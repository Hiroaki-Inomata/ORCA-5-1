      *******************************************************************
      * Project code name "ORCA"
      * 日医標準レセプトソフト（JMA standard receipt software）
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION              DIVISION.
       PROGRAM-ID.                 ORCSTOKNYUIN2.
      *****************************************************************
      *  システム名        : ＯＲＣＡ
      *  サブシステム名    : 入院
      *  コンポーネント名  : 特定入院料算定期間取得取得サブ
      *  管理者            : 
      *  作成日付    作業者        記述
      *  13/08/06    NACL−小豆沢  新規作成
      *****************************************************************
      *  プログラム修正履歴
      * Maj/Min/Rev  修正者       日付      内容
      *  05.00.01    NACL-小豆沢  17/11/20  (A314)認知症治療病棟入院料の
      *                                     起算日変更
      *  05.00.01    NACL-小豆沢  18/08/28  改正で算定コードが変更となった
      *                                     特定入院料の通算日数取得変更
      *  05.00.01    NACL-小豆沢  18/11/20  施設基準変更で緩和ケア病棟入院料
      *                                     の１と２が混在する場合の特定入院料
      *                                     の通算日数取得変更
      *  05.00.01    NACL-小豆沢  18/12/06  施設基準変更で地域包括ケア病棟入院料、
      *                                     地域包括ケア入院医療管理料の１と２が
      *                                     混在する場合の特定入院料の通算日数
      *                                     取得変更（特定地域は未対応）
      *  05.00.01    NACL-小豆沢  18/12/06  地域包括ケア病棟入院料、
      *                                     地域包括ケア入院医療管理料の
      *                                     通算日数取得変更
      *  05.00.01    NACL-小豆沢  19/04/17  地域包括ケア病棟入院料、
      *                                     地域包括ケア入院医療管理料の
      *                                     介護からの異動（急性増悪）対応
      *****************************************************************
      *
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *
       DATA                        DIVISION.
      *FILE                        SECTION.
      *
       WORKING-STORAGE             SECTION.
      *
      *    フラグ領域
       01  FLG-AREA.
           03  FLG-SYSKANRI                PIC 9(01).
           03  FLG-HIT                     PIC 9(01).
           03  FLG-PTCONF                  PIC 9(01).
           03  FLG-PTNYUINRRK              PIC 9(01).
      *  （０：治療室単位以外の特定入院料、１：治療室単位の特定入院料）
           03  FLG-ROOM                    PIC 9(01).
           03  FLG-KAIGO                   PIC 9(01).
      *
      *    添字領域
       01  IDX-AREA.
           03  IDX                         PIC 9(04).
           03  TN-IDX                      PIC 9(04).
      *
      *    一時領域
       01  WRK-AREA.
      *
           03  WRK-TOKNYUIN2-SRYCD         PIC X(09)  OCCURS 5.
           03  WRK-JGN-NISSU               PIC 9(05)  OCCURS 5.
           03  WRK-SRYCD-COUNT             PIC 9(02).
           03  WRK-TOKUTEI-DAY             PIC 9(03).
           03  WRK-TOKUTEI-DAY1            PIC 9(03).
           03  WRK-TOKUTEI-DAY2            PIC 9(03).
           03  WRK-TOKUTEI-DAY3            PIC 9(03).
           03  WRK-TOKUTEI-DAY4            PIC 9(03).
           03  WRK-TOKUTEI-DAY5            PIC 9(03).
           03  WRK-TOKU-TAISYONISSU        PIC 9(05).
      *    特定入院料の会計作成後に一般の入院料で会計を作成するための
      *    領域
           03  IPN-NYUKAIKEI-SAKUSEI-FLG   PIC X(01).
           03  IPN-SANTEISTYMD             PIC X(08).
           03  WRK-IPN-HANTEI-YMD1.
               05  WRK-IPN-HANTEI-YM1.
                   07  WRK-IPN-HANTEI-Y1   PIC 9(04).
                   07  WRK-IPN-HANTEI-M1   PIC 9(02).
               05  WRK-IPN-HANTEI-D1       PIC 9(02).
           03  WRK-IPN-HANTEI-YMD2         PIC X(08).
      *
           03  WRK-WEIGHT                  PIC 9(04).
           03  WRK-TOKUTEI-ROOM-NISSU      PIC 9(04).
           03  WRK-CHIIKI-HOUKATSU-NISSU   PIC 9(04).
      *
      *****************************************************************
      *    ファイルレイアウト
      *****************************************************************
      *
      *    システム管理
           COPY    "CPSK5001.INC".
      *
      *    患者個別設定
       01  PTCONF-REC.
           COPY    "CPPTCONF.INC".
      *
      *    患者入院履歴
       01  PTNYUINRRK-REC.
           COPY    "CPPTNYUINRRK.INC".
      *
      *    ＤＢ検索
           COPY    "MCPDATA.INC".
      *
           COPY    "MCPAREA".
      *
      *****************************************************************
      *    サブプロ用　領域
      *****************************************************************
      *
      *    日付変換サブ
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
           COPY    "CPORCSGDAY.INC".
      *
      *    通算日数取得サブ
           COPY "CPORCSTUSAN.INC".
      *
      *****************************************************************
      *    連絡　領域
      *****************************************************************
        LINKAGE                     SECTION.
      *
      *    特定入院料算定期間取得パラメタ
           COPY    "CPORCSTOKNYUIN2.INC".
      *
      *    スパ領域
           COPY    "COMMON-SPA".
      *
       PROCEDURE                   DIVISION    USING
           ORCSTOKNYUIN2-AREA
           SPA-AREA
           .
      *
      *****************************************************************
      *    主　　処理
      *****************************************************************
       000-PROC-SEC                    SECTION.
      *
           INITIALIZE                      FLG-AREA
           INITIALIZE                      IDX-AREA
           INITIALIZE                      WRK-AREA
           INITIALIZE                      LNK-TOKNYUIN2-HENKYAKU-AREA
           MOVE    ZERO                TO  LNK-TOKNYUIN2-RC
      *
           PERFORM    200-EDIT-SEC
           .
      *
       000-PROC-EXT.
           EXIT   PROGRAM
           .
      *
      *****************************************************************
      *    特定入院料コードセット
      *****************************************************************
       200-EDIT-SEC                    SECTION.
      *
           DISPLAY  "====  ORCSTOKNYUIN2 SET  ===="
           DISPLAY  "LNK-TOKNYUIN2-TOKUTEI-NYUIN  = " 
                     LNK-TOKNYUIN2-TOKUTEI-NYUIN
           DISPLAY  "LNK-TOKNYUIN2-IDOKBN    = " LNK-TOKNYUIN2-IDOKBN
           DISPLAY  "LNK-TOKNYUIN2-NYUINYMD  = " LNK-TOKNYUIN2-NYUINYMD
           DISPLAY  "LNK-TOKNYUIN2-SANTEIYMD = " LNK-TOKNYUIN2-SANTEIYMD
           DISPLAY  "LNK-TOKNYUIN2-NISSU08   = " LNK-TOKNYUIN2-NISSU08
      *
      *    特別処理
      *    精神科急性期治療病棟入院料１の急性増悪による転棟
           IF   (LNK-TOKNYUIN2-SET-SRYCD   =  "190121110")  AND
                (LNK-TOKNYUIN2-IDOKBN      =  "1")          AND
                (LNK-TOKNYUIN2-TOKUTEI-NYUIN   =   "24")
               MOVE    ZERO            TO  LNK-TOKNYUIN2-NISSU08
           END-IF
      *    精神科急性期治療病棟入院料２の急性増悪による転棟
           IF   (LNK-TOKNYUIN2-SET-SRYCD   =  "190121210")  AND
                (LNK-TOKNYUIN2-IDOKBN      =  "1")          AND
                (LNK-TOKNYUIN2-TOKUTEI-NYUIN   =   "25")
               MOVE    ZERO            TO  LNK-TOKNYUIN2-NISSU08
           END-IF
      *
      *    出生児体重の取得
           MOVE   SPACE                TO  PTCONF-REC
           INITIALIZE                      PTCONF-REC
           MOVE   LNK-TOKNYUIN2-HOSPNUM
                                       TO  PTCONF-HOSPNUM
           MOVE   LNK-TOKNYUIN2-PTID   TO  PTCONF-PTID
           MOVE   "BIRTHWEIGHT"        TO  PTCONF-CKEY
           PERFORM 900-PTCONF-READ-SEC
           IF     FLG-PTCONF           =   ZERO
               MOVE   PTCONF-CDATA(1:4)  TO  WRK-WEIGHT
           ELSE
               MOVE   9999               TO  WRK-WEIGHT
           END-IF
           DISPLAY  "ORCSTOKNYUIN2  WRK-WEIGHT = " WRK-WEIGHT
      *
      *    特定入院料コードと算定上限日数のセット（平成１８年３月３１日以前）
           IF     LNK-TOKNYUIN2-SANTEIYMD   <=   "20060331"
             EVALUATE    LNK-TOKNYUIN2-SET-SRYCD
      *      (A300)救命救急入院料１
              WHEN      "190024510"
                  MOVE  "190024510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190074510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料１（高度）
              WHEN      "190110210"
                  MOVE  "190110210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190110610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料１（Ａ）
              WHEN      "190110310"
                  MOVE  "190110310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190110710"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料２
              WHEN      "190024310"
                  MOVE  "190024310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190024410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料２（高度）
              WHEN      "190110410"
                  MOVE  "190110410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190110810"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料２（Ａ）
              WHEN      "190110510"
                  MOVE  "190110510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190110910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301)特定集中治療室管理料（重症者等比率基準未満）
              WHEN      "190116310"
                  MOVE  "190116310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190116410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301)特定集中治療室管理料
              WHEN      "190024610"
                  MOVE  "190024610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190074610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301-2)ハイケアユニット入院医療管理料
              WHEN      "190117310"
                  MOVE  "190117310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A302)新生児特定集中治療室管理料
      *      (A303)総合周産期特定集中治療室管理料
      *          ※上記入院料は出生時体重により上限日数が変動する為、
      *            このサブプログラムでは対応しない
      *      (A304)広範囲熱傷特定集中治療室管理料
              WHEN      "190024810"
                  MOVE  "190024810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A305)一類感染症患者入院医療管理料
              WHEN      "190075510"
                  MOVE  "190075510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190075610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A308)回復期リハビリテーション病棟入院料
              WHEN      "190075910"
                  MOVE  "190075910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  180            TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A308-2)亜急性期入院医療管理料
              WHEN      "190117410"
                  MOVE  "190117410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  90             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A316)診療所老人医療管理料
              WHEN      "190774110"
                  MOVE  "190774110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  "190774210"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
             END-EVALUATE
           END-IF
      *
      *    特定入院料コードと算定上限日数のセット
      *    （平成１８年４月１日から平成２０年３月３１日）
           IF    (LNK-TOKNYUIN2-SANTEIYMD   >=   "20060401")  AND
                 (LNK-TOKNYUIN2-SANTEIYMD   <=   "20080331")
             EVALUATE    LNK-TOKNYUIN2-SET-SRYCD
      *      (A300)救命救急入院料１
              WHEN      "190024510"
                  MOVE  "190024510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190074510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料１（高度）
              WHEN      "190110210"
                  MOVE  "190110210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190110610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料１（Ａ）
              WHEN      "190110310"
                  MOVE  "190110310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190110710"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料２
              WHEN      "190024310"
                  MOVE  "190024310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190024410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料２（高度）
              WHEN      "190110410"
                  MOVE  "190110410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190110810"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料２（Ａ）
              WHEN      "190110510"
                  MOVE  "190110510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190110910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301)特定集中治療室管理料
              WHEN      "190116310"
                  MOVE  "190116310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190116410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301)特定集中治療室管理料（重症者等比率基準適合）
              WHEN      "190024610"
                  MOVE  "190024610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190074610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301-2)ハイケアユニット入院医療管理料
              WHEN      "190117310"
                  MOVE  "190117310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A301-3)脳卒中ケアユニット入院医療管理料
              WHEN      "190120810"
                  MOVE  "190120810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A302)新生児特定集中治療室管理料
      *      (A303)総合周産期特定集中治療室管理料
      *          ※上記入院料は出生時体重により上限日数が変動する為、
      *            このサブプログラムでは対応しない
      *      (A304)広範囲熱傷特定集中治療室管理料
              WHEN      "190024810"
                  MOVE  "190024810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A305)一類感染症患者入院医療管理料
              WHEN      "190075510"
                  MOVE  "190075510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190075610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A308-2)亜急性期入院医療管理料
              WHEN      "190117410"
                  MOVE  "190117410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  90             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A311)精神科救急入院料
              WHEN      "190121010"
                  MOVE  "190121010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190111410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311-2)精神科急性期治療病棟入院料１
              WHEN      "190121110"
                  MOVE  "190121110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190066910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311-2)精神科急性期治療病棟入院料２
              WHEN      "190121210"
                  MOVE  "190121210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190067010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A314)老人性認知症疾患治療病棟入院料１
              WHEN      "190739910"
                  MOVE  "190739910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  90             TO  WRK-JGN-NISSU(1)
                  MOVE  "190740010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A314)老人性認知症疾患治療病棟入院料２
              WHEN      "190813410"
                  MOVE  "190813410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  90             TO  WRK-JGN-NISSU(1)
                  MOVE  "190813510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A316)診療所老人医療管理料
              WHEN      "190774110"
                  MOVE  "190774110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  "190774210"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A316)診療所老人医療管理料（生活療養）
              WHEN      "190125010"
                  MOVE  "190125010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  "190125110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
             END-EVALUATE
           END-IF
      *
      *    特定入院料コードと算定上限日数のセット
      *    （平成２０年４月１日から平成２２年３月３１日）
           IF    (LNK-TOKNYUIN2-SANTEIYMD   >=   "20080401")  AND
                 (LNK-TOKNYUIN2-SANTEIYMD   <=   "20100331")
             EVALUATE    LNK-TOKNYUIN2-SET-SRYCD
      *      (A300)救命救急入院料１
              WHEN      "190024510"
                  MOVE  "190024510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190128610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190074510"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料２
              WHEN      "190024310"
                  MOVE  "190024310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190128710"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190024410"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A301)特定集中治療室管理料
              WHEN      "190116310"
                  MOVE  "190116310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190116410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301)特定集中治療室管理料（重症者等比率基準適合）
              WHEN      "190024610"
                  MOVE  "190024610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190074610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301-2)ハイケアユニット入院医療管理料
              WHEN      "190117310"
                  MOVE  "190117310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A301-3)脳卒中ケアユニット入院医療管理料
              WHEN      "190120810"
                  MOVE  "190120810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A302)新生児特定集中治療室管理料
      *      (A303)総合周産期特定集中治療室管理料
      *          ※上記入院料は出生時体重により上限日数が変動する為、
      *            このサブプログラムでは対応しない
      *      (A304)広範囲熱傷特定集中治療室管理料
              WHEN      "190024810"
                  MOVE  "190024810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A305)一類感染症患者入院医療管理料
              WHEN      "190075510"
                  MOVE  "190075510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190075610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A308-2)亜急性期入院医療管理料１
              WHEN      "190117410"
                  MOVE  "190117410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  90             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A308-2)亜急性期入院医療管理料２
              WHEN      "190129910"
                  MOVE  "190129910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A311)精神科救急入院料１
              WHEN      "190121010"
                  MOVE  "190121010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190111410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311)精神科救急入院料２
              WHEN      "190130010"
                  MOVE  "190130010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190130110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311-2)精神科急性期治療病棟入院料１
              WHEN      "190121110"
                  MOVE  "190121110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190066910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311-2)精神科急性期治療病棟入院料２
              WHEN      "190121210"
                  MOVE  "190121210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190067010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311-3)精神科救急・合併症入院料
              WHEN      "190130210"
                  MOVE  "190130210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190130310"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A314)認知症病棟入院料１
              WHEN      "190739910"
                  MOVE  "190739910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  90             TO  WRK-JGN-NISSU(1)
                  MOVE  "190740010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A314)認知症病棟入院料２
              WHEN      "190813410"
                  MOVE  "190813410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  90             TO  WRK-JGN-NISSU(1)
                  MOVE  "190813510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A316)診療所後期高齢者医療管理料
              WHEN      "190774110"
                  MOVE  "190774110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  "190774210"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A316)診療所後期高齢者医療管理料（生活療養）
              WHEN      "190125010"
                  MOVE  "190125010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  "190125110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
             END-EVALUATE
           END-IF
      *
      *    特定入院料コードと算定上限日数のセット
      *    （平成２２年４月１日から平成２４年３月３１日）
           IF    (LNK-TOKNYUIN2-SANTEIYMD   >=   "20100401")  AND
                 (LNK-TOKNYUIN2-SANTEIYMD   <=   "20120331")
             EVALUATE    LNK-TOKNYUIN2-SET-SRYCD
      *      (A300)救命救急入院料１
              WHEN      "190024510"
                  MOVE  "190024510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190128610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190074510"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料２
              WHEN      "190024310"
                  MOVE  "190024310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190128710"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190024410"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料３（救命救急入院料）
              WHEN      "190138110"
                  MOVE  "190138110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138210"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138310"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料３（広範囲熱傷特定集中治療）
              WHEN      "190138410"
                  MOVE  "190138410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138610"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  60             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料４（救命救急入院料）
              WHEN      "190138710"
                  MOVE  "190138710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138810"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138910"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料４（広範囲熱傷特定集中治療）
              WHEN      "190139010"
                  MOVE  "190139010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190139110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190139210"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  "190139310"    TO  WRK-TOKNYUIN2-SRYCD(4)
                  MOVE  60             TO  WRK-JGN-NISSU(4)
                  MOVE  4              TO  WRK-SRYCD-COUNT
      *      (A301)特定集中治療室管理料１
              WHEN      "190116310"
                  MOVE  "190116310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190116410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301)特定集中治療室管理料２（特定集中治療室管理料）
              WHEN      "190139810"
                  MOVE  "190139810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190139910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301)特定集中治療室管理料２（広範囲熱傷特定集中治療）
              WHEN      "190140010"
                  MOVE  "190140010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190140110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301-2)ハイケアユニット入院医療管理料
              WHEN      "190117310"
                  MOVE  "190117310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A301-3)脳卒中ケアユニット入院医療管理料
              WHEN      "190120810"
                  MOVE  "190120810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A302)新生児特定集中治療室管理料１
              WHEN      "190024710"
                  MOVE  "190024710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A302)新生児特定集中治療室管理料２
              WHEN      "190140410"
                  MOVE  "190140410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A303)総合周産期特定集中治療室管理料（母体・胎児）
              WHEN      "190066710"
                  MOVE  "190066710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A303)総合周産期特定集中治療室管理料（新生児）
              WHEN      "190066810"
                  MOVE  "190066810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A303-2)新生児治療回復室入院医療管理料
              WHEN      "190140510"
                  MOVE  "190140510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  120        TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A305)一類感染症患者入院医療管理料
              WHEN      "190075510"
                  MOVE  "190075510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190075610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A308-2)亜急性期入院医療管理料１
              WHEN      "190117410"
                  MOVE  "190117410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  90             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A308-2)亜急性期入院医療管理料２
              WHEN      "190129910"
                  MOVE  "190129910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A311)精神科救急入院料１
              WHEN      "190121010"
                  MOVE  "190121010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190111410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311)精神科救急入院料２
              WHEN      "190130010"
                  MOVE  "190130010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190130110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311-2)精神科急性期治療病棟入院料１
              WHEN      "190121110"
                  MOVE  "190121110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190066910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311-2)精神科急性期治療病棟入院料２
              WHEN      "190121210"
                  MOVE  "190121210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190067010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311-3)精神科救急・合併症入院料
              WHEN      "190130210"
                  MOVE  "190130210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190130310"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A314)認知症治療病棟入院料１
              WHEN      "190739910"
                  MOVE  "190739910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  "190740010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A314)認知症治療病棟入院料２
              WHEN      "190813410"
                  MOVE  "190813410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  "190813510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
             END-EVALUATE
           END-IF
      *
      *    特定入院料コードと算定上限日数のセット
      *    （平成２４年４月１日から平成２６年３月３１日）
           IF    (LNK-TOKNYUIN2-SANTEIYMD   >=   "20120401")  AND
                 (LNK-TOKNYUIN2-SANTEIYMD   <=   "20140331")
             EVALUATE    LNK-TOKNYUIN2-SET-SRYCD
      *      (A300)救命救急入院料１
              WHEN      "190024510"
                  MOVE  "190024510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190128610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190074510"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料２
              WHEN      "190024310"
                  MOVE  "190024310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190128710"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190024410"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料３（救命救急入院料）
              WHEN      "190138110"
                  MOVE  "190138110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138210"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138310"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料３（広範囲熱傷特定集中治療）
              WHEN      "190138410"
                  MOVE  "190138410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138610"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  60             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料４（救命救急入院料）
              WHEN      "190138710"
                  MOVE  "190138710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138810"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138910"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A300)救命救急入院料４（広範囲熱傷特定集中治療）
              WHEN      "190139010"
                  MOVE  "190139010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190139110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190139210"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  "190139310"    TO  WRK-TOKNYUIN2-SRYCD(4)
                  MOVE  60             TO  WRK-JGN-NISSU(4)
                  MOVE  4              TO  WRK-SRYCD-COUNT
      *      (A301)特定集中治療室管理料１
              WHEN      "190116310"
                  MOVE  "190116310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190116410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301)特定集中治療室管理料２（特定集中治療室管理料）
              WHEN      "190139810"
                  MOVE  "190139810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190139910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301)特定集中治療室管理料２（広範囲熱傷特定集中治療）
              WHEN      "190140010"
                  MOVE  "190140010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190140110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A301-2)ハイケアユニット入院医療管理料
              WHEN      "190117310"
                  MOVE  "190117310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A301-3)脳卒中ケアユニット入院医療管理料
              WHEN      "190120810"
                  MOVE  "190120810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A301-4)小児特定集中治療室管理料
              WHEN      "190149910"
                  MOVE  "190149910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190150010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A302)新生児特定集中治療室管理料１
              WHEN      "190024710"
                  MOVE  "190024710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A302)新生児特定集中治療室管理料２
              WHEN      "190140410"
                  MOVE  "190140410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A303)総合周産期特定集中治療室管理料（母体・胎児）
              WHEN      "190066710"
                  MOVE  "190066710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A303)総合周産期特定集中治療室管理料（新生児）
              WHEN      "190066810"
                  MOVE  "190066810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A303-2)新生児治療回復室入院医療管理料
              WHEN      "190140510"
                  MOVE  "190140510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  120        TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A305)一類感染症患者入院医療管理料
              WHEN      "190075510"
                  MOVE  "190075510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190075610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A308-2)亜急性期入院医療管理料１
              WHEN      "190117410"
                  MOVE  "190117410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  IF    LNK-TOKNYUIN2-TOKUBETSU-FLG(1)  =  "1"
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  ELSE
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A308-2)亜急性期入院医療管理料１（指定地域）
              WHEN      "190150310"
                  MOVE  "190150310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A308-2)亜急性期入院医療管理料２
              WHEN      "190129910"
                  MOVE  "190129910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  IF    LNK-TOKNYUIN2-TOKUBETSU-FLG(1)  =  "1"
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  ELSE
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A308-2)亜急性期入院医療管理料２（指定地域）
              WHEN      "190150410"
                  MOVE  "190150410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A310)緩和ケア病棟入院料
              WHEN      "190028910"
                  MOVE  "190028910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190150510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190150610"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A311)精神科救急入院料１
              WHEN      "190121010"
                  MOVE  "190121010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190111410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311)精神科救急入院料２
              WHEN      "190130010"
                  MOVE  "190130010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190130110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311-2)精神科急性期治療病棟入院料１
              WHEN      "190121110"
                  MOVE  "190121110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190066910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311-2)精神科急性期治療病棟入院料２
              WHEN      "190121210"
                  MOVE  "190121210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190067010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A311-3)精神科救急・合併症入院料
              WHEN      "190130210"
                  MOVE  "190130210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190130310"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
      *      (A314)認知症治療病棟入院料１
              WHEN      "190151610"
                  MOVE  "190151610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190739910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190740010"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A314)認知症治療病棟入院料２
              WHEN      "190151710"
                  MOVE  "190151710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190813410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190813510"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
      *      (A317)特定一般病棟入院料（亜急性期入院医療管理）
              WHEN      "190152610"
                  MOVE  "190152610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
      *      (A317)特定一般病棟入院料（亜急性期入院医療管理・リハビリ算定患者）
              WHEN      "190152710"
                  MOVE  "190152710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
             END-EVALUATE
           END-IF
      *
      *    特定入院料コードと算定上限日数のセット
      *    （平成２６年４月１日から平成２８年３月３１日）
           IF    (LNK-TOKNYUIN2-SANTEIYMD   >=   "20140401")  AND
                 (LNK-TOKNYUIN2-SANTEIYMD   <=   "20160331")
             EVALUATE    LNK-TOKNYUIN2-SET-SRYCD
      *      (A300)救命救急入院料１
              WHEN      "190024510"
                  MOVE  "190024510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190128610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190074510"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料２
              WHEN      "190024310"
                  MOVE  "190024310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190128710"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190024410"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料３（救命救急入院料）
              WHEN      "190138110"
                  MOVE  "190138110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138210"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138310"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料３（広範囲熱傷特定集中治療）
              WHEN      "190138410"
                  MOVE  "190138410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138610"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  60             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料４（救命救急入院料）
              WHEN      "190138710"
                  MOVE  "190138710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138810"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138910"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料４（広範囲熱傷特定集中治療）
              WHEN      "190139010"
                  MOVE  "190139010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190139110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190139210"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  "190139310"    TO  WRK-TOKNYUIN2-SRYCD(4)
                  MOVE  60             TO  WRK-JGN-NISSU(4)
                  MOVE  4              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料１
              WHEN      "190174410"
                  MOVE  "190174410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190174510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料２（特定集中治療室管理料）
              WHEN      "190174610"
                  MOVE  "190174610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190174710"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料２（広範囲熱傷特定集中治療）
              WHEN      "190174810"
                  MOVE  "190174810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190174910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料３
              WHEN      "190116310"
                  MOVE  "190116310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190116410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料４（特定集中治療室管理料）
              WHEN      "190139810"
                  MOVE  "190139810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190139910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料４（広範囲熱傷特定集中治療）
              WHEN      "190140010"
                  MOVE  "190140010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190140110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-2)ハイケアユニット入院医療管理料１
              WHEN      "190175010"
                  MOVE  "190175010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-2)ハイケアユニット入院医療管理料２
              WHEN      "190175110"
                  MOVE  "190175110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-2)ハイケアユニット入院医療管理料
              WHEN      "190117310"
                  MOVE  "190117310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-3)脳卒中ケアユニット入院医療管理料
              WHEN      "190120810"
                  MOVE  "190120810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-4)小児特定集中治療室管理料
              WHEN      "190149910"
                  MOVE  "190149910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190150010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A302)新生児特定集中治療室管理料１
      **          体重１，５００グラム以上で，厚生労働大臣が定める疾患
      **          を主病とする患者は３５日限度だが、現状では判定できない
      **          為、未対応
              WHEN      "190024710"
                  MOVE  "190024710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A302)新生児特定集中治療室管理料２
      **          体重１，５００グラム以上で，厚生労働大臣が定める疾患
      **          を主病とする患者は３５日限度だが、現状では判定できない
      **          為、未対応
              WHEN      "190140410"
                  MOVE  "190140410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A303)総合周産期特定集中治療室管理料（母体・胎児）
              WHEN      "190066710"
                  MOVE  "190066710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A303)総合周産期特定集中治療室管理料（新生児）
      **          体重１，５００グラム以上で，厚生労働大臣が定める疾患
      **          を主病とする患者は３５日限度だが、現状では判定できない
      **          為、未対応
              WHEN      "190066810"
                  MOVE  "190066810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A303-2)新生児治療回復室入院医療管理料
      **          体重１，５００グラム以上で，厚生労働大臣が定める疾患
      **          を主病とする患者は５０日限度だが、現状では判定できない
      **          為、未対応
              WHEN      "190140510"
                  MOVE  "190140510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  120        TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A305)一類感染症患者入院医療管理料
              WHEN      "190075510"
                  MOVE  "190075510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190075610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A308-2)亜急性期入院医療管理料１
              WHEN      "190117410"
                  MOVE  "190117410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  IF    LNK-TOKNYUIN2-TOKUBETSU-FLG(1)  =  "1"
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  ELSE
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-2)亜急性期入院医療管理料１（指定地域）
              WHEN      "190150310"
                  MOVE  "190150310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-2)亜急性期入院医療管理料２
              WHEN      "190129910"
                  MOVE  "190129910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  IF    LNK-TOKNYUIN2-TOKUBETSU-FLG(1)  =  "1"
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  ELSE
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-2)亜急性期入院医療管理料２（指定地域）
              WHEN      "190150410"
                  MOVE  "190150410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院１
              WHEN      "190175310"
                  MOVE  "190175310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院１（生活療養）
              WHEN      "190175410"
                  MOVE  "190175410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料１
              WHEN      "190175510"
                  MOVE  "190175510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料１（生活療養）
              WHEN      "190175610"
                  MOVE  "190175610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院２
              WHEN      "190175710"
                  MOVE  "190175710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院２（生活療養）
              WHEN      "190175810"
                  MOVE  "190175810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料２
              WHEN      "190175910"
                  MOVE  "190175910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料２（生活療養）
              WHEN      "190176010"
                  MOVE  "190176010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院１（特定地域）
              WHEN      "190176110"
                  MOVE  "190176110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院１（生活療養）（特定地域）
              WHEN      "190176210"
                  MOVE  "190176210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料１（特定地域）
              WHEN      "190176310"
                  MOVE  "190176310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料１（生活療養）（特定地域）
              WHEN      "190176410"
                  MOVE  "190176410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院２（特定地域）
              WHEN      "190176510"
                  MOVE  "190176510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院２（生活療養）（特定地域）
              WHEN      "190176610"
                  MOVE  "190176610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料２（特定地域）
              WHEN      "190176710"
                  MOVE  "190176710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料２（生活療養）（特定地域）
              WHEN      "190176810"
                  MOVE  "190176810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A310)緩和ケア病棟入院料
              WHEN      "190028910"
                  MOVE  "190028910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190150510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190150610"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311)精神科救急入院料１
              WHEN      "190121010"
                  MOVE  "190121010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190111410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311)精神科救急入院料２
              WHEN      "190130010"
                  MOVE  "190130010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190130110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311-2)精神科急性期治療病棟入院料１
              WHEN      "190121110"
                  MOVE  "190121110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190066910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311-2)精神科急性期治療病棟入院料２
              WHEN      "190121210"
                  MOVE  "190121210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190067010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311-3)精神科救急・合併症入院料
              WHEN      "190130210"
                  MOVE  "190130210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190130310"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A314)認知症治療病棟入院料１
              WHEN      "190151610"
                  MOVE  "190151610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190739910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190740010"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A314)認知症治療病棟入院料２
              WHEN      "190151710"
                  MOVE  "190151710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190813410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190813510"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A317)特定一般病棟入院料（亜急性期入院医療管理）
              WHEN      "190152610"
                  MOVE  "190152610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A317)特定一般病棟入院料（亜急性期入院医療管理・リハビリ算定患者）
              WHEN      "190152710"
                  MOVE  "190152710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A317)特定一般病棟入院料（地域包括ケア入院医療管理１）
              WHEN      "190182310"
                  MOVE  "190182310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A317)特定一般病棟入院料（地域包括ケア入院医療管理２）
              WHEN      "190182410"
                  MOVE  "190182410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
             END-EVALUATE
           END-IF
      *
      *    特定入院料コードと算定上限日数のセット
      *    （平成２８年４月１日から平成３０年３月３１日）
           IF    (LNK-TOKNYUIN2-SANTEIYMD   >=   "20160401")  AND
                 (LNK-TOKNYUIN2-SANTEIYMD   <=   "20180331")
             EVALUATE    LNK-TOKNYUIN2-SET-SRYCD
      *      (A300)救命救急入院料１
              WHEN      "190024510"
                  MOVE  "190024510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190128610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190074510"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料２
              WHEN      "190024310"
                  MOVE  "190024310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190128710"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190024410"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料３（救命救急入院料）
              WHEN      "190138110"
                  MOVE  "190138110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138210"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138310"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料３（広範囲熱傷特定集中治療）
              WHEN      "190138410"
                  MOVE  "190138410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138610"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  60             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料４（救命救急入院料）
              WHEN      "190138710"
                  MOVE  "190138710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138810"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138910"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料４（広範囲熱傷特定集中治療）
              WHEN      "190139010"
                  MOVE  "190139010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190139110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190139210"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  "190139310"    TO  WRK-TOKNYUIN2-SRYCD(4)
                  MOVE  60             TO  WRK-JGN-NISSU(4)
                  MOVE  4              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料１
              WHEN      "190174410"
                  MOVE  "190174410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190174510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料２（特定集中治療室管理料）
              WHEN      "190174610"
                  MOVE  "190174610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190174710"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料２（広範囲熱傷特定集中治療）
              WHEN      "190174810"
                  MOVE  "190174810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190174910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料３
              WHEN      "190116310"
                  MOVE  "190116310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190116410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料４（特定集中治療室管理料）
              WHEN      "190139810"
                  MOVE  "190139810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190139910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料４（広範囲熱傷特定集中治療）
              WHEN      "190140010"
                  MOVE  "190140010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190140110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-2)ハイケアユニット入院医療管理料１
              WHEN      "190175010"
                  MOVE  "190175010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-2)ハイケアユニット入院医療管理料２
              WHEN      "190175110"
                  MOVE  "190175110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-2)ハイケアユニット入院医療管理料
              WHEN      "190117310"
                  MOVE  "190117310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-3)脳卒中ケアユニット入院医療管理料
              WHEN      "190120810"
                  MOVE  "190120810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-4)小児特定集中治療室管理料
              WHEN      "190149910"
                  MOVE  "190149910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190150010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A302)新生児特定集中治療室管理料１
      **          体重１，５００グラム以上で，厚生労働大臣が定める疾患
      **          を主病とする患者は３５日限度だが、現状では判定できない
      **          為、未対応
              WHEN      "190024710"
                  MOVE  "190024710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A302)新生児特定集中治療室管理料２
      **          体重１，５００グラム以上で，厚生労働大臣が定める疾患
      **          を主病とする患者は３５日限度だが、現状では判定できない
      **          為、未対応
              WHEN      "190140410"
                  MOVE  "190140410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A303)総合周産期特定集中治療室管理料（母体・胎児）
              WHEN      "190066710"
                  MOVE  "190066710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A303)総合周産期特定集中治療室管理料（新生児）
      **          体重１，５００グラム以上で，厚生労働大臣が定める疾患
      **          を主病とする患者は３５日限度だが、現状では判定できない
      **          為、未対応
              WHEN      "190066810"
                  MOVE  "190066810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A303-2)新生児治療回復室入院医療管理料
      **          体重１，５００グラム以上で，厚生労働大臣が定める疾患
      **          を主病とする患者は５０日限度だが、現状では判定できない
      **          為、未対応
              WHEN      "190140510"
                  MOVE  "190140510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  120        TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A305)一類感染症患者入院医療管理料
              WHEN      "190194310"
                  MOVE  "190194310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  "190194410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A308-2)亜急性期入院医療管理料１
              WHEN      "190117410"
                  MOVE  "190117410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  IF    LNK-TOKNYUIN2-TOKUBETSU-FLG(1)  =  "1"
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  ELSE
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-2)亜急性期入院医療管理料１（指定地域）
              WHEN      "190150310"
                  MOVE  "190150310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-2)亜急性期入院医療管理料２
              WHEN      "190129910"
                  MOVE  "190129910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  IF    LNK-TOKNYUIN2-TOKUBETSU-FLG(1)  =  "1"
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  ELSE
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-2)亜急性期入院医療管理料２（指定地域）
              WHEN      "190150410"
                  MOVE  "190150410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院１
              WHEN      "190175310"
                  MOVE  "190175310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院１（生活療養）
              WHEN      "190175410"
                  MOVE  "190175410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料１
              WHEN      "190175510"
                  MOVE  "190175510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料１（生活療養）
              WHEN      "190175610"
                  MOVE  "190175610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院２
              WHEN      "190175710"
                  MOVE  "190175710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院２（生活療養）
              WHEN      "190175810"
                  MOVE  "190175810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料２
              WHEN      "190175910"
                  MOVE  "190175910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料２（生活療養）
              WHEN      "190176010"
                  MOVE  "190176010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院１（特定地域）
              WHEN      "190176110"
                  MOVE  "190176110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院１（生活療養）（特定地域）
              WHEN      "190176210"
                  MOVE  "190176210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料１（特定地域）
              WHEN      "190176310"
                  MOVE  "190176310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料１（生活療養）（特定地域）
              WHEN      "190176410"
                  MOVE  "190176410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院２（特定地域）
              WHEN      "190176510"
                  MOVE  "190176510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院２（生活療養）（特定地域）
              WHEN      "190176610"
                  MOVE  "190176610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料２（特定地域）
              WHEN      "190176710"
                  MOVE  "190176710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料２（生活療養）（特定地域）
              WHEN      "190176810"
                  MOVE  "190176810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A310)緩和ケア病棟入院料
              WHEN      "190028910"
                  MOVE  "190028910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190150510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190150610"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311)精神科救急入院料１
              WHEN      "190121010"
                  MOVE  "190121010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190111410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311)精神科救急入院料２
              WHEN      "190130010"
                  MOVE  "190130010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190130110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311-2)精神科急性期治療病棟入院料１
              WHEN      "190121110"
                  MOVE  "190121110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190066910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311-2)精神科急性期治療病棟入院料２
              WHEN      "190121210"
                  MOVE  "190121210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190067010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311-3)精神科救急・合併症入院料
              WHEN      "190130210"
                  MOVE  "190130210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190130310"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A314)認知症治療病棟入院料１
              WHEN      "190151610"
                  MOVE  "190151610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190739910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190740010"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A314)認知症治療病棟入院料２
              WHEN      "190151710"
                  MOVE  "190151710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190813410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190813510"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A317)特定一般病棟入院料（亜急性期入院医療管理）
              WHEN      "190152610"
                  MOVE  "190152610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A317)特定一般病棟入院料（亜急性期入院医療管理・リハビリ算定患者）
              WHEN      "190152710"
                  MOVE  "190152710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A317)特定一般病棟入院料（地域包括ケア入院医療管理１）
              WHEN      "190182310"
                  MOVE  "190182310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A317)特定一般病棟入院料（地域包括ケア入院医療管理２）
              WHEN      "190182410"
                  MOVE  "190182410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
             END-EVALUATE
           END-IF
      *
      *    特定入院料コードと算定上限日数のセット（平成３０年４月１日以降）
           IF     LNK-TOKNYUIN2-SANTEIYMD   >=   "20180401"
             EVALUATE    LNK-TOKNYUIN2-SET-SRYCD
      *      (A300)救命救急入院料１
              WHEN      "190024510"
                  MOVE  "190024510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190128610"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190074510"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料２
              WHEN      "190024310"
                  MOVE  "190024310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190128710"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190024410"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料３（救命救急入院料）
              WHEN      "190138110"
                  MOVE  "190138110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138210"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138310"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料３（広範囲熱傷特定集中治療）
              WHEN      "190138410"
                  MOVE  "190138410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138610"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  60             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料４（救命救急入院料）
              WHEN      "190138710"
                  MOVE  "190138710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190138810"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190138910"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A300)救命救急入院料４（広範囲熱傷特定集中治療）
              WHEN      "190139010"
                  MOVE  "190139010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  3              TO  WRK-JGN-NISSU(1)
                  MOVE  "190139110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  7              TO  WRK-JGN-NISSU(2)
                  MOVE  "190139210"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  14             TO  WRK-JGN-NISSU(3)
                  MOVE  "190139310"    TO  WRK-TOKNYUIN2-SRYCD(4)
                  MOVE  60             TO  WRK-JGN-NISSU(4)
                  MOVE  4              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料１
              WHEN      "190174410"
                  MOVE  "190174410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190174510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料２（特定集中治療室管理料）
              WHEN      "190174610"
                  MOVE  "190174610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190174710"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料２（広範囲熱傷特定集中治療）
              WHEN      "190174810"
                  MOVE  "190174810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190174910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料３
              WHEN      "190116310"
                  MOVE  "190116310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190116410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料４（特定集中治療室管理料）
              WHEN      "190139810"
                  MOVE  "190139810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190139910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  14             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301)特定集中治療室管理料４（広範囲熱傷特定集中治療）
              WHEN      "190140010"
                  MOVE  "190140010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190140110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-2)ハイケアユニット入院医療管理料１
              WHEN      "190175010"
                  MOVE  "190175010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-2)ハイケアユニット入院医療管理料２
              WHEN      "190175110"
                  MOVE  "190175110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-2)ハイケアユニット入院医療管理料
              WHEN      "190117310"
                  MOVE  "190117310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-3)脳卒中ケアユニット入院医療管理料
              WHEN      "190120810"
                  MOVE  "190120810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A301-4)小児特定集中治療室管理料
              WHEN      "190149910"
                  MOVE  "190149910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  7              TO  WRK-JGN-NISSU(1)
                  MOVE  "190150010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A302)新生児特定集中治療室管理料１
      **          体重１，５００グラム以上で，厚生労働大臣が定める疾患
      **          を主病とする患者は３５日限度だが、現状では判定できない
      **          為、未対応
              WHEN      "190024710"
                  MOVE  "190024710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A302)新生児特定集中治療室管理料２
      **          体重１，５００グラム以上で，厚生労働大臣が定める疾患
      **          を主病とする患者は３５日限度だが、現状では判定できない
      **          為、未対応
              WHEN      "190140410"
                  MOVE  "190140410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A303)総合周産期特定集中治療室管理料（母体・胎児）
              WHEN      "190066710"
                  MOVE  "190066710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A303)総合周産期特定集中治療室管理料（新生児）
      **          体重１，５００グラム以上で，厚生労働大臣が定める疾患
      **          を主病とする患者は３５日限度だが、現状では判定できない
      **          為、未対応
              WHEN      "190066810"
                  MOVE  "190066810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  21             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  60         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A303-2)新生児治療回復室入院医療管理料
      **          体重１，５００グラム以上で，厚生労働大臣が定める疾患
      **          を主病とする患者は５０日限度だが、現状では判定できない
      **          為、未対応
              WHEN      "190140510"
                  MOVE  "190140510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  IF    WRK-WEIGHT     <   1000
                      MOVE  120        TO  WRK-JGN-NISSU(1)
                  END-IF
                  IF   (WRK-WEIGHT     >=  1000)   AND
                       (WRK-WEIGHT     <   1500)
                      MOVE  90         TO  WRK-JGN-NISSU(1)
                  END-IF
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A305)一類感染症患者入院医療管理料
              WHEN      "190194310"
                  MOVE  "190194310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  14             TO  WRK-JGN-NISSU(1)
                  MOVE  "190194410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  1              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院１
              WHEN      "190209110"
                  MOVE  "190209110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院１（生活療養）
              WHEN      "190209210"
                  MOVE  "190209210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料１
              WHEN      "190209310"
                  MOVE  "190209310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料１（生活療養）
              WHEN      "190209410"
                  MOVE  "190209410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院２
              WHEN      "190209510"
                  MOVE  "190209510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院２（生活療養）
              WHEN      "190209610"
                  MOVE  "190209610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料２
              WHEN      "190209710"
                  MOVE  "190209710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料２（生活療養）
              WHEN      "190209810"
                  MOVE  "190209810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院３
              WHEN      "190209910"
                  MOVE  "190209910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院３（生活療養）
              WHEN      "190210010"
                  MOVE  "190210010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料３
              WHEN      "190210110"
                  MOVE  "190210110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料３（生活療養）
              WHEN      "190210210"
                  MOVE  "190210210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院４
              WHEN      "190210310"
                  MOVE  "190210310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院４（生活療養）
              WHEN      "190210410"
                  MOVE  "190210410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料４
              WHEN      "190210510"
                  MOVE  "190210510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料４（生活療養）
              WHEN      "190210610"
                  MOVE  "190210610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院１（特定地域）
              WHEN      "190210710"
                  MOVE  "190210710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院１（生活療養）（特定地域）
              WHEN      "190210810"
                  MOVE  "190210810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料１（特定地域）
              WHEN      "190210910"
                  MOVE  "190210910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料１（生活療養）（特定地域）
              WHEN      "190211010"
                  MOVE  "190211010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院２（特定地域）
              WHEN      "190211110"
                  MOVE  "190211110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院２（生活療養）（特定地域）
              WHEN      "190211210"
                  MOVE  "190211210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料２（特定地域）
              WHEN      "190211310"
                  MOVE  "190211310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料２（生活療養）（特定地域）
              WHEN      "190211410"
                  MOVE  "190211410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院３（特定地域）
              WHEN      "190211510"
                  MOVE  "190211510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院３（生活療養）（特定地域）
              WHEN      "190211610"
                  MOVE  "190211610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料３（特定地域）
              WHEN      "190211710"
                  MOVE  "190211710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料３（生活療養）（特定地域）
              WHEN      "190211810"
                  MOVE  "190211810"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院４（特定地域）
              WHEN      "190211910"
                  MOVE  "190211910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア病棟入院４（生活療養）（特定地域）
              WHEN      "190212010"
                  MOVE  "190212010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料４（特定地域）
              WHEN      "190212110"
                  MOVE  "190212110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A308-3)地域包括ケア入院医療管理料４（生活療養）（特定地域）
              WHEN      "190212210"
                  MOVE  "190212210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A310)緩和ケア病棟入院料１
              WHEN      "190028910"
                  MOVE  "190028910"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190150510"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190150610"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A310)緩和ケア病棟入院料２
              WHEN      "190212710"
                  MOVE  "190212710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190212810"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190212910"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311)精神科救急入院料１
              WHEN      "190121010"
                  MOVE  "190121010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190111410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311)精神科救急入院料２
              WHEN      "190130010"
                  MOVE  "190130010"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190130110"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311-2)精神科急性期治療病棟入院料１
              WHEN      "190121110"
                  MOVE  "190121110"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190066910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311-2)精神科急性期治療病棟入院料２
              WHEN      "190121210"
                  MOVE  "190121210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190067010"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A311-3)精神科救急・合併症入院料
              WHEN      "190130210"
                  MOVE  "190130210"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190130310"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  99999          TO  WRK-JGN-NISSU(2)
                  MOVE  2              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A314)認知症治療病棟入院料１
              WHEN      "190151610"
                  MOVE  "190151610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190739910"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190740010"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A314)認知症治療病棟入院料２
              WHEN      "190151710"
                  MOVE  "190151710"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  30             TO  WRK-JGN-NISSU(1)
                  MOVE  "190813410"    TO  WRK-TOKNYUIN2-SRYCD(2)
                  MOVE  60             TO  WRK-JGN-NISSU(2)
                  MOVE  "190813510"    TO  WRK-TOKNYUIN2-SRYCD(3)
                  MOVE  99999          TO  WRK-JGN-NISSU(3)
                  MOVE  3              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A317)特定一般病棟入院料（地域包括ケア１）
              WHEN      "190213310"
                  MOVE  "190213310"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A317)特定一般病棟入院料（地域包括ケア２）
              WHEN      "190213410"
                  MOVE  "190213410"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A317)特定一般病棟入院料（地域包括ケア３）
              WHEN      "190213510"
                  MOVE  "190213510"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
      *      (A317)特定一般病棟入院料（地域包括ケア４）
              WHEN      "190213610"
                  MOVE  "190213610"    TO  WRK-TOKNYUIN2-SRYCD(1)
                  MOVE  60             TO  WRK-JGN-NISSU(1)
                  MOVE  1              TO  WRK-SRYCD-COUNT
                  MOVE  0              TO  FLG-ROOM
             END-EVALUATE
           END-IF
      *
      *    特定入院料にヒットした場合のフラグセット
           IF        WRK-TOKNYUIN2-SRYCD(1)   NOT =   SPACE
               MOVE  1                 TO  FLG-HIT
           END-IF
      *
      *    算定上限日数をプラス計算で使用する為にマイナス１しておく
           IF    (WRK-JGN-NISSU(1)     >=     1)   AND
                 (WRK-JGN-NISSU(1)     <=   99998)
               COMPUTE  WRK-JGN-NISSU(1)  =   WRK-JGN-NISSU(1)   -  1
           END-IF
           IF    (WRK-JGN-NISSU(2)     >=     1)   AND
                 (WRK-JGN-NISSU(2)     <=   99998)
               COMPUTE  WRK-JGN-NISSU(2)  =   WRK-JGN-NISSU(2)   -  1
           END-IF
           IF    (WRK-JGN-NISSU(3)     >=     1)   AND
                 (WRK-JGN-NISSU(3)     <=   99998)
               COMPUTE  WRK-JGN-NISSU(3)  =   WRK-JGN-NISSU(3)   -  1
           END-IF
           IF    (WRK-JGN-NISSU(4)     >=     1)   AND
                 (WRK-JGN-NISSU(4)     <=   99998)
               COMPUTE  WRK-JGN-NISSU(4)  =   WRK-JGN-NISSU(4)   -  1
           END-IF
           IF    (WRK-JGN-NISSU(5)     >=     1)   AND
                 (WRK-JGN-NISSU(5)     <=   99998)
               COMPUTE  WRK-JGN-NISSU(5)  =   WRK-JGN-NISSU(5)   -  1
           END-IF
      *
      *    算定特定入院料が治療室単位以外である場合、既に算定済みの同一
      *    特定入院料について通算日数を算出する
           IF   FLG-ROOM      =    0
             INITIALIZE                      ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
             IF      WRK-TOKNYUIN2-SRYCD(1)  NOT =   SPACE
                MOVE WRK-TOKNYUIN2-SRYCD(1)  TO  STUSAN-TOKUTEI-SRYCD(1)
             END-IF
             IF      WRK-TOKNYUIN2-SRYCD(2)  NOT =   SPACE
                MOVE WRK-TOKNYUIN2-SRYCD(2)  TO  STUSAN-TOKUTEI-SRYCD(2)
             END-IF
             IF      WRK-TOKNYUIN2-SRYCD(3)  NOT =   SPACE
                MOVE WRK-TOKNYUIN2-SRYCD(3)  TO  STUSAN-TOKUTEI-SRYCD(3)
             END-IF
             IF      WRK-TOKNYUIN2-SRYCD(4)  NOT =   SPACE
                MOVE WRK-TOKNYUIN2-SRYCD(4)  TO  STUSAN-TOKUTEI-SRYCD(4)
             END-IF
             IF      WRK-TOKNYUIN2-SRYCD(5)  NOT =   SPACE
                MOVE WRK-TOKNYUIN2-SRYCD(5)  TO  STUSAN-TOKUTEI-SRYCD(5)
             END-IF
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
             CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                             SPA-AREA
             MOVE    STUSAN-NISSU09          TO  LNK-TOKNYUIN2-NISSU08
           END-IF
      *
      *    算定特定入院料が治療室単位である場合、既に算定済みの治療室
      *    単位の特定入院料について通算日数を算出する
           IF   FLG-ROOM      =    1
             PERFORM    201-TOKUTEI-ROOM-NISSU-SEC
           END-IF
      *
      *    歴作成で登録した入院履歴について「特定入院−通算対象日数」の
      *    入力分日数を加算する
           PERFORM    202-RRK-TOKUTEI-NISSU-SEC
      *
      *    以下２つの特定入院料は初回入院日（他院分は含めない）からの
      *    通算日数により算定を行う
      *    (A314)認知症治療病棟入院料１
      *    (A314)認知症治療病棟入院料２
           IF     LNK-TOKNYUIN2-SANTEIYMD   >=   "20160401"
              EVALUATE    LNK-TOKNYUIN2-SET-SRYCD
                WHEN      "190151610"
                WHEN      "190151710"
                INITIALIZE                      ORCSTUSANAREA
                MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
                MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
                MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
                CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                                SPA-AREA
                COMPUTE   LNK-TOKNYUIN2-NISSU08  =  STUSAN-NISSU03 +
                                                    STUSAN-TAINREL-NISSU
                IF      LNK-TOKNYUIN2-NISSU08   NOT =  ZERO
                     COMPUTE    LNK-TOKNYUIN2-NISSU08 =
                                LNK-TOKNYUIN2-NISSU08  -  1
                END-IF
             END-EVALUATE
           END-IF
      *
      *    改正により特定入院料の算定コードが変更になった入院料について
      *    従前の算定コードの日数も通算する必要がある為、通算日数の取得
      *    を変更（平成３０年改正）
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア病棟入院１
              WHEN      "190209110"
      *      (A308-3)地域包括ケア病棟入院１（生活療養）
              WHEN      "190209210"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア入院医療管理料１
              WHEN      "190209310"
      *      (A308-3)地域包括ケア入院医療管理料１（生活療養）
              WHEN      "190209410"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア病棟入院２
              WHEN      "190209510"
      *      (A308-3)地域包括ケア病棟入院２（生活療養）
              WHEN      "190209610"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア入院医療管理料２
              WHEN      "190209710"
      *      (A308-3)地域包括ケア入院医療管理料２（生活療養）
              WHEN      "190209810"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア病棟入院１（特定地域）
              WHEN      "190210710"
      *      (A308-3)地域包括ケア病棟入院１（生活療養）（特定地域）
              WHEN      "190210810"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア入院医療管理料１（特定地域）
              WHEN      "190210910"
      *      (A308-3)地域包括ケア入院医療管理料１（生活療養）（特定地域）
              WHEN      "190211010"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア病棟入院２（特定地域）
              WHEN      "190211110"
      *      (A308-3)地域包括ケア病棟入院２（生活療養）（特定地域）
              WHEN      "190211210"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア入院医療管理料２（特定地域）
              WHEN      "190211310"
      *      (A308-3)地域包括ケア入院医療管理料２（生活療養）（特定地域）
              WHEN      "190211410"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア病棟入院３
              WHEN      "190209910"
      *      (A308-3)地域包括ケア病棟入院３（生活療養）
              WHEN      "190210010"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア入院医療管理料３
              WHEN      "190210110"
      *      (A308-3)地域包括ケア入院医療管理料３（生活療養）
              WHEN      "190210210"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア病棟入院４
              WHEN      "190210310"
      *      (A308-3)地域包括ケア病棟入院４（生活療養）
              WHEN      "190210410"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア入院医療管理料４
              WHEN      "190210510"
      *      (A308-3)地域包括ケア入院医療管理料４（生活療養）
              WHEN      "190210610"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア病棟入院３（特定地域）
              WHEN      "190211510"
      *      (A308-3)地域包括ケア病棟入院３（生活療養）（特定地域）
              WHEN      "190211610"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア入院医療管理料３（特定地域）
              WHEN      "190211710"
      *      (A308-3)地域包括ケア入院医療管理料３（生活療養）（特定地域）
              WHEN      "190211810"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア病棟入院４（特定地域）
              WHEN      "190211910"
      *      (A308-3)地域包括ケア病棟入院４（生活療養）（特定地域）
              WHEN      "190212010"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A308-3)地域包括ケア入院医療管理料４（特定地域）
              WHEN      "190212110"
      *      (A308-3)地域包括ケア入院医療管理料４（生活療養）（特定地域）
              WHEN      "190212210"
                  PERFORM  201-CHIIKI-HOUKATSU-NISSU-SEC
                  MOVE  WRK-CHIIKI-HOUKATSU-NISSU
                                             TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A317)特定一般病棟入院料（地域包括ケア１）
              WHEN      "190213310"
             INITIALIZE                      ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
             MOVE    "190213310"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    "190182310"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    "190182410"             TO  STUSAN-TOKUTEI-SRYCD(3)
             CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                             SPA-AREA
             MOVE    STUSAN-NISSU09          TO  LNK-TOKNYUIN2-NISSU08
             ADD     WRK-TOKU-TAISYONISSU    TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A317)特定一般病棟入院料（地域包括ケア２）
              WHEN      "190213410"
             INITIALIZE                      ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
             MOVE    "190213410"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    "190182310"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    "190182410"             TO  STUSAN-TOKUTEI-SRYCD(3)
             CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                             SPA-AREA
             MOVE    STUSAN-NISSU09          TO  LNK-TOKNYUIN2-NISSU08
             ADD     WRK-TOKU-TAISYONISSU    TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A317)特定一般病棟入院料（地域包括ケア３）
              WHEN      "190213510"
             INITIALIZE                      ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
             MOVE    "190213510"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    "190182310"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    "190182410"             TO  STUSAN-TOKUTEI-SRYCD(3)
             CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                             SPA-AREA
             MOVE    STUSAN-NISSU09          TO  LNK-TOKNYUIN2-NISSU08
             ADD     WRK-TOKU-TAISYONISSU    TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A317)特定一般病棟入院料（地域包括ケア４）
              WHEN      "190213610"
             INITIALIZE                      ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
             MOVE    "190213610"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    "190182310"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    "190182410"             TO  STUSAN-TOKUTEI-SRYCD(3)
             CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                             SPA-AREA
             MOVE    STUSAN-NISSU09          TO  LNK-TOKNYUIN2-NISSU08
             ADD     WRK-TOKU-TAISYONISSU    TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
      *    施設基準変更により緩和ケア病棟入院料の１と２が混在する場合に
      *    特定入院料の算定コードが変更になった入院料について
      *    従前の算定コードの日数も通算する必要がある為、通算日数の取得
      *    を変更
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A310)緩和ケア病棟入院料１
              WHEN      "190028910"
             INITIALIZE                      ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
             MOVE    "190028910"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    "190150510"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    "190150610"             TO  STUSAN-TOKUTEI-SRYCD(3)
             MOVE    "190212710"             TO  STUSAN-TOKUTEI-SRYCD(4)
             MOVE    "190212810"             TO  STUSAN-TOKUTEI-SRYCD(5)
             MOVE    "190212910"             TO  STUSAN-TOKUTEI-SRYCD(6)
             CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                             SPA-AREA
             MOVE    STUSAN-NISSU09          TO  LNK-TOKNYUIN2-NISSU08
             ADD     WRK-TOKU-TAISYONISSU    TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
           EVALUATE  WRK-TOKNYUIN2-SRYCD(1)
      *      (A310)緩和ケア病棟入院料２
              WHEN      "190212710"
             INITIALIZE                      ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
             MOVE    "190028910"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    "190150510"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    "190150610"             TO  STUSAN-TOKUTEI-SRYCD(3)
             MOVE    "190212710"             TO  STUSAN-TOKUTEI-SRYCD(4)
             MOVE    "190212810"             TO  STUSAN-TOKUTEI-SRYCD(5)
             MOVE    "190212910"             TO  STUSAN-TOKUTEI-SRYCD(6)
             CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                             SPA-AREA
             MOVE    STUSAN-NISSU09          TO  LNK-TOKNYUIN2-NISSU08
             ADD     WRK-TOKU-TAISYONISSU    TO  LNK-TOKNYUIN2-NISSU08
           END-EVALUATE
      *
      *    特定入院料コードが１種類の場合
           IF    WRK-SRYCD-COUNT       =   1
                 MOVE   ZERO           TO  TN-IDX
                 IF     LNK-TOKNYUIN2-NISSU08    <=  WRK-JGN-NISSU(1)
                     ADD   1           TO  TN-IDX
      *              特定入院料コード（１）
                     MOVE  WRK-TOKNYUIN2-SRYCD(1)
                                       TO  LNK-TOKNYUIN2-SRYCD (TN-IDX)
      *              特定入院開始日（１）
                     MOVE   LNK-TOKNYUIN2-SANTEIYMD
                                       TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
      *              特定入院終了日（１）
                   IF    WRK-JGN-NISSU(1) =   99999
                     MOVE  "99999999"   TO  LNK-TOKNYUIN2-EDYMD (TN-IDX)
                   ELSE
                     MOVE     ZERO     TO  WRK-TOKUTEI-DAY
                     COMPUTE  WRK-TOKUTEI-DAY =  WRK-JGN-NISSU(1)  -
                                                 LNK-TOKNYUIN2-NISSU08
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   LNK-TOKNYUIN2-SANTEIYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE    WRK-TOKUTEI-DAY   TO  LNK-DAY6-ZOGEN
                     CALL    "ORCSDAY"         USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-TOKNYUIN2-EDYMD (TN-IDX)
      *              一般入院会計作成フラグと作成開始日のセット
                     MOVE    "1"     TO   LNK-TOKNYUIN2-IPN-KAIKEI-FLG
                     INITIALIZE                 STS-AREA-DAY
                     INITIALIZE                 LNK-DAY6-AREA
                     MOVE    "61"           TO  LNK-DAY6-IRAI
                     MOVE    LNK-TOKNYUIN2-EDYMD (TN-IDX)
                                            TO  LNK-DAY6-KIJUN
                     MOVE    "1"            TO  LNK-DAY6-ZOGENPTN
                     MOVE     1             TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                    LNK-DAY6-AREA
                     MOVE   LNK-DAY6-KEISAN TO
                                          LNK-TOKNYUIN2-IPN-KAIKEI-YMD
                   END-IF
                 END-IF
      *
           END-IF
      *
      *    特定入院料コードが２種類の場合
           IF    WRK-SRYCD-COUNT       =   2
                 MOVE   ZERO           TO  TN-IDX
                 IF     LNK-TOKNYUIN2-NISSU08    <=  WRK-JGN-NISSU(1)
                     ADD   1           TO  TN-IDX
      *              特定入院料コード（１）
                     MOVE  WRK-TOKNYUIN2-SRYCD(1)
                                       TO  LNK-TOKNYUIN2-SRYCD (TN-IDX)
      *              特定入院開始日（１）
                     MOVE   LNK-TOKNYUIN2-SANTEIYMD
                                       TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
      *              特定入院終了日（１）
                     MOVE     ZERO     TO  WRK-TOKUTEI-DAY
                     COMPUTE  WRK-TOKUTEI-DAY =  WRK-JGN-NISSU(1)  -
                                                 LNK-TOKNYUIN2-NISSU08
                     COMPUTE  WRK-TOKUTEI-DAY1 = WRK-TOKUTEI-DAY + 1
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   LNK-TOKNYUIN2-SANTEIYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE    WRK-TOKUTEI-DAY   TO  LNK-DAY6-ZOGEN
                     CALL    "ORCSDAY"         USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-TOKNYUIN2-EDYMD (TN-IDX)
                 END-IF
      *
                 IF     LNK-TOKNYUIN2-NISSU08    <=  WRK-JGN-NISSU(2)
      *
                   ADD    1   TO    TN-IDX
      *
      *            特定入院料コード（２）
                   MOVE   WRK-TOKNYUIN2-SRYCD(2)
                                        TO  LNK-TOKNYUIN2-SRYCD (TN-IDX)
      *            特定入院開始日（２）
                   INITIALIZE                 STS-AREA-DAY
                   INITIALIZE                 LNK-DAY6-AREA
                   MOVE    "61"           TO  LNK-DAY6-IRAI
                   IF      TN-IDX         =   2
                       MOVE    LNK-TOKNYUIN2-EDYMD (1)
                                          TO  LNK-DAY6-KIJUN
                       MOVE    "1"        TO  LNK-DAY6-ZOGENPTN
                       MOVE     1         TO  LNK-DAY6-ZOGEN
                       CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                      LNK-DAY6-AREA
                       MOVE    LNK-DAY6-KEISAN
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                   ELSE
                       MOVE    LNK-TOKNYUIN2-SANTEIYMD
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                   END-IF
      *            特定入院終了日（２）
                   IF    WRK-JGN-NISSU(2) =   99999
                     MOVE  "99999999"   TO  LNK-TOKNYUIN2-EDYMD (TN-IDX)
                   ELSE
                     MOVE     ZERO      TO  WRK-TOKUTEI-DAY
                     COMPUTE  WRK-TOKUTEI-DAY =  WRK-JGN-NISSU(2)  -
                                                 LNK-TOKNYUIN2-NISSU08 -
                                                 WRK-TOKUTEI-DAY1
                     INITIALIZE              STS-AREA-DAY
                     INITIALIZE              LNK-DAY6-AREA
                     MOVE    "61"            TO  LNK-DAY6-IRAI
                     MOVE    LNK-TOKNYUIN2-STYMD (TN-IDX)
                                             TO  LNK-DAY6-KIJUN
                     MOVE    "1"             TO  LNK-DAY6-ZOGENPTN
                     MOVE    WRK-TOKUTEI-DAY TO  LNK-DAY6-ZOGEN
                     CALL    "ORCSDAY"       USING   STS-AREA-DAY
                                                     LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-TOKNYUIN2-EDYMD (TN-IDX)
      *              一般入院会計作成フラグと作成開始日のセット
                     MOVE    "1"     TO   LNK-TOKNYUIN2-IPN-KAIKEI-FLG
                     INITIALIZE                 STS-AREA-DAY
                     INITIALIZE                 LNK-DAY6-AREA
                     MOVE    "61"           TO  LNK-DAY6-IRAI
                     MOVE    LNK-TOKNYUIN2-EDYMD (TN-IDX)
                                            TO  LNK-DAY6-KIJUN
                     MOVE    "1"            TO  LNK-DAY6-ZOGENPTN
                     MOVE     1             TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                    LNK-DAY6-AREA
                     MOVE   LNK-DAY6-KEISAN TO
                                          LNK-TOKNYUIN2-IPN-KAIKEI-YMD
                   END-IF
                 END-IF
           END-IF
      *
      *    特定入院料コードが３種類の場合
           IF    WRK-SRYCD-COUNT       =   3
                 MOVE   ZERO           TO  TN-IDX
                 IF     LNK-TOKNYUIN2-NISSU08    <=  WRK-JGN-NISSU(1)
                     ADD   1           TO  TN-IDX
      *              特定入院料コード（１）
                     MOVE  WRK-TOKNYUIN2-SRYCD(1)
                                       TO  LNK-TOKNYUIN2-SRYCD (TN-IDX)
      *              特定入院開始日（１）
                     MOVE   LNK-TOKNYUIN2-SANTEIYMD
                                       TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
      *              特定入院終了日（１）
                     MOVE     ZERO     TO  WRK-TOKUTEI-DAY
                     COMPUTE  WRK-TOKUTEI-DAY =  WRK-JGN-NISSU(1)  -
                                                 LNK-TOKNYUIN2-NISSU08
                     COMPUTE  WRK-TOKUTEI-DAY1 = WRK-TOKUTEI-DAY + 1
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   LNK-TOKNYUIN2-SANTEIYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE    WRK-TOKUTEI-DAY   TO  LNK-DAY6-ZOGEN
                     CALL    "ORCSDAY"         USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-TOKNYUIN2-EDYMD (TN-IDX)
                 END-IF
      *
                 IF     LNK-TOKNYUIN2-NISSU08    <=  WRK-JGN-NISSU(2)
      *
                   ADD    1   TO    TN-IDX
      *
      *            特定入院料コード（２）
                   MOVE   WRK-TOKNYUIN2-SRYCD(2)
                                        TO  LNK-TOKNYUIN2-SRYCD (TN-IDX)
      *            特定入院開始日（２）
                   INITIALIZE                 STS-AREA-DAY
                   INITIALIZE                 LNK-DAY6-AREA
                   MOVE    "61"           TO  LNK-DAY6-IRAI
                   IF      TN-IDX         =   2
                       MOVE    LNK-TOKNYUIN2-EDYMD (1)
                                          TO  LNK-DAY6-KIJUN
                       MOVE    "1"        TO  LNK-DAY6-ZOGENPTN
                       MOVE     1         TO  LNK-DAY6-ZOGEN
                       CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                      LNK-DAY6-AREA
                       MOVE    LNK-DAY6-KEISAN
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                   ELSE
                       MOVE    LNK-TOKNYUIN2-SANTEIYMD
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                   END-IF
      *            特定入院終了日（２）
                   MOVE     ZERO      TO  WRK-TOKUTEI-DAY
                   COMPUTE  WRK-TOKUTEI-DAY =  WRK-JGN-NISSU(2)  -
                                               LNK-TOKNYUIN2-NISSU08 -
                                               WRK-TOKUTEI-DAY1
      **             DISPLAY "=== KAKUNIN DISPLAY ==="
      **             DISPLAY  "WRK-JGN-NISSU(2) = " WRK-JGN-NISSU(2)
      **             DISPLAY  "LNK-TOKNYUIN2-NISSU08 = " 
      **                       LNK-TOKNYUIN2-NISSU08
      **             DISPLAY  "WRK-TOKUTEI-DAY1 = " WRK-TOKUTEI-DAY1
      **             DISPLAY  "WRK-TOKUTEI-DAY = " WRK-TOKUTEI-DAY
      **             DISPLAY "=== KAKUNIN DISPLAY END ==="
                   COMPUTE  WRK-TOKUTEI-DAY2 = WRK-TOKUTEI-DAY + 1
                   INITIALIZE              STS-AREA-DAY
                   INITIALIZE              LNK-DAY6-AREA
                   MOVE    "61"            TO  LNK-DAY6-IRAI
                   MOVE    LNK-TOKNYUIN2-STYMD (TN-IDX)
                                           TO  LNK-DAY6-KIJUN
                   MOVE    "1"             TO  LNK-DAY6-ZOGENPTN
                   MOVE    WRK-TOKUTEI-DAY TO  LNK-DAY6-ZOGEN
                   CALL    "ORCSDAY"       USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                   MOVE    LNK-DAY6-KEISAN
                                        TO LNK-TOKNYUIN2-EDYMD (TN-IDX)
                 END-IF
      *
                 IF     LNK-TOKNYUIN2-NISSU08    <=  WRK-JGN-NISSU(3)
      *
                   ADD    1   TO    TN-IDX
      *
      *            特定入院料コード（３）
                   MOVE   WRK-TOKNYUIN2-SRYCD(3)
                                        TO  LNK-TOKNYUIN2-SRYCD (TN-IDX)
      *            特定入院開始日（３）
                   INITIALIZE                 STS-AREA-DAY
                   INITIALIZE                 LNK-DAY6-AREA
                   MOVE    "61"           TO  LNK-DAY6-IRAI
                   EVALUATE  TN-IDX
                     WHEN  1
                       MOVE    LNK-TOKNYUIN2-SANTEIYMD
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                     WHEN  2
                       MOVE    LNK-TOKNYUIN2-EDYMD (1)
                                          TO  LNK-DAY6-KIJUN
                       MOVE    "1"        TO  LNK-DAY6-ZOGENPTN
                       MOVE     1         TO  LNK-DAY6-ZOGEN
                       CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                      LNK-DAY6-AREA
                       MOVE    LNK-DAY6-KEISAN
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                     WHEN  3
                       MOVE    LNK-TOKNYUIN2-EDYMD (2)
                                          TO  LNK-DAY6-KIJUN
                       MOVE    "1"        TO  LNK-DAY6-ZOGENPTN
                       MOVE     1         TO  LNK-DAY6-ZOGEN
                       CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                      LNK-DAY6-AREA
                       MOVE    LNK-DAY6-KEISAN
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                   END-EVALUATE
      *            特定入院終了日（３）
                   IF    WRK-JGN-NISSU(3) =   99999
                     MOVE  "99999999"   TO  LNK-TOKNYUIN2-EDYMD (TN-IDX)
                   ELSE
                     MOVE     ZERO      TO  WRK-TOKUTEI-DAY
                     COMPUTE  WRK-TOKUTEI-DAY =  WRK-JGN-NISSU(3)  -
                                                 LNK-TOKNYUIN2-NISSU08 -
                                                 WRK-TOKUTEI-DAY1  -
                                                 WRK-TOKUTEI-DAY2
                     INITIALIZE              STS-AREA-DAY
                     INITIALIZE              LNK-DAY6-AREA
                     MOVE    "61"            TO  LNK-DAY6-IRAI
                     MOVE    LNK-TOKNYUIN2-STYMD (TN-IDX)
                                             TO  LNK-DAY6-KIJUN
                     MOVE    "1"             TO  LNK-DAY6-ZOGENPTN
                     MOVE    WRK-TOKUTEI-DAY TO  LNK-DAY6-ZOGEN
                     CALL    "ORCSDAY"       USING   STS-AREA-DAY
                                                     LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-TOKNYUIN2-EDYMD (TN-IDX)
      *              一般入院会計作成フラグと作成開始日のセット
                     MOVE    "1"     TO   LNK-TOKNYUIN2-IPN-KAIKEI-FLG
                     INITIALIZE                 STS-AREA-DAY
                     INITIALIZE                 LNK-DAY6-AREA
                     MOVE    "61"           TO  LNK-DAY6-IRAI
                     MOVE    LNK-TOKNYUIN2-EDYMD (TN-IDX)
                                            TO  LNK-DAY6-KIJUN
                     MOVE    "1"            TO  LNK-DAY6-ZOGENPTN
                     MOVE     1             TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                    LNK-DAY6-AREA
                     MOVE   LNK-DAY6-KEISAN TO
                                          LNK-TOKNYUIN2-IPN-KAIKEI-YMD
                   END-IF
                 END-IF
           END-IF
      *
      *    特定入院料コードが４種類の場合
           IF    WRK-SRYCD-COUNT       =   4
                 MOVE   ZERO           TO  TN-IDX
                 IF     LNK-TOKNYUIN2-NISSU08    <=  WRK-JGN-NISSU(1)
                     ADD   1           TO  TN-IDX
      *              特定入院料コード（１）
                     MOVE  WRK-TOKNYUIN2-SRYCD(1)
                                       TO  LNK-TOKNYUIN2-SRYCD (TN-IDX)
      *              特定入院開始日（１）
                     MOVE   LNK-TOKNYUIN2-SANTEIYMD
                                       TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
      *              特定入院終了日（１）
                     MOVE     ZERO     TO  WRK-TOKUTEI-DAY
                     COMPUTE  WRK-TOKUTEI-DAY =  WRK-JGN-NISSU(1)  -
                                                 LNK-TOKNYUIN2-NISSU08
                     COMPUTE  WRK-TOKUTEI-DAY1 = WRK-TOKUTEI-DAY + 1
                     INITIALIZE                STS-AREA-DAY
                     INITIALIZE                LNK-DAY6-AREA
                     MOVE    "61"              TO  LNK-DAY6-IRAI
                     MOVE   LNK-TOKNYUIN2-SANTEIYMD
                                               TO  LNK-DAY6-KIJUN
                     MOVE    "1"               TO  LNK-DAY6-ZOGENPTN
                     MOVE    WRK-TOKUTEI-DAY   TO  LNK-DAY6-ZOGEN
                     CALL    "ORCSDAY"         USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-TOKNYUIN2-EDYMD (TN-IDX)
                 END-IF
      *
                 IF     LNK-TOKNYUIN2-NISSU08    <=  WRK-JGN-NISSU(2)
      *
                   ADD    1   TO    TN-IDX
      *
      *            特定入院料コード（２）
                   MOVE   WRK-TOKNYUIN2-SRYCD(2)
                                        TO  LNK-TOKNYUIN2-SRYCD (TN-IDX)
      *            特定入院開始日（２）
                   INITIALIZE                 STS-AREA-DAY
                   INITIALIZE                 LNK-DAY6-AREA
                   MOVE    "61"           TO  LNK-DAY6-IRAI
                   IF      TN-IDX         =   2
                       MOVE    LNK-TOKNYUIN2-EDYMD (1)
                                          TO  LNK-DAY6-KIJUN
                       MOVE    "1"        TO  LNK-DAY6-ZOGENPTN
                       MOVE     1         TO  LNK-DAY6-ZOGEN
                       CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                      LNK-DAY6-AREA
                       MOVE    LNK-DAY6-KEISAN
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                   ELSE
                       MOVE    LNK-TOKNYUIN2-SANTEIYMD
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                   END-IF
      *            特定入院終了日（２）
                   MOVE     ZERO      TO  WRK-TOKUTEI-DAY
                   COMPUTE  WRK-TOKUTEI-DAY =  WRK-JGN-NISSU(2)  -
                                               LNK-TOKNYUIN2-NISSU08 -
                                               WRK-TOKUTEI-DAY1
                   COMPUTE  WRK-TOKUTEI-DAY2 = WRK-TOKUTEI-DAY + 1
                   INITIALIZE              STS-AREA-DAY
                   INITIALIZE              LNK-DAY6-AREA
                   MOVE    "61"            TO  LNK-DAY6-IRAI
                   MOVE    LNK-TOKNYUIN2-STYMD (TN-IDX)
                                           TO  LNK-DAY6-KIJUN
                   MOVE    "1"             TO  LNK-DAY6-ZOGENPTN
                   MOVE    WRK-TOKUTEI-DAY TO  LNK-DAY6-ZOGEN
                   CALL    "ORCSDAY"       USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                   MOVE    LNK-DAY6-KEISAN
                                        TO LNK-TOKNYUIN2-EDYMD (TN-IDX)
                 END-IF
      *
                 IF     LNK-TOKNYUIN2-NISSU08    <=  WRK-JGN-NISSU(3)
      *
                   ADD    1   TO    TN-IDX
      *
      *            特定入院料コード（３）
                   MOVE   WRK-TOKNYUIN2-SRYCD(3)
                                        TO  LNK-TOKNYUIN2-SRYCD (TN-IDX)
      *            特定入院開始日（３）
                   INITIALIZE                 STS-AREA-DAY
                   INITIALIZE                 LNK-DAY6-AREA
                   MOVE    "61"           TO  LNK-DAY6-IRAI
                   EVALUATE  TN-IDX
                     WHEN  1
                       MOVE    LNK-TOKNYUIN2-SANTEIYMD
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                     WHEN  2
                       MOVE    LNK-TOKNYUIN2-EDYMD (1)
                                          TO  LNK-DAY6-KIJUN
                       MOVE    "1"        TO  LNK-DAY6-ZOGENPTN
                       MOVE     1         TO  LNK-DAY6-ZOGEN
                       CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                      LNK-DAY6-AREA
                       MOVE    LNK-DAY6-KEISAN
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                     WHEN  3
                       MOVE    LNK-TOKNYUIN2-EDYMD (2)
                                          TO  LNK-DAY6-KIJUN
                       MOVE    "1"        TO  LNK-DAY6-ZOGENPTN
                       MOVE     1         TO  LNK-DAY6-ZOGEN
                       CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                      LNK-DAY6-AREA
                       MOVE    LNK-DAY6-KEISAN
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                   END-EVALUATE
      *            特定入院終了日（３）
                   MOVE     ZERO      TO  WRK-TOKUTEI-DAY
                   COMPUTE  WRK-TOKUTEI-DAY =  WRK-JGN-NISSU(3)  -
                                               LNK-TOKNYUIN2-NISSU08 -
                                               WRK-TOKUTEI-DAY1  -
                                               WRK-TOKUTEI-DAY2
                   COMPUTE  WRK-TOKUTEI-DAY3 = WRK-TOKUTEI-DAY + 1
                   INITIALIZE              STS-AREA-DAY
                   INITIALIZE              LNK-DAY6-AREA
                   MOVE    "61"            TO  LNK-DAY6-IRAI
                   MOVE    LNK-TOKNYUIN2-STYMD (TN-IDX)
                                           TO  LNK-DAY6-KIJUN
                   MOVE    "1"             TO  LNK-DAY6-ZOGENPTN
                   MOVE    WRK-TOKUTEI-DAY TO  LNK-DAY6-ZOGEN
                   CALL    "ORCSDAY"       USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
                   MOVE    LNK-DAY6-KEISAN
                                      TO LNK-TOKNYUIN2-EDYMD (TN-IDX)
                 END-IF
      *
                 IF     LNK-TOKNYUIN2-NISSU08    <=  WRK-JGN-NISSU(4)
      *
                   ADD    1   TO    TN-IDX
      *
      *            特定入院料コード（４）
                   MOVE   WRK-TOKNYUIN2-SRYCD(4)
                                        TO  LNK-TOKNYUIN2-SRYCD (TN-IDX)
      *            特定入院開始日（４）
                   INITIALIZE                 STS-AREA-DAY
                   INITIALIZE                 LNK-DAY6-AREA
                   MOVE    "61"           TO  LNK-DAY6-IRAI
                   EVALUATE  TN-IDX
                     WHEN  1
                       MOVE    LNK-TOKNYUIN2-SANTEIYMD
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                     WHEN  2
                       MOVE    LNK-TOKNYUIN2-EDYMD (1)
                                          TO  LNK-DAY6-KIJUN
                       MOVE    "1"        TO  LNK-DAY6-ZOGENPTN
                       MOVE     1         TO  LNK-DAY6-ZOGEN
                       CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                      LNK-DAY6-AREA
                       MOVE    LNK-DAY6-KEISAN
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                     WHEN  3
                       MOVE    LNK-TOKNYUIN2-EDYMD (2)
                                          TO  LNK-DAY6-KIJUN
                       MOVE    "1"        TO  LNK-DAY6-ZOGENPTN
                       MOVE     1         TO  LNK-DAY6-ZOGEN
                       CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                      LNK-DAY6-AREA
                       MOVE    LNK-DAY6-KEISAN
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                     WHEN  4
                       MOVE    LNK-TOKNYUIN2-EDYMD (3)
                                          TO  LNK-DAY6-KIJUN
                       MOVE    "1"        TO  LNK-DAY6-ZOGENPTN
                       MOVE     1         TO  LNK-DAY6-ZOGEN
                       CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                      LNK-DAY6-AREA
                       MOVE    LNK-DAY6-KEISAN
                                        TO  LNK-TOKNYUIN2-STYMD (TN-IDX)
                   END-EVALUATE
      *            特定入院終了日（４）
                   IF    WRK-JGN-NISSU(4) =   99999
                     MOVE  "99999999"   TO  LNK-TOKNYUIN2-EDYMD (TN-IDX)
                   ELSE
                     MOVE     ZERO      TO  WRK-TOKUTEI-DAY
                     COMPUTE  WRK-TOKUTEI-DAY =  WRK-JGN-NISSU(4)  -
                                                 LNK-TOKNYUIN2-NISSU08 -
                                                 WRK-TOKUTEI-DAY1 -
                                                 WRK-TOKUTEI-DAY2 -
                                                 WRK-TOKUTEI-DAY3
                     INITIALIZE              STS-AREA-DAY
                     INITIALIZE              LNK-DAY6-AREA
                     MOVE    "61"            TO  LNK-DAY6-IRAI
                     MOVE    LNK-TOKNYUIN2-STYMD (TN-IDX)
                                             TO  LNK-DAY6-KIJUN
                     MOVE    "1"             TO  LNK-DAY6-ZOGENPTN
                     MOVE    WRK-TOKUTEI-DAY TO  LNK-DAY6-ZOGEN
                     CALL    "ORCSDAY"       USING   STS-AREA-DAY
                                                     LNK-DAY6-AREA
                     MOVE    LNK-DAY6-KEISAN
                                        TO LNK-TOKNYUIN2-EDYMD (TN-IDX)
      *              一般入院会計作成フラグと作成開始日のセット
                     MOVE    "1"     TO   LNK-TOKNYUIN2-IPN-KAIKEI-FLG
                     INITIALIZE                 STS-AREA-DAY
                     INITIALIZE                 LNK-DAY6-AREA
                     MOVE    "61"           TO  LNK-DAY6-IRAI
                     MOVE    LNK-TOKNYUIN2-EDYMD (TN-IDX)
                                            TO  LNK-DAY6-KIJUN
                     MOVE    "1"            TO  LNK-DAY6-ZOGENPTN
                     MOVE     1             TO  LNK-DAY6-ZOGEN
                     CALL  "ORCSDAY"        USING   STS-AREA-DAY
                                                    LNK-DAY6-AREA
                     MOVE   LNK-DAY6-KEISAN TO
                                          LNK-TOKNYUIN2-IPN-KAIKEI-YMD
                   END-IF
                 END-IF
           END-IF
      *
           DISPLAY   "TN-IDX = " TN-IDX
      *    特定入院期間を経過した際の一般入院会計作成用のフラグ設定
           EVALUATE   LNK-TOKNYUIN2-IDOKBN
               WHEN   "1"
                   MOVE    LNK-TOKNYUIN2-SANTEIYMD
                                              TO WRK-IPN-HANTEI-YMD1
                   IF      WRK-IPN-HANTEI-M1   =   12
                         ADD    1     TO      WRK-IPN-HANTEI-Y1
                         MOVE   1     TO      WRK-IPN-HANTEI-M1
                   ELSE
                         ADD    1     TO      WRK-IPN-HANTEI-M1
                   END-IF
               WHEN   "2"
                   MOVE    LNK-TOKNYUIN2-SANTEIYMD
                                              TO WRK-IPN-HANTEI-YMD1
           END-EVALUATE
      *    月末日を算定
           INITIALIZE                STS-AREA-DAY
           INITIALIZE                LNK-DAY7-AREA
           MOVE    "71"              TO  LNK-DAY7-IRAI
           MOVE   WRK-IPN-HANTEI-YM1 TO  LNK-DAY7-YM
           CALL  "ORCSDAY"           USING   STS-AREA-DAY
                                             LNK-DAY7-AREA
           MOVE    LNK-DAY7-KOYOMI   TO      WRK-IPN-HANTEI-YMD1
      *    特定入院料の終了日付をセット
           IF     TN-IDX      NOT =     ZERO
               MOVE    LNK-TOKNYUIN2-EDYMD(TN-IDX)
                                     TO      WRK-IPN-HANTEI-YMD2
           ELSE
               MOVE    "00000000"    TO      WRK-IPN-HANTEI-YMD2
           END-IF
      *    一般入院会計作成用のフラグ設定
           DISPLAY "WRK-IPN-HANTEI-YMD1 = " WRK-IPN-HANTEI-YMD1
           DISPLAY "WRK-IPN-HANTEI-YMD2 = " WRK-IPN-HANTEI-YMD2
           IF    WRK-IPN-HANTEI-YMD1    >   WRK-IPN-HANTEI-YMD2
               MOVE    "1"        TO     LNK-TOKNYUIN2-IPN-KAIKEI-FLG
               IF    WRK-IPN-HANTEI-YMD2   =   "00000000"
                   MOVE   LNK-TOKNYUIN2-SANTEIYMD
                                  TO     LNK-TOKNYUIN2-IPN-KAIKEI-YMD
               END-IF
           ELSE
               MOVE    SPACE      TO     LNK-TOKNYUIN2-IPN-KAIKEI-FLG
                                         LNK-TOKNYUIN2-IPN-KAIKEI-YMD
           END-IF
      *
           IF        FLG-HIT    =    ZERO
               MOVE    SPACE      TO     LNK-TOKNYUIN2-IPN-KAIKEI-FLG
                                         LNK-TOKNYUIN2-IPN-KAIKEI-YMD
           END-IF
      *
      *    療養病棟（病床）の入院時は特定入院料算定後の一般入院会計は
      *    作成しない
           IF     LNK-TOKNYUIN2-TOKUBETSU-FLG(2)    =    "1"
               MOVE    SPACE      TO     LNK-TOKNYUIN2-IPN-KAIKEI-FLG
                                         LNK-TOKNYUIN2-IPN-KAIKEI-YMD
           END-IF
      *
           DISPLAY  "====  ORCSTOKNYUIN2 HENKYAKU  ===="
           DISPLAY  "LNK-TOKNYUIN2-SRYCD(1) = " LNK-TOKNYUIN2-SRYCD(1)
                 " " LNK-TOKNYUIN2-STYMD(1) " " LNK-TOKNYUIN2-EDYMD(1)
           DISPLAY  "LNK-TOKNYUIN2-SRYCD(2) = " LNK-TOKNYUIN2-SRYCD(2)
                 " " LNK-TOKNYUIN2-STYMD(2) " " LNK-TOKNYUIN2-EDYMD(2)
           DISPLAY  "LNK-TOKNYUIN2-SRYCD(3) = " LNK-TOKNYUIN2-SRYCD(3)
                 " " LNK-TOKNYUIN2-STYMD(3) " " LNK-TOKNYUIN2-EDYMD(3)
           DISPLAY  "LNK-TOKNYUIN2-SRYCD(4) = " LNK-TOKNYUIN2-SRYCD(4)
                 " " LNK-TOKNYUIN2-STYMD(4) " " LNK-TOKNYUIN2-EDYMD(4)
           DISPLAY  "LNK-TOKNYUIN2-SRYCD(5) = " LNK-TOKNYUIN2-SRYCD(5)
                 " " LNK-TOKNYUIN2-STYMD(5) " " LNK-TOKNYUIN2-EDYMD(5)
           DISPLAY  "LNK-TOKNYUIN2-IPN-KAIKEI-FLG = "
                     LNK-TOKNYUIN2-IPN-KAIKEI-FLG
           DISPLAY  "LNK-TOKNYUIN2-IPN-KAIKEI-YMD = "
                     LNK-TOKNYUIN2-IPN-KAIKEI-YMD
      *
           IF   LNK-TOKNYUIN2-SRYCD(1)  =      SPACE
               MOVE    1                TO     LNK-TOKNYUIN2-RC
           END-IF
           IF     FLG-HIT     =    ZERO
                  MOVE    2             TO     LNK-TOKNYUIN2-RC
           END-IF
      *
      *
           .
       200-EDIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    治療室単位の特定入院料通算日数（平成２６年４月１日以降）
      *****************************************************************
       201-TOKUTEI-ROOM-NISSU-SEC                    SECTION.
      *
           MOVE   ZERO                  TO  WRK-TOKUTEI-ROOM-NISSU
      *
           IF    LNK-TOKNYUIN2-NISSU08   NOT =    ZERO
      *     (A300)救命救急入院料１
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190024510"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190128610"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE   "190074510"             TO  STUSAN-TOKUTEI-SRYCD(3)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A300)救命救急入院料２
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190024310"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190128710"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE   "190024410"             TO  STUSAN-TOKUTEI-SRYCD(3)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A300)救命救急入院料３（救命救急入院料）
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190138110"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190138210"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE   "190138310"             TO  STUSAN-TOKUTEI-SRYCD(3)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A300)救命救急入院料３（広範囲熱傷特定集中治療）
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190138410"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190138510"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE   "190138610"             TO  STUSAN-TOKUTEI-SRYCD(3)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A300)救命救急入院料４（救命救急入院料）
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190138710"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190138810"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE   "190138910"             TO  STUSAN-TOKUTEI-SRYCD(3)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A300)救命救急入院料４（広範囲熱傷特定集中治療）
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190139010"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190139110"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE   "190139210"             TO  STUSAN-TOKUTEI-SRYCD(3)
             MOVE   "190139310"             TO  STUSAN-TOKUTEI-SRYCD(4)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A301)特定集中治療室管理料１
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190174410"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190174510"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A301)特定集中治療室管理料２（特定集中治療室管理料）
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190174610"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190174710"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A301)特定集中治療室管理料２（広範囲熱傷特定集中治療）
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190174810"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190174910"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A301)特定集中治療室管理料３
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190116310"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190116410"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A301)特定集中治療室管理料４（特定集中治療室管理料）
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190139810"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190139910"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A301)特定集中治療室管理料４（広範囲熱傷特定集中治療）
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190140010"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190140110"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A301-2)ハイケアユニット入院医療管理料１
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190175010"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A301-2)ハイケアユニット入院医療管理料２
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190175110"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A301-2)ハイケアユニット入院医療管理料
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190117310"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A301-3)脳卒中ケアユニット入院医療管理料
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190120810"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A301-4)小児特定集中治療室管理料
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190149910"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190150010"             TO  STUSAN-TOKUTEI-SRYCD(2)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A302)新生児特定集中治療室管理料１
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190024710"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A302)新生児特定集中治療室管理料２
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190140410"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A303)総合周産期特定集中治療室管理料（母体・胎児）
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190066710"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A303)総合周産期特定集中治療室管理料（新生児）
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190066810"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A303-2)新生児治療回復室入院医療管理料
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190140510"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *     (A305)一類感染症患者入院医療管理料
             INITIALIZE                         ORCSTUSANAREA
             MOVE    LNK-TOKNYUIN2-HOSPNUM  TO  STUSAN-HOSPNUM
             MOVE    LNK-TOKNYUIN2-PTID     TO  STUSAN-PTID
             MOVE   "190075510"             TO  STUSAN-TOKUTEI-SRYCD(1)
             MOVE   "190075610"             TO  STUSAN-TOKUTEI-SRYCD(2)
      *      平成２８年度改正で診療行為コード変更
             MOVE   "190194310"             TO  STUSAN-TOKUTEI-SRYCD(3)
             MOVE   "190194410"             TO  STUSAN-TOKUTEI-SRYCD(4)
             MOVE    LNK-TOKNYUIN2-SANTEIYMD TO STUSAN-KJNYMD
             CALL   "ORCSTUSAN"          USING  ORCSTUSANAREA
                                                SPA-AREA
             ADD     STUSAN-NISSU07         TO  WRK-TOKUTEI-ROOM-NISSU
      *
             MOVE    WRK-TOKUTEI-ROOM-NISSU TO  LNK-TOKNYUIN2-NISSU08
           END-IF
           .
       201-TOKUTEI-ROOM-NISSU-EXT.
           EXIT.
      *
      *****************************************************************
      *  （平成３０年４月１日以降）
      *    地域包括ケア病棟入院料、地域包括ケア入院医療管理料の
      *    通算日数取得
      *    ※平成３０年３月３１日までの算定コードもカウントすること
      *****************************************************************
       201-CHIIKI-HOUKATSU-NISSU-SEC                    SECTION.
      *
           MOVE   ZERO                  TO  WRK-CHIIKI-HOUKATSU-NISSU
           MOVE   ZERO                  TO  FLG-KAIGO
      *
      *    最終の入院履歴が介護からの異動（急性増悪）によるものか
      *    判定用に入院履歴の読み込み
           INITIALIZE                       PTNYUINRRK-REC
           MOVE    LNK-TOKNYUIN2-HOSPNUM
                                        TO  PTNYUINRRK-HOSPNUM
           MOVE    LNK-TOKNYUIN2-PTID   TO  PTNYUINRRK-PTID
           MOVE    PTNYUINRRK-REC       TO  MCPDATA-REC
           MOVE    "tbl_ptnyuinrrk"     TO  MCP-TABLE
           MOVE    "key9"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC               =   ZERO
               MOVE    "tbl_ptnyuinrrk" TO  MCP-TABLE
               MOVE    "key9"           TO  MCP-PATHNAME
               PERFORM 920-PTNYUINRRK-FETCH-SEC
               IF     FLG-PTNYUINRRK    =   ZERO
                   IF   PTNYUINRRK-KAIGOKBN   =   "2"
                       MOVE   1         TO  FLG-KAIGO
                   END-IF
               END-IF
           END-IF
      *
           MOVE    "tbl_ptnyuinrrk"       TO   MCP-TABLE
           MOVE    "key9"                TO   MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           DISPLAY "*******CHIIKI-HOUKATSU-NISSU****************"
           DISPLAY "PTNYUINRRK-RRKNUM = " PTNYUINRRK-RRKNUM
           DISPLAY "PTNYUINRRK-RRKEDANUM = " PTNYUINRRK-RRKEDANUM
           DISPLAY "PTNYUINRRK-KAIGOKBN = " PTNYUINRRK-KAIGOKBN
      *
      *    (A308-3)地域包括ケア病棟入院１
      *    (A308-3)地域包括ケア病棟入院１（生活療養）
      *    (A308-3)地域包括ケア病棟入院２
      *    (A308-3)地域包括ケア病棟入院２（生活療養）
           INITIALIZE                      ORCSTUSANAREA
           MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
           MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
           MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
      *    地域包括ケア病棟入院１
           MOVE    "190209110"             TO  STUSAN-TOKUTEI-SRYCD(1)
           MOVE    "190209210"             TO  STUSAN-TOKUTEI-SRYCD(2)
           MOVE    "190175310"             TO  STUSAN-TOKUTEI-SRYCD(3)
           MOVE    "190175410"             TO  STUSAN-TOKUTEI-SRYCD(4)
      *    地域包括ケア病棟入院２
           MOVE    "190209510"             TO  STUSAN-TOKUTEI-SRYCD(5)
           MOVE    "190209610"             TO  STUSAN-TOKUTEI-SRYCD(6)
           MOVE    "190175710"             TO  STUSAN-TOKUTEI-SRYCD(7)
           MOVE    "190175810"             TO  STUSAN-TOKUTEI-SRYCD(8)
      *
           CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                           SPA-AREA
           IF      FLG-KAIGO               =   ZERO
               ADD     STUSAN-NISSU09      TO  WRK-CHIIKI-HOUKATSU-NISSU
           ELSE
               ADD     STUSAN-NISSU07      TO  WRK-CHIIKI-HOUKATSU-NISSU
           END-IF
      *
      *    (A308-3)地域包括ケア入院医療管理料１
      *    (A308-3)地域包括ケア入院医療管理料１（生活療養）
      *    (A308-3)地域包括ケア入院医療管理料２
      *    (A308-3)地域包括ケア入院医療管理料２（生活療養）
           INITIALIZE                      ORCSTUSANAREA
           MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
           MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
           MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
      *    地域包括ケア入院医療管理料１
           MOVE    "190209310"             TO  STUSAN-TOKUTEI-SRYCD(1)
           MOVE    "190209410"             TO  STUSAN-TOKUTEI-SRYCD(2)
           MOVE    "190175510"             TO  STUSAN-TOKUTEI-SRYCD(3)
           MOVE    "190175610"             TO  STUSAN-TOKUTEI-SRYCD(4)
      *    地域包括ケア入院医療管理料２
           MOVE    "190209710"             TO  STUSAN-TOKUTEI-SRYCD(5)
           MOVE    "190209810"             TO  STUSAN-TOKUTEI-SRYCD(6)
           MOVE    "190175910"             TO  STUSAN-TOKUTEI-SRYCD(7)
           MOVE    "190176010"             TO  STUSAN-TOKUTEI-SRYCD(8)
           CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                           SPA-AREA
           IF      FLG-KAIGO               =   ZERO
               ADD     STUSAN-NISSU09      TO  WRK-CHIIKI-HOUKATSU-NISSU
           ELSE
               ADD     STUSAN-NISSU07      TO  WRK-CHIIKI-HOUKATSU-NISSU
           END-IF
      *
      *    (A308-3)地域包括ケア病棟入院１（特定地域）
      *    (A308-3)地域包括ケア病棟入院１（生活療養）（特定地域）
           INITIALIZE                      ORCSTUSANAREA
           MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
           MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
           MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
           MOVE    "190210710"             TO  STUSAN-TOKUTEI-SRYCD(1)
           MOVE    "190210810"             TO  STUSAN-TOKUTEI-SRYCD(2)
           MOVE    "190176110"             TO  STUSAN-TOKUTEI-SRYCD(3)
           MOVE    "190176210"             TO  STUSAN-TOKUTEI-SRYCD(4)
           CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                           SPA-AREA
           IF      FLG-KAIGO               =   ZERO
               ADD     STUSAN-NISSU09      TO  WRK-CHIIKI-HOUKATSU-NISSU
           ELSE
               ADD     STUSAN-NISSU07      TO  WRK-CHIIKI-HOUKATSU-NISSU
           END-IF
      *
      *    (A308-3)地域包括ケア病棟入院２（特定地域）
      *    (A308-3)地域包括ケア病棟入院２（生活療養）（特定地域）
           INITIALIZE                      ORCSTUSANAREA
           MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
           MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
           MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
           MOVE    "190211110"             TO  STUSAN-TOKUTEI-SRYCD(1)
           MOVE    "190211210"             TO  STUSAN-TOKUTEI-SRYCD(2)
           MOVE    "190176510"             TO  STUSAN-TOKUTEI-SRYCD(3)
           MOVE    "190176610"             TO  STUSAN-TOKUTEI-SRYCD(4)
           CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                           SPA-AREA
           IF      FLG-KAIGO               =   ZERO
               ADD     STUSAN-NISSU09      TO  WRK-CHIIKI-HOUKATSU-NISSU
           ELSE
               ADD     STUSAN-NISSU07      TO  WRK-CHIIKI-HOUKATSU-NISSU
           END-IF
      *
      *    (A308-3)地域包括ケア入院医療管理料１（特定地域）
      *    (A308-3)地域包括ケア入院医療管理料１（生活療養）（特定地域）
           INITIALIZE                      ORCSTUSANAREA
           MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
           MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
           MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
           MOVE    "190210910"             TO  STUSAN-TOKUTEI-SRYCD(1)
           MOVE    "190211010"             TO  STUSAN-TOKUTEI-SRYCD(2)
           MOVE    "190176310"             TO  STUSAN-TOKUTEI-SRYCD(3)
           MOVE    "190176410"             TO  STUSAN-TOKUTEI-SRYCD(4)
           CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                           SPA-AREA
           IF      FLG-KAIGO               =   ZERO
               ADD     STUSAN-NISSU09      TO  WRK-CHIIKI-HOUKATSU-NISSU
           ELSE
               ADD     STUSAN-NISSU07      TO  WRK-CHIIKI-HOUKATSU-NISSU
           END-IF
      *
      *    (A308-3)地域包括ケア入院医療管理料２（特定地域）
      *    (A308-3)地域包括ケア入院医療管理料２（生活療養）（特定地域）
           INITIALIZE                      ORCSTUSANAREA
           MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
           MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
           MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
           MOVE    "190211310"             TO  STUSAN-TOKUTEI-SRYCD(1)
           MOVE    "190211410"             TO  STUSAN-TOKUTEI-SRYCD(2)
           MOVE    "190176710"             TO  STUSAN-TOKUTEI-SRYCD(3)
           MOVE    "190176810"             TO  STUSAN-TOKUTEI-SRYCD(4)
           CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                           SPA-AREA
           IF      FLG-KAIGO               =   ZERO
               ADD     STUSAN-NISSU09      TO  WRK-CHIIKI-HOUKATSU-NISSU
           ELSE
               ADD     STUSAN-NISSU07      TO  WRK-CHIIKI-HOUKATSU-NISSU
           END-IF
      *
      *    (A308-3)地域包括ケア病棟入院３
      *    (A308-3)地域包括ケア病棟入院３（生活療養）
      *    (A308-3)地域包括ケア入院医療管理料３
      *    (A308-3)地域包括ケア入院医療管理料３（生活療養）
      *    (A308-3)地域包括ケア病棟入院４
      *    (A308-3)地域包括ケア病棟入院４（生活療養）
      *    (A308-3)地域包括ケア入院医療管理料４
      *    (A308-3)地域包括ケア入院医療管理料４（生活療養）
           INITIALIZE                      ORCSTUSANAREA
           MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
           MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
           MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
           MOVE    "190209910"             TO  STUSAN-TOKUTEI-SRYCD(1)
           MOVE    "190210010"             TO  STUSAN-TOKUTEI-SRYCD(2)
           MOVE    "190210110"             TO  STUSAN-TOKUTEI-SRYCD(3)
           MOVE    "190210210"             TO  STUSAN-TOKUTEI-SRYCD(4)
           MOVE    "190210310"             TO  STUSAN-TOKUTEI-SRYCD(5)
           MOVE    "190210410"             TO  STUSAN-TOKUTEI-SRYCD(6)
           MOVE    "190210510"             TO  STUSAN-TOKUTEI-SRYCD(7)
           MOVE    "190210610"             TO  STUSAN-TOKUTEI-SRYCD(8)
           CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                           SPA-AREA
           IF      FLG-KAIGO               =   ZERO
               ADD     STUSAN-NISSU09      TO  WRK-CHIIKI-HOUKATSU-NISSU
           ELSE
               ADD     STUSAN-NISSU07      TO  WRK-CHIIKI-HOUKATSU-NISSU
           END-IF
      *
      *    (A308-3)地域包括ケア病棟入院３（特定地域）
      *    (A308-3)地域包括ケア病棟入院３（生活療養）（特定地域）
      *    (A308-3)地域包括ケア入院医療管理料３（特定地域）
      *    (A308-3)地域包括ケア入院医療管理料３（生活療養）（特定地域）
      *    (A308-3)地域包括ケア病棟入院４（特定地域）
      *    (A308-3)地域包括ケア病棟入院４（生活療養）（特定地域）
      *    (A308-3)地域包括ケア入院医療管理料４（特定地域）
      *    (A308-3)地域包括ケア入院医療管理料４（生活療養）（特定地域）
           INITIALIZE                      ORCSTUSANAREA
           MOVE    LNK-TOKNYUIN2-HOSPNUM   TO  STUSAN-HOSPNUM
           MOVE    LNK-TOKNYUIN2-PTID      TO  STUSAN-PTID
           MOVE    LNK-TOKNYUIN2-SANTEIYMD TO  STUSAN-KJNYMD
           MOVE    "190211510"             TO  STUSAN-TOKUTEI-SRYCD(1)
           MOVE    "190211610"             TO  STUSAN-TOKUTEI-SRYCD(2)
           MOVE    "190211710"             TO  STUSAN-TOKUTEI-SRYCD(3)
           MOVE    "190211810"             TO  STUSAN-TOKUTEI-SRYCD(4)
           MOVE    "190211910"             TO  STUSAN-TOKUTEI-SRYCD(5)
           MOVE    "190212010"             TO  STUSAN-TOKUTEI-SRYCD(6)
           MOVE    "190212110"             TO  STUSAN-TOKUTEI-SRYCD(7)
           MOVE    "190212210"             TO  STUSAN-TOKUTEI-SRYCD(8)
           CALL    "ORCSTUSAN"     USING   ORCSTUSANAREA
                                           SPA-AREA
           IF      FLG-KAIGO               =   ZERO
               ADD     STUSAN-NISSU09      TO  WRK-CHIIKI-HOUKATSU-NISSU
           ELSE
               ADD     STUSAN-NISSU07      TO  WRK-CHIIKI-HOUKATSU-NISSU
           END-IF
      *
           ADD     WRK-TOKU-TAISYONISSU    TO  WRK-CHIIKI-HOUKATSU-NISSU
      *
           .
       201-CHIIKI-HOUKATSU-NISSU-EXT.
           EXIT.
      *
      *****************************************************************
      *    歴作成で登録した入院履歴について「特定入院−通算対象日数」の
      *    入力分日数を加算する
      *****************************************************************
       202-RRK-TOKUTEI-NISSU-SEC                    SECTION.
      *
           MOVE    ZERO                 TO  WRK-TOKU-TAISYONISSU
           INITIALIZE                       PTNYUINRRK-REC
           MOVE    LNK-TOKNYUIN2-HOSPNUM
                                        TO  PTNYUINRRK-HOSPNUM
           MOVE    LNK-TOKNYUIN2-PTID   TO  PTNYUINRRK-PTID
           MOVE    LNK-TOKNYUIN2-SHONUM TO  PTNYUINRRK-SHONUM
           MOVE    PTNYUINRRK-REC       TO  MCPDATA-REC
           MOVE    "tbl_ptnyuinrrk"     TO  MCP-TABLE
           MOVE    "key65"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC               =   ZERO
               MOVE    "tbl_ptnyuinrrk" TO  MCP-TABLE
               MOVE    "key65"          TO  MCP-PATHNAME
               PERFORM 920-PTNYUINRRK-FETCH-SEC
               PERFORM    UNTIL   FLG-PTNYUINRRK  =   1
      *
                  IF      PTNYUINRRK-TOKU-TAISYONISSU  NOT =  ZERO
                      ADD PTNYUINRRK-TOKU-TAISYONISSU  TO
                          LNK-TOKNYUIN2-NISSU08
                      ADD PTNYUINRRK-TOKU-TAISYONISSU  TO
                          WRK-TOKU-TAISYONISSU
                  END-IF
      *
                  MOVE    "tbl_ptnyuinrrk" TO  MCP-TABLE
                  MOVE    "key65"          TO  MCP-PATHNAME
                  PERFORM 920-PTNYUINRRK-FETCH-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_ptnyuinrrk"       TO   MCP-TABLE
           MOVE    "key65"                TO   MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           .
       202-RRK-TOKUTEI-NISSU-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者個別設定テーブル読込処理
      *****************************************************************
       900-PTCONF-READ-SEC         SECTION.
      *
           MOVE    PTCONF-REC          TO  MCPDATA-REC
           MOVE    "tbl_ptconf"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC          =   ZERO
                   MOVE    MCPDATA-REC TO  PTCONF-REC
                   MOVE    ZERO        TO  FLG-PTCONF
               ELSE
                   INITIALIZE              PTCONF-REC
                   MOVE    1           TO  FLG-PTCONF
               END-IF
           ELSE
               INITIALIZE                  PTCONF-REC
               MOVE    1               TO  FLG-PTCONF
           END-IF
      *
           MOVE    "tbl_ptconf"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           .
       900-PTCONF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    テーブル検索処理
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"      TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    ＤＢ読み込み処理
      *****************************************************************
       920-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       920-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者入院履歴マスター読込
      *****************************************************************
       920-PTNYUINRRK-FETCH-SEC     SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
               MOVE    ZERO            TO  FLG-PTNYUINRRK
           ELSE
               INITIALIZE                  PTNYUINRRK-REC
               MOVE    1               TO  FLG-PTNYUINRRK
           END-IF.
      *
       920-PTNYUINRRK-FETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢクロース処理
      *****************************************************************
       990-DBCLOSE-SEC         SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       990-DBCLOSE-EXT.
           EXIT.
      *
