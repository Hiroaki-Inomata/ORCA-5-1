      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCR0830.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ¥ì¥»¥×¥ÈÆþ±¡¡ÊÏ«ºÒ¡¦¼«ÇåÀÕ¡Ë
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ¿ÇÎÅ¼ÂÆü¿ôÊÔ½¸¡ÊÏ«ºÒ¡¦¼«ÇåÀÕ¡Ë
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  03/06/17    NaCl¡ÝÌçÏÆ    ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *  01.00.01    NACL-ÌçÏÆ    04.01.21  Ï«ºÒ¤ÎÆÃÄê´ïºà(09593)ÂÐ±þ
      *  01.00.02    NACL-ÌçÏÆ    04.01.21  Ï«ºÒ¡¦¼«ÇåÀÕ¤ÎÆþ±¡¼¼ÎÁ²Ã»»
      *                                     (09594)ÂÐ±þ
      *  01.00.03    NACL-ÌçÏÆ    04.10.15  ¼«ÇåÀÕÆÃÄê´ïºàÅù¾ÃÈñÀÇÂÐ±þ
      *  Ãæ»ß½èÍýÄÉ²Ã
      *  01.01.01    NACL-Æ£¸¶    04/10/13  Ãæ»ß½èÍý¤ÎÄÉ²Ã
      *  01.01.02    NACL-ÌçÏÆ    04/12/17  ¶»Éô¸ÇÄêÂÓ²Ã»»¡¢ÁÏ³°¸ÇÄê´ï
      *                                     »ÈÍÑ²Ã»»¤òÌôºÞÅù¤Ø
      *  01.01.03    NACL-ÌçÏÆ    05/01/26  ¥·¥¹¥Æ¥à´ÉÍý£´£°£°£±¤Ë´Ø¤¹¤ë½¤Àµ
      *  01.01.04    NACL-ÌçÏÆ    05/01/27  ¹ø¡¦¶»Éô¸ÇÄêÂÓ²Ã»»¡¢ÁÏ³°¸ÇÄê´ï
      *                                     »ÈÍÑ²Ã»»¤Îµ»½Ñ¡¦ÌôºÞÅù¤ÎÁªÂòÂÐ±þ
      *  01.01.05    NACL-ÌçÏÆ    05/03/03  ¿©»ö¤Ë´Ø¤¹¤ëÊÔ½¸½¤Àµ
      *  01.01.06    NACL-ÌçÏÆ    05/05/16  ÎÅÍÜÃ´Åö¼êÅö¡ÊËÌ³¤Æ»¡ËÂÐ±þ
      *  01.01.07    NACL-ÌçÏÆ    05.09.06  ¼«ÇåÀÕ½¾ÍèÍÍ¼°ÂÐ±þ
      *  01.01.08    NACL-ÌçÏÆ    05.10.06  ¿Ç¶è£¹£µ£¹£¶ÂÐ±þ
      *  02.09.01    NACL-ÌçÏÆ    06/04/13  £²£°£°£¶Ç¯£´·î²þÀµÂÐ±þ
      *  03.01.01    NACL-ÌçÏÆ    06/06/28  ¼ÂÆü¿ô¸º»»¥³¡¼¥ÉÂÐ±þ
      *  03.04.01    NACL-ÌçÏÆ    06/12/01  ¼«ÇåÀÕ·òÊÝ½àµòÂÐ±þ
      *  03.04.02    NACL-ÌçÏÆ    07/03/12  Êñ³ç¿ÇÎÅÂÐ±þ
      *
      *  03.05.01    NACL-ÌçÏÆ    07/06/01  ¥°¥ë¡¼¥×¿ÇÎÅÂÐ±þ
      *  03.05.02    NACL-Æ£¸¶    07/06/01  realtime preview ½èÍýÄÉ²Ã
      *  03.05.03    NACL-ÌçÏÆ    07/07/17  ¸ÄÊÌ»þ¤Î¥·¥¹¥Æ¥à´ÉÍýÊÔ½¸½¤Àµ
      *  04.01.01    NACL-ÌçÏÆ    07/11/01  ¸øÌ³ºÒ³²ÂÐ±þ
      *  04.01.02    NACL-ÌçÏÆ    07/12/19  Æþ±¡ÎÁÌ¤»»ÄêÆüÂÐ±þ
      *  04.02.01    NACL-ÌçÏÆ    08/03/24  Ê¿À®£²£°Ç¯£´·î²þÀµÂÐ±þ
      *                                     ¡ÊºÆ½¢Ï«¡§±ßÊÑ¹¹ÂÐ±þ¡Ë
      *  04.02.02    NACL-ÌçÏÆ    08/05/08  ÅÀÅ©£³£³£²¤Î¼êµ»ÎÁÊÔ½¸
      *  04.02.03    NACL-ÌçÏÆ    08/06/17  Æþ±¡ÎÁÌ¤»»ÄêÆüÂÐ±þ
      *
      *  04.04.01    NACL-ÌçÏÆ    09/01/23  Æþ±¡ÎÁ»»ÄêÊÝ¸±°Ê³°¤Î¿ÇÎÅÊ¬¼ÂÆü¿ô»»ÄêÂÐ±þ
      *  04.04.02    NACL-ÌçÏÆ    09/06/12  ÎÅÍÜ´ü´Ö¤ÎÊÔ½¸½¤Àµ
      *  04.04.03    NACL-ÌçÏÆ    09/11/19  ¼«ÇåÀÕ·òÊÝ½àµòÎÅÍÜÃ´Åö¼êÅöÂÐ±þ
      *  04.04.04    NACL-ÌçÏÆ    10/03/23  ²þÀµÂÐ±þ¡Ê³°Çñ¶èÊ¬£µ¤ÎÂÐ±þ¡Ë
      *  04.04.05    NACL-ÌçÏÆ    10/03/31  ²þÀµÂÐ±þ¡ÊðôÉô¸ÇÄêÂÓ²Ã»»¤ÎÂÐ±þ¡Ë
      *  04.04.06    NACL-ÌçÏÆ    10/04/02  ÆÃÊÌÏ«ºÒÉÕÅº´Ç¸î¤ÎÂÐ±þ
      *
      *  04.05.01    NACL-ÌçÏÆ    10/01/25  ¼£¸³ÂÐ±þ
      *  04.05.02    NACL-ÌçÏÆ    11/08/16  Ï«ºÒÉÂ°áÂßÍ¿ÎÁÂÐ±þ
      *  04.05.03    NACL-ÌçÏÆ    11/11/04  µßµÞÈÂÁ÷¿ÇÎÅÎÁ»»ÄêÂÐ±þ
      *  04.05.04    NACL-ÌçÏÆ    11/11/09  Æ±ÆüºÆÆþ±¡¿©»öÂÐ±þ
      *  04.05.05    NACL-ÌçÏÆ    12/04/02  Ê¿À®£²£´Ç¯£´·î²þÀµ
      *                                     ³°Çñ¶èÊ¬£¶¡¥£·¤ÎÂÐ±þ
      *                                     Æþ±¡Î¬¾Î¤ÎÊ¸»ú¿ô³ÈÄ¥ÂÐ±þ
      *  04.05.06    NACL-ÌçÏÆ    12/09/18  ²þÀµÂÐ±þ¡Ê³°Çñ¶èÊ¬£¸¡¤£¹¤ÎÂÐ±þ¡Ë
      *
      *  04.06.01    NACL-ÌçÏÆ    10/12/06  Ï«ºÒ¡¦¼«ÇåÀÕ¤Î¶â³Û¥Õ¥ê¡¼ÆþÎÏ
      *                                     ¥³¡¼¥ÉÂÐ±þ
      *  04.06.02    NACL-ÌçÏÆ    13/02/18  Ï«ºÒ¥ì¥»ÅÅÂÐ±þ
      *                                     ¡Ê¿·¿ÇÎÅ¹Ô°Ù¥³¡¼¥ÉÂÐ±þ¡Ë
      *  04.06.03    NACL-ÌçÏÆ    13/06/12  Ï«ºÒ¡¦¼«ÇåÀÕ¤Î
      *                                     ´Ç¸îÎÁ³äÁý²Ã»»ÂÐ±þ
      *  04.06.04    NACL-ÌçÏÆ    13/06/14  µßµÞ°åÎÅ´ÉÍý²Ã»»»»ÄêÈ½Äê½¤Àµ
      *  04.06.05    NACL-ÌçÏÆ    13/09/09  ÅÀ¿ô¥Þ¥¹¥¿·îÅÓÃæ¶â³ÛÊÑ¹¹ÂÐ±þ
      *                                     ¡Ê£°£¹£µ£¹£±¡Á£¹£´¡Ë
      *
      *  04.07.01    NACL-ÌçÏÆ    11/09/09  Ï«ºÒÀÁµá½ñºîÀ®ÂÐ±þ
      *  04.07.02    NACL-ÌçÏÆ    12/08/28  ÌôºÞÎÁ¸ºÅÀÂÐ±þ
      *  04.07.03    NACL-ÌçÏÆ    13/10/02  ¼«ÇåÀÕ¡ÊÂè»°¼Ô¹Ô°Ù¡ËÂÐ±þ
      *  04.07.04    NACL-ÌçÏÆ    14/02/13  Ï«ºÒ¡¦¼«ÇåÀÕ¤Î»Ü½Ñ²Ã»»ÂÐ±þ
      *  04.07.05    NACL-ÌçÏÆ    14/03/01  Ï«ºÒ¥Þ¥¹¥¿ÄÉ²ÃÂÐ±þ
      *  04.07.06    NACL-ÌçÏÆ    14/03/04  Ê¿À®£²£¶Ç¯£´·î²þÀµÂÐ±þ
      *  04.07.07    NACL-ÌçÏÆ    14/03/28  Ê¿À®£²£¶Ç¯£´·î²þÀµÂÐ±þ
      *  04.07.08    NACL-ÌçÏÆ    15/01/14  Æ±ÆüÆþ±¡»þ¤Î¥Õ¥é¥°ÊÔ½¸½¤Àµ
      *
      *  04.08.01    NACL-Æ£¸¶    14/07/07  °ì»þ¥Ç¥£¥ì¥¯¥È¥êÂÐ±þ
      *  04.08.02    NACL-ÌçÏÆ    16/04/18  Ê¿À®£²£¸Ç¯£´·î²þÀµÂÐ±þ
      *  04.08.03    NACL-ÌçÏÆ    16/08/23  »ý»²ÌôÂÐ±þ
      *  04.08.04    NACL-ÌçÏÆ    16/09/06  Æþ±¡¼¼ÎÁ²Ã»»º¹³ÛÀÁµá¥Þ¥¹¥¿¤È
      *                                     ÆÃÊÌÏ«ºÒÉÕÅº´Ç¸îÎÁº¹³ÛÀÁµá
      *                                     ¥Þ¥¹¥¿¤ÎÂÐ±þ
      *  04.08.05    NACL-ÌçÏÆ    18/02/01  Âè»°¼Ô¹Ô°Ù¤ÎÁªÄêÆþ±¡ÎÁÂÐ±þ
      *  04.08.06    NACL-ÌçÏÆ    18/04/24  Ê¿À®£³£°Ç¯£´·î²þÀµÂÐ±þ
      *
      *  05.00.01    NACL-ÌçÏÆ    19/08/28  ÎáÏÂ¸µÇ¯£±£°·î²þÀµ¡Ê¾ÃÈñÀÇ¡Ë
      *****************************************************************
      *
       ENVIRONMENT             DIVISION.
       CONFIGURATION           SECTION.
       INPUT-OUTPUT            SECTION.
       FILE-CONTROL.
           SELECT  RECE82-FILE     ASSIGN  RECE82PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE82-KEY
                                   FILE    STATUS  IS  STS-RECE82.
      *    ¥¨¥é¡¼¥Õ¥¡¥¤¥ë
           SELECT  RECEERR-FILE    ASSIGN  RECEERR
                                   FILE    STATUS  IS  STS-RECEERR.
      *
       DATA                    DIVISION.
       FILE                    SECTION.
      *
       FD  RECE82-FILE.
       01  RECE82-REC.
           COPY    "CPRCF082.INC".
      *
      *    ¥¨¥é¡¼¥Õ¥¡¥¤¥ë
       FD  RECEERR-FILE.
       01  RECEERR-REC             PIC X(200).
      *
       WORKING-STORAGE             SECTION.
      *
      *     ¥ì¥»¥×¥ÈÌÀºÙ¥Õ¥¡¥¤¥ë Ì¾¾ÎÎÎ°è 
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE82//.
      *
      *    ¥¨¥é¡¼¥Õ¥¡¥¤¥ë Ì¾¾ÎÎÎ°è 
           COPY    "CPERRFL.INC"   REPLACING  //ERRFLPARA//
                                   BY         //RECEERR//.
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  STS-AREA.
           03  STS-RECE82                              PIC X(02).
           03  STS-RECEERR                             PIC X(02).
      *
       01  FLG-AREA.
           03  FLG-END                                 PIC 9(01).
           03  FLG-SHOSAISIN                           PIC 9(01).
           03  FLG-SHOSAISIN-GEN                       PIC 9(01).
           03  FLG-NYUINACCT                           PIC 9(01).
           03  FLG-SRYACCT                             PIC 9(01).
           03  FLG-SRYACT                              PIC 9(01).
           03  FLG-TENSU                               PIC 9(01).
           03  FLG-ARI                                 PIC 9(01).
           03  FLG-SYSKANRI                            PIC 9(01).
           03  FLG-NYURYAKUSHO                         PIC 9(01).
           03  FLG-KYUKYU                              PIC 9(01).
           03  FLG-SET                                 PIC 9(01).
           03  FLG-OKIKAE                              PIC 9(01).
      *
      *    ¥«¥¦¥ó¥ÈÎÎ°è
       01  CNT-AREA.
           03  CNT-IN                                  PIC 9(06).
           03  CNT-IN-CANCEL                           PIC 9(06).
           03  CNT-MOD                                 PIC 9(06).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX                                     PIC 9(03).
           03  IDX1                                    PIC 9(03).
           03  IDX2                                    PIC 9(03).
           03  IDX3                                    PIC 9(02).
           03  IDX4                                    PIC 9(02).
           03  IDX8                                    PIC 9(02).
           03  IDY                                     PIC 9(03).
           03  IDY2                                    PIC 9(03).
           03  ID1                                     PIC 9(03).
           03  SRYACT-IDX                              PIC 9(03).
           03  SYSKAN-IDX                              PIC 9(03).
           03  IDV                                     PIC 9(02).
      *
      *    ¼ÂÆü¿ô¥«¥¦¥ó¥ÈÍÑÎÎ°è
       01  TBL-JNISSU.
           03  TBL-JNISSU-DAY                          PIC X(01)
                                                       OCCURS   31.
      *    ¼ÂÆü¿ô¸º¥«¥¦¥ó¥ÈÍÑÎÎ°è
       01  TBL-JNISSU-GEN.
           03  TBL-JNISSU-DAY-GEN                      PIC X(01)
                                                       OCCURS   31.
      *    ¹ç·×ÅÀ¿ô¡Ê¿ÇÎÅ¹Ô°Ù¡Ë½¸·×ÍÑÎÎ°è
       01  TOTAL-ACCT.
           03  TOTALTEN-ACCT                           PIC S9(08).
           03  TOTALKIN-ACCT                           PIC  9(08).
           03  TOTALKIN2-ACCT                          PIC  9(08).
      *
      *    ¼êµ»ÅÀ¡¦ÌôºÞÅùÅÀ¿ôÍÑÎÎ°è
       01  TBL-TENSUG-JI.
           03  TBL-TENSU-JI                            OCCURS   31.
              05  TBL-SYUTEN-JI                        PIC S9(09).
              05  TBL-YKZTEN-JI                        PIC S9(09).
      *
       01  WRK-DAY-TABLE.
           03  WRK-DAY-T                               OCCURS   31.
               05  WRK-DAY1                            PIC 9(04).
               05  WRK-DAY2                            PIC 9(04).
               05  WRK-DAY4                            PIC 9(04).
               05  WRK-DAY41                           PIC 9(04).
               05  WRK-DAY5                            PIC 9(04).
               05  WRK-DAY7                            PIC 9(04).
               05  WRK-DAY7-ZAITEN                     PIC 9(08).
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
           03  WRK-PARA.
               05  WRK-PARA-SRYYM                      PIC  X(06).
               05  WRK-PARA-TERMID                     PIC  X(16).
               05  WRK-PARA-SYSYMD                     PIC  X(08).
               05  WRK-PARA-RECEKBN                    PIC  X(01).
               05  WRK-PARA-JOBID                      PIC  9(07).
               05  WRK-PARA-SHELLID                    PIC  X(08).
           03  WRK-PARA-JIBAIPRTKBN                    PIC  X(01).
           03  WRK-PARA-HOSPNUM                        PIC  9(02).
      *
           03  WRK-SYS-SRYYMD                          PIC  X(08).
      *
           03  WRK-SRYYM-5000                          PIC  X(06).
           03  WRK-SYS5000-COUNT                       PIC  9(02).
      *
           03  WRK-TAIHI-FLG                           PIC  9(01).
           03  WRK-TAIHI-SRYYMD.
               05  WRK-TAIHI-SRYYM                     PIC  9(06).
               05  WRK-TAIHI-SRYD                      PIC  9(02).
      *
           03  WRK-TEN                                 PIC  9(09).
           03  WRK-TEN-KG                              PIC  9(09).
           03  WRK-TEN-KG2                             PIC  9(09).
           03  WRK-KIN                                 PIC  9(09).
           03  WRK-KIN2                                PIC  9(09).
      *
           03  WRK-SINDAN-TUU                          PIC  9(02).
           03  WRK-SINDAN-KIN                          PIC  9(09).
           03  WRK-MEISAI-TUU                          PIC  9(02).
           03  WRK-MEISAI-KIN                          PIC  9(09).
      *
           03  WRK-KSNRATE                             PIC  9V99.
      *    ¾ÃÈñÀÇÃ¼¿ô¶èÊ¬
           03  WRK-TAX1001-KBN                         PIC  X(01).
      *
           03  WRK-ZAIKAISU-JI                         PIC  9(03).
           03  WRK-KEISAN-JI                           PIC  9(09).
           03  WRK-TEN-JI                              PIC  9(09).
      *
           03  WRK-SHOKUJIRYOYO-OCC.
               05  WRK-SHOKUJIRYOYO                    PIC  9(01)
                                                       OCCURS 31.
           03  WRK-TOKUKANRIKASAN-OCC.
               05  WRK-TOKUKANRIKASAN                  PIC  9(01)
                                                       OCCURS 31.
           03  WRK-SRYCD                               PIC  X(09).
           03  WRK-NYUTOKRYO                           PIC  9(09).
      *
           03  WRK-KEISAN                              PIC  9(09).
           03  WRK-KEISAN2                             PIC  9(09).
           03  WRK-KEISAN-KG                           PIC  9(09).
           03  WRK-KEISAN-KG2                          PIC  9(09).
      *
           03  WRK-STDAY                               PIC  9(02).
           03  WRK-STDAY2                              PIC  9(02).
           03  WRK-EDDAY                               PIC  9(02).
           03  WRK-EDDAY2                              PIC  9(02).
      *
           03  WRK-SYUTEN-TOTALTEN                     PIC S9(09).
           03  WRK-YKZTEN-TOTALTEN                     PIC  9(09).
      *
           03  WRK-FUTANWARI                           PIC  9V99.
      *
           03  WRK-TAIHI-DAY                           PIC  9(02).
      *
           03  WRK-S1                                  PIC  9(03).
           03  WRK-S2                                  PIC  9(03).
           03  WRK-S3                                  PIC  9V99999.
           03  WRK-S4                                  PIC  9V99.
           03  WRK-S5                                  PIC  9V99.
      *
       01  WRK-TENTEK.
           03  WRK-TENTEK-SYUTEN                       PIC  9(07).
           03  WRK-TENTEK-ZAIKAISU                     PIC  9(04).
           03  WRK-TENTEK-YKZTEN                       PIC  9(07).
           03  WRK-TENTEK-YKZTEN2                      PIC  9(07)
                                                       OCCURS   31.
           03  WRK-TENTEK-KIZAITEN                     PIC  9(07).
           03  WRK-TENTEK-KIZAITEN2                    PIC  9(07)
                                                       OCCURS   31.
           03  WRK-TENTEK-FLG                          PIC  9(01).
           03  WRK-TENTEK-FLG2                         PIC  9(01).
      *
       01  WRK-CONS-AREA.
      *    ¸ÇÄêÃ¼Ëö£É£Ä
           03  WRK-CONS-TERMID     PIC X(64)   VALUE
                                   "0100007FZZZZZZZZZZZZZZZZZZZZZZZZ".
      *
           03  WRK-RECEERR                             PIC X(200).
      *
      *    °åÎÅµ¡´Ø¡Ê´ðËÜ¾ðÊó¡ËÂàÈòÍÑÎÎ°è
       01  TBL-SYS1001-T.
           03  TBL-SYS1001-OCC     OCCURS  100.
               05  TBL-SYS1001                         PIC X(610).
      *    °åÎÅµ¡´Ø¡ÊÆþ±¡´ðËÜ¡ËÂàÈòÍÑÎÎ°è
       01  TBL-SYS5000-T.
           03  TBL-SYS5000-OCC     OCCURS  100.
               05  TBL-SYS5000                         PIC X(610).
      *
      *---------------------------------------------------------------
      *    ¸ÇÄêÃÍ
       01  CONST-AREA.
           03  CONS-ROUSAI1    PIC X(09)   VALUE   "101110010".
           03  CONS-ROUSAI2    PIC X(09)   VALUE   "101110020".
           03  CONS-ROUSAI3    PIC X(09)   VALUE   "101130010".
           03  CONS-ROUSAI4    PIC X(09)   VALUE   "101130020".
           03  CONS-ROUSAI5    PIC X(09)   VALUE   "101130030".
           03  CONS-ROUSAI6    PIC X(09)   VALUE   "101130040".
           03  CONS-ROUSAI7    PIC X(09)   VALUE   "101130050".
           03  CONS-ROUSAI8    PIC X(09)   VALUE   "101130060".
           03  CONS-ROUSAI9    PIC X(09)   VALUE   "101130070".
           03  CONS-ROUSAI10   PIC X(09)   VALUE   "101130080".
           03  CONS-ROUSAI11   PIC X(09)   VALUE   "101130090".
           03  CONS-ROUSAI12   PIC X(09)   VALUE   "101130100".
      *
           03  CONS-ROUSAI13   PIC X(09)   VALUE   "101910010".
           03  CONS-ROUSAI14   PIC X(09)   VALUE   "101910020".
           03  CONS-ROUSAI15   PIC X(09)   VALUE   "101910030".
           03  CONS-ROUSAI16   PIC X(09)   VALUE   "101910040".
           03  CONS-ROUSAI17   PIC X(09)   VALUE   "101910070".
           03  CONS-ROUSAI18   PIC X(09)   VALUE   "101910080".
           03  CONS-ROUSAI19   PIC X(09)   VALUE   "101910090".
           03  CONS-ROUSAI20   PIC X(09)   VALUE   "101910100".
           03  CONS-ROUSAI21   PIC X(09)   VALUE   "101110040".
      *
           03  CONS-ROUSAI22   PIC X(09)   VALUE   "101800390".
           03  CONS-ROUSAI23   PIC X(09)   VALUE   "101800400".
           03  CONS-ROUSAI24   PIC X(09)   VALUE   "101800410".
           03  CONS-ROUSAI25   PIC X(09)   VALUE   "101800420".
           03  CONS-ROUSAI26   PIC X(09)   VALUE   "101800430".
           03  CONS-ROUSAI27   PIC X(09)   VALUE   "101800440".
           03  CONS-ROUSAI28   PIC X(09)   VALUE   "101800450".
           03  CONS-ROUSAI29   PIC X(09)   VALUE   "101800460".
      *
           03  CONS-ROUSAI30   PIC X(09)   VALUE   "101800870".
           03  CONS-ROUSAI31   PIC X(09)   VALUE   "101800470".
           03  CONS-ROUSAI32   PIC X(09)   VALUE   "101800480".
           03  CONS-ROUSAI33   PIC X(09)   VALUE   "101800490".
           03  CONS-ROUSAI34   PIC X(09)   VALUE   "101800500".
           03  CONS-ROUSAI35   PIC X(09)   VALUE   "101800510".
           03  CONS-ROUSAI36   PIC X(09)   VALUE   "101800520".
           03  CONS-ROUSAI37   PIC X(09)   VALUE   "101800530".
           03  CONS-ROUSAI38   PIC X(09)   VALUE   "101800540".
           03  CONS-ROUSAI39   PIC X(09)   VALUE   "101800960".
           03  CONS-ROUSAI40   PIC X(09)   VALUE   "101800970".
           03  CONS-ROUSAI41   PIC X(09)   VALUE   "101800980".
      *
           03  CONS-ROUSAI42   PIC X(09)   VALUE   "101800880".
      *
           03  CONS-ROUSAI43   PIC X(09)   VALUE   "101801040".
      *
           03  CONS-ROUSAI44   PIC X(09)   VALUE   "101801150".
           03  CONS-ROUSAI45   PIC X(09)   VALUE   "101801160".
           03  CONS-ROUSAI46   PIC X(09)   VALUE   "101801170".
           03  CONS-ROUSAI47   PIC X(09)   VALUE   "101801180".
      *
      *    ¹øÉô¸ÇÄêÂÓ²Ã»»
           03  CONS-YOUBUKASAN PIC X(09)   VALUE   "140037490".
      *    ¶»Éô¸ÇÄêÂÓ²Ã»»
           03  CONS-KYOBUKASAN PIC X(09)   VALUE   "140040110".
      *    ðôÉô¸ÇÄêÂÓ²Ã»»
           03  CONS-KEIBUKASAN PIC X(09)   VALUE   "140052610".
      *    ÁÏ³°¸ÇÄê´ï»ÈÍÑ²Ã»»
           03  CONS-SOGAIKASAN PIC X(09)   VALUE   "150266970".
      *    ÎÅÍÜÃ´Åö¼êÅö¡ÊÆþ±¡¡Ë
           03  CONS-RYOYOTEATE PIC X(09)   VALUE   "199000510".
      *---------------------------------------------------------------
      *
           COPY    "MCPAREA".
      *
           COPY    "COMMON-SPA".
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿
           COPY    "CPSYSKANRI.INC".
      *    °åÎÅµ¡´Ø¾ðÊó¡Ý´ðËÜ
           COPY    "CPSK1001.INC".
      *
           COPY    "CPSK5000.INC".
      *
      *    ¥¸¥ç¥Ö´ÉÍý¥Þ¥¹¥¿
       01  JOBKANRI-REC.
           COPY    "CPJOBKANRI.INC".
      *
      *    Æþ±¡²ñ·×
       01  NYUINACCT-REC.
           COPY    "CPNYUINACCT.INC".
      *
      *    ¿ÇÎÅ²ñ·×
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    ¿ÇÎÅ¹Ô°Ù
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *    ÅÀ¿ô
           COPY    "CPTENSU.INC".
      *
      *    Æþ±¡Î¬¾Î
       01  NYURYAKUSHO-REC.
           COPY    "CPNYUINRYAKUSHO.INC".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑÎÎ°è
      *****************************************************************
      *
      *   ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *    ¿ô»úÊÑ´¹ÎÎ°è
           COPY    "CPORCSNUM.INC".
      *    ´µ¼ÔÈÖ¹æÊÑ´¹¥µ¥Ö
           COPY    "CPORCSPTID.INC".
      *   ¥¸¥ç¥Ö´ÉÍý£Ä£ÂÀ©¸æ¥µ¥Ö
           COPY    "CPORCSJOBKANRI.INC".
      *
      *    Æþ±¡ÅÀÅ©°ì³ç¹¹¿·¥µ¥Ö
           COPY    "CPORCSTENTEK.INC".
      *
      *    Ï«ºÒÆþ±¡²ñ·×ºîÀ®¥µ¥Ö
           COPY    "CPORCSROUNYUIN.INC".
      *
           COPY    "CPORCSGETTEMP.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPDATA.INC".
      *
      ****************************************************************
       LINKAGE                 SECTION.
       01  COMMAND-PARAM.
           02  FILLER      PIC X(256).
      ****************************************************************
       PROCEDURE           DIVISION
               USING
           COMMAND-PARAM.
      *
      *
      *****************************************************************
      *    ¼ç½èÍý
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           PERFORM 100-INIT-SEC
      *
           PERFORM 200-MAIN-SEC    UNTIL   FLG-END =   1
      *
           PERFORM 300-TERM-SEC
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
               STOP    RUN
           ELSE
               EXIT    PROGRAM
           END-IF 
           .
      *
      *****************************************************************
      *    ½é´ü¡¡½èÍý
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
           INITIALIZE                  CNT-AREA
                                       WRK-AREA
                                       FLG-AREA
                                       SPA-AREA
                                       RECEERR
      *
           UNSTRING    COMMAND-PARAM   DELIMITED  BY  ","
                                       INTO    WRK-PARA
                                               WRK-PARA-JIBAIPRTKBN
                                               WRK-PARA-HOSPNUM
                                               RECEERR
           END-UNSTRING
           MOVE    WRK-PARA-HOSPNUM    TO  SPA-HOSPNUM
      *
           MOVE    SPACE               TO  RECE82PARA
           INITIALIZE                      RECE82PARA
           MOVE    "RECE820"           TO  RECE82PARA-FILE-ID
           MOVE    WRK-PARA-TERMID     TO  RECE82PARA-TERMID
grpsys     MOVE    WRK-PARA-HOSPNUM    TO  RECE82PARA-HOSPNUM
      *
           INITIALIZE                      SGETTEMP-AREA
           MOVE    RECEERR             TO  SGETTEMP-BASENAMES  (1)
           MOVE    RECE82PARA-BASENAME TO  SGETTEMP-BASENAMES  (2)
           CALL    "ORCSGETTEMP"       USING   SGETTEMP-AREA
           MOVE    SGETTEMP-FULLNAMES (1)
                                       TO  RECEERR
           MOVE    SGETTEMP-FULLNAMES (2)
                                       TO  RECE82PARA
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
               PERFORM 100-DBOPEN-SEC
      *
      *        ¥¹¥Æ¥Ã¥×´ÉÍý³«»Ï½èÍý
               MOVE    "STS"               TO  SJOBKANRI-MODE
               INITIALIZE                      JOBKANRI-REC
               MOVE    "ORCR0830"          TO  JOB-PGID
               MOVE    "¿ÇÎÅ¼ÂÆü¿ôÊÔ½¸¡ÊÏ«ºÒ¡¦¼«ÇåÀÕ¡Ë"
                                           TO  JOB-SHELLMSG
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
      *
      *        ½èÍýÃæ»ßÀßÄê½èÍý
               PERFORM 500-CANCEL-HENSYU-SEC
           END-IF 
      *
           IF   WRK-PARA-SRYYM    NOT =  ZERO
      *
             MOVE     WRK-PARA-SRYYM     TO  WRK-SRYYM-5000
             PERFORM   120-SYS-5000-CHK-SEC
      *      °åÎÅµ¡´Ø¸º»»¤Î¼èÆÀ¡Ê¥·¥¹¥Æ¥à´ÉÍý¥Æ¡¼¥Ö¥ë¤è¤ê¡Ë
             INITIALIZE                   WRK-SHOKUJIRYOYO-OCC
                                          WRK-TOKUKANRIKASAN-OCC
      *
             INITIALIZE                      SYSKANRI-REC
             MOVE    "5000"              TO  SYS-KANRICD
             MOVE    "*"                 TO  SYS-KBNCD
             MOVE    WRK-PARA-SRYYM      TO  SYS-STYUKYMD (1:6)
             MOVE    "01"                TO  SYS-STYUKYMD (7:2)
             MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
grpsys       MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
             MOVE    SYSKANRI-REC        TO  MCPDATA-REC
             PERFORM 910-SYSKANRI-INV-SEC
             IF      FLG-SYSKANRI        =   ZERO
               MOVE     MCPDATA-REC      TO  SYS-5000-REC
               PERFORM  110-SYSKAN-HENSYU-SEC
               IF        WRK-SYS5000-COUNT    =     ZERO
                  CONTINUE
               ELSE
                  PERFORM  130-SYS-5000-GET-SEC
               END-IF
             ELSE
               MOVE "°åÎÅµ¡´Ø¾ðÊó¡ÝÆþ±¡´ðËÜ¤¬¼èÆÀ¤Ç¤­¤Þ¤»¤ó¤Ç¤·¤¿¡£"
                                     TO  WRK-RECEERR
               PERFORM 500-ERR-HENSYU-SEC
               MOVE    1             TO  FLG-END
             END-IF
           ELSE
             MOVE     ZERO               TO  SYSKAN-IDX
             MOVE     SPACE              TO  TBL-SYS5000-T
             INITIALIZE                      TBL-SYS5000-T
      *
             INITIALIZE                      SYSKANRI-REC
             MOVE    "5000"              TO  SYS-KANRICD
             MOVE    "*"                 TO  SYS-KBNCD
grpsys       MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
             MOVE    SYSKANRI-REC        TO  MCPDATA-REC
             MOVE    "tbl_syskanri"      TO  MCP-TABLE
             MOVE    "key8"              TO  MCP-PATHNAME
grpsys       PERFORM 900-DBSELECT-SEC
             IF      MCP-RC              =   ZERO
                 MOVE    "tbl_syskanri"     TO  MCP-TABLE
                 MOVE    "key8"             TO  MCP-PATHNAME
                 PERFORM  900-SYSKANRI-READ-SEC
                 PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                           OR    (SYSKAN-IDX   >=  100)
      *
                   MOVE   MCPDATA-REC    TO  SYS-5000-REC
                   ADD     1             TO  SYSKAN-IDX
                   MOVE   SYS-5000-REC   TO  TBL-SYS5000(SYSKAN-IDX)
      *
                   MOVE    "tbl_syskanri"   TO  MCP-TABLE
                   MOVE    "key8"           TO  MCP-PATHNAME
                   PERFORM  900-SYSKANRI-READ-SEC
                 END-PERFORM
             ELSE
                 MOVE "°åÎÅµ¡´Ø¾ðÊó¡ÝÆþ±¡´ðËÜ¤¬¼èÆÀ¤Ç¤­¤Þ¤»¤ó¤Ç¤·¤¿¡£"
                                         TO  WRK-RECEERR
                 PERFORM 500-ERR-HENSYU-SEC
                 MOVE    1               TO  FLG-END
             END-IF
             MOVE    "tbl_syskanri"      TO  MCP-TABLE
             MOVE    "key8"              TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-IF
      *
      *
           IF   WRK-PARA-SRYYM    NOT =  ZERO
      *       °åÎÅµ¡´Ø¾ðÊó¡Ý´ðËÜ
              INITIALIZE                      SYSKANRI-REC
              MOVE    "1001"              TO  SYS-KANRICD
              MOVE    "*"                 TO  SYS-KBNCD
              MOVE    WRK-PARA-SRYYM      TO  SYS-STYUKYMD (1:6)
              MOVE    "01"                TO  SYS-STYUKYMD (7:2)
              MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
grpsys        MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
              MOVE    SYSKANRI-REC        TO  MCPDATA-REC
              PERFORM 910-SYSKANRI-INV-SEC
              IF      FLG-SYSKANRI        =   ZERO
                 MOVE     MCPDATA-REC     TO  SYS-1001-REC
                 MOVE     SYS-1001-TAX-HASU-KBN
                                          TO  WRK-TAX1001-KBN
                 IF   WRK-TAX1001-KBN = SPACE
                    MOVE   "2"            TO  WRK-TAX1001-KBN
                 END-IF
              ELSE
                 MOVE    "°åÎÅµ¡´Ø¾ðÊó¤¬¼èÆÀ¤Ç¤­¤Þ¤»¤ó¤Ç¤·¤¿¡£"
                                         TO  WRK-RECEERR
                 PERFORM 500-ERR-HENSYU-SEC
                 MOVE    1               TO  FLG-END
              END-IF
           ELSE
              MOVE     ZERO               TO  SYSKAN-IDX
              MOVE     SPACE              TO  TBL-SYS1001-T
              INITIALIZE                      TBL-SYS1001-T
      *
              INITIALIZE                      SYSKANRI-REC
              MOVE    "1001"              TO  SYS-KANRICD
              MOVE    "*"                 TO  SYS-KBNCD
grpsys        MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
              MOVE    SYSKANRI-REC        TO  MCPDATA-REC
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key8"              TO  MCP-PATHNAME
grpsys        PERFORM 900-DBSELECT-SEC
              IF      MCP-RC              =   ZERO
                  MOVE    "tbl_syskanri"      TO  MCP-TABLE
                  MOVE    "key8"              TO  MCP-PATHNAME
                  PERFORM  900-SYSKANRI-READ-SEC
                  PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                            OR    (SYSKAN-IDX   >=  100)
      *
                    MOVE    MCPDATA-REC   TO  SYS-1001-REC
                    ADD     1             TO  SYSKAN-IDX
                    MOVE    SYS-1001-REC  TO  TBL-SYS1001(SYSKAN-IDX)
      *
                    MOVE    "tbl_syskanri"    TO  MCP-TABLE
                    MOVE    "key8"            TO  MCP-PATHNAME
                    PERFORM  900-SYSKANRI-READ-SEC
                  END-PERFORM
              ELSE
                  MOVE    "°åÎÅµ¡´Ø¾ðÊó¤¬¼èÆÀ¤Ç¤­¤Þ¤»¤ó¤Ç¤·¤¿¡£"
                                          TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
                  MOVE    1               TO  FLG-END
              END-IF
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key8"              TO  MCP-PATHNAME
              PERFORM 900-CLOSE-SEC
           END-IF
      *
      *
           OPEN    I-O                 RECE82-FILE
      *
           PERFORM    900-RECE82-READ-SEC
      *
          .
       100-INIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥·¥¹¥«¥ó¤ÎÊÔ½¸
      *****************************************************************
       110-SYSKAN-HENSYU-SEC                SECTION.
      *
           PERFORM   VARYING   IDX3   FROM  1  BY  1
                      UNTIL    IDX3    >   31
              EVALUATE    SYS-5000-SHOKUJIRYOYOCD
      *         Æþ±¡¿©»öÎÅÍÜ¡Ê£±¡Ë
                WHEN         "197000110"
                    MOVE     1      TO   WRK-SHOKUJIRYOYO(IDX3)
                    EVALUATE  SYS-5000-SHOKUKBN(1)
                      WHEN     "1"
                        MOVE  ZERO  TO   WRK-TOKUKANRIKASAN(IDX3)
                      WHEN     "2"
                        MOVE    1   TO   WRK-TOKUKANRIKASAN(IDX3)
                    END-EVALUATE
      *         Æþ±¡¿©»öÎÅÍÜ¡Ê£²¡Ë
                WHEN         "197000710"
                    MOVE     2      TO   WRK-SHOKUJIRYOYO(IDX3)
              END-EVALUATE
           END-PERFORM
      *
           .
       110-SYSKAN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ·îÆâ¤ËÊ£¿ô¤Î°åÎÅ´ü´Ö¾ðÊó¤¬¤Ê¤¤¤«¸¡º÷¡Ê°åÎÅµ¡´Ø¸º»»¤Î³ÎÇ§¡Ë  *
      ******************************************************************
       120-SYS-5000-CHK-SEC                 SECTION.
      *
           MOVE     ZERO               TO  WRK-SYS5000-COUNT
      *
           INITIALIZE                      SYSKANRI-REC
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    WRK-SRYYM-5000      TO  SYS-STYUKYMD (1:6)
           MOVE    "__"                TO  SYS-STYUKYMD (7:2)
           MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
grpsys     MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key11"             TO  MCP-PATHNAME
               PERFORM  900-SYSKANRI-READ-SEC
               PERFORM  UNTIL    FLG-SYSKANRI   =   1
      *
                  MOVE    MCPDATA-REC  TO  SYS-5000-REC
                  ADD     1            TO  WRK-SYS5000-COUNT
      *
                  MOVE    "tbl_syskanri"   TO  MCP-TABLE
                  MOVE    "key11"          TO  MCP-PATHNAME
                  PERFORM  900-SYSKANRI-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
      *
       120-SYS-5000-CHK-EXT.
           EXIT.
      *
      ******************************************************************
      *    ·îÆâ¤Î°åÎÅ´ü´Ö¾ðÊó¼èÆÀ¡Ê°åÎÅµ¡´Ø¸º»»¾ðÊó¡Ë                  *
      ******************************************************************
       130-SYS-5000-GET-SEC                 SECTION.
      *
           INITIALIZE                      SYSKANRI-REC
           MOVE    "5000"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    WRK-SRYYM-5000      TO  SYS-STYUKYMD (1:6)
           MOVE    "__"                TO  SYS-STYUKYMD (7:2)
           MOVE    SYS-STYUKYMD        TO  SYS-EDYUKYMD
grpsys     MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"  TO  MCP-TABLE
               MOVE    "key11"         TO  MCP-PATHNAME
               PERFORM  900-SYSKANRI-READ-SEC
               PERFORM  UNTIL    FLG-SYSKANRI   =   1
      *
                 MOVE   MCPDATA-REC    TO  SYS-5000-REC
                 MOVE   SYS-5000-STYUKYMD(7:2)  TO  IDV
                 PERFORM    VARYING  IDX3  FROM  IDV  BY  1
                             UNTIL   IDX3    >   31
                      EVALUATE    SYS-5000-SHOKUJIRYOYOCD
      *                Æþ±¡¿©»öÎÅÍÜ¡Ê£±¡Ë
                       WHEN         "197000110"
                          MOVE     1      TO   WRK-SHOKUJIRYOYO(IDX3)
                          EVALUATE  SYS-5000-SHOKUKBN(1)
                            WHEN     "1"
                              MOVE  ZERO  TO   WRK-TOKUKANRIKASAN(IDX3)
                            WHEN     "2"
                              MOVE    1   TO   WRK-TOKUKANRIKASAN(IDX3)
                          END-EVALUATE
      *                Æþ±¡¿©»öÎÅÍÜ¡Ê£²¡Ë
                       WHEN         "197000710"
                          MOVE     2      TO   WRK-SHOKUJIRYOYO(IDX3)
                          MOVE    ZERO    TO   WRK-TOKUKANRIKASAN(IDX3)
                      END-EVALUATE
                 END-PERFORM
      *
                 MOVE    "tbl_syskanri"   TO   MCP-TABLE
                 MOVE    "key11"          TO   MCP-PATHNAME
                 PERFORM  900-SYSKANRI-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_syskanri"         TO  MCP-TABLE
           MOVE    "key11"                TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
      *
       130-SYS-5000-GET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼ç½èÍý
      *****************************************************************
       200-MAIN-SEC                SECTION.
      *
           PERFORM    210-HENSYU-SEC
      *
           PERFORM    900-RECE82-READ-SEC
      *
      *    ½èÍýÃæ»ßÀßÄê½èÍý
           IF      CNT-IN-CANCEL       =   50
               MOVE    ZERO                TO  CNT-IN-CANCEL
               PERFORM 500-CANCEL-HENSYU-SEC
           END-IF
      *
           .
       200-MAIN-EXT.
           EXIT.
      * 
      *****************************************************************
      *    ÊÔ½¸½èÍý
      *****************************************************************
       210-HENSYU-SEC                   SECTION.
      *
      *    ¾ÃÈñÀÇ·×»»¤Î·¸¿ôÀßÄê
           IF    RECE82-SRYYM >= "201910"
               MOVE      10      TO  WRK-S1
               MOVE     110      TO  WRK-S2
               MOVE     0.10     TO  WRK-S4
               MOVE     1.10     TO  WRK-S5
           ELSE
             IF  RECE82-SRYYM >= "201404"
               MOVE       8      TO  WRK-S1
               MOVE     108      TO  WRK-S2
               MOVE     0.08     TO  WRK-S4
               MOVE     1.08     TO  WRK-S5
             ELSE
               MOVE       5      TO  WRK-S1
               MOVE     105      TO  WRK-S2
               MOVE     0.05     TO  WRK-S4
               MOVE     1.05     TO  WRK-S5
             END-IF
           END-IF
           EVALUATE  WRK-TAX1001-KBN
               WHEN      "1"
                 MOVE   0.50000  TO  WRK-S3
               WHEN      "2"
                 MOVE   0.00000  TO  WRK-S3
               WHEN      "3"
                 MOVE   0.99999  TO  WRK-S3
           END-EVALUATE
      *
           MOVE       SPACE             TO     TBL-JNISSU
           INITIALIZE                          TBL-JNISSU
           MOVE       SPACE             TO     TBL-JNISSU-GEN
           INITIALIZE                          TBL-JNISSU-GEN
      *
           MOVE       SPACE             TO     TBL-TENSUG-JI
           INITIALIZE                          TBL-TENSUG-JI
      *
           MOVE       SPACE             TO     TOTAL-ACCT
           INITIALIZE                          TOTAL-ACCT
      *
           MOVE       SPACE             TO     WRK-DAY-TABLE
           INITIALIZE                          WRK-DAY-TABLE
      *
           MOVE       ZERO              TO     WRK-TAIHI-FLG
      *
           MOVE       ZERO              TO     WRK-SINDAN-TUU
                                               WRK-SINDAN-KIN
                                               WRK-MEISAI-TUU
                                               WRK-MEISAI-KIN
      *
           PERFORM     220-RECE82-HENSYU-SEC
           PERFORM     230-RECE82-HENSYU2-SEC
           IF   RECE82-SRYYM  >= "200604"
             CONTINUE
           ELSE
             PERFORM   250-RECE82-HENSYU4-SEC
           END-IF
           PERFORM     260-RECE82-HENSYU9-SEC
      *
           PERFORM     270-JNISSU-SET-SEC
      *
           PERFORM     280-RECE82-REWRITE-SEC
           .
       210-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥ÈÃæ´Ö¥Õ¥¡¥¤¥ë¤ÎÊÔ½¸¡Ê£Æ£°£°£²¡Ë
      *****************************************************************
       220-RECE82-HENSYU-SEC                SECTION.
      *
           INITIALIZE                            NYUINACCT-REC
           MOVE    RECE82-HOSPNUM        TO      NACCT-HOSPNUM
           MOVE    RECE82-NYUGAIKBN      TO      NACCT-NYUGAIKBN
           MOVE    RECE82-PTID           TO      NACCT-PTID
           MOVE    RECE82-SRYYM          TO      NACCT-SRYYM
           MOVE    NYUINACCT-REC         TO      MCPDATA-REC
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key7"                TO      MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC             =       ZERO
               MOVE    "tbl_nyuinacct"   TO      MCP-TABLE
               MOVE    "key7"            TO      MCP-PATHNAME
               PERFORM  900-NYUINACCT-READ-SEC
               PERFORM  UNTIL  (FLG-NYUINACCT  =    "1")
      *
                 IF     NACCT-ZAISKBKBN    =    "1"  OR  "2"  OR
                                                "4"  OR  "5"  OR
                                                "7"
                       PERFORM    2201-NYUIN-DAY-TAIHI-SEC
                 END-IF
      *
                 MOVE    "tbl_nyuinacct" TO      MCP-TABLE
                 MOVE    "key7"          TO      MCP-PATHNAME
                 PERFORM  900-NYUINACCT-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key7"                TO      MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
      *
           PERFORM  VARYING  IDY    FROM    1   BY  1
                          UNTIL   IDY     >       31
      *
                 IF        WRK-DAY5(IDY)   =   RECE82-HKNCOMBI
                      MOVE    ZERO            TO    FLG-SHOSAISIN
                      IF  (WRK-DAY1(IDY)   NOT =    ZERO )
                      OR  (RECE82-NYUINDAY-KBN(IDY) = "1")
                               MOVE    1      TO    FLG-SHOSAISIN
                      END-IF
                      PERFORM   2202-RECE82-TENSOU11-SEC
                 END-IF
      *
           END-PERFORM
      *
      *+++Æ±ÆüºÆÆþ±¡
      *
           PERFORM  VARYING  IDY    FROM    1   BY  1
                          UNTIL   IDY     >       31
      *
                 IF   RECE82-HKNCOMBI         =
                                   RECE82-DOUJITSU-HKNCOMBI(IDY)
      ***             MOVE    SPACE           TO    RECE82-NYUINRYOFLG
                      IF   RECE82-HKNCOMBI = WRK-DAY5(IDY)
                        CONTINUE
                      ELSE
                        MOVE  SPACE           TO    RECE82-NYUINRYOFLG
                      END-IF
                      MOVE    ZERO            TO    FLG-SHOSAISIN
                      IF  (WRK-DAY1(IDY)   NOT =    ZERO )
                      OR  (RECE82-NYUINDAY-KBN(IDY) = "1")
                               MOVE    1      TO    FLG-SHOSAISIN
                      END-IF
                      PERFORM   2202-RECE82-TENSOU11-SEC
                 END-IF
      *
           END-PERFORM
      *
      *+++
      *
           INITIALIZE                           SRYACCT-REC
           MOVE    RECE82-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    RECE82-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    RECE82-PTID          TO      ACCT-PTID
           MOVE    RECE82-SRYYM         TO      ACCT-SRYYM
           MOVE    RECE82-HKNCOMBI      TO      ACCT-HKNCOMBI
           MOVE    SRYACCT-REC          TO      MCPDATA-REC
           MOVE    "tbl_sryacct"        TO      MCP-TABLE
           MOVE    "key22"              TO      MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryacct"    TO      MCP-TABLE
               MOVE    "key22"          TO      MCP-PATHNAME
               PERFORM  900-SRYACCT-READ-SEC
               PERFORM  UNTIL
                  (FLG-SRYACCT        =    1)
                   IF   (ACCT-ZAITEN    NOT =    ZERO)    AND
                        (ACCT-ZAIKAISU  NOT =    ZERO)    AND
                        (ACCT-JIHOKBN       =   SPACE)    AND
                        (ACCT-ZAIKBN        =    ZERO)
                        MOVE    ZERO     TO    FLG-SHOSAISIN
                                               FLG-SHOSAISIN-GEN
                                               FLG-KYUKYU
      ***               IF   ACCT-SRYKBN  =  "11"  OR
      ***                                    "13"  OR  "14"
      ***                   PERFORM   2203-SHOSAISIN-HANTEI-SEC
      ***               END-IF
                        IF   ACCT-SRYKBN  =  "95"  OR  "96"
                            CONTINUE
                        ELSE
                            IF   ACCT-SRYKBN  =  "13"  OR  "80"
                               PERFORM   2206-SHOSAISIN-HANTEI2-SEC
                            ELSE
                               MOVE    1    TO    FLG-SHOSAISIN
                            END-IF
                        END-IF
                        IF   ACCT-SRYKBN  =  "11"  OR  "80"
                            PERFORM   2204-KYUKYU-HANTEI-SEC
                        END-IF
                        PERFORM   2205-RECE82-TENSOU12-SEC
                   END-IF
                   IF   (ACCT-ZAITEN    =        ZERO)    AND
                        (ACCT-ZAIKAISU  NOT =    ZERO)    AND
                        (ACCT-JIHOKBN       =   SPACE)    AND
                        (ACCT-ZAIKBN        =    ZERO)
                        MOVE    ZERO     TO    FLG-SHOSAISIN
                                               FLG-SHOSAISIN-GEN
                                               FLG-KYUKYU
                        IF   ACCT-SRYKBN  =  "11"  OR  "99" 
                            PERFORM   2203-SHOSAISIN-HANTEI-SEC
                        END-IF
                        PERFORM   2205-RECE82-TENSOU12-SEC
                   END-IF
                   MOVE    "tbl_sryacct"    TO      MCP-TABLE
                   MOVE    "key22"          TO      MCP-PATHNAME
                   PERFORM  900-SRYACCT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_sryacct"    TO      MCP-TABLE
           MOVE    "key22"          TO      MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
      *
           .
       220-RECE82-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ²ñ·×¥Õ¥é¥°ÂàÈò½èÍý                                          *
      ******************************************************************
       2201-NYUIN-DAY-TAIHI-SEC         SECTION.
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                                    UNTIL    IDY    >    31
      *
             IF       NACCT-DAY(IDY)   NOT =  ZERO 
      *
               IF     NACCT-ZAISKBKBN    =    "1"  
                  IF     NACCT-SRYCDTOTAL    =    099999916
                    CONTINUE
                  ELSE
                    MOVE   NACCT-DAY(IDY)   TO  WRK-DAY1(IDY) 
                    IF  ( NACCT-SRYKBN     = "90"      )
                    OR  ( NACCT-SRYCDTOTAL = 190799410 )
                    OR  ( NACCT-SRYCDTOTAL = 190799510 )
                       MOVE   "90" TO  RECE82-NYUDAY-SRYKBN(IDY)
                    ELSE
                       MOVE   "92" TO  RECE82-NYUDAY-SRYKBN(IDY)
                    END-IF
                  END-IF
               END-IF 
      *
               IF     NACCT-ZAISKBKBN    =    "2"  
                    MOVE   NACCT-DAY(IDY)   TO  WRK-DAY2(IDY) 
               END-IF 
      *
               IF   RECE82-SRYYM  >= "200604"
                 CONTINUE
               ELSE
                 IF     NACCT-ZAISKBKBN    =    "4"
                   IF    NACCT-SRYCDTOTAL  =    197000570 
                      MOVE   NACCT-DAY(IDY)   TO  WRK-DAY41(IDY)
                   ELSE
                      MOVE   NACCT-DAY(IDY)   TO  WRK-DAY4(IDY)
                   END-IF
                 END-IF
               END-IF
      *
               IF     NACCT-ZAISKBKBN    =    "5"  
                    MOVE   NACCT-DAY(IDY)   TO  WRK-DAY5(IDY) 
               END-IF 
      *
               IF     NACCT-ZAISKBKBN    =    "7"  
                    MOVE   NACCT-DAY(IDY)   TO  WRK-DAY7(IDY) 
                    ADD    NACCT-ZAITEN     TO  WRK-DAY7-ZAITEN(IDY)
               END-IF 
      *
             END-IF
      *
           END-PERFORM.
      *
       2201-NYUIN-DAY-TAIHI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥ÈÃæ´Ö¥Õ¥¡¥¤¥ë¤Î¹àÌÜÅ¾Á÷¡Ê£Æ£°£°£²¡Ë
      *****************************************************************
       2202-RECE82-TENSOU11-SEC                 SECTION.
      *
           IF   FLG-SHOSAISIN        =       1
                       MOVE    "1"   TO   TBL-JNISSU-DAY(IDY)
           END-IF
           .
       2202-RECE82-TENSOU11-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ²ñ·×¥Æ¡¼¥Ö¥ë¤ÎÆâÍÆ¤«¤é¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë¤òÆÉ¤ß¹þ¤ß¡¢
      *    ¿ÇÎÅ¼ÂÆü¿ô¤Î¥«¥¦¥ó¥È¤ò¹Ô¤¨¤ëºÞ¤Ç¤¢¤ë¤«¤ÎÈ½Äê
      *****************************************************************
       2203-SHOSAISIN-HANTEI-SEC                 SECTION.
      *
           PERFORM 800-ACCT-SETACT9-SEC
      *
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryact"     TO      MCP-TABLE
               MOVE    "key9"           TO      MCP-PATHNAME
               PERFORM  900-SRYACT-READ-SEC
               PERFORM  UNTIL  FLG-SRYACT    =    1
                   PERFORM   VARYING   SRYACT-IDX  FROM  1   BY   1
                             UNTIL    (SRYACT-IDX    >   5)  OR
                                      (SRY-SRYCD(SRYACT-IDX)
                                                         =   SPACE)
      ****                                               =   SPACE)  OR
      ****                            (FLG-SHOSAISIN     =    1)
      *
      **               PERFORM  900-TENSU-READ-SEC
      *
      **               IF       FLG-TENSU      =    ZERO
      **                 IF ( (TNS-JITUDAY    =     2)    AND
      **                      (TNS-DAYCNT     =     1   OR   2) ) OR
      **                    (  SRY-SRYCD(SRYACT-IDX) =  "099409901" OR
      **                                                "099999902" OR
      **                                                "099110001" OR
      **                                                "099120001" OR
      **                                                "111011810" OR
      **                                                 CONS-ROUSAI21 )
      **                     MOVE    1       TO   FLG-SHOSAISIN
      **                 END-IF
      **                 IF    SRY-SRYCD(SRYACT-IDX) =  "099409903"
      **                     MOVE    1       TO   FLG-SHOSAISIN-GEN
      **                 END-IF
      **               END-IF
                       IF  SRY-SRYCD(SRYACT-IDX) =  "099409901" OR
                                                    "099999902" OR
                                                    "099110001" OR
                                                    "099120001"
                           MOVE      1       TO   FLG-SHOSAISIN
                       END-IF
                       IF  SRY-SRYCD(SRYACT-IDX) =  "099409903"
                           MOVE      1       TO   FLG-SHOSAISIN-GEN
                       END-IF
      *
                   END-PERFORM
                   MOVE    "tbl_sryact"      TO   MCP-TABLE
                   MOVE    "key9"            TO   MCP-PATHNAME
                   PERFORM  900-SRYACT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_sryact"      TO   MCP-TABLE
           MOVE    "key9"            TO   MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
      *
           .
      *
       2203-SHOSAISIN-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ²ñ·×¥Æ¡¼¥Ö¥ë¤ÎÆâÍÆ¤«¤é¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë¤òÆÉ¤ß¹þ¤ß¡¢
      *    ¿ÇÎÅ¼ÂÆü¿ô¤Î¥«¥¦¥ó¥È¤ò¹Ô¤¨¤ëºÞ¤Ç¤¢¤ë¤«¤ÎÈ½Äê
      *****************************************************************
       2206-SHOSAISIN-HANTEI2-SEC                 SECTION.
      *
           PERFORM 800-ACCT-SETACT9-SEC
      *
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryact"     TO      MCP-TABLE
               MOVE    "key9"           TO      MCP-PATHNAME
               PERFORM  900-SRYACT-READ-SEC
               IF   FLG-SRYACT = ZERO
                 IF ((SRY-SRYCD(1) =
                      CONS-ROUSAI4  OR CONS-ROUSAI5  OR
                      CONS-ROUSAI6  OR CONS-ROUSAI7  OR
                      CONS-ROUSAI8  OR CONS-ROUSAI9  OR
                      CONS-ROUSAI10 OR CONS-ROUSAI11 OR
                      CONS-ROUSAI12                       ) AND
                     (RECE82-SRYYM  <= "201306"           ))
                 OR ((SRY-SRYCD(1) =
                      CONS-ROUSAI30 OR CONS-ROUSAI31 OR
                      CONS-ROUSAI32 OR CONS-ROUSAI33 OR
                      CONS-ROUSAI34 OR CONS-ROUSAI35 OR
                      CONS-ROUSAI36 OR CONS-ROUSAI37 OR
                      CONS-ROUSAI38 OR CONS-ROUSAI39 OR
                      CONS-ROUSAI40 OR CONS-ROUSAI41 OR
                      CONS-ROUSAI43                       ) AND
                     (RECE82-SRYYM  >= "201307"           ))
                 OR ( SRY-SRYCD(1)(1:5) =
                      "09591" OR "09592" OR "09593"        )
                      CONTINUE
                 ELSE
                      MOVE    1      TO   FLG-SHOSAISIN
                 END-IF
               END-IF
           END-IF
      *
           MOVE    "tbl_sryact"      TO   MCP-TABLE
           MOVE    "key9"            TO   MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
      *
           .
      *
       2206-SHOSAISIN-HANTEI2-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ²ñ·×¥Æ¡¼¥Ö¥ë¤ÎÆâÍÆ¤«¤é¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë¤òÆÉ¤ß¹þ¤ß¡¢
      *    µßµÞ´ÉÍý²Ã»»¤¬¤¢¤ë¤«¤ÎÈ½Äê
      *****************************************************************
       2204-KYUKYU-HANTEI-SEC                 SECTION.
      *
           PERFORM 800-ACCT-SETACT9-SEC
      *
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryact"     TO      MCP-TABLE
               MOVE    "key9"           TO      MCP-PATHNAME
               PERFORM  900-SRYACT-READ-SEC
               PERFORM  UNTIL  FLG-SRYACT    =    1
      *
                   PERFORM   VARYING   SRYACT-IDX  FROM  1   BY   1
                             UNTIL    (SRYACT-IDX    >   5)  OR
                                      (SRY-SRYCD(SRYACT-IDX)
                                                         =   SPACE)  OR
                                      (FLG-KYUKYU        =    1)
                     IF   RECE82-SRYYM    >=   "201307"
                       IF  SRY-SRYCD(SRYACT-IDX) =  CONS-ROUSAI42
                             MOVE    1      TO    FLG-KYUKYU
                       END-IF
                     ELSE
                       IF  SRY-SRYCD(SRYACT-IDX) =  CONS-ROUSAI2
                             MOVE    1      TO    FLG-KYUKYU
                       END-IF
                     END-IF
                   END-PERFORM
      *
                   MOVE    "tbl_sryact"   TO    MCP-TABLE
                   MOVE    "key9"         TO    MCP-PATHNAME
                   PERFORM  900-SRYACT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_sryact"         TO      MCP-TABLE
           MOVE    "key9"               TO      MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
      *
           .
      *
       2204-KYUKYU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥ÈÃæ´Ö¥Õ¥¡¥¤¥ë¤Î¹àÌÜÅ¾Á÷¡Ê£Æ£°£°£²¡Ë
      *****************************************************************
       2205-RECE82-TENSOU12-SEC                 SECTION.
      *
           IF   FLG-SHOSAISIN        =       1
              PERFORM    VARYING   IDY   FROM   1    BY   1
                           UNTIL    IDY   >      31
                  IF  ACCT-DAY(1 IDY)   NOT =    ZERO
                       MOVE   "1"  TO  TBL-JNISSU-DAY(IDY)
                  END-IF
              END-PERFORM
           END-IF
           IF   FLG-SHOSAISIN-GEN    =       1
              PERFORM    VARYING   IDY   FROM   1    BY   1
                           UNTIL    IDY   >      31
                  IF  ACCT-DAY(1 IDY)   NOT =    ZERO
                       MOVE   "1"  TO  TBL-JNISSU-DAY-GEN(IDY)
                  END-IF
              END-PERFORM
           END-IF
           IF   FLG-KYUKYU           =       1
              PERFORM    VARYING   IDY   FROM   1    BY   1
                     UNTIL  ( IDY                  >    31 )  OR
                            ( WRK-TAIHI-FLG        =     1 )
                  IF  ACCT-DAY(1 IDY)   NOT =    ZERO
                      MOVE   RECE82-SRYYM  TO  WRK-TAIHI-SRYYM
                      MOVE   IDY           TO  WRK-TAIHI-SRYD
                      MOVE   1             TO  WRK-TAIHI-FLG
                  END-IF
              END-PERFORM
           END-IF
           .
       2205-RECE82-TENSOU12-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥ÈÃæ´Ö¥Õ¥¡¥¤¥ë¤ÎÊÔ½¸¡Ê£Æ£°£°£²¡Ë
      *****************************************************************
       230-RECE82-HENSYU2-SEC                SECTION.
      *
           INITIALIZE                      ORCSROUNYUIN-AREA
           MOVE    RECE82-HOSPNUM      TO  LNK-SROUNYUIN-HOSPNUM
           MOVE    RECE82-PTID         TO  LNK-SROUNYUIN-PTID
           MOVE    RECE82-SRYYM        TO  LNK-SROUNYUIN-SANTEIYM
           MOVE    RECE82-HKNCOMBI     TO  LNK-SROUNYUIN-HKNCOMBI
           MOVE    "1"                 TO  LNK-SROUNYUIN-RYAKUKBN
           IF   (RECE82-HKNKBN  =  "6"    )
           AND  (RECE82-SRYYM  >= "201604")
             MOVE  "1"                 TO  LNK-SROUNYUIN-DAISANFLG
           END-IF
      *
           CALL    "ORCSROUNYUIN"      USING   MCPAREA
                                               ORCSROUNYUIN-AREA
                                               SPA-AREA
      *
           IF   LNK-SROUNYUIN-RC   =   ZERO
      *
              PERFORM    VARYING   IDY   FROM   1   BY   1
                          UNTIL    IDY    >    31
      *
                IF   LNK-SROUNYUIN-NYUIN-FLG(IDY)    =  "1"
                     PERFORM   2301-KHNTEN-HENSYU-SEC
                END-IF
                PERFORM        2303-KHNTEN-HENSYU2-SEC
      *
              END-PERFORM
      *
              PERFORM   2302-RYAKUSYO-HENSYU-SEC
      *
           END-IF
      *
           .
       230-RECE82-HENSYU2-EXT.
           EXIT.
      *
      **************************************************************
      *    Æþ±¡´ðËÜÎÁ¤È³°ÇñÅù¤ÎÊÔ½¸
      **************************************************************
       2301-KHNTEN-HENSYU-SEC           SECTION.
      *
           EVALUATE   LNK-SROUNYUIN-SRYKBN(IDY)
             WHEN   "90"
                IF    LNK-SROUNYUIN-ZAITEN(IDY)  NOT = ZERO
                  MOVE     ZERO     TO    FLG-ARI
                  PERFORM  VARYING  ID1    FROM    1   BY  1
                                UNTIL   ID1                   > 20
                                  OR    RECE82-NYUKHNNISSU(ID1)
                                                              = ZERO
                                  OR    FLG-ARI               = 1
                      IF  RECE82-NYUKHNRYO(ID1)  =  
                                          LNK-SROUNYUIN-ZAITEN(IDY)
                            ADD   1   TO   RECE82-NYUKHNNISSU(ID1)
                            ADD   LNK-SROUNYUIN-ZAITEN(IDY)
                                      TO   RECE82-NYUKHNKEI(ID1)
                            MOVE  1   TO   FLG-ARI
                      END-IF
                  END-PERFORM  
                  IF  FLG-ARI  =  ZERO  
                      ADD        1           TO  RECE82-NYUKHNNISSU(ID1)
                      MOVE   LNK-SROUNYUIN-ZAITEN(IDY)
                                             TO  RECE82-NYUKHNRYO(ID1)
                      ADD    LNK-SROUNYUIN-ZAITEN(IDY)
                                       TO  RECE82-NYUKHNKEI(ID1)
                  END-IF
                END-IF
      *
                COMPUTE  RECE82-NYUKHNKEI2  =
                         RECE82-NYUKHNKEI2  +
                         LNK-SROUNYUIN-ZAITEN-NACCT(IDY)
      *
                COMPUTE  RECE82-NYUKHNKEI2  =
                         RECE82-NYUKHNKEI2  +
                         LNK-SROUNYUIN-ZAITEN-ACCT(IDY)
      *
      **>       COMPUTE  RECE82-NYUTOKKEI2  =
      **>                RECE82-NYUTOKKEI2  +
      **>                LNK-SROUNYUIN-ZAITEN-ACCTETC(IDY)
      *
                COMPUTE  RECE82-NYUTOKKEI2  =
                         RECE82-NYUTOKKEI2  -
                         LNK-SROUNYUIN-GENTEN(IDY)
      *
             WHEN   "92"
                COMPUTE  WRK-NYUTOKRYO                   =
                         LNK-SROUNYUIN-ZAITEN(IDY)       +
                         LNK-SROUNYUIN-ZAITEN-NACCT(IDY) +
                         LNK-SROUNYUIN-ZAITEN-ACCT(IDY)
      *
                IF    WRK-NYUTOKRYO  NOT = ZERO
                  IF     LNK-SROUNYUIN-GAIHAKU(IDY) =  ZERO
                    MOVE     ZERO     TO    FLG-ARI
                    PERFORM  VARYING  ID1    FROM    1   BY  1
                        UNTIL ( ID1                          > 20    )  
                          OR  ( RECE82-NYUTOKNISSU(ID1)      = ZERO  )
                          OR  ( FLG-ARI                      = 1     )
                      IF  RECE82-NYUTOKRYO-RYAKU(ID1)  =  
                                      LNK-SROUNYUIN-RYAKUSYO(IDY)
                            ADD   1   TO   RECE82-NYUTOKNISSU(ID1)
                            ADD   WRK-NYUTOKRYO
                                      TO   RECE82-NYUTOKKEI(ID1)
                            MOVE  1   TO   FLG-ARI
                      END-IF
                    END-PERFORM  
                    IF  FLG-ARI  =  ZERO  
                      ADD        1           TO  RECE82-NYUTOKNISSU(ID1)
                      MOVE   LNK-SROUNYUIN-RYAKUSYO(IDY)
                                             TO  RECE82-NYUTOKRYO-RYAKU
                                                                   (ID1)
      ***             Î¬¾Î¤¬¶õÇò¤Î¾ì¹ç¤Î°Ù¤Î½èÃÖ
                      MOVE   99999999        TO  RECE82-NYUTOKRYO(ID1)
      *
                      ADD    WRK-NYUTOKRYO   TO  RECE82-NYUTOKKEI(ID1)
                    END-IF
                  ELSE
                    MOVE     ZERO     TO    FLG-ARI
                    PERFORM  VARYING  ID1    FROM    1   BY  1
                        UNTIL ( ID1                          > 20    )  
                          OR  ( RECE82-NYUTOKNISSU(ID1)      = ZERO  )
                          OR  ( FLG-ARI                      = 1     )
                      IF  RECE82-NYUTOKRYO(ID1)  =  
                                            WRK-NYUTOKRYO
                            ADD   1   TO   RECE82-NYUTOKNISSU(ID1)
                            ADD   WRK-NYUTOKRYO
                                      TO   RECE82-NYUTOKKEI(ID1)
                            MOVE  1   TO   FLG-ARI
                      END-IF
                    END-PERFORM  
                    IF  FLG-ARI  =  ZERO  
                      ADD        1           TO  RECE82-NYUTOKNISSU(ID1)
      ***             ÅÀ¿ô¤¬¥¼¥í¤Î¾ì¹ç¤Î°Ù¤Î½èÃÖ
                      MOVE   "£¹£¹£¹£¹£¹£¹£¹£¹£¹£¹"
                                             TO  RECE82-NYUTOKRYO-RYAKU
                                                                   (ID1)
      *
                      MOVE   WRK-NYUTOKRYO   TO  RECE82-NYUTOKRYO(ID1)
                      ADD    WRK-NYUTOKRYO   TO  RECE82-NYUTOKKEI(ID1)
                    END-IF
                  END-IF
                END-IF
      *
      **>       COMPUTE  RECE82-NYUTOKKEI2  =
      **>                RECE82-NYUTOKKEI2  +
      **>                LNK-SROUNYUIN-ZAITEN-ACCTETC(IDY)
      *
                COMPUTE  RECE82-NYUTOKKEI2  =
                         RECE82-NYUTOKKEI2  -
                         LNK-SROUNYUIN-GENTEN(IDY)
      *
           END-EVALUATE
      *
           IF  (LNK-SROUNYUIN-SRYKBN(IDY) =  SPACE)
           AND (RECE82-NYUINDAY-KBN(IDY)  =  "1"  )
      *
             COMPUTE       RECE82-NYUTOKKEI2  =
                           RECE82-NYUTOKKEI2  +
                           LNK-SROUNYUIN-ZAITEN-NACCT(IDY)
             COMPUTE       RECE82-NYUTOKKEI2  =
                           RECE82-NYUTOKKEI2  +  
                           LNK-SROUNYUIN-ZAITEN-ACCT(IDY)
      **>    COMPUTE       RECE82-NYUTOKKEI2  =
      **>                  RECE82-NYUTOKKEI2  +
      **>                  LNK-SROUNYUIN-ZAITEN-ACCTETC(IDY)
      *
             COMPUTE       RECE82-NYUTOKKEI2  =
                           RECE82-NYUTOKKEI2  -
                           LNK-SROUNYUIN-GENTEN(IDY)
      *
           END-IF
      *
           .
       2301-KHNTEN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    Î¬¾Î¤ÎÊÔ½¸
      *****************************************************************
       2302-RYAKUSYO-HENSYU-SEC                SECTION.
      *
           PERFORM  VARYING  IDY2    FROM    1   BY  1
                      UNTIL  (IDY2    >   20)
                       OR    (LNK-SROUNYUIN-RYAKUSYO2(IDY2) = SPACE)
      *
              MOVE   LNK-SROUNYUIN-RYAKUSYO2(IDY2)
                                 TO    RECE82-NYUSYUBETU(IDY2)
      *
           END-PERFORM
      *
      *    ÆÃÊÌ¤Ê´Ø·¸¤Ë¤¢¤ëÂ¾±¡
      *
           IF   (RECE82-TAINFLG          =  "1"     )
           AND  (RECE82-SRYYM           >=  "201804")
             MOVE     ZERO     TO    FLG-ARI
             PERFORM  VARYING  IDY2    FROM    1   BY  1
                       UNTIL  (IDY2                    >  20  )
                        OR    (RECE82-NYUSYUBETU(IDY2) = SPACE)
                        OR    (FLG-ARI                 =   1  )
               IF  RECE82-NYUSYUBETU(IDY2)(1:4) = "ÆÃÊÌ"
                 MOVE  1   TO   FLG-ARI
               END-IF
             END-PERFORM
             IF    FLG-ARI  =  ZERO
             AND   IDY2    <=   20
               MOVE   "ÆÃÊÌ"   TO   RECE82-NYUSYUBETU(IDY2)(1:4)
             END-IF
           END-IF
      *
           .
       2302-RYAKUSYO-HENSYU-EXT.
           EXIT.
      *
      **************************************************************
      *    Æþ±¡´ðËÜÎÁ¤È³°ÇñÅù¤ÎÊÔ½¸£²
      **************************************************************
       2303-KHNTEN-HENSYU2-SEC           SECTION.
      *
           EVALUATE   LNK-SROUNYUIN-SRYKBN(IDY)
             WHEN   "90"
                  COMPUTE  RECE82-NYUTOKKEI2  =
                           RECE82-NYUTOKKEI2  +  
                           LNK-SROUNYUIN-ZAITEN-ACCTETC(IDY)
             WHEN   "92"
                  COMPUTE  RECE82-NYUTOKKEI2  =
                           RECE82-NYUTOKKEI2  +
                           LNK-SROUNYUIN-ZAITEN-ACCTETC(IDY)
           END-EVALUATE
      *
           IF   LNK-SROUNYUIN-SRYKBN(IDY) =  SPACE
             COMPUTE       RECE82-NYUTOKKEI2  =
                           RECE82-NYUTOKKEI2  +
                           LNK-SROUNYUIN-ZAITEN-ACCTETC(IDY)
           END-IF
      *
           .
       2303-KHNTEN-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥ÈÃæ´Ö¥Õ¥¡¥¤¥ë¤ÎÊÔ½¸¡Ê£Æ£°£°£²¡Ë
      *****************************************************************
       250-RECE82-HENSYU4-SEC                SECTION.
      *
      **   IF    WRK-SHOKUJIRYOYO   NOT =  ZERO
              PERFORM  VARYING  IDY    FROM    1   BY  1
                             UNTIL   IDY     >       31
      *
                    IF  WRK-DAY1(IDY) NOT =  ZERO 
                    AND WRK-DAY5(IDY)  =  RECE82-HKNCOMBI
                         IF   (WRK-DAY4(IDY)          NOT = ZERO)
                         AND  ((WRK-DAY2(IDY)         =  ZERO  ) OR
                               (WRK-DAY2(IDY)        >=   4    ))
                         AND  (WRK-SHOKUJIRYOYO(IDY)  NOT = ZERO)
                              PERFORM   2501-NYUINKHN-GET4-SEC
                         END-IF
                    END-IF
      *
              END-PERFORM
      **   END-IF
      *
           .
       250-RECE82-HENSYU4-EXT.
           EXIT.
      *
      **************************************************************
      *    ¿©»öÎ¬¾Î¤Î¼èÆÀ
      **************************************************************
       2501-NYUINKHN-GET4-SEC           SECTION.
      *
           EVALUATE   WRK-DAY4(IDY)
             WHEN  1
                EVALUATE   WRK-SHOKUJIRYOYO(IDY)
                  WHEN  1
                     MOVE    "197000110"  TO  WRK-SRYCD
                     PERFORM  25011-NYUINKHN-SET4-SEC
                     IF    WRK-TOKUKANRIKASAN(IDY)  =  1
                        MOVE    "197000270"  TO  WRK-SRYCD
                        PERFORM  25011-NYUINKHN-SET4-SEC
                     END-IF
                     IF    WRK-DAY41(IDY)  =  1
                        MOVE    "197000570"  TO  WRK-SRYCD
                        PERFORM  25011-NYUINKHN-SET4-SEC
                     END-IF
                  WHEN  2
                     MOVE    "197000710"  TO  WRK-SRYCD
                     PERFORM  25011-NYUINKHN-SET4-SEC
                END-EVALUATE
             WHEN  2
             WHEN  3
             WHEN  4
                     MOVE    "197000110"  TO  WRK-SRYCD
                     PERFORM  25011-NYUINKHN-SET4-SEC
                     IF    WRK-TOKUKANRIKASAN(IDY)  =  1
                        MOVE    "197000270"  TO  WRK-SRYCD
                        PERFORM  25011-NYUINKHN-SET4-SEC
                     END-IF
                     IF    WRK-DAY41(IDY)  =  1
                        MOVE    "197000570"  TO  WRK-SRYCD
                        PERFORM  25011-NYUINKHN-SET4-SEC
                     END-IF
           END-EVALUATE
      *
           .
       2501-NYUINKHN-GET4-EXT.
           EXIT.
      *
      **************************************************************
      *    ¿©»öÎ¬¾Î¤Î¥»¥Ã¥È
      **************************************************************
       25011-NYUINKHN-SET4-SEC           SECTION.
      *
           MOVE    SPACE          TO   NYURYAKUSHO-REC
           INITIALIZE                  NYURYAKUSHO-REC
           MOVE    WRK-SRYCD      TO   NYURYAKUSHO-SRYCD
           MOVE    RECE82-SRYYM   TO   NYURYAKUSHO-YUKOSTYMD(1:6)
           MOVE    "01"           TO   NYURYAKUSHO-YUKOSTYMD(7:2)
           MOVE    RECE82-SRYYM   TO   NYURYAKUSHO-YUKOEDYMD(1:6)
           MOVE    "01"           TO   NYURYAKUSHO-YUKOEDYMD(7:2)
           PERFORM  900-NYURYAKUSHO-READ-SEC
           IF       FLG-NYURYAKUSHO    =    ZERO
                MOVE     ZERO     TO    FLG-ARI
                PERFORM  VARYING  ID1    FROM    1   BY  1
                       UNTIL   ID1                   > 3
                         OR    RECE82-SHOKUJISYUBETU(ID1) = SPACE
                         OR    FLG-ARI                = 1 
                    IF  RECE82-SHOKUJISYUBETU(ID1)  
                               =  NYURYAKUSHO-RYAKUSHO
                        MOVE  1   TO   FLG-ARI
                    END-IF
                END-PERFORM  
                IF  FLG-ARI  =  ZERO  
                    MOVE   NYURYAKUSHO-RYAKUSHO
                             TO   RECE82-SHOKUJISYUBETU(ID1)
                END-IF
           END-IF                  
      *
           .
       25011-NYUINKHN-SET4-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥ÈÃæ´Ö¥Õ¥¡¥¤¥ë¤ÎÊÔ½¸¡Ê£Æ£°£°£²¡Ë
      *****************************************************************
       260-RECE82-HENSYU9-SEC                SECTION.
      *
      *     ÅÀÅ©ÌôºÞ¡Ê´ïºà¡Ë¤Þ¤È¤á½èÍý
           PERFORM    2601-TENTEK-MATOME-SEC
      *
           MOVE       ZERO              TO      WRK-TENTEK-FLG
                                                WRK-TENTEK-FLG2
      *
           INITIALIZE                           SRYACCT-REC
           MOVE    RECE82-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    RECE82-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    RECE82-PTID          TO      ACCT-PTID
           MOVE    RECE82-SRYYM         TO      ACCT-SRYYM
           MOVE    RECE82-HKNCOMBI      TO      ACCT-HKNCOMBI
           MOVE    SRYACCT-REC          TO      MCPDATA-REC
           MOVE    "tbl_sryacct"        TO      MCP-TABLE
           MOVE    "key22"              TO      MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryacct"    TO      MCP-TABLE
               MOVE    "key22"          TO      MCP-PATHNAME
               PERFORM  900-SRYACCT-READ-SEC
               PERFORM  UNTIL
                  (FLG-SRYACCT        =    1)
                   IF   (ACCT-ZAITEN    NOT =    ZERO)    AND
                        (ACCT-ZAIKAISU  NOT =    ZERO)    AND
                        (ACCT-JIHOKBN       =   SPACE)
                     IF  ACCT-ZAIKBN        =    ZERO
                       MOVE    ZERO     TO    WRK-TEN
                                              WRK-KIN
                                              WRK-KIN2
                       PERFORM   2602-ENDATE-HANTEI-SEC
                       IF    RECE82-HKNKBN   =   "4" OR "6"
                         IF   ACCT-SRYKBN  =  "80"
                             PERFORM   2603-SINDAN-HANTEI-SEC
                         END-IF
      *
                         IF  WRK-TENTEK-FLG2  =   ZERO
                           PERFORM VARYING IDY FROM 1  BY 1
                                       UNTIL    IDY     >    31
                             COMPUTE  TBL-YKZTEN-JI(IDY)  =
                                      TBL-YKZTEN-JI(IDY)  +
                                      WRK-TENTEK-YKZTEN2(IDY) +
                                      WRK-TENTEK-KIZAITEN2(IDY)
                           END-PERFORM
                           MOVE  1        TO   WRK-TENTEK-FLG2
                         END-IF
      *
                         PERFORM VARYING IDY FROM 1  BY 1
                                   UNTIL    IDY     >    31
                           IF  ACCT-DAY(1 IDY)   NOT =  ZERO
                                MOVE  ACCT-DAY(1 IDY)  
                                       TO  WRK-ZAIKAISU-JI
                                PERFORM  2604-SYUGITEN-HANTEI-SEC
                           END-IF
                         END-PERFORM
                       END-IF
                       PERFORM   2605-RECE82-TENSOU9-SEC
                     ELSE
                       MOVE    ZERO     TO    WRK-TEN
                                              WRK-KIN
                                              WRK-KIN2
                       IF    RECE82-HKNKBN   =   "4" OR "6"
                         IF  WRK-TENTEK-FLG2  =   ZERO
                           PERFORM VARYING IDY FROM 1  BY 1
                                       UNTIL    IDY     >    31
                             COMPUTE  TBL-YKZTEN-JI(IDY)  =
                                      TBL-YKZTEN-JI(IDY)  +
                                      WRK-TENTEK-YKZTEN2(IDY) +
                                      WRK-TENTEK-KIZAITEN2(IDY)
                           END-PERFORM
                           MOVE  1        TO   WRK-TENTEK-FLG2
                         END-IF
      *
                         IF  ACCT-ZAIKBN   =  2
                          PERFORM VARYING IDY FROM 1  BY 1
                                    UNTIL    IDY     >    31
                           IF  ACCT-DAY(1 IDY)   NOT =  ZERO
                                MOVE  ACCT-DAY(1 IDY)  
                                       TO  WRK-ZAIKAISU-JI
                                PERFORM  2604-SYUGITEN-HANTEI-SEC
                           END-IF
                          END-PERFORM
                         END-IF
                       END-IF
                       PERFORM   2605-RECE82-TENSOU9-SEC
                     END-IF
                   END-IF
                   IF   (ACCT-ZAITEN        =    ZERO)    AND
                        (ACCT-ZAIKAISU  NOT =    ZERO)    AND
                        (ACCT-JIHOKBN       =   SPACE)
                     IF  ACCT-ZAIKBN        =    ZERO
                       IF    RECE82-HKNKBN   =   "4" OR "6"
                         IF   ACCT-SRYKBN  =  "80"
                             PERFORM   2603-SINDAN-HANTEI-SEC
                         END-IF
                       END-IF
                     END-IF
                   END-IF
                   MOVE    "tbl_sryacct"    TO      MCP-TABLE
                   MOVE    "key22"          TO      MCP-PATHNAME
                   PERFORM  900-SRYACCT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_sryacct"    TO      MCP-TABLE
           MOVE    "key22"          TO      MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
      *
      *    ÎÅÍÜÃ´Åö¼êÅö½¸·×
      *
           PERFORM  VARYING  IDY    FROM    1   BY  1
                     UNTIL   IDY     >     31
      *
              IF   ((WRK-DAY1(IDY)          NOT =  ZERO   ) OR
                    (RECE82-NYUINDAY-KBN(IDY)   =  "1"    ))
              AND  ( WRK-DAY5(IDY)      =  RECE82-HKNCOMBI )
                  IF  (WRK-DAY7(IDY)          NOT =  ZERO)
                  AND (WRK-DAY7-ZAITEN(IDY)   NOT =  ZERO)
                  AND ((WRK-DAY2(IDY)         =  ZERO   ) OR
                       (WRK-DAY2(IDY)        >=   4     ))
                     IF    RECE82-HKNKBN   =   "4" OR "6"
                      IF   (RECE82-HKNKBN    =  "4")
                      AND  (RECE82-JIBAIKBN  =  "1")
                        COMPUTE  TOTALKIN2-ACCT =  TOTALKIN2-ACCT
                                                +  120
                      ELSE
                        COMPUTE  TBL-YKZTEN-JI(IDY)  =
                                 TBL-YKZTEN-JI(IDY)  +
                                 WRK-DAY7-ZAITEN(IDY)
                      END-IF
                     ELSE
                        COMPUTE  TOTALTEN-ACCT  =  TOTALTEN-ACCT
                                                +  WRK-DAY7-ZAITEN(IDY)
                     END-IF
                  END-IF
              END-IF
      *
           END-PERFORM
      *
           .
       260-RECE82-HENSYU9-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀÅ©Ãí¼Í¤ÎÌôºÞ¡Ê´ïºà¡ËÅÀ¿ô»»Äê
      *****************************************************************
       2601-TENTEK-MATOME-SEC                    SECTION.
      *
           INITIALIZE                  WRK-TENTEK
      *
           INITIALIZE                  ORCSTENTEKAREA
           MOVE    "2"                 TO  ORCSTEN-KBN
           MOVE    RECE82-PTID         TO  ORCSTEN-PTID
           MOVE    RECE82-SRYYM        TO  ORCSTEN-SRYYM
           MOVE    RECE82-HKNCOMBI     TO  ORCSTEN-HKNCOMBI
      ***  MOVE    RECE82-HOSPNUM      TO  SPA-HOSPNUM
           CALL    "ORCSTENTEK"        USING
                                       SPA-AREA
                                       ORCSTENTEKAREA
      *    ÌôºÞÅÀ¿ô¤È´ïºàÅÀ¿ô
           PERFORM  VARYING  IDX1    FROM    1   BY  1
                      UNTIL  IDX1     >       31
      *
              IF  ORCSTEN-ZAITEN(IDX1)  NOT =  ZERO
                 ADD  ORCSTEN-ZAITEN(IDX1)  TO  WRK-TENTEK-YKZTEN
                 ADD  ORCSTEN-ZAITEN(IDX1)  TO  WRK-TENTEK-YKZTEN2
                                                             (IDX1)
              END-IF
      *
           END-PERFORM
      *
           PERFORM  VARYING  IDX1    FROM    1   BY  1
                      UNTIL  IDX1     >       50
                       OR    ORCSTEN-KIZ-ZAITEN(IDX1)  =  ZERO
      *
                MOVE    ZERO   TO   WRK-TENTEK-ZAIKAISU
                PERFORM  VARYING  IDX2    FROM    1   BY  1
                      UNTIL   IDX2     >       31
                  ADD    ORCSTEN-KIZ-DAY(IDX1 IDX2)  
                                     TO  WRK-TENTEK-ZAIKAISU
                END-PERFORM
      *
                COMPUTE  WRK-TENTEK-KIZAITEN  =
                         WRK-TENTEK-KIZAITEN  +
                         ( ORCSTEN-KIZ-ZAITEN(IDX1) *
                           WRK-TENTEK-ZAIKAISU ) 
      **
                MOVE    ZERO   TO   WRK-TENTEK-ZAIKAISU
                PERFORM  VARYING  IDX2    FROM    1   BY  1
                      UNTIL   IDX2     >       31
                  MOVE     ORCSTEN-KIZ-DAY(IDX1 IDX2)  
                                     TO  WRK-TENTEK-ZAIKAISU
                  COMPUTE  WRK-TENTEK-KIZAITEN2(IDX2)  =
                           WRK-TENTEK-KIZAITEN2(IDX2)  +
                         ( ORCSTEN-KIZ-ZAITEN(IDX1) *
                           WRK-TENTEK-ZAIKAISU ) 
                END-PERFORM
      *
           END-PERFORM
      *
           .
       2601-TENTEK-MATOME-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ²ñ·×¥Æ¡¼¥Ö¥ë¤ÎÆâÍÆ¤«¤é¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë¤òÆÉ¤ß¹þ¤ß¡¢
      *    ±ß·ú¤Æ¹àÌÜÅù¤Ç¤¢¤ë¤«¤ÎÈ½Äê
      *****************************************************************
       2602-ENDATE-HANTEI-SEC                 SECTION.
      *
           PERFORM 290-DAY-CHECK-SEC
      *
           PERFORM 800-ACCT-SETACT9-SEC
      *
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryact"     TO      MCP-TABLE
               MOVE    "key9"           TO      MCP-PATHNAME
               PERFORM  900-SRYACT-READ-SEC
               PERFORM  UNTIL  FLG-SRYACT    =    1
      *
                 PERFORM   VARYING   SRYACT-IDX  FROM  1   BY   1
                           UNTIL    (SRYACT-IDX    >   5)  OR
                                    (SRY-SRYCD(SRYACT-IDX)
                                                       =   SPACE)
      *
                   PERFORM  900-TENSU-READ-SEC
      *
                   IF       FLG-TENSU      =    ZERO
      *
                     IF    RECE82-HKNKBN   =   "4" OR "6"
                         IF   RECE82-SRYYM    >=   "201307"
                          IF  SRY-SRYCD(SRYACT-IDX) = CONS-ROUSAI1  OR
                                                      CONS-ROUSAI42 OR
                                                      CONS-ROUSAI21
                            ADD    TNS-TEN      TO    WRK-KIN
                          END-IF
                         ELSE
                          IF  SRY-SRYCD(SRYACT-IDX) = CONS-ROUSAI1  OR
                                                      CONS-ROUSAI2  OR
                                                      CONS-ROUSAI21
                            ADD    TNS-TEN      TO    WRK-KIN
                          END-IF
                         END-IF
                         IF ((SRY-SRYCD(SRYACT-IDX) = CONS-ROUSAI3 ) AND
                             (RECE82-SRYYM          < "200804"     ))
                         OR ((SRY-SRYCD(SRYACT-IDX) =
                              CONS-ROUSAI4  OR  CONS-ROUSAI5  OR
                              CONS-ROUSAI6  OR  CONS-ROUSAI7  OR
                              CONS-ROUSAI8  OR  CONS-ROUSAI9  OR
                              CONS-ROUSAI10 OR  CONS-ROUSAI11 OR
                              CONS-ROUSAI12 OR
                              CONS-ROUSAI13 OR  CONS-ROUSAI14 OR
                              CONS-ROUSAI15 OR  CONS-ROUSAI16 OR
                              CONS-ROUSAI17 OR  CONS-ROUSAI18 OR
                              CONS-ROUSAI19 OR  CONS-ROUSAI20      ) AND
                             (RECE82-SRYYM         <= "201306"     ))
                         OR ((SRY-SRYCD(SRYACT-IDX) =
                              CONS-ROUSAI22 OR  CONS-ROUSAI23 OR
                              CONS-ROUSAI24 OR  CONS-ROUSAI25 OR
                              CONS-ROUSAI26 OR  CONS-ROUSAI27 OR
                              CONS-ROUSAI28 OR  CONS-ROUSAI29 OR
                              CONS-ROUSAI30 OR  CONS-ROUSAI31 OR
                              CONS-ROUSAI32 OR  CONS-ROUSAI33 OR
                              CONS-ROUSAI34 OR  CONS-ROUSAI35 OR
                              CONS-ROUSAI36 OR  CONS-ROUSAI37 OR
                              CONS-ROUSAI38 OR  CONS-ROUSAI39 OR
                              CONS-ROUSAI40 OR  CONS-ROUSAI41 OR
                              CONS-ROUSAI43 OR  CONS-ROUSAI44 OR
                              CONS-ROUSAI45 OR  CONS-ROUSAI46 OR
                              CONS-ROUSAI47                        ) AND
                             (RECE82-SRYYM         >= "201307"     ))
                            ADD    TNS-TEN      TO    WRK-KIN2
                         END-IF
                         IF   RECE82-SRYYM         >= "201307"
                           EVALUATE  SRY-SRYCD(SRYACT-IDX)
                             WHEN    "101800570"  THRU  "101800860"
                             WHEN    "101801010"  THRU  "101801020"
                             WHEN    "101801190"  THRU  "101801420"
                              ADD    TNS-TEN      TO    WRK-KIN2
      *
                              COMPUTE WRK-TEN-KG2 = TNS-TEN
                           END-EVALUATE
                           IF   SRY-SRYCD(SRYACT-IDX) = "101800550" OR
                                         "101800560" OR "101800990" OR
                                         "101801030"
                              COMPUTE WRK-FUTANWARI = TNS-TEN / 100
      *
                              COMPUTE WRK-KEISAN-KG2 =
                                     (WRK-TEN-KG2 * WRK-FUTANWARI)
                              ADD  WRK-KEISAN-KG2 TO    WRK-KIN2
                           END-IF
                         ELSE
                           EVALUATE  SRY-SRYCD(SRYACT-IDX)
                             WHEN    "101910110"  THRU  "101910400"
                              ADD    TNS-TEN      TO    WRK-KIN2
                           END-EVALUATE
                         END-IF
                         IF  ( ACCT-SRYKBN                =  "80"    ) 
                         AND ( SRY-SRYCD(SRYACT-IDX)(1:5) =  "09593" 
                                                          OR "09594" ) 
                          IF  SRY-SRYSYUKBN = "809"
                            ADD    SRY-JIHIMONEY(SRYACT-IDX)
                                                TO    WRK-KIN2
                          ELSE
                            ADD    TNS-TEN      TO    WRK-KIN2
                          END-IF
                         END-IF
      *                 ¼«ÇåÀÕ¡¦ÎÅÍÜÃ´Åö¼êÅöÍÑÆÃÎã½èÍý
      *                ¡Ê¼«ÇåÀÕ¤Î¾ì¹ç¡¢£±£°ÅÀ¤ò£±£²£°±ß¤ËÆÉ¤ßÂØ¤¨¤ë¡Ë
      *                ¡ÊÎÅÍÜÃ´Åö¼êÅö¡§£±·î£±²ó¤Î»»Äê¡Ë
                         IF   SRY-SRYCD(SRYACT-IDX) =  CONS-RYOYOTEATE
                          IF   (RECE82-HKNKBN    =  "4")
                          AND  (RECE82-JIBAIKBN  =  "1")
                            ADD    120          TO    WRK-KIN2
                          END-IF
                         END-IF
                     ELSE 
                         IF ( SRY-SRYCD(SRYACT-IDX) = CONS-ROUSAI1  OR
                                                      CONS-ROUSAI21 )
                         OR ((SRY-SRYCD(SRYACT-IDX) = CONS-ROUSAI3 ) AND
                             (RECE82-SRYYM          < "200804"     ))
                         OR ((SRY-SRYCD(SRYACT-IDX) =
                              CONS-ROUSAI2  OR
                              CONS-ROUSAI4  OR  CONS-ROUSAI5  OR
                              CONS-ROUSAI6  OR  CONS-ROUSAI7  OR
                              CONS-ROUSAI8  OR  CONS-ROUSAI9  OR
                              CONS-ROUSAI10 OR  CONS-ROUSAI11 OR
                              CONS-ROUSAI12 OR
                              CONS-ROUSAI13 OR  CONS-ROUSAI14 OR
                              CONS-ROUSAI15 OR  CONS-ROUSAI16 OR
                              CONS-ROUSAI17 OR  CONS-ROUSAI18 OR
                              CONS-ROUSAI19 OR  CONS-ROUSAI20      ) AND
                             (RECE82-SRYYM         <= "201306"     ))
                         OR ((SRY-SRYCD(SRYACT-IDX) =
                              CONS-ROUSAI42 OR
                              CONS-ROUSAI22 OR  CONS-ROUSAI23 OR
                              CONS-ROUSAI24 OR  CONS-ROUSAI25 OR
                              CONS-ROUSAI26 OR  CONS-ROUSAI27 OR
                              CONS-ROUSAI28 OR  CONS-ROUSAI29 OR
                              CONS-ROUSAI30 OR  CONS-ROUSAI31 OR
                              CONS-ROUSAI32 OR  CONS-ROUSAI33 OR
                              CONS-ROUSAI34 OR  CONS-ROUSAI35 OR
                              CONS-ROUSAI36 OR  CONS-ROUSAI37 OR
                              CONS-ROUSAI38 OR  CONS-ROUSAI39 OR
                              CONS-ROUSAI40 OR  CONS-ROUSAI41 OR
                              CONS-ROUSAI43 OR  CONS-ROUSAI44 OR
                              CONS-ROUSAI45 OR  CONS-ROUSAI46 OR
                              CONS-ROUSAI47                        ) AND
                             (RECE82-SRYYM         >= "201307"     ))
                            ADD    TNS-TEN      TO    WRK-KIN
                            COMPUTE  WRK-TEN  =   WRK-TEN   +
                                     ( TNS-TEN / 10)
                         END-IF
                         IF   RECE82-SRYYM         >= "201307"
                           EVALUATE  SRY-SRYCD(SRYACT-IDX)
                             WHEN    "101800570"  THRU  "101800860"
                             WHEN    "101801010"  THRU  "101801020"
                             WHEN    "101801190"  THRU  "101801420"
                              ADD    TNS-TEN      TO    WRK-KIN
                              COMPUTE  WRK-TEN  =   WRK-TEN   +
                                       ( TNS-TEN / 10)
      *
                              COMPUTE WRK-TEN-KG  = TNS-TEN / 10
                              COMPUTE WRK-TEN-KG2 = TNS-TEN
                           END-EVALUATE
                           IF   SRY-SRYCD(SRYACT-IDX) = "101800550" OR
                                         "101800560" OR "101800990" OR
                                         "101801030"
                              COMPUTE WRK-FUTANWARI = TNS-TEN / 100
      *
                              COMPUTE WRK-KEISAN-KG2 =
                                     (WRK-TEN-KG2 * WRK-FUTANWARI)
                              ADD  WRK-KEISAN-KG2 TO    WRK-KIN
      *
                              COMPUTE WRK-KEISAN-KG  =
                                     (WRK-TEN-KG  * WRK-FUTANWARI)
                                                  + 0.5
                              ADD  WRK-KEISAN-KG  TO    WRK-TEN
                           END-IF
                         ELSE
                           EVALUATE  SRY-SRYCD(SRYACT-IDX)
                             WHEN    "101910110"  THRU  "101910400"
                              ADD    TNS-TEN      TO    WRK-KIN
                              COMPUTE  WRK-TEN  =   WRK-TEN   +
                                       ( TNS-TEN / 10)
                           END-EVALUATE
                         END-IF
                         IF  ( ACCT-SRYKBN                =  "80"    ) 
                         AND ( SRY-SRYCD(SRYACT-IDX)(1:5) =  "09593" 
                                                          OR "09594" ) 
                          IF  SRY-SRYSYUKBN = "809"
                            ADD    SRY-JIHIMONEY(SRYACT-IDX)
                                                TO    WRK-KIN
                            COMPUTE  WRK-TEN  =   WRK-TEN   +
                                    ( SRY-JIHIMONEY(SRYACT-IDX)
                                               / 10)
                          ELSE
                            ADD    TNS-TEN      TO    WRK-KIN
                            COMPUTE  WRK-TEN  =   WRK-TEN   +
                                     ( TNS-TEN / 10)
                          END-IF
                         END-IF
                     END-IF
      *
                   END-IF
      *
                 END-PERFORM
      *
                 MOVE    "tbl_sryact"     TO      MCP-TABLE
                 MOVE    "key9"           TO      MCP-PATHNAME
                 PERFORM   900-SRYACT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_sryact"     TO      MCP-TABLE
           MOVE    "key9"           TO      MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
           .
      *
       2602-ENDATE-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ²ñ·×¥Æ¡¼¥Ö¥ë¤ÎÆâÍÆ¤«¤é¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë¤òÆÉ¤ß¹þ¤ß¡¢
      *    ¼«ÇåÀÕ¤Î¿ÇÃÇ½ñÎÁ¡¦ÌÀºÙ½ñÎÁ¤Ç¤¢¤ë¤«¤ÎÈ½Äê
      *****************************************************************
       2603-SINDAN-HANTEI-SEC                 SECTION.
      *
           PERFORM 290-DAY-CHECK-SEC
      *
           PERFORM 800-ACCT-SETACT9-SEC
      *
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryact"     TO      MCP-TABLE
               MOVE    "key9"           TO      MCP-PATHNAME
               PERFORM  900-SRYACT-READ-SEC
               PERFORM  UNTIL  FLG-SRYACT    =    1
      *
                   PERFORM   VARYING   SRYACT-IDX  FROM  1   BY   1
                             UNTIL    (SRYACT-IDX    >   5)  OR
                                      (SRY-SRYCD(SRYACT-IDX)
                                                         =   SPACE)
      *
                     PERFORM  900-TENSU-READ-SEC
      *
                     IF       FLG-TENSU      =    ZERO
      *
                        IF   SRY-SRYCD(SRYACT-IDX)(1:5) =  "09591"
      *
                          COMPUTE  WRK-SINDAN-TUU = WRK-SINDAN-TUU +
                                                    ACCT-ZAIKAISU
      ****
                          IF    RECE82-TAXKBN      =   "2"
                            IF  SRY-SRYSYUKBN = "809"
                              COMPUTE  WRK-KEISAN  =
                               (SRY-JIHIMONEY(SRYACT-IDX) * WRK-S5)
                                                          + WRK-S3
                            ELSE
                              COMPUTE  WRK-KEISAN  =
                               (TNS-TEN                   * WRK-S5)
                                                          + WRK-S3
                            END-IF
                            COMPUTE  WRK-KEISAN2     =  WRK-KEISAN
                                                     *  ACCT-ZAIKAISU
                            COMPUTE  WRK-SINDAN-KIN  =  WRK-SINDAN-KIN
                                                     +  WRK-KEISAN2
                          ELSE
                            IF  SRY-SRYSYUKBN = "809"
                              COMPUTE  WRK-SINDAN-KIN  =
                                       WRK-SINDAN-KIN  +
                                      (SRY-JIHIMONEY(SRYACT-IDX)
                                                *  ACCT-ZAIKAISU)
                            ELSE
                              COMPUTE  WRK-SINDAN-KIN  =
                                       WRK-SINDAN-KIN  +
                                      (TNS-TEN  *  ACCT-ZAIKAISU)
                            END-IF
                          END-IF
      ****
                        END-IF
      *
                        IF   SRY-SRYCD(SRYACT-IDX)(1:5) =  "09592"
      *
                          COMPUTE  WRK-MEISAI-TUU = WRK-MEISAI-TUU +
                                                    ACCT-ZAIKAISU
      ****
                          IF    RECE82-TAXKBN      =   "2"
                            IF  SRY-SRYSYUKBN = "809"
                              COMPUTE  WRK-KEISAN  =
                               (SRY-JIHIMONEY(SRYACT-IDX) * WRK-S5)
                                                          + WRK-S3
                            ELSE
                              COMPUTE  WRK-KEISAN  =
                               (TNS-TEN                   * WRK-S5)
                                                          + WRK-S3
                            END-IF
                            COMPUTE  WRK-KEISAN2     =  WRK-KEISAN
                                                     *  ACCT-ZAIKAISU
                            COMPUTE  WRK-MEISAI-KIN  =  WRK-MEISAI-KIN
                                                     +  WRK-KEISAN2
                          ELSE
                            IF  SRY-SRYSYUKBN = "809"
                              COMPUTE  WRK-MEISAI-KIN  =
                                       WRK-MEISAI-KIN  +
                                      (SRY-JIHIMONEY(SRYACT-IDX)
                                                *  ACCT-ZAIKAISU)
                            ELSE
                              COMPUTE  WRK-MEISAI-KIN  =
                                       WRK-MEISAI-KIN  +
                                      (TNS-TEN  *  ACCT-ZAIKAISU)
                            END-IF
                          END-IF
      ****
                        END-IF
      *
                     END-IF
      *
                   END-PERFORM
      *
                   MOVE    "tbl_sryact"     TO      MCP-TABLE
                   MOVE    "key9"           TO      MCP-PATHNAME
                   PERFORM   900-SRYACT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_sryact"     TO      MCP-TABLE
           MOVE    "key9"           TO      MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
           .
      *
       2603-SINDAN-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ²ñ·×¥Æ¡¼¥Ö¥ë¤ÎÆâÍÆ¤«¤é¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë¤òÆÉ¤ß¹þ¤ß¡¢
      *    ÆüÃ±°Ì¤Î¼êµ»ÅÀ¡¦ÌôºÞÅÀÅù¤ò¥»¥Ã¥È
      *****************************************************************
       2604-SYUGITEN-HANTEI-SEC                 SECTION.
      *
           PERFORM 290-DAY-CHECK-SEC
      *
           PERFORM 800-ACCT-SETACT9-SEC
      *
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryact"     TO      MCP-TABLE
               MOVE    "key9"           TO      MCP-PATHNAME
               PERFORM  900-SRYACT-READ-SEC
               PERFORM  UNTIL  FLG-SRYACT    =    1
      *
                 IF    SRY-RENNUM     =     1
      *
                   IF    ACCT-SRYKBN       =  "90"  OR  "92"  OR
                                              "95"  OR  "96"  OR  "97"
                         CONTINUE
                   ELSE
                     IF       (ACCT-SRYCDTOTAL    =    630010002)
                     OR       (ACCT-ZAIKBN        =    2        )
                      IF  ACCT-ZAIKBN  =    2
                         COMPUTE  TBL-SYUTEN-JI(IDY)  =
                                  TBL-SYUTEN-JI(IDY)  -
                                 ( WRK-ZAIKAISU-JI * ACCT-SYUTEN1  )
                         COMPUTE  WRK-KEISAN-JI   =  ACCT-KIZAITEN  +
                                                     ACCT-YKZTEN
                         COMPUTE  TBL-YKZTEN-JI(IDY)  =
                                  TBL-YKZTEN-JI(IDY)  -
                                 ( WRK-ZAIKAISU-JI * WRK-KEISAN-JI )
                      ELSE
                         COMPUTE  TBL-YKZTEN-JI(IDY)  =
                                  TBL-YKZTEN-JI(IDY)  -
                                 ( WRK-ZAIKAISU-JI * ACCT-ZAITEN   )
                      END-IF
                     ELSE 
                      IF    ACCT-SRYKBN  =  "33"
                         EVALUATE  SRY-SRYSYUKBN
                            WHEN  "330"
                            WHEN  "331"
                            WHEN  "332"
                              COMPUTE  TBL-SYUTEN-JI(IDY)  =
                                       TBL-SYUTEN-JI(IDY)  +
                                      (WRK-ZAIKAISU-JI * ACCT-SYUTEN1)
                            WHEN  "340"
                              COMPUTE  TBL-SYUTEN-JI(IDY)  =
                                       TBL-SYUTEN-JI(IDY)  +
                                      (WRK-ZAIKAISU-JI * ACCT-SYUTEN1)
                              COMPUTE  WRK-KEISAN-JI = 
                                       ACCT-KIZAITEN + ACCT-YKZTEN
                              COMPUTE  TBL-YKZTEN-JI(IDY)  =
                                       TBL-YKZTEN-JI(IDY)  +
                                      (WRK-ZAIKAISU-JI * WRK-KEISAN-JI)
                         END-EVALUATE
                      ELSE
                       IF   ACCT-SRYKBN  =  "70"
                         COMPUTE  WRK-KEISAN-JI   =  ACCT-SYUTEN1
                                                  -  ACCT-SYUTEN2
                         COMPUTE  TBL-SYUTEN-JI(IDY)  =
                                  TBL-SYUTEN-JI(IDY)  +
                                 ( WRK-ZAIKAISU-JI * WRK-KEISAN-JI )
                         COMPUTE  WRK-KEISAN-JI   =  ACCT-SYUTEN2   +
                                                     ACCT-KIZAITEN  +
                                                     ACCT-YKZTEN
                         COMPUTE  TBL-YKZTEN-JI(IDY)  =
                                  TBL-YKZTEN-JI(IDY)  +
                                 ( WRK-ZAIKAISU-JI * WRK-KEISAN-JI )
                       ELSE
                         COMPUTE  TBL-SYUTEN-JI(IDY)  =
                                  TBL-SYUTEN-JI(IDY)  +
                                 ( WRK-ZAIKAISU-JI * ACCT-SYUTEN1  )
                         COMPUTE  WRK-KEISAN-JI   =  ACCT-KIZAITEN  +
                                                     ACCT-YKZTEN
                         COMPUTE  TBL-YKZTEN-JI(IDY)  =
                                  TBL-YKZTEN-JI(IDY)  +
                                 ( WRK-ZAIKAISU-JI * WRK-KEISAN-JI )
                       END-IF
                      END-IF
                     END-IF
                   END-IF
      *
                 END-IF
      *
                 IF   ( ACCT-SRYKBN       =  "95"  OR  "96" )
                 OR   ( ACCT-ZAIKBN       =   2             )
                   CONTINUE
                 ELSE
                   PERFORM   VARYING   SRYACT-IDX   FROM   1   BY   1
                         UNTIL    (SRYACT-IDX            >       5)  OR
                                  (SRY-SRYCD(SRYACT-IDX) =   SPACE)  
      *
                     PERFORM  900-TENSU-READ-SEC
      *
                     IF       FLG-TENSU      =    ZERO
      *
                       IF ( SRY-SRYCD(SRYACT-IDX) =  CONS-ROUSAI1  OR
                                                     CONS-ROUSAI21 )
                       OR ((SRY-SRYCD(SRYACT-IDX) =  CONS-ROUSAI3 ) AND
                           (RECE82-SRYYM          <  "200804"     ))
                       OR ((SRY-SRYCD(SRYACT-IDX) =
                            CONS-ROUSAI2  OR
                            CONS-ROUSAI4  OR  CONS-ROUSAI5  OR
                            CONS-ROUSAI6  OR  CONS-ROUSAI7  OR
                            CONS-ROUSAI8  OR  CONS-ROUSAI9  OR
                            CONS-ROUSAI10 OR  CONS-ROUSAI11 OR
                            CONS-ROUSAI12 OR
                            CONS-ROUSAI13 OR  CONS-ROUSAI14 OR
                            CONS-ROUSAI15 OR  CONS-ROUSAI16 OR
                            CONS-ROUSAI17 OR  CONS-ROUSAI18 OR
                            CONS-ROUSAI19 OR  CONS-ROUSAI20       ) AND
                           (RECE82-SRYYM         <= "201306"      ))
                       OR ((SRY-SRYCD(SRYACT-IDX) =
                            CONS-ROUSAI42 OR
                            CONS-ROUSAI22 OR  CONS-ROUSAI23 OR
                            CONS-ROUSAI24 OR  CONS-ROUSAI25 OR
                            CONS-ROUSAI26 OR  CONS-ROUSAI27 OR
                            CONS-ROUSAI28 OR  CONS-ROUSAI29 OR
                            CONS-ROUSAI30 OR  CONS-ROUSAI31 OR
                            CONS-ROUSAI32 OR  CONS-ROUSAI33 OR
                            CONS-ROUSAI34 OR  CONS-ROUSAI35 OR
                            CONS-ROUSAI36 OR  CONS-ROUSAI37 OR
                            CONS-ROUSAI38 OR  CONS-ROUSAI39 OR
                            CONS-ROUSAI40 OR  CONS-ROUSAI41 OR
                            CONS-ROUSAI43 OR  CONS-ROUSAI44 OR
                            CONS-ROUSAI45 OR  CONS-ROUSAI46 OR
                            CONS-ROUSAI47                         ) AND
                           (RECE82-SRYYM         >=  "201307"     ))
      *
                            COMPUTE  WRK-TEN-JI   =  TNS-TEN / 10
                            COMPUTE  TBL-SYUTEN-JI(IDY)  =
                                     TBL-SYUTEN-JI(IDY)  -
                              ( WRK-ZAIKAISU-JI * WRK-TEN-JI )
      *
                       END-IF
                       IF   RECE82-SRYYM         >= "201307"
                         EVALUATE  SRY-SRYCD(SRYACT-IDX)
                           WHEN    "101800570"  THRU  "101800860"
                           WHEN    "101801010"  THRU  "101801020"
                           WHEN    "101801190"  THRU  "101801420"
                              COMPUTE  WRK-TEN-JI   =  TNS-TEN / 10
                              COMPUTE  TBL-SYUTEN-JI(IDY)  =
                                       TBL-SYUTEN-JI(IDY)  -
                                ( WRK-ZAIKAISU-JI * WRK-TEN-JI )
      *
                              COMPUTE  WRK-TEN-KG = TNS-TEN / 10
                         END-EVALUATE
                         IF   SRY-SRYCD(SRYACT-IDX) = "101800550" OR
                                       "101800560" OR "101800990" OR
                                       "101801030"
                              COMPUTE  WRK-FUTANWARI = TNS-TEN / 100
      *
                              COMPUTE  WRK-KEISAN-KG =
                                      (WRK-TEN-KG * WRK-FUTANWARI)
                                                  + 0.5
                              COMPUTE  TBL-SYUTEN-JI(IDY)  =
                                       TBL-SYUTEN-JI(IDY)  -
                                ( WRK-ZAIKAISU-JI * WRK-KEISAN-KG )
                         END-IF
                       ELSE
                         EVALUATE  SRY-SRYCD(SRYACT-IDX)
                           WHEN    "101910110"  THRU  "101910400"
                              COMPUTE  WRK-TEN-JI   =  TNS-TEN / 10
                              COMPUTE  TBL-SYUTEN-JI(IDY)  =
                                       TBL-SYUTEN-JI(IDY)  -
                                ( WRK-ZAIKAISU-JI * WRK-TEN-JI )
                         END-EVALUATE
                       END-IF
      *
                       IF  ( ACCT-SRYKBN         =  "80"    ) AND
                           ( SRY-SRYCD(SRYACT-IDX)(1:5) =  "09591" 
                                                        OR "09592" 
                                                        OR "09593" 
                                                        OR "09594")
                         IF  SRY-SRYSYUKBN = "809"
                           COMPUTE WRK-TEN-JI =
                                   SRY-JIHIMONEY(SRYACT-IDX) / 10
                         ELSE
                           COMPUTE WRK-TEN-JI = TNS-TEN      / 10
                         END-IF
                         COMPUTE   TBL-SYUTEN-JI(IDY)  =
                                   TBL-SYUTEN-JI(IDY)  -
                                  (WRK-ZAIKAISU-JI * WRK-TEN-JI)
                       END-IF
      *
                       IF   SRY-SRYCD(SRYACT-IDX) =  CONS-YOUBUKASAN
                                                 OR  CONS-KYOBUKASAN
                                                 OR  CONS-KEIBUKASAN
                                                 OR  CONS-SOGAIKASAN
                         IF   RECE82-KOTEIKBN  =  SPACE  OR  "2"
                            COMPUTE  TBL-SYUTEN-JI(IDY)  =
                                     TBL-SYUTEN-JI(IDY)  -
                                    ( WRK-ZAIKAISU-JI * TNS-TEN )
                            COMPUTE  TBL-YKZTEN-JI(IDY)  =
                                     TBL-YKZTEN-JI(IDY)  +
                                    ( WRK-ZAIKAISU-JI * TNS-TEN )
                         END-IF
                       END-IF
      *
                       IF   SRY-SRYCD(SRYACT-IDX) =  CONS-RYOYOTEATE
                            COMPUTE  TBL-SYUTEN-JI(IDY)  =
                                     TBL-SYUTEN-JI(IDY)  -
                                    ( WRK-ZAIKAISU-JI * TNS-TEN )
                            IF ((RECE82-HKNKBN     =  "4") AND
                                (RECE82-JIBAIKBN   =  "2"))
                            OR ( RECE82-HKNKBN     =  "6" )
                              COMPUTE  TBL-YKZTEN-JI(ID1)  =
                                       TBL-YKZTEN-JI(ID1)  +
                                      ( WRK-ZAIKAISU-JI * TNS-TEN )
                            END-IF
                       END-IF
      *
                     END-IF
      *
                   END-PERFORM
                 END-IF
      *
                 MOVE    "tbl_sryact"     TO      MCP-TABLE
                 MOVE    "key9"           TO      MCP-PATHNAME
                 PERFORM   900-SRYACT-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE    "tbl_sryact"     TO      MCP-TABLE
           MOVE    "key9"           TO      MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
           .
      *
       2604-SYUGITEN-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥ÈÃæ´Ö¥Õ¥¡¥¤¥ë¤Î¹àÌÜÅ¾Á÷¡Ê£Æ£°£°£²¡Ë
      *****************************************************************
       2605-RECE82-TENSOU9-SEC                 SECTION.
      *
           IF        ACCT-SRYKBN   =    "90" OR "92" OR "95"  
                                             OR "96" OR "97"
               CONTINUE
           ELSE
               IF       (ACCT-SRYCDTOTAL    =    630010002)
               OR       (ACCT-ZAIKBN        =    2        )
                 COMPUTE   TOTALTEN-ACCT =
                           TOTALTEN-ACCT -
                           (ACCT-ZAITEN  *
                            ACCT-ZAIKAISU)
               ELSE
                 IF        WRK-TENTEK-FLG  =   ZERO
                     COMPUTE   TOTALTEN-ACCT        =
                               TOTALTEN-ACCT        +
                               WRK-TENTEK-YKZTEN    +
                               WRK-TENTEK-KIZAITEN
                     MOVE  1        TO   WRK-TENTEK-FLG
                 END-IF
                 IF        ACCT-SRYKBN     =    "33"
                     PERFORM   26051-TENTEK-SYUTEN-SEC
                     COMPUTE   TOTALTEN-ACCT =  
                               TOTALTEN-ACCT +
                               WRK-TENTEK-SYUTEN
                 ELSE
                     COMPUTE   TOTALTEN-ACCT =  
                               TOTALTEN-ACCT +
                               (ACCT-ZAITEN  *  
                                ACCT-ZAIKAISU)
                     IF  ( WRK-KIN  NOT =  ZERO )
                     OR  ( WRK-KIN2 NOT =  ZERO )
                     OR  ( WRK-TEN  NOT =  ZERO )                       
                       COMPUTE  TOTALTEN-ACCT  =  TOTALTEN-ACCT  -
                                                   (WRK-TEN    *
                                                    ACCT-ZAIKAISU)
      *
                       IF    RECE82-HKNKBN   =   "4" OR "6"
                         COMPUTE  TOTALKIN-ACCT  =  TOTALKIN-ACCT  +
                                                     (WRK-KIN    *
                                                      ACCT-ZAIKAISU)
                         COMPUTE  TOTALKIN2-ACCT =  TOTALKIN2-ACCT +
                                                     (WRK-KIN2   *
                                                      ACCT-ZAIKAISU)
                       ELSE
                         COMPUTE  TOTALKIN-ACCT  =  TOTALKIN-ACCT  +
                                                     (WRK-KIN    *
                                                      ACCT-ZAIKAISU)
                       END-IF
                     END-IF 
                 END-IF
               END-IF
           END-IF
           .
       2605-RECE82-TENSOU9-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀÅ©Ãí¼Í¤Î¼êµ»ÅÀ¿ô»»Äê
      *****************************************************************
       26051-TENTEK-SYUTEN-SEC                    SECTION.
      *
           PERFORM 800-ACCT-SETACT9-SEC
      *
           IF      MCP-RC             =    ZERO
                 MOVE    "tbl_sryact"     TO   MCP-TABLE
                 MOVE    "key9"           TO   MCP-PATHNAME
                 PERFORM  900-SRYACT-READ-SEC
           ELSE
                 MOVE    1                TO   FLG-SRYACT
           END-IF
      *
           MOVE    ZERO                   TO   WRK-TENTEK-SYUTEN
      *
           IF   FLG-SRYACT   =    ZERO
                EVALUATE  SRY-SRYSYUKBN
                    WHEN  "330"
                    WHEN  "331"
                    WHEN  "332"
                       COMPUTE WRK-TENTEK-SYUTEN = WRK-TENTEK-SYUTEN +
                               (ACCT-SYUTEN1 * ACCT-ZAIKAISU)
                    WHEN  "340"
                       COMPUTE WRK-TENTEK-SYUTEN = WRK-TENTEK-SYUTEN +
                               (ACCT-ZAITEN  * ACCT-ZAIKAISU)
                END-EVALUATE
           END-IF
      *
           MOVE    "tbl_sryact"     TO      MCP-TABLE
           MOVE    "key9"           TO      MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
      *
           .
       26051-TENTEK-SYUTEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼ÂÆü¿ô¤Î¹àÌÜÅ¾Á÷¡Ê£Æ£°£°£²¡Ë
      *****************************************************************
       270-JNISSU-SET-SEC                    SECTION.
      *
      *¼ÂÆü¿ô¤«¤é¸º¤¹¤ë
           PERFORM    VARYING    IDY    FROM    1   BY   1
                          UNTIL      IDY    >     31
                IF  (TBL-JNISSU-DAY(IDY)      NOT =  SPACE)
                AND (TBL-JNISSU-DAY-GEN(IDY)  NOT =  SPACE)
                    MOVE  SPACE  TO  TBL-JNISSU-DAY(IDY)
                END-IF
           END-PERFORM
      *
           IF   (RECE82-RYOSTYMD   =   SPACE)
           AND  (RECE82-RYOEDYMD   =   SPACE)
      *
      *      ½éÎò¤¬Æ±¤¸ÍúÎò¤ÎÈÏ°Ï¡Ê£¹£¹£¹¡Ë¤ÇÃÖ¤­´¹¤¨
             MOVE    ZERO   TO  FLG-OKIKAE
             MOVE    ZERO   TO  WRK-STDAY
             MOVE    ZERO   TO  WRK-STDAY2
             MOVE    ZERO   TO  WRK-EDDAY
             MOVE    ZERO   TO  WRK-EDDAY2
             MOVE    ZERO   TO  IDX4
             PERFORM    VARYING    IDY    FROM    1   BY   1
                         UNTIL     IDY     >     31
                 IF      RECE82-DAY (IDY) =  RECE82-HKNCOMBI
                     MOVE    IDY   TO   WRK-STDAY
                     MOVE    31    TO   IDY
                 END-IF
             END-PERFORM
             IF  WRK-STDAY >  1
               COMPUTE  IDX4 = WRK-STDAY - 1
               PERFORM    VARYING    IDY    FROM    1   BY   1
                           UNTIL     IDY     >    IDX4
                 IF      RECE82-DAY (IDY) =  999
                     MOVE    IDY   TO   WRK-STDAY2
                     MOVE    31    TO   IDY
                 END-IF
               END-PERFORM
               IF  WRK-STDAY2  NOT = ZERO
                 PERFORM  VARYING    IDY    FROM  WRK-STDAY2  BY   1
                           UNTIL     IDY     >    IDX4
                   IF    TBL-JNISSU-DAY(IDY)  NOT =  SPACE
                     MOVE     1    TO   FLG-OKIKAE
                     MOVE    31    TO   IDY
                   END-IF
                 END-PERFORM
               END-IF
             END-IF
      *
             PERFORM    VARYING    IDY    FROM   31   BY  -1
                         UNTIL     IDY     <      1
                 IF      RECE82-DAY (IDY) =  RECE82-HKNCOMBI
                     MOVE    IDY   TO   WRK-EDDAY
                     MOVE     1    TO   IDY
                 END-IF
             END-PERFORM
             IF  WRK-EDDAY < 31
               COMPUTE  IDX4 = WRK-EDDAY + 1
               PERFORM    VARYING    IDY    FROM   31   BY  -1
                           UNTIL     IDY     <    IDX4
                 IF      RECE82-DAY (IDY) =  999
                     MOVE    IDY   TO   WRK-EDDAY2
                     MOVE     1    TO   IDY
                 END-IF
               END-PERFORM
               IF  WRK-EDDAY2  NOT = ZERO
                 PERFORM  VARYING    IDY    FROM  WRK-EDDAY2  BY  -1
                           UNTIL     IDY     <    IDX4
                   IF    TBL-JNISSU-DAY(IDY)  NOT =  SPACE
                     MOVE     1    TO   FLG-OKIKAE
                     MOVE     1    TO   IDY
                   END-IF
                 END-PERFORM
               END-IF
             END-IF
      *
             IF     FLG-OKIKAE  =   1
               IF  WRK-STDAY2  NOT = ZERO
                  MOVE  RECE82-HKNCOMBI  TO  RECE82-DAY(WRK-STDAY2)
               END-IF
               IF  WRK-EDDAY2  NOT = ZERO
                  MOVE  RECE82-HKNCOMBI  TO  RECE82-DAY(WRK-EDDAY2)
               END-IF
             END-IF
      *
      *      Æ±·î¤ÎÍúÎò¤ÎÈÏ°Ï¡Ê£¹£¹£¹¡¦£¹£¹£¸¡Ë¤ÇÃÖ¤­´¹¤¨
             MOVE    ZERO   TO  FLG-OKIKAE
             MOVE    ZERO   TO  WRK-STDAY
             MOVE    ZERO   TO  WRK-STDAY2
             MOVE    ZERO   TO  WRK-EDDAY
             MOVE    ZERO   TO  WRK-EDDAY2
             MOVE    ZERO   TO  IDX4
             PERFORM    VARYING    IDY    FROM    1   BY   1
                         UNTIL     IDY     >     31
                 IF      RECE82-DAY (IDY) =  RECE82-HKNCOMBI
                     MOVE    IDY   TO   WRK-STDAY
                     MOVE    31    TO   IDY
                 END-IF
             END-PERFORM
             IF  WRK-STDAY >  1
               COMPUTE  IDX4 = WRK-STDAY - 1
               PERFORM    VARYING    IDY    FROM    1   BY   1
                           UNTIL     IDY     >    IDX4
                 IF      RECE82-DAY (IDY) =  999 OR 998
                     MOVE    IDY   TO   WRK-STDAY2
                     MOVE    31    TO   IDY
                 END-IF
               END-PERFORM
               IF  WRK-STDAY2  NOT = ZERO
                 PERFORM  VARYING    IDY    FROM  WRK-STDAY2  BY   1
                           UNTIL     IDY     >    IDX4
                   IF    TBL-JNISSU-DAY(IDY)  NOT =  SPACE
                     MOVE     1    TO   FLG-OKIKAE
                     MOVE    31    TO   IDY
                   END-IF
                 END-PERFORM
               END-IF
             END-IF
      *
             PERFORM    VARYING    IDY    FROM   31   BY  -1
                         UNTIL     IDY     <      1
                 IF      RECE82-DAY (IDY) =  RECE82-HKNCOMBI
                     MOVE    IDY   TO   WRK-EDDAY
                     MOVE     1    TO   IDY
                 END-IF
             END-PERFORM
             IF  WRK-EDDAY < 31
               COMPUTE  IDX4 = WRK-EDDAY + 1
               PERFORM    VARYING    IDY    FROM   31   BY  -1
                           UNTIL     IDY     <    IDX4
                 IF      RECE82-DAY (IDY) =  999 OR 998
                     MOVE    IDY   TO   WRK-EDDAY2
                     MOVE     1    TO   IDY
                 END-IF
               END-PERFORM
               IF  WRK-EDDAY2  NOT = ZERO
                 PERFORM  VARYING    IDY    FROM  WRK-EDDAY2  BY  -1
                           UNTIL     IDY     <    IDX4
                   IF    TBL-JNISSU-DAY(IDY)  NOT =  SPACE
                     MOVE     1    TO   FLG-OKIKAE
                     MOVE     1    TO   IDY
                   END-IF
                 END-PERFORM
               END-IF
             END-IF
      *
             IF     FLG-OKIKAE  =   1
               IF  WRK-STDAY2  NOT = ZERO
                  MOVE  RECE82-HKNCOMBI  TO  RECE82-DAY(WRK-STDAY2)
               END-IF
               IF  WRK-EDDAY2  NOT = ZERO
                  MOVE  RECE82-HKNCOMBI  TO  RECE82-DAY(WRK-EDDAY2)
               END-IF
             END-IF
      *
           END-IF
      *
           PERFORM    VARYING    IDY    FROM    1   BY   1
                          UNTIL      IDY    >     31
                IF    TBL-JNISSU-DAY(IDY)  NOT =  SPACE
                          ADD    1      TO    RECE82-JNISSU
                END-IF
           END-PERFORM
      *
           IF  ((RECE82-HKNKBN     =   "4") AND
                (RECE82-JIBAIKBN   =   "2"))
           OR  ((RECE82-HKNKBN     =   "5") AND
                (RECE82-KOMUKBN    =   "2"))
           OR  ( RECE82-HKNKBN     =   "6" )
             CONTINUE
           ELSE
             IF  RECE82-JNISSU     =   ZERO
                   MOVE    999    TO    RECE82-JNISSU
             END-IF
           END-IF
      *
           IF     WRK-TAIHI-FLG       =   1
                MOVE   WRK-TAIHI-FLG       TO  RECE82-KYUKYU-PRTKBN
                MOVE   WRK-TAIHI-SRYYMD    TO  RECE82-KYUKYUYMD
           END-IF
      *
           IF     WRK-SINDAN-TUU      =   ZERO                          
                CONTINUE                                                
           ELSE                                                         
                MOVE   WRK-SINDAN-TUU      TO  RECE82-SINDAN-TUU        
      ***>      IF    RECE82-TAXKBN      =   "2"                           
      ***>        COMPUTE  WRK-SINDAN-KIN  =
      ***>                (WRK-SINDAN-KIN  * WRK-S5) + WRK-S3
      ***>      END-IF                                                  
                MOVE   WRK-SINDAN-KIN      TO  RECE82-SINDAN-KIN        
           END-IF
      *
           IF     WRK-MEISAI-TUU      =   ZERO                          
                CONTINUE                                                
           ELSE                                                         
                MOVE   WRK-MEISAI-TUU      TO  RECE82-MEISAI-TUU        
      ***>      IF    RECE82-TAXKBN      =   "2"                           
      ***>        COMPUTE  WRK-MEISAI-KIN  =
      ***>                (WRK-MEISAI-KIN  * WRK-S5) + WRK-S3
      ***>      END-IF                                                  
                MOVE   WRK-MEISAI-KIN      TO  RECE82-MEISAI-KIN
           END-IF                                                       
      *
           IF    RECE82-HKNKBN   =   "4" OR "6"
      *
              PERFORM    VARYING    IDX    FROM   1   BY   1
                      UNTIL      IDX    >      20
                    COMPUTE  RECE82-TOTALTEN  = 
                             RECE82-TOTALTEN  + 
                             RECE82-NYUKHNKEI(IDX)
                    COMPUTE  RECE82-TOTALTEN  = 
                             RECE82-TOTALTEN  + 
                             RECE82-NYUTOKKEI(IDX)
              END-PERFORM
      *
              COMPUTE  RECE82-TOTALTEN  = 
                       RECE82-TOTALTEN  + 
                       RECE82-NYUKHNKEI2
              COMPUTE  RECE82-TOTALTEN  = 
                       RECE82-TOTALTEN  + 
                       RECE82-NYUTOKKEI2
      *
              MOVE     RECE82-TOTALTEN   TO   RECE82-NYUTOTALTEN
      *
              MOVE     ZERO              TO   WRK-SYUTEN-TOTALTEN
              MOVE     ZERO              TO   WRK-YKZTEN-TOTALTEN
              PERFORM    VARYING    IDY    FROM    1   BY   1              
                          UNTIL      IDY    >     31                    
      *
                  MOVE  TBL-SYUTEN-JI(IDY)  TO  RECE82-SYUTEN-JI(IDY)     
                  COMPUTE  WRK-SYUTEN-TOTALTEN = WRK-SYUTEN-TOTALTEN
                                               + TBL-SYUTEN-JI(IDY)
                  MOVE  TBL-YKZTEN-JI(IDY)  TO  RECE82-YKZTEN-JI(IDY)     
                  COMPUTE  WRK-YKZTEN-TOTALTEN = WRK-YKZTEN-TOTALTEN
                                               + TBL-YKZTEN-JI(IDY)
      *
              END-PERFORM                                                  
              ADD    WRK-SYUTEN-TOTALTEN  TO  RECE82-TOTALTEN
              ADD    WRK-YKZTEN-TOTALTEN  TO  RECE82-TOTALTEN-YAK
      *
              COMPUTE   WRK-KSNRATE     =  RECE82-KSNRATE  /  100
      *
              COMPUTE   RECE82-TOTALKIN   =  
                  (RECE82-TOTALTEN  *  RECE82-TANKA *  WRK-KSNRATE) 
                                                  +  0.5
      *
              COMPUTE   RECE82-TOTALKIN-YAK =  
                  (RECE82-TOTALTEN-YAK  *  RECE82-TANKA)  
                                                  +  0.5
      *
      ***     MOVE     TOTALKIN-ACCT   TO   RECE82-KINGAKU2-SYO
      *
      ***     MOVE     TOTALKIN2-ACCT  TO   RECE82-KINGAKU3-SYO
      *
      ***     COMPUTE  RECE82-TOTALKIN2     =  
      ***         (RECE82-KINGAKU2-SYO  *  WRK-KSNRATE)  +  0.5  
      *
           ELSE
      *
              PERFORM    VARYING    IDX    FROM   1   BY   1
                      UNTIL      IDX    >      20
                    COMPUTE  RECE82-TOTALTEN  = 
                             RECE82-TOTALTEN  + 
                             RECE82-NYUKHNKEI(IDX)
                    COMPUTE  RECE82-TOTALTEN  = 
                             RECE82-TOTALTEN  + 
                             RECE82-NYUTOKKEI(IDX)
              END-PERFORM
      *
              COMPUTE  RECE82-TOTALTEN  = 
                       RECE82-TOTALTEN  + 
                       RECE82-NYUKHNKEI2
              COMPUTE  RECE82-TOTALTEN  = 
                       RECE82-TOTALTEN  + 
                       RECE82-NYUTOKKEI2
      *
              MOVE     RECE82-TOTALTEN  TO   RECE82-NYUTOTALTEN
      *
              ADD      TOTALTEN-ACCT    TO   RECE82-TOTALTEN
      *
              IF    RECE82-HKNKBN   =   "5"
              AND   RECE82-KOMUKBN  =   "2"
                COMPUTE  RECE82-TOTALKIN   =   RECE82-TOTALTEN   *
                                               RECE82-KOMUTENTANKA
              ELSE
                COMPUTE  RECE82-TOTALKIN   =   RECE82-TOTALTEN   *
                                               RECE82-TANKA
              END-IF
      *
              MOVE     TOTALKIN-ACCT    TO   RECE82-KINGAKU2-SYO
      *
           END-IF                                                       
      *
      *
           PERFORM    VARYING    IDX    FROM   1   BY   1
                      UNTIL      IDX    >      20
                 IF   RECE82-NYUTOKRYO(IDX)  =  99999999
                    MOVE    ZERO    TO   RECE82-NYUTOKRYO(IDX)
                 END-IF
                 IF   RECE82-NYUTOKRYO-RYAKU(IDX)  
                                             =  "£¹£¹£¹£¹£¹£¹£¹£¹£¹£¹"
                    MOVE    SPACE   TO   RECE82-NYUTOKRYO-RYAKU(IDX)
                 END-IF
           END-PERFORM
      *
           .
       270-JNISSU-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Ç¡¼¥¿¹¹¿·½èÍý¡Ê£Æ£°£°£²¡Ë
      *****************************************************************
       280-RECE82-REWRITE-SEC                SECTION.
      *
           REWRITE   RECE82-REC
      *
           ADD     1                   TO  CNT-MOD
      *
           .
       280-RECE82-REWRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    »»ÄêÆü¥Á¥§¥Ã¥¯
      *****************************************************************
       290-DAY-CHECK-SEC              SECTION.
      *
           MOVE     ZERO         TO    WRK-TAIHI-DAY
           PERFORM   VARYING   IDX8   FROM    1    BY   1
                      UNTIL    IDX8     >    31
              IF   ACCT-DAY(1 IDX8)  NOT =   ZERO
                MOVE     IDX8    TO    WRK-TAIHI-DAY
                MOVE     31      TO    IDX8
              END-IF
           END-PERFORM
           IF   WRK-TAIHI-DAY  =  ZERO
              MOVE       01      TO    WRK-TAIHI-DAY
           END-IF
      *
           .
       290-DAY-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½ªÎ»½èÍý
      *****************************************************************
       300-TERM-SEC                SECTION.
      *
           CLOSE   RECE82-FILE
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *        ¥¹¥Æ¥Ã¥×´ÉÍý½ªÎ»½èÍý
               MOVE    "STE"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
      *
               PERFORM 900-DBDISCONNECT-SEC
           END-IF
      *
           DISPLAY "RECE820 IN  :" CNT-IN
           DISPLAY "        MOD :" CNT-MOD
           DISPLAY "*** ORCR0830 END ***"
           .
       300-TERM-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¨¥é¡¼½ÐÎÏ½èÍý
      *****************************************************************
       500-ERR-HENSYU-SEC                SECTION.
      *
           OPEN    INPUT   RECEERR-FILE
           IF      STS-RECEERR         =   ZERO
               CLOSE   RECEERR-FILE
           ELSE
               OPEN    OUTPUT              RECEERR-FILE
      *
               MOVE    WRK-RECEERR         TO  RECEERR-REC
               WRITE   RECEERR-REC
               CLOSE   RECEERR-FILE
      *
               IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *            ¥¸¥ç¥Ö´ÉÍý½ªÎ»½èÍý
                   MOVE    "JBE"           TO  SJOBKANRI-MODE
                   INITIALIZE                  JOBKANRI-REC
                   MOVE    WRK-RECEERR     TO  JOB-YOBI
                   MOVE    "9999"          TO  JOB-ERRCD
grpsys             PERFORM 900-CALL-ORCSJOB-SEC
               END-IF
           END-IF
      *                             
           MOVE    1                   TO  FLG-END
      *
           .
       500-ERR-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½èÍýÃæ»ß½èÍý
      *****************************************************************
       500-CANCEL-HENSYU-SEC                SECTION.
      *
           IF      WRK-PARA-SHELLID    =   "RECEPTX"
               CONTINUE
           ELSE
               MOVE    "CHK"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
               IF    ( SJOBKANRI-RETURN
                                       =   ZERO )
               AND   ( JOB-STOPFLG     =   1    )
                   MOVE    "½èÍý¤¬Ãæ»ß¤µ¤ì¤Þ¤·¤¿"
                                           TO  WRK-RECEERR
      *
                   OPEN    INPUT   RECEERR-FILE
                   IF      STS-RECEERR         =   ZERO
                       CLOSE   RECEERR-FILE
                   ELSE
                       OPEN    OUTPUT              RECEERR-FILE
      *    
                       MOVE    WRK-RECEERR         TO  RECEERR-REC
                       WRITE   RECEERR-REC
                       CLOSE   RECEERR-FILE
      *         
      *                ¥¸¥ç¥Ö´ÉÍý½ªÎ»½èÍý
                       MOVE    "CAN"           TO  SJOBKANRI-MODE
                       INITIALIZE                  JOBKANRI-REC
                       MOVE    WRK-RECEERR     TO  JOB-YOBI
                       MOVE    "8888"          TO  JOB-ERRCD
                       MOVE    2               TO  JOB-STOPFLG
grpsys                 PERFORM 900-CALL-ORCSJOB-SEC
                   END-IF
      *                             
                   MOVE    1                   TO  FLG-END
               END-IF
           END-IF
           .
       500-CANCEL-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       800-ACCT-SETACT9-SEC           SECTION.
      *
           INITIALIZE                           SRYACT-REC
           MOVE    ACCT-HOSPNUM         TO      SRY-HOSPNUM
           MOVE    ACCT-NYUGAIKBN       TO      SRY-NYUGAIKBN
           MOVE    ACCT-PTID            TO      SRY-PTID
           MOVE    ACCT-SRYYM           TO      SRY-SRYYM
           MOVE    ACCT-ZAINUM          TO      SRY-ZAINUM
           MOVE    SRYACT-REC           TO      MCPDATA-REC
           MOVE    "tbl_sryact"         TO      MCP-TABLE
           MOVE    "key9"               TO      MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
      *
           .
       800-ACCT-SETACT9-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ãæ´Ö¥Õ¥¡¥¤¥ë£Ò£Å£Á£Ä½èÍý
      *****************************************************************
       900-RECE82-READ-SEC            SECTION.
      *
           READ    RECE82-FILE   NEXT
               AT  END
                   MOVE    1     TO    FLG-END
               NOT  AT  END
                   ADD     1     TO    CNT-IN
                                       CNT-IN-CANCEL
      *
                   DISPLAY "RECE82  PTNUM=" RECE82-PTNUM
      *
                   PERFORM 910-SYSKANRI-HENSYU-SEC
      *
           END-READ
           .
       900-RECE82-READ-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¿ÇÎÅÇ¯·î¤ÎÂÐ¾Ý¤È¤Ê¤ë¥·¥¹´ÉÍý¤ò¼èÆÀ¡Ê¸ÄÊÌ½èÍý¤Î¤ß
      ****************************************************************
       910-SYSKANRI-HENSYU-SEC         SECTION.
      *
           IF   WRK-PARA-SRYYM    NOT =  ZERO
                CONTINUE
           ELSE
      *         °åÎÅµ¡´Ø£É£ÄÊÔ½¸
                MOVE  ZERO           TO  FLG-SET
                MOVE  RECE82-SRYYM   TO  WRK-SYS-SRYYMD(1:6)
                MOVE  "01"           TO  WRK-SYS-SRYYMD(7:2)
                PERFORM  VARYING  SYSKAN-IDX  FROM  1  BY  1
                      UNTIL  ( SYSKAN-IDX              >  100  )
                       OR    ( TBL-SYS1001(SYSKAN-IDX) = SPACE )
                       OR    ( FLG-SET                 =   1   )
      *
                  MOVE  TBL-SYS1001(SYSKAN-IDX)  TO  SYS-1001-REC
                  IF   ( SYS-1001-STYUKYMD  <=  WRK-SYS-SRYYMD    )
                  AND  ( WRK-SYS-SRYYMD     <=  SYS-1001-EDYUKYMD )
                     MOVE     1       TO    FLG-SET
                     MOVE    SYS-1001-TAX-HASU-KBN
                                      TO    WRK-TAX1001-KBN
                     IF   WRK-TAX1001-KBN = SPACE
                        MOVE   "2"    TO    WRK-TAX1001-KBN
                     END-IF
                  END-IF
      *
                END-PERFORM
                IF     FLG-SET  =  ZERO
                  STRING
                  "°åÎÅµ¡´Ø¾ðÊó¤¬¼èÆÀ¤Ç¤­¤Þ¤»¤ó¤Ç¤·¤¿¡£¿ÇÎÅÇ¯·î¡á"
                                               DELIMITED  BY  SIZE 
                       RECE82-SRYYM            DELIMITED  BY  SIZE
                                       INTO    WRK-RECEERR
                  END-STRING
                  PERFORM 500-ERR-HENSYU-SEC
                  MOVE    1               TO  FLG-END
                  GO  TO  910-SYSKANRI-HENSYU-EXT
                END-IF
      *
                MOVE      RECE82-SRYYM   TO  WRK-SRYYM-5000
                PERFORM   120-SYS-5000-CHK-SEC
      *         °åÎÅµ¡´Ø¸º»»¤Î¼èÆÀ¡Ê¥·¥¹¥Æ¥à´ÉÍý¥Æ¡¼¥Ö¥ë¤è¤ê¡Ë
                INITIALIZE                 WRK-SHOKUJIRYOYO-OCC
                                           WRK-TOKUKANRIKASAN-OCC
      *
                MOVE  ZERO         TO  FLG-SET
                MOVE  RECE82-SRYYM TO  WRK-SYS-SRYYMD(1:6)
                MOVE  "01"         TO  WRK-SYS-SRYYMD(7:2)
                PERFORM  VARYING  SYSKAN-IDX  FROM  1  BY  1
                     UNTIL  ( SYSKAN-IDX              >  100  )
                      OR    ( TBL-SYS5000(SYSKAN-IDX) = SPACE )
                      OR    ( FLG-SET                 =   1   )
      *
                   MOVE  TBL-SYS5000(SYSKAN-IDX)  TO  SYS-5000-REC
                   IF   ( SYS-5000-STYUKYMD  <=  WRK-SYS-SRYYMD    )
                   AND  ( WRK-SYS-SRYYMD     <=  SYS-5000-EDYUKYMD )
                      MOVE     1       TO    FLG-SET
                      PERFORM  110-SYSKAN-HENSYU-SEC
                      IF        WRK-SYS5000-COUNT    =     ZERO
                         CONTINUE
                      ELSE
                         PERFORM  130-SYS-5000-GET-SEC
                      END-IF
                   END-IF
      *
                END-PERFORM
                IF     FLG-SET  =  ZERO
                  STRING
             "°åÎÅµ¡´Ø¾ðÊó¡ÝÆþ±¡´ðËÜ¤¬¼èÆÀ¤Ç¤­¤Þ¤»¤ó¤Ç¤·¤¿¡£¿ÇÎÅÇ¯·î¡á"
                                           DELIMITED  BY  SIZE 
                        RECE82-SRYYM       DELIMITED  BY  SIZE
                                       INTO    WRK-RECEERR
                  END-STRING
                  PERFORM 500-ERR-HENSYU-SEC
                  MOVE    1               TO  FLG-END
                  GO  TO  910-SYSKANRI-HENSYU-EXT
                END-IF
           END-IF
      *
           .
      *
       910-SYSKANRI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡²ñ·×¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       900-NYUINACCT-READ-SEC         SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO                TO  FLG-NYUINACCT
               MOVE    MCPDATA-REC         TO  NYUINACCT-REC
           ELSE
               MOVE    1                   TO  FLG-NYUINACCT
               INITIALIZE                      NYUINACCT-REC
           END-IF
      *
           .
       900-NYUINACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ²ñ·×ÆÉ¹þ
      *****************************************************************
       900-SRYACCT-READ-SEC           SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO                TO  FLG-SRYACCT
               MOVE    MCPDATA-REC         TO  SRYACCT-REC
           ELSE
               MOVE    1                   TO  FLG-SRYACCT
               INITIALIZE                      SRYACCT-REC
           END-IF
      *
           .
       900-SRYACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¹Ô°ÙÆÉ¹þ
      *****************************************************************
       900-SRYACT-READ-SEC           SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  SRYACT-REC
               MOVE    ZERO                TO  FLG-SRYACT
           ELSE
               INITIALIZE                      SRYACT-REC
               MOVE    1                   TO  FLG-SRYACT
           END-IF
      *
           .
       900-SRYACT-READ-EXT.
           EXIT.
      *     
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¡¼ÆÉ¹þ¡Ê¼ç¥­¡¼¡Ë
      *****************************************************************
       900-TENSU-READ-SEC         SECTION.
      *
           MOVE    SPACE                  TO   TNS-TENSU-REC
           INITIALIZE                          TNS-TENSU-REC
      *
grpsys     MOVE    SRY-HOSPNUM            TO   TNS-HOSPNUM
           MOVE    SRY-SRYCD(SRYACT-IDX)  TO   TNS-SRYCD
           MOVE    ACCT-SRYYM             TO   TNS-YUKOSTYMD(1:6)
           MOVE    WRK-TAIHI-DAY          TO   TNS-YUKOSTYMD(7:2)
           MOVE    ACCT-SRYYM             TO   TNS-YUKOEDYMD(1:6)
           MOVE    WRK-TAIHI-DAY          TO   TNS-YUKOEDYMD(7:2)
      *
           MOVE    TNS-TENSU-REC          TO   MCPDATA-REC
      *
           MOVE    "tbl_tensu"            TO   MCP-TABLE
           MOVE    "key"                  TO   MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
grpsys         PERFORM 900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC     TO  TNS-TENSU-REC
                   MOVE    ZERO            TO  FLG-TENSU
               ELSE
                   MOVE    1               TO  FLG-TENSU
                   INITIALIZE                  TNS-TENSU-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-TENSU
               INITIALIZE                      TNS-TENSU-REC
           END-IF
      *
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       900-TENSU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡Î¬¾Î¥Þ¥¹¥¿¡¼ÆÉ¹þ¡Ê¼ç¥­¡¼¡Ë
      *****************************************************************
       900-NYURYAKUSHO-READ-SEC        SECTION.
      *
           MOVE    NYURYAKUSHO-REC     TO  MCPDATA-REC
      *
           MOVE    "tbl_nyuinryakusho" TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_nyuinryakusho" TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
grpsys         PERFORM 900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC     TO  NYURYAKUSHO-REC
                   MOVE    ZERO            TO  FLG-NYURYAKUSHO
               ELSE
                   MOVE    1               TO  FLG-NYURYAKUSHO
                   INITIALIZE                  NYURYAKUSHO-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-NYURYAKUSHO
               INITIALIZE                      NYURYAKUSHO-REC
           END-IF
      *
           MOVE    "tbl_nyuinryakusho"     TO  MCP-TABLE
           MOVE    "key"                   TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       900-NYURYAKUSHO-READ-EXT.
           EXIT.
      *
      **************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿ÆÉ¤ß¹þ¤ß½èÍý
      **************************************************************
       900-SYSKANRI-READ-SEC         SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           .
       900-SYSKANRI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿ÆÉ¹þ
      *****************************************************************
       910-SYSKANRI-INV-SEC         SECTION.
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key10"             TO  MCP-PATHNAME
grpsys         PERFORM 900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO            TO  FLG-SYSKANRI
               ELSE
                   MOVE    1               TO  FLG-SYSKANRI
               END-IF
           ELSE
               MOVE    1                   TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       910-SYSKANRI-INV-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¸¥ç¥Ö´ÉÍý£Ä£ÂÀ©¸æ½èÍý
      *****************************************************************
       900-CALL-ORCSJOB-SEC            SECTION.
      *
           MOVE    WRK-PARA-JOBID  TO  JOB-JOBID
           MOVE    WRK-PARA-SHELLID
                                   TO  JOB-SHELLID
grpsys     MOVE    SPA-HOSPNUM     TO  JOB-HOSPNUM
           CALL    "ORCSJOB"       USING
                                   ORCSJOBKANRIAREA 
                                   JOBKANRI-REC
                                   SPA-AREA
           .
       900-CALL-ORCSJOB-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â£Ó£Å£Ì£Å£Ã£Ô½èÍý
      *****************************************************************
       900-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           IF      MCP-RC              =   ZERO
               CONTINUE
           ELSE
               DISPLAY "SELECT ERR table=" MCP-TABLE
                       " pathname="        MCP-PATHNAME
           END-IF
           .
       900-DBSELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â£Æ£Å£Ô£Ã£È½èÍý
      *****************************************************************
       900-DBFETCH-SEC                SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       900-CLOSE-SEC               SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-CLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¥¢¥¯¥»¥¹½èÍý
      *****************************************************************
       900-ORCDBMAIN-SEC               SECTION.
      *
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
      *
       900-ORCDBMAIN-EXT.
           EXIT.
      *      
      *****************************************************************
      *    £Ä£Â¥ª¡¼¥×¥ó½èÍý
      *****************************************************************
       100-DBOPEN-SEC                SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBOPEN"            TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBSTART"           TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           .
       100-DBOPEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       900-DBDISCONNECT-SEC            SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBCOMMIT"          TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBDISCONNECT"      TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           .
       900-DBDISCONNECT-EXT.
           EXIT.
