      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this licence along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION              DIVISION.
       PROGRAM-ID.                 ORCSSYOKIKSN.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : 
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ½é´ü²Ã»»¥µ¥Ö
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  02/10/03    NACL-ÂÀÅÄ     ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *  00.00.01    NACL-¾®Æ¦Âô  04/03/11  Í­¾²¿ÇÎÅ½ê£±·²Æþ±¡´ðËÜÎÁ£±
      *                                     ¡Ê°å»ÕÇÛÃÖÅ¬¹ç¡Ë¤ÎÄÉ²Ã
      *  00.00.02    NACL-¾®Æ¦Âô  04/04/21  Í­¾²¿ÇÎÅ½ê£±·²Æþ±¡´ðËÜÎÁ£±
      *                                     ¡Ê´Ç¸î¡¦°å»ÕÇÛÃÖÅ¬¹ç¡Ë¤ÎÄÉ²Ã
      *Ê¿À®£±£¸Ç¯£´·î²þÄêÂÐ±þ
      *  00.00.03    NACL-¾®Æ¦Âô  06/03/15  Í­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁÂÐ±þ
      *  03.05.00    NACL-ÂÀÅÄ    07/05/10  ¥°¥ë¡¼¥×¿ÇÎÅÂÐ±þ
      *Ê¿À®£²£²Ç¯£´·î²þÄêÂÐ±þ
      *  00.00.00    NACL-¾®Æ¦Âô  10/03/02  Í­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ£³ÂÐ±þ
      *Ê¿À®£²£¶Ç¯£´·î²þÄêÂÐ±þ
      *  00.00.00    NACL-¾®Æ¦Âô  14/02/27  Í­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ£±
      *                                     Í­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ£²
      *                                     Í­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ£³ÄÉ²ÃÂÐ±þ
      *****************************************************************
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *
       DATA                        DIVISION.
      *FILE                        SECTION.
      *
       WORKING-STORAGE             SECTION.
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-ERR                     PIC 9(01).
           03  FLG-SINRYOJO-VAL-1804       PIC 9(01).
           03  FLG-SINRYOJO-VAL-2204       PIC 9(01).
           03  FLG-SINRYOJO-VAL-2604       PIC 9(01).
           03  FLG-TENSU                   PIC 9(01).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX1                        PIC 9(05).
           03  IDX2                        PIC 9(05).
           03  IDX3                        PIC 9(05).
           03  IDX4                        PIC 9(05).
           03  IDX5                        PIC 9(05).
      *
      *    ºî¶ÈÎÎ°è
       01  WRK-AREA.
           03  WRK-YMD                     PIC X(10). 
           03  WRK-SYMD.
               05  WRK-SYY                 PIC 9(04).
               05  WRK-SMM                 PIC 9(02).
               05  WRK-SDD                 PIC 9(02).
           03  WRK-HENYMDG                 PIC X(09).
           03  WRK-STYMD                   PIC X(08).
           03  WRK-EDYMD                   PIC X(08).
           03  WRK-NISSU1                  PIC 9(05).
           03  WRK-NISSU2                  PIC 9(05).
           03  WRK-KJNYMD                  PIC X(08).
           03  WRK-ZOGENPTN                PIC X(01).
           03  WRK-ZOGEN                   PIC S9(05).
           03  WRK-KEISANYMD               PIC X(08).
           03  WRK-KIKAN-TBL.
               05  WRK-KIKAN-OCC           OCCURS  7.
                   07  WRK-KIKAN-STZOGENPTN
                                           PIC X(01).
                   07  WRK-KIKAN-STZOGEN   PIC 9(03).
                   07  WRK-KIKAN-EDZOGENPTN
                                           PIC X(01).
                   07  WRK-KIKAN-EDZOGEN   PIC 9(03).
           03  WRK-KGNTEN-TBL.
               05  WRK-KGNTEN-OCC          OCCURS  7.
                   07  WRK-KGNTEN-SRYCD    PIC X(09).
                   07  WRK-KGNTEN-YUKOSTYMD
                                           PIC X(08).
                   07  WRK-KGNTEN-YUKOEDYMD
                                           PIC X(08).
      *
      *    ¸ÇÄêÃÍÎÎ°è
       01  CONST-AREA.
           03  CONST-KGNTEN-VAL.
               05  CONST-KGNTEN-01-ST      PIC X(4)    VALUE   "1001".
               05  CONST-KGNTEN-01-ED      PIC X(4)    VALUE   "1014".
               05  CONST-KGNTEN-02-ST      PIC X(4)    VALUE   "1015".
               05  CONST-KGNTEN-02-ED      PIC X(4)    VALUE   "1030".
               05  CONST-KGNTEN-03-ST      PIC X(4)    VALUE   "1031".
               05  CONST-KGNTEN-03-ED      PIC X(4)    VALUE   "1090".
               05  CONST-KGNTEN-04-ST      PIC X(4)    VALUE   "1091".
               05  CONST-KGNTEN-04-ED      PIC X(4)    VALUE   "1180".
               05  CONST-KGNTEN-05-ST      PIC X(4)    VALUE   "1091".
               05  CONST-KGNTEN-05-ED      PIC X(4)    VALUE   "1180".
               05  CONST-KGNTEN-06-ST      PIC X(4)    VALUE   "1181".
               05  CONST-KGNTEN-06-ED      PIC X(4)    VALUE   "3001".
               05  CONST-KGNTEN-07-ST      PIC X(4)    VALUE   "1180".
               05  CONST-KGNTEN-07-ED      PIC X(4)    VALUE   "9999".
           03  CONST-SINRYOJO-VAL.
               05  CONST-SINRYOJO-01-ST    PIC X(4)    VALUE   "1001".
               05  CONST-SINRYOJO-01-ED    PIC X(4)    VALUE   "1007".
               05  CONST-SINRYOJO-02-ST    PIC X(4)    VALUE   "1008".
               05  CONST-SINRYOJO-02-ED    PIC X(4)    VALUE   "1014".
               05  CONST-SINRYOJO-03-ST    PIC X(4)    VALUE   "1015".
               05  CONST-SINRYOJO-03-ED    PIC X(4)    VALUE   "1030".
               05  CONST-SINRYOJO-04-ST    PIC X(4)    VALUE   "1031".
               05  CONST-SINRYOJO-04-ED    PIC X(4)    VALUE   "1090".
               05  CONST-SINRYOJO-05-ST    PIC X(4)    VALUE   "1091".
               05  CONST-SINRYOJO-05-ED    PIC X(4)    VALUE   "1180".
               05  CONST-SINRYOJO-06-ST    PIC X(4)    VALUE   "1181".
               05  CONST-SINRYOJO-06-ED    PIC X(4)    VALUE   "3001".
               05  CONST-SINRYOJO-07-ST    PIC X(4)    VALUE   "1180".
               05  CONST-SINRYOJO-07-ED    PIC X(4)    VALUE   "9999".
           03  CONST-SINRYOJO-VAL-1804.
               05  CONST-SINRYOJO-01-ST    PIC X(4)    VALUE   "1001".
               05  CONST-SINRYOJO-01-ED    PIC X(4)    VALUE   "1007".
               05  CONST-SINRYOJO-02-ST    PIC X(4)    VALUE   "1008".
               05  CONST-SINRYOJO-02-ED    PIC X(4)    VALUE   "1014".
               05  CONST-SINRYOJO-03-ST    PIC X(4)    VALUE   "1015".
               05  CONST-SINRYOJO-03-ED    PIC X(4)    VALUE   "1030".
               05  CONST-SINRYOJO-04-ST    PIC X(4)    VALUE   "1031".
               05  CONST-SINRYOJO-04-ED    PIC X(4)    VALUE   "1999".
               05  CONST-SINRYOJO-05-ST    PIC X(4)    VALUE   "1091".
               05  CONST-SINRYOJO-05-ED    PIC X(4)    VALUE   "1180".
               05  CONST-SINRYOJO-06-ST    PIC X(4)    VALUE   "1181".
               05  CONST-SINRYOJO-06-ED    PIC X(4)    VALUE   "3001".
               05  CONST-SINRYOJO-07-ST    PIC X(4)    VALUE   "1180".
               05  CONST-SINRYOJO-07-ED    PIC X(4)    VALUE   "9999".
      *    Í­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ£±¡¢£²¡¢£³¡ÊÊ¿À®£²£²Ç¯ÅÙ²þÄê¡Ë
           03  CONST-SINRYOJO-VAL-2204.
               05  CONST-SINRYOJO-01-ST    PIC X(4)    VALUE   "1001".
               05  CONST-SINRYOJO-01-ED    PIC X(4)    VALUE   "1014".
               05  CONST-SINRYOJO-02-ST    PIC X(4)    VALUE   "1015".
               05  CONST-SINRYOJO-02-ED    PIC X(4)    VALUE   "1030".
               05  CONST-SINRYOJO-03-ST    PIC X(4)    VALUE   "1031".
               05  CONST-SINRYOJO-03-ED    PIC X(4)    VALUE   "1999".
               05  CONST-SINRYOJO-04-ST    PIC X(4)    VALUE   "1031".
               05  CONST-SINRYOJO-04-ED    PIC X(4)    VALUE   "1999".
               05  CONST-SINRYOJO-05-ST    PIC X(4)    VALUE   "1032".
               05  CONST-SINRYOJO-05-ED    PIC X(4)    VALUE   "1033".
               05  CONST-SINRYOJO-06-ST    PIC X(4)    VALUE   "1034".
               05  CONST-SINRYOJO-06-ED    PIC X(4)    VALUE   "1035".
               05  CONST-SINRYOJO-07-ST    PIC X(4)    VALUE   "1036".
               05  CONST-SINRYOJO-07-ED    PIC X(4)    VALUE   "9999".
      *    Í­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ£±¡¢£²¡¢£³¡¢£´¡¢£µ¡¢£¶¡ÊÊ¿À®£²£¶Ç¯ÅÙ²þÄê¡Ë
           03  CONST-SINRYOJO-VAL-2604.
               05  CONST-SINRYOJO-01-ST    PIC X(4)    VALUE   "1001".
               05  CONST-SINRYOJO-01-ED    PIC X(4)    VALUE   "1014".
               05  CONST-SINRYOJO-02-ST    PIC X(4)    VALUE   "1015".
               05  CONST-SINRYOJO-02-ED    PIC X(4)    VALUE   "1030".
               05  CONST-SINRYOJO-03-ST    PIC X(4)    VALUE   "1031".
               05  CONST-SINRYOJO-03-ED    PIC X(4)    VALUE   "1999".
               05  CONST-SINRYOJO-04-ST    PIC X(4)    VALUE   "1031".
               05  CONST-SINRYOJO-04-ED    PIC X(4)    VALUE   "1999".
               05  CONST-SINRYOJO-05-ST    PIC X(4)    VALUE   "1032".
               05  CONST-SINRYOJO-05-ED    PIC X(4)    VALUE   "1033".
               05  CONST-SINRYOJO-06-ST    PIC X(4)    VALUE   "1034".
               05  CONST-SINRYOJO-06-ED    PIC X(4)    VALUE   "1035".
               05  CONST-SINRYOJO-07-ST    PIC X(4)    VALUE   "1036".
               05  CONST-SINRYOJO-07-ED    PIC X(4)    VALUE   "9999".
      *
      *    ·ë³ËÉÂÅïÆþ±¡´ðËÜÎÁ¡ÊÊ¿À®£²£¸Ç¯ÅÙ²þÄê¡Ë
           03  CONST-KEKKAKU-VAL-2804.
               05  CONST-KEKKAKU-01-ST      PIC X(4)    VALUE   "1001".
               05  CONST-KEKKAKU-01-ED      PIC X(4)    VALUE   "1014".
      *
               05  CONST-KEKKAKU-02-ST      PIC X(4)    VALUE   "1015".
               05  CONST-KEKKAKU-02-ED      PIC X(4)    VALUE   "1030".
      *
               05  CONST-KEKKAKU-03-ST      PIC X(4)    VALUE   "1031".
               05  CONST-KEKKAKU-03-ED      PIC X(4)    VALUE   "1060".
      *
               05  CONST-KEKKAKU-04-ST      PIC X(4)    VALUE   "1061".
               05  CONST-KEKKAKU-04-ED      PIC X(4)    VALUE   "1090".
      *
               05  CONST-KEKKAKU-05-ST      PIC X(4)    VALUE   "1091".
               05  CONST-KEKKAKU-05-ED      PIC X(4)    VALUE   "1180".
      *
               05  CONST-KEKKAKU-06-ST      PIC X(4)    VALUE   "1181".
               05  CONST-KEKKAKU-06-ED      PIC X(4)    VALUE   "3001".
      *
               05  CONST-KEKKAKU-07-ST      PIC X(4)    VALUE   "1180".
               05  CONST-KEKKAKU-07-ED      PIC X(4)    VALUE   "9999".
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    Æþ±¡ÎÁ»»Äê¥Þ¥¹¥¿
       01  NYUINKHN-REC.
           COPY  "CPNYUINKHN.INC".
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿¡Ý
           COPY    "CPTENSU.INC".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *    ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
           COPY    "CPORCSGDAY.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPAREA".
           COPY    "MCPDATA.INC".
      *
      *****************************************************************
      *    Ï¢Íí¡¡ÎÎ°è
      *****************************************************************
        LINKAGE                     SECTION.
      *
           COPY  "CPORCSSYOKIKSN.INC".
           COPY  "COMMON-SPA".
      *
       PROCEDURE                   DIVISION    USING
                                               ORCSSYOKIKSNAREA
                                               SPA-AREA.
           .
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           INITIALIZE              SYOKIKSN-OT-AREA
                                   FLG-AREA
                                   IDX-AREA
                                   WRK-AREA
      *
      *    ¥Ñ¥é¥á¡¼¥¿¥Á¥§¥Ã¥¯½èÍý
           PERFORM 100-PARA-CHK-SEC
           IF    ( FLG-ERR NOT =   ZERO )
               MOVE    FLG-ERR TO  SYOKIKSN-OT-RC
               GO  TO  000-PROC-EXT
           END-IF
      *
      *    ÊÔ½¸½èÍý
           IF     SYOKIKSN-IN-SANTEISTYMD   >=  "20140401"
               PERFORM 202-EDIT-SEC
           ELSE
               IF     SYOKIKSN-IN-SANTEISTYMD   >=  "20100401"
                   PERFORM 201-EDIT-SEC
               ELSE
                   PERFORM 200-EDIT-SEC
               END-IF
           END-IF
      *
           IF    ( FLG-ERR NOT =   ZERO )
               MOVE    FLG-ERR TO  SYOKIKSN-OT-RC
               GO  TO  000-PROC-EXT
           END-IF
      *
           .
      *
       000-PROC-EXT.
           EXIT    PROGRAM
           .
      *
      *****************************************************************
      *    ¥Ñ¥é¥á¡¼¥¿¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       100-PARA-CHK-SEC            SECTION.
      *
      *    ÄÌ»»Æü¿ô¤Ë¿ô»ú¤¬ÀßÄê¤µ¤ì¤Æ¤¤¤ë¤³¤È
           IF    ( SYOKIKSN-IN-TUSANNISSU  IS  NUMERIC )
               CONTINUE
           ELSE
               MOVE    1       TO  FLG-ERR
               GO  TO  100-PARA-CHK-EXT
           END-IF
      *
      *    ´ðËÜÅÀ¿ô¿ÇÎÅ¥³¡¼¥É ¤¬ÀßÄê¤µ¤ì¤Æ¤¤¤ë¤³¤È
           IF    ( SYOKIKSN-IN-KHNSRYCD    =   SPACE )
               MOVE    1       TO  FLG-ERR
               GO  TO  100-PARA-CHK-EXT
           END-IF
      *
      *    »»Äê³«»ÏÆü¤¬ÀßÄê¤µ¤ì¤Æ¤¤¤ë¤³¤È
           IF    ( SYOKIKSN-IN-SANTEISTYMD =   SPACE )
               MOVE    1       TO  FLG-ERR
               GO  TO  100-PARA-CHK-EXT
           END-IF
      *
      *    »»Äê³«»ÏÆü¤¬ÆüÉÕ¤È¤·¤ÆÂÅÅö¤Ç¤¢¤ë¤³¤È
           MOVE    SYOKIKSN-IN-SANTEISTYMD
                                   TO  WRK-YMD
           PERFORM 5002-HIZUKE-CHK-SEC
           IF    ( FLG-ERR         NOT =   ZERO )
               GO  TO  100-PARA-CHK-EXT
           END-IF
      *
           .
       100-PARA-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÊÔ½¸½èÍý¡ÊÊ¿À®£²£²Ç¯£³·î°ÊÁ°¡Ë
      *****************************************************************
       200-EDIT-SEC                SECTION.
      *
           IF    ( SYOKIKSN-IN-KHNSRYCD    =   "190097010"
            OR                                 "190097110"
            OR                                 "190097210"
            OR                                 "190097310"
            OR                                 "190109510"
            OR                                 "190109670"
            OR                                 "190805710"
            OR                                 "190805810"
            OR                                 "190805910"
            OR                                 "190806010"
            OR                                 "190808710"
            OR                                 "190808870"
            OR                                 "190117070"
            OR                                 "190813270"
            OR                                 "190117670"
            OR                                 "190813870"
            OR                                 "099999950"
            OR                                 "099999951"   )
      *        Ê¿À®£±£¸Ç¯£´·î²þÄêÂÐ±þ¡ÊÍ­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ¡Ë
               IF  (SYOKIKSN-IN-KHNSRYCD  = "099999950"  OR
                                            "099999951") AND
                   SYOKIKSN-IN-SANTEISTYMD(1:6) >= "200604"
                   MOVE    1       TO    FLG-SINRYOJO-VAL-1804
                   MOVE    CONST-SINRYOJO-VAL-1804  TO  WRK-KIKAN-TBL
               ELSE
                   MOVE    CONST-SINRYOJO-VAL  TO  WRK-KIKAN-TBL
               END-IF
           ELSE
               MOVE    CONST-KGNTEN-VAL    TO  WRK-KIKAN-TBL
           END-IF
      *
      *    ´ð½àÆü¼èÆÀ½èÍý
           PERFORM 210-KJNYMD-GET-SEC
      *
      *    Æþ±¡ÎÁ»»Äê¥Þ¥¹¥¿¸¡º÷½èÍý
           PERFORM 210-NYUINKHN-SEL-SEC
           IF    ( FLG-ERR NOT =   ZERO )
               GO  TO  200-EDIT-EXT
           END-IF
      *
      *    Ê¿À®£±£¸Ç¯£´·î²þÄêÂÐ±þ¡ÊÍ­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ¡Ë
      **     DISPLAY  "FLG-SINRYOJO-VAL-1804 = " FLG-SINRYOJO-VAL-1804
           IF   FLG-SINRYOJO-VAL-1804     =    1
               IF   SYOKIKSN-IN-KHNSRYCD  = "099999950"
                   MOVE    SPACE        TO  SYOKIKSN-IN-KHNSRYCD
      *            Í­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ£±
      **             MOVE   "190097010"   TO  NYUKHN-KAGENCD (1)
      **             MOVE   "190097110"   TO  NYUKHN-KAGENCD (2)
      **             MOVE   "190119510"   TO  NYUKHN-KAGENCD (3)
      **             MOVE   "190119610"   TO  NYUKHN-KAGENCD (4)
               ELSE
                   MOVE    SPACE        TO  SYOKIKSN-IN-KHNSRYCD
      *            Í­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ£±
      **             MOVE   "190097210"   TO  NYUKHN-KAGENCD (1)
      **             MOVE   "190097310"   TO  NYUKHN-KAGENCD (2)
      **             MOVE   "190119710"   TO  NYUKHN-KAGENCD (3)
      **             MOVE   "190119810"   TO  NYUKHN-KAGENCD (4)
               END-IF
           END-IF
      *    ¥ï¡¼¥¯²Ã¸º»»¥Æ¡¼¥Ö¥ë¤Ë¿ÇÎÅ¹Ô°Ù¥³¡¼¥É¤ÈÍ­¸ú´ü´Ö¤òÀßÄê
           INITIALIZE              WRK-KGNTEN-TBL
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   7 )
      *
               MOVE    NYUKHN-KAGENCD (IDX1)
                                   TO  WRK-KGNTEN-SRYCD (IDX1)
      *        ´ð½àÆü
               MOVE    WRK-KJNYMD
                                   TO WRK-YMD
               MOVE    WRK-KIKAN-STZOGENPTN (IDX1)
                                   TO WRK-ZOGENPTN
               MOVE    WRK-KIKAN-STZOGEN (IDX1)
                                   TO WRK-ZOGEN
               PERFORM 220-HIZUKE-GET-SEC
               MOVE    WRK-KEISANYMD
                                   TO  WRK-KGNTEN-YUKOSTYMD (IDX1)
      *
      *        Í­¸ú´ü´Ö½ªÎ»Æü
               MOVE    WRK-KJNYMD
                                   TO WRK-YMD
               MOVE    WRK-KIKAN-EDZOGENPTN (IDX1)
                                   TO WRK-ZOGENPTN
               MOVE    WRK-KIKAN-EDZOGEN (IDX1)
                                   TO WRK-ZOGEN
               PERFORM 220-HIZUKE-GET-SEC
               MOVE    WRK-KEISANYMD
                                   TO  WRK-KGNTEN-YUKOEDYMD (IDX1)
      *
           END-PERFORM
      *
      *    ¥ï¡¼¥¯²Ã¸º»»¥Æ¡¼¥Ö¥ë¤Î³ºÅö¤ÎÍ­¸ú´ü´Ö³«»ÏÆü¤Ë»»Äê³«»ÏÆü¤ò
      *    ÀßÄê¤¹¤ë
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   7 )
      *
               IF    ( SYOKIKSN-IN-SANTEISTYMD
                                   >=  WRK-KGNTEN-YUKOSTYMD (IDX1) )
                AND  ( SYOKIKSN-IN-SANTEISTYMD
                                   <=  WRK-KGNTEN-YUKOEDYMD (IDX1) )
                       MOVE    SYOKIKSN-IN-SANTEISTYMD
                                       TO  WRK-KGNTEN-YUKOSTYMD (IDX1)
               ELSE
                   IF    ( SYOKIKSN-IN-SANTEISTYMD
                                   >   WRK-KGNTEN-YUKOEDYMD (IDX1))
                       MOVE    SPACE   TO  WRK-KGNTEN-SRYCD  (IDX1)
                   END-IF
               END-IF
      *
           END-PERFORM
      *
      *    Æ±°ìÅÀ¿ô¤Î¥Ç¡¼¥¿¤¬Â¸ºß¤¹¤ë¾ì¹ç¤Ï¤Þ¤È¤á¤ë
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   6 )
               COMPUTE IDX2    =   IDX1    +   1
               IF    ( WRK-KGNTEN-SRYCD (IDX1) NOT =   SPACE )
                   IF    ( WRK-KGNTEN-SRYCD (IDX1)
                                   =   WRK-KGNTEN-SRYCD (IDX2))
                       PERFORM VARYING IDX3    FROM    IDX2    BY  1
                           UNTIL     ( IDX3    >   7 )
                               OR    ( WRK-KGNTEN-SRYCD (IDX1)
                                       NOT =   WRK-KGNTEN-SRYCD (IDX3))
                           MOVE    WRK-KGNTEN-YUKOEDYMD (IDX3)
                               TO  WRK-KGNTEN-YUKOEDYMD (IDX1)
                           MOVE    SPACE   TO  WRK-KGNTEN-SRYCD (IDX3)
                       END-PERFORM
                   END-IF
               END-IF
      *
           END-PERFORM
      *
      *    ¥ï¡¼¥¯²Ã¸º»»¥Æ¡¼¥Ö¥ë¤ÎÆâÍÆ¤òÊÖµÑÃÍ¤ËÀßÄê
           MOVE    ZERO            TO  IDX2
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   7)
      *
               IF    ( WRK-KGNTEN-SRYCD  (IDX1)
                                   NOT =   SPACE )
                   COMPUTE IDX2    =   IDX2    +   1
                   MOVE    WRK-KGNTEN-SRYCD (IDX1)
                                   TO  SYOKIKSN-OT-KGNSRYCD  (IDX2)
                   MOVE    WRK-KGNTEN-YUKOSTYMD (IDX1)
                                   TO  SYOKIKSN-OT-YUKOSTYMD (IDX2)
                   MOVE    WRK-KGNTEN-YUKOEDYMD (IDX1)
                                   TO  SYOKIKSN-OT-YUKOEDYMD (IDX2)
               END-IF
      *
           END-PERFORM
      *
           MOVE    ZERO            TO  SYOKIKSN-OT-RC
      *
           .
       200-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ÊÔ½¸½èÍý¡ÊÊ¿À®£²£²Ç¯£´·î²þÄê°Ê¹ß¡Ë
      *****************************************************************
       201-EDIT-SEC                SECTION.
      *
           IF    ( SYOKIKSN-IN-KHNSRYCD    =   "099999950"
            OR                                 "099999951"
            OR                                 "099999952"   )
      *        Ê¿À®£²£²Ç¯£´·î²þÄêÂÐ±þ¡ÊÍ­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ¡Ë
               MOVE    1       TO    FLG-SINRYOJO-VAL-2204
               MOVE    CONST-SINRYOJO-VAL-2204  TO  WRK-KIKAN-TBL
           ELSE
               MOVE    CONST-KGNTEN-VAL    TO  WRK-KIKAN-TBL
           END-IF
      *
      *    ´ð½àÆü¼èÆÀ½èÍý
           PERFORM 210-KJNYMD-GET-SEC
      *
      *    Æþ±¡ÎÁ»»Äê¥Þ¥¹¥¿¸¡º÷½èÍý
           PERFORM 210-NYUINKHN-SEL-SEC
           IF    ( FLG-ERR NOT =   ZERO )
               GO  TO  201-EDIT-EXT
           END-IF
      *
      *    Ê¿À®£²£²Ç¯£´·î²þÄêÂÐ±þ¡ÊÍ­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ¡Ë
           IF   FLG-SINRYOJO-VAL-2204     =    1
               IF   SYOKIKSN-IN-KHNSRYCD  = "099999950"  OR
                                            "099999951"  OR
                                            "099999952"
                   MOVE    SPACE        TO  SYOKIKSN-IN-KHNSRYCD
               END-IF
           END-IF
      *    ¥ï¡¼¥¯²Ã¸º»»¥Æ¡¼¥Ö¥ë¤Ë¿ÇÎÅ¹Ô°Ù¥³¡¼¥É¤ÈÍ­¸ú´ü´Ö¤òÀßÄê
           INITIALIZE              WRK-KGNTEN-TBL
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   7 )
      *
               MOVE    NYUKHN-KAGENCD (IDX1)
                                   TO  WRK-KGNTEN-SRYCD (IDX1)
      *        ´ð½àÆü
               MOVE    WRK-KJNYMD
                                   TO WRK-YMD
               MOVE    WRK-KIKAN-STZOGENPTN (IDX1)
                                   TO WRK-ZOGENPTN
               MOVE    WRK-KIKAN-STZOGEN (IDX1)
                                   TO WRK-ZOGEN
               PERFORM 220-HIZUKE-GET-SEC
               MOVE    WRK-KEISANYMD
                                   TO  WRK-KGNTEN-YUKOSTYMD (IDX1)
      *
      *        Í­¸ú´ü´Ö½ªÎ»Æü
               MOVE    WRK-KJNYMD
                                   TO WRK-YMD
               MOVE    WRK-KIKAN-EDZOGENPTN (IDX1)
                                   TO WRK-ZOGENPTN
               MOVE    WRK-KIKAN-EDZOGEN (IDX1)
                                   TO WRK-ZOGEN
               PERFORM 220-HIZUKE-GET-SEC
               MOVE    WRK-KEISANYMD
                                   TO  WRK-KGNTEN-YUKOEDYMD (IDX1)
      *
           END-PERFORM
      *
      *    ¥ï¡¼¥¯²Ã¸º»»¥Æ¡¼¥Ö¥ë¤Î³ºÅö¤ÎÍ­¸ú´ü´Ö³«»ÏÆü¤Ë»»Äê³«»ÏÆü¤ò
      *    ÀßÄê¤¹¤ë
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   7 )
      *
               IF    ( SYOKIKSN-IN-SANTEISTYMD
                                   >=  WRK-KGNTEN-YUKOSTYMD (IDX1) )
                AND  ( SYOKIKSN-IN-SANTEISTYMD
                                   <=  WRK-KGNTEN-YUKOEDYMD (IDX1) )
                       MOVE    SYOKIKSN-IN-SANTEISTYMD
                                       TO  WRK-KGNTEN-YUKOSTYMD (IDX1)
               ELSE
                   IF    ( SYOKIKSN-IN-SANTEISTYMD
                                   >   WRK-KGNTEN-YUKOEDYMD (IDX1))
                       MOVE    SPACE   TO  WRK-KGNTEN-SRYCD  (IDX1)
                   END-IF
               END-IF
      *
           END-PERFORM
      *
      *    Æ±°ìÅÀ¿ô¤Î¥Ç¡¼¥¿¤¬Â¸ºß¤¹¤ë¾ì¹ç¤Ï¤Þ¤È¤á¤ë
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   6 )
               COMPUTE IDX2    =   IDX1    +   1
               IF    ( WRK-KGNTEN-SRYCD (IDX1) NOT =   SPACE )
                   IF    ( WRK-KGNTEN-SRYCD (IDX1)
                                   =   WRK-KGNTEN-SRYCD (IDX2))
                       PERFORM VARYING IDX3    FROM    IDX2    BY  1
                           UNTIL     ( IDX3    >   7 )
                               OR    ( WRK-KGNTEN-SRYCD (IDX1)
                                       NOT =   WRK-KGNTEN-SRYCD (IDX3))
                           MOVE    WRK-KGNTEN-YUKOEDYMD (IDX3)
                               TO  WRK-KGNTEN-YUKOEDYMD (IDX1)
                           MOVE    SPACE   TO  WRK-KGNTEN-SRYCD (IDX3)
                       END-PERFORM
                   END-IF
               END-IF
      *
           END-PERFORM
      *
      *    ¥ï¡¼¥¯²Ã¸º»»¥Æ¡¼¥Ö¥ë¤ÎÆâÍÆ¤òÊÖµÑÃÍ¤ËÀßÄê
           MOVE    ZERO            TO  IDX2
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   7)
      *
               IF    ( WRK-KGNTEN-SRYCD  (IDX1)
                                   NOT =   SPACE )
                   COMPUTE IDX2    =   IDX2    +   1
                   MOVE    WRK-KGNTEN-SRYCD (IDX1)
                                   TO  SYOKIKSN-OT-KGNSRYCD  (IDX2)
                   MOVE    WRK-KGNTEN-YUKOSTYMD (IDX1)
                                   TO  SYOKIKSN-OT-YUKOSTYMD (IDX2)
                   MOVE    WRK-KGNTEN-YUKOEDYMD (IDX1)
                                   TO  SYOKIKSN-OT-YUKOEDYMD (IDX2)
               END-IF
      *
           END-PERFORM
      *
           MOVE    ZERO            TO  SYOKIKSN-OT-RC
      *
           .
       201-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ÊÔ½¸½èÍý¡ÊÊ¿À®£²£¶Ç¯£´·î²þÄê°Ê¹ß¡Ë
      *****************************************************************
       202-EDIT-SEC                SECTION.
      *
           IF    ( SYOKIKSN-IN-KHNSRYCD    =   "099999950"
            OR                                 "099999951"
            OR                                 "099999952"
            OR                                 "099999955"
            OR                                 "099999956"
            OR                                 "099999957"   )
      *        Ê¿À®£²£¶Ç¯£´·î²þÄêÂÐ±þ¡ÊÍ­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ¡Ë
               MOVE    1       TO    FLG-SINRYOJO-VAL-2604
               MOVE    CONST-SINRYOJO-VAL-2604  TO  WRK-KIKAN-TBL
           ELSE
               MOVE    CONST-KGNTEN-VAL    TO  WRK-KIKAN-TBL
           END-IF
      *
      *    ·ë³ËÉÂÅïÆþ±¡´ðËÜÎÁ¡ÊÊ¿À®£²£¸Ç¯ÅÙ²þÄê¡Ë
           IF   SYOKIKSN-IN-SANTEISTYMD(1:6)  >=    "201604"
      *        ·ë³ËÉÂÅïÆþ±¡´ðËÜÎÁ¤ÎÈ½Äê¤Î°Ù¡¢ÅÀ¿ô¥Þ¥¹¥¿»²¾È
               INITIALIZE                        TNS-TENSU-REC
               MOVE    SPA-HOSPNUM           TO  TNS-HOSPNUM
               MOVE    SYOKIKSN-IN-KHNSRYCD  TO  TNS-SRYCD
               MOVE    SYOKIKSN-IN-SANTEISTYMD
                                             TO  TNS-YUKOSTYMD
               MOVE    TNS-YUKOSTYMD         TO  TNS-YUKOEDYMD
               PERFORM   910-TENSU-READ-SEC
               IF    ( TNS-CDKBN-KBN        =    "A"  )   AND
                     ( TNS-CDKBN-KBNNUM     =    102  )
                   MOVE    CONST-KEKKAKU-VAL-2804  TO  WRK-KIKAN-TBL
               END-IF
           END-IF
      *
      *    ´ð½àÆü¼èÆÀ½èÍý
           PERFORM 210-KJNYMD-GET-SEC
      *
      *    Æþ±¡ÎÁ»»Äê¥Þ¥¹¥¿¸¡º÷½èÍý
           PERFORM 210-NYUINKHN-SEL-SEC
           IF    ( FLG-ERR NOT =   ZERO )
               GO  TO  202-EDIT-EXT
           END-IF
      *
      *    Ê¿À®£²£¶Ç¯£´·î²þÄêÂÐ±þ¡ÊÍ­¾²¿ÇÎÅ½êÆþ±¡´ðËÜÎÁ¡Ë
           IF   FLG-SINRYOJO-VAL-2604     =    1
               IF   SYOKIKSN-IN-KHNSRYCD  = "099999950"  OR
                                            "099999951"  OR
                                            "099999952"  OR
                                            "099999955"  OR
                                            "099999956"  OR
                                            "099999957"
                   MOVE    SPACE        TO  SYOKIKSN-IN-KHNSRYCD
               END-IF
           END-IF
      *    ¥ï¡¼¥¯²Ã¸º»»¥Æ¡¼¥Ö¥ë¤Ë¿ÇÎÅ¹Ô°Ù¥³¡¼¥É¤ÈÍ­¸ú´ü´Ö¤òÀßÄê
           INITIALIZE              WRK-KGNTEN-TBL
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   7 )
      *
               MOVE    NYUKHN-KAGENCD (IDX1)
                                   TO  WRK-KGNTEN-SRYCD (IDX1)
      *        ´ð½àÆü
               MOVE    WRK-KJNYMD
                                   TO WRK-YMD
               MOVE    WRK-KIKAN-STZOGENPTN (IDX1)
                                   TO WRK-ZOGENPTN
               MOVE    WRK-KIKAN-STZOGEN (IDX1)
                                   TO WRK-ZOGEN
               PERFORM 220-HIZUKE-GET-SEC
               MOVE    WRK-KEISANYMD
                                   TO  WRK-KGNTEN-YUKOSTYMD (IDX1)
      *
      *        Í­¸ú´ü´Ö½ªÎ»Æü
               MOVE    WRK-KJNYMD
                                   TO WRK-YMD
               MOVE    WRK-KIKAN-EDZOGENPTN (IDX1)
                                   TO WRK-ZOGENPTN
               MOVE    WRK-KIKAN-EDZOGEN (IDX1)
                                   TO WRK-ZOGEN
               PERFORM 220-HIZUKE-GET-SEC
               MOVE    WRK-KEISANYMD
                                   TO  WRK-KGNTEN-YUKOEDYMD (IDX1)
      *
           END-PERFORM
      *
      *    ¥ï¡¼¥¯²Ã¸º»»¥Æ¡¼¥Ö¥ë¤Î³ºÅö¤ÎÍ­¸ú´ü´Ö³«»ÏÆü¤Ë»»Äê³«»ÏÆü¤ò
      *    ÀßÄê¤¹¤ë
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   7 )
      *
               IF    ( SYOKIKSN-IN-SANTEISTYMD
                                   >=  WRK-KGNTEN-YUKOSTYMD (IDX1) )
                AND  ( SYOKIKSN-IN-SANTEISTYMD
                                   <=  WRK-KGNTEN-YUKOEDYMD (IDX1) )
                       MOVE    SYOKIKSN-IN-SANTEISTYMD
                                       TO  WRK-KGNTEN-YUKOSTYMD (IDX1)
               ELSE
                   IF    ( SYOKIKSN-IN-SANTEISTYMD
                                   >   WRK-KGNTEN-YUKOEDYMD (IDX1))
                       MOVE    SPACE   TO  WRK-KGNTEN-SRYCD  (IDX1)
                   END-IF
               END-IF
      *
           END-PERFORM
      *
      *    Æ±°ìÅÀ¿ô¤Î¥Ç¡¼¥¿¤¬Â¸ºß¤¹¤ë¾ì¹ç¤Ï¤Þ¤È¤á¤ë
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   6 )
               COMPUTE IDX2    =   IDX1    +   1
               IF    ( WRK-KGNTEN-SRYCD (IDX1) NOT =   SPACE )
                   IF    ( WRK-KGNTEN-SRYCD (IDX1)
                                   =   WRK-KGNTEN-SRYCD (IDX2))
                       PERFORM VARYING IDX3    FROM    IDX2    BY  1
                           UNTIL     ( IDX3    >   7 )
                               OR    ( WRK-KGNTEN-SRYCD (IDX1)
                                       NOT =   WRK-KGNTEN-SRYCD (IDX3))
                           MOVE    WRK-KGNTEN-YUKOEDYMD (IDX3)
                               TO  WRK-KGNTEN-YUKOEDYMD (IDX1)
                           MOVE    SPACE   TO  WRK-KGNTEN-SRYCD (IDX3)
                       END-PERFORM
                   END-IF
               END-IF
      *
           END-PERFORM
      *
      *    ¥ï¡¼¥¯²Ã¸º»»¥Æ¡¼¥Ö¥ë¤ÎÆâÍÆ¤òÊÖµÑÃÍ¤ËÀßÄê
           MOVE    ZERO            TO  IDX2
           PERFORM VARYING IDX1    FROM    1   BY  1
               UNTIL     ( IDX1    >   7)
      *
               IF    ( WRK-KGNTEN-SRYCD  (IDX1)
                                   NOT =   SPACE )
                   COMPUTE IDX2    =   IDX2    +   1
                   MOVE    WRK-KGNTEN-SRYCD (IDX1)
                                   TO  SYOKIKSN-OT-KGNSRYCD  (IDX2)
                   MOVE    WRK-KGNTEN-YUKOSTYMD (IDX1)
                                   TO  SYOKIKSN-OT-YUKOSTYMD (IDX2)
                   MOVE    WRK-KGNTEN-YUKOEDYMD (IDX1)
                                   TO  SYOKIKSN-OT-YUKOEDYMD (IDX2)
               END-IF
      *
           END-PERFORM
      *
           MOVE    ZERO            TO  SYOKIKSN-OT-RC
      *
           .
       202-EDIT-EXT.
           EXIT.
      *****************************************************************
      *    ´ð½àÆü¼èÆÀ½èÍý
      *****************************************************************
       210-KJNYMD-GET-SEC              SECTION.
      *
      *
      *    ´ð½à¤È¤Ê¤ëÆüÉÕ¤ò¤â¤È¤á¤ë¡Ê»»Äê³«»ÏÆü¡ÝÄÌ»»Æü¿ô¡Ë
           MOVE    SYOKIKSN-IN-SANTEISTYMD
                                   TO WRK-YMD
      *
           MOVE    "1"             TO WRK-ZOGENPTN
      *
           COMPUTE WRK-ZOGEN       =  SYOKIKSN-IN-TUSANNISSU
                                   *  -1
           PERFORM 5002-CALENDAR-SEC
      *
           MOVE    WRK-KEISANYMD   TO WRK-KJNYMD
      *
           .
       210-KJNYMD-GET-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÎÁ»»Äê¥Þ¥¹¥¿¸¡º÷½èÍý
      *****************************************************************
       210-NYUINKHN-SEL-SEC            SECTION.
      *
           INITIALIZE  NYUINKHN-REC
           MOVE    SYOKIKSN-IN-KHNSRYCD
                                       TO  NYUKHN-KHNSRYCD
           MOVE    SYOKIKSN-IN-SANTEISTYMD
                                       TO  NYUKHN-YUKOSTYMD
                                           NYUKHN-YUKOEDYMD
           MOVE    NYUINKHN-REC        TO  MCPDATA-REC
           MOVE    "tbl_nyuinkhn"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF    ( MCP-RC      NOT =   ZERO )
               MOVE    1               TO  FLG-ERR
           ELSE
               MOVE    MCPDATA-REC     TO  NYUINKHN-REC
           END-IF
      *
           MOVE    "tbl_nyuinkhn"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBCLOSECURSOR-SEC
      *
           .
       210-NYUINKHN-SEL-EXT.
           EXIT.
      *****************************************************************
      *    Æþ±¡ÎÁ»»Äê¥Þ¥¹¥¿¸¡º÷½èÍý
      *****************************************************************
       220-HIZUKE-GET-SEC              SECTION.
      *
           IF    ( WRK-ZOGEN       = 999 )
               MOVE    "99999999"  TO  WRK-KEISANYMD
               GO  TO  220-HIZUKE-GET-EXT
           END-IF
      *
           PERFORM 5002-CALENDAR-SEC
      *
           MOVE    WRK-KEISANYMD   TO WRK-YMD
           MOVE    "1"             TO WRK-ZOGENPTN
           MOVE    -1              TO WRK-ZOGEN
           PERFORM 5002-CALENDAR-SEC
      *
           .
       220-HIZUKE-GET-EXT.
           EXIT.
      *****************************************************************
      *    ÆüÉÕ¥Á¥§¥Ã¥¯¡¦ÊÔ½¸½èÍý
      *****************************************************************
       5002-HIZUKE-CHK-SEC             SECTION.
      *
           MOVE    SPACE               TO  WRK-HENYMDG
                                           WRK-SYMD
      *
           IF    ( WRK-YMD         =   SPACE )
               GO  TO  5002-HIZUKE-CHK-EXT
           END-IF
      *
      *    ÆüÉÕ²èÌÌ¥Á¥§¥Ã¥¯¥µ¥Ö
           INITIALIZE                      ORCSGDAYAREA
           MOVE    WRK-YMD             TO  SGDAY-INDAY
           CALL    "ORCSGDAY"          USING
                                           ORCSGDAYAREA
           IF  ( SGDAY-RC              =   ZERO )
               MOVE    SGDAY-OTDAY     TO  WRK-HENYMDG
               MOVE    SGDAY-SDAY      TO  WRK-SYMD
           ELSE
               MOVE    1               TO  FLG-ERR
           END-IF
           .
       5002-HIZUKE-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ´ü´Ö»»½Ð½èÍý
      *****************************************************************
       5002-KIKAN-CALC-SEC             SECTION.
      *
           MOVE    ZERO                TO  WRK-NISSU1
                                           WRK-NISSU2
      *
           INITIALIZE                  STS-AREA-DAY
           INITIALIZE                  LNK-DAY5-AREA
           MOVE    "51"                TO  LNK-DAY5-IRAI
           MOVE    WRK-STYMD           TO  LNK-DAY5-START
           MOVE    WRK-EDYMD           TO  LNK-DAY5-END
           CALL  "ORCSDAY"             USING   STS-AREA-DAY
                                           LNK-DAY5-AREA
      *
           MOVE    LNK-DAY5-NISSU1     TO  WRK-NISSU1
           MOVE    LNK-DAY5-NISSU2     TO  WRK-NISSU2
      *
           .
       5002-KIKAN-CALC-EXT.
           EXIT.
      *****************************************************************
      *    ¥«¥ì¥ó¥À¡¼½èÍý
      *****************************************************************
       5002-CALENDAR-SEC               SECTION.
      *
           INITIALIZE                  STS-AREA-DAY
           INITIALIZE                  LNK-DAY6-AREA
           MOVE    "61"                TO  LNK-DAY6-IRAI
           MOVE    WRK-YMD             TO  LNK-DAY6-KIJUN
           MOVE    WRK-ZOGENPTN        TO  LNK-DAY6-ZOGENPTN
           MOVE    WRK-ZOGEN           TO  LNK-DAY6-ZOGEN
           CALL  "ORCSDAY"             USING   STS-AREA-DAY
                                               LNK-DAY6-AREA
           MOVE    LNK-DAY6-KEISAN     TO  WRK-KEISANYMD
      *
           .
       5002-CALENDAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¡¼ÆÉ¹þ¡Ê¼ç¥­¡¼¡Ë
      *****************************************************************
       910-TENSU-READ-SEC         SECTION.
      *
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   911-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM   910-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC     TO  TNS-TENSU-REC
                   MOVE    ZERO            TO  FLG-TENSU
               ELSE
                   MOVE    1               TO  FLG-TENSU
                   INITIALIZE              TNS-TENSU-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-TENSU
               INITIALIZE                  TNS-TENSU-REC
           END-IF
      *
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   910-DBCLOSECURSOR-SEC
      *
           .
       910-TENSU-READ-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£Â¸¡º÷½èÍý¡ÊFHETCH¤â¹Ô¤¦)
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
           CALL    "ORCDBMAIN"             USING
                                           MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
           IF    ( MCP-RC          =   ZERO )
               PERFORM 910-DBFETCH-SEC
           END-IF
      *
           .
      *
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£Â¸¡º÷½èÍý¡ÊFHETCH¤Ï¹Ô¤ï¤Ê¤¤)
      *****************************************************************
       911-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
           CALL    "ORCDBMAIN"             USING
                                           MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
      *
           .
      *
       911-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£ÂÆÉ¤ß¹þ¤ß½èÍý
      *****************************************************************
       910-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"             USING
                                           MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
      *
           .
      *
       910-DBFETCH-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£Â¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       910-DBCLOSECURSOR-SEC                 SECTION.
      *
           MOVE    "DBCLOSECURSOR" TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING
                                       MCPAREA
                                       MCPDATA-REC
                                       SPA-AREA
      *
           .
      *
       910-DBCLOSECURSOR-EXT.
           EXIT.
