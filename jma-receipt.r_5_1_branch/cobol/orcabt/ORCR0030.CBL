      *******************************************************************
      * Project code name "ORCA"
      * 日医標準レセプトソフト（JMA standard receipt software）
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCR0030.
      *****************************************************************
      *  システム名        : ＯＲＣＡ
      *  サブシステム名    : レセプト
      *  コンポーネント名  : 診療区分別点数集計
      *  管理者            : 
      *  作成日付    作業者        記述
      *  00/12/01    MCC−小豆沢   新規作成
      *****************************************************************
      *  プログラム修正履歴
      * Maj/Min/Rev  修正者       日付      内容
      *  05.00.01    NACL-門脇    18/12/03  群馬県地方公費対応
      *  05.00.02    NACL-門脇    19/01/11  マル長と生保に関する修正
      *  05.00.03    NACL-門脇    19/03/11  予約コード読み飛ばし修正
      *  05.00.04    NACL-門脇    19/03/13  北海道地方公費対応
      *  05.00.05    NACL-門脇    19/04/03  コメントマスタの改元対応に
      *                                     伴う修正
      *  05.00.06    NACL-門脇    19/05/07  地方公費一部負担金編集修正
      *  05.00.07    NACL-門脇    19/05/09  特記事項０１（公）に関わる
      *                                     レセプト一部負担金記載修正
      *  05.00.08    NACL-門脇    19/05/14  括弧再掲記載修正
      *  05.00.09    NACL-門脇    19/06/04  生保に関わる保険組み合わせ作成
      *                                     対応（主保険なしの場合）
      *  05.00.10    NACL-門脇    19/06/14  難病の特記事項置き換え対応
      *  05.00.11    NACL-門脇    19/07/01  リハビリ発症日レセプト記載対応
      *                                     （機能追加）
      *  05.00.12    NACL-門脇    19/07/03  在医総算定フラグ編集
      *  05.00.13    NACL-門脇    19/07/26  特記事項記載修正（下船）
      *  05.00.14    NACL-門脇    19/08/21  請求点数０点の全国公費を記載
      *                                     しない場合の内部金額編集修正
      *  05.00.15    NACL-門脇    19/10/01  括弧再掲記載に関わる対応
      *  05.00.16    NACL-門脇    19/10/15  第三者行為の患者負担額記載修正
      *  05.00.17    NACL-門脇    19/11/15  マル長対応
      *  05.00.18    NACL-門脇    19/12/26  器材点数０点時のコメントコード
      *                                     の取り扱い修正
      *  05.00.19    NACL-門脇    20/01/10  減免（免除・支払猶予）の災２の
      *                                     請求額情報編集対応
      *  05.00.20    NACL-門脇    20/01/17  生保一部負担金記載修正
      *  05.00.21    NACL-門脇    20/02/10  薬剤・器材の単位編集（点数付加）
      *  05.00.22    NACL-門脇    20/03/11  小児慢性複数受給者証対応
      *  05.00.23    NACL-門脇    20/03/26  小児慢性の実施機関番号追加対応
      *                                     （７１０・８１０）
      *  05.00.24    NACL-門脇    20/03/30  令和２年４月改正対応
      *  05.00.25    NACL-門脇    20/04/07  新型コロナウイルス対応
      *  05.00.26    NACL-門脇    20/04/16  器材の単位編集修正
      *  05.00.27    NACL-門脇    20/04/28  「他保険にて診察料算定済」の名称
      *                                     編集修正
      *****************************************************************
      *
       ENVIRONMENT             DIVISION.
       CONFIGURATION           SECTION.
       INPUT-OUTPUT            SECTION.
       FILE-CONTROL.
           SELECT  RECE02-FILE     ASSIGN  RECE01PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE02-KEY
                                   FILE    STATUS  IS  STS-RECE02.
           SELECT  RECE04-FILE     ASSIGN  RECE04PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE04-KEY
                                   FILE    STATUS  IS  STS-RECE04.
           SELECT  RECE05-FILE     ASSIGN  RECE05PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE05-KEY
                                   FILE    STATUS  IS  STS-RECE05.
           SELECT  RECE09-FILE     ASSIGN  RECE09PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE09-KEY
                                   FILE    STATUS  IS  STS-RECE09.
      *    エラーファイル
           SELECT  RECEERR-FILE    ASSIGN  RECEERR
                                   FILE    STATUS  IS  STS-RECEERR.
      *
       DATA                    DIVISION.
       FILE                    SECTION.
      *
       FD  RECE02-FILE.
       01  RECE02-REC. 
           COPY    "CPRCF002.INC".
      *
       FD  RECE04-FILE.
       01  RECE04-REC. 
           COPY    "CPRCF004.INC".
      *
       FD  RECE05-FILE.
       01  RECE05-REC. 
           COPY    "CPRCF005.INC".
      *
       FD  RECE09-FILE.
       01  RECE09-REC. 
           COPY    "CPRCF009.INC".
      *
      *    エラーファイル
       FD  RECEERR-FILE.
       01  RECEERR-REC             PIC X(200). 
      *
       WORKING-STORAGE             SECTION.
      *
      *     レセプト明細ファイル 名称領域 
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //RECE01PARA//.
      *
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //RECE04PARA//.
      *
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //RECE05PARA//.
      *
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //RECE09PARA//.
      *
      *    エラーファイル 名称領域 
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //RECEERR//.
      *
      *    ファイル名取得
           COPY    "CPRECEDAT1.INC".
           COPY    "CPTEMPFL.INC".
      *
      *    フラグ領域
       01  STS-AREA.
           03  STS-RECE02                              PIC X(02).
           03  STS-RECE04                              PIC X(02).
           03  STS-RECE05                              PIC X(02).
           03  STS-RECE09                              PIC X(02).
           03  STS-RECEERR                             PIC X(02).
      *
       01  FLG-AREA.
           03  FLG-END                                 PIC 9(01).
           03  FLG-SRYACCT                             PIC 9(01).
           03  FLG-SRYACT                              PIC 9(01).
           03  FLG-TENSU                               PIC 9(01).
           03  FLG-SYUNOU                              PIC 9(01).
           03  FLG-JYURRK                              PIC 9(01).
           03  FLG-SYSKANRI                            PIC 9(01).
           03  FLG-SRYACCTPLUS                         PIC 9(01).
           03  FLG-ZAITAKU                             PIC 9(01).
           03  FLG-OSINKBN                             PIC 9(01).
           03  FLG-RECE02                              PIC 9(01).
           03  FLG-KANJI                               PIC 9(01).
           03  FLG-SP                                  PIC 9(01). 
           03  FLG-PTCOM                               PIC 9(01).
           03  FLG-ZANHAIKI                            PIC 9(01).
           03  FLG-FORMAL-KISAI                        PIC 9(01).
           03  FLG-RECE05                              PIC 9(01).
           03  FLG-REWRITE                             PIC 9(01).
           03  FLG-SHOSAISIN                           PIC 9(01).       
           03  FLG-SHOSAISIN-GEN                       PIC 9(01).
           03  FLG-SET                                 PIC 9(01).
           03  FLG-HOUSIJI-COM                         PIC 9(01).
           03  FLG-OSIN-COM                            PIC 9(01).
           03  FLG-ZAIHOU-COM                          PIC 9(01).
           03  FLG-SYOUNI-COM                          PIC 9(01).
           03  FLG-HOUTEN-COM                          PIC 9(01).
           03  FLG-SYOBYO-COM                          PIC 9(01).
           03  FLG-RYOYO-COM                           PIC 9(01).
           03  FLG-SYODOU-COM                          PIC 9(01).
           03  FLG-SAIDOU-COM                          PIC 9(01).
           03  FLG-NIKOCHIN-COM                        PIC 9(01).
           03  FLG-ZAIKYO-COM                          PIC 9(01).
           03  FLG-BOKOHO-COM                          PIC 9(01).
           03  FLG-IZONSYO-COM                         PIC 9(01).
           03  FLG-NINRYO-COM                          PIC 9(01).
           03  FLG-ZENSOKU-COM                         PIC 9(01).
           03  FLG-KENSA-COM                           PIC 9(01).
           03  FLG-ZAIRIHA-COM                         PIC 9(01).
           03  FLG-NYUSEN-COM                          PIC 9(01).
           03  FLG-KIATU-COM                           PIC 9(01).
           03  FLG-GAIJIR-COM                          PIC 9(01).
      *****03  FLG-HKNNUM                              PIC 9(01).
           03  FLG-RECESKYKBN                          PIC 9(01).
           03  FLG-ZENKOH-ARI                          PIC 9(01).
           03  FLG-HKNCOMBI                            PIC 9(01).
           03  FLG-RECE09                              PIC 9(01).
           03  FLG-RINYAK                              PIC 9(01).
           03  FLG-TOKKI                               PIC 9(02).
           03  FLG-MIYAGI                              PIC 9(01).
           03  FLG-PTKOHINF                            PIC 9(01).
           03  FLG-KEISAN                              PIC 9(01).
           03  FLG-KEISAN2                             PIC 9(01).
           03  FLG-KEISAN3                             PIC 9(01).
           03  FLG-KEISAN-TOK1                         PIC 9(01).
           03  FLG-KEISAN-TOK2                         PIC 9(01).
           03  FLG-GENBUTU70                           PIC 9(01).
           03  FLG-GENBUTU70-KBN                       PIC 9(02).
           03  FLG-GENBUTU-TAISYOOK                    PIC 9(01).
           03  FLG-KOHYONKAIME                         PIC 9(01).
           03  FLG-WRITE05                             PIC 9(01).
           03  FLG-WRITE05X                            PIC 9(01).
           03  FLG-TAISYO                              PIC 9(01).
           03  FLG-RJNGENMEN-CHIARI                    PIC 9(01).
           03  FLG-IRYOHI70K                           PIC 9(01).
           03  FLG-KOUGAKUCYO-GEN70K                   PIC 9(01).
           03  FLG-SAIKEI-KISAI                        PIC 9(01).
           03  FLG-TAHOKEN                             PIC 9(01).
           03  FLG-DOTANDOKU-IGAI                      PIC 9(01).
           03  FLG-DOTANDOKU                           PIC 9(01).
           03  FLG-ZENKI-TOKUREI                       PIC 9(01).
           03  FLG-ZENKI-CHECK                         PIC 9(01).
           03  FLG-HOKENICHIBU                         PIC 9(01).
           03  FLG-HOKENICHIBU-SYU                     PIC 9(01).
           03  FLG-HOKENICHIBU2                        PIC 9(01).
           03  FLG-HOKENICHIBU3                        PIC 9(01).
           03  FLG-HOKENICHIBU5                        PIC 9(01).
           03  FLG-HOKENICHIBU6                        PIC 9(01).
           03  FLG-HOKENICHIBU7                        PIC 9(01).
           03  FLG-HOKENICHIBU-CHK                     PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU                   PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU2                  PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU3                  PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU4                  PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU5                  PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU6                  PIC 9(01).
           03  FLG-ZENKOKUKOHI-NISYU-SC                PIC 9(01).
           03  FLG-TOKU75                              PIC 9(01).
           03  FLG-TOKU75-KIZON                        PIC 9(01).
           03  FLG-SYOGAI75                            PIC 9(01).
           03  FLG-TOKU75-XXX                          PIC 9(01).
           03  FLG-TOKU75-KOHSKY                       PIC 9(01).
           03  FLG-KOKI-HIGAITO                        PIC 9(01).
           03  FLG-TOKUSITU                            PIC 9(01).
           03  FLG-TOKUSITU-KBN                        PIC 9(02).
           03  FLG-KOUGAKU                             PIC 9(01).
           03  FLG-KOUGAKU2                            PIC 9(01).
           03  FLG-KISAIOK                             PIC 9(01).
           03  FLG-PTNYUINRRK                          PIC 9(01).
           03  FLG-GENGAKU-OKIKAE                      PIC 9(01).
           03  FLG-KOHYONKAIME-NO                      PIC 9(01).
           03  FLG-SETCOM                              PIC 9(01).
           03  FLG-BUNBEN-SET                          PIC 9(01).
           03  FLG-WRKFILE-CLEAR                       PIC 9(01).
           03  FLG-WRKFILE-KGKTAI                      PIC 9(01).
           03  FLG-SAIGAI-TAISYO                       PIC 9(01).
           03  FLG-CHIIKI                              PIC 9(01).
           03  FLG-CHIIKIX                             PIC 9(01).
           03  FLG-CHIIKI2                             PIC 9(01).
           03  FLG-CHIIKI3                             PIC 9(01).
           03  FLG-KGKIPNTAI                           PIC 9(01).
           03  FLG-KGK                                 PIC 9(01).
           03  FLG-SKY-TOKKOH                          PIC 9(01).
           03  FLG-GENMEN-ARI                          PIC 9(01).
           03  FLG-GENMEN-NASI                         PIC 9(01).
           03  FLG-SAIGAI-JGN-ETC                      PIC 9(01).
           03  FLG-JIRITU-CYUKANSOU1                   PIC 9(01).
           03  FLG-JIRITU-CYUKANSOU2                   PIC 9(01).
           03  FLG-SYSCHK                              PIC 9(01).
           03  FLG-CYOKI-CHECK                         PIC 9(01).
           03  FLG-CYOKI-CHECK2                        PIC 9(01).
           03  FLG-CYOKI-CHECK3                        PIC 9(01).
           03  FLG-CYOKI-CHECK4                        PIC 9(01).
           03  FLG-KIN-OKIKAE                          PIC 9(01).
           03  FLG-KIN-OKIKAE2                         PIC 9(01).
           03  FLG-KIN-OKIKAE3                         PIC 9(01).
           03  FLG-RIHA-OKIKAE                         PIC 9(02).
           03  FLG-HENSYU-NG                           PIC 9(01).
           03  FLG-HENSYU-NG2                          PIC 9(01).
           03  FLG-HENSYU-ARI                          PIC 9(01).
           03  FLG-ZEROKOGAITO                         PIC 9(01).
           03  FLG-IRYORENKEI                          PIC 9(01).
           03  FLG-NYUSYO                              PIC 9(01).
           03  FLG-DAISAN-ARI                          PIC 9(01).
           03  FLG-DAISAN-NG                           PIC 9(01).
           03  FLG-ZAITAKU-CHECK                       PIC 9(01).
           03  FLG-CYOKI-HENSYU                        PIC 9(01).
           03  FLG-CYOKI-HENSYU2                       PIC 9(01).
           03  FLG-CYOKI-HENSYU3                       PIC 9(01).
           03  FLG-CYOKI-HENSYU4                       PIC 9(01).
           03  FLG-DAISAN-GENBUTU                      PIC 9(01).
           03  FLG-ARI                                 PIC 9(01).
           03  FLG-ARI2                                PIC 9(01).
           03  FLG-ARI3                                PIC 9(01).
           03  FLG-ARI4                                PIC 9(01).
           03  FLG-ARI5                                PIC 9(01).
           03  FLG-NYUIN-CHECK                         PIC 9(01).
           03  FLG-CYOFUKU-KOH                         PIC 9(01).
           03  FLG-RECECOM                             PIC 9(01).
           03  FLG-SIPPU-COM                           PIC 9(01).
           03  FLG-SIPPU-ARI                           PIC 9(01).
           03  FLG-CHECK-ARI                           PIC 9(01).
           03  FLG-YKZ-PRTKBN                          PIC 9(01).
           03  FLG-KIZ-PRTKBN                          PIC 9(01).
           03  FLG-GENGAKU5                            PIC 9(01).
           03  FLG-KOHSKY-ARI                          PIC 9(01).
           03  FLG-KOUREI-GENEKIKBN                    PIC 9(01).
           03  FLG-XX8-TUUKA                           PIC 9(01).
           03  FLG-XX5-TUUKA                           PIC 9(01).
           03  FLG-XX3-TUUKA                           PIC 9(01).
           03  FLG-XX6-TUUKA                           PIC 9(01).
           03  FLG-HANTEI                              PIC 9(01).
           03  FLG-CYOKI-KINGAKU-SET                   PIC 9(01).
           03  FLG-OK                                  PIC 9(01).
           03  FLG-PTHKNINF                            PIC 9(01).
           03  FLG-KOHARI-CHECK                        PIC 9(01).
           03  FLG-CHECK-OK                            PIC 9(01).
      *
      *    基本点数の非表示判定用フラグ
       01  FLG-KHNTEN-AREA.
           03  FLG-KHNTEN2                             PIC 9(01).
           03  FLG-KHNTEN3                             PIC 9(01).
           03  FLG-KHNTEN4                             PIC 9(01).
           03  FLG-KHNTEN5                             PIC 9(01).
           03  FLG-KHNTEN6                             PIC 9(01).
           03  FLG-KHNTEN15                            PIC 9(01).
           03  FLG-KHNTEN18                            PIC 9(01).
           03  FLG-KHNTEN19                            PIC 9(01).
      *
      *    再診料基本点数加算フラグ
       01  FLG-SAISIN-AREA.
           03  FLG-NYUYOJI                             PIC 9(01).
           03  FLG-YOJI                                PIC 9(01).
           03  FLG-YOJI-ARI                            PIC 9(01).
           03  FLG-SAISIN-ARI                          PIC 9(01).
           03  FLG-KOKENKSN-ARI                        PIC 9(01).
           03  FLG-MESAIKSN-ARI                        PIC 9(01).
           03  FLG-CHIHOKATU-ARI                       PIC 9(01).
           03  FLG-CHIHOKAT2-ARI                       PIC 9(01).
           03  FLG-JIKANTAI1-ARI                       PIC 9(01).
           03  FLG-JIKANTAI3-ARI                       PIC 9(01).
           03  FLG-CHIHOKAT3-ARI                       PIC 9(01).
           03  FLG-CHIHOKAT4-ARI                       PIC 9(01).
           03  FLG-YAKRENKEI-ARI                       PIC 9(01).
           03  FLG-NINPU-ARI                           PIC 9(01).
           03  FLG-NINPU2-ARI                          PIC 9(01).
      *
      *    乳幼児加算カウント
       01  CNT-SAISIN-AREA.
           03  CNT-NYUYOJI                             PIC 9(02).
           03  CNT-NYUYOJI2                            PIC 9(02).
           03  CNT-YOJI                                PIC 9(02).
           03  CNT-KOKENKSN                            PIC 9(02).
           03  CNT-MESAIKSN                            PIC 9(02).
           03  CNT-CHIHOKATU                           PIC 9(02).
           03  CNT-CHIHOKAT2                           PIC 9(02).
           03  CNT-JIKANTAI1                           PIC 9(02).
           03  CNT-JIKANTAI3                           PIC 9(02).
           03  CNT-CHIHOKAT3                           PIC 9(02).
           03  CNT-CHIHOKAT4                           PIC 9(02).
           03  CNT-YAKRENKEI                           PIC 9(02).
           03  CNT-NINPU                               PIC 9(02).
           03  CNT-NINPU2                              PIC 9(02).
           03  CNT-SAISIN-DOUJITU                      PIC 9(02).
           03  CNT-SAISIN-ONLINE                       PIC 9(02).
           03  CNT-SAISIN-ETC                          PIC 9(02).
      *
      *    カウント領域
       01  CNT-AREA.
           03  CNT-IN-CANCEL                           PIC 9(06).
           03  CNT-IN-COMMIT                           PIC 9(06).
           03  CNT-OUT1                                PIC 9(06).
           03  CNT-OUT2                                PIC 9(06).
           03  CNT-TBL-OCC                             OCCURS  2.
               05  CNT-IN                              PIC 9(06).
               05  CNT-OUT3                            PIC 9(06).
      *
           03  CNT-CYOKI-HENSYU1                       PIC 9(02).
           03  CNT-CYOKI-HENSYU2                       PIC 9(02).
           03  CNT-HKNCOMBI-KOHARI                     PIC 9(02).
      *
      *    添字領域
       01  IDX-AREA.
           03  IDX                                     PIC 9(03).
           03  IDX1                                    PIC 9(03).
           03  IDX2                                    PIC 9(03).
           03  IDX3                                    PIC 9(03).
           03  IDX4                                    PIC 9(03).
           03  IDX5                                    PIC 9(03).
           03  IDX6                                    PIC 9(03).
           03  IDX7                                    PIC 9(03).
           03  IDX8                                    PIC 9(02).
           03  IDX9                                    PIC 9(02).
           03  IDX10                                   PIC 9(03).
           03  IDX11                                   PIC 9(03).
           03  IDX13                                   PIC 9(03).
           03  IDX14                                   PIC 9(03).
           03  IDX15                                   PIC 9(03).
           03  IDX16                                   PIC 9(03).
           03  IDX17                                   PIC 9(03).
           03  IDX18                                   PIC 9(03).
           03  IDX19                                   PIC 9(03).
           03  IDX20                                   PIC 9(03).
           03  IDX21                                   PIC 9(03).
           03  IDX22                                   PIC 9(02).
           03  IDX23                                   PIC 9(03).
           03  IDX24                                   PIC 9(03).
           03  IDX25                                   PIC 9(03).
           03  IDX27                                   PIC 9(03).
           03  IDX28                                   PIC 9(03).
           03  IDX29                                   PIC 9(03).
           03  IDX30                                   PIC 9(03).
           03  IDX31                                   PIC 9(02).
           03  IDX32                                   PIC 9(03).
           03  IDX33                                   PIC 9(03).
           03  IDX34                                   PIC 9(03).
           03  IDX35                                   PIC 9(03).
           03  IDX36                                   PIC 9(03).
           03  IDX37                                   PIC 9(03).
           03  IDX38                                   PIC 9(03).
           03  IDX39                                   PIC 9(03).
           03  IDX40                                   PIC 9(02).
           03  IDX41                                   PIC 9(02).
           03  IDXA                                    PIC 9(01).
           03  IDXB                                    PIC 9(03).
           03  IDXX                                    PIC 9(03).
           03  IDY                                     PIC 9(03).
           03  IDY2                                    PIC 9(03).
           03  IDY3                                    PIC 9(03).
           03  IDY4                                    PIC 9(03).
           03  IDY5                                    PIC 9(03).
           03  IDY6                                    PIC 9(03).
           03  IDY7                                    PIC 9(03).
           03  IDYX                                    PIC 9(02).
           03  IDYY                                    PIC 9(02).
           03  IDZ                                     PIC 9(03).
           03  IDZ1                                    PIC 9(03).
           03  IDZ2                                    PIC 9(03).
           03  IDZX                                    PIC 9(02).
           03  IDW                                     PIC 9(03).
           03  IDW2                                    PIC 9(03).
           03  IDW3                                    PIC 9(03).
           03  IDW4                                    PIC 9(03).
           03  IDW5                                    PIC 9(03).
           03  IDW6                                    PIC 9(03).
           03  IDW7                                    PIC 9(03).
           03  IDW8                                    PIC 9(03).
           03  IDW9                                    PIC 9(02).
           03  IDW11                                   PIC 9(03).
           03  IDA                                     PIC 9(04).
           03  IDB                                     PIC 9(04).
           03  IDV                                     PIC 9(03).
           03  IDU                                     PIC 9(03).
           03  NUM-IDX                                 PIC 9(01).
           03  HC-IDX                                  PIC 9(03).
           03  KH-IDX                                  PIC 9(03).
           03  BUN-IDX                                 PIC 9(03).
           03  BUN-IDX2                                PIC 9(03).
           03  BUN-IDX3                                PIC 9(03).
           03  BUN-IDX4                                PIC 9(03).
           03  BUN-IDX5                                PIC 9(03).       
           03  BUN-IDX6                                PIC 9(03).
           03  ACCT-IDX                                PIC 9(02).       
           03  HKN-IDX                                 PIC 9(02).       
           03  KOHFTN-IDX                              PIC 9(03).
           03  KOHFTN-IDX2                             PIC 9(03).
           03  SYSKAN-IDX                              PIC 9(03).
           03  SYSKAN-IDX2                             PIC 9(03).
           03  FUKA-IDX                                PIC 9(03).
           03  GEN-IDX                                 PIC 9(02).
           03  TOKU75-IDX                              PIC 9(03).
           03  TOKU75-IDX2                             PIC 9(03).
           03  SYU-IDX                                 PIC 9(03).
           03  SYU-IDX2                                PIC 9(03).
           03  IDX-SAI                                 PIC 9(03).
           03  IDX-NEXT                                PIC 9(03).
           03  SEIHIDX                                 PIC 9(02).
           03  KAKKIDX                                 PIC 9(02).
           03  SESNIDX                                 PIC 9(02).
      *
      *    ＯＣＲ編集領域
       01  OCR1-AREA.
           03  OCR1-HKNJANUM                           PIC 9(08).
           03  OCR1-HOSPCD                             PIC 9(07).
           03  OCR1-SKYTENSU                           PIC 9(07).
           03  OCR1-CHKDGT1                            PIC 9(01).
           03  OCR1-YKZFTN                             PIC 9(05).
           03  OCR1-CHKDGT2                            PIC 9(01).
           03  OCR1-FTNMONEY                           PIC 9(05).
           03  OCR1-CHKDGT3                            PIC 9(01).
           03  OCR1-CHKDGT4                            PIC 9(01).
           03  OCR1-JNISSU                             PIC 9(02).
           03  OCR1-SRYYM                              PIC 9(04).
           03  OCR1-CHKDGT5                            PIC 9(01).
           03  OCR1-FTNJANUM                           PIC 9(08).
           03  OCR1-JKYSNUM                            PIC 9(07).
           03  OCR1-CHKDGT6                            PIC 9(01).
           03  OCR1-PREFNUM                            PIC 9(02).
           03  OCR1-TENSUHYO                           PIC 9(01).
           03  OCR1-HKNSYUBETU1                        PIC 9(01).
           03  OCR1-HKNSYUBETU2                        PIC 9(01).
           03  OCR1-HONKZKKBN                          PIC 9(01).
           03  OCR1-SEIRINO                            PIC 9(01).
           03  OCR1-CHKDGT7                            PIC 9(01).
      *
       01  OCR2-AREA.
           03  OCR2-SEX                                PIC 9(01).
           03  OCR2-GENGO                              PIC 9(01).
           03  OCR2-BIRTHYY                            PIC 9(02).
           03  OCR2-CHKDGT1                            PIC 9(01).
           03  OCR2-KIGO                               PIC 9(10).
           03  OCR2-NUM                                PIC 9(10).
           03  OCR2-CHKDGT2                            PIC 9(01).
           03  OCR2-AREA-X.
               05  OCR2-FTNJANUM                       PIC 9(08).
               05  OCR2-JKYSNUM                        PIC 9(07).
               05  OCR2-CHKDGT3                        PIC 9(01).
               05  OCR2-JNISSU                         PIC 9(02).
               05  OCR2-TENSU                          PIC 9(07).
               05  OCR2-CHKDGT4                        PIC 9(01).
               05  OCR2-YKZFTN                         PIC 9(05).
               05  OCR2-CHKDGT5                        PIC 9(01).
               05  OCR2-FTNMONEY                       PIC 9(05).
               05  OCR2-CHKDGT6                        PIC 9(01).
               05  OCR2-CHKDGT7                        PIC 9(01).
           03  OCR2-YOBI                               PIC X(02).
      *
       01  OCR3-AREA.
           03  OCR3-AREA-X.
               05  OCR3-FTNJANUM                       PIC 9(08).
               05  OCR3-JKYSNUM                        PIC 9(07).
               05  OCR3-CHKDGT1                        PIC 9(01).
               05  OCR3-JNISSU                         PIC 9(02).
               05  OCR3-TENSU                          PIC 9(07).
               05  OCR3-CHKDGT2                        PIC 9(01).
               05  OCR3-YKZFTN                         PIC 9(05).
               05  OCR3-CHKDGT3                        PIC 9(01).
               05  OCR3-FTNMONEY                       PIC 9(05).
               05  OCR3-CHKDGT4                        PIC 9(01).
               05  OCR3-CHKDGT5                        PIC 9(01).
           03  OCR3-YOBI                               PIC X(28).
      *
      *    剤情報退避領域
       01  WK-ZAIKAISU                                 PIC S9(07).
       01  WK-ZAITEN                                   PIC S9(08).
       01  WK-SYUTEN                                   PIC S9(08).
       01  WK-KIZAITEN                                 PIC S9(08).
       01  WK-YKZTEN                                   PIC S9(08).
      *
      *    点数テーブル検索用対象日領域
       01  WK-TAIHI-AREA.
           03  WK-TAIHI-DAY                            PIC 9(02).
           03  WK-TAIHI-FLG                            PIC 9(01).
           03  WK-TAIHI-SRYYMD.
               05  WK-TAIHI-SRYYM                      PIC 9(06).
               05  WK-TAIHI-SRYD                       PIC 9(02).
      *
       01  WRK-AREA-SAIKEI.
           03  WRK-KOH-FTN                             PIC 9(09).
           03  WRK-KOH-FTN-GEN70                       PIC 9(09).
           03  WRK-KOH-FTN-GEN70-Z                     PIC 9(09).
           03  WRK-KOH-GAI                             PIC 9(09).
           03  WRK-KOH-GAI2                            PIC 9(09).
           03  WRK-KOH-GAI-GEN70                       PIC 9(09).
           03  WRK-KOH-GAI-GEN70-Z                     PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN                   PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN1                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN2                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN3                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN4                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN5                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN6                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN8                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-TEN9                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN                   PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN1                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN2                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN3                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN4                  PIC 9(09).
           03  WRK-KOH-GAI-GEN70-KIN5                  PIC 9(09).
           03  FTN-KOH-XXX                             PIC 9(09).       
           03  FTN-KOH-XX2                             PIC 9(09).
           03  FTN-KOH-XX3                             PIC 9(09).
           03  FTN-KOH-XX4                             PIC 9(09).
           03  FTN-KOH-XX5                             PIC 9(09).
           03  FTN-KOH-XX6                             PIC 9(09).
           03  FTN-KOH-XX7                             PIC 9(09).
           03  FTN-KOH-XX7X                            PIC 9(09).
           03  FTN-KOH-XX8                             PIC 9(09).
           03  FTN-KOH-YYY                             PIC 9(09).       
           03  FTN-KOH-YY2                             PIC 9(09).
           03  FTN-KOH-YY3                             PIC 9(09).
           03  FTN-KOH-YY4                             PIC 9(09).
           03  FTN-KOH-YY5                             PIC 9(09).
           03  FTN-KOH-YY6                             PIC 9(09).
           03  FTN-KOH-YY7                             PIC 9(09).
           03  FTN-KOH-YY8                             PIC 9(09).
           03  FLG-KOH                                 PIC 9(01).
           03  FLG-GENBUTU-HANTEI                      PIC 9(01).
           03  FLG-GENBUTU-HANTEI2                     PIC 9(01).
           03  WRK-FTNKEI                              PIC 9(09).
           03  WRK-FTNKEI-Z                            PIC 9(09).
           03  WRK-FTNKEI2                             PIC 9(09).
           03  WRK-FTNKEI3                             PIC 9(09).
           03  WRK-FTNKEI5                             PIC 9(09).
           03  WRK-FTNKEI6                             PIC 9(09).
           03  WRK-FTNKEI7                             PIC 9(09).
           03  WRK-FTNKEI-FTN                          PIC 9(09).
           03  WRK-FTNKEI-GENGAKU                      PIC 9(09).
           03  WRK-FTNKEI-GENGAKU2                     PIC 9(09).
           03  WRK-FTNKEI-XXX                          PIC 9(09).
           03  WRK-GENDO                               PIC 9(09).
           03  WRK-KINGAKU                             PIC 9(09).
           03  WRK-KINGAKU2                            PIC 9(09).
           03  WRK-KINGAKU3                            PIC 9(09).
           03  WRK-KINGAKU-GENBUTU                     PIC 9(09).
           03  WRK-KINGAKU-GENBUTU2                    PIC 9(09).
           03  WRK-KINGAKU-GENBUTU2-XXX                PIC 9(09).
           03  WRK-KINGAKU-GENBUTU3                    PIC 9(09).
           03  WRK-KINGAKU-GENBUTU4                    PIC 9(09).
           03  WRK-KINGAKU-GENBUTU4-XXX                PIC 9(09).
           03  WRK-KINGAKU-GENBUTU5                    PIC 9(09).
           03  FLG-CYOKI                               PIC 9(01).
           03  FLG-CYOKI2                              PIC 9(01).
           03  FLG-JYOGENKBN                           PIC 9(01).
           03  FLG-JYOGENKBN2                          PIC 9(01).
           03  FLG-JYOGENKBN3                          PIC 9(01).
           03  WRK-JYOGENKBN-TEN                       PIC 9(09).
           03  WRK-JYOGENKBN-TEN2                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN3                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN4                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN5                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN6                      PIC 9(09).
           03  WRK-JYOGENKBN-TEN9                      PIC 9(09).
           03  WRK-TOTAL-HKNTEN                        PIC 9(09).
           03  WRK-TAIHI-FTNMONEYINF-AREA.
             05  WRK-TAIHI-FTNMONEYINF     OCCURS  5.
                 07  WRK-TAIHI-FTNMONEY                PIC 9(09).
                 07  WRK-TAIHI-FTNMONEY2               PIC 9(09).
                 07  WRK-TAIHI-FTNMONEY-KOJ            PIC 9(09).
                 07  WRK-TAIHI-FTNMONEY-EN             PIC 9(09).
                 07  WRK-TAIHI-FTNMONEY-EN2            PIC 9(09)V9(01).
                 07  WRK-TAIHI-FTNMONEY-SAGAKU         PIC S9(09).
      *
       01  WRK-SYUNOU-GENBUTU-AREA.
      *    ７０歳未満現物給付の収納データ退避（公費併用分）
           03  WRK-SYUNOU-GENBUTU70-TABLE.
             05  WRK-SYUNOU-GENBUTU70-OCC                OCCURS  10.
                 07  WRK-SYUNOU-GEN70-HKNCOMBINUM        PIC  X(04).
                 07  WRK-SYUNOU-GEN70-TOTAL-HKNTEN       PIC  9(07).
                 07  WRK-SYUNOU-GEN70-SYUHKNNUM          PIC  X(03).
                 07  WRK-SYUNOU-GEN70-KOH1HKNNUM         PIC  X(03).
                 07  WRK-SYUNOU-GEN70-KOH1COMPFTN        PIC  9(07).
                 07  WRK-SYUNOU-GEN70-KOH2HKNNUM         PIC  X(03).
                 07  WRK-SYUNOU-GEN70-KOH2COMPFTN        PIC  9(07).
                 07  WRK-SYUNOU-GEN70-KOH3HKNNUM         PIC  X(03).
                 07  WRK-SYUNOU-GEN70-KOH3COMPFTN        PIC  9(07).
                 07  WRK-SYUNOU-GEN70-KOH4HKNNUM         PIC  X(03).
                 07  WRK-SYUNOU-GEN70-KOH4COMPFTN        PIC  9(07).
                 07  WRK-SYUNOU-GEN70-GASSANFLG          PIC  9(01).
                 07  WRK-SYUNOU-GEN70-HANTEIFLG          PIC  9(01).
      *    ７０歳未満現物給付の収納データ退避（主保険単独分）
           03  WRK-SYUNOU-GENBUTU70T-TABLE.
                 07  WRK-SYUNOU-GEN70T-TOTAL-HKNTEN      PIC  9(07).
                 07  WRK-SYUNOU-GEN70T-HANTEIFLG         PIC  9(01).
      *
       01  WRK-SYUNOU-CYOKI-AREA.
           03  WRK-SYUNOU-CYOKI-TABLE.
             05  WRK-SYUNOU-CYOKI-OCC                    OCCURS  10.
                 07  WRK-SYUNOU-CYOKI-HKNCOMBINUM        PIC  X(04).
                 07  WRK-SYUNOU-CYOKI-KOHFLG             PIC  9(01).
                 07  WRK-SYUNOU-CYOKI-TEKSTYMD           PIC  X(08).
             05  WRK-SYUNOU-CYOKI-FTNMONEY               PIC  9(07).
             05  WRK-SYUNOU-CYOKI-FTNMONEY2              PIC  9(07).
             05  WRK-SYUNOU-CYOKI-TEKSTYMD-XXX           PIC  X(08).
             05  WRK-SYUNOU-CYOKI-HANTEIFLG              PIC  9(01).
             05  WRK-SYUNOU-CYOKI-HANTEIFLG2             PIC  9(01).
             05  WRK-SYUNOU-CYOKI-KEISANFLG              PIC  9(01).
             05  WRK-SYUNOU-CYOKI-KEISANFLG2             PIC  9(01).
             05  FTN-CYOKI-XXX                           PIC  9(07).
             05  FTN-CYOKI-YYY                           PIC  9(07).
             05  FTN-CYOKI-XX2                           PIC  9(07).
             05  FTN-CYOKI-YY2                           PIC  9(07).
      *
       01  WRK-SKY-AREA.
           03  WRK-SKY-KEISAN                          PIC 9(09).
           03  WRK-SKY-KEISAN2                         PIC 9(09).
           03  WRK-SKY-KEISAN3                         PIC 9(09).
           03  WRK-SKY-KEISAN4                         PIC S9(09).
           03  WRK-SKY-KEISAN5                         PIC 9(09).
           03  WRK-SKY-KEISAN6                         PIC 9(09).
           03  WRK-SKY-HOKENJA                         PIC 9(09).
           03  WRK-SKY-HOKENJA-KOH                     PIC 9(09).
           03  WRK-SKY-ICHIBUFTN                       PIC 9(09).
           03  WRK-SKY-ZENGAKU                         PIC 9(09).
           03  WRK-SKY-ZENGAKU-KOH                     PIC 9(09).
           03  WRK-SKY-FTNMONEY                        PIC 9(09).
           03  WRK-SKY-FTNMONEY-KOH                    PIC 9(09)V9(01).
           03  WRK-SKY-FTNMONEY-KOH2                   PIC 9(09).
           03  WRK-SKY-FTNMONEY-KOH3                   PIC 9(09).
           03  WRK-SKY-FTNMONEY-KOH9                   PIC 9(09).
           03  WRK-SKY-ZENGAKU2                        PIC 9(09).
           03  WRK-SKY-FTNMONEY2                       PIC 9(09).
           03  WRK-SKY-FTNMONEY3                       PIC 9(09).
           03  WRK-SKY-FTNMONEY9                       PIC 9(09).
           03  WRK-SKY-FTNMONEY-XXX                    PIC S9(09).
           03  WRK-SKY-FTNMONEY-XX2                    PIC S9(09).
           03  WRK-SKY-FTNMONEY-JYOKEN                 PIC 9(09).
           03  WRK-SKY-FTNMONEY9-JYOKEN                PIC 9(09).
           03  WRK-SKY-FTNMONEY-KOH-JYOKEN             PIC 9(09)V9(01).
           03  WRK-SKY-FTNMONEY-KOH9-JYOKEN            PIC 9(09).
           03  WRK-SKY-SKYIRYO-KOHFTN                  PIC 9(09).
      *
      *    点数マスタ情報退避領域
       01  WRK-TNS-TAIHI-AREA.
           03  WRK-TNS-TAIHI-TABLE                     OCCURS  5.
               05  WRK-TNS-CHUKSNTUBAN                 PIC X(01).
               05  WRK-TNS-DATAKBN                     PIC 9(01).
               05  WRK-TNS-TIMEKSNKBN                  PIC 9(01).
               05  WRK-TNS-TEN                         PIC 9(09)V99.    
               05  WRK-TNS-GAITENTTLKBN                PIC 9(03).
               05  WRK-TNS-OSINKBN                     PIC 9(01).
               05  WRK-TNS-KNSJISKBN                   PIC 9(01).
               05  WRK-TNS-SRYCD                       PIC X(09).
      *
      *    院外処方一般名編集情報退避領域
       01  WRK-ORCSGETGE-OUT-AREA.
           03  WRK-ORCSGETGE-OUT-TABLE                 OCCURS  50.
               05  WRK-ORCSGETGE-YAKKAKJNCD            PIC X(12).
               05  WRK-ORCSGETGE-GENERIC-KBN           PIC X(01).
               05  WRK-ORCSGETGE-GENERICNAME           PIC X(200).
      *
      *    第三者行為用の保険組み合わせ毎の院外処方判定領域
       01  WRK-DAISAN-INGAI-TABLE.
           03  WRK-DAISAN-INGAI-OCC                    OCCURS  10.
               05  WRK-DAISAN-INGAI                    PIC 9(01).
      *
      *    請求額情報編集（準備）領域
       01  WRK-KOHSKY-XXX-TABLE.
           03  WRK-KOHSKY-XXX-OCC                      OCCURS  10.
               05  WRK-KOHSKY-XXX-FLG                  PIC 9(01).
           03  WRK-KOHSKY-XXX-COMPFTN-RUI              PIC 9(09).
           03  WRK-KOHSKY-XXX-COMPFTN-EN-RUI           PIC 9(09)V9(01).
           03  WRK-KOHSKY-XXX-COMPFTN-EN-RUI9          PIC 9(09).
           03  WRK-KOHSKY-XXX-FLG-RUI1                 PIC 9(01).
           03  WRK-KOHSKY-XXX-FLG-RUI2                 PIC 9(01).
      *
      *    公費請求書分の負担割合領域
       01  WRK-KOHSKY-GAIKFTNRATE-TABLE.
           03  WRK-KOHSKY-GAIKFTNRATE-OCC              OCCURS   4.
               05  WRK-KOHSKY-GAIKFTNRATE              PIC 9(03).
      *
      *    実日数カウント用領域                                         
       01  TBL-JNISSU.
           03  TBL-JNISSU-HKN                          OCCURS   5.
               05  TBL-JNISSU-DAY                      PIC X(01)
                                                       OCCURS   31.
      *    実日数カウント用領域２                                         
       01  TBL-JNISSU2.
           03  TBL-JNISSU2-HKN                         OCCURS   5.
               05  TBL-JNISSU2-MON                     PIC 9(02).
               05  TBL-JNISSU2-DAY                     PIC X(01)
                                                       OCCURS   31.
      *    実日数減カウント用領域                                         
       01  TBL-JNISSU-GEN.
           03  TBL-JNISSU-HKN-GEN                      OCCURS   5.
               05  TBL-JNISSU-DAY-GEN                  PIC X(01)
                                                       OCCURS   31.
      *    実日数減カウント用領域（まとめ）
       01  TBL-JNISSU-MATOME.
           03  TBL-JNISSU-HKN-MATOME                   OCCURS  31.
               05  TBL-JNISSU-DAY-M                    PIC X(01).
      *    医療機関（基本情報）退避用領域
       01  TBL-SYS1001-T.
           03  TBL-SYS1001-OCC                         OCCURS  100.
               05  TBL-SYS1001                         PIC X(610).
      *    施設基準情報退避用領域
       01  TBL-SYS1006-T.
           03  TBL-SYS1006-OCC                         OCCURS  100.
               05  TBL-SYS10062                        PIC X(610).
               05  TBL-SYS10067                        PIC X(610).
      *    帳票編集区分情報退避用領域
       01  TBL-SYS1030-T.
           03  TBL-SYS1030-OCC                         OCCURS  100.
               05  TBL-SYS1030                         PIC X(610).
      *
       01  TBL-TOKUSYU-KEISAN.
           03  TBL-TOKUSYU-KEISAN-OCC                  OCCURS  5.
               05  TBL-KEISAN-FLG                      PIC 9(01).
               05  TBL-KEISAN-ENTANI                   PIC 9(07)V9(01).
      *
       01  TBL-DOTANDOKU.
           03  TBL-DOTANDOKU-OCC                       OCCURS  4.
               05  TBL-DOTANDOKU-FLG                   PIC 9(01).
      *
       01  TBL-FUKUSHI.
           03  TBL-FUKUSHI-OCC                         OCCURS  4.
               05  TBL-FUKUSHIFLG                      PIC 9(01).
               05  TBL-FUKUSHI-DAYFLG                  PIC 9(01).
      *
       01  TBL-TOKUSITU.
           03  TBL-TOKUSITU-OCC                        OCCURS  4.
               05  TBL-TOKUSITUFLG                     PIC 9(01).
      *
       01  TBL-TOKATUKAI.
           03  TBL-TOKATUKAI-OCC                       OCCURS   4.
               05  TBL-TOKATUKAIFLG                    PIC  9(01).
      *
       01  TBL-TOKATUKAI2.
           03  TBL-TOKATUKAI2-OCC.
               05  TBL-TOKATUKAIFLG2                   PIC  9(01).
      *
       01  TBL-HKNFTNDATA.
           03  TBL-HKNFTNDATA-OCC                      OCCURS   4.
               05  TBL-HKNFTNDATA-JGN                  PIC  9(07).
               05  TBL-HKNFTNDATA-TAF                  PIC  9(07).
               05  TBL-HKNFTNDATA-GAIRAI               PIC  9(07).
               05  TBL-HKNFTNDATA-NYUIN                PIC  9(07).
               05  TBL-HKNFTNDATA-ZAN                  PIC  9(07).
               05  TBL-HKNFTNDATA-FLG                  PIC  9(01).
               05  TBL-HKNFTNDATA-FLG2                 PIC  9(01).
               05  TBL-HKNFTNDATA-JGNXXX               PIC  9(07).
               05  TBL-HKNFTNDATA-TEKFLG               PIC  9(01).
      *
       01  TBL-CYOFUKU-KOH.
           03  TBL-CYOFUKU-KOH-OCC                     OCCURS   4.
               05  TBL-CYOFUKU-KOHNUM                  PIC  X(03).
               05  TBL-CYOFUKU-KOHID                   PIC  9(10).
      *
       01  TBL-PTTOKKI.
           03  TBL-PTTOKKI-OCC                         OCCURS   5.
               05  TBL-PTTOKKI-NAIYO                   PIC  X(12).
               05  TBL-PTTOKKI-CD                      PIC  X(02).
      *
       01  TBL-TOKKI.
           03  TBL-TOKKI-OCC                           OCCURS   5.
               05  TBL-TOKKI-CD                        PIC  X(02).
      *
       01  TBL-HKNCOMBI.
           03  TBL-HKNCOMBI-OCC                        OCCURS  10.
               05  TBL-HKNCOMBI-TOTALTEN               PIC  9(07).
               05  TBL-HKNCOMBI-CHKFLG                 PIC  9(01).
               05  TBL-HKNCOMBI-KOHARI                 PIC  9(01).
      *
       01  TBL-HKNCOMBI2.
           03  TBL-HKNCOMBI2-OCC                       OCCURS  10.
               05  TBL-HKNCOMBI-SKYTENFLG              PIC  9(01).
               05  TBL-HKNCOMBI-SKYTENFLG2             PIC  9(01).
      *
       01  TBL-ZAITAKU-KAISU-XXX.
           03  TBL-ZAITAKU-KAISU-XXX2                  OCCURS   6.
             05  TBL-ZAITAKU-KAISU-XXX3                OCCURS   9.
               07  TBL-ZAITAKU-KAISU-XXX4              OCCURS  31.
                 09  TBL-ZAITAKU-KAISU                 PIC  9(03).
      *
       01  TBL-CHIIKI-SANTEI.
           03  TBL-CHIIKI-SANTEI-OCC                   OCCURS   5.
               05  TBL-CHIIKI-SANTEI-FLG               PIC  9(01)
                                                       OCCURS  31.
      *
      *    一時領域
       01  WRK-AREA.
           03  WRK-PARA.
      *********05  WRK-PARA-PREFNUM                    PIC X(02).
               05  WRK-PARA-SRYYM                      PIC X(06).
               05  WRK-PARA-TERMID                     PIC X(16).
               05  WRK-PARA-SYSYMD                     PIC X(08).
               05  WRK-PARA-JOBID                      PIC 9(07).
               05  WRK-PARA-SHELLID                    PIC X(08).
           03  WRK-PARA-HOSPNUM                        PIC 9(02).
           03  WRK-PARA-PRTKBN                         PIC X(01).
      *
           03  WRK-SYS-SRYYMD                          PIC X(08).
      *
           03  WRK-CHK-HKNJANUM                        PIC X(08).
           03  WRK-CHK-HONKZKKBN                       PIC X(01).
           03  WRK-CHK-IDOU                            PIC 9(01).
           03  WRK-CHK-TAISYO                          PIC 9(01).
           03  WRK-CHK-TAISYO2                         PIC 9(01).
           03  WRK-CHK-TAISYO3                         PIC 9(01).
           03  WRK-CHK-TOKU75-MAE                      PIC 9(01).
           03  WRK-CHK-CNT                             PIC 9(07).
           03  WRK-CHK-HKNID                           PIC 9(10).
           03  WRK-CHK-HKNNUM                          PIC X(03).
           03  WRK-CHK-ICHIBUGAKU                      PIC 9(07).
           03  WRK-CHK-ICHIBUGAKU2                     PIC 9(07).
           03  WRK-CHK-FTNGAKU                         PIC 9(07).
           03  WRK-CHK-KOHFTNGAKU                      PIC 9(07).
           03  WRK-CHK-KEISAN1                         PIC 9(07).
           03  WRK-CHK-KEISAN2                         PIC 9(07).
           03  WRK-CHK-KINGAKU                         PIC 9(07).
           03  WRK-CHK-KINGAKU2                        PIC 9(07).
           03  WRK-CHK-KINGAKU3                        PIC 9(07).
           03  WRK-CHK-KEIKASOCHIXX                    PIC 9(07).
           03  WRK-CHK-KEIKASOCHIXX9                   PIC 9(07).
           03  WRK-CHK-KEIKASOCHI1                     PIC S9(07).
           03  WRK-CHK-KEIKASOCHI2                     PIC S9(07).
           03  WRK-CHK-KEIKASOCHI3                     PIC S9(07).
           03  WRK-CHK-KOKIGAK                         PIC 9(07).
           03  WRK-CHK-KOKIGAK2                        PIC 9(07).
           03  WRK-CHK-KOKIGAK4                        PIC 9(07).
           03  WRK-CHK-KOKIGAK5                        PIC 9(07).
           03  WRK-CHK-KOKIGAK6                        PIC 9(07).
           03  WRK-CHK-KOKIGAK7                        PIC 9(07).
           03  WRK-CHK-KOKIGAK8                        PIC 9(07).
           03  WRK-CHK-KOKIGAK9                        PIC 9(07).
           03  WRK-CHK-KOKIGAK10                       PIC S9(07).
      *
           03  WRK-KEISAN1                             PIC 9(07).
           03  WRK-KEISAN2                             PIC 9(07).
           03  WRK-KEISAN3                             PIC 9(07).
           03  WRK-KEISAN4                             PIC 9(07).
           03  WRK-KEISAN9                             PIC 9(07).
           03  WRK-KEISAN10                            PIC 9(09).
           03  WRK-KEISAN-XXX                          PIC 9(07).
           03  WRK-KEISAN-YYY                          PIC 9(07).
           03  WRK-KEISAN-ZZZ                          PIC 9(07).
      *
           03  WRK-ZENKAKU                             PIC X(80).
           03  WRK-NUM.
               05  WRK-NUM-X                           PIC X(10).
               05  FILLER                              PIC X(70).
           03  WRK-NUM-9                               PIC 9(10). 
           03  WRK-STIDX                               PIC 9(02).
           03  WRK-EDIDX                               PIC 9(02).
      *
           03  WRK-GAIJGNGAK                           PIC 9(07).
      *
           03  WRK-TOKKI                               PIC X(02).
           03  TOKKI-IDX                               PIC 9(02). 
           03  TOKKI-IDX2                              PIC 9(02).
      *
           03  WRK-TANICD                              PIC 9(03).
           03  WRK-TANIMOJISU                          PIC 9(01).
           03  WRK-TANINAME                            PIC X(24).
           03  WRK-SRYSURYO                            PIC 9(05)V9(05).
           03  WRK-SRYSURYO2                           PIC 9(05).
           03  WRK-SRYSURYO3                           PIC 9(05).
           03  WRK-KZI058-TEN                          PIC 9(09)V99.
           03  WRK-KZI058-TANICD                       PIC 9(03).
           03  WRK-KZI058-TANIMOJISU                   PIC 9(01).
           03  WRK-KZI058-TANINAME                     PIC X(24).
           03  WRK-RENNUM                              PIC 9(02).
           03  WRK-RENNUM2                             PIC 9(02).
      *
           03  WRK-SRYCD                               PIC 9(09).
      *
           03  WRK-SISETU613                           PIC 9(01).
           03  WRK-SISETU695                           PIC 9(01).
           03  WRK-SISETU3055                          PIC 9(01).
           03  WRK-SISETU3056                          PIC 9(01).
           03  WRK-SISETU3057                          PIC 9(01).
           03  WRK-SISETU3058                          PIC 9(01).
           03  WRK-SISETU3168                          PIC 9(01).
           03  WRK-SISETU3169                          PIC 9(01).
      *
           03  WRK-FILMTEN                             PIC 9(07)V9(02).
           03  WRK-FILMTEN2                            PIC 9(07)V9(02).
      *
           03  WRK-KOGAKU-TAISYOGAI-T.
             04  WRK-KOGAKU-TAISYOGAI-OCC              OCCURS  4.
               05  WRK-KOGAKU-TAISYOGAI                PIC 9(01).
      *
      *    1桁目:生保 2桁目:結核 3桁目:精神
           03  WRK-3SYU-KBN.
               05  WRK-3SYU        PIC X(03).
      *
      *    パス名領域
           03  WRK-MCP-TABLE       PIC X(64).
           03  WRK-MCP-PATHNAME    PIC X(64).
           03  WRK-SRYACCT-PATHNAME
                                   PIC X(64).
      *
      *    数字半角全角変換用     
           03  WRK-CHAR-IDX                    PIC 9(02).
           03  WRK-CHAR-HENKAN-AREA.
               05  WRK-CHAR-X                  PIC X(20).
               05  WRK-CHAR-N                  PIC X(40).
               05  WRK-CHAR-CNT                PIC 9(02).
               05  WRK-CHAR-N-CNT              PIC 9(02).
      *     
      *    単価編集用     
           03  WRK-TANKA                       PIC 9(09)V9(02).
           03  WRK-TANKA-R  REDEFINES  WRK-TANKA.
               05  WRK-TANKA-S1                PIC 9(09).
               05  WRK-TANKA-S2                PIC 9(02).
           03  WRK-TANKA-X.
               05  WRK-TANKA-Z1                PIC ZZZZZZZZ9.
               05  WRK-TANKA-Z2                PIC X(01).
               05  WRK-TANKA-Z3                PIC ZZ.
      *
      *
           03  WRK-SRYCDTOTAL9                 PIC 9(14).
           03  WRK-SRYCDTOTALX   REDEFINES     WRK-SRYCDTOTAL9
                                               PIC X(14).
           03  WRK-ZAINUM                      PIC 9(08).
      *
           03  WRK-KEISAN-COMPFTN              PIC 9(07).
           03  WRK-JYOSEIGAKU                  PIC 9(07).
           03  WRK-KEISU                       PIC 9V99.
      *
      ***  03  WRK-FUKA-KINGAKU                PIC 9(09).
           03  WRK-FUKA-KINGAKU                PIC 9(13)V9(05).
           03  WRK-FUKA-VALUE                  PIC 9(01).
      *
           03  WRK-BIRTHDAY                    PIC X(08).
      *
           03  WK-GENGAKUKBN                   PIC  9(01).
           03  WK-GENGAKUKBN-KEISAN            PIC  9(01).
           03  WK-GENGAKU-KOHID                PIC  9(10).
           03  WK-GENGAKU-RITU                 PIC  9(03).
           03  WK-GENGAKU-RITUX                PIC  9(03).
           03  WK-GENGAKU-RITU-KEISAN          PIC  9V99.
           03  WK-GENGAKU-KIN                  PIC  9(07).
           03  WK-GENGAKU-KIN2                 PIC  9(07).
           03  WK-GENGAKU-KIN3                 PIC  9(07).
           03  WK-GENGAKU-KTKBN                PIC  9(01).
      *
           03  WK-GENGAKU-KEISAN1              PIC  9(07).
           03  WK-GENGAKU-KEISAN2              PIC  9(07).
           03  WK-GENGAKU-KEISAN3              PIC  9(07).
           03  WK-GENGAKU-KEISAN9              PIC  9(07).
      *
           03  WK-GENGAKU-YMD.
               05  WK-GENGAKU-YM               PIC  9(06).
               05  WK-GENGAKU-DD               PIC  9(02).
           03  WK-GENGAKU2-YMD.
               05  WK-GENGAKU2-YM              PIC  9(06).
               05  WK-GENGAKU2-DD              PIC  9(02).
           03  WK-GENGAKU3-YMD.
               05  WK-GENGAKU3-YM              PIC  9(06).
               05  WK-GENGAKU3-DD              PIC  9(02).
      *
           03  WK-CHECK-TEKSTYMD               PIC  X(08).
           03  WK-CHECK-TEKEDYMD               PIC  X(08).
      *
           03  WRK-CHIHOU-KIN                  PIC  9(09).
           03  WRK-CHIHOU-KIN2                 PIC  9(09).
           03  WRK-CHIHOU-KIN4                 PIC  9(09).
           03  WRK-CHIHOU-KIN5                 PIC  9(09).
           03  WRK-CHIHOU-KIN6                 PIC  9(09).
           03  WRK-CHIHOU-KIN7                 PIC  9(09).
           03  WRK-CHIHOU-KIN8                 PIC  9(09).
      *
           03  WRK-GEN70-YMD.
               05  WRK-GEN70-YM                PIC  9(06).
               05  WRK-GEN70-DD                PIC  9(02).
      *
           03  WRK-GEN702-YMD.
               05  WRK-GEN702-YM               PIC  9(06).
               05  WRK-GEN702-DD               PIC  9(02).
      *
           03  WRK-KOH-GENDOGAKU               PIC  9(07).
           03  WRK-GEN70-GENDOGAKU             PIC  9(07).
           03  WRK-SEIHO-GENDO                 PIC  9(07).
           03  WRK-SEIHO-GENDO70               PIC  9(07).
           03  WRK-CYOKI-GENDO                 PIC  9(07).
           03  WRK-CYOKI-GENDO2                PIC  9(07).
           03  WRK-JYOGEN-KOH                  PIC  9(07).
           03  WRK-JYOGEN-KOH9                 PIC  9(07).
           03  WRK-JIRITU-TAFTNRUIKEI          PIC  9(07).
           03  WRK-JIRITU-CYUKANSOU            PIC  9(01).
           03  WRK-KOUREI-IRYOHI70             PIC  9(09).
           03  WRK-KOUREI-IRYOHI70X            PIC  9(09).
           03  WRK-FTNKEI-KOH                  PIC  9(07).
           03  WRK-TAIHI-GENKIN2               PIC  9(07)V9(01).
           03  WRK-TAIHI-GENKIN3               PIC  9(07).
           03  WRK-TAIHI-GENKIN4               PIC  9(07).
           03  WRK-TAIHI-GENKIN-TBL.
              05  WRK-TAIHI-GENKIN-OCC         OCCURS   4.
                07  WRK-TAIHI-GENKIN           PIC  9(07).
                07  WRK-TAIHI-GENKIN-EN        PIC  9(07)V9(01).
                07  WRK-TAIHI-GENKIN9          PIC  9(07).
                07  WRK-TAIHI-GENKIN-GEN       PIC  9(07).
                07  WRK-TAIHI-GENKIN-EN-GEN    PIC  9(07)V9(01).
           03  WRK-TAIHI-GENKIN-XXX            PIC  9(07).
           03  WRK-TAIHI-GENKIN-XXX-EN         PIC  9(07).
      *
           03  WRK-FORMALNAME                  PIC  X(300).
      *
           03  WRK-KOHCNT                      PIC  9(01).
      *
           03  WRK-HANTEI-TOTALTEN             PIC  9(09).
      *
           03  WRK-TOKU75-BIRTHDAY             PIC  X(08).
      *
           03  WRK-KINGAKU-TOK1                PIC  9(07).
           03  WRK-KINGAKU-TOK1X               PIC  9(07).
      *
           03  WRK-KINGAKU-TOK3                PIC  9(07).
           03  WRK-KINGAKU-TOK4                PIC  9(07).
           03  WRK-KINGAKU-TOK5                PIC  9(07).
      *
           03  WRK-KINGAKU-TOK7                PIC  9(07).
           03  WRK-KINGAKU-TOK8                PIC  9(07).
           03  WRK-KINGAKU-TOK9                PIC  9(07).
      *
           03  WRK-HKNFTNDATA-RUI              PIC  9(07).
      *
           03  WRK-SEIKYUSTYMD                 PIC  9(08).
           03  WRK-SEIKYUEDYMD                 PIC  9(08).
           03  WRK-STYMD                       PIC  X(08).
           03  WRK-EDYMD                       PIC  X(08).
      *
           03  WRK-KOH-KINGAKU                 PIC  9(07).
      *
           03  WRK-GENMEN-NASI-KIN             PIC  9(07).
      *
           03  WRK-JIRITU-SAIKEI               PIC  9(09).
           03  WRK-JIRITU-SAIKEI2              PIC  9(09).
      *
           03  WRK-SAIKEI-TAIHI                PIC  9(09).
      *
      *    数量編集用
           03  WRK-SURYOKETA                   PIC 9(02).
           03  WRK-SURYOKETA1                  PIC 9(02).
           03  WRK-SURYOKETA2                  PIC 9(02).
           03  WRK-SURYOST                     PIC 9(02).
           03  WRK-SURYO                       PIC 9(05)V9(05).
           03  WRK-SURYO-R  REDEFINES  WRK-SURYO.
               05  WRK-SURYO-S1                PIC 9(05).
               05  WRK-SURYO-S2                PIC 9(05).
           03  WRK-SURYO-X.
               05  WRK-SURYO-Z1                PIC ZZZZZ.
               05  WRK-SURYO-Z2                PIC X(01).
               05  WRK-SURYO-Z3                PIC ZZZZZ.
           03  WRK-SURYO-N.
               05  WRK-SURYO-N1                PIC X(10).
               05  WRK-SURYO-N2                PIC X(02).
               05  WRK-SURYO-N3                PIC X(10).
           03  WRK-SRYSURYOW                   PIC X(24).
      *
           03  WRK-SETCOM-JIDO                 PIC 9(03).
           03  WRK-SETCOM-JIDO2                PIC 9(03).
      *
           03  WRK-SURYOU-COUNT                PIC 9(09).
      *
           03  WRK-FTNMONEY-MAE                PIC 9(09).
           03  WRK-FTNMONEY-ATO                PIC 9(09).
      *
           03  WRK-CYOKI-KEISAN                PIC 9(09).
           03  WRK-CYOKI-KEISAN2               PIC 9(09).
           03  WRK-CYOKI-KEISAN3               PIC 9(09).
           03  WRK-CYOKI-KEISAN4               PIC 9(09).
           03  WRK-CYOKI-KEISAN5               PIC 9(09).
           03  WRK-CYOKI-KEISAN6               PIC 9(09).
           03  WRK-CYOKI-KEISAN7               PIC 9(09).
           03  WRK-CYOKI-KEISAN8               PIC 9(09).
      *
           03  WRK-CYOKI-JGNGAK                PIC 9(09).
           03  WRK-CYOKI-KOH-FTN               PIC 9(09).
           03  WRK-CYOKI-KOH-FTN2              PIC 9(09).
           03  WRK-CYOKI-KOH-FTN3              PIC 9(09).
      *
           03  WRK-ZENKI-FTNMONEY              PIC 9(09).
      *
           03  WRK-SYSCHK-SRYYM                PIC X(06).
           03  WRK-SYSCHK-HOSPCD               PIC 9(07).
      *
           03  WRK-CYOKI-TOTAL-HKNKIN          PIC 9(07).
           03  WRK-CYOKI-TOTAL-HKNKIN-X        PIC 9(07).
           03  WRK-CYOKI-TOTAL-HKNKIN-X2       PIC 9(07).
           03  WRK-CYOKI-TOTAL-HKNTEN          PIC 9(07).
           03  WRK-CYOKI-TOTAL-HKNTEN2         PIC 9(07).
      *
           03  WRK-KOHJGNGET-TAISYOKBN-T.
             04  WRK-KOHJGNGET-TAISYOKBN-OCC   OCCURS  4.
               05  WRK-KOHJGNGET-TAISYOKBN     PIC 9(01).
               05  WRK-KOHJGNGET-TEKIYOFLG     PIC 9(01).
      *
           03  WRK-KYURATE                     PIC 9(03).
           03  WRK-KYURATE2                    PIC 9(03).
           03  WRK-KYURATE3                    PIC 9(03).
      *
           03  WRK-INPUTCOMENT                 PIC X(140).
           03  WRK-INPUTCOMENT2                PIC X(14).
           03  WRK-INPUTCOMENT-KIN-T.
               05  WRK-INPUTCOMENT-KIN         PIC 9(07).
           03  WRK-INPUTCOMENT-KIN2-T.
               05  WRK-INPUTCOMENT-KIN2        PIC X(07).
      *
           03  WRK-RIHA-YMD                    PIC X(07).
           03  WRK-RIHA-YMD-SEI                PIC X(08).
      *
           03  WRK-1030-KOUHATUKA              PIC X(01).
      *
           03  WRK-TAIHI-ZAINUM                PIC 9(08).
           03  WRK-TAIHI-OKIKAE                PIC 9(01).
           03  WRK-TAIHI-ZAINUM2               PIC 9(08).
           03  WRK-TAIHI-OKIKAE2               PIC 9(01).
           03  WRK-TAIHI-ZAINUM3               PIC 9(08).
      *
           03  WRK-TAIHI-TOTALTEN              PIC 9(08).
           03  WRK-DAISAN-FTNMONEY             PIC 9(08).
           03  WRK-DAISAN-FTNMONEY2            PIC 9(08).
           03  WRK-DAISAN-FTNMONEY3            PIC 9(08).
           03  WRK-DAISAN-TOTALTEN-GEN         PIC 9(08).
           03  WRK-DAISAN-DAISANKBN            PIC X(01).
           03  WRK-DAISAN-TOTALTEN-SYUNOU      PIC 9(08).
           03  WRK-DAISAN-ACCT-UPDKBN          PIC X(01).
      *
           03  WRK-COL                         PIC 9(03).
      *
           03  WRK-KOHHBTNUM                   PIC X(02).
      *
           03  WRK-HKNNUM-CHECK-T.
               05  WRK-HKNNUM-CHECK-OCC        OCCURS 100.
                 07  WRK-HKNNUM                PIC X(03).
                 07  WRK-HKNNUM-KOHHBTNUM      PIC X(02).
      *
           03  WRK-CYOFUKU-KOH-YMD.
               05  WRK-CYOFUKU-KOH-YM          PIC 9(06).
               05  WRK-CYOFUKU-KOH-DD          PIC 9(02).
      *
           03  WRK-TOKUSITU-TOKKI              PIC X(02).
           03  WRK-TOKUSITU-TOKKI2             PIC X(02).
      *
           03  WRK-CHIIKI-ENTANI               PIC 9(08).
      *
           03  WRK-SENIN-HOJOKBN               PIC X(01).
      *
           03  WRK-KASANKIN                    PIC 9(08).
      *
      *---------------------------------------------------------------
      *  回数減算用退避領域
      *    処方減回数
           03  WRK-SYOHOU-KAISU                PIC 9(03).
      *    処方せん減回数
           03  WRK-SYOSEN-KAISU                PIC 9(03).
      *    処方料（麻・向・毒・覚）
           03  WRK-MADOKU-SHOHO                PIC 9(03).
      *---------------------------------------------------------------
      *
       01  WRK-ERR-AREA.
           03  WRK-RECEERR                         PIC X(200).
           03  WRK-ERRMSG                          PIC X(300).
           03  WRK-MCP-RC                          PIC 9(9).
           03  WRK-ERR-FILE-STS                    PIC X(02).
           03  WRK-ERR-FILE-MSG                    PIC X(100).
           03  WRK-ERR-FILE-MSG1                   PIC X(17).
           03  WRK-ERR-FLG                         PIC 9(01).
      *    エラーファイル名称領域 
           COPY    "CPTEMPFL.INC"  REPLACING  //TEMPFLPARA//
                                   BY         //WRK-ERR-FILE-NM//.
      *    FULLNAME内のBASENAME開始位置
       01  WRK-SGETTEMP-ST         PIC 9(05).
      *
      *    剤の診療内容チェックテーブル
       01  TBL-ZAICHECK-AREA.
      *    （サ）
           03  FILLER          PIC X(09)   VALUE    "820000046".
      *    （検選）
           03  FILLER          PIC X(09)   VALUE    "820000053".
      *    （リハ選）
           03  FILLER          PIC X(09)   VALUE    "820000054".
      *    （精選）
           03  FILLER          PIC X(09)   VALUE    "820000055".
      *
       01  TBL-ZAICHECK-R      REDEFINES   TBL-ZAICHECK-AREA.
           03  TBL-ZAICHECK    PIC X(09)   OCCURS    4.
      *
       01  TBL-ZAICHECK-MAX    PIC 9(02)   VALUE     4.
      *
      *    減額・免除・支払猶予判定用テーブル
       01  TBL-GENGAKU-AREA.
           03  FILLER          PIC X(03)   VALUE    "960".
           03  FILLER          PIC X(03)   VALUE    "961".
           03  FILLER          PIC X(03)   VALUE    "962".
           03  FILLER          PIC X(03)   VALUE    "963".
           03  FILLER          PIC X(03)   VALUE    "953".
      *
       01  TBL-GENGAKU-R       REDEFINES   TBL-GENGAKU-AREA.
           03  TBL-GENGAKU     PIC X(03)   OCCURS    5.
      *
       01  TBL-GENGAKU-MAX     PIC 9(02)   VALUE     5.
      *
      *    ７０歳未満現物給付判定用テーブル
       01  TBL-GENBUTU70-AREA.
           03  FILLER          PIC X(03)   VALUE    "966".
           03  FILLER          PIC X(03)   VALUE    "967".
      *
       01  TBL-GENBUTU70-R     REDEFINES   TBL-GENBUTU70-AREA.
           03  TBL-GENBUTU70   PIC X(03)   OCCURS    2.
      *
       01  TBL-GENBUTU70-MAX   PIC 9(02)   VALUE     2.
      *
      *    入所判定用テーブル
       01  TBL-NYUSYO-AREA.
           03  FILLER          PIC X(03)   VALUE    "948".
           03  FILLER          PIC X(03)   VALUE    "949".
           03  FILLER          PIC X(03)   VALUE    "950".
           03  FILLER          PIC X(03)   VALUE    "951".
      *
       01  TBL-NYUSYO-R        REDEFINES   TBL-NYUSYO-AREA.
           03  TBL-NYUSYO      PIC X(03)   OCCURS    4.
      *
       01  TBL-NYUSYO-MAX      PIC 9(02)   VALUE     4.
      *
      *    在総診テーブル（２０１６年４月診療分〜）
       01  TBL-ZAITAKU-AREA.
      *    在がん医総（在支診等）（処方せんあり）
           03  FILLER          PIC X(09)   VALUE   "114007610".
      *    在がん医総（在支診等）（処方せんなし）
           03  FILLER          PIC X(09)   VALUE   "114007710".
      *    在医総・在医総管（ＤＵＭＭＹ）
           03  FILLER          PIC X(09)   VALUE   "099140003".
      *
      *    在がん医総（機能強化した在支診等）（病床あり）（処方せんあり）
           03  FILLER          PIC X(09)   VALUE   "114019510".
      *    在がん医総（機能強化した在支診等）（病床あり）（処方せんなし）
           03  FILLER          PIC X(09)   VALUE   "114019610".
      *    在がん医総（機能強化した在支診等）（病床なし）（処方せんあり）
           03  FILLER          PIC X(09)   VALUE   "114019710".
      *    在がん医総（機能強化した在支診等）（病床なし）（処方せんなし）
           03  FILLER          PIC X(09)   VALUE   "114019810".
      *
      *    在医総管（機能強化在支診等・病床有・難病等月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114030710".
      *    在医総管（機能強化在支診等・病床有・難病等月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114030810".
      *    在医総管（機能強化在支診等・病床有・難病等月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114030910".
      *    在医総管（機能強化在支診等・病床有・月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114031010".
      *    在医総管（機能強化在支診等・病床有・月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114031110".
      *    在医総管（機能強化在支診等・病床有・月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114031210".
      *    在医総管（機能強化在支診等・病床有・月１回・１人）
           03  FILLER          PIC X(09)   VALUE   "114031310".
      *    在医総管（機能強化在支診等・病床有・月１回・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114031410".
      *    在医総管（機能強化在支診等・病床有・月１回・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114031510".
      *    在医総管（機能強化在支診等・病床無・難病等月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114031610".
      *    在医総管（機能強化在支診等・病床無・難病等月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114031710".
      *    在医総管（機能強化在支診等・病床無・難病等月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114031810".
      *    在医総管（機能強化在支診等・病床無・月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114031910".
      *    在医総管（機能強化在支診等・病床無・月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114032010".
      *    在医総管（機能強化在支診等・病床無・月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114032110".
      *    在医総管（機能強化在支診等・病床無・月１回・１人）
           03  FILLER          PIC X(09)   VALUE   "114032210".
      *    在医総管（機能強化在支診等・病床無・月１回・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114032310".
      *    在医総管（機能強化在支診等・病床無・月１回・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114032410".
      *    在医総管（在支診等・難病等月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114032510".
      *    在医総管（在支診等・難病等月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114032610".
      *    在医総管（在支診等・難病等月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114032710".
      *    在医総管（在支診等・月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114032810".
      *    在医総管（在支診等・月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114032910".
      *    在医総管（在支診等・月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114033010".
      *    在医総管（在支診等・月１回・１人）
           03  FILLER          PIC X(09)   VALUE   "114033110".
      *    在医総管（在支診等・月１回・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114033210".
      *    在医総管（在支診等・月１回・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114033310".
      *    在医総管（在支診等以外・難病等月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114033410".
      *    在医総管（在支診等以外・難病等月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114033510".
      *    在医総管（在支診等以外・難病等月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114033610".
      *    在医総管（在支診等以外・月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114033710".
      *    在医総管（在支診等以外・月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114033810".
      *    在医総管（在支診等以外・月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114033910".
      *    在医総管（在支診等以外・月１回・１人）
           03  FILLER          PIC X(09)   VALUE   "114034010".
      *    在医総管（在支診等以外・月１回・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114034110".
      *    在医総管（在支診等以外・月１回・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114034210".
      *
      *    施医総管（機能強化在支診等・病床有・難病等月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114035510".
      *    施医総管（機能強化在支診等・病床有・難病等月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114035610".
      *    施医総管（機能強化在支診等・病床有・難病等月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114035710".
      *    施医総管（機能強化在支診等・病床有・月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114035810".
      *    施医総管（機能強化在支診等・病床有・月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114035910".
      *    施医総管（機能強化在支診等・病床有・月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114036010".
      *    施医総管（機能強化在支診等・病床有・月１回・１人）
           03  FILLER          PIC X(09)   VALUE   "114036110".
      *    施医総管（機能強化在支診等・病床有・月１回・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114036210".
      *    施医総管（機能強化在支診等・病床有・月１回・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114036310".
      *    施医総管（機能強化在支診等・病床無・難病等月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114036410".
      *    施医総管（機能強化在支診等・病床無・難病等月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114036510".
      *    施医総管（機能強化在支診等・病床無・難病等月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114036610".
      *    施医総管（機能強化在支診等・病床無・月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114036710".
      *    施医総管（機能強化在支診等・病床無・月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114036810".
      *    施医総管（機能強化在支診等・病床無・月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114036910".
      *    施医総管（機能強化在支診等・病床無・月１回・１人）
           03  FILLER          PIC X(09)   VALUE   "114037010".
      *    施医総管（機能強化在支診等・病床無・月１回・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114037110".
      *    施医総管（機能強化在支診等・病床無・月１回・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114037210".
      *    施医総管（在支診等・難病等月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114037310".
      *    施医総管（在支診等・難病等月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114037410".
      *    施医総管（在支診等・難病等月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114037510".
      *    施医総管（在支診等・月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114037610".
      *    施医総管（在支診等・月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114037710".
      *    施医総管（在支診等・月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114037810".
      *    施医総管（在支診等・月１回・１人）
           03  FILLER          PIC X(09)   VALUE   "114037910".
      *    施医総管（在支診等・月１回・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114038010".
      *    施医総管（在支診等・月１回・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114038110".
      *    施医総管（在支診等以外・難病等月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114038210".
      *    施医総管（在支診等以外・難病等月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114038310".
      *    施医総管（在支診等以外・難病等月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114038410".
      *    施医総管（在支診等以外・月２回以上・１人）
           03  FILLER          PIC X(09)   VALUE   "114038510".
      *    施医総管（在支診等以外・月２回以上・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114038610".
      *    施医総管（在支診等以外・月２回以上・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114038710".
      *    施医総管（在支診等以外・月１回・１人）
           03  FILLER          PIC X(09)   VALUE   "114038810".
      *    施医総管（在支診等以外・月１回・２〜９人）
           03  FILLER          PIC X(09)   VALUE   "114038910".
      *    施医総管（在支診等以外・月１回・１０人〜）
           03  FILLER          PIC X(09)   VALUE   "114039010".
      *
       01  TBL-ZAITAKU-R       REDEFINES   TBL-ZAITAKU-AREA.
           03  TBL-ZAITAKU     PIC X(09)   OCCURS  79.
      *
       01  TBL-ZAITAKU-MAX     PIC 9(02)   VALUE   79.
      *
      *    酸素 
           COPY    "CMSANSOTBL.INC".
      *
      *   日本語数字
       01  TBL-SUJI-AREA.
           03  FILLER          PIC X(20)   VALUE
              "１２３４５６７８９０".
       01  TBL-SUJI-R          REDEFINES   TBL-SUJI-AREA.
           03  TBL-SUJI        PIC X(02)   OCCURS   10.
       01  TBL-SUJI-AREA-X.
           03  FILLER          PIC X(10)   VALUE
              "1234567890".
       01  TBL-SUJI-X-R        REDEFINES   TBL-SUJI-AREA-X.
           03  TBL-SUJI-X      PIC X(01)   OCCURS   10.
      *    
      *
       01  WRK-CONS-AREA.    
      *    固定端末ＩＤ
           03  WRK-CONS-TERMID     PIC X(64)   VALUE
                                   "0100007FZZZZZZZZZZZZZZZZZZZZZZZZ".
      * 
           03  WRK-CONS-SRYYM-200604  PIC 9(06)   VALUE   200604. 
      *
      *    改行コード
           03  WRK-CONS-RETURN      PIC X(01)   VALUE   X"0A".
      *
      *
           COPY    "MCPAREA".
      *
           COPY    "COMMON-SPA".
      *
      *    点数マスタ退避ワーク
           COPY    "CPTTNS.INC".
      *
      *    ＲＥＣＥ０２のワークレコード
       01  RECE2W-REC.
           COPY    "CPRCF002.INC"  REPLACING  //RECE02//
                                   BY         //RECE2W//.
      *
       01  RECE2G-REC.
           COPY    "CPRCF002.INC"  REPLACING  //RECE02//
                                   BY         //RECE2G//.
      *
      *    収納作成サブ
       01  LNK-ORCS02-REC.
           COPY  "CPORCS02.INC".
       01  LNK-SYUNOU-REC-T.
         02 LNK-SYUNOU-REC     OCCURS 10.
           COPY  "CPSYUNOU.INC"  REPLACING  //SYU-//  BY //LNK-SYU-//.
       01  LNK-SYUDAY-REC-T.
         02 LNK-SYUDAY-REC     OCCURS 10.
           COPY  "CPSYUDAY.INC"  REPLACING  //SDAY-// BY //LNK-SDAY-//.
      *
      *****************************************************************
      *    ファイルレイアウト
      *****************************************************************
      *
      *    ジョブ管理マスタ
       01  JOBKANRI-REC.
           COPY    "CPJOBKANRI.INC".
      *
      *    診療会計
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    診療行為
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *    点数
           COPY    "CPTENSU.INC".
      *
      *    収納
       01  SYUNOU-REC.
           COPY    "CPSYUNOU.INC".
      *
      *    患者入院履歴
       01  PTNYUINRRK-REC.
           COPY    "CPPTNYUINRRK.INC".
      *
      *    システム管理
           COPY    "CPSYSKANRI.INC".
      *    
           COPY    "CPSK1001.INC".
           COPY    "CPSK1006.INC".
      *    
           COPY    "CPSK2005.INC".     
           COPY    "CPSK200501.INC".     
      *
           COPY    "CPSK2010.INC".
           COPY    "CPSK2012.INC".
      *
           COPY    "CPSK1001.INC"  REPLACING  //SYS-1001-//
                                   BY         //WRK-1001-//.
      *
           COPY    "CPSK1030.INC".
      *
      *    患者コメント
       01  PTCOM-REC.
           COPY    "CPPTCOM.INC".
      *
      *    患者公費情報
       01  PTKOHINF-REC.
           COPY    "CPPTKOHINF.INC".
      *
      *    保険組み合わせ
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *    分娩管理テーブル
       01  BUNBEN-REC.
           COPY    "CPBUNBEN.INC".
      *
      *    診療会計マスタ付加
       01  SRYACCTPLUS-REC.
           COPY    "CPSRYACCTPLUS.INC".
      *
      *    保険番号
       01  HKNNUM-REC.
           COPY    "CPHKNNUM.INC".
      *
      *    レセプトコメントマスタ
       01  RECECOM-REC.
           COPY    "CPRECECOM.INC".
      *
      *    受診履歴
       01  JYURRK-REC.
           COPY    "CPJYURRK.INC".
      *
      *    患者保険情報
       01  PTHKNINF-REC.
           COPY    "CPPTHKNINF.INC".
      *
      *****************************************************************
      *    サブプロ用領域
      *****************************************************************
      *
      *    半角チェックサブ
           COPY    "CPORCSKANACHK.INC".
      *
      *   日付変換サブ
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *    患者番号変換サブ
           COPY    "CPORCSPTID.INC".
      *    数値変換サブ
           COPY    "CPORCSNUM.INC".
      *    チェックディジット（モジュラス１１用）算出サブ
           COPY    "CPORCCHKDGT11.INC".
      *   ジョブ管理ＤＢ制御サブ
           COPY    "CPORCSJOBKANRI.INC".
      *    公費月上限額取得サブ
           COPY    "CPORCSJGNGET.INC".
      *    高齢者の一部負担金額記載に関するチェックサブ
           COPY    "CPORCSKOREIFTNCHK.INC".
      *    保険算定用年齢・割合計算サブ
           COPY    "CPORCSAGECHK.INC".
      *    患者自己負担金レセプト記載判定
           COPY    "CPORCSFTNJGNCHK.INC".
      *    特定疾患等算定判定サブ
           COPY    "CPORCSSRHKOH.INC".
      *    院外処方一般名編集サブ
           COPY    "CPORCSGETGENERIC.INC".
      *
           COPY    "CPORCSGETTEMP.INC".
      *
      *    ＤＢ検索
           COPY    "MCPDATA.INC".
      *
      ****************************************************************
       LINKAGE                 SECTION.
       01  COMMAND-PARAM.
           02  FILLER      PIC X(256).
      ****************************************************************
       PROCEDURE           DIVISION
               USING
           COMMAND-PARAM.
      *
      *****************************************************************
      *    主処理
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           PERFORM 100-INIT-SEC
      *
           PERFORM 200-MAIN-SEC    UNTIL   FLG-END =   1 
      *
           PERFORM 300-TERM-SEC
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
               STOP    RUN
           ELSE
               EXIT    PROGRAM
           END-IF 
           .
      *****************************************************************
      *    初期　処理
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
           INITIALIZE                  CNT-AREA
           INITIALIZE                  SPA-AREA
                                       WRK-AREA
                                       TTNS-AREA
                                       FLG-AREA
      *
           MOVE    ZERO                TO  FLG-END
      *
           UNSTRING    COMMAND-PARAM   DELIMITED  BY  ","
                                       INTO    WRK-PARA
                                               WRK-PARA-PRTKBN
                                               WRK-PARA-HOSPNUM
                                               RECEERR
           END-UNSTRING
           MOVE    WRK-PARA-HOSPNUM    TO  SPA-HOSPNUM
      *
           DISPLAY "WRK-PARA-PRTKBN =" WRK-PARA-PRTKBN
      *
           INITIALIZE                      SGETTEMP-AREA
           MOVE    RECEERR             TO  SGETTEMP-BASENAME
           CALL    "ORCSGETTEMP"       USING   SGETTEMP-AREA
           MOVE    SPACE               TO  RECEERR
           MOVE    SGETTEMP-FULLNAME   TO  RECEERR
      *
           MOVE   SGETTEMP-ST          TO  WRK-SGETTEMP-ST
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *    ＤＢオープン処理
               PERFORM 100-DBOPEN-SEC
      *
      *    ステップ管理開始処理
               MOVE    "STS"               TO  SJOBKANRI-MODE
               INITIALIZE                      JOBKANRI-REC
               MOVE    "ORCR0030"          TO  JOB-PGID
               MOVE    "診療区分別点数集計"
                                           TO  JOB-SHELLMSG
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
      *    処理中止設定処理
               PERFORM 500-CANCEL-HENSYU-SEC
           END-IF
      *
           IF   WRK-PARA-SRYYM    NOT =  ZERO
              MOVE    ZERO             TO  FLG-SYSCHK
      *       医療機関情報
              INITIALIZE                   SYSKANRI-REC
              MOVE    "1001"           TO  SYS-KANRICD
              MOVE    "*"              TO  SYS-KBNCD
              MOVE    WRK-PARA-SRYYM   TO  SYS-STYUKYMD (1:6)
              MOVE    "01"             TO  SYS-STYUKYMD (7:2)
              MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
              MOVE    "tbl_syskanri"   TO  WRK-MCP-TABLE
              MOVE    "key10"          TO  WRK-MCP-PATHNAME
              PERFORM 960-KANRIMST-READ-SEC
              IF      FLG-SYSKANRI     =   ZERO
                  MOVE    MCPDATA-REC  TO  SYS-1001-REC
      *           システム管理１００１のチェック
                  MOVE    SYS-1001-HOSPCD
                                       TO  WRK-SYSCHK-HOSPCD
                  MOVE    WRK-PARA-SRYYM
                                       TO  WRK-SYSCHK-SRYYM
                  PERFORM 901-SYSKANRI-CHECK-SEC
                  MOVE    SYS-1001-DAISANKBN
                                       TO  WRK-DAISAN-DAISANKBN
                  IF  WRK-DAISAN-DAISANKBN = SPACE
                    MOVE  "2"          TO  WRK-DAISAN-DAISANKBN
                  END-IF
              ELSE    
                  MOVE    "医療機関情報が取得できませんでした。"
                                       TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
              END-IF    
      *       施設基準情報
              MOVE     ZERO     TO     WRK-SISETU613
              MOVE     ZERO     TO     WRK-SISETU695
              MOVE     ZERO     TO     WRK-SISETU3055
              MOVE     ZERO     TO     WRK-SISETU3056
              MOVE     ZERO     TO     WRK-SISETU3057
              MOVE     ZERO     TO     WRK-SISETU3058
              MOVE     ZERO     TO     WRK-SISETU3168
              MOVE     ZERO     TO     WRK-SISETU3169
              PERFORM  VARYING  IDXA   FROM   1   BY  1
                        UNTIL   IDXA     >    7
               IF   IDXA  =  1 OR 3 OR 4 OR 5 OR 6
                 CONTINUE
               ELSE
                 INITIALIZE                   SYSKANRI-REC
                 MOVE    "1006"           TO  SYS-KANRICD
                 MOVE    IDXA             TO  SYS-KBNCD
                 MOVE    WRK-PARA-SRYYM   TO  SYS-STYUKYMD (1:6)
                 MOVE    "01"             TO  SYS-STYUKYMD (7:2)
                 MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
                 MOVE    "tbl_syskanri"   TO  WRK-MCP-TABLE
                 MOVE    "key10"          TO  WRK-MCP-PATHNAME
                 PERFORM 960-KANRIMST-READ-SEC
                 IF      FLG-SYSKANRI     =   ZERO
                   MOVE     MCPDATA-REC   TO  SYS-1006-REC
                   EVALUATE  IDXA
                     WHEN     2
                       MOVE  SYS-1006-SSTKIJUN(113)  TO  WRK-SISETU613
                       MOVE  SYS-1006-SSTKIJUN(195)  TO  WRK-SISETU695
                     WHEN     7
                       MOVE  SYS-1006-SSTKIJUN(55)   TO  WRK-SISETU3055
                       MOVE  SYS-1006-SSTKIJUN(56)   TO  WRK-SISETU3056
                       MOVE  SYS-1006-SSTKIJUN(57)   TO  WRK-SISETU3057
                       MOVE  SYS-1006-SSTKIJUN(58)   TO  WRK-SISETU3058
                       MOVE  SYS-1006-SSTKIJUN(168)  TO  WRK-SISETU3168
                       MOVE  SYS-1006-SSTKIJUN(169)  TO  WRK-SISETU3169
                   END-EVALUATE
                 END-IF
               END-IF
              END-PERFORM
      *       帳票編集区分情報
              MOVE    SPACE            TO  WRK-1030-KOUHATUKA
      **>     IF      WRK-PARA-PRTKBN = "9" OR "2" OR "3" OR "4" OR "5"
                INITIALIZE                   SYSKANRI-REC
                MOVE    "1030"           TO  SYS-KANRICD
                MOVE    "*"              TO  SYS-KBNCD
                MOVE    WRK-PARA-SRYYM   TO  SYS-STYUKYMD (1:6)
                MOVE    "01"             TO  SYS-STYUKYMD (7:2)
                MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
                MOVE    "tbl_syskanri"   TO  WRK-MCP-TABLE
                MOVE    "key10"          TO  WRK-MCP-PATHNAME
                PERFORM 960-KANRIMST-READ-SEC
                IF      FLG-SYSKANRI     =   ZERO
                  MOVE    MCPDATA-REC  TO  SYS-1030-REC
                  MOVE    SYS-1030-KOUHATUKA
                                       TO  WRK-1030-KOUHATUKA
                END-IF
      **>     END-IF
           ELSE
              MOVE     ZERO               TO  SYSKAN-IDX
              MOVE     SPACE              TO  TBL-SYS1001-T
              INITIALIZE                      TBL-SYS1001-T
      *
              INITIALIZE                      SYSKANRI-REC
              MOVE    "1001"              TO  SYS-KANRICD
              MOVE    "*"                 TO  SYS-KBNCD
grpsys        MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
              MOVE    SYSKANRI-REC        TO  MCPDATA-REC
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key8"              TO  MCP-PATHNAME
grpsys        PERFORM 900-DBSELECT-SEC
              IF      MCP-RC              =   ZERO
                  MOVE    "tbl_syskanri"      TO  MCP-TABLE
                  MOVE    "key8"              TO  MCP-PATHNAME
                  PERFORM  970-KANRIMST-READ-SEC
                  PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                            OR    (SYSKAN-IDX   >=  100)
      *
                    MOVE    MCPDATA-REC   TO  SYS-1001-REC
                    ADD     1             TO  SYSKAN-IDX
                    MOVE    SYS-1001-REC  TO  TBL-SYS1001(SYSKAN-IDX)
      *
                    MOVE    "tbl_syskanri"      TO  MCP-TABLE
                    MOVE    "key8"              TO  MCP-PATHNAME
                    PERFORM 970-KANRIMST-READ-SEC
      *
                  END-PERFORM
              ELSE
                  MOVE    "医療機関情報が取得できませんでした。"
                                       TO  WRK-RECEERR
                  PERFORM 500-ERR-HENSYU-SEC
              END-IF
      *
              MOVE    "tbl_syskanri"      TO  MCP-TABLE
              MOVE    "key8"              TO  MCP-PATHNAME
              PERFORM 900-CLOSE-SEC
      *
              MOVE     SPACE              TO  TBL-SYS1006-T
              INITIALIZE                      TBL-SYS1006-T
      *
              PERFORM  VARYING  IDXA   FROM   1   BY  1
                        UNTIL   IDXA     >    7
               IF   IDXA  =  1 OR 3 OR 4 OR 5 OR 6
                 CONTINUE
               ELSE
                 MOVE     ZERO            TO  SYSKAN-IDX2
                 INITIALIZE                   SYSKANRI-REC
                 MOVE    "1006"           TO  SYS-KANRICD
                 MOVE    IDXA             TO  SYS-KBNCD
grpsys           MOVE    SPA-HOSPNUM      TO  SYS-HOSPNUM
                 MOVE    SYSKANRI-REC     TO  MCPDATA-REC
                 MOVE    "tbl_syskanri"      TO  MCP-TABLE
                 MOVE    "key8"              TO  MCP-PATHNAME
grpsys           PERFORM 900-DBSELECT-SEC
                 IF      MCP-RC              =   ZERO
                     MOVE    "tbl_syskanri"      TO  MCP-TABLE
                     MOVE    "key8"              TO  MCP-PATHNAME
                     PERFORM  970-KANRIMST-READ-SEC
                     PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                               OR    (SYSKAN-IDX2  >=  100)
      *
                       MOVE    MCPDATA-REC   TO  SYS-1006-REC
                       EVALUATE  IDXA
                         WHEN     2
                           ADD     1     TO  SYSKAN-IDX2
                           MOVE    SYS-1006-REC
                                         TO  TBL-SYS10062(SYSKAN-IDX2)
                         WHEN     7
                           ADD     1     TO  SYSKAN-IDX2
                           MOVE    SYS-1006-REC
                                         TO  TBL-SYS10067(SYSKAN-IDX2)
                       END-EVALUATE
      *
                       MOVE    "tbl_syskanri"      TO  MCP-TABLE
                       MOVE    "key8"              TO  MCP-PATHNAME
                       PERFORM 970-KANRIMST-READ-SEC
      *
                     END-PERFORM
                 END-IF
                 MOVE    "tbl_syskanri"      TO  MCP-TABLE
                 MOVE    "key8"              TO  MCP-PATHNAME
                 PERFORM 900-CLOSE-SEC
               END-IF
              END-PERFORM
      *
              MOVE     ZERO               TO  SYSKAN-IDX
              MOVE     SPACE              TO  TBL-SYS1030-T
              INITIALIZE                      TBL-SYS1030-T
      **>     IF      WRK-PARA-PRTKBN = "9" OR "2" OR "3" OR "4" OR "5"
                INITIALIZE                      SYSKANRI-REC
                MOVE    "1030"              TO  SYS-KANRICD
                MOVE    "*"                 TO  SYS-KBNCD
                MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
                MOVE    SYSKANRI-REC        TO  MCPDATA-REC
                MOVE    "tbl_syskanri"      TO  MCP-TABLE
                MOVE    "key8"              TO  MCP-PATHNAME
                PERFORM 900-DBSELECT-SEC
                IF      MCP-RC              =   ZERO
                  MOVE    "tbl_syskanri"      TO  MCP-TABLE
                  MOVE    "key8"              TO  MCP-PATHNAME
                  PERFORM  970-KANRIMST-READ-SEC
                  PERFORM  UNTIL  (FLG-SYSKANRI  =    1)
                            OR    (SYSKAN-IDX   >=  100)
      *
                    MOVE    MCPDATA-REC   TO  SYS-1030-REC
                    ADD     1             TO  SYSKAN-IDX
                    MOVE    SYS-1030-REC  TO  TBL-SYS1030(SYSKAN-IDX)
      *
                    MOVE    "tbl_syskanri"      TO  MCP-TABLE
                    MOVE    "key8"              TO  MCP-PATHNAME
                    PERFORM 970-KANRIMST-READ-SEC
                  END-PERFORM
                END-IF
                MOVE    "tbl_syskanri"      TO  MCP-TABLE
                MOVE    "key8"              TO  MCP-PATHNAME
                PERFORM 900-CLOSE-SEC
      **>     END-IF
           END-IF
      *
      *    レセプト編集区分情報
           MOVE    SPACE            TO  SYSKANRI-REC
           INITIALIZE                   SYSKANRI-REC
           MOVE    "2005"           TO  SYS-KANRICD
           MOVE    "*"              TO  SYS-KBNCD
           MOVE    WRK-PARA-SRYYM   TO  SYS-STYUKYMD (1:6)
           MOVE    "01"             TO  SYS-STYUKYMD (7:2)
           MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
           MOVE    "tbl_syskanri"   TO  WRK-MCP-TABLE
           MOVE    "key10"          TO  WRK-MCP-PATHNAME
           PERFORM 960-KANRIMST-READ-SEC
           IF      FLG-SYSKANRI     =   ZERO
               MOVE    MCPDATA-REC      TO  SYS-2005-REC
           ELSE    
               INITIALIZE                   SYS-2005-REC
               MOVE    ZERO             TO  SYS-2005-KKHOCRKBN 
           END-IF
           IF      SYS-2005-JIHITEKKSIKBN     =   SPACE
               MOVE    ZERO             TO  SYS-2005-JIHITEKKSIKBN
           END-IF
           IF      SYS-2005-SYAOCRKBN   =   SPACE
               MOVE    ZERO             TO  SYS-2005-SYAOCRKBN
           END-IF
           IF      SYS-2005-KKHOCRKBN   =   SPACE
               MOVE    ZERO             TO  SYS-2005-KKHOCRKBN
           END-IF
      *         
           MOVE    SPACE            TO  SYSKANRI-REC
           INITIALIZE                   SYSKANRI-REC
           MOVE    "2005"           TO  SYS-KANRICD
           MOVE    "01"             TO  SYS-KBNCD
           MOVE    WRK-PARA-SRYYM   TO  SYS-STYUKYMD (1:6)
           MOVE    "01"             TO  SYS-STYUKYMD (7:2)
           MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
           MOVE    "tbl_syskanri"      TO  WRK-MCP-TABLE
           MOVE    "key10"             TO  WRK-MCP-PATHNAME
           PERFORM 960-KANRIMST-READ-SEC
           IF      FLG-SYSKANRI     =   ZERO
               MOVE    MCPDATA-REC      TO  SYS-200501-REC
           ELSE    
               INITIALIZE                   SYS-200501-REC
           END-IF
           IF      SYS-200501-KOUIKIOCRKBN
                                    =   SPACE
               MOVE    ZERO             TO  SYS-200501-KOUIKIOCRKBN
           END-IF
           IF      SYS-200501-GENBUTU-ICHIBU-KSIKBN
                                    =   SPACE
               MOVE    "0"   TO  SYS-200501-GENBUTU-ICHIBU-KSIKBN
           END-IF
           IF      SYS-200501-INSPECT-GENERAL-KBN   =   SPACE
               MOVE    "0"   TO  SYS-200501-INSPECT-GENERAL-KBN
           END-IF
           IF      SYS-200501-COMPRESS-KBN          =   SPACE
               MOVE    "0"   TO  SYS-200501-COMPRESS-KBN
           END-IF
           IF      SYS-200501-15-YKZ-PRTKBN         =   SPACE
               MOVE    "0"   TO  SYS-200501-15-YKZ-PRTKBN
           END-IF
           IF      SYS-200501-KOUHI-ICHIBU-KSIKBN   =   SPACE
               MOVE    "0"   TO  SYS-200501-KOUHI-ICHIBU-KSIKBN
           END-IF
      *
          .
       100-INIT-EXT.
           EXIT.
      * 
      *****************************************************************
      *    主処理
      *****************************************************************
       200-MAIN-SEC                SECTION.
      *
           INITIALIZE                      SGETTEMP-AREA
           MOVE    "RECE040"           TO  RECEDAT1PARA-FILE-ID
           PERFORM 800-FILENM-SET-SEC
           MOVE    RECEDAT1PARA-BASENAME
                                       TO  SGETTEMP-BASENAMES  (1)
           MOVE    "RECE050"           TO  RECEDAT1PARA-FILE-ID
           PERFORM 800-FILENM-SET-SEC
           MOVE    RECEDAT1PARA-BASENAME
                                       TO  SGETTEMP-BASENAMES  (2)
           MOVE    "RECE090"           TO  RECEDAT1PARA-FILE-ID
           PERFORM 800-FILENM-SET-SEC
           MOVE    RECEDAT1PARA-BASENAME
                                       TO  SGETTEMP-BASENAMES  (3)
           CALL    "ORCSGETTEMP"       USING   SGETTEMP-AREA
           MOVE    SGETTEMP-FULLNAMES (1)
                                       TO  RECE04PARA
           MOVE    SGETTEMP-FULLNAMES (2)
                                       TO  RECE05PARA
           MOVE    SGETTEMP-FULLNAMES (3)
                                       TO  RECE09PARA
      *
           PERFORM VARYING IDZ FROM    1   BY  1
                   UNTIL   IDZ >       2
                   OR      FLG-END     =   1
      *
               IF      IDZ             =   1               
      *    レセプト処理
                   INITIALIZE                      SGETTEMP-AREA
                   MOVE    "RECE020"           TO  RECEDAT1PARA-FILE-ID
                   PERFORM 800-FILENM-SET-SEC
                   MOVE    RECEDAT1PARA-BASENAME
                                               TO  SGETTEMP-BASENAME
               ELSE
      *    請求書処理
                   INITIALIZE                      SGETTEMP-AREA
                   MOVE    "RECE02X"           TO  RECEDAT1PARA-FILE-ID
                   PERFORM 800-FILENM-SET-SEC
                   IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
                       MOVE    WRK-CONS-TERMID     TO
                                                   RECEDAT1PARA-TERMID
                   END-IF
                   MOVE    RECEDAT1PARA-BASENAME
                                               TO  SGETTEMP-BASENAME
               END-IF
               CALL    "ORCSGETTEMP"       USING   SGETTEMP-AREA
               MOVE    SGETTEMP-FULLNAME   TO  RECE01PARA
      *
               PERFORM 200-HENSYU-SEC
      *        
               IF      WRK-PARA-SHELLID    =   "RECEPTX"
                   MOVE    1                   TO  FLG-END
               END-IF
           END-PERFORM 
      *
           MOVE    1                   TO  FLG-END
           .
       200-MAIN-EXT.
           EXIT.
      * 
      *****************************************************************
      *    主処理
      *****************************************************************
       200-HENSYU-SEC                SECTION.
      *
           MOVE    ZERO                TO  FLG-RECE02
      *
           IF      IDZ             =   1               
      *    レセプト処理
               OPEN    OUTPUT              RECE04-FILE
               CLOSE                       RECE04-FILE
      *
               OPEN    OUTPUT              RECE05-FILE
               CLOSE                       RECE05-FILE
      *
               OPEN    OUTPUT              RECE04-FILE
               OPEN    I-O                 RECE05-FILE
           END-IF
      *
           OPEN    I-O                 RECE02-FILE
           IF      STS-RECE02          =   "00"
               CONTINUE
           ELSE
               MOVE    SPACE               TO  WRK-ERR-AREA
               INITIALIZE                      WRK-ERR-AREA
               MOVE    1                   TO  WRK-ERR-FLG
               MOVE    RECE01PARA          TO  WRK-ERR-FILE-NM
               MOVE    STS-RECE02          TO  WRK-ERR-FILE-STS
               PERFORM 500-FILE-ERR-ABORT-SEC
           END-IF
      *
           OPEN    INPUT               RECE09-FILE
           IF      STS-RECE09          =   "00"
               CONTINUE
           ELSE
               MOVE    SPACE               TO  WRK-ERR-AREA
               INITIALIZE                      WRK-ERR-AREA
               MOVE    1                   TO  WRK-ERR-FLG
               MOVE    RECE09PARA          TO  WRK-ERR-FILE-NM
               MOVE    STS-RECE09          TO  WRK-ERR-FILE-STS
               PERFORM 500-FILE-ERR-ABORT-SEC
           END-IF
      *
           PERFORM    RECE02-READ-SEC
      *
           PERFORM                     UNTIL   FLG-RECE02  =   1
                                       OR      FLG-END     =   1
               PERFORM     210-HENSYU-SEC
      *
               PERFORM     RECE02-READ-SEC
      *
               IF  CNT-IN-COMMIT       =   300
                   MOVE  ZERO              TO  CNT-IN-COMMIT
                   PERFORM 900-DBCOMMIT-SEC
                   PERFORM 900-DBSTART-SEC
               END-IF
      *
      *        処理中止設定処理
               IF      CNT-IN-CANCEL   =   50
                   MOVE    ZERO            TO  CNT-IN-CANCEL
                   PERFORM 500-CANCEL-HENSYU-SEC
               END-IF
           END-PERFORM
      *
           CLOSE   RECE02-FILE
           CLOSE   RECE09-FILE
      *
           IF      IDZ             =   1               
      *    レセプト処理
               CLOSE   RECE04-FILE
                       RECE05-FILE
           END-IF
           .
       200-HENSYU-EXT.
           EXIT.
      * 
      *****************************************************************
      *    編集処理
      *****************************************************************
       210-HENSYU-SEC                   SECTION.
      *
      *    地方公費データのとき不明分は処理の対象としない
           IF    ( IDZ                  =   2    )
           AND   ( RECE02-RECESYUBETU   =   ZERO )
               GO  TO  210-HENSYU-EXT
           END-IF
      *
           INITIALIZE                   WRK-AREA-SAIKEI
           INITIALIZE                   WRK-SYUNOU-GENBUTU-AREA
           INITIALIZE                   WRK-SKY-AREA
           INITIALIZE                   TBL-JNISSU                      
           INITIALIZE                   TBL-JNISSU2
           INITIALIZE                   TBL-JNISSU-GEN
           INITIALIZE                   TBL-JNISSU-MATOME
      *
           INITIALIZE                   FLG-KHNTEN-AREA
           INITIALIZE                   FLG-SAISIN-AREA
           INITIALIZE                   CNT-SAISIN-AREA
      *
           INITIALIZE                   TBL-FUKUSHI
           MOVE    88888880     TO      WRK-ZAINUM
      *
           INITIALIZE                   TBL-TOKUSYU-KEISAN
      *
           INITIALIZE                   RECE2G-REC
      *
           INITIALIZE                   TBL-HKNCOMBI2
      *
           MOVE    ZERO         TO      WRK-SURYOU-COUNT
      *
           MOVE      ZERO       TO      WRK-CHIHOU-KIN
           MOVE      ZERO       TO      WRK-CHIHOU-KIN2
           MOVE      ZERO       TO      WRK-CHIHOU-KIN4
           MOVE      ZERO       TO      WRK-CHIHOU-KIN5
           MOVE      ZERO       TO      WRK-CHIHOU-KIN6
           MOVE      ZERO       TO      WRK-CHIHOU-KIN7
           MOVE      ZERO       TO      WRK-CHIHOU-KIN8
           MOVE      ZERO       TO      WRK-CHK-ICHIBUGAKU
                                        WRK-CHK-ICHIBUGAKU2
                                        WRK-CHK-FTNGAKU
                                        WRK-CHK-KOHFTNGAKU
           MOVE      ZERO       TO      FLG-GENBUTU-TAISYOOK
           MOVE      ZERO       TO      FLG-GENBUTU70
           MOVE      ZERO       TO      FLG-GENBUTU70-KBN
           MOVE      ZERO       TO      FLG-KOUREI-GENEKIKBN
           MOVE      ZERO       TO      FLG-KOHYONKAIME
           MOVE      ZERO       TO      FLG-ZEROKOGAITO
           MOVE      ZERO       TO      FLG-NYUSYO
           MOVE      ZERO       TO      FLG-RJNGENMEN-CHIARI
           INITIALIZE                   WRK-TAIHI-GENKIN-TBL
           MOVE      ZERO       TO      FLG-ZENKI-TOKUREI
           MOVE      ZERO       TO      FLG-HOKENICHIBU
           MOVE      ZERO       TO      FLG-HOKENICHIBU-SYU
           MOVE      ZERO       TO      FLG-HOKENICHIBU2
           MOVE      ZERO       TO      FLG-HOKENICHIBU3
           MOVE      ZERO       TO      FLG-HOKENICHIBU5
           MOVE      ZERO       TO      FLG-HOKENICHIBU6
           MOVE      ZERO       TO      FLG-HOKENICHIBU7
           MOVE      ZERO       TO      FLG-ZENKOKUKOHI-NISYU
           MOVE      ZERO       TO      FLG-ZENKOKUKOHI-NISYU2
           MOVE      ZERO       TO      FLG-ZENKOKUKOHI-NISYU3
           MOVE      ZERO       TO      FLG-ZENKOKUKOHI-NISYU4
           MOVE      ZERO       TO      FLG-ZENKOKUKOHI-NISYU5
           MOVE      ZERO       TO      FLG-ZENKOKUKOHI-NISYU6
           MOVE      ZERO       TO      FLG-ZENKOKUKOHI-NISYU-SC
           MOVE      ZERO       TO      FLG-KEISAN-TOK1
                                        FLG-KEISAN-TOK2
           MOVE      ZERO       TO      WRK-KINGAKU-TOK1
                                        WRK-KINGAKU-TOK1X
                                        WRK-KINGAKU-TOK3
                                        WRK-KINGAKU-TOK4
                                        WRK-KINGAKU-TOK5
                                        WRK-KINGAKU-TOK7
                                        WRK-KINGAKU-TOK8
                                        WRK-KINGAKU-TOK9
           MOVE      ZERO       TO      FLG-XX8-TUUKA
                                        FLG-XX5-TUUKA
                                        FLG-XX3-TUUKA
                                        FLG-XX6-TUUKA
           MOVE      ZERO       TO      FLG-KOUGAKU
           MOVE      ZERO       TO      FLG-BUNBEN-SET
           MOVE      ZERO       TO      FLG-WRKFILE-CLEAR
           MOVE      ZERO       TO      FLG-SKY-TOKKOH
           MOVE      ZERO       TO      FLG-GENMEN-ARI
           MOVE      ZERO       TO      FLG-GENMEN-NASI
           MOVE      ZERO       TO      WRK-GENMEN-NASI-KIN
      *
           MOVE      ZERO       TO      FLG-KOKI-HIGAITO
           MOVE      ZERO       TO      FLG-CHIIKI2
      *
           MOVE      ZERO       TO      WRK-CYOKI-JGNGAK
           MOVE      ZERO       TO      WRK-CYOKI-KOH-FTN
           MOVE      ZERO       TO      WRK-CYOKI-KOH-FTN2
      *
           MOVE      ZERO       TO      FLG-JIRITU-CYUKANSOU1
           MOVE      ZERO       TO      FLG-JIRITU-CYUKANSOU2
           MOVE      ZERO       TO      WRK-JIRITU-SAIKEI
           MOVE      ZERO       TO      WRK-JIRITU-SAIKEI2
           MOVE      ZERO       TO      WRK-SAIKEI-TAIHI
      *
           INITIALIZE                   WRK-KOGAKU-TAISYOGAI-T
      *
           INITIALIZE                   WRK-KOHJGNGET-TAISYOKBN-T
      *
           INITIALIZE                   TBL-TOKATUKAI
      *
           INITIALIZE                   WRK-DAISAN-INGAI-TABLE
      *
           INITIALIZE                   TBL-ZAITAKU-KAISU-XXX
      *
           INITIALIZE                   TBL-CHIIKI-SANTEI
      *
           MOVE      ZERO       TO      WK-GENGAKUKBN
           MOVE      ZERO       TO      WK-GENGAKUKBN-KEISAN
           MOVE      ZERO       TO      WK-GENGAKU-KOHID
           MOVE      ZERO       TO      WK-GENGAKU-RITU
           MOVE      ZERO       TO      WK-GENGAKU-KIN
           MOVE      ZERO       TO      WK-GENGAKU-KIN2
           MOVE      ZERO       TO      WK-GENGAKU-KIN3
           MOVE      ZERO       TO      WK-GENGAKU-KTKBN
           MOVE      ZERO       TO      FLG-SAIGAI-TAISYO
      *
           MOVE      ZERO       TO      WK-GENGAKU-KEISAN2
           MOVE      ZERO       TO      WK-GENGAKU-KEISAN3
           MOVE      ZERO       TO      WK-GENGAKU-KEISAN9
           MOVE      ZERO       TO      FLG-GENGAKU5
      *
           MOVE      SPACE      TO      WRK-TOKUSITU-TOKKI
           MOVE      SPACE      TO      WRK-TOKUSITU-TOKKI2
      *
           MOVE      ZERO       TO      WRK-TAIHI-ZAINUM
           MOVE      ZERO       TO      WRK-TAIHI-OKIKAE
           MOVE      ZERO       TO      WRK-TAIHI-ZAINUM2
           MOVE      ZERO       TO      WRK-TAIHI-OKIKAE2
           MOVE      ZERO       TO      WRK-TAIHI-ZAINUM3
      *
           MOVE    123456789    TO      RECE02-SAIKEI-CHIKAN-KIN1
           MOVE    123456789    TO      RECE02-SAIKEI-CHIKAN-KIN2
           MOVE    123456789    TO      RECE02-SAIKEI-CHIKAN-KIN3
           MOVE    123456789    TO      RECE02-SAIKEI-CHIKAN-KIN4
           MOVE    123456789    TO      RECE02-HKN-CHIKAN-KIN
           MOVE    123456789    TO      RECE02-KOH-CHIKAN-KIN1
           MOVE    123456789    TO      RECE02-KOH-CHIKAN-KIN2
           MOVE    123456789    TO      RECE02-KOH-CHIKAN-KIN3
           MOVE    123456789    TO      RECE02-KOH-CHIKAN-KIN4
           MOVE    123456789    TO      RECE02-SEI-CHIKAN-KIN1
           MOVE    123456789    TO      RECE02-SEI-CHIKAN-KIN2
           MOVE    123456789    TO      RECE02-SEI-CHIKAN-KIN3
           MOVE    123456789    TO      RECE02-SEI-CHIKAN-KIN4
      *
           PERFORM     211J-SYUKEIKBN-HANBETU-SEC
      *
           PERFORM     211R-ETCKISAIFLGINF-HENSYU-SEC
           PERFORM     211Q-HOTEIGAI-HENSYU-SEC
      *
           IF    (RECE02-SRYYM   >=  "200804")
           AND   (RECE02-SRYYM   <=  "201903")
             IF  (RECE02-HKNNUM       =   SPACE                      )
             OR  (RECE02-HKNNUM(1:2)  =   "98" OR "90" OR "91"       )
             OR  (RECE02-HKNNUM  =   "068" OR "069" OR "040" OR "039")
             OR  (RECE02-AGE          <    70                        )
      ***    OR  (RECE02-AGE          >    74                        )
             OR  (RECE02-KOREIHIGAITO =     1                        )
               CONTINUE
             ELSE
               IF  (RECE02-HOJOKBN     =   "1"  OR  "9")
               AND (RECE02-BIRTHDAY    <    19440402   )
                  MOVE      1     TO    FLG-ZENKI-TOKUREI
               END-IF
             END-IF
           END-IF
      *
           MOVE      ZERO         TO    WRK-KOHCNT
           IF      RECE02-SRYYM   >=   "200804"
              PERFORM   VARYING  IDY2    FROM    1   BY   1
                         UNTIL   IDY2      >     4
                 IF   (RECE02-KOHNUM(IDY2)  NOT =  SPACE          )
                 AND  (RECE02-KOHNUM(IDY2)  NOT =  "972" AND "974")
                     ADD    1     TO    WRK-KOHCNT
                 END-IF
              END-PERFORM
      *
              IF   (RECE02-HKNCOMBI(2)   NOT =   ZERO)
              AND  (WRK-KOHCNT               >    1  )
                  MOVE     "1"    TO    RECE02-JSKISAIFLG
              END-IF
      *
              IF   (RECE02-JSKISAIFLG   =   "1" )
              AND  (RECE02-HKNCOMBI(3)  =   ZERO)
                 IF  (RECE02-HKNNUMHC(1)   NOT =  SPACE               )
                 AND (RECE02-HKNNUMHC(2)   NOT =  SPACE               )
                 AND (RECE02-KOHNUMHC(1 1)     =  RECE02-KOHNUMHC(2 1))
                 AND (RECE02-KOHIDHC (1 1)     =  RECE02-KOHIDHC (2 1))
                 AND (RECE02-KOHNUMHC(1 2)     =  RECE02-KOHNUMHC(2 2))
                 AND (RECE02-KOHIDHC (1 2)     =  RECE02-KOHIDHC (2 2))
                 AND (RECE02-KOHNUMHC(1 3)     =  RECE02-KOHNUMHC(2 3))
                 AND (RECE02-KOHIDHC (1 3)     =  RECE02-KOHIDHC (2 3))
                 AND (RECE02-KOHNUMHC(1 4)     =  RECE02-KOHNUMHC(2 4))
                 AND (RECE02-KOHIDHC (1 4)     =  RECE02-KOHIDHC (2 4))
                     MOVE  SPACE  TO    RECE02-JSKISAIFLG
                 END-IF
                 IF ((RECE02-HKNNUMHC(1)   NOT =  SPACE         ) AND
                     (RECE02-HKNNUMHC(2)   NOT =  SPACE         ) AND
                     (RECE02-KOHNUMHC(1 1)     =  SPACE OR "972"
                                                        OR "974") AND
                     (RECE02-KOHNUMHC(1 2)     =  SPACE         ) AND
                     (RECE02-KOHNUMHC(1 3)     =  SPACE         ) AND
                     (RECE02-KOHNUMHC(1 4)     =  SPACE         ))
                 OR ((RECE02-HKNNUMHC(1)   NOT =  SPACE         ) AND
                     (RECE02-HKNNUMHC(2)   NOT =  SPACE         ) AND
                     (RECE02-KOHNUMHC(2 1)     =  SPACE OR "972"
                                                        OR "974") AND
                     (RECE02-KOHNUMHC(2 2)     =  SPACE         ) AND
                     (RECE02-KOHNUMHC(2 3)     =  SPACE         ) AND
                     (RECE02-KOHNUMHC(2 4)     =  SPACE         ))
                     MOVE  SPACE  TO    RECE02-JSKISAIFLG
                 END-IF
              END-IF
           END-IF
      *
           IF    RECE02-SRYYM     >=  "201808"
           AND   RECE02-ZAITAKU    =  "1"
                PERFORM     2121-KOUREI-GENBUTU-HENSYU-SEC
           END-IF
      *
           PERFORM          211C-TOKUSITU-HANTEI-SEC
      *
           IF    RECE02-ZAITAKU    =  "1" OR "2"
             IF  RECE02-ZAITAKU    =  "1"
                PERFORM     2116-KOUREI-GENBUTU-HANTEI-SEC
             ELSE
                PERFORM     2118-GENBUTU70-HANTEI-SEC
             END-IF
           END-IF
      *
           PERFORM          211X-DAISAN-CHECK-SEC
           IF   RECE02-DAISAN-GAITO          =   1
           AND  RECE02-DAISAN-GENBUTU-GAITO  =  ZERO
             MOVE      SPACE    TO      RECE02-ZAITAKU
             MOVE      SPACE    TO      RECE02-KOUREI-HANTEIFLG
           END-IF
      *
           IF   RECE02-DAISAN-GAITO  =   1
             CONTINUE
           ELSE
             PERFORM        2117-GENGAKU-HANTEI-SEC
           END-IF
      *
           IF   (IDZ                       =     1   )
           AND  (RECE02-SRYYM             >= "201204")
             IF   (RECE02-HKNNUM       =   SPACE                  )
             OR   (RECE02-HKNNUM(1:2)  =   "98" OR "90" OR "91"   )
             OR   (RECE02-HKNNUM       =   "068" OR "069" OR "040")
             OR   ((RECE02-DAISAN-GAITO          =   1           ) AND
                   (RECE02-DAISAN-GENBUTU-GAITO  =  ZERO         ))
                CONTINUE
             ELSE
                PERFORM     211V-ZEROKOGAITO-CHECK-SEC
             END-IF
           END-IF
      *
           PERFORM          211W-NYUSYOCYU-CHECK-SEC
      *
           IF   RECE02-DAISAN-GAITO          =   1
           AND  RECE02-DAISAN-GENBUTU-GAITO  =  ZERO
             CONTINUE
           ELSE
             PERFORM        211B-TOKU75-HANTEI-SEC
           END-IF
      *
           PERFORM          2101-KOREISYA-KOHI-SEC
           PERFORM          211A-ZENKOKUKOHI-NISYU-CHK-SEC
           IF  ( RECE02-ZAITAKU    =    "1"  OR  "2"    )
           OR  ( FLG-TOKU75        =     1  OR  2  OR 3 )
             PERFORM        2102-KOREISYA-CHECK-SEC
           END-IF
      *
           PERFORM     2119-TOKUTEISIKKAN-CHECK-SEC
      *
           INITIALIZE                   TBL-HKNFTNDATA
           IF   RECE02-SRYYM    >=  "200804"
      *
             PERFORM   VARYING  IDY2    FROM    1   BY   1
                        UNTIL   IDY2      >     4
                IF  ( RECE02-KOHNUM(IDY2) =
                      "015" OR "016" OR "024" OR "079" OR
                      "038" OR "021" OR "051" OR "052" OR
                      "012" OR "025"                      )
                OR  ((RECE02-KOHNUM(IDY2) = "054"        ) AND
                     (RECE02-SRYYM       >= "201501"     ))
                OR  ( TBL-TOKATUKAIFLG(IDY2)  =  1        )
                OR  ( WRK-KOHJGNGET-TEKIYOFLG(IDY2) =  1  )
                     PERFORM  211E-JGNCHK-HENSYU-SEC
                END-IF
             END-PERFORM
      *
             IF ((RECE02-KOHNUM(1)  =
                  "015" OR "016" OR "024" OR "079" OR "038") AND
                 (TBL-HKNFTNDATA-JGN(1)  NOT =  ZERO       ))
             OR ((RECE02-KOHNUM(1)  =        "052" OR "054") AND
                 (TBL-HKNFTNDATA-JGN(1)  NOT =  ZERO       ) AND
                 (RECE02-SRYYM     >=        "201501"      ))
             OR ((RECE02-KOHNUM(2)  =
                  "015" OR "016" OR "024" OR "079" OR "038") AND
                 (TBL-HKNFTNDATA-JGN(2)  NOT =  ZERO       ))
             OR ((RECE02-KOHNUM(2)  =        "052" OR "054") AND
                 (TBL-HKNFTNDATA-JGN(2)  NOT =  ZERO       ) AND
                 (RECE02-SRYYM     >=        "201501"      ))
             OR ((RECE02-KOHNUM(3)  =
                  "015" OR "016" OR "024" OR "079" OR "038") AND
                 (TBL-HKNFTNDATA-JGN(3)  NOT =  ZERO       ))
             OR ((RECE02-KOHNUM(3)  =        "052" OR "054") AND
                 (TBL-HKNFTNDATA-JGN(3)  NOT =  ZERO       ) AND
                 (RECE02-SRYYM     >=        "201501"      ))
             OR ((RECE02-KOHNUM(4)  =
                  "015" OR "016" OR "024" OR "079" OR "038") AND
                 (TBL-HKNFTNDATA-JGN(4)  NOT =  ZERO       ))
             OR ((RECE02-KOHNUM(4)  =        "052" OR "054") AND
                 (TBL-HKNFTNDATA-JGN(4)  NOT =  ZERO       ) AND
                 (RECE02-SRYYM     >=        "201501"      ))
             OR ((SYS-1001-PREFNUM  =  23 OR 24            ) AND
                 (RECE02-KOHNUM(1)  = "152"                ) AND
                 (TBL-HKNFTNDATA-JGN(1)  NOT =  ZERO       ) AND
                 (RECE02-SRYYM     >= "201104"             ) AND
                 (RECE02-SRYYM     <= "201412"             ))
             OR ((SYS-1001-PREFNUM  =  23 OR 24            ) AND
                 (RECE02-KOHNUM(2)  = "152"                ) AND
                 (TBL-HKNFTNDATA-JGN(2)  NOT =  ZERO       ) AND
                 (RECE02-SRYYM     >= "201104"             ) AND
                 (RECE02-SRYYM     <= "201412"             ))
             OR ((SYS-1001-PREFNUM  =  23 OR 24            ) AND
                 (RECE02-KOHNUM(3)  = "152"                ) AND
                 (TBL-HKNFTNDATA-JGN(3)  NOT =  ZERO       ) AND
                 (RECE02-SRYYM     >= "201104"             ) AND
                 (RECE02-SRYYM     <= "201412"             ))
             OR ((SYS-1001-PREFNUM  =  23 OR 24            ) AND
                 (RECE02-KOHNUM(4)  = "152"                ) AND
                 (TBL-HKNFTNDATA-JGN(4)  NOT =  ZERO       ) AND
                 (RECE02-SRYYM     >= "201104"             ) AND
                 (RECE02-SRYYM     <= "201412"             ))
             OR ((WRK-KOHJGNGET-TEKIYOFLG(1) =  1          ) AND
                 (TBL-HKNFTNDATA-JGN(1)  NOT =  ZERO       ))
             OR ((WRK-KOHJGNGET-TEKIYOFLG(2) =  1          ) AND
                 (TBL-HKNFTNDATA-JGN(2)  NOT =  ZERO       ))
             OR ((WRK-KOHJGNGET-TEKIYOFLG(3) =  1          ) AND
                 (TBL-HKNFTNDATA-JGN(3)  NOT =  ZERO       ))
             OR ((WRK-KOHJGNGET-TEKIYOFLG(4) =  1          ) AND
                 (TBL-HKNFTNDATA-JGN(4)  NOT =  ZERO       ))
                     MOVE     1    TO  FLG-NYUIN-CHECK
                     PERFORM  211D-NYUIN-SYUNOU-HENSYU-SEC
             END-IF
      *
             PERFORM   VARYING  IDY2    FROM    1   BY   1
                        UNTIL   IDY2      >     4
                IF  TBL-HKNFTNDATA-JGN(IDY2)  NOT =  ZERO
                   IF  TBL-HKNFTNDATA-JGN(IDY2)   >
                               TBL-HKNFTNDATA-TAF(IDY2)
                       COMPUTE  TBL-HKNFTNDATA-ZAN(IDY2) =
                                TBL-HKNFTNDATA-JGN(IDY2) -
                                TBL-HKNFTNDATA-TAF(IDY2)
                   ELSE
                       MOVE  ZERO  TO  TBL-HKNFTNDATA-ZAN(IDY2)
                   END-IF
                   IF  TBL-HKNFTNDATA-ZAN(IDY2)   NOT =  ZERO
                     IF  TBL-HKNFTNDATA-ZAN(IDY2) >
                               TBL-HKNFTNDATA-NYUIN(IDY2)
                       COMPUTE  TBL-HKNFTNDATA-ZAN(IDY2) =
                                TBL-HKNFTNDATA-ZAN(IDY2) -
                                TBL-HKNFTNDATA-NYUIN(IDY2)
                     ELSE
                       MOVE  ZERO  TO  TBL-HKNFTNDATA-ZAN(IDY2)
                     END-IF
                     IF  TBL-HKNFTNDATA-ZAN(IDY2) NOT =  ZERO
                       PERFORM  211F-JGNCHK-HENSYU2-SEC
                       IF  TBL-HKNFTNDATA-ZAN(IDY2)  >
                               TBL-HKNFTNDATA-GAIRAI(IDY2)
                         COMPUTE  WRK-HKNFTNDATA-RUI          =
                                  TBL-HKNFTNDATA-TAF(IDY2)    +
                                  TBL-HKNFTNDATA-GAIRAI(IDY2) +
                                  TBL-HKNFTNDATA-NYUIN(IDY2)
                         IF   TBL-HKNFTNDATA-JGN(IDY2) =
                                              WRK-HKNFTNDATA-RUI
                           MOVE 1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                           MOVE ZERO TO  TBL-HKNFTNDATA-ZAN(IDY2)
                         ELSE
                           COMPUTE  TBL-HKNFTNDATA-ZAN(IDY2) =
                                    TBL-HKNFTNDATA-ZAN(IDY2) -
                                    TBL-HKNFTNDATA-GAIRAI(IDY2)
                         END-IF
                       ELSE
                         MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                         MOVE   ZERO TO  TBL-HKNFTNDATA-ZAN(IDY2)
                       END-IF
                     ELSE
                         MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                     END-IF
                   ELSE
                         MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                   END-IF
                   IF   TBL-HKNFTNDATA-FLG(IDY2) = 1
                     IF  ((RECE02-KOHNUM(IDY2)      =  "051"   ) AND
                          (TBL-DOTANDOKU-FLG(IDY2)  =   1      ))
                     OR  ((SYS-1001-PREFNUM         =   13     ) AND
                          (RECE02-KOHNUM(IDY2)      =  "151"   ) AND
                          (RECE02-SRYYM             <  "200905"))
                         MOVE   2    TO  TBL-HKNFTNDATA-FLG(IDY2)
                     END-IF
                   END-IF
                END-IF
             END-PERFORM
      *
      *      複数の公費登録が有る場合
             PERFORM   VARYING  IDY2    FROM    1   BY   1
                        UNTIL   IDY2      >     4
               IF  ( RECE02-KOHNUM(IDY2) =
                     "051" OR "038" OR "015" OR "016" OR
                     "021"                                )
               OR  ((RECE02-KOHNUM(IDY2) = "052"         ) AND
                    (RECE02-SRYYM       <= "201412"      ))
               OR  ((RECE02-KOHNUM(IDY2) = "054" OR "052") AND
                    (RECE02-SRYYM       >= "201501"      ))
                 IF   (TBL-HKNFTNDATA-JGN(IDY2)  NOT =  ZERO)
                 AND  (TBL-HKNFTNDATA-ZAN(IDY2)  NOT =  ZERO)
                 AND  (TBL-HKNFTNDATA-FLG(IDY2)      =  ZERO)
                 AND  (TBL-HKNFTNDATA-TEKFLG(IDY2)   =  ZERO)
                   MOVE   ZERO   TO  WRK-HKNFTNDATA-RUI
                   PERFORM   VARYING  IDY3    FROM    1   BY   1
                              UNTIL   IDY3      >     4
                     IF  (IDY2  NOT = IDY3                         )
                     AND (RECE02-KOHNUM(IDY2) = RECE02-KOHNUM(IDY3))
                     AND (TBL-HKNFTNDATA-TEKFLG(IDY3)  =  ZERO     )
                       ADD   TBL-HKNFTNDATA-GAIRAI(IDY3)  TO
                                               WRK-HKNFTNDATA-RUI
                       ADD   TBL-HKNFTNDATA-NYUIN (IDY3)  TO
                                               WRK-HKNFTNDATA-RUI
                     END-IF
                   END-PERFORM
      *
                   IF    TBL-HKNFTNDATA-ZAN(IDY2) <= WRK-HKNFTNDATA-RUI
                        MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                   ELSE
                    IF  ( RECE02-KOHNUM(IDY2) =
                                       "038" OR "015" OR "016" )
                    OR  ((RECE02-KOHNUM(IDY2) = "054" OR "052") AND
                         (RECE02-SRYYM       >= "201501"      ))
                      PERFORM  211Z-CYOFUKU-KOH-HENSYU-SEC
                      IF TBL-HKNFTNDATA-ZAN(IDY2) <= WRK-HKNFTNDATA-RUI
                        MOVE   1    TO  TBL-HKNFTNDATA-FLG(IDY2)
                      END-IF
                    END-IF
                   END-IF
                 END-IF
               END-IF
             END-PERFORM
      *
             PERFORM   VARYING  IDY2    FROM    1   BY   1
                        UNTIL   IDY2      >     4
                IF  TBL-HKNFTNDATA-JGN(IDY2)  NOT =  ZERO
                   DISPLAY "IDX KOHNUM=" IDY2
                           " "    RECE02-KOHNUM(IDY2)
                   DISPLAY "JGN=" TBL-HKNFTNDATA-JGN(IDY2)
                   DISPLAY "FLG=" TBL-HKNFTNDATA-FLG(IDY2)
                END-IF
             END-PERFORM
      *
           END-IF
      *
           MOVE      ZERO       TO   FLG-KOHSKY-ARI
           INITIALIZE                WRK-KOHSKY-XXX-TABLE
           INITIALIZE                WRK-KOHSKY-GAIKFTNRATE-TABLE
           IF   (IDZ                       =     1   )
           AND  (RECE02-SRYYM             >= "201704")
             PERFORM  VARYING  IDX36  FROM  1  BY  1
                       UNTIL   IDX36    >   4
               IF   (RECE02-KOHSKY-KOHNUM(IDX36) NOT = SPACE)
               AND  (RECE02-KOHSKY-KOHNUM(IDX36)
                                      NOT = RECE02-KOHNUM(1))
               AND  (RECE02-KOHSKY-KOHNUM(IDX36)
                                      NOT = RECE02-KOHNUM(2))
               AND  (RECE02-KOHSKY-KOHNUM(IDX36)
                                      NOT = RECE02-KOHNUM(3))
               AND  (RECE02-KOHSKY-KOHNUM(IDX36)
                                      NOT = RECE02-KOHNUM(4))
                 MOVE     1     TO   FLG-KOHSKY-ARI
      *
                 INITIALIZE                     HKNNUM-REC
                 MOVE    RECE02-HOSPNUM     TO  HKN-HOSPNUM
                 MOVE    RECE02-KOHSKY-KOHNUM(IDX36)
                                            TO  HKN-HKNNUM
                 MOVE    RECE02-SRYYM       TO  HKN-TEKSTYMD(1:6)
                                                HKN-TEKEDYMD(1:6)
                 MOVE    "01"               TO  HKN-TEKSTYMD(7:2)
                                                HKN-TEKEDYMD(7:2)
                 MOVE    "00"               TO  HKN-PAYKBN
                 MOVE    HKNNUM-REC         TO  MCPDATA-REC
                 MOVE    "tbl_hknnum"       TO  MCP-TABLE
                 MOVE    "key"              TO  MCP-PATHNAME
                 PERFORM   900-DBSELECT-SEC
                 IF     MCP-RC   =   ZERO
                   MOVE  "tbl_hknnum"       TO  MCP-TABLE
                   MOVE  "key"              TO  MCP-PATHNAME
                   PERFORM 900-DBFETCH-SEC
                   IF   MCP-RC   =   ZERO
                     MOVE  MCPDATA-REC      TO  HKNNUM-REC
                     MOVE  HKN-HON-GAIKFTNRATE
                              TO  WRK-KOHSKY-GAIKFTNRATE(IDX36)
                   END-IF
                 END-IF
                 MOVE    "tbl_hknnum"       TO  MCP-TABLE
                 MOVE    "key"              TO  MCP-PATHNAME
                 PERFORM   900-CLOSE-SEC
               END-IF
             END-PERFORM
           END-IF
      *
           IF  (RECE02-SRYYM     >=    "201204")
           AND (RECE02-ZAITAKU    =    "2"     )
               PERFORM    211S-GENBUTU70-GASSAN-CHK-SEC
           END-IF
           MOVE      ZERO       TO   FLG-CYOKI-CHECK
           MOVE      ZERO       TO   WRK-CYOKI-TOTAL-HKNKIN
           MOVE      ZERO       TO   WRK-CYOKI-TOTAL-HKNTEN
           MOVE      ZERO       TO   WRK-CYOKI-TOTAL-HKNTEN2
           MOVE      ZERO       TO   CNT-CYOKI-HENSYU1
           MOVE      ZERO       TO   CNT-CYOKI-HENSYU2
           MOVE      ZERO       TO   FLG-CYOKI-HENSYU
           MOVE      ZERO       TO   FLG-CYOKI-HENSYU2
           MOVE      ZERO       TO   FLG-CYOKI-HENSYU3
           MOVE      ZERO       TO   FLG-CYOKI-HENSYU4
           INITIALIZE                WRK-SYUNOU-CYOKI-AREA
           IF  (RECE02-SRYYM          >=  "200804")
           AND (RECE02-ZAITAKU         =  "1"     )
           AND (RECE02-TEISYOTOKU  NOT =   SPACE  )
           AND (IDZ                    =   1      )
               PERFORM    211T-CYOKI-CHECK-SEC
           END-IF
           IF  (RECE02-SRYYM        >=  "201204"  )
           AND (RECE02-ZAITAKU       =  "1" OR "2")
           AND (IDZ                  =   1        )
               PERFORM    211TX-CYOKI-CHECK2-SEC
           END-IF
           IF   FLG-CYOKI-HENSYU4    =  ZERO
               MOVE  SPACE  TO  RECE02-CYOKI-KSIKBN
           END-IF
      *
      *    保険組み合わせの公費チェック（生保まとめ）
           IF  (RECE02-SRYYM        >=  "200804")
           AND (RECE02-SEIHOFLG      =  "1"     )
              PERFORM  210B-SEIHO-HKNCOMBI-CHECK-SEC
           END-IF
      *
           PERFORM    VARYING    IDX    FROM   1   BY   1
                      UNTIL     (IDX      >   20)  OR
                                (RECE02-SRYKA(IDX)   =   SPACE)
               PERFORM    2104-RECE04-HENSYU-SEC
               PERFORM    2105-YKZFTN-SET-SEC
           END-PERFORM
           PERFORM     2120-GENMEN-TEK-CHECK-SEC
           PERFORM     211M-WRKFILE-CLEAR-SEC
           PERFORM     211H-GENTEN-HENSYU-SEC
           PERFORM     2106-JNISSU-SET-SEC                                   
           PERFORM     2107-KHNTEN-CLEAR-SEC
           PERFORM     2109-SAIKEI-KEISAN-SEC
           PERFORM     2110-NYUYOJI-COMENTFLG-SET-SEC
           PERFORM     2111-ICHIBUFUTAN-OKIKAE-SEC
      *
           IF    RECE02-SRYYM   >=  "200804"
             PERFORM   211K-BUNTENSU-HENSYU-SEC
           ELSE
             PERFORM   2108-BUNTENSU-CLEAR-SEC
           END-IF
           IF    RECE02-FUKUSHIFLG(3)  =  "2"
               MOVE   SPACE   TO   RECE02-FUKUSHIFLG(3)
           END-IF
           IF    RECE02-FUKUSHIFLG(4)  =  "2"
               MOVE   SPACE   TO   RECE02-FUKUSHIFLG(4)
           END-IF
           IF    RECE02-FUKUSHIFLG(5)  =  "2"
               MOVE   SPACE   TO   RECE02-FUKUSHIFLG(5)
           END-IF
      *
      *    レセプト請求区分による公費情報の振り分け処理
           MOVE    ZERO            TO  FLG-RECESKYKBN
           PERFORM VARYING IDX     FROM    1   BY  1
                   UNTIL   IDX     >       4
                   OR      FLG-RECESKYKBN  =   1 
               IF    ( RECE02-KOHNUM     (IDX) NOT =   SPACE )
               AND   ( RECE02-RECESKYKBN (IDX) NOT =   SPACE )
                   MOVE    1                TO  FLG-RECESKYKBN
               END-IF
           END-PERFORM
           IF     FLG-RECESKYKBN        =   1
               PERFORM 2112-RECESKYKBN-HENSYU-SEC
           END-IF
      *
      *    第２〜第４公費の情報編集
      *    （レセプト請求区分による公費情報の振り分け処理後に編集）
           IF   RECE02-ZAITAKU      =  "1" OR "2"
             IF      FLG-ZENKOKUKOHI-NISYU =  1 OR 2 OR 3 OR 4 OR
                                              5 OR 8 OR 9
               EVALUATE  RECE02-EKF-SAIKEIKSI(3)
                 WHEN      "1"
                   IF      FLG-ZENKOKUKOHI-NISYU6 = ZERO
                     MOVE   999999999    TO  RECE02-ZAITAKU-SAIKEI2
                     MOVE   ZERO         TO  RECE02-SAIKEIZEROKSI2
                   END-IF
                 WHEN      "2"
                 WHEN      "3"
                   MOVE     999999999    TO  RECE02-ZAITAKU-SAIKEI2
                   MOVE     ZERO         TO  RECE02-SAIKEIZEROKSI2
                   IF  (RECE02-TOTALTEN(1) = RECE02-TOTALTEN(2)   )
                   AND (RECE02-FTNMONEY(1) = RECE02-ZAITAKU-SAIKEI)
                     MOVE   ZERO         TO  RECE02-ZAITAKU-SAIKEI
                     MOVE   ZERO         TO  RECE02-SAIKEIZEROKSI1
                   END-IF
               END-EVALUATE
             END-IF
           END-IF
      *
           IF      IDZ                  =   1
               IF ( ( RECE02-TEISYUTUSAKI   =   1               )  AND
                    ( SYS-2005-SYAOCRKBN    =   ZERO    OR  "2" )      )
               OR ( ( RECE02-TEISYUTUSAKI   =   2               )  AND
                    ( SYS-2005-KKHOCRKBN    =   "1"     OR  "3" )      )
               OR ( ( RECE02-TEISYUTUSAKI   =   6               )  AND
                    ( SYS-200501-KOUIKIOCRKBN
                                            =   "1"     OR  "3" )      )
      *
      *            医療保険・公費のフラグ
                   MOVE    SPACE              TO  WRK-3SYU-KBN
                   MOVE    ZERO               TO  SEIHIDX
                   MOVE    ZERO               TO  KAKKIDX
                   MOVE    ZERO               TO  SESNIDX
                   PERFORM   VARYING   IDX  FROM    1   BY  1
                         UNTIL   ( IDX                >    4    )
                         OR      ( RECE02-KOHID(IDX)  =   SPACE )
      *                生保
                       IF  RECE02-KOHNUM (IDX)  =   "012"
                           MOVE    "1"          TO  WRK-3SYU (1:1)
                           MOVE     IDX         TO  SEIHIDX
                       END-IF
      *                結核
                       IF  RECE02-KOHNUM (IDX)  =   "010"  OR  "011"
                           MOVE    "1"          TO  WRK-3SYU (2:1)
                           MOVE     IDX         TO  KAKKIDX
                       END-IF
      *
                       IF      RECE02-SRYYM <   WRK-CONS-SRYYM-200604
      *                    精神
                           IF  RECE02-KOHNUM (IDX)  =   "020"  OR  "021"
                               MOVE    "1"          TO  WRK-3SYU (3:1)
                               MOVE     IDX         TO  SESNIDX
                           END-IF
                       ELSE
      *                    自立支援法
                           IF  RECE02-KOHNUM (IDX)  =   "021"  OR  "015"
                                                    OR  "016"  OR  "024"
                               MOVE    "1"          TO  WRK-3SYU (3:1)
                               MOVE     IDX         TO  SESNIDX
                           END-IF
                       END-IF
                   END-PERFORM
      *    
                   IF      WRK-3SYU-KBN           =   ALL "1" AND 
                           RECE02-HKNNUM          =   SPACE            
      *                ３種の場合
                       IF  KAKKIDX         >   SESNIDX
                           MOVE    SESNIDX     TO  IDA
                           MOVE    KAKKIDX     TO  IDB
                       ELSE
                           MOVE    KAKKIDX     TO  IDA
                           MOVE    SESNIDX     TO  IDB
                       END-IF
                       COMPUTE IDX5     =   SEIHIDX    +   1
                       COMPUTE IDX6     =   IDA        +   1
                       COMPUTE IDX7     =   IDB        +   1
                   ELSE    
      *                ３種以外の場合
                       MOVE    1               TO  IDA
                       MOVE    2               TO  IDB
                       MOVE    1               TO  IDX5
                       MOVE    2               TO  IDX6
                       MOVE    3               TO  IDX7
                   END-IF
      *
                   PERFORM     2113-OCR1-HENSYU-SEC
                   PERFORM     2114-OCR2-HENSYU-SEC
                   PERFORM     2115-OCR3-HENSYU-SEC
               END-IF
           END-IF
      *
      *    新潟県中越沖地震対応 
      *    岩手・宮城内陸地震対応 
      *    中国・九州北部豪雨対応
      *    平成２１年台風第９号対応
      *    平成２２年７月中国地方豪雨対応
      *    鹿児島県奄美市等における局地的大雨対応
      *
           IF   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "15"         ) AND
                 ( RECE02-SRYYM       >=   200709       ) AND
                 ( RECE02-SRYYM       <=   200712       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "03" OR "04" ) AND
                 ( RECE02-SRYYM       >=   200806       ) AND
                 ( RECE02-SRYYM       <=   200812       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "35" OR "40" ) AND
                 ( RECE02-SRYYM       >=   200907       ) AND
                 ( RECE02-SRYYM       <=   200912       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "28" OR "33" ) AND
                 ( RECE02-SRYYM       >=   200908       ) AND
                 ( RECE02-SRYYM       <=   201001       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "34" OR "35" ) AND
                 ( RECE02-SRYYM       >=   201007       ) AND
                 ( RECE02-SRYYM       <=   201012       ))
           OR   (( IDZ                 =   1            ) AND
                 ( SYS-1001-PREFNUM    =   "46"         ) AND
                 ( RECE02-SRYYM       >=   201010       ) AND
                 ( RECE02-SRYYM       <=   201103       ))
           OR   (( IDZ                 =   1            ) AND
                 ( RECE02-SRYYM       >=   201101       ))
               IF    ( RECE02-HKNNUM   NOT =   SPACE )
               AND   ( RECE02-HKNJANUM     =   SPACE )
                   IF  RECE02-SRYYM   >=  "201101"
                       MOVE    6           TO  RECE02-RJNGAIKOHFTN (1)
      *                保険者不明＋減免対象者のとき
                       IF    RECE02-GENMENKBN   >  ZERO
                           MOVE    7       TO  RECE02-RJNGAIKOHFTN (1)
                       END-IF
                   ELSE
                       MOVE    3           TO  RECE02-RJNGAIKOHFTN (1)
                   END-IF
               ELSE
                   IF    ( RECE02-RJNHKNNUM
                                           NOT =   SPACE )
                   AND   ( RECE02-RJNFTNJANUM  =   SPACE )
                       MOVE    3           TO  RECE02-RJNGAIKOHFTN (1)
                   ELSE
      *                記号・番号が不明のとき
                       IF       RECE02-HKNNUM   NOT =   SPACE
                         IF    (RECE02-KIGO         =   SPACE)
                         AND   (RECE02-NUM          =   SPACE)
                           MOVE    1       TO  RECE02-RJNGAIKOHFTN (1)
                         ELSE
                           IF  (RECE02-KIGO     NOT =   SPACE)
                           AND (RECE02-NUM          =   SPACE)
                             MOVE  1       TO  RECE02-RJNGAIKOHFTN (1)
                           END-IF
                         END-IF
                       END-IF   
      *                老人保健の受給者番号が不明のとき
                       IF    ( RECE02-RJNHKNNUM
                                               NOT =   SPACE )
                       AND   ( RECE02-RJNJKYSNUM   =   SPACE )
                           MOVE    1       TO  RECE02-RJNGAIKOHFTN (1)
                       END-IF
      *                公費負担者番号又は受給者番号が不明のとき
                       IF  (RECE02-SRYYM          >= "201101")
                       AND (RECE02-RJNGAIKOHFTN(1) =  ZERO   )
                       AND (RECE02-HKNNUM          =  SPACE  )
                         PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                                   UNTIL   IDX-SAI    >    4
                           IF  (RECE02-KOHNUM(IDX-SAI) NOT =  SPACE)
                           AND (RECE02-KOHNUM(IDX-SAI) NOT = 
                                                    "972" AND "974")
                             IF  RECE02-KOHFTNJANUM(IDX-SAI) = SPACE
                               MOVE    6   TO  RECE02-RJNGAIKOHFTN (1)
                               MOVE    4   TO  IDX-SAI
                             ELSE
                              IF RECE02-KOHJKYSNUM (IDX-SAI) = SPACE
                               MOVE    1   TO  RECE02-RJNGAIKOHFTN (1)
                              END-IF
                             END-IF
                           END-IF
                         END-PERFORM
                       END-IF
      *                記号番号不明＋減免対象者のとき
      *                公費受給者番号不明＋減免対象者のとき
                       IF  (RECE02-RJNGAIKOHFTN(1) =   1  )
                       AND (RECE02-GENMENKBN       >  ZERO)
                         IF   RECE02-SRYYM    >= "201101"
                           MOVE    5       TO  RECE02-RJNGAIKOHFTN (1)
                         END-IF
                       END-IF
      *                公費負担者番号不明＋減免対象者のとき
                       IF  (RECE02-RJNGAIKOHFTN(1) =   6  )
                       AND (RECE02-GENMENKBN       >  ZERO)
                         IF   RECE02-SRYYM    >= "201101"
                           MOVE    7       TO  RECE02-RJNGAIKOHFTN (1)
                         END-IF
                       END-IF
      *                減免対象者のとき
                       IF  (RECE02-RJNGAIKOHFTN(1) =  ZERO)
                       AND (RECE02-GENMENKBN       >  ZERO)
                         IF  (RECE02-SRYYM    >= "201101")
                         AND (FLG-GENMEN-ARI   =  1      )
                         AND (FLG-GENMEN-NASI  =  1      )
                           MOVE    4       TO  RECE02-RJNGAIKOHFTN (1)
                           MOVE  WRK-GENMEN-NASI-KIN
                                           TO  RECE02-GENMEN-NASI-KIN
                           IF   (FLG-SAIGAI-TAISYO  =   1       )
                           AND  (RECE02-GENMENKBN   =   2  OR  3)
                             IF  RECE02-ZAITAKU     =  "1" OR "2"
                               MOVE   WRK-GENMEN-NASI-KIN
                                           TO  RECE02-FTNMONEY(1)
                             END-IF
                           END-IF
                         ELSE
                           MOVE    2       TO  RECE02-RJNGAIKOHFTN (1)
                         END-IF
                       END-IF
                   END-IF
               END-IF
      *
               IF   RECE02-SRYYM   >=  "201007"
                   IF  (RECE02-SRYYM          >= "201101"         )
                   AND (RECE02-HKNNUM          =  SPACE           )
                   AND (FLG-SAIGAI-TAISYO      =   1              )
                   AND (RECE02-RJNGAIKOHFTN(1) =  2 OR 4 OR 5 OR 7)
      *              上限額確認
                     MOVE     ZERO      TO    FLG-SAIGAI-JGN-ETC
                     PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                               UNTIL   IDX-SAI    >    4
                       IF  (RECE02-KOHNUM(IDX-SAI) NOT =  SPACE)
                       AND (RECE02-KOHNUM(IDX-SAI) NOT = 
                                                "972" AND "974")
                         IF  RECE02-KOHNUM(IDX-SAI)  =  "010"
                            MOVE   1    TO    FLG-SAIGAI-JGN-ETC
                         END-IF
                         IF ( RECE02-KOHNUM(IDX-SAI)  =
                              "012" OR "015" OR "016" OR "021" OR
                              "024" OR "025" OR "038" OR "051" OR
                              "052" OR "079"                      )
                         OR ((RECE02-KOHNUM(IDX-SAI)  = "054"    ) AND
                             (RECE02-SRYYM           >= "201501" ))
                            PERFORM   211P-SAIGAI-JGN-CHECK-SEC
                         END-IF
                       END-IF
                     END-PERFORM
                     IF  FLG-SAIGAI-JGN-ETC = ZERO
                       EVALUATE  RECE02-RJNGAIKOHFTN(1)
                         WHEN      2
                         WHEN      4
                           MOVE  ZERO  TO  RECE02-RJNGAIKOHFTN(1)
                         WHEN      5
                           MOVE   1    TO  RECE02-RJNGAIKOHFTN(1)
                         WHEN      7
                           MOVE   6    TO  RECE02-RJNGAIKOHFTN(1)
                       END-EVALUATE
                       MOVE    ZERO    TO  RECE02-GENMEN-NASI-KIN
                       MOVE    ZERO    TO  RECE02-GENMENKBN
                     END-IF
                   END-IF
                   IF   FLG-SAIGAI-TAISYO   =   1
                     IF  (RECE02-SRYYM          >= "201101")
                     AND (RECE02-RJNGAIKOHFTN(1) =  ZERO   )
                       MOVE    3     TO   RECE02-RJNGAIKOHFTN (1)
                     END-IF
                     IF  (RECE02-HKNNUM      NOT =  SPACE  )
                     AND (RECE02-SRYYM          >= "201101")
                       EVALUATE  RECE02-RJNGAIKOHFTN(1)
                         WHEN       1
                           PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                                     UNTIL   IDX-SAI    >    4
                             IF  (RECE02-KOHNUM(IDX-SAI) NOT =  SPACE)
                             AND (RECE02-KOHNUM(IDX-SAI) NOT = 
                                                      "972" AND "974")
                               IF  RECE02-KOHFTNJANUM(IDX-SAI) = SPACE
                                 MOVE   11   TO  RECE02-RJNGAIKOHFTN(1)
                                 MOVE    4   TO  IDX-SAI
                               ELSE
                                IF RECE02-KOHJKYSNUM (IDX-SAI) = SPACE
                                 MOVE    1   TO  RECE02-RJNGAIKOHFTN(1)
                                END-IF
                               END-IF
                             END-IF
                           END-PERFORM
                         WHEN       3
                           PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                                     UNTIL   IDX-SAI    >    4
                             IF  (RECE02-KOHNUM(IDX-SAI) NOT =  SPACE)
                             AND (RECE02-KOHNUM(IDX-SAI) NOT = 
                                                      "972" AND "974")
                               IF  RECE02-KOHFTNJANUM(IDX-SAI) = SPACE
                                 MOVE    9   TO  RECE02-RJNGAIKOHFTN(1)
                                 MOVE    4   TO  IDX-SAI
                               ELSE
                                IF RECE02-KOHJKYSNUM (IDX-SAI) = SPACE
                                 MOVE   10   TO  RECE02-RJNGAIKOHFTN(1)
                                END-IF
                               END-IF
                             END-IF
                           END-PERFORM
                         WHEN       6
                           PERFORM  VARYING  IDX-SAI  FROM   1   BY   1
                                     UNTIL   IDX-SAI    >    4
                             IF  (RECE02-KOHNUM(IDX-SAI) NOT =  SPACE)
                             AND (RECE02-KOHNUM(IDX-SAI) NOT = 
                                                      "972" AND "974")
                               IF  RECE02-KOHFTNJANUM(IDX-SAI) = SPACE
                                 MOVE    6   TO  RECE02-RJNGAIKOHFTN(1)
                                 MOVE    4   TO  IDX-SAI
                               ELSE
                                IF RECE02-KOHJKYSNUM (IDX-SAI) = SPACE
                                 MOVE    8   TO  RECE02-RJNGAIKOHFTN(1)
                                END-IF
                               END-IF
                             END-IF
                           END-PERFORM
                       END-EVALUATE
                     END-IF
                     IF  (RECE02-SRYYM          >= "201101")
                       EVALUATE  RECE02-RJNGAIKOHFTN(1)
                         WHEN       2
                         WHEN       5
                         WHEN       7
                            MOVE    96   TO      FLG-TOKKI
                            PERFORM   21045-TOKKI-HENSYU-SEC
                         WHEN       4
                            MOVE    97   TO      FLG-TOKKI
                            PERFORM   21045-TOKKI-HENSYU-SEC
                       END-EVALUATE
                     END-IF
                     IF  (RECE02-SRYYM        >= "201101")
                     AND (RECE02-HKNNUM    NOT =  SPACE  )
                     AND (RECE02-HKNJANUM  NOT =  SPACE  )
                     AND (RECE02-KIGO      NOT =  SPACE  )
                     AND (RECE02-NUM           =  SPACE  )
                     AND (RECE02-RJNGAIKOHFTN(1) =  5    )
                       MOVE  SPACE   TO   RECE02-KIGO
                       MOVE  "0000000000"
                                     TO   RECE02-OCR2(6:10)
                       MOVE  "0"     TO   RECE02-OCR2(26:1)
                     END-IF
                   ELSE
                     MOVE    ZERO    TO   RECE02-RJNGAIKOHFTN (1)
                     MOVE    ZERO    TO   RECE02-GENMEN-NASI-KIN
                   END-IF
               END-IF
           END-IF
      *
           IF   FLG-ZENKI-TOKUREI  =   1
              MOVE      1     TO     RECE02-RJNGAIKOHFTN(2)
           END-IF
      *
           PERFORM     211G-PTTOKKI-HENSYU-SEC
      *
      *    請求額情報編集
           PERFORM     211N-SKY-HENSYU-SEC
      *
      *    再掲・一部負担金置き換え編集
           PERFORM     211U-ICHIBUFUTAN-OKIKAE2-SEC
      *
      *    減額（円）置き換え編集
           IF   WK-GENGAKUKBN   =   2
             IF   RECE02-ZAITAKU  =  "1" OR "2"
               MOVE      ZERO              TO  RECE02-GENGAKU
             ELSE
               IF  RECE02-GENGAKU > WK-GENGAKU-KEISAN2
                 MOVE  WK-GENGAKU-KEISAN2  TO  RECE02-GENGAKU
               END-IF
             END-IF
           END-IF
      *    減額（円超）置き換え編集
           IF   WK-GENGAKUKBN   =   5
             IF   RECE02-ZAITAKU  =  "1" OR "2"
               MOVE      ZERO              TO  RECE02-GENGAKU
             ELSE
               IF  RECE02-GENGAKU < WK-GENGAKU-KEISAN3
      *          減額金額を計算
      **>        COMPUTE WK-GENGAKU-KEISAN1  = WK-GENGAKU-KEISAN3
      **>                                    - RECE02-GENGAKU
      **>        MOVE  WK-GENGAKU-KEISAN1  TO  RECE02-GENGAKU
      **>        IF  RECE02-GENGAKU > WK-GENGAKU-KEISAN2
      **>          MOVE  WK-GENGAKU-KEISAN2  TO  RECE02-GENGAKU
      **>        END-IF
      *
                 IF  RECE02-GENGAKU >= WK-GENGAKU-KEISAN2
                   COMPUTE WK-GENGAKU-KEISAN1  = WK-GENGAKU-KEISAN3
                                               - RECE02-GENGAKU
                 ELSE
                   COMPUTE WK-GENGAKU-KEISAN1  = WK-GENGAKU-KEISAN2
                                               - RECE02-GENGAKU
                 END-IF
                 MOVE    WK-GENGAKU-KEISAN1  TO  RECE02-GENGAKU
               END-IF
             END-IF
           END-IF
      *
      *    請求点数がない保険組み合わせ有りフラグ編集
           IF   RECE02-HKNCOMBI(2)   NOT =   ZERO
             PERFORM  VARYING  IDX18  FROM  1  BY  1
                       UNTIL  (IDX18                   >  10  )
                         OR   (RECE02-HKNCOMBI(IDX18)  =  ZERO)
               IF    (TBL-HKNCOMBI-SKYTENFLG (IDX18) = ZERO)
               AND   (TBL-HKNCOMBI-SKYTENFLG2(IDX18) =  1  )
                   MOVE    1    TO   RECE02-SKYTENFLG
               END-IF
             END-PERFORM
           END-IF
      *
      *    第三者行為の一部負担金編集
           IF   RECE02-DAISAN-GAITO   =   1  OR  2
      *
              IF    RECE02-DAISAN-CHIKAN   =   1
                COMPUTE  WRK-DAISAN-FTNMONEY3    =
                         RECE02-DAISAN-TOTALTEN  *
                         10
                IF  WRK-DAISAN-FTNMONEY3 < RECE02-DAISAN-FTNMONEY
                  MOVE   WRK-DAISAN-FTNMONEY3   TO
                                           RECE02-DAISAN-FTNMONEY
                END-IF
              END-IF
      *
              IF    RECE02-DAISAN-TOKKI    =   ZERO
                MOVE     13     TO     FLG-TOKKI
                PERFORM  21045-TOKKI-HENSYU-SEC
              END-IF
      *
              EVALUATE  RECE02-DAISAN-GENBUTU-GAITO
                WHEN      ZERO
                  IF    RECE02-DAISAN-CHIKAN  =   ZERO
                    IF   WRK-DAISAN-DAISANKBN  =  "1"
                       PERFORM  211X2-DAISAN-CHECK3-SEC
                       MOVE     WRK-DAISAN-FTNMONEY     TO
                                           RECE02-DAISAN-FTNMONEY
                    ELSE
                       COMPUTE  RECE02-DAISAN-FTNMONEY  =
                                RECE02-DAISAN-TOTALTEN  *
                                10                      *
                                RECE02-KYURATE          /
                                100
                    END-IF
                  END-IF
                  IF  RECE02-ZAITAKU      =  "1" OR "2"
                    ADD  RECE02-DAISAN-FTNMONEY
                                         TO  RECE02-FTNMONEY(1)
                  END-IF
                WHEN       1
                  IF    RECE02-DAISAN-CHIKAN  =   ZERO
                    PERFORM     211X3-DAISAN-CHECK4-SEC
                    MOVE        WRK-DAISAN-FTNMONEY     TO
                                           RECE02-DAISAN-FTNMONEY
                  END-IF
                  IF RECE02-SKYIRYO-ICHIBUFTN >= RECE02-DAISAN-FTNMONEY
                    COMPUTE  RECE02-SKYIRYO-ICHIBUFTN  =
                             RECE02-SKYIRYO-ICHIBUFTN  -
                             RECE02-DAISAN-FTNMONEY
                  ELSE
                    DISPLAY  "??? RECE02-DAISAN-FTNMONEY="
                              RECE02-DAISAN-FTNMONEY
                    DISPLAY  "??? RECE02-SKYIRYO-ICHIBUFTN="
                              RECE02-SKYIRYO-ICHIBUFTN
      *???          MOVE     RECE02-SKYIRYO-ICHIBUFTN
      *???                          TO  RECE02-DAISAN-FTNMONEY
      *???          MOVE     ZERO   TO  RECE02-SKYIRYO-ICHIBUFTN
                  END-IF
              END-EVALUATE
           END-IF
      *
      *    第三者行為の院外処方の有無チェック
           PERFORM     211X1-DAISAN-CHECK2-SEC
      *
      *    在宅回数の再編集
           PERFORM     211Y-ZAITAKU-KAISU-HENSYU-SEC
      *
      *    特記事項０９施有りフラグ編集
           PERFORM     210A-TOKKI09FLG-HENSYU-SEC
      *
           PERFORM     RECE02-REWRITE-SEC
           .
       210-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組み合わせの公費チェック（生保まとめ）
      *****************************************************************
       210B-SEIHO-HKNCOMBI-CHECK-SEC               SECTION.
      *
           IF    IDZ  =  1
             PERFORM  VARYING  IDX32  FROM  1  BY  1
                       UNTIL  (IDX32                  >   10 )
                        OR    (RECE02-HKNCOMBI(IDX32) =  ZERO)
               IF   (RECE02-HKNNUMHC(IDX32)   NOT =   SPACE)
               AND  (RECE02-KOHNUMHC(IDX32 1)     =   SPACE)
               AND  (RECE02-KOHNUMHC(IDX32 2)     =   SPACE)
               AND  (RECE02-KOHNUMHC(IDX32 3)     =   SPACE)
               AND  (RECE02-KOHNUMHC(IDX32 4)     =   SPACE)
                 MOVE    1    TO    RECE02-SYUTANARIFLG
               END-IF
             END-PERFORM
           END-IF
      *
           .
       210B-SEIHO-HKNCOMBI-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    特記事項０９施有りフラグ編集
      *****************************************************************
       210A-TOKKI09FLG-HENSYU-SEC               SECTION.
      *
           IF   RECE02-TOKKI09FLG  =  ZERO
             PERFORM  VARYING  IDX25  FROM  1  BY  1
                       UNTIL  (IDX25               >  5   )
                        OR    (RECE02-TOKKI(IDX25) = SPACE)
               IF   RECE02-TOKKI(IDX25) = "09"
                 MOVE   1   TO  RECE02-TOKKI09FLG
                 MOVE   5   TO  IDX25
               END-IF
             END-PERFORM
           END-IF
      *
           IF   RECE02-TOKKI09FLG  =  ZERO
             PERFORM  VARYING  IDX25  FROM  1  BY  1
                       UNTIL  (IDX25                    >  5   )
                        OR    (RECE02-PTTOKKI-CD(IDX25) = SPACE)
               IF   RECE02-PTTOKKI-CD(IDX25) = "09"
                 MOVE   1   TO  RECE02-TOKKI09FLG
                 MOVE   5   TO  IDX25
               END-IF
             END-PERFORM
           END-IF
      *
           IF   RECE02-TOKKI09FLG  =   1
           AND  RECE02-HAICOMFLG   =  ZERO
      *      レセプトコメント（９９）のチェック
             INITIALIZE                      RECECOM-REC
             MOVE    RECE02-HOSPNUM      TO  RECECOM-HOSPNUM
             MOVE    RECE02-PTID         TO  RECECOM-PTID
             MOVE    RECE02-SRYYM        TO  RECECOM-SRYYM
             MOVE    RECE02-NYUGAIKBN    TO  RECECOM-NYUGAIKBN
             MOVE    RECECOM-REC         TO  MCPDATA-REC
             MOVE    "tbl_rececom"       TO  MCP-TABLE
             MOVE    "key7"              TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC              =   ZERO
               MOVE    "tbl_rececom"     TO  MCP-TABLE
               MOVE    "key7"            TO  MCP-PATHNAME
               PERFORM 900-RECECOM-READ-SEC
             ELSE
               INITIALIZE                    RECECOM-REC
               MOVE    1                 TO  FLG-RECECOM
             END-IF
             PERFORM  UNTIL  FLG-RECECOM       =   1
                       OR    RECE02-HAICOMFLG  =   1
               MOVE     ZERO    TO   FLG-ARI
               PERFORM  VARYING  IDX25  FROM  1  BY  1
                         UNTIL  (IDX25                  >   10 )
                          OR    (RECE02-HKNCOMBI(IDX25) =  ZERO)
                 IF  RECE02-HKNCOMBI(IDX25) =  RECECOM-HKNCOMBI
                   MOVE     1   TO   FLG-ARI
                   MOVE    10   TO   IDX25
                 END-IF
               END-PERFORM
               IF    FLG-ARI  =  1
      *          【配】の有無チェック
                IF  RECE02-HAICOMFLG  =  ZERO
                 MOVE       ZERO         TO  WRK-COL
                 INSPECT  RECECOM-COMMENT  TALLYING  WRK-COL
                                           FOR ALL   "【配】",
                                               ALL   "（配）",
                                               ALL   "「配」"
                 IF      WRK-COL         >   ZERO
                     MOVE    1           TO  RECE02-HAICOMFLG
                 END-IF
                END-IF
                IF  RECE02-HAICOMFLG  =  ZERO
                 IF  ( RECECOM-COMMENT(1:2) = "配" )
                 AND ((RECECOM-COMMENT(5:2) = "回") OR
                      (RECECOM-COMMENT(7:2) = "回") OR
                      (RECECOM-COMMENT(9:2) = "回"))
                     MOVE    1           TO  RECE02-HAICOMFLG
                 END-IF
                END-IF
               END-IF
               MOVE      "tbl_rececom"   TO  MCP-TABLE
               MOVE      "key7"          TO  MCP-PATHNAME
               PERFORM   900-RECECOM-READ-SEC
             END-PERFORM
             MOVE        "tbl_rececom"   TO  MCP-TABLE
             MOVE        "key7"          TO  MCP-PATHNAME
             PERFORM     900-CLOSE-SEC
           END-IF
      *
           .
       210A-TOKKI09FLG-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    在宅回数の再編集
      *****************************************************************
       211Y-ZAITAKU-KAISU-HENSYU-SEC               SECTION.
      *
           IF    RECE02-SRYYM   >=  "201404"
      *
      *      患家診療時間加算（往診）に関する回数の再編集
             PERFORM  VARYING  IDX19  FROM  1  BY  1
                       UNTIL   IDX19   >    9
               PERFORM  VARYING  IDX20  FROM  1  BY  1
                         UNTIL   IDX20   >   31
                 IF  TBL-ZAITAKU-KAISU(1 IDX19 IDX20) NOT = ZERO
                 AND TBL-ZAITAKU-KAISU(2 IDX19 IDX20) NOT = ZERO
                   COMPUTE  RECE02-KAISU(8) =
                            RECE02-KAISU(8) -
                            TBL-ZAITAKU-KAISU(2 IDX19 IDX20)
                 END-IF
               END-PERFORM
             END-PERFORM
      *      患家診療時間加算（特別往診）に関する回数の再編集
             PERFORM  VARYING  IDX19  FROM  1  BY  1
                       UNTIL   IDX19   >    9
               PERFORM  VARYING  IDX20  FROM  1  BY  1
                         UNTIL   IDX20   >   31
                 IF  TBL-ZAITAKU-KAISU(3 IDX19 IDX20) NOT = ZERO
                 AND TBL-ZAITAKU-KAISU(4 IDX19 IDX20) NOT = ZERO
                   COMPUTE  RECE02-KAISU(8) =
                            RECE02-KAISU(8) -
                            TBL-ZAITAKU-KAISU(4 IDX19 IDX20)
                 END-IF
               END-PERFORM
             END-PERFORM
      *      患家診療時間加算（在宅患者訪問診療料）に関する回数の再編集
             PERFORM  VARYING  IDX19  FROM  1  BY  1
                       UNTIL   IDX19   >    9
               PERFORM  VARYING  IDX20  FROM  1  BY  1
                         UNTIL   IDX20   >   31
                 IF  TBL-ZAITAKU-KAISU(5 IDX19 IDX20) NOT = ZERO
                 AND TBL-ZAITAKU-KAISU(6 IDX19 IDX20) NOT = ZERO
                   COMPUTE  RECE02-KAISU(11) =
                            RECE02-KAISU(11) -
                            TBL-ZAITAKU-KAISU(6 IDX19 IDX20)
                 END-IF
               END-PERFORM
             END-PERFORM
      *
           END-IF
      *
           .
       211Y-ZAITAKU-KAISU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    第三者行為の請求点数チェック
      *****************************************************************
       211X-DAISAN-CHECK-SEC      SECTION.
      *
           MOVE      ZERO      TO      FLG-DAISAN-ARI
           MOVE      ZERO      TO      WRK-DAISAN-TOTALTEN-GEN
      *
           PERFORM  VARYING  IDX16   FROM    1   BY  1
                     UNTIL  (IDX16                   >   10 )
                       OR   (RECE02-HKNCOMBI(IDX16)  =  ZERO)
      *
             IF     RECE02-DAISANFLG(IDX16)   =   1
      *
               INITIALIZE                        SRYACCT-REC
               MOVE  RECE02-HOSPNUM         TO   ACCT-HOSPNUM
               MOVE  RECE02-NYUGAIKBN       TO   ACCT-NYUGAIKBN
               MOVE  RECE02-PTID            TO   ACCT-PTID
               MOVE  RECE02-SRYYM           TO   ACCT-SRYYM
               MOVE  RECE02-HKNCOMBI(IDX16) TO   ACCT-HKNCOMBI
               MOVE  SRYACCT-REC            TO   MCPDATA-REC
               MOVE  "tbl_sryacct"          TO   MCP-TABLE
               MOVE  "key22"                TO   MCP-PATHNAME
               PERFORM 900-DBSELECT-SEC
               IF    MCP-RC   =   ZERO
                 MOVE    "tbl_sryacct"      TO   MCP-TABLE
                 MOVE    "key22"            TO   MCP-PATHNAME
                 PERFORM  900-SRYACCT-READ-SEC
                 PERFORM  UNTIL  (FLG-SRYACCT =  1)
                   IF   (ACCT-ZAITEN    NOT =  ZERO         )
                   AND  (ACCT-ZAIKAISU  NOT =  ZERO         )
                   AND  (ACCT-JIHOKBN       =  SPACE        )
                   AND  (ACCT-SRYKBN    NOT =  "95" AND "96")
                     MOVE    ZERO    TO   FLG-DAISAN-NG
                     IF  (ACCT-SRYKBN             =  "80")
                     AND (ACCT-ZAIREQFLG          =  "1" )
                       INITIALIZE                  SRYACT-REC
                       MOVE    ACCT-HOSPNUM    TO  SRY-HOSPNUM
                       MOVE    ACCT-NYUGAIKBN  TO  SRY-NYUGAIKBN
                       MOVE    ACCT-PTID       TO  SRY-PTID
                       MOVE    ACCT-SRYKA      TO  SRY-SRYKA
                       MOVE    ACCT-SRYYM      TO  SRY-SRYYM
                       MOVE    ACCT-ZAINUM     TO  SRY-ZAINUM
                       MOVE    1               TO  SRY-RENNUM
                       MOVE    SRYACT-REC      TO  MCPDATA-REC
                       MOVE    "tbl_sryact"    TO  MCP-TABLE
                       MOVE    "key"           TO  MCP-PATHNAME
                       PERFORM 900-DBSELECT-SEC
                       IF      MCP-RC          =   ZERO
                         MOVE  "tbl_sryact"    TO  MCP-TABLE
                         MOVE  "key"           TO  MCP-PATHNAME
                         PERFORM  900-SRYACT-READ-SEC
                         IF    FLG-SRYACT      =   ZERO
                           IF  SRY-SRYCD(1)(1:5) =
                               "09591" OR "09592" OR "09593"
                             MOVE    1    TO   FLG-DAISAN-NG
                           END-IF
                         END-IF
                       END-IF
                       MOVE    "tbl_sryact"    TO  MCP-TABLE
                       MOVE    "key"           TO  MCP-PATHNAME
                       PERFORM 900-CLOSE-SEC
                     END-IF
                     IF   FLG-DAISAN-NG = ZERO
                       MOVE   1   TO  RECE02-DAISAN-SKYFLG(IDX16)
                       IF      ACCT-ZAIKBN      =    2
                           COMPUTE    WRK-DAISAN-TOTALTEN-GEN =
                                      WRK-DAISAN-TOTALTEN-GEN +
                                     (ACCT-ZAITEN  *  ACCT-ZAIKAISU)
                       ELSE
                         IF   ACCT-SRYCDTOTAL(6:9) = "630010002"
                                                  OR "630010005"
                                                  OR "630010006"
                                                  OR "630010007"
                           COMPUTE    RECE02-DAISAN-TOTALTEN  =
                                      RECE02-DAISAN-TOTALTEN  -
                                     (ACCT-ZAITEN  *  ACCT-ZAIKAISU)
                         ELSE
                           COMPUTE    RECE02-DAISAN-TOTALTEN  =
                                      RECE02-DAISAN-TOTALTEN  +
                                     (ACCT-ZAITEN  *  ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                       MOVE   1   TO  RECE02-DAISAN-GAITO
                     END-IF
                   END-IF
                   MOVE    "tbl_sryacct"    TO  MCP-TABLE
                   MOVE    "key22"          TO  MCP-PATHNAME
                   PERFORM  900-SRYACCT-READ-SEC
                 END-PERFORM
               END-IF
               MOVE      "tbl_sryacct"      TO  MCP-TABLE
               MOVE      "key22"            TO  MCP-PATHNAME
               PERFORM    900-CLOSE-SEC
      *
               MOVE       1                 TO  FLG-DAISAN-ARI
      *
             END-IF
      *
           END-PERFORM
      *
           IF    RECE02-DAISAN-GAITO  =   1
      *
             COMPUTE  RECE02-DAISAN-TOTALTEN = RECE02-DAISAN-TOTALTEN
                                             - WRK-DAISAN-TOTALTEN-GEN
      *
             PERFORM  VARYING  IDX16   FROM    1   BY  1
                       UNTIL  (IDX16                   >   10 )
                         OR   (RECE02-HKNCOMBI(IDX16)  =  ZERO)
                         OR   (RECE02-DAISAN-GAITO     =   2  )
      *
               IF     RECE02-DAISANFLG(IDX16)   NOT =   1
      *
                 INITIALIZE                        SRYACCT-REC
                 MOVE  RECE02-HOSPNUM         TO   ACCT-HOSPNUM
                 MOVE  RECE02-NYUGAIKBN       TO   ACCT-NYUGAIKBN
                 MOVE  RECE02-PTID            TO   ACCT-PTID
                 MOVE  RECE02-SRYYM           TO   ACCT-SRYYM
                 MOVE  RECE02-HKNCOMBI(IDX16) TO   ACCT-HKNCOMBI
                 MOVE  SRYACCT-REC            TO   MCPDATA-REC
                 MOVE  "tbl_sryacct"          TO   MCP-TABLE
                 MOVE  "key22"                TO   MCP-PATHNAME
                 PERFORM 900-DBSELECT-SEC
                 IF    MCP-RC   =   ZERO
                   MOVE    "tbl_sryacct"      TO   MCP-TABLE
                   MOVE    "key22"            TO   MCP-PATHNAME
                   PERFORM  900-SRYACCT-READ-SEC
                   PERFORM  UNTIL  (FLG-SRYACCT         =  1 )
                             OR    (RECE02-DAISAN-GAITO =  2 )
                     IF   (ACCT-ZAITEN    NOT =  ZERO         )
                     AND  (ACCT-ZAIKAISU  NOT =  ZERO         )
                     AND  (ACCT-JIHOKBN       =  SPACE        )
                     AND  (ACCT-SRYKBN    NOT =  "95" AND "96")
                         MOVE   2   TO  RECE02-DAISAN-GAITO
                     END-IF
                     MOVE    "tbl_sryacct"    TO  MCP-TABLE
                     MOVE    "key22"          TO  MCP-PATHNAME
                     PERFORM  900-SRYACCT-READ-SEC
                   END-PERFORM
                 END-IF
                 MOVE      "tbl_sryacct"      TO  MCP-TABLE
                 MOVE      "key22"            TO  MCP-PATHNAME
                 PERFORM    900-CLOSE-SEC
      *
               END-IF
      *
             END-PERFORM
      *
           END-IF
      *
           IF    RECE02-DAISAN-GAITO  =  ZERO
           AND   FLG-DAISAN-ARI       =  ZERO
      *
             INITIALIZE                          HKNCOMBI-REC
             MOVE     RECE02-HOSPNUM       TO    COMB-HOSPNUM
             MOVE     RECE02-PTID          TO    COMB-PTID
             MOVE     HKNCOMBI-REC         TO    MCPDATA-REC
             MOVE     "tbl_hkncombi"       TO    MCP-TABLE
             MOVE     "key8"               TO    MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF     MCP-RC   =   ZERO
               MOVE   "tbl_hkncombi"       TO    MCP-TABLE
               MOVE   "key8"               TO    MCP-PATHNAME
               PERFORM 900-DBFETCH-SEC
               IF   MCP-RC   =   ZERO
                 CONTINUE
               ELSE
                 MOVE     9     TO  RECE02-DAISAN-GAITO
               END-IF
             ELSE
               MOVE       9     TO  RECE02-DAISAN-GAITO
             END-IF
             MOVE     "tbl_hkncombi"       TO    MCP-TABLE
             MOVE     "key8"               TO    MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
      *
           END-IF
      *
      ***********
      *
      *    現物給付計算対象かチェック
      *    全ての収納が現物給付計算されているかチェック
           MOVE     ZERO       TO     FLG-DAISAN-GENBUTU
           IF    RECE02-DAISAN-GENBUTU-GAITO   =   1
      *
             IF    RECE02-ZAITAKU   NOT =  SPACE
               PERFORM  VARYING  IDX16   FROM    1   BY  1
                         UNTIL  (IDX16                   >   10 )
                           OR   (RECE02-HKNCOMBI(IDX16)  =  ZERO)
                           OR   (FLG-DAISAN-GENBUTU      =   1  )
                 IF     RECE02-DAISANFLG(IDX16)   =   1
                   INITIALIZE                       SYUNOU-REC
                   MOVE  RECE02-HOSPNUM         TO  SYU-HOSPNUM
                   MOVE  RECE02-NYUGAIKBN       TO  SYU-NYUGAIKBN
                   MOVE  RECE02-PTID            TO  SYU-PTID
                   MOVE  RECE02-SRYYM           TO  SYU-SRYYMD(1:6)
                   MOVE  "__"                   TO  SYU-SRYYMD(7:2)
                   MOVE  RECE02-HKNCOMBI(IDX16) TO  SYU-HKNCOMBINUM
                   MOVE  SYUNOU-REC             TO  MCPDATA-REC
                   MOVE  "tbl_syunou"           TO  MCP-TABLE
                   MOVE  "key41"                TO  MCP-PATHNAME
                   PERFORM 900-DBSELECT-SEC
                   IF    MCP-RC   =   ZERO
                     MOVE    "tbl_syunou"       TO  MCP-TABLE
                     MOVE    "key41"            TO  MCP-PATHNAME
                     PERFORM  900-SYUNOU-READ-SEC
                     PERFORM  UNTIL  (FLG-SYUNOU  =  1)
                       IF    SYU-DENPJTIKBN    NOT =  "3"
                         IF  SYU-TOTAL-HKNTEN  NOT = ZERO
                         AND SYU-SKJ-FTNGAKU(2)    = ZERO
                           MOVE     1           TO  FLG-DAISAN-GENBUTU
                           MOVE   IDX16         TO  IDX23
                         END-IF
                       END-IF
                       MOVE    "tbl_syunou"     TO  MCP-TABLE
                       MOVE    "key41"          TO  MCP-PATHNAME
                       PERFORM  900-SYUNOU-READ-SEC
                     END-PERFORM
                   END-IF
                   MOVE      "tbl_syunou"       TO  MCP-TABLE
                   MOVE      "key41"            TO  MCP-PATHNAME
                   PERFORM    900-CLOSE-SEC
                 END-IF
               END-PERFORM
               IF   FLG-DAISAN-GENBUTU   =   1
                 MOVE     ZERO       TO     RECE02-DAISAN-GENBUTU-GAITO
                 IF    RECE02-DAISAN-GENBUTUFLG(IDX23) = ZERO
                  DISPLAY "現物給付対象未登録の第三者行為有"
                 ELSE
                  DISPLAY "現物給付対象登録後の再計算未実施分有"
                  DISPLAY "又は、減額認定証適用期間外の診療分有"
                 END-IF
                 DISPLAY  "HKNCOMBI=" RECE02-HKNCOMBI(IDX23)
                 DISPLAY  "DAISAN-GENBUTUFLG="
                                      RECE02-DAISAN-GENBUTUFLG(IDX23)
               END-IF
             ELSE
                 MOVE     ZERO       TO     RECE02-DAISAN-GENBUTU-GAITO
             END-IF
      *
           END-IF
      *
           .
       211X-DAISAN-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    第三者行為の院外処方の有無チェック
      *****************************************************************
       211X1-DAISAN-CHECK2-SEC      SECTION.
      *
      *    病名記載の為、院外処方の有無チェックを行い、フラグの値を置換する
      *
      *    ＜第三者行為の請求点なし＞の場合
           IF    RECE02-DAISAN-GAITO  =  ZERO
             PERFORM  VARYING  IDX16   FROM    1   BY  1
                       UNTIL  (IDX16                   >   10 )
                         OR   (RECE02-HKNCOMBI(IDX16)  =  ZERO)
               IF   WRK-DAISAN-INGAI(IDX16)  =   1
                 IF     RECE02-DAISANFLG(IDX16)   =   1
                     MOVE   1   TO  RECE02-DAISAN-SKYFLG(IDX16)
                     MOVE   3   TO  RECE02-DAISAN-GAITO
                 END-IF
               END-IF
             END-PERFORM
           END-IF
      *
      *    ＜第三者行為のみ請求点あり＞の場合
           IF    RECE02-DAISAN-GAITO  =   1
             PERFORM  VARYING  IDX16   FROM    1   BY  1
                       UNTIL  (IDX16                   >   10 )
                         OR   (RECE02-HKNCOMBI(IDX16)  =  ZERO)
               IF   WRK-DAISAN-INGAI(IDX16)  =   1
                 IF     RECE02-DAISANFLG(IDX16)   =   1
                   IF   RECE02-DAISAN-SKYFLG(IDX16) =  ZERO
                     MOVE   1   TO  RECE02-DAISAN-SKYFLG(IDX16)
                   END-IF
                 ELSE
                     MOVE   4   TO  RECE02-DAISAN-GAITO
                 END-IF
               END-IF
             END-PERFORM
           END-IF
      *
           .
       211X1-DAISAN-CHECK2-EXT.
           EXIT.
      *
      *****************************************************************
      *    第三者行為の一部負担金計算（１０円未満四捨五入の場合）
      *****************************************************************
       211X2-DAISAN-CHECK3-SEC      SECTION.
      *
           MOVE     ZERO     TO    WRK-DAISAN-TOTALTEN-SYUNOU
           MOVE     ZERO     TO    WRK-DAISAN-FTNMONEY
           MOVE     SPACE    TO    WRK-DAISAN-ACCT-UPDKBN
      *
           PERFORM  VARYING  IDX16   FROM    1   BY  1
                     UNTIL  (IDX16                   >   10 )
                       OR   (RECE02-HKNCOMBI(IDX16)  =  ZERO)
      *
             IF     RECE02-DAISANFLG(IDX16)   =   1
      *
               INITIALIZE                       SYUNOU-REC
               MOVE  RECE02-HOSPNUM         TO  SYU-HOSPNUM
               MOVE  RECE02-NYUGAIKBN       TO  SYU-NYUGAIKBN
               MOVE  RECE02-PTID            TO  SYU-PTID
               MOVE  RECE02-SRYYM           TO  SYU-SRYYMD(1:6)
               MOVE  "__"                   TO  SYU-SRYYMD(7:2)
               MOVE  RECE02-HKNCOMBI(IDX16) TO  SYU-HKNCOMBINUM
               MOVE  SYUNOU-REC             TO  MCPDATA-REC
               MOVE  "tbl_syunou"           TO  MCP-TABLE
               MOVE  "key41"                TO  MCP-PATHNAME
               PERFORM 900-DBSELECT-SEC
               IF    MCP-RC   =   ZERO
                 MOVE    "tbl_syunou"       TO  MCP-TABLE
                 MOVE    "key41"            TO  MCP-PATHNAME
                 PERFORM  900-SYUNOU-READ-SEC
                 PERFORM  UNTIL  (FLG-SYUNOU  =  1)
                   IF    SYU-DENPJTIKBN    NOT =  "3"
                     IF  SYU-TOTAL-HKNTEN  NOT = ZERO
                       ADD  SYU-TOTAL-HKNTEN
                                  TO  WRK-DAISAN-TOTALTEN-SYUNOU
      *
      ***              COMPUTE  WRK-DAISAN-FTNMONEY2 = SYU-TOTAL-HKNTEN
      ***                                            * 10
      ***                                            * RECE02-KYURATE
      ***                                            / 100
      ***              COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***                       WRK-DAISAN-FTNMONEY2 +  5
      ***              COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***                       WRK-DAISAN-FTNMONEY2 /  10
      ***              COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***                       WRK-DAISAN-FTNMONEY2 *  10
      *                複数科まとめの対応
                       COMPUTE  WRK-DAISAN-FTNMONEY2 =
                                SYU-SYUCOMPFTN       +  5
                       COMPUTE  WRK-DAISAN-FTNMONEY2 =
                                WRK-DAISAN-FTNMONEY2 /  10
                       COMPUTE  WRK-DAISAN-FTNMONEY2 =
                                WRK-DAISAN-FTNMONEY2 *  10
      *
                       COMPUTE  WRK-DAISAN-FTNMONEY  =
                                WRK-DAISAN-FTNMONEY  +
                                WRK-DAISAN-FTNMONEY2
                     END-IF
                     IF  SYU-ACCT-UPDKBN  NOT =  SPACE
                       MOVE  "1"  TO  WRK-DAISAN-ACCT-UPDKBN
                     END-IF
                   END-IF
                   MOVE    "tbl_syunou"     TO  MCP-TABLE
                   MOVE    "key41"          TO  MCP-PATHNAME
                   PERFORM  900-SYUNOU-READ-SEC
                 END-PERFORM
               END-IF
               MOVE      "tbl_syunou"       TO  MCP-TABLE
               MOVE      "key41"            TO  MCP-PATHNAME
               PERFORM    900-CLOSE-SEC
      *
             END-IF
      *
           END-PERFORM
      *
      *    リアルタイムプレビュー時
      ***  IF   (WRK-PARA-SHELLID        =   "RECEPTX")
      ***  AND  (WRK-DAISAN-ACCT-UPDKBN  =    SPACE   )
      *
      ***    IF   RECE02-DAISAN-TOTALTEN  >  WRK-DAISAN-TOTALTEN-SYUNOU
      ***      COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***         (RECE02-DAISAN-TOTALTEN - WRK-DAISAN-TOTALTEN-SYUNOU)
      ***                                    * 10
      ***                                    * RECE02-KYURATE
      ***                                    / 100
      ***      COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***               WRK-DAISAN-FTNMONEY2 +  5
      ***      COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***               WRK-DAISAN-FTNMONEY2 /  10
      ***      COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***               WRK-DAISAN-FTNMONEY2 *  10
      *
      ***      COMPUTE  WRK-DAISAN-FTNMONEY  =
      ***               WRK-DAISAN-FTNMONEY  +
      ***               WRK-DAISAN-FTNMONEY2
      ***    END-IF
      *
      ***  END-IF
      *
           .
       211X2-DAISAN-CHECK3-EXT.
           EXIT.
      *
      *****************************************************************
      *    第三者行為の一部負担金計算＜現物給付＞
      *****************************************************************
       211X3-DAISAN-CHECK4-SEC      SECTION.
      *
           MOVE     ZERO     TO    WRK-DAISAN-TOTALTEN-SYUNOU
           MOVE     ZERO     TO    WRK-DAISAN-FTNMONEY
           MOVE     SPACE    TO    WRK-DAISAN-ACCT-UPDKBN
      *
           PERFORM  VARYING  IDX16   FROM    1   BY  1
                     UNTIL  (IDX16                   >   10 )
                       OR   (RECE02-HKNCOMBI(IDX16)  =  ZERO)
      *
             IF     RECE02-DAISANFLG(IDX16)   =   1
      *
               INITIALIZE                       SYUNOU-REC
               MOVE  RECE02-HOSPNUM         TO  SYU-HOSPNUM
               MOVE  RECE02-NYUGAIKBN       TO  SYU-NYUGAIKBN
               MOVE  RECE02-PTID            TO  SYU-PTID
               MOVE  RECE02-SRYYM           TO  SYU-SRYYMD(1:6)
               MOVE  "__"                   TO  SYU-SRYYMD(7:2)
               MOVE  RECE02-HKNCOMBI(IDX16) TO  SYU-HKNCOMBINUM
               MOVE  SYUNOU-REC             TO  MCPDATA-REC
               MOVE  "tbl_syunou"           TO  MCP-TABLE
               MOVE  "key41"                TO  MCP-PATHNAME
               PERFORM 900-DBSELECT-SEC
               IF    MCP-RC   =   ZERO
                 MOVE    "tbl_syunou"       TO  MCP-TABLE
                 MOVE    "key41"            TO  MCP-PATHNAME
                 PERFORM  900-SYUNOU-READ-SEC
                 PERFORM  UNTIL  (FLG-SYUNOU  =  1)
                   IF    SYU-DENPJTIKBN    NOT =  "3"
                     IF  SYU-TOTAL-HKNTEN  NOT = ZERO
                       ADD  SYU-TOTAL-HKNTEN
                                  TO  WRK-DAISAN-TOTALTEN-SYUNOU
      *
                       COMPUTE  WRK-DAISAN-FTNMONEY  =
                                WRK-DAISAN-FTNMONEY  +
                                SYU-SYUCOMPFTN
                     END-IF
                     IF  SYU-ACCT-UPDKBN  NOT =  SPACE
                       MOVE  "1"  TO  WRK-DAISAN-ACCT-UPDKBN
                     END-IF
                   END-IF
                   MOVE    "tbl_syunou"     TO  MCP-TABLE
                   MOVE    "key41"          TO  MCP-PATHNAME
                   PERFORM  900-SYUNOU-READ-SEC
                 END-PERFORM
               END-IF
               MOVE      "tbl_syunou"       TO  MCP-TABLE
               MOVE      "key41"            TO  MCP-PATHNAME
               PERFORM    900-CLOSE-SEC
      *
             END-IF
      *
           END-PERFORM
      *
      *    リアルタイムプレビュー時
      ***  IF   (WRK-PARA-SHELLID        =   "RECEPTX")
      ***  AND  (WRK-DAISAN-ACCT-UPDKBN  =    SPACE   )
      *
      ***    IF   RECE02-DAISAN-TOTALTEN  >  WRK-DAISAN-TOTALTEN-SYUNOU
      ***      COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***         (RECE02-DAISAN-TOTALTEN - WRK-DAISAN-TOTALTEN-SYUNOU)
      ***                                    * 10
      ***                                    * RECE02-KYURATE
      ***                                    / 100
      ***      COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***               WRK-DAISAN-FTNMONEY2 +  5
      ***      COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***               WRK-DAISAN-FTNMONEY2 /  10
      ***      COMPUTE  WRK-DAISAN-FTNMONEY2 =
      ***               WRK-DAISAN-FTNMONEY2 *  10
      *
      ***      COMPUTE  WRK-DAISAN-FTNMONEY  =
      ***               WRK-DAISAN-FTNMONEY  +
      ***               WRK-DAISAN-FTNMONEY2
      ***    END-IF
      *
      ***  END-IF
      *
           .
       211X3-DAISAN-CHECK4-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費単独の災害対象上限額チェック
      *****************************************************************
       211P-SAIGAI-JGN-CHECK-SEC      SECTION.
      *
           INITIALIZE                        LNK-ORCSJGNGET-REC
           MOVE   RECE02-HOSPNUM         TO  LNK-ORCSJGNGET-HOSPNUM
           MOVE   RECE02-NYUGAIKBN       TO  LNK-ORCSJGNGET-NYUGAIKBN
           MOVE   RECE02-PTID            TO  LNK-ORCSJGNGET-PTID
           MOVE   RECE02-KOHNUM(IDX-SAI) TO  LNK-ORCSJGNGET-KOHHKNNUM
           MOVE   RECE02-KOHID(IDX-SAI)  TO  LNK-ORCSJGNGET-KOHID
           MOVE   RECE02-SRYYM           TO  LNK-ORCSJGNGET-SRYYM
           IF     RECE02-KOHNUM(IDX-SAI)(1:1) >=  "1" AND <=  "8"
              MOVE   WRK-KOHJGNGET-TAISYOKBN(IDX-SAI)
                                         TO  LNK-ORCSJGNGET-SETKBN
              MOVE   WRK-KOHJGNGET-TEKIYOFLG(IDX-SAI)
                                         TO  LNK-ORCSJGNGET-SETKBN2
           END-IF
           CALL    "ORCSJGNGET"          USING
                                         LNK-ORCSJGNGET-REC
                                         SPA-AREA
           IF   LNK-ORCSJGNGET-RC  =  ZERO
             IF   LNK-ORCSJGNGET-GAIJGNGAK  NOT = ZERO
                MOVE    1    TO    FLG-SAIGAI-JGN-ETC
             END-IF
           END-IF
      *
           .
       211P-SAIGAI-JGN-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    全国公費併用分請求点集計判別
      *****************************************************************
       211J-SYUKEIKBN-HANBETU-SEC      SECTION.
      *
           IF    IDZ    =    1
      *
             PERFORM  VARYING  IDX11   FROM    1   BY  1
                       UNTIL  (IDX11                   >   10 )
                         OR   (RECE02-HKNCOMBI(IDX11)  =  ZERO)
      *
              IF ((RECE02-HKNNUMHC(IDX11)     NOT = SPACE          ) AND
                  (RECE02-KOHNUMHC(IDX11 1)(1:1)  = "0"            ) AND
                  (RECE02-KOHNUMHC(IDX11 2)(1:1) >= "1" AND <= "8" ))
              OR ((SYS-1001-PREFNUM               = "13"           ) AND
                  (RECE02-HKNNUMHC(IDX11)     NOT = SPACE          ) AND
                  (RECE02-KOHNUMHC(IDX11 1)(1:1) >= "1" AND <= "8" ) AND
                  (RECE02-KOHNUMHC(IDX11 2)(1:1) >= "1" AND <= "8" ))
              OR ((SYS-1001-PREFNUM               = "23"           ) AND
                  (RECE02-SRYYM                  >= "200910"       ) AND
                  (RECE02-HKNNUMHC(IDX11)     NOT = SPACE          ) AND
                  (RECE02-KOHNUMHC(IDX11 1)       = "191"          ) AND
                  (RECE02-KOHNUMHC(IDX11 2)(1:1) >= "1" AND <= "8" ))
              OR ((SYS-1001-PREFNUM               = "23" OR "24"   ) AND
                  (RECE02-SRYYM                  >= "201104"       ) AND
                  (RECE02-SRYYM                  <= "201412"       ) AND
                  (RECE02-HKNNUMHC(IDX11)     NOT = SPACE          ) AND
                  (RECE02-KOHNUMHC(IDX11 1)       = "152"          ) AND
                  (RECE02-KOHNUMHC(IDX11 2)(1:1) >= "1" AND <= "8" ))
      *
                IF ((RECE02-KOHNUMHC(IDX11 2) =  RECE02-KOHNUM(2)) AND
                    (RECE02-KOHIDHC(IDX11 2)  =  RECE02-KOHID(2) ))
                OR ((RECE02-KOHNUMHC(IDX11 2) =  RECE02-KOHNUM(3)) AND
                    (RECE02-KOHIDHC(IDX11 2)  =  RECE02-KOHID(3) ))
                OR ((RECE02-KOHNUMHC(IDX11 2) =  RECE02-KOHNUM(4)) AND
                    (RECE02-KOHIDHC(IDX11 2)  =  RECE02-KOHID(4) ))
      *
                  IF    RECE02-SRYYM  >=  "200804"
                    INITIALIZE                   SYSKANRI-REC
                    MOVE    "2010"           TO  SYS-KANRICD
                    MOVE    RECE02-KOHNUMHC(IDX11 2)
                                             TO  SYS-KBNCD
                    MOVE    RECE02-SRYYM     TO  SYS-STYUKYMD (1:6)
                    MOVE    "01"             TO  SYS-STYUKYMD (7:2)
                    MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
                    MOVE    "tbl_syskanri"   TO  WRK-MCP-TABLE
                    MOVE    "key10"          TO  WRK-MCP-PATHNAME
                    PERFORM 960-KANRIMST-READ-SEC
                    IF      FLG-SYSKANRI     =   ZERO
                       MOVE    MCPDATA-REC   TO  SYS-2010-REC
                    ELSE
                       INITIALIZE                SYS-2010-REC
                    END-IF
                    PERFORM    211J1-SYUKEIKBN-HENSYU-SEC
                  ELSE
                    EVALUATE   SYS-1001-PREFNUM
                      WHEN     "08"
                      WHEN     "32"
                      WHEN     "13"
                      WHEN     "26"
                          MOVE "4" TO RECE02-SYUKEIKBN(IDX11 2)
                          MOVE "1" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                      WHEN     "30"
                      WHEN     "38"
                          MOVE "3" TO RECE02-SYUKEIKBN(IDX11 2)
                          MOVE "1" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                      WHEN     "36"
                          MOVE "3" TO RECE02-SYUKEIKBN(IDX11 2)
                          MOVE "0" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                      WHEN     "10"
                          MOVE "4" TO RECE02-SYUKEIKBN(IDX11 2)
                          MOVE "4" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                    END-EVALUATE
                  END-IF
      *
                  IF ((SYS-1001-PREFNUM          =  "13"    ) AND
                      (RECE02-KOHNUMHC(IDX11 2)  =  "151"   ) AND
                      (RECE02-SRYYM             >=  "200905"))
                  OR ((SYS-1001-PREFNUM          =  "23"    ) AND
                      (RECE02-KOHNUMHC(IDX11 2)  =  "191"   ) AND
                      (RECE02-SRYYM             >=  "200910"))
                  OR ((SYS-1001-PREFNUM          =  "23"
                                                 OR "24"    ) AND
                      (RECE02-KOHNUMHC(IDX11 2)  =  "152"   ) AND
                      (RECE02-SRYYM             >=  "201104") AND
                      (RECE02-SRYYM             <=  "201412"))
                          MOVE "0" TO RECE02-SYUKEIKBN(IDX11 2)
                          MOVE "0" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                  END-IF
      *
                END-IF
      *
              END-IF
      *
             END-PERFORM
      *
           END-IF
      *
           .
       211J-SYUKEIKBN-HANBETU-EXT.
           EXIT.
      *
      *****************************************************************
      *    全国公費併用分請求点集計判別編集
      *****************************************************************
       211J1-SYUKEIKBN-HENSYU-SEC      SECTION.
      *
           EVALUATE  SYS-2010-SYUKEIKBN
             WHEN      SPACE
                 EVALUATE   SYS-1001-PREFNUM
                   WHEN     "32"
                   WHEN     "13"
                       MOVE "4" TO RECE02-SYUKEIKBN(IDX11 2)
                       MOVE "1" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                   WHEN     "36"
                       MOVE "3" TO RECE02-SYUKEIKBN(IDX11 2)
                       MOVE "0" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                   WHEN     "10"
                       MOVE "4" TO RECE02-SYUKEIKBN(IDX11 2)
                       MOVE "4" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
      ***          WHEN     "38"
      ***            IF  RECE02-SRYYM  <=  "201711"
      ***              MOVE "3" TO RECE02-SYUKEIKBN(IDX11 2)
      ***              MOVE "1" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
      ***            END-IF
                   WHEN     "08"
                     IF  RECE02-SRYYM  <=  "201002"
                       MOVE "4" TO RECE02-SYUKEIKBN(IDX11 2)
                       MOVE "1" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                     END-IF
                   WHEN     "26"
                     IF  RECE02-SRYYM  <=  "201103"
                       MOVE "4" TO RECE02-SYUKEIKBN(IDX11 2)
                       MOVE "1" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                     END-IF
                   WHEN     "30"
                     IF  RECE02-SRYYM  <=  "201003"
                       MOVE "3" TO RECE02-SYUKEIKBN(IDX11 2)
                       MOVE "1" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                     END-IF
                 END-EVALUATE
             WHEN      "0"
                 MOVE   SYS-2010-SYUKEIKBN
                                    TO   RECE02-SYUKEIKBN(IDX11 2)
                 MOVE   SYS-2010-SYUKEI-TAIKBN
                                    TO   RECE02-SYUKEI-TAIKBN(IDX11 2)
                 EVALUATE   SYS-1001-PREFNUM
      ***          WHEN     "38"
      ***            IF  RECE02-SRYYM  <=  "201711"
      ***              MOVE "3" TO RECE02-SYUKEIKBN(IDX11 2)
      ***              MOVE "1" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
      ***            END-IF
                   WHEN     "08"
                     IF  RECE02-SRYYM  <=  "201002"
                       MOVE "4" TO RECE02-SYUKEIKBN(IDX11 2)
                       MOVE "1" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                     END-IF
                   WHEN     "26"
                     IF  RECE02-SRYYM  <=  "201103"
                       MOVE "4" TO RECE02-SYUKEIKBN(IDX11 2)
                       MOVE "1" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                     END-IF
                   WHEN     "30"
                     IF  RECE02-SRYYM  <=  "201003"
                       MOVE "3" TO RECE02-SYUKEIKBN(IDX11 2)
                       MOVE "1" TO RECE02-SYUKEI-TAIKBN(IDX11 2)
                     END-IF
                 END-EVALUATE
             WHEN      "1"
             WHEN      "2"
             WHEN      "3"
             WHEN      "4"
                 MOVE   SYS-2010-SYUKEIKBN
                                    TO   RECE02-SYUKEIKBN(IDX11 2)
                 MOVE   SYS-2010-SYUKEI-TAIKBN
                                    TO   RECE02-SYUKEI-TAIKBN(IDX11 2)
                 IF   RECE02-SYUKEIKBN(IDX11 2) = "1"
                       MOVE "3" TO RECE02-SYUKEIKBN(IDX11 2)
                 END-IF
                 IF   RECE02-SYUKEIKBN(IDX11 2) = "2"
                       MOVE "4" TO RECE02-SYUKEIKBN(IDX11 2)
                 END-IF
           END-EVALUATE
      *
           .
       211J1-SYUKEIKBN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集
      *****************************************************************
       211E-JGNCHK-HENSYU-SEC      SECTION.
      *
           INITIALIZE                      LNK-ORCSJGNGET-REC
           MOVE   RECE02-HOSPNUM       TO  LNK-ORCSJGNGET-HOSPNUM
           MOVE   RECE02-NYUGAIKBN     TO  LNK-ORCSJGNGET-NYUGAIKBN
           MOVE   RECE02-PTID          TO  LNK-ORCSJGNGET-PTID
           MOVE   RECE02-KOHNUM(IDY2)  TO  LNK-ORCSJGNGET-KOHHKNNUM
           MOVE   RECE02-KOHID(IDY2)   TO  LNK-ORCSJGNGET-KOHID
           MOVE   RECE02-SRYYM         TO  LNK-ORCSJGNGET-SRYYM
           IF     RECE02-KOHNUM(IDY2)(1:1) >=  "1" AND <=  "8"
              MOVE   WRK-KOHJGNGET-TAISYOKBN(IDY2)
                                       TO  LNK-ORCSJGNGET-SETKBN
              MOVE   WRK-KOHJGNGET-TEKIYOFLG(IDY2)
                                       TO  LNK-ORCSJGNGET-SETKBN2
           END-IF
           CALL    "ORCSJGNGET"        USING
                                       LNK-ORCSJGNGET-REC
                                       SPA-AREA
           IF     LNK-ORCSJGNGET-RC    =   ZERO
              IF    (RECE02-KOHNUM(IDY2) = "015" OR "016" OR "021")
              AND   (LNK-ORCSJGNGET-GAIJGNGAK = 9999999 OR 999999 )
                MOVE    ZERO           TO  TBL-HKNFTNDATA-JGN(IDY2)
              ELSE
                MOVE    LNK-ORCSJGNGET-GAIJGNGAK
                                       TO  TBL-HKNFTNDATA-JGN(IDY2)
                IF  ( RECE02-KOHNUM(IDY2) =
                      "015" OR "016" OR "021" OR "038"     )
                OR  ((RECE02-KOHNUM(IDY2) = "052" OR "054") AND
                     (RECE02-SRYYM       >= "201501"      ))
                OR  ((SYS-1001-PREFNUM    =  23 OR 24     ) AND
                     (RECE02-KOHNUM(IDY2) = "152"         ) AND
                     (RECE02-SRYYM       >= "201104"      ) AND
                     (RECE02-SRYYM       <= "201412"      ))
                OR  ( WRK-KOHJGNGET-TEKIYOFLG(IDY2) =  1   )
                  MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO  TBL-HKNFTNDATA-TAF(IDY2)
                END-IF
              END-IF
              MOVE    LNK-ORCSJGNGET-GAIJGNGAK
                                       TO  TBL-HKNFTNDATA-JGNXXX(IDY2)
           END-IF
      *
           IF   TBL-HKNFTNDATA-JGN(IDY2)  NOT =  ZERO
              INITIALIZE                      ORCSFTNJGNCHKAREA
              MOVE    RECE02-HOSPNUM      TO  LNK-FTNJGNCHK-HOSPNUM
              MOVE    RECE02-PTID         TO  LNK-FTNJGNCHK-PTID
              MOVE    "2"                 TO  LNK-FTNJGNCHK-NYUGAIKBN
              MOVE    RECE02-SRYYM        TO  LNK-FTNJGNCHK-SRYYM
              MOVE    RECE02-KOHNUM(IDY2) TO  LNK-FTNJGNCHK-KOHNUM
              MOVE    RECE02-KOHID(IDY2)  TO  LNK-FTNJGNCHK-KOHID
              MOVE    SYS-1001-PREFNUM    TO  LNK-FTNJGNCHK-PREFNUM
              MOVE    ZERO                TO  LNK-FTNJGNCHK-HKNCOMBINUM
              MOVE    ZERO                TO  LNK-FTNJGNCHK-HKNID
              CALL    "ORCSFTNJGNCHK"     USING
                                          ORCSFTNJGNCHKAREA
                                          SPA-AREA
              MOVE    LNK-FTNJGNCHK-KOHFTN
                                   TO  TBL-HKNFTNDATA-GAIRAI(IDY2)
      *
              IF   RECE02-KOHNUM(IDY2) = "015" OR "016" OR "021"
                MOVE  RECE02-SRYYM    TO  WRK-CYOFUKU-KOH-YM
                MOVE  01              TO  WRK-CYOFUKU-KOH-DD
                IF   RECE02-KOHTEKSTYMD(IDY2) <=  WRK-CYOFUKU-KOH-YMD
                  CONTINUE
                ELSE
                  MOVE    1           TO  TBL-HKNFTNDATA-TEKFLG(IDY2)
                END-IF
              END-IF
           END-IF
      *
           .
       211E-JGNCHK-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    重複公費編集（入院レセプトのみに一部負担がある場合）
      *****************************************************************
       211Z-CYOFUKU-KOH-HENSYU-SEC      SECTION.
      *
           MOVE    ZERO                 TO  IDY4
           INITIALIZE                       TBL-CYOFUKU-KOH
      *
           INITIALIZE                       PTKOHINF-REC
           MOVE    RECE02-HOSPNUM       TO  PTKOH-HOSPNUM
           MOVE    RECE02-PTID          TO  PTKOH-PTID
           MOVE    RECE02-KOHNUM(IDY2)  TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC         TO  MCPDATA-REC
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key4"               TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC               =   ZERO
             MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
             MOVE    "key4"             TO  MCP-PATHNAME
             PERFORM  900-PTKOHINF-READ-SEC
             PERFORM  UNTIL   FLG-PTKOHINF    =   1
               IF  (PTKOH-TEKSTYMD(1:6)  <=   RECE02-SRYYM       )
               AND (RECE02-SRYYM         <=   PTKOH-TEKEDYMD(1:6))
               AND (PTKOH-SAKJOKBN        =   SPACE              )
                 IF  ((PTKOH-KOHNUM = RECE02-KOHNUM(1)) AND
                      (PTKOH-KOHID  = RECE02-KOHID (1)))
                 OR  ((PTKOH-KOHNUM = RECE02-KOHNUM(2)) AND
                      (PTKOH-KOHID  = RECE02-KOHID (2)))
                 OR  ((PTKOH-KOHNUM = RECE02-KOHNUM(3)) AND
                      (PTKOH-KOHID  = RECE02-KOHID (3)))
                 OR  ((PTKOH-KOHNUM = RECE02-KOHNUM(4)) AND
                      (PTKOH-KOHID  = RECE02-KOHID (4)))
                   CONTINUE
                 ELSE
                   MOVE    ZERO           TO  FLG-CYOFUKU-KOH
                   IF   PTKOH-KOHNUM = "015" OR "016"
                     MOVE  RECE02-SRYYM   TO  WRK-CYOFUKU-KOH-YM
                     MOVE  01             TO  WRK-CYOFUKU-KOH-DD
                     IF   PTKOH-TEKSTYMD <=  WRK-CYOFUKU-KOH-YMD
                       CONTINUE
                     ELSE
                       MOVE    1          TO  FLG-CYOFUKU-KOH
                     END-IF
                   END-IF
                   IF  (FLG-CYOFUKU-KOH  =  ZERO)
                   AND (IDY4             <   4  )
                     ADD      1           TO  IDY4
                     MOVE  PTKOH-KOHNUM   TO  TBL-CYOFUKU-KOHNUM(IDY4)
                     MOVE  PTKOH-KOHID    TO  TBL-CYOFUKU-KOHID (IDY4)
                   END-IF
                 END-IF
               END-IF
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
             END-PERFORM
           END-IF
           MOVE        "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE        "key4"             TO  MCP-PATHNAME
           PERFORM      900-CLOSE-SEC
      *
           PERFORM   VARYING  IDY4    FROM    1   BY   1
                      UNTIL  (IDY4                     >  4   )
                       OR    (TBL-CYOFUKU-KOHNUM(IDY4) = SPACE)
             MOVE     2    TO  FLG-NYUIN-CHECK
             PERFORM  211D-NYUIN-SYUNOU-HENSYU-SEC
           END-PERFORM
      *
           .
       211Z-CYOFUKU-KOH-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集（入院収納編集）
      *****************************************************************
       211D-NYUIN-SYUNOU-HENSYU-SEC      SECTION.
      *
           MOVE    RECE02-SRYYM        TO  WRK-STYMD (1:6)
           MOVE    "01"                TO  WRK-STYMD (7:2)
      *
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY7-AREA
           MOVE    "71"                TO  LNK-DAY7-IRAI
           MOVE    RECE02-SRYYM        TO  LNK-DAY7-YM
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY7-AREA
           MOVE    LNK-DAY7-KOYOMI     TO  WRK-EDYMD
      *
           MOVE    ZERO                TO  WRK-SEIKYUSTYMD
                                           WRK-SEIKYUEDYMD
      *    診療月内の入退院情報
           INITIALIZE                      PTNYUINRRK-REC
           MOVE    RECE02-HOSPNUM      TO  PTNYUINRRK-HOSPNUM
           MOVE    RECE02-PTID         TO  PTNYUINRRK-PTID
           MOVE    RECE02-SRYYM        TO  PTNYUINRRK-NYUINYMD (1:6)
           MOVE    "31"                TO  PTNYUINRRK-NYUINYMD (7:2)
           MOVE    RECE02-SRYYM        TO  PTNYUINRRK-TAIINYMD (1:6)
           MOVE    "01"                TO  PTNYUINRRK-TAIINYMD (7:2)
           MOVE    PTNYUINRRK-REC      TO  MCPDATA-REC
           MOVE    "tbl_ptnyuinrrk"    TO  MCP-TABLE
           MOVE    "key23"             TO  MCP-PATHNAME
           PERFORM    900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_ptnyuinrrk"    TO  MCP-TABLE
               MOVE    "key23"             TO  MCP-PATHNAME
               PERFORM 900-PTNYUINRRK-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-PTNYUINRRK
           END-IF
           PERFORM     UNTIL   FLG-PTNYUINRRK    =   1
               IF    ( WRK-SEIKYUSTYMD =   ZERO                )
               OR    ( WRK-SEIKYUSTYMD >   PTNYUINRRK-NYUINYMD )
                   IF  WRK-SEIKYUSTYMD =   WRK-STYMD
                      CONTINUE
                   ELSE
                     IF  PTNYUINRRK-NYUINYMD  >  WRK-STYMD
                       MOVE  PTNYUINRRK-NYUINYMD
                                             TO  WRK-SEIKYUSTYMD
                     ELSE
                       MOVE  WRK-STYMD       TO  WRK-SEIKYUSTYMD
                     END-IF
                   END-IF
               END-IF
               IF      WRK-SEIKYUEDYMD =   ZERO
                   MOVE  PTNYUINRRK-TAIINYMD TO  WRK-SEIKYUEDYMD
               END-IF
               MOVE    "tbl_ptnyuinrrk"    TO  MCP-TABLE
               MOVE    "key23"             TO  MCP-PATHNAME
               PERFORM 900-PTNYUINRRK-READ-SEC
           END-PERFORM
      *
           MOVE    "tbl_ptnyuinrrk"    TO  MCP-TABLE
           MOVE    "key23"             TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           IF    WRK-SEIKYUSTYMD   =   ZERO
              CONTINUE
           ELSE
      *
              IF    ( WRK-SEIKYUEDYMD     =   99999999 )
              OR    ( WRK-SEIKYUEDYMD     >   WRK-EDYMD)
                 MOVE    WRK-EDYMD     TO  WRK-SEIKYUEDYMD
              END-IF
      *
      *       収納データ取得処理
      *
              INITIALIZE                  LNK-ORCS02-REC
                                          LNK-SYUNOU-REC-T
                                          LNK-SYUDAY-REC-T
      *
              MOVE    RECE02-HOSPNUM  TO  LNK-S02-HOSPNUM
              MOVE    "1"             TO  LNK-S02-NYUGAIKBN
              MOVE    RECE02-PTID     TO  LNK-S02-PTID
              MOVE    WRK-SEIKYUSTYMD TO  LNK-S02-SKYSTYMD
              MOVE    WRK-SEIKYUEDYMD TO  LNK-S02-SKYEDYMD
              MOVE    "X"             TO  LNK-S02-TEIKI-KBN
              MOVE    WRK-STYMD       TO  LNK-S02-SYSYMD
              MOVE    "2"             TO  LNK-S02-SYORI-KBN
      *
              CALL    "ORCSNYUFTN"    USING
                                      SPA-AREA
                                      LNK-ORCS02-REC
                                      LNK-SYUNOU-REC-T
                                      LNK-SYUDAY-REC-T
      *
      *       仮収納出力処理
              IF      LNK-S02-RC      =   ZERO
                  PERFORM VARYING SYU-IDX   FROM    1   BY  1
                          UNTIL ( SYU-IDX                   >     10  )
                            OR  ( LNK-SYU-SKYSTYMD(SYU-IDX) =   SPACE )
                    EVALUATE  FLG-NYUIN-CHECK
                      WHEN     1
                        PERFORM 211D1-NYUIN-SYUNOU-CHECK-SEC
                      WHEN     2
                        PERFORM 211D2-NYUIN-SYUNOU-CHECK2-SEC
                    END-EVALUATE
                  END-PERFORM
              ELSE
                  DISPLAY "SKYSTYMD="   WRK-SEIKYUSTYMD
                  DISPLAY "SKYEDYMD="   WRK-SEIKYUEDYMD
                  DISPLAY "LNK-S02-RC=" LNK-S02-RC
              END-IF
      *
           END-IF
      *
           .
       211D-NYUIN-SYUNOU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集（入院収納チェック）
      *****************************************************************
       211D1-NYUIN-SYUNOU-CHECK-SEC      SECTION.
      *
           INITIALIZE                         HKNCOMBI-REC
           MOVE    RECE02-HOSPNUM       TO    COMB-HOSPNUM
           MOVE    RECE02-PTID          TO    COMB-PTID
           MOVE    LNK-SYU-HKNCOMBINUM(SYU-IDX)
                                        TO    COMB-HKNCOMBINUM
           MOVE    HKNCOMBI-REC         TO    MCPDATA-REC
           PERFORM 900-HKNCOMBI-INV-SEC
           IF      FLG-HKNCOMBI    =   ZERO
              PERFORM VARYING  SYU-IDX2   FROM    1   BY  1
                       UNTIL   SYU-IDX2     >     4
                IF ((RECE02-KOHNUM(SYU-IDX2)  =
                       "015" OR "016" OR "024" OR "079" OR "038") AND
                    (TBL-HKNFTNDATA-JGN(SYU-IDX2)  NOT =  ZERO  ))
                OR ((RECE02-KOHNUM(SYU-IDX2)  =   "052" OR "054") AND
                    (TBL-HKNFTNDATA-JGN(SYU-IDX2)  NOT =  ZERO  ) AND
                    (RECE02-SRYYM            >=   "201501"      ))
                OR ((SYS-1001-PREFNUM  =  23 OR 24              ) AND
                    (RECE02-KOHNUM(SYU-IDX2)  = "152"           ) AND
                    (TBL-HKNFTNDATA-JGN(SYU-IDX2)  NOT =  ZERO  ) AND
                    (RECE02-SRYYM     >= "201104"               ) AND
                    (RECE02-SRYYM     <= "201412"               ))
                OR ((WRK-KOHJGNGET-TEKIYOFLG(SYU-IDX2) =  1     ) AND
                    (TBL-HKNFTNDATA-JGN(SYU-IDX2)  NOT =  ZERO  ))
                  IF  COMB-KOH1HKNNUM  NOT =  SPACE
                  AND COMB-KOH1HKNNUM  =  RECE02-KOHNUM(SYU-IDX2)
                  AND COMB-KOH1ID      =  RECE02-KOHID (SYU-IDX2)
                      ADD   LNK-SYU-KOH1HKNFTNMONEY(SYU-IDX)
                               TO  TBL-HKNFTNDATA-NYUIN(SYU-IDX2)
                  END-IF
                  IF  COMB-KOH2HKNNUM  NOT =  SPACE
                  AND COMB-KOH2HKNNUM  =  RECE02-KOHNUM(SYU-IDX2)
                  AND COMB-KOH2ID      =  RECE02-KOHID (SYU-IDX2)
                      ADD   LNK-SYU-KOH2HKNFTNMONEY(SYU-IDX)
                               TO  TBL-HKNFTNDATA-NYUIN(SYU-IDX2)
                  END-IF
                  IF  COMB-KOH3HKNNUM  NOT =  SPACE
                  AND COMB-KOH3HKNNUM  =  RECE02-KOHNUM(SYU-IDX2)
                  AND COMB-KOH3ID      =  RECE02-KOHID (SYU-IDX2)
                      ADD   LNK-SYU-KOH3HKNFTNMONEY(SYU-IDX)
                               TO  TBL-HKNFTNDATA-NYUIN(SYU-IDX2)
                  END-IF
                  IF  COMB-KOH4HKNNUM  NOT =  SPACE
                  AND COMB-KOH4HKNNUM  =  RECE02-KOHNUM(SYU-IDX2)
                  AND COMB-KOH4ID      =  RECE02-KOHID (SYU-IDX2)
                      ADD   LNK-SYU-KOH4HKNFTNMONEY(SYU-IDX)
                               TO  TBL-HKNFTNDATA-NYUIN(SYU-IDX2)
                  END-IF
                END-IF
              END-PERFORM
           END-IF
      *
           .
       211D1-NYUIN-SYUNOU-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集２（入院収納チェック）
      *****************************************************************
       211D2-NYUIN-SYUNOU-CHECK2-SEC      SECTION.
      *
           INITIALIZE                         HKNCOMBI-REC
           MOVE    RECE02-HOSPNUM       TO    COMB-HOSPNUM
           MOVE    RECE02-PTID          TO    COMB-PTID
           MOVE    LNK-SYU-HKNCOMBINUM(SYU-IDX)
                                        TO    COMB-HKNCOMBINUM
           MOVE    HKNCOMBI-REC         TO    MCPDATA-REC
           PERFORM 900-HKNCOMBI-INV-SEC
           IF      FLG-HKNCOMBI    =   ZERO
             IF   (TBL-CYOFUKU-KOHNUM(IDY4) = COMB-KOH1HKNNUM)
             AND  (TBL-CYOFUKU-KOHID (IDY4) = COMB-KOH1ID    )
               ADD  LNK-SYU-KOH1HKNFTNMONEY(SYU-IDX)
                                        TO  WRK-HKNFTNDATA-RUI
             END-IF
             IF   (TBL-CYOFUKU-KOHNUM(IDY4) = COMB-KOH2HKNNUM)
             AND  (TBL-CYOFUKU-KOHID (IDY4) = COMB-KOH2ID    )
               ADD  LNK-SYU-KOH2HKNFTNMONEY(SYU-IDX)
                                        TO  WRK-HKNFTNDATA-RUI
             END-IF
             IF   (TBL-CYOFUKU-KOHNUM(IDY4) = COMB-KOH3HKNNUM)
             AND  (TBL-CYOFUKU-KOHID (IDY4) = COMB-KOH3ID    )
               ADD  LNK-SYU-KOH3HKNFTNMONEY(SYU-IDX)
                                        TO  WRK-HKNFTNDATA-RUI
             END-IF
             IF   (TBL-CYOFUKU-KOHNUM(IDY4) = COMB-KOH4HKNNUM)
             AND  (TBL-CYOFUKU-KOHID (IDY4) = COMB-KOH4ID    )
               ADD  LNK-SYU-KOH4HKNFTNMONEY(SYU-IDX)
                                        TO  WRK-HKNFTNDATA-RUI
             END-IF
           END-IF
      *
           .
       211D2-NYUIN-SYUNOU-CHECK2-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集（上限置き換え金額編集）
      *****************************************************************
       211F1-JGNGAK-SET-SEC      SECTION.
      *
      *    ＜特定疾患給付対象療養は所得区分に準ずるが、一般所得の
      *      金額を超える上限額が平成２６年１２月まではなかった。＞
      *    ＜高齢者の上位所得者について、平成２７年１月以降で、
      *      一般所得の金額を超える上限額ができた為、修正した。  ＞
           IF    RECE02-SRYYM  >=  "201808"
               IF   (TBL-TOKUSITUFLG(IDX10) =   1               )
               AND  (RECE02-HOJOKBN         =  "3" OR "6" OR "7")
                 MOVE   80100    TO   WRK-KOH-GENDOGAKU
                 IF  FLG-KOHYONKAIME = 1
                   MOVE 44400    TO   WRK-KOH-GENDOGAKU
                 END-IF
               ELSE
                 MOVE   18000    TO   WRK-KOH-GENDOGAKU
               END-IF
           ELSE
             IF  RECE02-SRYYM  >=  "201708"
               IF   (TBL-TOKUSITUFLG(IDX10) =   1               )
               AND  (RECE02-HOJOKBN         =  "3" OR "6" OR "7")
                 MOVE   57600    TO   WRK-KOH-GENDOGAKU
               ELSE
                 MOVE   14000    TO   WRK-KOH-GENDOGAKU
               END-IF
             ELSE
               IF   (TBL-TOKUSITUFLG(IDX10) =   1               )
               AND  (RECE02-HOJOKBN         =  "3" OR "6" OR "7")
               AND  (RECE02-SRYYM          >=  "201501"         )
                 MOVE   44400    TO   WRK-KOH-GENDOGAKU
               ELSE
                 MOVE   12000    TO   WRK-KOH-GENDOGAKU
               END-IF
             END-IF
           END-IF
           IF  RECE02-TEISYOTOKU  NOT =  SPACE
             MOVE      8000    TO   WRK-KOH-GENDOGAKU
           END-IF
      *
           IF   ( RECE02-KOHNUM(1)  =   "972" )
           OR   ( RECE02-KOHNUM(2)  =   "972" )
           OR   ( RECE02-KOHNUM(3)  =   "972" )
           OR   ( RECE02-KOHNUM(4)  =   "972" )
              IF   WRK-KOH-GENDOGAKU  >  10000
                  MOVE   10000    TO   WRK-KOH-GENDOGAKU
              END-IF
           END-IF
           IF   ( RECE02-KOHNUM(1)  =   "974" )
           OR   ( RECE02-KOHNUM(2)  =   "974" )
           OR   ( RECE02-KOHNUM(3)  =   "974" )
           OR   ( RECE02-KOHNUM(4)  =   "974" )
              IF   WRK-KOH-GENDOGAKU  >  20000
                  MOVE   20000    TO   WRK-KOH-GENDOGAKU
              END-IF
           END-IF
      *
           MOVE      ZERO         TO   WRK-GEN70-GENDOGAKU
           IF     FLG-GENBUTU70   NOT =  ZERO
              EVALUATE   FLG-GENBUTU70
                WHEN        1
                WHEN        2
                  MOVE     80100  TO   WRK-GEN70-GENDOGAKU
                  IF   TBL-TOKUSITUFLG(IDX10) = 1
                    IF  FLG-KOHYONKAIME = 1
                       MOVE  44400  TO   WRK-GEN70-GENDOGAKU
                    END-IF
                  ELSE
                    IF  FLG-KOHYONKAIME = 1
                       MOVE  44400  TO   WRK-GEN70-GENDOGAKU
                    END-IF
                  END-IF
                WHEN        3
                  MOVE     35400  TO   WRK-GEN70-GENDOGAKU
                  IF   TBL-TOKUSITUFLG(IDX10) = 1
                    IF  FLG-KOHYONKAIME = 1
                       MOVE  24600  TO   WRK-GEN70-GENDOGAKU
                    END-IF
                  ELSE
                    IF  FLG-KOHYONKAIME = 1
                       MOVE  24600  TO   WRK-GEN70-GENDOGAKU
                    END-IF
                  END-IF
              END-EVALUATE
              IF   ( RECE02-KOHNUM(1)  =   "972" )
              OR   ( RECE02-KOHNUM(2)  =   "972" )
              OR   ( RECE02-KOHNUM(3)  =   "972" )
              OR   ( RECE02-KOHNUM(4)  =   "972" )
                 IF   WRK-GEN70-GENDOGAKU  >  10000
                     MOVE  10000  TO   WRK-GEN70-GENDOGAKU
                 END-IF
              END-IF
              IF   ( RECE02-KOHNUM(1)  =   "974" )
              OR   ( RECE02-KOHNUM(2)  =   "974" )
              OR   ( RECE02-KOHNUM(3)  =   "974" )
              OR   ( RECE02-KOHNUM(4)  =   "974" )
                 IF   WRK-GEN70-GENDOGAKU  >  20000
                     MOVE  20000  TO   WRK-GEN70-GENDOGAKU
                 END-IF
              END-IF
           END-IF
      *
           MOVE       8000        TO   WRK-SEIHO-GENDO
           IF  FLG-KOHYONKAIME = 1
              MOVE   24600        TO   WRK-SEIHO-GENDO70
           ELSE
              MOVE   35400        TO   WRK-SEIHO-GENDO70
           END-IF
           MOVE      10000        TO   WRK-CYOKI-GENDO
           MOVE      20000        TO   WRK-CYOKI-GENDO2
      *
           IF   FLG-GENGAKU-OKIKAE  =  1
             IF  FLG-TOKU75 = 1 OR 2 OR 3
               COMPUTE  WRK-KOH-GENDOGAKU   = WRK-KOH-GENDOGAKU
                                            / 2
               COMPUTE  WRK-GEN70-GENDOGAKU = WRK-GEN70-GENDOGAKU
                                            / 2
               COMPUTE  WRK-SEIHO-GENDO     = WRK-SEIHO-GENDO
                                            / 2
               COMPUTE  WRK-SEIHO-GENDO70   = WRK-SEIHO-GENDO70
                                            / 2
               COMPUTE  WRK-CYOKI-GENDO     = WRK-CYOKI-GENDO
                                            / 2
               COMPUTE  WRK-CYOKI-GENDO2    = WRK-CYOKI-GENDO2
                                            / 2
             END-IF
           END-IF
      *
           .
       211F1-JGNGAK-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費上限額編集２
      *****************************************************************
       211F-JGNCHK-HENSYU2-SEC      SECTION.
      *
           MOVE      ZERO    TO     FLG-GENGAKU-OKIKAE
           MOVE      IDY2    TO     IDX10
           PERFORM   211F1-JGNGAK-SET-SEC
      *
           IF  (RECE02-ZAITAKU            =   "1")
           OR  (RECE02-KOUREI-HANTEIFLG   =   "1")
               IF  TBL-HKNFTNDATA-ZAN(IDY2)  >  WRK-KOH-GENDOGAKU
                 MOVE WRK-KOH-GENDOGAKU   TO TBL-HKNFTNDATA-ZAN(IDY2)
               END-IF
           END-IF
           IF  FLG-GENBUTU70   NOT =   ZERO
               IF  TBL-HKNFTNDATA-ZAN(IDY2)  >  WRK-GEN70-GENDOGAKU
                 MOVE WRK-GEN70-GENDOGAKU TO TBL-HKNFTNDATA-ZAN(IDY2)
               END-IF
           END-IF
           IF   (RECE02-KOHNUM(1) = "972")
           OR   (RECE02-KOHNUM(2) = "972")
           OR   (RECE02-KOHNUM(3) = "972")
           OR   (RECE02-KOHNUM(4) = "972")
               IF  TBL-HKNFTNDATA-ZAN(IDY2)  >  WRK-CYOKI-GENDO
                 MOVE WRK-CYOKI-GENDO     TO TBL-HKNFTNDATA-ZAN(IDY2)
               END-IF
           END-IF
           IF   (RECE02-KOHNUM(1) = "974")
           OR   (RECE02-KOHNUM(2) = "974")
           OR   (RECE02-KOHNUM(3) = "974")
           OR   (RECE02-KOHNUM(4) = "974")
               IF  TBL-HKNFTNDATA-ZAN(IDY2)  >  WRK-CYOKI-GENDO2
                 MOVE WRK-CYOKI-GENDO2    TO TBL-HKNFTNDATA-ZAN(IDY2)
               END-IF
           END-IF
      *
           .
       211F-JGNCHK-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者特記事項編集
      *****************************************************************
       211G-PTTOKKI-HENSYU-SEC      SECTION.
      *
           INITIALIZE                TBL-PTTOKKI
      *
           MOVE      ZERO      TO    TOKKI-IDX2
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL   TOKKI-IDX   >      5
               IF (( RECE02-PTTOKKI-CD(TOKKI-IDX)    = SPACE ) AND
                   ( RECE02-PTTOKKI-NAIYO(TOKKI-IDX) = SPACE ))
               OR (( RECE02-PTTOKKI-CD(TOKKI-IDX) = "15"     ) AND
                   ((RECE02-SRYYM   <  "200608") OR
                    (RECE02-SRYYM   >  "200812")             ))
               OR (( RECE02-PTTOKKI-CD(TOKKI-IDX) = "16"     ) AND
                   ( RECE02-SRYYM   <  "200610"              ))
               OR (( RECE02-PTTOKKI-CD(TOKKI-IDX) =
                                    "17" OR "18" OR "19"     ) AND
                   ((RECE02-SRYYM   <  "200704") OR
                    (RECE02-SRYYM   >  "201807")             ))
               OR (( RECE02-PTTOKKI-CD(TOKKI-IDX) = "20"     ) AND
                   ((RECE02-SRYYM   <  "200804") OR
                    (RECE02-SRYYM   >  "201903")             ))
               OR (( RECE02-PTTOKKI-CD(TOKKI-IDX) = "21"     ) AND
                   ( RECE02-SRYYM   <  "200901"              ))
                 CONTINUE
               ELSE
                 ADD    1     TO    TOKKI-IDX2
                 MOVE   RECE02-PTTOKKI-CD(TOKKI-IDX)    TO
                                    TBL-PTTOKKI-CD(TOKKI-IDX2)
                 MOVE   RECE02-PTTOKKI-NAIYO(TOKKI-IDX) TO
                                    TBL-PTTOKKI-NAIYO(TOKKI-IDX2)
      *
                 IF    RECE02-KOUREI-HANTEIFLG  =  "1"
                   IF  RECE02-SRYYM  >=  "201808"
                     EVALUATE  WRK-TOKUSITU-TOKKI
                       WHEN      "26"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "27" OR "28" OR "29" OR "30"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                       WHEN      "27"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "26" OR "28" OR "29" OR "30"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                       WHEN      "28"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "26" OR "27" OR "29" OR "30"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                       WHEN      "29"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "26" OR "27" OR "28" OR "30"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                       WHEN      "30"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "26" OR "27" OR "28" OR "29"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                     END-EVALUATE
                   ELSE
                     EVALUATE  WRK-TOKUSITU-TOKKI
                       WHEN      "17"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "18" OR "19"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                       WHEN      "18"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "17" OR "19"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                       WHEN      "19"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "17" OR "18"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                     END-EVALUATE
                   END-IF
                 ELSE
                   IF  RECE02-SRYYM  >=  "201501"
                     EVALUATE  WRK-TOKUSITU-TOKKI
                       WHEN      "26"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "27" OR "28" OR "29" OR "30"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                       WHEN      "27"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "26" OR "28" OR "29" OR "30"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                       WHEN      "28"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "26" OR "27" OR "29" OR "30"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                       WHEN      "29"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "26" OR "27" OR "28" OR "30"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                       WHEN      "30"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "26" OR "27" OR "28" OR "29"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                     END-EVALUATE
                   ELSE
                     EVALUATE  WRK-TOKUSITU-TOKKI
                       WHEN      "17"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "18" OR "19"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                       WHEN      "18"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "17" OR "19"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                       WHEN      "19"
                         IF   RECE02-PTTOKKI-CD(TOKKI-IDX) =
                              "17" OR "18"
                           MOVE   WRK-TOKUSITU-TOKKI  TO
                                          WRK-TOKUSITU-TOKKI2
                         END-IF
                     END-EVALUATE
                   END-IF
                 END-IF
               END-IF
           END-PERFORM
      *
           INITIALIZE                RECE02-PTTOKKI-AREA
      *
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL   TOKKI-IDX   >      5
                 MOVE   TBL-PTTOKKI-CD(TOKKI-IDX)       TO
                                    RECE02-PTTOKKI-CD(TOKKI-IDX)
                 MOVE   TBL-PTTOKKI-NAIYO(TOKKI-IDX)    TO
                                    RECE02-PTTOKKI-NAIYO(TOKKI-IDX)
           END-PERFORM
      *
      ***
      *
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL   TOKKI-IDX   >      5
             IF    RECE02-KOUREI-HANTEIFLG  =  "1"
               IF  RECE02-SRYYM  >=  "201808"
                 EVALUATE  WRK-TOKUSITU-TOKKI
                   WHEN      "26"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "27" OR "28" OR "29" OR "30"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                   WHEN      "27"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "26" OR "28" OR "29" OR "30"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                   WHEN      "28"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "26" OR "27" OR "29" OR "30"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                   WHEN      "29"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "26" OR "27" OR "28" OR "30"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                   WHEN      "30"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "26" OR "27" OR "28" OR "29"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                 END-EVALUATE
               ELSE
                 EVALUATE  WRK-TOKUSITU-TOKKI
                   WHEN      "17"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "18" OR "19"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                   WHEN      "18"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "17" OR "19"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                   WHEN      "19"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "17" OR "18"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                 END-EVALUATE
               END-IF
             ELSE
               IF  RECE02-SRYYM  >=  "201501"
                 EVALUATE  WRK-TOKUSITU-TOKKI
                   WHEN      "26"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "27" OR "28" OR "29" OR "30"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                   WHEN      "27"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "26" OR "28" OR "29" OR "30"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                   WHEN      "28"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "26" OR "27" OR "29" OR "30"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                   WHEN      "29"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "26" OR "27" OR "28" OR "30"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                   WHEN      "30"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "26" OR "27" OR "28" OR "29"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                 END-EVALUATE
               ELSE
                 EVALUATE  WRK-TOKUSITU-TOKKI
                   WHEN      "17"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "18" OR "19"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                   WHEN      "18"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "17" OR "19"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                   WHEN      "19"
                     IF   RECE02-TOKKI(TOKKI-IDX) =
                          "17" OR "18"
                       MOVE   WRK-TOKUSITU-TOKKI  TO
                                      WRK-TOKUSITU-TOKKI2
                     END-IF
                 END-EVALUATE
               END-IF
             END-IF
           END-PERFORM
      *
      ***
      *
           INITIALIZE                TBL-TOKKI
      *
           MOVE      ZERO      TO    TOKKI-IDX2
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL   TOKKI-IDX   >      5
               IF  (RECE02-TOKKI(TOKKI-IDX) = SPACE              )
               OR  (RECE02-TOKKI(TOKKI-IDX) = WRK-TOKUSITU-TOKKI2)
                 CONTINUE
               ELSE
                 ADD    1      TO    TOKKI-IDX2
                 MOVE   RECE02-TOKKI(TOKKI-IDX)   TO
                                     TBL-TOKKI-CD(TOKKI-IDX2)
               END-IF
           END-PERFORM
      *
           MOVE      SPACE     TO    RECE02-TOKKI(1)
           MOVE      SPACE     TO    RECE02-TOKKI(2)
           MOVE      SPACE     TO    RECE02-TOKKI(3)
           MOVE      SPACE     TO    RECE02-TOKKI(4)
           MOVE      SPACE     TO    RECE02-TOKKI(5)
      *
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL   TOKKI-IDX   >      5
                 MOVE   TBL-TOKKI-CD(TOKKI-IDX)   TO
                                     RECE02-TOKKI(TOKKI-IDX)
           END-PERFORM
      *
           .
       211G-PTTOKKI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    減額・免除・支払猶予者の判定
      *****************************************************************
       2117-GENGAKU-HANTEI-SEC      SECTION.
      *
           IF   (RECE02-SRYYM       >=  "200610")
           AND  (RECE02-HKNNUM   NOT =   SPACE  )
      *
            IF  (RECE02-HKNNUM(1:2)  =   "98"  OR "90"  OR "91" )
              CONTINUE
            ELSE
              MOVE      RECE02-SRYYM          TO   WK-GENGAKU-YM
              IF   RECE02-TEKSTYMD(1:6)  >=  RECE02-SRYYM
                 MOVE   RECE02-TEKSTYMD(7:2)  TO   WK-GENGAKU-DD
              ELSE
                 MOVE   01                    TO   WK-GENGAKU-DD
              END-IF
      *
              MOVE      RECE02-SRYYM          TO   WK-GENGAKU2-YM
              IF   RECE02-TEKEDYMD-X(1:6) >  RECE02-SRYYM
                 INITIALIZE                        STS-AREA-DAY
                 INITIALIZE                        LNK-DAY7-AREA
                 MOVE   "71"                  TO   LNK-DAY7-IRAI
                 MOVE   RECE02-SRYYM          TO   LNK-DAY7-YM
                 CALL   "ORCSDAY"          USING   STS-AREA-DAY
                                                   LNK-DAY7-AREA
                 MOVE   LNK-DAY7-KOYOMI       TO   WRK-EDYMD
                 MOVE   WRK-EDYMD(7:2)        TO   WK-GENGAKU2-DD
              ELSE
                 MOVE   RECE02-TEKEDYMD-X(7:2)
                                              TO   WK-GENGAKU2-DD
              END-IF
      *
              MOVE      RECE02-SRYYM          TO   WK-GENGAKU3-YM
              IF   RECE02-TEKSTYMD-X(1:6)  >=  RECE02-SRYYM
                 MOVE   RECE02-TEKSTYMD-X(7:2)
                                              TO   WK-GENGAKU3-DD
              ELSE
                 MOVE   01                    TO   WK-GENGAKU3-DD
              END-IF
      *
              PERFORM  21171-GENGAKU-HENSYU-SEC
      *
            END-IF
      *
            IF   (WK-GENGAKUKBN        =   2      )
            AND  (RECE02-SRYYM         <  "201204")
                   MOVE     ZERO    TO    WK-GENGAKUKBN
            END-IF
      *
            IF   RECE02-SRYYM   >=  "201007"
              PERFORM  211L-SAIGAI-TAISYO-HANTEI-SEC
            END-IF
      *
            IF   RECE02-HKNNUM   =   "068" OR "069" OR "040"
             IF   RECE02-SRYYM  >=   "201101"
              IF   (WK-GENGAKUKBN      =   3 OR 4)
              AND  (FLG-SAIGAI-TAISYO  =   1     )
                CONTINUE
              ELSE
                MOVE     ZERO    TO    WK-GENGAKUKBN
              END-IF
             ELSE
                MOVE     ZERO    TO    WK-GENGAKUKBN
                MOVE     ZERO    TO    FLG-SAIGAI-TAISYO
             END-IF
            END-IF
      *
            IF   RECE02-HKNNUM   =   "004"
            AND  RECE02-SRYYM   >=   "201101"
              IF  RECE02-HKNJANUM(1:4) = "0404"
                CONTINUE
              ELSE
                MOVE     ZERO    TO    WK-GENGAKUKBN
              END-IF
            END-IF
      *
           END-IF
      *
      ***
      *
           IF   (RECE02-SRYYM       >=  "201101")
           AND  (RECE02-HKNNUM       =   SPACE  )
      *
            MOVE      RECE02-SRYYM       TO   WK-GENGAKU-YM
            IF   RECE02-KOHTEKSTYMD(1)(1:6)
                                       >=  RECE02-SRYYM
               MOVE   RECE02-KOHTEKSTYMD(1)(7:2)
                                         TO   WK-GENGAKU-DD
            ELSE
               MOVE   01                 TO   WK-GENGAKU-DD
            END-IF
      *
            MOVE      RECE02-SRYYM       TO   WK-GENGAKU2-YM
            IF   RECE02-KOHTEKEDYMD(1)(1:6)
                                        >  RECE02-SRYYM
              INITIALIZE                      STS-AREA-DAY
              INITIALIZE                      LNK-DAY7-AREA
              MOVE   "71"                TO   LNK-DAY7-IRAI
              MOVE   RECE02-SRYYM        TO   LNK-DAY7-YM
              CALL   "ORCSDAY"         USING  STS-AREA-DAY
                                              LNK-DAY7-AREA
              MOVE   LNK-DAY7-KOYOMI     TO   WRK-EDYMD
              MOVE   WRK-EDYMD(7:2)      TO   WK-GENGAKU2-DD
            ELSE
              MOVE   RECE02-KOHTEKEDYMD(1)(7:2)
                                         TO   WK-GENGAKU2-DD
            END-IF
      *
            MOVE     "99999999"          TO   WK-GENGAKU3-YMD
      *
            PERFORM  21171-GENGAKU-HENSYU-SEC
      *
            PERFORM  211L-SAIGAI-TAISYO-HANTEI-SEC
      *
            IF   (WK-GENGAKUKBN      =   3 OR 4)
            AND  (FLG-SAIGAI-TAISYO  =   1     )
              CONTINUE
            ELSE
              MOVE     ZERO    TO    WK-GENGAKUKBN
            END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN   =   1   OR   2   OR   5
      *
      *       公費月上限額取得
              INITIALIZE                  LNK-ORCSJGNGET-REC
grpsys        MOVE  RECE02-HOSPNUM    TO  LNK-ORCSJGNGET-HOSPNUM
              MOVE  RECE02-NYUGAIKBN  TO  LNK-ORCSJGNGET-NYUGAIKBN
              MOVE  RECE02-PTID       TO  LNK-ORCSJGNGET-PTID
              EVALUATE   WK-GENGAKUKBN
                WHEN         1
                   MOVE    "960"      TO  LNK-ORCSJGNGET-KOHHKNNUM
                WHEN         2
                   MOVE    "961"      TO  LNK-ORCSJGNGET-KOHHKNNUM
                WHEN         5
                   MOVE    "953"      TO  LNK-ORCSJGNGET-KOHHKNNUM
              END-EVALUATE
              MOVE  WK-GENGAKU-KOHID  TO  LNK-ORCSJGNGET-KOHID
              MOVE  RECE02-SRYYM      TO  LNK-ORCSJGNGET-SRYYM
      *
              CALL    "ORCSJGNGET"    USING
                                      LNK-ORCSJGNGET-REC
                                      SPA-AREA 
      *
              IF    LNK-ORCSJGNGET-RC   =   ZERO
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                      MOVE    LNK-ORCSJGNGET-GAIJGNGAK
                                       TO  WK-GENGAKU-RITU
                      IF   WK-GENGAKU-RITU  >  100
                          MOVE   100   TO  WK-GENGAKU-RITU
                      END-IF
                      IF   WK-GENGAKU-RITU  =  ZERO
                          MOVE   ZERO  TO  WK-GENGAKUKBN
                      END-IF
                   WHEN          2
                      MOVE    LNK-ORCSJGNGET-GAIJGNGAK
                                       TO  WK-GENGAKU-KIN
                                           WK-GENGAKU-KIN2
                                           WK-GENGAKU-KIN3
                      IF   WK-GENGAKU-KIN   =  ZERO
                          MOVE   ZERO  TO  WK-GENGAKUKBN
                      END-IF
                      COMPUTE  WK-GENGAKU-KIN  = WK-GENGAKU-KIN  +  5
                      COMPUTE  WK-GENGAKU-KIN  = WK-GENGAKU-KIN  / 10
                      COMPUTE  WK-GENGAKU-KIN  = WK-GENGAKU-KIN  * 10
                      COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN2 +  5
                      COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN2 / 10
                      COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN2 * 10
                      COMPUTE  WK-GENGAKU-KIN3 = WK-GENGAKU-KIN3 +  5
                      COMPUTE  WK-GENGAKU-KIN3 = WK-GENGAKU-KIN3 / 10
                      COMPUTE  WK-GENGAKU-KIN3 = WK-GENGAKU-KIN3 * 10
                   WHEN          5
                      MOVE    LNK-ORCSJGNGET-GAIJGNGAK
                                       TO  WK-GENGAKU-KIN
                                           WK-GENGAKU-KIN2
                                           WK-GENGAKU-KIN3
                      IF   WK-GENGAKU-KIN   =  9999999 OR 999999
                        MOVE     ZERO  TO  WK-GENGAKUKBN
                        MOVE     ZERO  TO  WK-GENGAKU-KIN
                        MOVE     ZERO  TO  WK-GENGAKU-KIN2
                        MOVE     ZERO  TO  WK-GENGAKU-KIN3
                      ELSE
                        COMPUTE  WK-GENGAKU-KIN  = WK-GENGAKU-KIN  +  5
                        COMPUTE  WK-GENGAKU-KIN  = WK-GENGAKU-KIN  / 10
                        COMPUTE  WK-GENGAKU-KIN  = WK-GENGAKU-KIN  * 10
                        COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN2 +  5
                        COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN2 / 10
                        COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN2 * 10
                        COMPUTE  WK-GENGAKU-KIN3 = WK-GENGAKU-KIN3 +  5
                        COMPUTE  WK-GENGAKU-KIN3 = WK-GENGAKU-KIN3 / 10
                        COMPUTE  WK-GENGAKU-KIN3 = WK-GENGAKU-KIN3 * 10
                      END-IF
                 END-EVALUATE
              END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
              EVALUATE   WK-GENGAKUKBN
      *           減額（割）
                  WHEN        1
                     MOVE    1                TO  RECE02-GENMENKBN
                     IF   WK-GENGAKUKBN-KEISAN  =  2
                       IF  RECE02-KYURATE  <= WK-GENGAKU-RITU
                          MOVE   100          TO  RECE02-GENGAKURATE
                       ELSE
      *****>              COMPUTE  WK-GENGAKU-RITU-KEISAN =
      *****>                      (WK-GENGAKU-RITU  /  RECE02-KYURATE)
      *****>                                        +  0.009
      *****>              COMPUTE  RECE02-GENGAKURATE =
      *****>                       WK-GENGAKU-RITU-KEISAN * 100
                          MOVE  WK-GENGAKU-RITU
                                              TO  RECE02-GENGAKURATE
                       END-IF
                     ELSE
                       MOVE  WK-GENGAKU-RITU  TO  RECE02-GENGAKURATE
                     END-IF
      *           減額（円）
                  WHEN        2
                     MOVE    1                TO  RECE02-GENMENKBN
                     MOVE    WK-GENGAKU-KIN   TO  RECE02-GENGAKU
      *           免除
                  WHEN        3
                     MOVE    2                TO  RECE02-GENMENKBN
      *           支払猶予
                  WHEN        4
                     MOVE    3                TO  RECE02-GENMENKBN
      *           減額（円超）
                  WHEN        5
                     MOVE    1                TO  RECE02-GENMENKBN
                     MOVE    WK-GENGAKU-KIN   TO  RECE02-GENGAKU
              END-EVALUATE
      *
              MOVE   WK-GENGAKU-KTKBN         TO  RECE02-GENMEN-COM
           END-IF
      *
           .
       2117-GENGAKU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    減額・免除・支払猶予者の編集
      *****************************************************************
       21171-GENGAKU-HENSYU-SEC      SECTION.
      *
           MOVE     SPACE    TO     WK-CHECK-TEKSTYMD
           MOVE     SPACE    TO     WK-CHECK-TEKEDYMD
      *
           PERFORM   VARYING   GEN-IDX   FROM   1    BY   1
                      UNTIL   (GEN-IDX    >    TBL-GENGAKU-MAX)
                        OR    (WK-GENGAKUKBN   NOT = ZERO     )
             INITIALIZE                       PTKOHINF-REC
             MOVE    RECE02-HOSPNUM       TO  PTKOH-HOSPNUM
             MOVE    RECE02-PTID          TO  PTKOH-PTID
             MOVE    TBL-GENGAKU(GEN-IDX) TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC         TO  MCPDATA-REC
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC               =   ZERO
               MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
               MOVE    "key4"               TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WK-GENGAKU-YMD ) AND
                      (WK-GENGAKU-YMD  <=   PTKOH-TEKEDYMD ) AND
                      (PTKOH-SAKJOKBN   =   SPACE          ))
                  OR ((PTKOH-TEKSTYMD  <=   WK-GENGAKU2-YMD) AND
                      (WK-GENGAKU2-YMD <=   PTKOH-TEKEDYMD ) AND
                      (PTKOH-SAKJOKBN   =   SPACE          ))
                  OR ((PTKOH-TEKSTYMD  <=   WK-GENGAKU3-YMD) AND
                      (WK-GENGAKU3-YMD <=   PTKOH-TEKEDYMD ) AND
                      (WK-GENGAKU3-YMD NOT = "99999999"    ) AND
                      (PTKOH-SAKJOKBN   =   SPACE          ))
                      EVALUATE   GEN-IDX
                        WHEN        1
                          MOVE   1           TO  WK-GENGAKUKBN
                          MOVE   PTKOH-KOHID TO  WK-GENGAKU-KOHID
                        WHEN        2
                          MOVE   2           TO  WK-GENGAKUKBN
                          MOVE   PTKOH-KOHID TO  WK-GENGAKU-KOHID
                        WHEN        3
                          MOVE   3           TO  WK-GENGAKUKBN
                        WHEN        4
                          MOVE   4           TO  WK-GENGAKUKBN
                        WHEN        5
                          MOVE   5           TO  WK-GENGAKUKBN
                          MOVE   PTKOH-KOHID TO  WK-GENGAKU-KOHID
                      END-EVALUATE
      *
                      IF  RECE02-HKNJANUM  =  "270280" OR "67270280"
                        IF     PTKOH-JKYSNUM(1:1)  = "1"
                          MOVE   1           TO  WK-GENGAKU-KTKBN
                        END-IF
                        IF     PTKOH-JKYSNUM(1:1)  = "2"
                          MOVE   2           TO  WK-GENGAKU-KTKBN
                        END-IF
                      END-IF
      *
                      IF    WK-GENGAKUKBN  =  1
                        IF     PTKOH-FTNJANUM(1:1) = "1"
                          MOVE   1           TO  WK-GENGAKUKBN-KEISAN
                        END-IF
                        IF     PTKOH-FTNJANUM(1:1) = "2"
                          MOVE   2           TO  WK-GENGAKUKBN-KEISAN
                        END-IF
                      END-IF
      *
                      MOVE  PTKOH-TEKSTYMD   TO  WK-CHECK-TEKSTYMD
                      IF    PTKOH-TEKSTYMD(1:6)  <  RECE02-SRYYM
                        MOVE  RECE02-SRYYM   TO  WK-CHECK-TEKSTYMD(1:6)
                        MOVE  "01"           TO  WK-CHECK-TEKSTYMD(7:2)
                      END-IF
                      MOVE  PTKOH-TEKEDYMD   TO  WK-CHECK-TEKEDYMD
                      IF    PTKOH-TEKEDYMD(1:6)  >  RECE02-SRYYM
                        MOVE  RECE02-SRYYM   TO  WK-CHECK-TEKEDYMD(1:6)
                        MOVE  "31"           TO  WK-CHECK-TEKEDYMD(7:2)
                      END-IF
      *
                      MOVE       1           TO  FLG-PTKOHINF
                  ELSE
                      MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                      MOVE    "key4"               TO  MCP-PATHNAME
                      PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-PERFORM
      *
           MOVE     ZERO      TO  FLG-CHECK-ARI
           IF   WK-GENGAKUKBN  NOT =  ZERO
              PERFORM  211711-GENGAKU-CHECK-SEC
              IF   FLG-CHECK-ARI  =  ZERO
                  MOVE  ZERO  TO  WK-GENGAKUKBN
              END-IF
           END-IF
      *
           .
       21171-GENGAKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    減額・免除・支払猶予者のチェック
      *****************************************************************
       211711-GENGAKU-CHECK-SEC      SECTION.
      *
           PERFORM  VARYING  IDX35   FROM    1   BY  1
                     UNTIL  (IDX35                   >   10 )
                      OR    (RECE02-HKNCOMBI(IDX35)  =  ZERO)
                      OR    (FLG-CHECK-ARI           =   1  )
             IF   RECE02-DAISANFLG(IDX35)   =   1
               CONTINUE
             ELSE
               INITIALIZE                       SYUNOU-REC
               MOVE  RECE02-HOSPNUM         TO  SYU-HOSPNUM
               MOVE  RECE02-NYUGAIKBN       TO  SYU-NYUGAIKBN
               MOVE  RECE02-PTID            TO  SYU-PTID
               MOVE  RECE02-SRYYM           TO  SYU-SRYYMD(1:6)
               MOVE  "__"                   TO  SYU-SRYYMD(7:2)
               MOVE  RECE02-HKNCOMBI(IDX35) TO  SYU-HKNCOMBINUM
               MOVE  SYUNOU-REC             TO  MCPDATA-REC
               MOVE  "tbl_syunou"           TO  MCP-TABLE
               MOVE  "key41"                TO  MCP-PATHNAME
               PERFORM 900-DBSELECT-SEC
               IF    MCP-RC   =   ZERO
                 MOVE    "tbl_syunou"       TO  MCP-TABLE
                 MOVE    "key41"            TO  MCP-PATHNAME
                 PERFORM  900-SYUNOU-READ-SEC
                 PERFORM  UNTIL  (FLG-SYUNOU      =  1)
                           OR    (FLG-CHECK-ARI   =  1)
                   IF    SYU-DENPJTIKBN    NOT =  "3"
                     IF  (WK-CHECK-TEKSTYMD <= SYU-SRYYMD       )
                     AND (SYU-SRYYMD        <= WK-CHECK-TEKEDYMD)
                        MOVE   1   TO   FLG-CHECK-ARI
                     END-IF
                   END-IF
                   MOVE    "tbl_syunou"     TO  MCP-TABLE
                   MOVE    "key41"          TO  MCP-PATHNAME
                   PERFORM  900-SYUNOU-READ-SEC
                 END-PERFORM
               END-IF
               MOVE      "tbl_syunou"       TO  MCP-TABLE
               MOVE      "key41"            TO  MCP-PATHNAME
               PERFORM    900-CLOSE-SEC
             END-IF
           END-PERFORM
      *
           .
       211711-GENGAKU-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    高齢者高額現物給付対象者の所得区分編集
      *****************************************************************
       2121-KOUREI-GENBUTU-HENSYU-SEC      SECTION.
      *
           MOVE      SPACE    TO   WRK-SENIN-HOJOKBN
           IF   (RECE02-HKNNUM  = "002"            )
           AND  (RECE02-HOJOKBN = "1" OR "2" OR "3")
             INITIALIZE                    PTHKNINF-REC
             MOVE    RECE02-HOSPNUM    TO  PTHKN-HOSPNUM
             MOVE    RECE02-PTID       TO  PTHKN-PTID
             MOVE    RECE02-HKNID      TO  PTHKN-HKNID
             MOVE    PTHKNINF-REC      TO  MCPDATA-REC
             PERFORM 900-PTHKNINF-INV-SEC
             IF      FLG-PTHKNINF      =   ZERO
               MOVE  PTHKN-HOJOKBN     TO  WRK-SENIN-HOJOKBN
             END-IF
           END-IF
      *
           IF  ( RECE02-KYURATE =  30               )
           OR  ((RECE02-HKNNUM  = "002"            ) AND
                (RECE02-HOJOKBN = "G" OR "H" OR "I"))
           OR  ((RECE02-HKNNUM  = "031" OR "032" OR
                                  "033" OR "034"   ) AND
                (RECE02-HOJOKBN = "H"              ))
           OR  ((RECE02-HKNNUM  = "002"            ) AND
                (WRK-SENIN-HOJOKBN
                                = "G" OR "H" OR "I"))
             MOVE     1      TO      FLG-KOUREI-GENEKIKBN
      *
             MOVE     RECE02-SRYYM            TO   WRK-GEN70-YM
             IF   RECE02-TEKSTYMD(1:6)    >=  RECE02-SRYYM
               MOVE   RECE02-TEKSTYMD(7:2)    TO   WRK-GEN70-DD
             ELSE
               MOVE   01                      TO   WRK-GEN70-DD
             END-IF
      *
             MOVE     RECE02-SRYYM            TO   WRK-GEN702-YM
             IF   RECE02-TEKSTYMD-X(1:6)  >=  RECE02-SRYYM
               MOVE   RECE02-TEKSTYMD-X(7:2)  TO   WRK-GEN702-DD
             ELSE
               MOVE   01                      TO   WRK-GEN702-DD
             END-IF
      *
             INITIALIZE                       PTKOHINF-REC
             MOVE    RECE02-HOSPNUM       TO  PTKOH-HOSPNUM
             MOVE    RECE02-PTID          TO  PTKOH-PTID
             MOVE    "946"                TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC         TO  MCPDATA-REC
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key14"              TO  MCP-PATHNAME
             PERFORM  900-DBSELECT-SEC
             IF      MCP-RC  =  ZERO
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key14"            TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL  FLG-PTKOHINF  =  1
                 IF ((PTKOH-TEKSTYMD  <=  WRK-GEN70-YMD ) AND
                     (WRK-GEN70-YMD   <=  PTKOH-TEKEDYMD) AND
                     (PTKOH-SAKJOKBN   =  SPACE         ))
                 OR ((PTKOH-TEKSTYMD  <=  WRK-GEN702-YMD) AND
                     (WRK-GEN702-YMD  <=  PTKOH-TEKEDYMD) AND
                     (PTKOH-SAKJOKBN   =  SPACE         ))
                   IF  (PTKOH-JKYSNUM(1:2) = "２")
                   OR  (PTKOH-JKYSNUM(1:1) = "2" )
                       MOVE    2   TO  FLG-KOUREI-GENEKIKBN
                   ELSE
                     IF  (PTKOH-JKYSNUM(1:2) = "１")
                     OR  (PTKOH-JKYSNUM(1:1) = "1" )
                       MOVE    3   TO  FLG-KOUREI-GENEKIKBN
                     ELSE
                       MOVE    1   TO  FLG-KOUREI-GENEKIKBN
                     END-IF
                   END-IF
                   MOVE     1      TO  FLG-PTKOHINF
                 ELSE
                   MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                   MOVE    "key14"            TO  MCP-PATHNAME
                   PERFORM  900-PTKOHINF-READ-SEC
                 END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key14"              TO  MCP-PATHNAME
             PERFORM  900-CLOSE-SEC
           ELSE
             IF  RECE02-TEISYOTOKU  =  SPACE
               MOVE   4   TO   FLG-KOUREI-GENEKIKBN
             ELSE
               MOVE   5   TO   FLG-KOUREI-GENEKIKBN
             END-IF
           END-IF
      *
           .
       2121-KOUREI-GENBUTU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    高齢者高額現物給付対象者の判定
      *****************************************************************
       2116-KOUREI-GENBUTU-HANTEI-SEC      SECTION.
      *
      *    一般経過措置対象者
      *
           IF   (RECE02-SRYYM   >=  "200608")
           AND  (RECE02-SRYYM   <=  "200812")
           AND  (RECE02-KYURATE  =  20 OR 30)
             INITIALIZE                      PTKOHINF-REC
             MOVE    RECE02-HOSPNUM      TO  PTKOH-HOSPNUM
             MOVE    RECE02-PTID         TO  PTKOH-PTID
             MOVE    "978"               TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC        TO  MCPDATA-REC
             MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
             MOVE    "key4"              TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC  =  ZERO
               MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
               MOVE    "key4"            TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL  FLG-PTKOHINF  =  1
                 IF  (PTKOH-TEKSTYMD(1:6) <= RECE02-SRYYM       )
                 AND (RECE02-SRYYM        <= PTKOH-TEKEDYMD(1:6))
                 AND (PTKOH-SAKJOKBN       = SPACE              )
                   MOVE    "1"    TO  RECE02-RJNGENMENKBN
                   MOVE     1     TO  FLG-PTKOHINF
                 ELSE
                   MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
                   MOVE    "key4"            TO  MCP-PATHNAME
                   PERFORM  900-PTKOHINF-READ-SEC
                 END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
             MOVE    "key4"              TO  MCP-PATHNAME
             PERFORM  900-CLOSE-SEC
           END-IF
      *
           IF   (RECE02-SRYYM   >=  "201204"   )
           AND  (RECE02-KYURATE  =   30        )
           AND  (RECE02-TEISYOTOKU  NOT = SPACE)
             MOVE    SPACE    TO      RECE02-TEISYOTOKU
           END-IF
      *
           IF    RECE02-SRYYM   >=  "201808"
      *      高額４回目対象者の判定
             PERFORM   21161-KOHYONKAIME-HANTEI-SEC
           END-IF
      *
           IF    RECE02-SRYYM   >=  "201808"
             IF  FLG-KISAIOK  =  ZERO
               MOVE    19   TO   FLG-TOKKI
               PERFORM   21045-TOKKI-HENSYU-SEC
             END-IF
           END-IF
      *
           .
       2116-KOUREI-GENBUTU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    高額４回目対象者の判定
      *****************************************************************
       21161-KOHYONKAIME-HANTEI-SEC      SECTION.
      *
           MOVE     RECE02-SRYYM            TO   WRK-GEN70-YM
           IF   RECE02-TEKSTYMD(1:6)    >=  RECE02-SRYYM
             MOVE   RECE02-TEKSTYMD(7:2)    TO   WRK-GEN70-DD
           ELSE
             MOVE   01                      TO   WRK-GEN70-DD
           END-IF
      *
           MOVE     RECE02-SRYYM            TO   WRK-GEN702-YM
           IF   RECE02-TEKSTYMD-X(1:6)  >=  RECE02-SRYYM
             MOVE   RECE02-TEKSTYMD-X(7:2)  TO   WRK-GEN702-DD
           ELSE
             MOVE   01                      TO   WRK-GEN702-DD
           END-IF
      *
           INITIALIZE                       PTKOHINF-REC
           MOVE    RECE02-HOSPNUM       TO  PTKOH-HOSPNUM
           MOVE    RECE02-PTID          TO  PTKOH-PTID
           MOVE    "965"                TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC         TO  MCPDATA-REC
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key14"              TO  MCP-PATHNAME
           PERFORM  900-DBSELECT-SEC
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
             MOVE    "key14"            TO  MCP-PATHNAME
             PERFORM  900-PTKOHINF-READ-SEC
             PERFORM  UNTIL  FLG-PTKOHINF  =  1
               IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                   (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                   (PTKOH-SAKJOKBN   =   SPACE         ))
               OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                   (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                   (PTKOH-SAKJOKBN   =   SPACE         ))
                   MOVE     1      TO  FLG-KOHYONKAIME
                   MOVE     1      TO  FLG-PTKOHINF
               ELSE
                   MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                   MOVE    "key14"          TO  MCP-PATHNAME
                   PERFORM  900-PTKOHINF-READ-SEC
               END-IF
             END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key14"              TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       21161-KOHYONKAIME-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７０歳未満高額現物給付対象者の判定
      *****************************************************************
       2118-GENBUTU70-HANTEI-SEC      SECTION.
      *
      *    ７０歳未満高額現物給付対象者
           MOVE      RECE02-SRYYM          TO   WRK-GEN70-YM
           IF   RECE02-TEKSTYMD(1:6)  >=  RECE02-SRYYM
              MOVE   RECE02-TEKSTYMD(7:2)  TO   WRK-GEN70-DD
           ELSE
              MOVE   01                    TO   WRK-GEN70-DD
           END-IF
      *
           MOVE      RECE02-SRYYM            TO   WRK-GEN702-YM
           IF   RECE02-TEKSTYMD-X(1:6)  >=  RECE02-SRYYM
              MOVE   RECE02-TEKSTYMD-X(7:2)  TO   WRK-GEN702-DD
           ELSE
              MOVE   01                      TO   WRK-GEN702-DD
           END-IF
      *
           PERFORM   VARYING   GEN-IDX   FROM   1    BY   1
                      UNTIL   (GEN-IDX    >    TBL-GENBUTU70-MAX)
                        OR    (FLG-GENBUTU70   NOT = ZERO       )
                INITIALIZE                       PTKOHINF-REC
grpsys          MOVE    RECE02-HOSPNUM       TO  PTKOH-HOSPNUM
                MOVE    RECE02-PTID          TO  PTKOH-PTID
                MOVE    TBL-GENBUTU70(GEN-IDX)
                                             TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key14"              TO  MCP-PATHNAME
grpsys          PERFORM 900-DBSELECT-SEC
                IF      MCP-RC               =       ZERO
                  MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                  MOVE    "key14"              TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                  PERFORM  UNTIL   FLG-PTKOHINF    =   1
                     IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                         (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                         (PTKOH-SAKJOKBN   =   SPACE         ))
                     OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                         (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                         (PTKOH-SAKJOKBN   =   SPACE         ))
                         EVALUATE   GEN-IDX
                           WHEN        1
                             MOVE    1   TO  FLG-GENBUTU70
                             IF  RECE02-SRYYM  >= "201501"
                              IF  PTKOH-JKYSNUM(1:2) = "イ"
                               MOVE  12  TO  FLG-GENBUTU70-KBN
                              ELSE
                               MOVE  11  TO  FLG-GENBUTU70-KBN
                              END-IF
                             END-IF
                             IF   (RECE02-SRYYM   >=  "201204"   )
                             AND  (RECE02-TEISYOTOKU  NOT = SPACE)
                               MOVE  SPACE  TO  RECE02-TEISYOTOKU
                             END-IF
                           WHEN        2
                             IF  RECE02-TEISYOTOKU  =  SPACE
                               MOVE  2   TO  FLG-GENBUTU70
                               IF  RECE02-SRYYM  >= "201501"
                                IF  PTKOH-JKYSNUM(1:2) = "エ"
                                 MOVE 22 TO  FLG-GENBUTU70-KBN
                                ELSE
                                 MOVE 21 TO  FLG-GENBUTU70-KBN
                                END-IF
                               END-IF
                             ELSE
                               MOVE  3   TO  FLG-GENBUTU70
                               IF  RECE02-SRYYM  >= "201501"
                                 MOVE 31 TO  FLG-GENBUTU70-KBN
                               END-IF
                             END-IF
                         END-EVALUATE
                         MOVE     1      TO  FLG-PTKOHINF
                     ELSE
                         MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                         MOVE    "key14"              TO  MCP-PATHNAME
                         PERFORM  900-PTKOHINF-READ-SEC
                     END-IF
                  END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key14"              TO  MCP-PATHNAME
                PERFORM 900-CLOSE-SEC
           END-PERFORM
      *
           IF   (RECE02-HKNNUM   =  "002"                )
           AND  (RECE02-HOJOKBN  =  "1" OR "2" OR "3" OR
                                    "A" OR "B" OR "C" OR
                                    "D" OR "E" OR "F" OR
                                    "G" OR "H" OR "I"    )
                MOVE    ZERO           TO   FLG-GENBUTU70
                MOVE    ZERO           TO   FLG-GENBUTU70-KBN
           END-IF
           IF   (RECE02-HKNNUM   =  "031" OR "032" OR "033" OR "034")
           AND  (RECE02-HOJOKBN  =  "2" OR "B" OR "E" OR "H"        )
                MOVE    ZERO           TO   FLG-GENBUTU70
                MOVE    ZERO           TO   FLG-GENBUTU70-KBN
           END-IF
      *
           IF    FLG-GENBUTU70      =  ZERO
             IF  FLG-TOKUSITU   NOT =  ZERO
                MOVE    FLG-TOKUSITU   TO   FLG-GENBUTU70
                IF  RECE02-SRYYM   >=  "201501"
                  MOVE  FLG-TOKUSITU-KBN
                                       TO   FLG-GENBUTU70-KBN
                END-IF
                IF   (RECE02-SRYYM   >=  "201204"   )
                AND  (FLG-TOKUSITU    =   1         )
                AND  (RECE02-TEISYOTOKU  NOT = SPACE)
                  MOVE  SPACE  TO  RECE02-TEISYOTOKU
                END-IF
             END-IF
           END-IF
      *
           IF    FLG-GENBUTU70  =  ZERO
                MOVE    SPACE    TO     RECE02-ZAITAKU
           ELSE
      *         高額４回目対象者の判定
                PERFORM   21161-KOHYONKAIME-HANTEI-SEC
      *
                IF  FLG-KISAIOK     =  ZERO
                   IF  RECE02-SRYYM   >=  "201501"
                     MOVE   14    TO    FLG-TOKKI
                   ELSE
                     MOVE    5    TO    FLG-TOKKI
                   END-IF
                   PERFORM   21045-TOKKI-HENSYU-SEC
                END-IF
           END-IF
      *
           EVALUATE   FLG-GENBUTU70
             WHEN     1
               IF  RECE02-SRYYM   >=  "201501"
                 EVALUATE  FLG-GENBUTU70-KBN
                   WHEN      11
                     MOVE     "26"   TO    RECE02-DISCOUNTTENTNK
                   WHEN      12
                     MOVE     "27"   TO    RECE02-DISCOUNTTENTNK
                 END-EVALUATE
               ELSE
                 MOVE   "17"   TO    RECE02-DISCOUNTTENTNK
               END-IF
             WHEN     2
               IF  RECE02-SRYYM   >=  "201501"
                 EVALUATE  FLG-GENBUTU70-KBN
                   WHEN      21
                     MOVE     "28"   TO    RECE02-DISCOUNTTENTNK
                   WHEN      22
                     MOVE     "29"   TO    RECE02-DISCOUNTTENTNK
                 END-EVALUATE
               ELSE
                 MOVE   "18"   TO    RECE02-DISCOUNTTENTNK
               END-IF
             WHEN     3
               IF  RECE02-SRYYM   >=  "201501"
                 MOVE   "30"   TO    RECE02-DISCOUNTTENTNK
               ELSE
                 MOVE   "19"   TO    RECE02-DISCOUNTTENTNK
               END-IF
           END-EVALUATE
      *
           .
       2118-GENBUTU70-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せに全国公費を含むかチェック
      *****************************************************************
       2101-KOREISYA-KOHI-SEC      SECTION.
      *
           INITIALIZE                   TBL-HKNCOMBI
      *
           MOVE      ZERO        TO     CNT-HKNCOMBI-KOHARI
      *
           MOVE      ZERO        TO     FLG-ZENKOH-ARI
           PERFORM   VARYING  IDY2    FROM    1   BY  1
                      UNTIL   IDY2    >       10
                       OR     RECE02-HKNCOMBI (IDY2)  =   ZERO
                    IF      RECE02-HKNCOMBIFLG (IDY2)  =  1 OR 2
                       MOVE     1        TO     FLG-ZENKOH-ARI
                       MOVE    10        TO     IDY2
                    END-IF
           END-PERFORM
      *
           IF   FLG-ZENKOH-ARI  =  1
             PERFORM   VARYING  IDY2    FROM    1   BY  1
                        UNTIL   IDY2    >       10
                         OR     RECE02-HKNCOMBI (IDY2)  =   ZERO
      ****    IF   RECE02-HKNCOMBIFLG(IDY2) =  1 OR 2
               INITIALIZE                      SYUNOU-REC
               MOVE  RECE02-HOSPNUM        TO  SYU-HOSPNUM
               MOVE  RECE02-NYUGAIKBN      TO  SYU-NYUGAIKBN
               MOVE  RECE02-PTID           TO  SYU-PTID
               MOVE  RECE02-SRYYM          TO  SYU-SRYYMD(1:6)
               MOVE  "__"                  TO  SYU-SRYYMD(7:2)
               MOVE  RECE02-HKNCOMBI(IDY2) TO  SYU-HKNCOMBINUM
               MOVE  SYUNOU-REC            TO  MCPDATA-REC
               MOVE  "tbl_syunou"          TO  MCP-TABLE
               MOVE  "key41"               TO  MCP-PATHNAME
               PERFORM 900-DBSELECT-SEC
               IF    MCP-RC   =   ZERO
                 MOVE    "tbl_syunou"      TO  MCP-TABLE
                 MOVE    "key41"           TO  MCP-PATHNAME
                 PERFORM  900-SYUNOU-READ-SEC
                 PERFORM  UNTIL  (FLG-SYUNOU  =  1)
                   IF   SYU-DENPJTIKBN           NOT =  "3"
                     IF   RECE02-DAISANFLG(IDY2) NOT =   1
                       ADD   SYU-TOTAL-HKNTEN
                                TO  TBL-HKNCOMBI-TOTALTEN(IDY2)
                     END-IF
                     IF  (SYU-KOH-HKNNUM(1)  =
                          "012" OR "025" OR "972" OR "974")
                     OR  (SYU-KOH-HKNNUM(2)  =
                          "012" OR "025" OR "972" OR "974")
                     OR  (SYU-KOH-HKNNUM(3)  =
                          "012" OR "025" OR "972" OR "974")
                     OR  (SYU-KOH-HKNNUM(4)  =
                          "012" OR "025" OR "972" OR "974")
                       MOVE  1  TO  TBL-HKNCOMBI-CHKFLG(IDY2)
                     END-IF
      *
                     IF ((SYU-KOH-HKNNUM(1)  =
                              SPACE OR "027" OR "972" OR "974") AND
                         (SYU-KOH-HKNNUM(2)  =  SPACE         ) AND
                         (SYU-KOH-HKNNUM(3)  =  SPACE         ) AND
                         (SYU-KOH-HKNNUM(4)  =  SPACE         ))
                     OR ( SYU-KOH-HKNNUM(1)  =  "970"          )
                       CONTINUE
                     ELSE
                       MOVE  1  TO  TBL-HKNCOMBI-KOHARI(IDY2)
                     END-IF
                   END-IF
                   MOVE    "tbl_syunou"    TO  MCP-TABLE
                   MOVE    "key41"         TO  MCP-PATHNAME
                   PERFORM  900-SYUNOU-READ-SEC
                 END-PERFORM
               END-IF
               MOVE      "tbl_syunou"      TO  MCP-TABLE
               MOVE      "key41"           TO  MCP-PATHNAME
               PERFORM    900-CLOSE-SEC
      *
               IF  (TBL-HKNCOMBI-TOTALTEN(IDY2) =  ZERO)
               AND (TBL-HKNCOMBI-CHKFLG(IDY2)   =  ZERO)
                 IF ((RECE02-KOHNUMHC(IDY2 1)      NOT = "027") AND
                     (RECE02-KOHNUMHC(IDY2 1)(1:1)     = "0"  ))
                 OR ((RECE02-KOHNUMHC(IDY2 2)      NOT = "027") AND
                     (RECE02-KOHNUMHC(IDY2 2)(1:1)     = "0"  ))
                 OR ((RECE02-KOHNUMHC(IDY2 3)      NOT = "027") AND
                     (RECE02-KOHNUMHC(IDY2 3)(1:1)     = "0"  ))
                 OR ((RECE02-KOHNUMHC(IDY2 4)      NOT = "027") AND
                     (RECE02-KOHNUMHC(IDY2 4)(1:1)     = "0"  ))
                     MOVE  1  TO  TBL-HKNCOMBI-CHKFLG(IDY2)
                 END-IF
               END-IF
      ****    END-IF
             END-PERFORM
      *
             PERFORM   VARYING  IDY2    FROM    1   BY  1
                        UNTIL   IDY2    >       10
                         OR     RECE02-HKNCOMBI (IDY2)  =   ZERO
               IF    (RECE02-HKNCOMBIFLG(IDY2)    =  1 OR 2)
               AND   (TBL-HKNCOMBI-TOTALTEN(IDY2) =  ZERO  )
               AND   (TBL-HKNCOMBI-CHKFLG(IDY2)   =  ZERO  )
                 MOVE   ZERO    TO  RECE02-HKNCOMBIFLG(IDY2)
               END-IF
             END-PERFORM
      *
             MOVE       ZERO    TO  FLG-ZENKOH-ARI
             PERFORM   VARYING  IDY2    FROM    1   BY  1
                        UNTIL   IDY2    >       10
                         OR     RECE02-HKNCOMBI (IDY2)  =   ZERO
               IF     RECE02-HKNCOMBIFLG(IDY2)    =  1 OR 2
                 MOVE     1     TO  FLG-ZENKOH-ARI
                 MOVE    10     TO  IDY2
               END-IF
             END-PERFORM
      *
             PERFORM   VARYING  IDY2    FROM    1   BY  1
                        UNTIL   IDY2    >       10
                         OR     RECE02-HKNCOMBI (IDY2)  =   ZERO
               IF     TBL-HKNCOMBI-KOHARI(IDY2)   =  1
                 ADD      1     TO  CNT-HKNCOMBI-KOHARI
               END-IF
             END-PERFORM
           END-IF
      *
           MOVE      ZERO        TO     FLG-DOTANDOKU-IGAI
                                        FLG-DOTANDOKU
           IF   ( SYS-1001-PREFNUM    =   01      )
           AND  ( RECE02-SRYYM       >=  "200510" )
           AND  ( RECE02-SRYYM       <   "200810" )
             PERFORM   VARYING  IDY2    FROM    1   BY  1
                        UNTIL   IDY2      >     4
               IF RECE02-KOHNUM(IDY2)(1:1) =  "0" OR "9"
                  IF  ( RECE02-KOHNUM(IDY2) =  "051"         )
                  AND ((RECE02-KOHJKYSNUM(IDY2)(1:2) >= "91"
                                                 AND <= "95") OR
                       (RECE02-KOHJKYSNUM(IDY2)(1:2) >= "71"
                                                 AND <= "88"))
                     MOVE    1     TO    FLG-DOTANDOKU
                  ELSE
                     MOVE    1     TO    FLG-DOTANDOKU-IGAI
                  END-IF
               END-IF
             END-PERFORM
             IF   (FLG-DOTANDOKU-IGAI   =   ZERO)
             AND  (FLG-DOTANDOKU        =    1  )
             AND  (FLG-ZENKOH-ARI       =    1  )
                     MOVE   ZERO   TO    FLG-ZENKOH-ARI
             END-IF
           END-IF
      *
           IF   FLG-ZENKOH-ARI  =  ZERO
             IF (TBL-TOKATUKAIFLG(1)  =  1)
             OR (TBL-TOKATUKAIFLG(2)  =  1)
             OR (TBL-TOKATUKAIFLG(3)  =  1)
             OR (TBL-TOKATUKAIFLG(4)  =  1)
                     MOVE     1    TO    FLG-ZENKOH-ARI
             END-IF
           END-IF
      *
           MOVE      ZERO        TO     FLG-TAISYO
           PERFORM   VARYING  IDY2    FROM    1   BY  1
                      UNTIL   IDY2    >       10
                       OR     RECE02-HKNCOMBI (IDY2)  =   ZERO
                 IF      RECE02-HKNCOMBIFLG (IDY2)  =  2
                     IF   FLG-TAISYO  =  ZERO
                        MOVE   1     TO   FLG-TAISYO
                     END-IF
                 ELSE
                     MOVE      9     TO   FLG-TAISYO
                 END-IF
           END-PERFORM
      *
           .
       2101-KOREISYA-KOHI-EXT.
           EXIT.
      *
      *****************************************************************
      *    高齢者の一部負担金額記載に関するチェック
      *****************************************************************
       2102-KOREISYA-CHECK-SEC               SECTION.
      *
           MOVE    SPACE               TO  WRK-CHK-HKNJANUM
                                           WRK-CHK-HKNNUM
                                           WRK-CHK-HONKZKKBN
           MOVE    ZERO                TO  WRK-CHK-IDOU
                                           WRK-CHK-TAISYO
                                           WRK-CHK-HKNID
                                           WRK-CHK-CNT
                                           WRK-CHK-TAISYO2
                                           WRK-CHK-TOKU75-MAE
                                           FLG-TOKU75-XXX
                                           WRK-CHK-TAISYO3
      *
           INITIALIZE                      RECE09-REC
grpsys     MOVE    RECE02-HOSPNUM      TO  RECE09-HOSPNUM
           MOVE    RECE02-SRYYM        TO  RECE09-SRYYM
           MOVE    RECE02-NYUGAIKBN    TO  RECE09-NYUGAIKBN
           MOVE    RECE02-PTID         TO  RECE09-PTID
           MOVE    RECE02-RECEKA       TO  RECE09-RECEKA
      *
           START   RECE09-FILE
               KEY IS    >=   RECE09-KEY
               INVALID
                   MOVE    1           TO  FLG-RECE09
               NOT INVALID
                   PERFORM RECE09-NEXT-SEC
           END-START
           PERFORM UNTIL ( FLG-RECE09           =   1                )
grpsys             OR    ( RECE02-HOSPNUM   NOT =   RECE09-HOSPNUM   )
                   OR    ( RECE02-SRYYM     NOT =   RECE09-SRYYM     )
                   OR    ( RECE02-NYUGAIKBN NOT =   RECE09-NYUGAIKBN )
                   OR    ( RECE02-PTID      NOT =   RECE09-PTID      )
                   OR    ( RECE02-RECEKA    NOT =   RECE09-RECEKA    )
      *
               EVALUATE    RECE09-TEISYUTUSAKI
                   WHEN    "1"
                     EVALUATE    WRK-CHK-IDOU
                       WHEN    ZERO
                         ADD     1                TO  WRK-CHK-CNT
                         IF   RECE09-HKNJANUM  NOT =  SPACE
                            MOVE    1             TO  WRK-CHK-IDOU
                            MOVE  RECE09-HKNJANUM TO  WRK-CHK-HKNJANUM
                            MOVE  RECE09-HONKZKKBN
                                                  TO  WRK-CHK-HONKZKKBN
                            MOVE  RECE09-HKNID    TO  WRK-CHK-HKNID
                            MOVE  RECE09-HKNNUM   TO  WRK-CHK-HKNNUM
                            IF  (FLG-TOKU75  =  2 OR 3                 )
                            AND (RECE09-TEKSTYMDX < WRK-TOKU75-BIRTHDAY)
                                 MOVE     1    TO    WRK-CHK-TOKU75-MAE
                            END-IF
                         END-IF
                       WHEN     1
                         ADD     1                TO  WRK-CHK-CNT
                         IF   (RECE02-ZAITAKU   =   "1")
                         OR   (FLG-TOKU75    =  1 OR 2 )
                          IF  (RECE09-HKNJANUM  NOT = SPACE        ) AND
                              (RECE09-HKNJANUM  NOT =
                                                  WRK-CHK-HKNJANUM )
                              MOVE    1           TO  WRK-CHK-TAISYO
                          END-IF
                          IF  (RECE09-HKNJANUM  NOT = SPACE         )
                          AND (RECE09-HKNJANUM  =  WRK-CHK-HKNJANUM )
                              IF  (FLG-TOKU75   = 2                  )
                              AND (RECE09-TEKSTYMDX
                                               >= WRK-TOKU75-BIRTHDAY)
                              AND (WRK-CHK-TOKU75-MAE = 1            )
                                   MOVE    1      TO  WRK-CHK-TAISYO2
                              END-IF
                          END-IF
                         ELSE
                          IF ((RECE09-HKNJANUM  NOT = SPACE        ) AND
                              (RECE09-HKNJANUM  NOT =
                                                  WRK-CHK-HKNJANUM ))
                          OR ( RECE09-HONKZKKBN NOT =
                                                  WRK-CHK-HONKZKKBN )
                              MOVE    1           TO  WRK-CHK-TAISYO
                          END-IF
                          IF  (RECE09-HKNJANUM  NOT = SPACE         )
                          AND (RECE09-HKNJANUM  =  WRK-CHK-HKNJANUM )
                          AND (RECE09-HONKZKKBN =  WRK-CHK-HONKZKKBN)
                              IF  (FLG-TOKU75   = 3                  )
                              AND (RECE09-TEKSTYMDX
                                               >= WRK-TOKU75-BIRTHDAY)
                              AND (WRK-CHK-TOKU75-MAE = 1            )
                                   MOVE    2      TO  WRK-CHK-TAISYO2
                              END-IF
                          END-IF
                         END-IF
                       WHEN     2
                         ADD     1                TO  WRK-CHK-CNT
                         MOVE    1                TO  WRK-CHK-TAISYO
                       WHEN     6
                         ADD     1                TO  WRK-CHK-CNT
                         MOVE    1                TO  WRK-CHK-TAISYO
                     END-EVALUATE
                   WHEN    "2"
                     EVALUATE    WRK-CHK-IDOU
                       WHEN    ZERO
                         ADD     1                TO  WRK-CHK-CNT
                         IF   RECE09-HKNJANUM  NOT =  SPACE
                            MOVE    2             TO  WRK-CHK-IDOU
                            MOVE  RECE09-HKNJANUM TO  WRK-CHK-HKNJANUM
                            MOVE  RECE09-HONKZKKBN
                                                  TO  WRK-CHK-HONKZKKBN
                            MOVE  RECE09-HKNID    TO  WRK-CHK-HKNID
                            MOVE  RECE09-HKNNUM   TO  WRK-CHK-HKNNUM
                            IF  (FLG-TOKU75  =  2 OR 3                 )
                            AND (RECE09-TEKSTYMDX < WRK-TOKU75-BIRTHDAY)
                                 MOVE     1    TO    WRK-CHK-TOKU75-MAE
                            END-IF
                         END-IF
                       WHEN     1
                         ADD     1                TO  WRK-CHK-CNT
                         MOVE    1                TO  WRK-CHK-TAISYO
                      WHEN     2
                         ADD     1                TO  WRK-CHK-CNT
                         IF   (RECE02-HKNNUM  = "060"  )
                         OR   (RECE02-ZAITAKU = "1"    )
                         OR   (FLG-TOKU75     =  1 OR 2)
                          IF  (RECE09-HKNJANUM  NOT = SPACE        ) AND
                              (RECE09-HKNJANUM  NOT =
                                                  WRK-CHK-HKNJANUM )
                              MOVE    1           TO  WRK-CHK-TAISYO
                          END-IF
                          IF  (RECE09-HKNJANUM  NOT = SPACE         )
                          AND (RECE09-HKNJANUM  =  WRK-CHK-HKNJANUM )
                              IF  (FLG-TOKU75   = 2                  )
                              AND (RECE09-TEKSTYMDX
                                               >= WRK-TOKU75-BIRTHDAY)
                              AND (WRK-CHK-TOKU75-MAE = 1            )
                                   MOVE    1      TO  WRK-CHK-TAISYO2
                              END-IF
                          END-IF
                         ELSE
                          IF ((RECE09-HKNJANUM  NOT = SPACE        ) AND
                              (RECE09-HKNJANUM  NOT =
                                                  WRK-CHK-HKNJANUM ))
                          OR ( RECE09-HONKZKKBN NOT =
                                                  WRK-CHK-HONKZKKBN )
                              MOVE    1           TO  WRK-CHK-TAISYO
                          END-IF
                          IF  (RECE09-HKNJANUM  NOT = SPACE         )
                          AND (RECE09-HKNJANUM  =  WRK-CHK-HKNJANUM )
                          AND (RECE09-HONKZKKBN =  WRK-CHK-HONKZKKBN)
                              IF  (FLG-TOKU75   = 3                  )
                              AND (RECE09-TEKSTYMDX
                                               >= WRK-TOKU75-BIRTHDAY)
                              AND (WRK-CHK-TOKU75-MAE = 1            )
                                   MOVE    2      TO  WRK-CHK-TAISYO2
                              END-IF
                          END-IF
                         END-IF
                       WHEN     6
                         ADD     1                TO  WRK-CHK-CNT
                         MOVE    1                TO  WRK-CHK-TAISYO
                     END-EVALUATE
                   WHEN    "6"
                     EVALUATE    WRK-CHK-IDOU
                       WHEN    ZERO
                         ADD     1                TO  WRK-CHK-CNT
                         IF   RECE09-HKNJANUM  NOT =  SPACE
                            MOVE    6             TO  WRK-CHK-IDOU
                            MOVE  RECE09-HKNJANUM TO  WRK-CHK-HKNJANUM
                            MOVE  RECE09-HONKZKKBN
                                                  TO  WRK-CHK-HONKZKKBN
                            MOVE  RECE09-HKNID    TO  WRK-CHK-HKNID
                            MOVE  RECE09-HKNNUM   TO  WRK-CHK-HKNNUM
                         END-IF
                       WHEN     1
                       WHEN     2
                         ADD     1                TO  WRK-CHK-CNT
                         IF   RECE02-HKNNUM  =  "039"
                          IF  FLG-TOKU75     =   ZERO
                            IF    FLG-TAISYO   =    1
                                MOVE    1         TO  WRK-CHK-TAISYO
                            END-IF
                          ELSE
                            MOVE    1             TO  WRK-CHK-CNT
                            MOVE    6             TO  WRK-CHK-IDOU
                            MOVE  RECE09-HKNJANUM TO  WRK-CHK-HKNJANUM
                            MOVE  RECE09-HONKZKKBN
                                                  TO  WRK-CHK-HONKZKKBN
                            MOVE  RECE09-HKNID    TO  WRK-CHK-HKNID
                            MOVE  RECE09-HKNNUM   TO  WRK-CHK-HKNNUM
                            MOVE   ZERO           TO  WRK-CHK-TAISYO
                          END-IF
                         END-IF
                       WHEN     6
                         ADD     1                TO  WRK-CHK-CNT
                         IF  (RECE09-HKNJANUM  NOT = SPACE        ) AND
                             (RECE09-HKNJANUM  NOT =
                                                 WRK-CHK-HKNJANUM )
                             MOVE    1            TO  WRK-CHK-TAISYO
                             MOVE    1            TO  WRK-CHK-TAISYO3
                         END-IF
                     END-EVALUATE
               END-EVALUATE
      *
               PERFORM RECE09-NEXT-SEC
           END-PERFORM
      *
           IF   (RECE02-SRYYM       >=  "201204")
           AND  (WRK-CHK-TAISYO3     =   1      )
           AND  (WRK-CHK-CNT         =   2      )
             IF  (RECE02-HKNJANUM  NOT = SPACE           )
             AND (RECE02-HKNJANUM  NOT = WRK-CHK-HKNJANUM)
               IF   RECE02-HKNJANUM(1:4) = WRK-CHK-HKNJANUM(1:4)
                  MOVE    1      TO  FLG-GENBUTU-HANTEI2
               END-IF
             END-IF
           END-IF
      *
           IF   (RECE02-HKNNUM    NOT = "039")
           AND  (FLG-TOKU75       =  2 OR 3  )
           AND  (WRK-CHK-TAISYO2  NOT =  ZERO)
           AND  (WRK-CHK-CNT      =  2       )
              EVALUATE  WRK-CHK-TAISYO2
                WHEN      1
                  IF  (RECE02-HKNJANUM  NOT = SPACE        )
                  AND (RECE02-HKNJANUM  = WRK-CHK-HKNJANUM )
                    MOVE      1     TO    FLG-TOKU75-XXX
                  END-IF
                WHEN      2
                  IF  (RECE02-HKNJANUM  NOT = SPACE        )
                  AND (RECE02-HKNJANUM  = WRK-CHK-HKNJANUM )
                  AND (RECE02-HONKZKKBN = WRK-CHK-HONKZKKBN)
                    MOVE      1     TO    FLG-TOKU75-XXX
                  END-IF
              END-EVALUATE
           END-IF
      *
           IF   RECE02-RECEKA  =  SPACE
             IF    RECE02-SRYYM       >=  "200804"
               IF  ((RECE02-ZAITAKU      =   "1"         ) AND
                    (RECE02-HKNNUM       =   "039"       ) AND
                    (FLG-TAISYO          =    1          ))
               OR  ((RECE02-ZAITAKU      =   "1"  OR  "2") AND
                    (RECE02-HKNNUM   NOT =   "039"       ) AND
                    (FLG-TAISYO          =    1          ) AND
                    (FLG-TOKU75          =   ZERO        ))
                  CONTINUE
               ELSE
                  MOVE   ZERO    TO  WRK-CHK-TAISYO
               END-IF
             ELSE
               IF  ( RECE02-ZAITAKU      =   "1"          )
               OR  ((RECE02-ZAITAKU      =   "2"         ) AND
                    (FLG-TAISYO          =    1          ))
                  CONTINUE
               ELSE
                  MOVE   ZERO    TO  WRK-CHK-TAISYO
               END-IF
             END-IF
           ELSE
             MOVE        ZERO    TO  WRK-CHK-TAISYO
           END-IF
      *
           IF   (RECE02-SRYYM       >=  "201204")
           AND  (WRK-CHK-TAISYO3     =   1      )
           AND  (WRK-CHK-CNT         =   2      )
           AND  (FLG-TOKU75          =   1      )
             IF  (RECE02-HKNJANUM  NOT = SPACE           )
             AND (RECE02-HKNJANUM  NOT = WRK-CHK-HKNJANUM)
               IF   RECE02-HKNJANUM(1:4) = WRK-CHK-HKNJANUM(1:4)
                  CONTINUE
               ELSE
                  MOVE   ZERO    TO  WRK-CHK-TAISYO
               END-IF
             END-IF
           END-IF
      *
           IF  ((  WRK-CHK-TAISYO       =  1                 )  AND
                (  WRK-CHK-CNT          =  2                 )  AND
                (((RECE02-HKNJANUM  NOT = SPACE            ) AND
                  (RECE02-HKNJANUM  NOT = WRK-CHK-HKNJANUM ))  OR
                 ( RECE02-HONKZKKBN NOT = WRK-CHK-HONKZKKBN )))
           OR  ((  WRK-CHK-TAISYO       =  ZERO              )  AND
                (  WRK-CHK-CNT          =  2                 )  AND
                (  RECE02-RECEIPT-KBN(2:3)  NOT = SPACE      )  AND
                (  RECE02-RECEIPT-KBN(4:1)      = "2"        ))
      *
                INITIALIZE                 ORCSKOREIFTNCHKAREA
grpsys          MOVE    RECE02-HOSPNUM TO  LNK-KOREIFTNCHK-HOSPNUM
                MOVE    RECE02-PTID    TO  LNK-KOREIFTNCHK-PTID
                MOVE    "2"            TO  LNK-KOREIFTNCHK-NYUGAIKBN
                MOVE    RECE02-SRYYM   TO  LNK-KOREIFTNCHK-SRYYM
                MOVE    WRK-CHK-HKNNUM TO  LNK-KOREIFTNCHK-HKNNUM
                MOVE    WRK-CHK-HKNID  TO  LNK-KOREIFTNCHK-HKNID
                MOVE    RECE02-TEISYOTOKU
                                       TO  LNK-KOREIFTNCHK-TEISYOTOKU
                MOVE    RECE02-RECEKA  TO  LNK-KOREIFTNCHK-RECEKA
                MOVE    RECE02-RJNGENMENKBN
                                       TO  LNK-KOREIFTNCHK-KEIKASOCHI
                MOVE    WK-GENGAKUKBN  TO  LNK-KOREIFTNCHK-GENGAKUKBN
                MOVE    WK-GENGAKU-RITU
                                       TO  LNK-KOREIFTNCHK-GENGAKU-RITU
                MOVE    WK-GENGAKU-KIN TO  LNK-KOREIFTNCHK-GENGAKU-KIN
                MOVE    WK-GENGAKUKBN-KEISAN
                                       TO  LNK-KOREIFTNCHK-GENGAKUFLG
                MOVE    FLG-KOHYONKAIME
                                       TO  LNK-KOREIFTNCHK-KOHYONKAIME
                MOVE    RECE02-ZAITAKU TO  LNK-KOREIFTNCHK-NENREIKBN
                MOVE    RECE02-AGE     TO  LNK-KOREIFTNCHK-AGE
                MOVE    SYS-1001-PREFNUM
                                       TO  LNK-KOREIFTNCHK-PREFNUM
                MOVE    RECE02-SYUGAKUKBN
                                       TO  LNK-KOREIFTNCHK-SYUGAKUKBN
                MOVE    RECE02-KOHID(1)
                                       TO  LNK-KOREIFTNCHK-KOHID-CYOKI
                MOVE    FLG-TOKU75     TO  LNK-KOREIFTNCHK-TOKU75
                IF      RECE02-SRYYM   >=  "200804"
                     MOVE      1       TO  LNK-KOREIFTNCHK-CYOKINOMI
                ELSE
                  IF   (RECE02-ZAITAKU  =   "2")
                  AND  (FLG-TAISYO      =    1 )
                     MOVE      1       TO  LNK-KOREIFTNCHK-CYOKINOMI
                  END-IF
                END-IF
      *
                CALL    "ORCSKOREIFTNCHK"   USING
                                            ORCSKOREIFTNCHKAREA
                                            SPA-AREA 
                IF      LNK-KOREIFTNCHK-RC   =   ZERO
      ***           MOVE   LNK-KOREIFTNCHK-FTNGAKU
      ***                              TO  WRK-CHK-FTNGAKU
                    MOVE   LNK-KOREIFTNCHK-KOHFTNGAKU
                                       TO  WRK-CHK-KOHFTNGAKU
                    IF  FLG-ZENKOKUKOHI-NISYU = ZERO
                      MOVE   LNK-KOREIFTNCHK-ICHIBUGAKU
                                       TO  FTN-KOH-XXX
                                           WRK-CHK-ICHIBUGAKU
                      MOVE   LNK-KOREIFTNCHK-ICHIBUGAKU2
                                       TO  WRK-CHK-ICHIBUGAKU2
                    END-IF
      ***           MOVE   LNK-KOREIFTNCHK-CHIHOUGAKU
      ***                              TO  WRK-CHIHOU-KIN
                END-IF
      *
           END-IF
      *
           IF   FLG-TOKU75-XXX  =  1
              MOVE    ZERO    TO    FLG-TOKU75
           END-IF
      *
           .
       2102-KOREISYA-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患０５１チェック
      *****************************************************************
       2119-TOKUTEISIKKAN-CHECK-SEC               SECTION.
      *
           INITIALIZE                TBL-DOTANDOKU
      *
           IF   ( SYS-1001-PREFNUM    =   01      )
           AND  ( RECE02-SRYYM       >=  "200510" )
           AND  ( RECE02-SRYYM       <   "200810" )
             PERFORM   VARYING  IDY2    FROM    1   BY  1
                        UNTIL   IDY2      >     4
               IF  ( RECE02-KOHNUM(IDY2) =  "051"         )
               AND ((RECE02-KOHJKYSNUM(IDY2)(1:2) >= "91"
                                              AND <= "95") OR
                    (RECE02-KOHJKYSNUM(IDY2)(1:2) >= "71"
                                              AND <= "88"))
                   MOVE    1     TO    TBL-DOTANDOKU-FLG(IDY2)
               END-IF
             END-PERFORM
           END-IF
      *
           .
       2119-TOKUTEISIKKAN-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ０１公該当対象者の判定
      *****************************************************************
       211V-ZEROKOGAITO-CHECK-SEC      SECTION.
      *
           MOVE      RECE02-SRYYM          TO   WRK-GEN70-YM
           IF   RECE02-TEKSTYMD(1:6)  >=  RECE02-SRYYM
              MOVE   RECE02-TEKSTYMD(7:2)  TO   WRK-GEN70-DD
           ELSE
              MOVE   01                    TO   WRK-GEN70-DD
           END-IF
      *
           MOVE      RECE02-SRYYM            TO   WRK-GEN702-YM
           IF   RECE02-TEKSTYMD-X(1:6)  >=  RECE02-SRYYM
              MOVE   RECE02-TEKSTYMD-X(7:2)  TO   WRK-GEN702-DD
           ELSE
              MOVE   01                      TO   WRK-GEN702-DD
           END-IF
      *
           INITIALIZE                       PTKOHINF-REC
           MOVE    RECE02-HOSPNUM       TO  PTKOH-HOSPNUM
           MOVE    RECE02-PTID          TO  PTKOH-PTID
           MOVE    "955"                TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC         TO  MCPDATA-REC
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key4"               TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             PERFORM  900-PTKOHINF-READ-SEC
             PERFORM  UNTIL   FLG-PTKOHINF    =   1
                IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                    (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                    (PTKOH-SAKJOKBN   =   SPACE         ))
                OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                    (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                    (PTKOH-SAKJOKBN   =   SPACE         ))
                    MOVE     1      TO  FLG-ZEROKOGAITO
                    MOVE     1      TO  FLG-PTKOHINF
                ELSE
                    MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                    MOVE    "key4"               TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                END-IF
             END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key4"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           IF   (RECE02-ZAITAKU     =  "1" OR "2"    )
           AND  (RECE02-KOHNUM(1)   =  SPACE OR "972"
                                             OR "974")
           AND  (RECE02-KOHNUM(2)   =  SPACE         )
           AND  (RECE02-KOHNUM(3)   =  SPACE         )
           AND  (RECE02-KOHNUM(4)   =  SPACE         )
           AND  (RECE02-HKNCOMBI(2) =  ZERO          )
           AND  (FLG-ZEROKOGAITO    =   1            )
             INITIALIZE                    HKNCOMBI-REC
             MOVE  RECE02-HOSPNUM      TO  COMB-HOSPNUM
             MOVE  RECE02-PTID         TO  COMB-PTID
             MOVE  RECE02-HKNCOMBI(1)  TO  COMB-HKNCOMBINUM
             MOVE  HKNCOMBI-REC        TO  MCPDATA-REC
             PERFORM 900-HKNCOMBI-INV-SEC
             IF    FLG-HKNCOMBI  =  ZERO
               IF  ((COMB-KOH1HKNNUM(1:1) >= "1" AND <= "8" ) AND
                    (COMB-KOH2HKNNUM = SPACE                ) AND
                    (COMB-KOH3HKNNUM = SPACE                ) AND
                    (COMB-KOH4HKNNUM = SPACE                ))
               OR  ((COMB-KOH1HKNNUM(1:1) >= "1" AND <= "8" ) AND
                    (COMB-KOH2HKNNUM(1:1) >= "1" AND <= "8" ) AND
                    (COMB-KOH3HKNNUM = SPACE                ) AND
                    (COMB-KOH4HKNNUM = SPACE                ))
               OR  ((COMB-KOH1HKNNUM(1:1) >= "1" AND <= "8" ) AND
                    (COMB-KOH2HKNNUM = "972" OR "974"       ) AND
                    (COMB-KOH3HKNNUM = SPACE                ) AND
                    (COMB-KOH4HKNNUM = SPACE                ))
               OR  ((COMB-KOH1HKNNUM(1:1) >= "1" AND <= "8" ) AND
                    (COMB-KOH2HKNNUM(1:1) >= "1" AND <= "8" ) AND
                    (COMB-KOH3HKNNUM = "972" OR "974"       ) AND
                    (COMB-KOH4HKNNUM = SPACE                ))
                 CONTINUE
               ELSE
                 MOVE   ZERO   TO   FLG-ZEROKOGAITO
               END-IF
             ELSE
               MOVE     ZERO   TO   FLG-ZEROKOGAITO
             END-IF
           ELSE
             MOVE       ZERO   TO   FLG-ZEROKOGAITO
           END-IF
      *
           IF   FLG-ZEROKOGAITO   =   1
             MOVE   12    TO      FLG-TOKKI
             PERFORM   21045-TOKKI-HENSYU-SEC
           END-IF
      *
           .
       211V-ZEROKOGAITO-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    当月月途中の入所・退所ありの判定
      *****************************************************************
       211W-NYUSYOCYU-CHECK-SEC      SECTION.
      *
           INITIALIZE                         STS-AREA-DAY
           INITIALIZE                         LNK-DAY7-AREA
           MOVE   "71"                    TO  LNK-DAY7-IRAI
           MOVE   RECE02-SRYYM            TO  LNK-DAY7-YM
           CALL   "ORCSDAY"            USING  STS-AREA-DAY
                                              LNK-DAY7-AREA
           MOVE   LNK-DAY7-KOYOMI         TO  WRK-EDYMD
      *
           PERFORM  VARYING  GEN-IDX   FROM   1    BY   1
                     UNTIL  (GEN-IDX    >    TBL-NYUSYO-MAX)
                       OR   (FLG-NYUSYO   NOT = ZERO       )
             INITIALIZE                       PTKOHINF-REC
             MOVE    RECE02-HOSPNUM       TO  PTKOH-HOSPNUM
             MOVE    RECE02-PTID          TO  PTKOH-PTID
             MOVE    TBL-NYUSYO(GEN-IDX)  TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC         TO  MCPDATA-REC
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
               MOVE    "key4"               TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                 IF ((PTKOH-TEKSTYMD(1:6)      =  RECE02-SRYYM  ) AND
                     (PTKOH-TEKSTYMD(7:2)  NOT =  "01"          ) AND
                     (PTKOH-SAKJOKBN           =  SPACE         ) AND
                     (RECE02-RECEIPT-KBN(1:1)
                                           NOT =  SPACE         ))
                 OR ((PTKOH-TEKEDYMD(1:6)      =  RECE02-SRYYM  ) AND
                     (PTKOH-TEKEDYMD(7:2)  NOT =  WRK-EDYMD(7:2)) AND
                     (PTKOH-SAKJOKBN           =  SPACE         ) AND
                     (RECE02-RECEIPT-KBN(1:1)  =  SPACE         ))
                    MOVE     1      TO  FLG-NYUSYO
                    MOVE     1      TO  FLG-PTKOHINF
                 ELSE
                    MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                    MOVE    "key4"               TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                 END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-PERFORM
      *
           .
       211W-NYUSYOCYU-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    全国公費２種チェック
      *****************************************************************
       211A-ZENKOKUKOHI-NISYU-CHK-SEC               SECTION.
      *
           IF     (RECE02-SRYYM          >=  "200804")
           AND    (RECE02-HKNNUM      NOT =  SPACE   )
      *
      *      主＋全Ａ、主＋全Ｂ
             IF ((((RECE02-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE02-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
                 (((RECE02-KOHNUM(2)(1:1)  =  "0"            ) AND
                   (RECE02-KOHNUM(2)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(2)    =   1              ))  AND
                 (((RECE02-KOHNUM(3)(1:1) >= "1" AND <= "8"  ) AND
                   (TBL-TOKATUKAIFLG(3)    =  ZERO           )) OR
                  ( RECE02-KOHNUM(3)       =  SPACE           ) OR
                  ( RECE02-KOHNUM(3)       =  "972" OR "974"  ))  AND
                 (((RECE02-KOHNUM(4)(1:1) >= "1" AND <= "8"  ) AND
                   (TBL-TOKATUKAIFLG(4)    =  ZERO           )) OR
                  ( RECE02-KOHNUM(4)       =  SPACE           )))
      *
             OR ((RECE02-KOHNUM(1)(1:1)  =  "0"                )  AND
                 (RECE02-KOHNUM(1)   NOT =  "012" AND "025"    )  AND
                 (RECE02-KOHNUM(2)       =  "972" OR "974"     )  AND
                 (TBL-TOKATUKAIFLG(3)    =   1                 )  AND
                 (((RECE02-KOHNUM(4)(1:1) >= "1" AND <= "8"  ) AND
                   (TBL-TOKATUKAIFLG(4)    =  ZERO           )) OR
                  ( RECE02-KOHNUM(4)       =  SPACE           )))
      *
      ****   OR ((RECE02-KOHNUM(1)(1:1)  =  "0"                )  AND
      ****       (RECE02-KOHNUM(1)   NOT =  "012" AND "025"    )  AND
      ****       (RECE02-KOHNUM(2)       =  "972" OR "974"     )  AND
      ****       (RECE02-KOHNUM(3)(1:1)  =  "0"                )  AND
      ****       (RECE02-KOHNUM(3)   NOT =  "012" AND "025"    )  AND
      ****       (((RECE02-KOHNUM(4)(1:1) >= "1" AND <= "8"  ) AND
      ****         (TBL-TOKATUKAIFLG(4)    =  ZERO           )) OR
      ****        ( RECE02-KOHNUM(4)       =  SPACE           )))
      *
             OR ((RECE02-KOHNUM(1)       =  "972" OR "974"     )  AND
                 (TBL-TOKATUKAIFLG(2)    =   1                 )  AND
                 (TBL-TOKATUKAIFLG(3)    =   1                 )  AND
                 (((RECE02-KOHNUM(4)(1:1) >= "1" AND <= "8"  ) AND
                   (TBL-TOKATUKAIFLG(4)    =  ZERO           )) OR
                  ( RECE02-KOHNUM(4)       =  SPACE           )))
      *
               IF  (((RECE02-KOHNUM(1)(1:1)  =  "0"            ) AND
                     (RECE02-KOHNUM(1)   NOT =  "012" AND "025")) OR
                    ( TBL-TOKATUKAIFLG(1)    =   1              ))
               AND (((RECE02-KOHNUM(2)(1:1)  =  "0"            ) AND
                     (RECE02-KOHNUM(2)   NOT =  "012" AND "025")) OR
                    ( TBL-TOKATUKAIFLG(2)    =   1              ))
               AND (((RECE02-KOHNUM(3)(1:1) >= "1" AND <= "8"  ) AND
                     (TBL-TOKATUKAIFLG(3)    =  ZERO           )) OR
                    ( RECE02-KOHNUM(3)       =  SPACE           ) OR
                    ( RECE02-KOHNUM(3)       =  "972" OR "974"  ))
                  MOVE        1           TO   FLG-ZENKOKUKOHI-NISYU
               END-IF
      *
               IF  (RECE02-KOHNUM(1)(1:1)  =  "0"                )
               AND (RECE02-KOHNUM(1)   NOT =  "012" AND "025"    )
               AND (RECE02-KOHNUM(2)       =  "972" OR "974"     )
               AND (TBL-TOKATUKAIFLG(3)    =   1                 )
                  MOVE        8           TO   FLG-ZENKOKUKOHI-NISYU
               END-IF
      ****     IF  (RECE02-KOHNUM(1)(1:1)  =  "0"                )
      ****     AND (RECE02-KOHNUM(1)   NOT =  "012" AND "025"    )
      ****     AND (RECE02-KOHNUM(2)       =  "972" OR "974"     )
      ****     AND (RECE02-KOHNUM(3)(1:1)  =  "0"                )
      ****     AND (RECE02-KOHNUM(3)   NOT =  "012" AND "025"    )
      ****        MOVE        8           TO   FLG-ZENKOKUKOHI-NISYU
      ****     END-IF
      *
               IF  (RECE02-KOHNUM(1)       =  "972" OR "974"     )
               AND (TBL-TOKATUKAIFLG(2)    =   1                 )
               AND (TBL-TOKATUKAIFLG(3)    =   1                 )
                  MOVE        9           TO   FLG-ZENKOKUKOHI-NISYU
               END-IF
      *
               IF    RECE02-HKNCOMBI(2)   =   ZERO
                          MOVE    ZERO    TO   FLG-ZENKOKUKOHI-NISYU
               END-IF
             END-IF
      *
      *      主＋生保、主＋全
             IF (( RECE02-KOHNUM(1)(1:1)  =  "0"             )  AND
                 ( RECE02-KOHNUM(1)   NOT =  "012" AND "025" )  AND
                 ( RECE02-KOHNUM(2)       =  "012" OR  "025" )  AND
                 ((RECE02-KOHNUM(3)       =  SPACE          ) OR
                  (RECE02-KOHNUM(3)       =  "972" OR  "974"))  AND
                 ( RECE02-KOHNUM(4)       =  SPACE           ))
             OR (( RECE02-KOHNUM(1)(1:1)  =  "0"             )  AND
                 ( RECE02-KOHNUM(1)   NOT =  "012" AND "025" )  AND
                 ( RECE02-KOHNUM(2)(1:1)  =  "0"             )  AND
                 ( RECE02-KOHNUM(2)   NOT =  "012" AND "025" )  AND
                 ( RECE02-KOHNUM(3)       =  "012" OR  "025" )  AND
                 ((RECE02-KOHNUM(4)       =  SPACE          ) OR
                  (RECE02-KOHNUM(4)       =  "012" OR  "025") OR
                  (RECE02-KOHNUM(4)       =  "972" OR  "974")))
             OR (( RECE02-KOHNUM(1)(1:1)  =  "0"             )  AND
                 ( RECE02-KOHNUM(1)   NOT =  "012" AND "025" )  AND
                 ( RECE02-KOHNUM(2)       =  "012" OR  "025" )  AND
                 ( RECE02-KOHNUM(3)       =  "012" OR  "025" )  AND
                 ((RECE02-KOHNUM(4)       =  SPACE          ) OR
                  (RECE02-KOHNUM(4)       =  "972" OR  "974")))
             OR (( RECE02-KOHNUM(1)       =  "012" OR  "025" )  AND
                 ( RECE02-KOHNUM(2)       =  "012" OR  "025" )  AND
                 ((RECE02-KOHNUM(3)       =  SPACE          ) OR
                  (RECE02-KOHNUM(3)       =  "972" OR  "974"))  AND
                 ( RECE02-KOHNUM(4)       =  SPACE           ))
      *
                  MOVE        1           TO   FLG-ZENKOKUKOHI-NISYU
                  IF    RECE02-HKNCOMBI(2)   =   ZERO
                          MOVE    ZERO    TO   FLG-ZENKOKUKOHI-NISYU
                  ELSE
                    PERFORM   VARYING  IDY2  FROM  1  BY  1
                               UNTIL  (IDY2                  >  10 )
                                OR    (RECE02-HKNCOMBI(IDY2) = ZERO)
                      IF (RECE02-KOHNUMHC(IDY2 1) = "012" OR "025")
                      OR (RECE02-KOHNUMHC(IDY2 2) = "012" OR "025")
                      OR (RECE02-KOHNUMHC(IDY2 3) = "012" OR "025")
                      OR (RECE02-KOHNUMHC(IDY2 4) = "012" OR "025")
                          CONTINUE
                      ELSE
                          MOVE     5      TO   FLG-ZENKOKUKOHI-NISYU
      *
                          INITIALIZE                    HKNCOMBI-REC
                          MOVE RECE02-HOSPNUM        TO COMB-HOSPNUM
                          MOVE RECE02-PTID           TO COMB-PTID
                          MOVE RECE02-HKNCOMBI(IDY2) TO COMB-HKNCOMBINUM
                          MOVE HKNCOMBI-REC          TO MCPDATA-REC
                          PERFORM 900-HKNCOMBI-INV-SEC
                          IF   FLG-HKNCOMBI  =  ZERO
                            IF  (COMB-KOH1HKNNUM  =  "972")
                            OR  (COMB-KOH2HKNNUM  =  "972")
                            OR  (COMB-KOH3HKNNUM  =  "972")
                            OR  (COMB-KOH4HKNNUM  =  "972")
                              MOVE   1    TO   FLG-ZENKOKUKOHI-NISYU-SC
                            END-IF
                          END-IF
                      END-IF
                    END-PERFORM
                  END-IF
                  IF    FLG-ZENKOKUKOHI-NISYU  =   1
                    IF  CNT-HKNCOMBI-KOHARI    >   1
                      MOVE     5          TO   FLG-ZENKOKUKOHI-NISYU
                    ELSE
                      MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU
                    END-IF
                  END-IF
      *
             END-IF
      *
             IF ((((RECE02-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE02-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
                 (  RECE02-KOHNUM(2)(1:1) >=  "1" AND <= "8"   )  AND
                 (  TBL-TOKATUKAIFLG(2)    =  ZERO             ))
             OR ((  RECE02-KOHNUM(1)(1:1)  =  "0"              )  AND
                 (  RECE02-KOHNUM(1)   NOT =  "012" AND "025"  )  AND
                 (  RECE02-KOHNUM(2)       =  "972" OR "974"   )  AND
                 (  RECE02-KOHNUM(3)(1:1) >=  "1" AND <= "8"   )  AND
                 (  TBL-TOKATUKAIFLG(3)    =  ZERO             ))
             OR ((  RECE02-KOHNUM(1)       =  "972" OR "974"   )  AND
                 (  TBL-TOKATUKAIFLG(2)    =   1               )  AND
                 (  RECE02-KOHNUM(3)(1:1) >=  "1" AND <= "8"   )  AND
                 (  TBL-TOKATUKAIFLG(3)    =  ZERO             ))
      *
               MOVE           1           TO   FLG-ZENKOKUKOHI-NISYU3
      *
               IF (((RECE02-KOHNUM(1)(1:1)  =  "0"            ) AND
                    (RECE02-KOHNUM(1)   NOT =  "012" AND "025")) OR
                   ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
                  (  RECE02-KOHNUM(2)(1:1) >=  "1" AND <= "8"   )  AND
                  (  TBL-TOKATUKAIFLG(2)    =  ZERO             )
                 IF   RECE02-KOUREI-HANTEIFLG   =  "1"
                   IF    RECE02-EKF-KAK21KBN-K(3)  =  "1"
                      MOVE       2          TO   FLG-ZENKOKUKOHI-NISYU
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                        MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU
                        IF (RECE02-KOHNUM(1)  = "972" OR "974")
                        OR (RECE02-KOHNUM(2)  = "972" OR "974")
                        OR (RECE02-KOHNUM(3)  = "972" OR "974")
                        OR (RECE02-KOHNUM(4)  = "972" OR "974")
                          IF   RECE02-EKF-KAK23KBN-K(3)  =  "1"
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU
                          END-IF
                        ELSE
                          IF   RECE02-EKF-KAK22KBN-K(3)  =  "1"
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU
                          END-IF
                        END-IF
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK31KBN-K(3)  =  "1"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             CONTINUE
                      ELSE
                             MOVE     1     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK32KBN-K(3)  =  "1"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             MOVE     2     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK32KBN-K(3)  =  "2"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK32KBN-K(3)  =  "3"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             MOVE     4     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK41KBN-K(3)  =  "1"
                      MOVE       2          TO   FLG-ZENKOKUKOHI-NISYU5
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                        MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU5
                        IF (RECE02-KOHNUM(1)  = "972" OR "974")
                        OR (RECE02-KOHNUM(2)  = "972" OR "974")
                        OR (RECE02-KOHNUM(3)  = "972" OR "974")
                        OR (RECE02-KOHNUM(4)  = "972" OR "974")
                          IF   RECE02-EKF-KAK43KBN-K(3)  =  "1"
                             MOVE     4     TO   FLG-ZENKOKUKOHI-NISYU5
                          END-IF
                        ELSE
                          IF   RECE02-EKF-KAK42KBN-K(3)  =  "1"
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU5
                          END-IF
                        END-IF
                      END-IF
                   END-IF
                 ELSE
                   IF    RECE02-EKF-KAK21KBN-Y(3)  =  "1"
                      MOVE       2          TO   FLG-ZENKOKUKOHI-NISYU
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                        MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU
                        IF (RECE02-KOHNUM(1)  = "972" OR "974")
                        OR (RECE02-KOHNUM(2)  = "972" OR "974")
                        OR (RECE02-KOHNUM(3)  = "972" OR "974")
                        OR (RECE02-KOHNUM(4)  = "972" OR "974")
                          IF   RECE02-EKF-KAK23KBN-Y(3)  =  "1"
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU
                          END-IF
                        ELSE
                          IF   RECE02-EKF-KAK22KBN-Y(3)  =  "1"
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU
                          END-IF
                        END-IF
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK31KBN-Y(3)  =  "1"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             CONTINUE
                      ELSE
                             MOVE     1     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK32KBN-Y(3)  =  "1"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             MOVE     2     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK32KBN-Y(3)  =  "2"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK41KBN-Y(3)  =  "1"
                      MOVE       2          TO   FLG-ZENKOKUKOHI-NISYU5
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                        MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU5
                        IF (RECE02-KOHNUM(1)  = "972" OR "974")
                        OR (RECE02-KOHNUM(2)  = "972" OR "974")
                        OR (RECE02-KOHNUM(3)  = "972" OR "974")
                        OR (RECE02-KOHNUM(4)  = "972" OR "974")
                          IF   RECE02-EKF-KAK43KBN-Y(3)  =  "1"
                             MOVE     4     TO   FLG-ZENKOKUKOHI-NISYU5
                          END-IF
                        ELSE
                          IF   RECE02-EKF-KAK42KBN-Y(3)  =  "1"
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU5
                          END-IF
                        END-IF
                      END-IF
                   END-IF
                 END-IF
               END-IF
               IF  ((RECE02-KOHNUM(1)(1:1)  =  "0"            )  AND
                    (RECE02-KOHNUM(1)   NOT =  "012" AND "025")  AND
                    (RECE02-KOHNUM(2)       =  "972" OR "974" )  AND
                    (RECE02-KOHNUM(3)(1:1) >=  "1" AND <= "8" )  AND
                    (TBL-TOKATUKAIFLG(3)    =  ZERO           ))
               OR  ((RECE02-KOHNUM(1)       =  "972" OR "974" )  AND
                    (TBL-TOKATUKAIFLG(2)    =   1             )  AND
                    (RECE02-KOHNUM(3)(1:1) >=  "1" AND <= "8" )  AND
                    (TBL-TOKATUKAIFLG(3)    =  ZERO           ))
                 IF   RECE02-KOUREI-HANTEIFLG   =  "1"
                   IF    RECE02-EKF-KAK21KBN-K(4)  =  "1"
                      MOVE       2          TO   FLG-ZENKOKUKOHI-NISYU
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                        MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU
                        IF (RECE02-KOHNUM(1)  = "972" OR "974")
                        OR (RECE02-KOHNUM(2)  = "972" OR "974")
                        OR (RECE02-KOHNUM(3)  = "972" OR "974")
                        OR (RECE02-KOHNUM(4)  = "972" OR "974")
                          IF   RECE02-EKF-KAK23KBN-K(4)  =  "1"
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU
                          END-IF
                        ELSE
                          IF   RECE02-EKF-KAK22KBN-K(4)  =  "1"
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU
                          END-IF
                        END-IF
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK31KBN-K(4)  =  "1"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             CONTINUE
                      ELSE
                             MOVE     1     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK32KBN-K(4)  =  "1"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             MOVE     2     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK32KBN-K(4)  =  "2"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK32KBN-K(4)  =  "3"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             MOVE     4     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK41KBN-K(4)  =  "1"
                      MOVE       2          TO   FLG-ZENKOKUKOHI-NISYU5
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                        MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU5
                        IF (RECE02-KOHNUM(1)  = "972" OR "974")
                        OR (RECE02-KOHNUM(2)  = "972" OR "974")
                        OR (RECE02-KOHNUM(3)  = "972" OR "974")
                        OR (RECE02-KOHNUM(4)  = "972" OR "974")
                          IF   RECE02-EKF-KAK43KBN-K(4)  =  "1"
                             MOVE     4     TO   FLG-ZENKOKUKOHI-NISYU5
                          END-IF
                        ELSE
                          IF   RECE02-EKF-KAK42KBN-K(4)  =  "1"
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU5
                          END-IF
                        END-IF
                      END-IF
                   END-IF
                 ELSE
                   IF    RECE02-EKF-KAK21KBN-Y(4)  =  "1"
                      MOVE       2          TO   FLG-ZENKOKUKOHI-NISYU
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                        MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU
                        IF (RECE02-KOHNUM(1)  = "972" OR "974")
                        OR (RECE02-KOHNUM(2)  = "972" OR "974")
                        OR (RECE02-KOHNUM(3)  = "972" OR "974")
                        OR (RECE02-KOHNUM(4)  = "972" OR "974")
                          IF   RECE02-EKF-KAK23KBN-Y(4)  =  "1"
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU
                          END-IF
                        ELSE
                          IF   RECE02-EKF-KAK22KBN-Y(4)  =  "1"
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU
                          END-IF
                        END-IF
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK31KBN-Y(4)  =  "1"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             CONTINUE
                      ELSE
                             MOVE     1     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK32KBN-Y(4)  =  "1"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             MOVE     2     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK32KBN-Y(4)  =  "2"
                      IF  (RECE02-KOHNUM(1)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(2)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(3)  = "972" OR "974")
                      OR  (RECE02-KOHNUM(4)  = "972" OR "974")
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                             MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU4
                      END-IF
                   END-IF
                   IF    RECE02-EKF-KAK41KBN-Y(4)  =  "1"
                      MOVE       2          TO   FLG-ZENKOKUKOHI-NISYU5
                      IF   RECE02-HKNCOMBI(2)  =    ZERO
                        MOVE    ZERO        TO   FLG-ZENKOKUKOHI-NISYU5
                        IF (RECE02-KOHNUM(1)  = "972" OR "974")
                        OR (RECE02-KOHNUM(2)  = "972" OR "974")
                        OR (RECE02-KOHNUM(3)  = "972" OR "974")
                        OR (RECE02-KOHNUM(4)  = "972" OR "974")
                          IF   RECE02-EKF-KAK43KBN-Y(4)  =  "1"
                             MOVE     4     TO   FLG-ZENKOKUKOHI-NISYU5
                          END-IF
                        ELSE
                          IF   RECE02-EKF-KAK42KBN-Y(4)  =  "1"
                             MOVE     3     TO   FLG-ZENKOKUKOHI-NISYU5
                          END-IF
                        END-IF
                      END-IF
                   END-IF
                 END-IF
               END-IF
      *
             END-IF
      *
      *      主＋地Ａ、主＋地Ｂ
             IF  ((RECE02-KOHNUM(1)(1:1) >=  "1" AND <= "8"   ) AND
                  (TBL-TOKATUKAIFLG(1)    =  ZERO             ) AND
                  (RECE02-KOHNUM(2)(1:1) >=  "1" AND <= "8"   ) AND
                  (TBL-TOKATUKAIFLG(2)    =  ZERO             ) AND
                  (RECE02-KOHNUM(3)       =  SPACE            ) AND
                  (RECE02-KOHNUM(4)       =  SPACE            ))
             OR  ((RECE02-KOHNUM(1)       =  "972" OR "974"   ) AND
                  (RECE02-KOHNUM(2)(1:1) >=  "1" AND <= "8"   ) AND
                  (TBL-TOKATUKAIFLG(2)    =  ZERO             ) AND
                  (RECE02-KOHNUM(3)(1:1) >=  "1" AND <= "8"   ) AND
                  (TBL-TOKATUKAIFLG(3)    =  ZERO             ) AND
                  (RECE02-KOHNUM(4)       =  SPACE            ))
      *
                  MOVE        4           TO   FLG-ZENKOKUKOHI-NISYU
      *
                  IF    RECE02-HKNCOMBI(2)   =   ZERO
                     MOVE     ZERO        TO   FLG-ZENKOKUKOHI-NISYU
                  ELSE
                     PERFORM   VARYING  IDY2  FROM  1  BY  1
                                UNTIL  (IDY2                  >  10 )
                                 OR    (RECE02-HKNCOMBI(IDY2) = ZERO)
                      IF   RECE02-KOHNUM(1)  =  "972" OR "974"
                        IF  (RECE02-KOHNUMHC(IDY2 1) = RECE02-KOHNUM(3))
                        AND (RECE02-KOHNUMHC(IDY2 2) = RECE02-KOHNUM(2))
                           MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU
                        END-IF
                      ELSE
                        IF  (RECE02-KOHNUMHC(IDY2 1) = RECE02-KOHNUM(2))
                        AND (RECE02-KOHNUMHC(IDY2 2) = RECE02-KOHNUM(1))
                           MOVE    ZERO   TO   FLG-ZENKOKUKOHI-NISYU
                        END-IF
                      END-IF
                     END-PERFORM
                  END-IF
             END-IF
      *
      *      第２〜第４公費の情報編集
             PERFORM   VARYING  IDY5  FROM  3  BY  1
                        UNTIL  (IDY5                    >   5  )
                          OR   (RECE02-KOHNUM(IDY5 - 1) = SPACE)
               IF   (RECE02-KOHNUM(IDY5 - 1)(1:1) >=  "1" AND <= "8")
               AND  (TBL-TOKATUKAIFLG(IDY5 - 1)    =  ZERO          )
                 IF   RECE02-KOUREI-HANTEIFLG   =  "1"
                   IF   RECE02-EKF-KAK21KBN-K(IDY5)  =  "1"
                     MOVE      "1"     TO  RECE02-EKF-SAIKEIKSI(IDY5)
                     IF   RECE02-HKNCOMBI(2)  =  ZERO
                       MOVE    SPACE   TO  RECE02-EKF-SAIKEIKSI(IDY5)
                       IF (RECE02-KOHNUM(1)  = "972" OR "974")
                       OR (RECE02-KOHNUM(2)  = "972" OR "974")
                       OR (RECE02-KOHNUM(3)  = "972" OR "974")
                       OR (RECE02-KOHNUM(4)  = "972" OR "974")
                         IF   RECE02-EKF-KAK23KBN-K(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE02-EKF-SAIKEIKSI(IDY5)
                         END-IF
                       ELSE
                         IF   RECE02-EKF-KAK22KBN-K(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE02-EKF-SAIKEIKSI(IDY5)
                         END-IF
                       END-IF
                     END-IF
                   END-IF
                   IF   RECE02-EKF-KAK41KBN-K(IDY5)  =  "1"
                     MOVE      "1"     TO  RECE02-EKF-KINGAKKSN(IDY5)
                     IF   RECE02-HKNCOMBI(2)  =  ZERO
                       MOVE    SPACE   TO  RECE02-EKF-KINGAKKSN(IDY5)
                       IF (RECE02-KOHNUM(1)  = "972" OR "974")
                       OR (RECE02-KOHNUM(2)  = "972" OR "974")
                       OR (RECE02-KOHNUM(3)  = "972" OR "974")
                       OR (RECE02-KOHNUM(4)  = "972" OR "974")
                         IF   RECE02-EKF-KAK43KBN-K(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE02-EKF-KINGAKKSN(IDY5)
                         END-IF
                       ELSE
                         IF   RECE02-EKF-KAK42KBN-K(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE02-EKF-KINGAKKSN(IDY5)
                         END-IF
                       END-IF
                     END-IF
                   END-IF
                 ELSE
                   IF   RECE02-EKF-KAK21KBN-Y(IDY5)  =  "1"
                     MOVE      "1"     TO  RECE02-EKF-SAIKEIKSI(IDY5)
                     IF   RECE02-HKNCOMBI(2)  =  ZERO
                       MOVE    SPACE   TO  RECE02-EKF-SAIKEIKSI(IDY5)
                       IF (RECE02-KOHNUM(1)  = "972" OR "974")
                       OR (RECE02-KOHNUM(2)  = "972" OR "974")
                       OR (RECE02-KOHNUM(3)  = "972" OR "974")
                       OR (RECE02-KOHNUM(4)  = "972" OR "974")
                         IF   RECE02-EKF-KAK23KBN-Y(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE02-EKF-SAIKEIKSI(IDY5)
                         END-IF
                       ELSE
                         IF   RECE02-EKF-KAK22KBN-Y(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE02-EKF-SAIKEIKSI(IDY5)
                         END-IF
                       END-IF
                     END-IF
                   END-IF
                   IF   RECE02-EKF-KAK41KBN-Y(IDY5)  =  "1"
                     MOVE      "1"     TO  RECE02-EKF-KINGAKKSN(IDY5)
                     IF   RECE02-HKNCOMBI(2)  =  ZERO
                       MOVE    SPACE   TO  RECE02-EKF-KINGAKKSN(IDY5)
                       IF (RECE02-KOHNUM(1)  = "972" OR "974")
                       OR (RECE02-KOHNUM(2)  = "972" OR "974")
                       OR (RECE02-KOHNUM(3)  = "972" OR "974")
                       OR (RECE02-KOHNUM(4)  = "972" OR "974")
                         IF   RECE02-EKF-KAK43KBN-Y(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE02-EKF-KINGAKKSN(IDY5)
                         END-IF
                       ELSE
                         IF   RECE02-EKF-KAK42KBN-Y(IDY5)  =  "1"
                            MOVE  "1"  TO  RECE02-EKF-KINGAKKSN(IDY5)
                         END-IF
                       END-IF
                     END-IF
                   END-IF
                 END-IF
                 EVALUATE  IDY5
                   WHEN     3
                     IF (((RECE02-KOHNUM(1)(1:1) = "0"            ) AND
                          (RECE02-KOHNUM(1)  NOT = "012" AND "025")) OR
                         ( TBL-TOKATUKAIFLG(1)    =   1            ))
                       CONTINUE
                     ELSE
                       MOVE  SPACE  TO  RECE02-EKF-SAIKEIKSI(IDY5)
                     END-IF
                   WHEN     4
                     IF (((RECE02-KOHNUM(1)(1:1) = "0"            ) AND
                          (RECE02-KOHNUM(1)  NOT = "012" AND "025")) OR
                         ( TBL-TOKATUKAIFLG(1)    =   1            ))
                     OR (((RECE02-KOHNUM(2)(1:1) = "0"            ) AND
                          (RECE02-KOHNUM(2)  NOT = "012" AND "025")) OR
                         ( TBL-TOKATUKAIFLG(2)    =   1            ))
                       CONTINUE
                     ELSE
                       MOVE  SPACE  TO  RECE02-EKF-SAIKEIKSI(IDY5)
                     END-IF
                   WHEN     5
                     IF (((RECE02-KOHNUM(1)(1:1) = "0"            ) AND
                          (RECE02-KOHNUM(1)  NOT = "012" AND "025")) OR
                         ( TBL-TOKATUKAIFLG(1)    =   1            ))
                     OR (((RECE02-KOHNUM(2)(1:1) = "0"            ) AND
                          (RECE02-KOHNUM(2)  NOT = "012" AND "025")) OR
                         ( TBL-TOKATUKAIFLG(2)    =   1            ))
                     OR (((RECE02-KOHNUM(3)(1:1) = "0"            ) AND
                          (RECE02-KOHNUM(3)  NOT = "012" AND "025")) OR
                         ( TBL-TOKATUKAIFLG(3)    =   1            ))
                       CONTINUE
                     ELSE
                       MOVE  SPACE  TO  RECE02-EKF-SAIKEIKSI(IDY5)
                     END-IF
                 END-EVALUATE
                 IF  RECE02-EKF-SAIKEIKSI(IDY5)  =  SPACE
                   MOVE        "2"     TO  RECE02-EKF-SAIKEIKSI(IDY5)
                 END-IF
               ELSE
                 IF (RECE02-KOHNUM(IDY5 - 1)(1:1)  =  "0")
                 OR (TBL-TOKATUKAIFLG(IDY5 - 1)    =   1 )
                   MOVE        "3"     TO  RECE02-EKF-SAIKEIKSI(IDY5)
                 END-IF
               END-IF
      *
               IF    RECE02-EKF-SAIKEIKSI(IDY5)  NOT =  SPACE
                 PERFORM   VARYING  IDY2  FROM  1  BY  1
                             UNTIL (IDY2                  >  10 )
                              OR   (RECE02-HKNCOMBI(IDY2) = ZERO)
                   IF  (RECE02-KOHNUM(IDY5 - 1) =
                                         RECE02-KOHNUMHC(IDY2 1))
                   AND (RECE02-KOHID (IDY5 - 1) =
                                         RECE02-KOHIDHC (IDY2 1))
                     IF    RECE02-EKF-SAIKEIKSI(IDY5)  =  "1"
                       MOVE    "4"     TO  RECE02-EKF-SAIKEIKSI(IDY5)
                     ELSE
                       MOVE   SPACE    TO  RECE02-EKF-SAIKEIKSI(IDY5)
                     END-IF
                     MOVE     10       TO  IDY2
                   END-IF
                 END-PERFORM
               END-IF
             END-PERFORM
      *
           END-IF
      *
      *    主＋全Ａ、主＋全Ｂ
           IF ((((RECE02-KOHNUM(1)(1:1)  =  "0"            ) AND
                 (RECE02-KOHNUM(1)   NOT =  "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(1)    =   1              ))  AND
               (((RECE02-KOHNUM(2)(1:1)  =  "0"            ) AND
                 (RECE02-KOHNUM(2)   NOT =  "012" AND "025")) OR
                ( TBL-TOKATUKAIFLG(2)    =   1              )))
      *
           OR ((RECE02-KOHNUM(1)(1:1)  =  "0"                )  AND
               (RECE02-KOHNUM(1)   NOT =  "012" AND "025"    )  AND
               (RECE02-KOHNUM(2)       =  "972" OR "974"     )  AND
               (TBL-TOKATUKAIFLG(3)    =   1                 ))
      *
           OR ((RECE02-KOHNUM(1)       =  "972" OR "974"     )  AND
               (TBL-TOKATUKAIFLG(2)    =   1                 )  AND
               (TBL-TOKATUKAIFLG(3)    =   1                 ))
      *
                  MOVE        1           TO   FLG-ZENKOKUKOHI-NISYU2
      *
           END-IF
      *
      *    第３公費、第４公費
           MOVE      ZERO       TO    IDY6
           PERFORM   VARYING  IDY5  FROM  2  BY  1
                      UNTIL  (IDY5                    >   5  )
                        OR   (RECE02-KOHNUM(IDY5 - 1) = SPACE)
             IF    RECE02-KOHNUM(IDY5 - 1) = "972" OR "974"
               CONTINUE
             ELSE
               ADD    1         TO    IDY6
               IF   IDY6  >  2
                 IF  RECE02-EKF-SAIKEIKSI(IDY5)  =  SPACE OR "4"
                   MOVE   ZERO  TO    FLG-ZENKOKUKOHI-NISYU
                                      FLG-ZENKOKUKOHI-NISYU2
                                      FLG-ZENKOKUKOHI-NISYU3
                                      FLG-ZENKOKUKOHI-NISYU4
                                      FLG-ZENKOKUKOHI-NISYU5
                                      FLG-ZENKOKUKOHI-NISYU-SC
                 END-IF
               END-IF
             END-IF
           END-PERFORM
      *
           .
       211A-ZENKOKUKOHI-NISYU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７５歳到達月の特例判定
      *****************************************************************
       211B-TOKU75-HANTEI-SEC               SECTION.
      *
           MOVE      ZERO       TO    FLG-TOKU75
                                      FLG-TOKU75-KIZON
           MOVE      SPACE      TO    WRK-TOKU75-BIRTHDAY
           MOVE      ZERO       TO    FLG-SYOGAI75
      *
           IF   (RECE02-SRYYM       >=  "200901")
           AND  (RECE02-HKNNUM   NOT =   SPACE  )
             IF  (RECE02-HKNNUM(1:2)  =   "98"  OR "90"  OR "91" )
             OR  (RECE02-HKNNUM       =   "068" OR "069" OR "040")
               CONTINUE
             ELSE
               IF   RECE02-KOUREI-HANTEIFLG   =   "1"
                 INITIALIZE                      PTKOHINF-REC
                 MOVE    RECE02-HOSPNUM      TO  PTKOH-HOSPNUM
                 MOVE    RECE02-PTID         TO  PTKOH-PTID
                 MOVE    "977"               TO  PTKOH-KOHNUM
                 MOVE    PTKOHINF-REC        TO  MCPDATA-REC
                 MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
                 MOVE    "key4"              TO  MCP-PATHNAME
                 PERFORM 900-DBSELECT-SEC
                 IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                    MOVE    "key4"               TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD(1:6) <= RECE02-SRYYM       )
                      AND (RECE02-SRYYM        <= PTKOH-TEKEDYMD(1:6))
                      AND (PTKOH-SAKJOKBN       = SPACE              )
                         MOVE     1          TO  FLG-KOKI-HIGAITO
                         MOVE     1          TO  FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                         MOVE    "key4"               TO  MCP-PATHNAME
                         PERFORM  900-PTKOHINF-READ-SEC
                      END-IF
                    END-PERFORM
                 END-IF
                 MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                 MOVE    "key4"               TO  MCP-PATHNAME
                 PERFORM 900-CLOSE-SEC
      *
                 INITIALIZE                      ORCSAGECHKAREA
                 MOVE    RECE02-HOSPNUM      TO  AGECHK-HOSPNUM
                 MOVE    RECE02-PTID         TO  AGECHK-PTID
                 MOVE    RECE02-SRYYM        TO  AGECHK-SRYYMD(1:6)
                 MOVE    "01"                TO  AGECHK-SRYYMD(7:2)
                 MOVE    RECE02-BIRTHDAY     TO  AGECHK-BIRTHDAY
                 CALL    "ORCSAGECHK"        USING
                                             ORCSAGECHKAREA
                                             SPA-AREA
                 IF      AGECHK-RC       =   ZERO
                   IF  (AGECHK-NENREI        =  74              )
                   AND (AGECHK-ROUJIN2       =  0               )
                   AND (RECE02-BIRTHDAY(5:2) = RECE02-SRYYM(5:2))
                   AND (RECE02-BIRTHDAY(7:2)  NOT =  "01"       )
                   AND (RECE02-BIRTHDAY(5:4)  NOT =  "0229"     )
                   AND (FLG-KOKI-HIGAITO          =   ZERO      )
                       MOVE   1    TO    FLG-TOKU75
                       MOVE   RECE02-BIRTHDAY
                                   TO    WRK-TOKU75-BIRTHDAY
                   END-IF
                   IF  ( AGECHK-NENREI       >=  75 )
                   OR  ( AGECHK-ROUJIN2       =  1  )
                       MOVE   1    TO    FLG-TOKU75-KIZON
                   END-IF
                   IF  (AGECHK-NENREI        =  74              )
                   AND (AGECHK-ROUJIN2       =  1               )
                   AND (RECE02-BIRTHDAY(5:2) = RECE02-SRYYM(5:2))
                   AND (RECE02-BIRTHDAY(7:2)  NOT =  "01"       )
                   AND (RECE02-BIRTHDAY(5:4)  NOT =  "0229"     )
                       MOVE   1    TO    FLG-SYOGAI75
                   END-IF
                 END-IF
               END-IF
      *
               IF (FLG-TOKU75         =    1)
               OR (FLG-TOKU75-KIZON   =    1)
                 CONTINUE
               ELSE
                 INITIALIZE                   PTKOHINF-REC
                 MOVE    RECE02-HOSPNUM   TO  PTKOH-HOSPNUM
                 MOVE    RECE02-PTID      TO  PTKOH-PTID
                 MOVE    "969"            TO  PTKOH-KOHNUM
                 MOVE    PTKOHINF-REC     TO  MCPDATA-REC
                 MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                 MOVE    "key4"           TO  MCP-PATHNAME
                 PERFORM 900-DBSELECT-SEC
                 IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                    MOVE    "key4"               TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD(1:6) =  RECE02-SRYYM       )
                      AND (RECE02-SRYYM        =  PTKOH-TEKEDYMD(1:6))
                      AND (PTKOH-SAKJOKBN      =  SPACE              )
                         IF  PTKOH-TEKSTYMD(5:4)   NOT =  "0229"
                           IF   RECE02-KOUREI-HANTEIFLG   =   "1"
                              MOVE  2   TO   FLG-TOKU75
                           ELSE
                              MOVE  3   TO   FLG-TOKU75
                           END-IF
                           MOVE  PTKOH-TEKSTYMD
                                        TO   WRK-TOKU75-BIRTHDAY
                         END-IF
                         MOVE    1      TO   FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                         MOVE    "key4"               TO  MCP-PATHNAME
                         PERFORM  900-PTKOHINF-READ-SEC
                      END-IF
                    END-PERFORM
                 END-IF
                 MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                 MOVE    "key4"               TO  MCP-PATHNAME
                 PERFORM 900-CLOSE-SEC
               END-IF
             END-IF
           END-IF
      *
      *    ７５歳到達月の特例非該当
           IF   FLG-TOKU75   =  1  OR  2  OR  3
             MOVE      RECE02-SRYYM          TO   WRK-GEN70-YM
             IF   RECE02-TEKSTYMD(1:6)  >=  RECE02-SRYYM
                MOVE   RECE02-TEKSTYMD(7:2)  TO   WRK-GEN70-DD
             ELSE
                MOVE   01                    TO   WRK-GEN70-DD
             END-IF
      *
             MOVE      RECE02-SRYYM            TO   WRK-GEN702-YM
             IF   RECE02-TEKSTYMD-X(1:6)  >=  RECE02-SRYYM
                MOVE   RECE02-TEKSTYMD-X(7:2)  TO   WRK-GEN702-DD
             ELSE
                MOVE   01                      TO   WRK-GEN702-DD
             END-IF
      *
             INITIALIZE                   PTKOHINF-REC
             MOVE    RECE02-HOSPNUM   TO  PTKOH-HOSPNUM
             MOVE    RECE02-PTID      TO  PTKOH-PTID
             MOVE    "954"            TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC     TO  MCPDATA-REC
             MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
             MOVE    "key4"           TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                PERFORM  900-PTKOHINF-READ-SEC
                PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                      (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                  OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                      (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                     MOVE     ZERO   TO  FLG-TOKU75
                     MOVE     1      TO  FLG-PTKOHINF
                  ELSE
                     MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                     MOVE    "key4"               TO  MCP-PATHNAME
                     PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
                END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-IF
      *
           EVALUATE   FLG-TOKU75
             WHEN        1
             WHEN        2
               IF    RECE02-ZAITAKU      =   "1"
                 CONTINUE
               ELSE
                IF      IDZ   =   1
                 IF (RECE02-KOHNUM(1) = "972" OR "974")
                 OR (RECE02-KOHNUM(2) = "972" OR "974")
                 OR (RECE02-KOHNUM(3) = "972" OR "974")
                 OR (RECE02-KOHNUM(4) = "972" OR "974")
                 OR (RECE02-KOHNUM(1)(1:1) = "0"      )
                 OR (RECE02-KOHNUM(2)(1:1) = "0"      )
                 OR (RECE02-KOHNUM(3)(1:1) = "0"      )
                 OR (RECE02-KOHNUM(4)(1:1) = "0"      )
                 OR (TBL-TOKATUKAIFLG(1)   =  1       )
                 OR (TBL-TOKATUKAIFLG(2)   =  1       )
                 OR (TBL-TOKATUKAIFLG(3)   =  1       )
                 OR (TBL-TOKATUKAIFLG(4)   =  1       )
                    CONTINUE
                 ELSE
                    MOVE   ZERO    TO   FLG-TOKU75
                 END-IF
                ELSE
                 PERFORM   211B1-TOKU75-HANTEI-KOHSKY-SEC
                 IF  FLG-TOKU75-KOHSKY = 1
                    CONTINUE
                 ELSE
                    MOVE   ZERO    TO   FLG-TOKU75
                 END-IF
                END-IF
               END-IF
             WHEN        3
               IF    RECE02-ZAITAKU      =   "2"
                 CONTINUE
               ELSE
                IF      IDZ   =   1
                 IF (RECE02-KOHNUM(1) = "972" OR "974")
                 OR (RECE02-KOHNUM(2) = "972" OR "974")
                 OR (RECE02-KOHNUM(3) = "972" OR "974")
                 OR (RECE02-KOHNUM(4) = "972" OR "974")
                    CONTINUE
                 ELSE
                    MOVE   ZERO    TO   FLG-TOKU75
                 END-IF
                ELSE
                 PERFORM   211B1-TOKU75-HANTEI-KOHSKY-SEC
                 IF  FLG-TOKU75-KOHSKY = 1
                    CONTINUE
                 ELSE
                    MOVE   ZERO    TO   FLG-TOKU75
                 END-IF
                END-IF
               END-IF
           END-EVALUATE
      *
           IF  FLG-TOKU75    =  2  OR  3
               MOVE    6    TO      FLG-TOKKI
               PERFORM   21045-TOKKI-HENSYU-SEC
           END-IF
      *
           IF  FLG-TOKU75    =  1  OR  2  OR  3
              EVALUATE  FLG-TOKU75
                WHEN       1
                  MOVE   1    TO   RECE02-RJNNYUKOHFTN(1)
                WHEN       2
                  MOVE   2    TO   RECE02-RJNNYUKOHFTN(1)
                WHEN       3
                  MOVE   3    TO   RECE02-RJNNYUKOHFTN(1)
              END-EVALUATE
           END-IF
      *
           IF  FLG-SYOGAI75  =  1
               IF    RECE02-ZAITAKU      =   "1"
                    MOVE    1    TO    RECE02-RJNGAIKOHFTN(3)
               ELSE
                 IF (RECE02-KOHNUM(1) = "972" OR "974")
                 OR (RECE02-KOHNUM(2) = "972" OR "974")
                 OR (RECE02-KOHNUM(3) = "972" OR "974")
                 OR (RECE02-KOHNUM(4) = "972" OR "974")
                 OR (RECE02-KOHNUM(1)(1:1) = "0"      )
                 OR (RECE02-KOHNUM(2)(1:1) = "0"      )
                 OR (RECE02-KOHNUM(3)(1:1) = "0"      )
                 OR (RECE02-KOHNUM(4)(1:1) = "0"      )
                 OR (TBL-TOKATUKAIFLG(1)   =  1       )
                 OR (TBL-TOKATUKAIFLG(2)   =  1       )
                 OR (TBL-TOKATUKAIFLG(3)   =  1       )
                 OR (TBL-TOKATUKAIFLG(4)   =  1       )
                    MOVE    1    TO    RECE02-RJNGAIKOHFTN(3)
                 END-IF
               END-IF
           END-IF
      *
           .
       211B-TOKU75-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７５歳到達月の特例判定（公費請求分）
      *****************************************************************
       211B1-TOKU75-HANTEI-KOHSKY-SEC               SECTION.
      *
           MOVE    ZERO    TO    FLG-TOKU75-KOHSKY
      *
           PERFORM   VARYING   TOKU75-IDX    FROM    1   BY  1
                      UNTIL   (TOKU75-IDX                   >  10  )
                       OR     (RECE02-HKNCOMBI(TOKU75-IDX)  =  ZERO)
                       OR     (FLG-TOKU75-KOHSKY            =  1   )
      *
             INITIALIZE                  HKNCOMBI-REC
             MOVE    RECE02-HOSPNUM  TO  COMB-HOSPNUM
             MOVE    RECE02-PTID     TO  COMB-PTID
             MOVE    RECE02-HKNCOMBI(TOKU75-IDX)
                                     TO  COMB-HKNCOMBINUM
             MOVE    HKNCOMBI-REC    TO  MCPDATA-REC
             PERFORM 900-HKNCOMBI-INV-SEC
             IF      FLG-HKNCOMBI    =   ZERO
                 PERFORM   VARYING   TOKU75-IDX2   FROM    1   BY  1
                            UNTIL   (TOKU75-IDX2        >  4)
                              OR    (FLG-TOKU75-KOHSKY  =  1)
                   IF ( COMB-KOHHKNNUM(TOKU75-IDX2)
                                              = "972" OR "974" )
                   OR ((FLG-TOKU75  = 1 OR 2                  ) AND
                       (COMB-KOHHKNNUM(TOKU75-IDX2)(1:1) = "0"))
                   OR ((FLG-TOKU75  = 1 OR 2                  ) AND
                       (SYS-1001-PREFNUM            =  13     ) AND
                       (COMB-KOHHKNNUM(TOKU75-IDX2) = "151"   ) AND
                       (TOKU75-IDX2                 =  1      ) AND
                       (RECE02-SRYYM               >= "200905"))
                   OR ((FLG-TOKU75  = 1 OR 2                  ) AND
                       (SYS-1001-PREFNUM            =  23     ) AND
                       (COMB-KOHHKNNUM(TOKU75-IDX2) = "191"   ) AND
                       (TOKU75-IDX2                 =  1      ) AND
                       (RECE02-SRYYM               >= "200910"))
                     INITIALIZE               ORCSFTNJGNCHKAREA
                     MOVE RECE02-HOSPNUM   TO LNK-FTNJGNCHK-HOSPNUM
                     MOVE RECE02-PTID      TO LNK-FTNJGNCHK-PTID
                     MOVE "2"              TO LNK-FTNJGNCHK-NYUGAIKBN
                     MOVE RECE02-SRYYM     TO LNK-FTNJGNCHK-SRYYM
                     MOVE COMB-KOHHKNNUM(TOKU75-IDX2)
                                           TO LNK-FTNJGNCHK-KOHNUM
                     MOVE COMB-KOHID(TOKU75-IDX2)
                                           TO LNK-FTNJGNCHK-KOHID
                     MOVE SYS-1001-PREFNUM TO LNK-FTNJGNCHK-PREFNUM
                     MOVE COMB-HKNCOMBINUM TO LNK-FTNJGNCHK-HKNCOMBINUM
                     MOVE COMB-HKNID       TO LNK-FTNJGNCHK-HKNID
                     CALL "ORCSFTNJGNCHK"  USING
                                           ORCSFTNJGNCHKAREA
                                           SPA-AREA
                     IF     LNK-FTNJGNCHK-RC   =   ZERO
                         MOVE    1    TO    FLG-TOKU75-KOHSKY
                     END-IF
                   END-IF
                 END-PERFORM
             END-IF
      *
           END-PERFORM
      *
           .
       211B1-TOKU75-HANTEI-KOHSKY-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の判定
      *****************************************************************
       211C-TOKUSITU-HANTEI-SEC               SECTION.
      *
           INITIALIZE               TBL-TOKUSITU
           MOVE     ZERO      TO    FLG-TOKUSITU
           MOVE     ZERO      TO    FLG-TOKUSITU-KBN
           MOVE     ZERO      TO    FLG-KISAIOK
           IF   (RECE02-SRYYM       >=  "200905")
           AND  (RECE02-HKNNUM   NOT =   SPACE  )
             IF  (RECE02-HKNNUM(1:2)  =   "98"  OR "90"  OR "91" )
             OR  (RECE02-HKNNUM       =   "068" OR "069" OR "040")
               CONTINUE
             ELSE
               IF (((RECE02-KOHNUM(1)    = "051" OR "091"       ) OR
                    (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                   ( RECE02-KOHFTNJANUM(1)(5:3) = "601" OR "602" ) AND
                   ( RECE02-KOHFTNJANUM(1)(1:2) = "51"           ))
               OR (((RECE02-KOHNUM(1)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                   ( RECE02-KOHFTNJANUM(1)(5:2) = "60"           ) AND
                   ( RECE02-KOHFTNJANUM(1)(1:2) = "52"           ) AND
                   ( RECE02-SRYYM              <= "201412"       ))
               OR (((RECE02-KOHNUM(1)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                   ( RECE02-KOHFTNJANUM(1)(5:1) = "7" OR "8"     ) AND
                   ( RECE02-KOHFTNJANUM(1)(1:2) = "52"           ) AND
                   ( RECE02-SRYYM              >= "201501"       ))
               OR (( RECE02-KOHNUM(1)    = "054"                 ) AND
                   ( RECE02-KOHFTNJANUM(1)(5:3) = "601" OR "501"
                                                        OR "602" ) AND
                   ( RECE02-KOHFTNJANUM(1)(1:2) = "54"           ) AND
                   ( RECE02-SRYYM              >= "201501"       ))
               OR (( RECE02-KOHNUM(1)    = "054"                 ) AND
                   ( RECE02-KOHFTNJANUM(1)(5:1) = "7" OR "8"     ) AND
                   ( RECE02-KOHFTNJANUM(1)(1:2) = "54"           ) AND
                   ( RECE02-SRYYM              >= "201804"       ))
               OR (((RECE02-KOHNUM(2)    = "051" OR "091"       ) OR
                    (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                   ( RECE02-KOHFTNJANUM(2)(5:3) = "601" OR "602" ) AND
                   ( RECE02-KOHFTNJANUM(2)(1:2) = "51"           ))
               OR (((RECE02-KOHNUM(2)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                   ( RECE02-KOHFTNJANUM(2)(5:2) = "60"           ) AND
                   ( RECE02-KOHFTNJANUM(2)(1:2) = "52"           ) AND
                   ( RECE02-SRYYM              <= "201412"       ))
               OR (((RECE02-KOHNUM(2)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                   ( RECE02-KOHFTNJANUM(2)(5:1) = "7" OR "8"     ) AND
                   ( RECE02-KOHFTNJANUM(2)(1:2) = "52"           ) AND
                   ( RECE02-SRYYM              >= "201501"       ))
               OR (( RECE02-KOHNUM(2)    = "054"                 ) AND
                   ( RECE02-KOHFTNJANUM(2)(5:3) = "601" OR "501"
                                                        OR "602" ) AND
                   ( RECE02-KOHFTNJANUM(2)(1:2) = "54"           ) AND
                   ( RECE02-SRYYM              >= "201501"       ))
               OR (( RECE02-KOHNUM(2)    = "054"                 ) AND
                   ( RECE02-KOHFTNJANUM(2)(5:1) = "7" OR "8"     ) AND
                   ( RECE02-KOHFTNJANUM(2)(1:2) = "54"           ) AND
                   ( RECE02-SRYYM              >= "201804"       ))
               OR (((RECE02-KOHNUM(3)    = "051" OR "091"       ) OR
                    (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                   ( RECE02-KOHFTNJANUM(3)(5:3) = "601" OR "602" ) AND
                   ( RECE02-KOHFTNJANUM(3)(1:2) = "51"           ))
               OR (((RECE02-KOHNUM(3)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                   ( RECE02-KOHFTNJANUM(3)(5:2) = "60"           ) AND
                   ( RECE02-KOHFTNJANUM(3)(1:2) = "52"           ) AND
                   ( RECE02-SRYYM              <= "201412"       ))
               OR (((RECE02-KOHNUM(3)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                   ( RECE02-KOHFTNJANUM(3)(5:1) = "7" OR "8"     ) AND
                   ( RECE02-KOHFTNJANUM(3)(1:2) = "52"           ) AND
                   ( RECE02-SRYYM              >= "201501"       ))
               OR (( RECE02-KOHNUM(3)    = "054"                 ) AND
                   ( RECE02-KOHFTNJANUM(3)(5:3) = "601" OR "501"
                                                        OR "602" ) AND
                   ( RECE02-KOHFTNJANUM(3)(1:2) = "54"           ) AND
                   ( RECE02-SRYYM              >= "201501"       ))
               OR (( RECE02-KOHNUM(3)    = "054"                 ) AND
                   ( RECE02-KOHFTNJANUM(3)(5:1) = "7" OR "8"     ) AND
                   ( RECE02-KOHFTNJANUM(3)(1:2) = "54"           ) AND
                   ( RECE02-SRYYM              >= "201804"       ))
               OR (((RECE02-KOHNUM(4)    = "051" OR "091"       ) OR
                    (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                   ( RECE02-KOHFTNJANUM(4)(5:3) = "601" OR "602" ) AND
                   ( RECE02-KOHFTNJANUM(4)(1:2) = "51"           ))
               OR (((RECE02-KOHNUM(4)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                   ( RECE02-KOHFTNJANUM(4)(5:2) = "60"           ) AND
                   ( RECE02-KOHFTNJANUM(4)(1:2) = "52"           ) AND
                   ( RECE02-SRYYM              <= "201412"       ))
               OR (((RECE02-KOHNUM(4)    = "052"                ) OR
                    (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                   ( RECE02-KOHFTNJANUM(4)(5:1) = "7" OR "8"     ) AND
                   ( RECE02-KOHFTNJANUM(4)(1:2) = "52"           ) AND
                   ( RECE02-SRYYM              >= "201501"       ))
               OR (( RECE02-KOHNUM(4)    = "054"                 ) AND
                   ( RECE02-KOHFTNJANUM(4)(5:3) = "601" OR "501"
                                                        OR "602" ) AND
                   ( RECE02-KOHFTNJANUM(4)(1:2) = "54"           ) AND
                   ( RECE02-SRYYM              >= "201501"       ))
               OR (( RECE02-KOHNUM(4)    = "054"                 ) AND
                   ( RECE02-KOHFTNJANUM(4)(5:1) = "7" OR "8"     ) AND
                   ( RECE02-KOHFTNJANUM(4)(1:2) = "54"           ) AND
                   ( RECE02-SRYYM              >= "201804"       ))
               OR (  WRK-KOHJGNGET-TEKIYOFLG(1) =  1              )
               OR (  WRK-KOHJGNGET-TEKIYOFLG(2) =  1              )
               OR (  WRK-KOHJGNGET-TEKIYOFLG(3) =  1              )
               OR (  WRK-KOHJGNGET-TEKIYOFLG(4) =  1              )
      *
                 IF (((RECE02-KOHNUM(1)    = "051" OR "091"       ) OR
                      (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                     ( RECE02-KOHFTNJANUM(1)(5:3) = "601" OR "602" ) AND
                     ( RECE02-KOHFTNJANUM(1)(1:2) = "51"           ))
                 OR (((RECE02-KOHNUM(1)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                     ( RECE02-KOHFTNJANUM(1)(5:2) = "60"           ) AND
                     ( RECE02-KOHFTNJANUM(1)(1:2) = "52"           ) AND
                     ( RECE02-SRYYM              <= "201412"       ))
                 OR (((RECE02-KOHNUM(1)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(1) =  1                   )) AND
                     ( RECE02-KOHFTNJANUM(1)(5:1) = "7" OR "8"     ) AND
                     ( RECE02-KOHFTNJANUM(1)(1:2) = "52"           ) AND
                     ( RECE02-SRYYM              >= "201501"       ))
                 OR (( RECE02-KOHNUM(1)    = "054"                 ) AND
                     ( RECE02-KOHFTNJANUM(1)(5:3) = "601" OR "501"
                                                          OR "602" ) AND
                     ( RECE02-KOHFTNJANUM(1)(1:2) = "54"           ) AND
                     ( RECE02-SRYYM              >= "201501"       ))
                 OR (( RECE02-KOHNUM(1)    = "054"                 ) AND
                     ( RECE02-KOHFTNJANUM(1)(5:1) = "7" OR "8"     ) AND
                     ( RECE02-KOHFTNJANUM(1)(1:2) = "54"           ) AND
                     ( RECE02-SRYYM              >= "201804"       ))
                 OR (  WRK-KOHJGNGET-TEKIYOFLG(1) =  1              )
                    MOVE     1     TO    TBL-TOKUSITUFLG(1)
                 END-IF
                 IF (((RECE02-KOHNUM(2)    = "051" OR "091"       ) OR
                      (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                     ( RECE02-KOHFTNJANUM(2)(5:3) = "601" OR "602" ) AND
                     ( RECE02-KOHFTNJANUM(2)(1:2) = "51"           ))
                 OR (((RECE02-KOHNUM(2)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                     ( RECE02-KOHFTNJANUM(2)(5:2) = "60"           ) AND
                     ( RECE02-KOHFTNJANUM(2)(1:2) = "52"           ) AND
                     ( RECE02-SRYYM              <= "201412"       ))
                 OR (((RECE02-KOHNUM(2)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(2) =  1                   )) AND
                     ( RECE02-KOHFTNJANUM(2)(5:1) = "7" OR "8"     ) AND
                     ( RECE02-KOHFTNJANUM(2)(1:2) = "52"           ) AND
                     ( RECE02-SRYYM              >= "201501"       ))
                 OR (( RECE02-KOHNUM(2)    = "054"                 ) AND
                     ( RECE02-KOHFTNJANUM(2)(5:3) = "601" OR "501"
                                                          OR "602" ) AND
                     ( RECE02-KOHFTNJANUM(2)(1:2) = "54"           ) AND
                     ( RECE02-SRYYM              >= "201501"       ))
                 OR (( RECE02-KOHNUM(2)    = "054"                 ) AND
                     ( RECE02-KOHFTNJANUM(2)(5:1) = "7" OR "8"     ) AND
                     ( RECE02-KOHFTNJANUM(2)(1:2) = "54"           ) AND
                     ( RECE02-SRYYM              >= "201804"       ))
                 OR (  WRK-KOHJGNGET-TEKIYOFLG(2) =  1              )
                    MOVE     1     TO    TBL-TOKUSITUFLG(2)
                 END-IF
                 IF (((RECE02-KOHNUM(3)    = "051" OR "091"       ) OR
                      (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                     ( RECE02-KOHFTNJANUM(3)(5:3) = "601" OR "602" ) AND
                     ( RECE02-KOHFTNJANUM(3)(1:2) = "51"           ))
                 OR (((RECE02-KOHNUM(3)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                     ( RECE02-KOHFTNJANUM(3)(5:2) = "60"           ) AND
                     ( RECE02-KOHFTNJANUM(3)(1:2) = "52"           ) AND
                     ( RECE02-SRYYM              <= "201412"       ))
                 OR (((RECE02-KOHNUM(3)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(3) =  1                   )) AND
                     ( RECE02-KOHFTNJANUM(3)(5:1) = "7" OR "8"     ) AND
                     ( RECE02-KOHFTNJANUM(3)(1:2) = "52"           ) AND
                     ( RECE02-SRYYM              >= "201501"       ))
                 OR (( RECE02-KOHNUM(3)    = "054"                 ) AND
                     ( RECE02-KOHFTNJANUM(3)(5:3) = "601" OR "501"
                                                          OR "602" ) AND
                     ( RECE02-KOHFTNJANUM(3)(1:2) = "54"           ) AND
                     ( RECE02-SRYYM              >= "201501"       ))
                 OR (( RECE02-KOHNUM(3)    = "054"                 ) AND
                     ( RECE02-KOHFTNJANUM(3)(5:1) = "7" OR "8"     ) AND
                     ( RECE02-KOHFTNJANUM(3)(1:2) = "54"           ) AND
                     ( RECE02-SRYYM              >= "201804"       ))
                 OR (  WRK-KOHJGNGET-TEKIYOFLG(3) =  1              )
                    MOVE     1     TO    TBL-TOKUSITUFLG(3)
                 END-IF
                 IF (((RECE02-KOHNUM(4)    = "051" OR "091"       ) OR
                      (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                     ( RECE02-KOHFTNJANUM(4)(5:3) = "601" OR "602" ) AND
                     ( RECE02-KOHFTNJANUM(4)(1:2) = "51"           ))
                 OR (((RECE02-KOHNUM(4)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                     ( RECE02-KOHFTNJANUM(4)(5:2) = "60"           ) AND
                     ( RECE02-KOHFTNJANUM(4)(1:2) = "52"           ) AND
                     ( RECE02-SRYYM              <= "201412"       ))
                 OR (((RECE02-KOHNUM(4)    = "052"                ) OR
                      (TBL-TOKATUKAIFLG(4) =  1                   )) AND
                     ( RECE02-KOHFTNJANUM(4)(5:1) = "7" OR "8"     ) AND
                     ( RECE02-KOHFTNJANUM(4)(1:2) = "52"           ) AND
                     ( RECE02-SRYYM              >= "201501"       ))
                 OR (( RECE02-KOHNUM(4)    = "054"                 ) AND
                     ( RECE02-KOHFTNJANUM(4)(5:3) = "601" OR "501"
                                                          OR "602" ) AND
                     ( RECE02-KOHFTNJANUM(4)(1:2) = "54"           ) AND
                     ( RECE02-SRYYM              >= "201501"       ))
                 OR (( RECE02-KOHNUM(4)    = "054"                 ) AND
                     ( RECE02-KOHFTNJANUM(4)(5:1) = "7" OR "8"     ) AND
                     ( RECE02-KOHFTNJANUM(4)(1:2) = "54"           ) AND
                     ( RECE02-SRYYM              >= "201804"       ))
                 OR (  WRK-KOHJGNGET-TEKIYOFLG(4) =  1              )
                    MOVE     1     TO    TBL-TOKUSITUFLG(4)
                 END-IF
      *
                 MOVE      RECE02-SRYYM         TO   WRK-GEN70-YM
                 IF   RECE02-TEKSTYMD(1:6)  >=  RECE02-SRYYM
                   MOVE    RECE02-TEKSTYMD(7:2) TO   WRK-GEN70-DD
                 ELSE
                   MOVE    01                   TO   WRK-GEN70-DD
                 END-IF
      *
                 MOVE      RECE02-SRYYM         TO   WRK-GEN702-YM
                 IF   RECE02-TEKSTYMD-X(1:6)  >=  RECE02-SRYYM
                   MOVE    RECE02-TEKSTYMD-X(7:2)
                                                TO   WRK-GEN702-DD
                 ELSE
                   MOVE    01                   TO   WRK-GEN702-DD
                 END-IF
      *
                 IF   RECE02-KOUREI-HANTEIFLG   =   "1"
                   IF    RECE02-KYURATE     =   30
                        MOVE    1    TO   FLG-TOKUSITU
                   ELSE
                     IF  RECE02-TEISYOTOKU  =  SPACE
                        MOVE    2    TO   FLG-TOKUSITU
                     ELSE
                        MOVE    3    TO   FLG-TOKUSITU
                     END-IF
                   END-IF
                 ELSE
                   PERFORM   211C1-TOKUSITU-HANTEI2-SEC
                 END-IF
      *
                 IF   FLG-TOKUSITU  NOT = ZERO
                   PERFORM   211C3-TOKUSITU-HENSYU4-SEC
                 ELSE
                   MOVE    ZERO    TO    TBL-TOKUSITUFLG(1)
                   MOVE    ZERO    TO    TBL-TOKUSITUFLG(2)
                   MOVE    ZERO    TO    TBL-TOKUSITUFLG(3)
                   MOVE    ZERO    TO    TBL-TOKUSITUFLG(4)
                 END-IF
      *
               ELSE
      *
                 IF      IDZ   =   2
                   MOVE      RECE02-SRYYM         TO   WRK-GEN70-YM
                   IF   RECE02-TEKSTYMD(1:6)  >=  RECE02-SRYYM
                     MOVE    RECE02-TEKSTYMD(7:2) TO   WRK-GEN70-DD
                   ELSE
                     MOVE    01                   TO   WRK-GEN70-DD
                   END-IF
      *
                   MOVE      RECE02-SRYYM         TO   WRK-GEN702-YM
                   IF   RECE02-TEKSTYMD-X(1:6)  >=  RECE02-SRYYM
                     MOVE    RECE02-TEKSTYMD-X(7:2)
                                                  TO   WRK-GEN702-DD
                   ELSE
                     MOVE    01                   TO   WRK-GEN702-DD
                   END-IF
      *
                   IF   RECE02-KOUREI-HANTEIFLG   =   "1"
                     INITIALIZE                      SSRHKOH-AREA
                     MOVE    RECE02-PTID         TO  SSRHKOH-PTID
                     MOVE    "2"                 TO  SSRHKOH-NYUGAIKBN
                     MOVE    RECE02-SRYYM        TO  SSRHKOH-SRYYM
                     MOVE    RECE02-HKNCOMBI(1)  TO  SSRHKOH-HKNCOMBI
                     CALL    "ORCSSRHKOH"        USING
                                                 SSRHKOH-AREA
                                                 SPA-AREA
                     IF   SSRHKOH-RC  =  1
                        IF    RECE02-KYURATE     =   30
                             MOVE    1    TO   FLG-TOKUSITU
                        ELSE
                          IF  RECE02-TEISYOTOKU  =  SPACE
                             MOVE    2    TO   FLG-TOKUSITU
                          ELSE
                             MOVE    3    TO   FLG-TOKUSITU
                          END-IF
                        END-IF
                     END-IF
                   ELSE
                     INITIALIZE                      SSRHKOH-AREA
                     MOVE    RECE02-PTID         TO  SSRHKOH-PTID
                     MOVE    "2"                 TO  SSRHKOH-NYUGAIKBN
                     MOVE    RECE02-SRYYM        TO  SSRHKOH-SRYYM
                     MOVE    RECE02-HKNCOMBI(1)  TO  SSRHKOH-HKNCOMBI
                     CALL    "ORCSSRHKOH"        USING
                                                 SSRHKOH-AREA
                                                 SPA-AREA
                     IF   SSRHKOH-RC  =  1
                        PERFORM   211C1-TOKUSITU-HANTEI2-SEC
                     END-IF
                   END-IF
                   IF   FLG-TOKUSITU  NOT = ZERO
                        PERFORM   211C3-TOKUSITU-HENSYU4-SEC
                   END-IF
                 END-IF
      *
               END-IF
             END-IF
           END-IF
      *
           .
       211C-TOKUSITU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       211C1-TOKUSITU-HANTEI2-SEC               SECTION.
      *
           INITIALIZE                      PTKOHINF-REC
           MOVE  RECE02-HOSPNUM        TO  PTKOH-HOSPNUM
           MOVE  RECE02-PTID           TO  PTKOH-PTID
           MOVE  "966"                 TO  PTKOH-KOHNUM
           MOVE  PTKOHINF-REC          TO  MCPDATA-REC
           MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
           MOVE  "key14"               TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
             MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
             MOVE    "key14"           TO  MCP-PATHNAME
             PERFORM  900-PTKOHINF-READ-SEC
             PERFORM  UNTIL   FLG-PTKOHINF    =   1
                IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                    (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                    (PTKOH-SAKJOKBN   =   SPACE         ))
                OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                    (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                    (PTKOH-SAKJOKBN   =   SPACE         ))
                  MOVE     1      TO  FLG-TOKUSITU
                  IF  RECE02-SRYYM  >= "201501"
                    IF  PTKOH-JKYSNUM(1:2) = "イ"
                      MOVE   12   TO  FLG-TOKUSITU-KBN
                    ELSE
                      MOVE   11   TO  FLG-TOKUSITU-KBN
                    END-IF
                  END-IF
                  MOVE     1      TO  FLG-PTKOHINF
                ELSE
                  MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                  MOVE    "key14"          TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                END-IF
             END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key14"              TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           IF    FLG-TOKUSITU  =  ZERO
             INITIALIZE                      PTKOHINF-REC
             MOVE  RECE02-HOSPNUM        TO  PTKOH-HOSPNUM
             MOVE  RECE02-PTID           TO  PTKOH-PTID
             MOVE  "967"                 TO  PTKOH-KOHNUM
             MOVE  PTKOHINF-REC          TO  MCPDATA-REC
             MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
             MOVE  "key14"               TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
               MOVE    "key14"           TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                      (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                  OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                      (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                    IF  RECE02-TEISYOTOKU  =  SPACE
                        MOVE    2    TO   FLG-TOKUSITU
                        IF  RECE02-SRYYM  >= "201501"
                          IF  PTKOH-JKYSNUM(1:2) = "エ"
                           MOVE  22  TO   FLG-TOKUSITU-KBN
                          ELSE
                           MOVE  21  TO   FLG-TOKUSITU-KBN
                          END-IF
                        END-IF
                    ELSE
                        MOVE    3    TO   FLG-TOKUSITU
                        IF  RECE02-SRYYM  >= "201501"
                           MOVE  31  TO   FLG-TOKUSITU-KBN
                        END-IF
                    END-IF
                    MOVE        1    TO   FLG-PTKOHINF
                  ELSE
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key14"          TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key14"              TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-IF
      *
      ***
      *
           IF    FLG-TOKUSITU  =  ZERO
             INITIALIZE                      PTKOHINF-REC
             MOVE  RECE02-HOSPNUM        TO  PTKOH-HOSPNUM
             MOVE  RECE02-PTID           TO  PTKOH-PTID
             MOVE  "956"                 TO  PTKOH-KOHNUM
             MOVE  PTKOHINF-REC          TO  MCPDATA-REC
             MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
             MOVE  "key14"               TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
               MOVE    "key14"           TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                      (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                  OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                      (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                    MOVE     1      TO  FLG-TOKUSITU
                    IF  RECE02-SRYYM  >= "201501"
                      IF  PTKOH-JKYSNUM(1:2) = "イ"
                        MOVE   12   TO  FLG-TOKUSITU-KBN
                      ELSE
                        MOVE   11   TO  FLG-TOKUSITU-KBN
                      END-IF
                    END-IF
                    MOVE     1      TO  FLG-PTKOHINF
                  ELSE
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key14"          TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key14"              TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-IF
      *
           IF    FLG-TOKUSITU  =  ZERO
             INITIALIZE                      PTKOHINF-REC
             MOVE  RECE02-HOSPNUM        TO  PTKOH-HOSPNUM
             MOVE  RECE02-PTID           TO  PTKOH-PTID
             MOVE  "957"                 TO  PTKOH-KOHNUM
             MOVE  PTKOHINF-REC          TO  MCPDATA-REC
             MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
             MOVE  "key14"               TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
               MOVE    "key14"           TO  MCP-PATHNAME
               PERFORM  900-PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                      (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                  OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                      (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                      (PTKOH-SAKJOKBN   =   SPACE         ))
                    IF  RECE02-TEISYOTOKU  =  SPACE
                        MOVE    2    TO   FLG-TOKUSITU
                        IF  RECE02-SRYYM  >= "201501"
                          IF  PTKOH-JKYSNUM(1:2) = "エ"
                           MOVE  22  TO   FLG-TOKUSITU-KBN
                          ELSE
                           MOVE  21  TO   FLG-TOKUSITU-KBN
                          END-IF
                        END-IF
                    ELSE
                        MOVE    3    TO   FLG-TOKUSITU
                        IF  RECE02-SRYYM  >= "201501"
                           MOVE  31  TO   FLG-TOKUSITU-KBN
                        END-IF
                    END-IF
                    MOVE        1    TO   FLG-PTKOHINF
                  ELSE
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key14"          TO  MCP-PATHNAME
                    PERFORM  900-PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key14"              TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
           END-IF
      *
           .
       211C1-TOKUSITU-HANTEI2-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       211C2-TOKUSITU-HANTEI3-SEC               SECTION.
      *
           INITIALIZE                      PTKOHINF-REC
           MOVE  RECE02-HOSPNUM        TO  PTKOH-HOSPNUM
           MOVE  RECE02-PTID           TO  PTKOH-PTID
           MOVE  "957"                 TO  PTKOH-KOHNUM
           MOVE  PTKOHINF-REC          TO  MCPDATA-REC
           MOVE  "tbl_ptkohinf"        TO  MCP-TABLE
           MOVE  "key14"               TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
             MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
             MOVE    "key14"           TO  MCP-PATHNAME
             PERFORM  900-PTKOHINF-READ-SEC
             PERFORM  UNTIL   FLG-PTKOHINF    =   1
                IF ((PTKOH-TEKSTYMD  <=   WRK-GEN70-YMD ) AND
                    (WRK-GEN70-YMD   <=   PTKOH-TEKEDYMD) AND
                    (PTKOH-SAKJOKBN   =   SPACE         ))
                OR ((PTKOH-TEKSTYMD  <=   WRK-GEN702-YMD) AND
                    (WRK-GEN702-YMD  <=   PTKOH-TEKEDYMD) AND
                    (PTKOH-SAKJOKBN   =   SPACE         ))
                  MOVE    1    TO   FLG-KISAIOK
                  MOVE    1    TO   FLG-PTKOHINF
                ELSE
                  MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                  MOVE    "key14"          TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                END-IF
             END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key14"              TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       211C2-TOKUSITU-HANTEI3-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       211C3-TOKUSITU-HENSYU4-SEC               SECTION.
      *
           IF   RECE02-KOUREI-HANTEIFLG   =   "1"
             IF    RECE02-KYURATE     =   30
               MOVE      1   TO   FLG-KISAIOK
             ELSE
               IF  RECE02-TEISYOTOKU  =  SPACE
                 IF  RECE02-SRYYM  >= "201808"
                   MOVE  1   TO   FLG-KISAIOK
                 ELSE
                   PERFORM 211C2-TOKUSITU-HANTEI3-SEC
                 END-IF
               ELSE
                 MOVE    1   TO   FLG-KISAIOK
               END-IF
             END-IF
           ELSE
             MOVE        1   TO   FLG-KISAIOK
           END-IF
      *
           IF   FLG-KISAIOK  =  1
             IF  RECE02-KOUREI-HANTEIFLG = "1"
               IF  RECE02-SRYYM  >= "201808"
                 MOVE  20    TO   FLG-TOKKI
               ELSE
                 MOVE   7    TO   FLG-TOKKI
               END-IF
             ELSE
               IF  RECE02-SRYYM   >=  "201501"
                 MOVE  15    TO   FLG-TOKKI
               ELSE
                 MOVE   7    TO   FLG-TOKKI
               END-IF
             END-IF
             PERFORM   21045-TOKKI-HENSYU-SEC
             IF  RECE02-SRYYM   >=  "201501"
               IF   FLG-TOKUSITU   NOT =  ZERO
                   MOVE   1    TO   RECE02-RJNNYUKOHFTN(2)
               END-IF
             ELSE
               EVALUATE  FLG-TOKUSITU
                 WHEN       1
                   MOVE   1    TO   RECE02-RJNNYUKOHFTN(2)
                 WHEN       2
                   MOVE   2    TO   RECE02-RJNNYUKOHFTN(2)
                 WHEN       3
                   MOVE   3    TO   RECE02-RJNNYUKOHFTN(2)
               END-EVALUATE
             END-IF
           END-IF
      *
           IF     (IDZ             =   1      )
           AND    (RECE02-SRYYM   >=  "201501")
             MOVE     ZERO    TO     IDX29
             PERFORM  VARYING  IDX27  FROM  1  BY  1
                       UNTIL  (IDX27                  >  10  )
                         OR   (RECE02-HKNCOMBI(IDX27) =  ZERO)
               INITIALIZE                  HKNCOMBI-REC
               MOVE    RECE02-HOSPNUM  TO  COMB-HOSPNUM
               MOVE    RECE02-PTID     TO  COMB-PTID
               MOVE    RECE02-HKNCOMBI(IDX27)
                                       TO  COMB-HKNCOMBINUM
               MOVE    HKNCOMBI-REC    TO  MCPDATA-REC
               PERFORM 900-HKNCOMBI-INV-SEC
               IF      FLG-HKNCOMBI    =   ZERO
                 PERFORM  VARYING  IDX28  FROM  1  BY  1
                           UNTIL   IDX28    >   4
                   IF ((COMB-KOHHKNNUM(IDX28) = RECE02-KOHNUM(1)) AND
                       (COMB-KOHID(IDX28)     = RECE02-KOHID(1) ) AND
                       (TBL-TOKUSITUFLG(1)    =   1             ))
                   OR ((COMB-KOHHKNNUM(IDX28) = RECE02-KOHNUM(2)) AND
                       (COMB-KOHID(IDX28)     = RECE02-KOHID(2) ) AND
                       (TBL-TOKUSITUFLG(2)    =   1             ))
                   OR ((COMB-KOHHKNNUM(IDX28) = RECE02-KOHNUM(3)) AND
                       (COMB-KOHID(IDX28)     = RECE02-KOHID(3) ) AND
                       (TBL-TOKUSITUFLG(3)    =   1             ))
                   OR ((COMB-KOHHKNNUM(IDX28) = RECE02-KOHNUM(4)) AND
                       (COMB-KOHID(IDX28)     = RECE02-KOHID(4) ) AND
                       (TBL-TOKUSITUFLG(4)    =   1             ))
                     INITIALIZE               ORCSFTNJGNCHKAREA
                     MOVE RECE02-HOSPNUM   TO LNK-FTNJGNCHK-HOSPNUM
                     MOVE RECE02-PTID      TO LNK-FTNJGNCHK-PTID
                     MOVE "2"              TO LNK-FTNJGNCHK-NYUGAIKBN
                     MOVE RECE02-SRYYM     TO LNK-FTNJGNCHK-SRYYM
                     MOVE COMB-KOHHKNNUM(IDX28)
                                           TO LNK-FTNJGNCHK-KOHNUM
                     MOVE COMB-KOHID(IDX28)
                                           TO LNK-FTNJGNCHK-KOHID
                     MOVE SYS-1001-PREFNUM TO LNK-FTNJGNCHK-PREFNUM
                     MOVE COMB-HKNCOMBINUM TO LNK-FTNJGNCHK-HKNCOMBINUM
                     MOVE COMB-HKNID       TO LNK-FTNJGNCHK-HKNID
                     CALL "ORCSFTNJGNCHK"  USING
                                           ORCSFTNJGNCHKAREA
                                           SPA-AREA
                     IF   LNK-FTNJGNCHK-SKYZEROFLG  =  SPACE
                       ADD     1    TO     IDX29
                     ELSE
                       IF  (COMB-KOHHKNNUM(IDX28) = RECE02-KOHNUM(1))
                       AND (COMB-KOHID(IDX28)     = RECE02-KOHID(1) )
                       AND (TBL-TOKUSITUFLG(1)    =   1             )
                          MOVE    ZERO     TO TBL-TOKUSITUFLG(1)
                       END-IF
                       IF  (COMB-KOHHKNNUM(IDX28) = RECE02-KOHNUM(2))
                       AND (COMB-KOHID(IDX28)     = RECE02-KOHID(2) )
                       AND (TBL-TOKUSITUFLG(2)    =   1             )
                          MOVE    ZERO     TO TBL-TOKUSITUFLG(2)
                       END-IF
                       IF  (COMB-KOHHKNNUM(IDX28) = RECE02-KOHNUM(3))
                       AND (COMB-KOHID(IDX28)     = RECE02-KOHID(3) )
                       AND (TBL-TOKUSITUFLG(3)    =   1             )
                          MOVE    ZERO     TO TBL-TOKUSITUFLG(3)
                       END-IF
                       IF  (COMB-KOHHKNNUM(IDX28) = RECE02-KOHNUM(4))
                       AND (COMB-KOHID(IDX28)     = RECE02-KOHID(4) )
                       AND (TBL-TOKUSITUFLG(4)    =   1             )
                          MOVE    ZERO     TO TBL-TOKUSITUFLG(4)
                       END-IF
                     END-IF
                   END-IF
                 END-PERFORM
               END-IF
             END-PERFORM
             IF  IDX29  =  ZERO
               MOVE     ZERO      TO    FLG-TOKUSITU
               MOVE     ZERO      TO    FLG-TOKUSITU-KBN
               MOVE     ZERO      TO    RECE02-RJNNYUKOHFTN(2)
             END-IF
           END-IF
      *
           .
       211C3-TOKUSITU-HENSYU4-EXT.
           EXIT.
      *
      *****************************************************************
      *    その他記載フラグの編集
      *    特定疾患扱いとする地方公費フラグ等の編集
      *    マル長レセプト記載処理区分の編集
      *****************************************************************
       211R-ETCKISAIFLGINF-HENSYU-SEC      SECTION.
      *
           IF    IDZ    =    1
      *
             PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                         UNTIL    KOHFTN-IDX     >    4
      *
              IF   RECE02-KOHNUM(KOHFTN-IDX)(1:1) >=  "1" AND <=  "8"
      *
                 IF    RECE02-SRYYM        >=  "200804"
                    INITIALIZE                   SYSKANRI-REC
                    MOVE    "2010"           TO  SYS-KANRICD
                    MOVE    RECE02-KOHNUM(KOHFTN-IDX)
                                             TO  SYS-KBNCD
                    MOVE    RECE02-SRYYM     TO  SYS-STYUKYMD (1:6)
                    MOVE    "01"             TO  SYS-STYUKYMD (7:2)
                    MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
                    MOVE    "tbl_syskanri"   TO  WRK-MCP-TABLE
                    MOVE    "key10"          TO  WRK-MCP-PATHNAME
                    PERFORM 960-KANRIMST-READ-SEC
                    IF      FLG-SYSKANRI     =   ZERO
                      MOVE    MCPDATA-REC   TO  SYS-2010-REC
                    ELSE
                      INITIALIZE                SYS-2010-REC
                    END-IF
                    PERFORM   211R1-ETCKISAIFLGINF-SET-SEC
                 ELSE
                    PERFORM   211R2-ETCKISAIFLGINF-SET2-SEC
                 END-IF
                 PERFORM      211R3-ETCKISAIFLGINF-KURIA-SEC
      *
              END-IF
      *
             END-PERFORM
      *
      ****
      *
             PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                         UNTIL    KOHFTN-IDX     >    4
      *
              IF  ((SYS-1001-PREFNUM           =   13     ) AND
                   (RECE02-KOHNUM(KOHFTN-IDX)  =  "151"   ) AND
                   (RECE02-SRYYM              >=  "200905"))
              OR  ((SYS-1001-PREFNUM           =   23     ) AND
                   (RECE02-KOHNUM(KOHFTN-IDX)  =  "191"   ) AND
                   (RECE02-SRYYM              >=  "200910"))
              OR  ((SYS-1001-PREFNUM      =  23 OR 24     ) AND
                   (RECE02-KOHNUM(KOHFTN-IDX)  =  "152"   ) AND
                   (RECE02-SRYYM              >=  "201104") AND
                   (RECE02-SRYYM              <=  "201412"))
                 MOVE     1     TO    TBL-TOKATUKAIFLG(KOHFTN-IDX)
              END-IF
      *
              IF   RECE02-KOHNUM(KOHFTN-IDX)(1:1) >=  "1" AND <=  "8"
      *
                 INITIALIZE                   LNK-ORCSJGNGET-REC
                 MOVE   RECE02-HOSPNUM    TO  LNK-ORCSJGNGET-HOSPNUM
                 MOVE   RECE02-KOHNUM(KOHFTN-IDX)
                                          TO  LNK-ORCSJGNGET-KOHHKNNUM
                 MOVE   RECE02-KOHTEKSTYMD(KOHFTN-IDX)
                                          TO  LNK-ORCSJGNGET-TEKSTYMD
                 MOVE   SYS-1001-PREFNUM  TO  LNK-ORCSJGNGET-PREFNUM
                 MOVE   "1"               TO  LNK-ORCSJGNGET-HENFLG
                 CALL   "ORCSJGNGET"      USING
                                          LNK-ORCSJGNGET-REC
                                          SPA-AREA
                 IF     LNK-ORCSJGNGET-RC     =   ZERO
                   MOVE   LNK-ORCSJGNGET-TAISYOKBN
                             TO    WRK-KOHJGNGET-TAISYOKBN(KOHFTN-IDX)
                   IF  (RECE02-SRYYM                >=  "201501")
                   AND (LNK-ORCSJGNGET-TEKIYOFLG     =   1      )
                   AND (TBL-TOKATUKAIFLG(KOHFTN-IDX) =   ZERO   )
                     MOVE  1   TO  WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)
      ***************MOVE  1   TO  TBL-TOKATUKAIFLG(KOHFTN-IDX)
                   END-IF
                 END-IF
      *
              END-IF
      *
             END-PERFORM
      *
      ****
      *
             IF    RECE02-SRYYM  >=  "202001"
                 INITIALIZE                   SYSKANRI-REC
                 MOVE    "2010"           TO  SYS-KANRICD
                 MOVE    "972"            TO  SYS-KBNCD
                 MOVE    RECE02-SRYYM     TO  SYS-STYUKYMD (1:6)
                 MOVE    "01"             TO  SYS-STYUKYMD (7:2)
                 MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
                 MOVE    "tbl_syskanri"   TO  WRK-MCP-TABLE
                 MOVE    "key10"          TO  WRK-MCP-PATHNAME
                 PERFORM 960-KANRIMST-READ-SEC
                 IF      FLG-SYSKANRI     =   ZERO
                   MOVE  MCPDATA-REC      TO  SYS-2010-REC
                 ELSE
                   INITIALIZE                 SYS-2010-REC
                 END-IF
                 IF      SYS-2010-CYOKI-FTNKBN  =  "0"
                 AND     SYS-2010-CYOKI-KSIKBN  =  "1"
                   EVALUATE  SYS-2010-CYOKI-KSIKBN-TAIKBN
                     WHEN      "0"
                         MOVE  "1"  TO  RECE02-CYOKI-KSIKBN
                     WHEN      "1"
                       IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                         MOVE  "1"  TO  RECE02-CYOKI-KSIKBN
                       END-IF
                     WHEN      "2"
                       IF   RECE02-TEISYUTUSAKI  =  1
                         MOVE  "1"  TO  RECE02-CYOKI-KSIKBN
                       END-IF
                     WHEN      "3"
                       IF   RECE02-TEISYUTUSAKI  =  2
                         MOVE  "1"  TO  RECE02-CYOKI-KSIKBN
                       END-IF
                     WHEN      "4"
                       IF   RECE02-TEISYUTUSAKI  =  6
                         MOVE  "1"  TO  RECE02-CYOKI-KSIKBN
                       END-IF
                   END-EVALUATE
                 END-IF
             END-IF
      *
           END-IF
      *
           .
       211R-ETCKISAIFLGINF-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    その他記載フラグセット
      *****************************************************************
       211R1-ETCKISAIFLGINF-SET-SEC               SECTION.
      *
           EVALUATE  SYS-2010-JNISSUKBN
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-JNISSUFLG(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-JNISSU-TAIKBN
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "2"
               MOVE    SPACE   TO RECE02-EKF-JNISSUFLG(KOHFTN-IDX + 1)
               EVALUATE  SYS-2010-JNISSU-TAIKBN
                 WHEN        "0"
                    MOVE  "2"  TO RECE02-MJK-JNISSUFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "2"  TO RECE02-MJK-JNISSUFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "2"  TO RECE02-MJK-JNISSUFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "2"  TO RECE02-MJK-JNISSUFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "2"  TO RECE02-MJK-JNISSUFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-TOTALTENKBN
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-TOTALTEN-TAIKBN
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "2"
               MOVE    SPACE   TO RECE02-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
               EVALUATE  SYS-2010-TOTALTEN-TAIKBN
                 WHEN        "0"
                    MOVE  "2"  TO RECE02-MJK-TOTALTENFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "2"  TO RECE02-MJK-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "2"  TO RECE02-MJK-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "2"  TO RECE02-MJK-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "2"  TO RECE02-MJK-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-FTNMONEYKBN-G
             WHEN      "0"
                    MOVE SPACE TO RECE02-KISAIFLG(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-FTNMONEY-TAIKBN-G
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-KISAIFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-KISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-KISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-KISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-KISAIFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "2"
               MOVE    SPACE   TO RECE02-KISAIFLG(KOHFTN-IDX + 1)
               EVALUATE  SYS-2010-FTNMONEY-TAIKBN-G
                 WHEN        "0"
                    MOVE  "2"  TO RECE02-MJK-KISAIFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "2"  TO RECE02-MJK-KISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "2"  TO RECE02-MJK-KISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "2"  TO RECE02-MJK-KISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "2"  TO RECE02-MJK-KISAIFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-FTNZEROKBN-G
             WHEN      "0"
                    MOVE SPACE TO RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-FTNZERO-TAIKBN-G
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "2"
               MOVE    SPACE   TO RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
               EVALUATE  SYS-2010-FTNZERO-TAIKBN-G
                 WHEN        "0"
                    MOVE "2" TO RECE02-MJK-ZEROKISAIFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE "2" TO RECE02-MJK-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE "2" TO RECE02-MJK-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE "2" TO RECE02-MJK-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE "2" TO RECE02-MJK-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-OCRKBN
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-OCRFLG(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-OCR-TAIKBN
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-OCRFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-OCRFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-OCRFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-OCRFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-OCRFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "2"
               MOVE    SPACE   TO RECE02-EKF-OCRFLG(KOHFTN-IDX + 1)
               EVALUATE  SYS-2010-OCR-TAIKBN
                 WHEN        "0"
                    MOVE  "2"  TO RECE02-MJK-OCRFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "2"  TO RECE02-MJK-OCRFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "2"  TO RECE02-MJK-OCRFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "2"  TO RECE02-MJK-OCRFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "2"  TO RECE02-MJK-OCRFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-FTNKEIKBN-G
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "29"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6            )
                  AND (RECE02-KOHHBTNUM(KOHFTN-IDX)
                                    =  "71" OR "81" OR "91" OR "80")
                    MOVE "1" TO
                          RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "32"
                  IF ((RECE02-TEISYUTUSAKI   =   2 OR 6    ) AND
                      (RECE02-KOHNUM(KOHFTN-IDX) =  "790"  ) AND
                      (RECE02-SRYYM         >=  "201107"   ) AND
                      (RECE02-SRYYM         <=  "201409"   ))
                  OR ((RECE02-TEISYUTUSAKI   =   2 OR 6    ) AND
                      (RECE02-KOHNUM(KOHFTN-IDX) =  "393"  ) AND
                      (RECE02-SRYYM         >=  "201007"   ) AND
                      (RECE02-SRYYM         <=  "201309"   ))
                  OR ((RECE02-TEISYUTUSAKI   =   2 OR 6    ) AND
                      (RECE02-KOHNUM(KOHFTN-IDX) =  "493"  ) AND
                      (RECE02-SRYYM         >=  "201107"   ) AND
                      (RECE02-SRYYM         <=  "201409"   ))
                  OR ((RECE02-TEISYUTUSAKI   =   2 OR 6    ) AND
                      (RECE02-KOHNUM(KOHFTN-IDX) =
                         "625" OR "627" OR "628" OR "629"  ) AND
                      (RECE02-SRYYM         >=  "201302"   ) AND
                      (RECE02-SRYYM         <=  "201409"   ))
                    MOVE "1" TO
                          RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "35"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
                  AND (RECE02-KOHNUM(KOHFTN-IDX) =  "781"  )
                  AND (RECE02-SRYYM         >=  "201004"   )
                    MOVE "1" TO
                          RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "39"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
                  AND (RECE02-KOHHBTNUM(KOHFTN-IDX) =  "72")
                    MOVE "1" TO
                          RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "45"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
                  AND (RECE02-KOHNUM(KOHFTN-IDX) =  "190"  )
                    MOVE "2" TO
                          RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
               MOVE SPACE TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "32"
                  IF ((RECE02-TEISYUTUSAKI   =   2 OR 6    ) AND
                      (RECE02-KOHNUM(KOHFTN-IDX) =  "393"  ) AND
                      (RECE02-SRYYM         >=  "201007"   ) AND
                      (RECE02-SRYYM         <=  "201309"   ))
                  OR ((RECE02-TEISYUTUSAKI   =   2 OR 6    ) AND
                      (RECE02-KOHNUM(KOHFTN-IDX) =  "790"  ) AND
                      (RECE02-SRYYM         >=  "201107"   ) AND
                      (RECE02-SRYYM         <=  "201409"   ))
                  OR ((RECE02-TEISYUTUSAKI   =   2 OR 6    ) AND
                      (RECE02-KOHNUM(KOHFTN-IDX) =  "493"  ) AND
                      (RECE02-SRYYM         >=  "201107"   ) AND
                      (RECE02-SRYYM         <=  "201409"   ))
                  OR ((RECE02-TEISYUTUSAKI   =   2 OR 6    ) AND
                      (RECE02-KOHNUM(KOHFTN-IDX) =
                         "625" OR "627" OR "628" OR "629"  ) AND
                      (RECE02-SRYYM         >=  "201302"   ) AND
                      (RECE02-SRYYM         <=  "201409"   ))
                    MOVE "1" TO
                          RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "1"
               EVALUATE  SYS-2010-FTNKEI-TAIKBN-G
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "2"
               EVALUATE  SYS-2010-FTNKEI-TAIKBN-G
                 WHEN        "0"
                    MOVE  "2"  TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "2"  TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "2"  TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "2"  TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "2"  TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-HKNFTNKBN-K
             WHEN      SPACE
               IF  (SYS-1001-PREFNUM          =  "42" )
               AND (RECE02-KOHNUM(KOHFTN-IDX) =  "186")
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-K(KOHFTN-IDX + 1)
               ELSE
                 IF   RECE02-TEISYUTUSAKI   =   1
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-K(KOHFTN-IDX + 1)
                 END-IF
               END-IF
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-HKNFTNFLG-K(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-HKNFTN-TAIKBN-K
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-K(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
           IF  SYS-2010-HKNFTNKBN-K = "0"
               MOVE  "0"  TO RECE02-EKF-HKNFTNFLG-K2(KOHFTN-IDX + 1)
           END-IF
      *
           EVALUATE  SYS-2010-HKNFTNKBN-Y
             WHEN      SPACE
               IF  (SYS-1001-PREFNUM          =  "42" )
               AND (RECE02-KOHNUM(KOHFTN-IDX) =  "186")
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-Y(KOHFTN-IDX + 1)
               ELSE
                 IF   RECE02-TEISYUTUSAKI   =   1
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-Y(KOHFTN-IDX + 1)
                 END-IF
               END-IF
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-HKNFTNFLG-Y(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-HKNFTN-TAIKBN-Y
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-Y(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-HKNFTNFLG-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
           IF  SYS-2010-HKNFTNKBN-Y = "0"
               MOVE  "0"  TO RECE02-EKF-HKNFTNFLG-Y2(KOHFTN-IDX + 1)
           END-IF
      *
      *@@@
      *
           EVALUATE  SYS-2010-KAKKBN-K
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "01"
                  IF  (RECE02-KOHNUM(KOHFTN-IDX) =  "183"   )
                  AND (RECE02-SRYYM             >=  "200810")
                    MOVE  "1"  TO RECE02-EKF-KAKKBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAKKBN-K(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK-TAIKBN-K
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAKKBN-K(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAKKBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAKKBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAKKBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAKKBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK31KBN-K
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "38"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK31KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "10"
                 WHEN     "23"
                 WHEN     "27"
                 WHEN     "28"
                 WHEN     "34"
                 WHEN     "45"
                  IF  (RECE02-TEISYUTUSAKI   =   6         )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK31KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK31KBN-K(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK31-TAIKBN-K
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK31KBN-K(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK31KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK31KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK31KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK31KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK32KBN-K
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "34"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "3"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "38"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "2"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK32-TAIKBN-K
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "2"
               EVALUATE  SYS-2010-KAK32-TAIKBN-K
                 WHEN        "0"
                    MOVE  "2"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "2"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "2"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "2"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "2"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "3"
               EVALUATE  SYS-2010-KAK32-TAIKBN-K
                 WHEN        "0"
                    MOVE  "3"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "3"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "3"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "3"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "3"  TO RECE02-EKF-KAK32KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK41KBN-K
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "27"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK41KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "23"
                  IF  (RECE02-TEISYUTUSAKI   =   6         )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK41KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK41KBN-K(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK41-TAIKBN-K
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK41KBN-K(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK41KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK41KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK41KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK41KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK42KBN-K
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "27"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK42KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK42KBN-K(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK42-TAIKBN-K
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK42KBN-K(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK42KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK42KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK42KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK42KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK43KBN-K
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "27"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK43KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK43KBN-K(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK43-TAIKBN-K
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK43KBN-K(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK43KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK43KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK43KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK43KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK21KBN-K
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "27"
                  IF  (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "38"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "23"
                 WHEN     "28"
                  IF  (RECE02-TEISYUTUSAKI   =   6         )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK21KBN-K(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK21-TAIKBN-K
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-K(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK22KBN-K
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "27"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK22KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK22KBN-K(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK22-TAIKBN-K
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK22KBN-K(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK22KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK22KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK22KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK22KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK23KBN-K
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "27"
                 WHEN     "38"
                  IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK23KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK23KBN-K(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK23-TAIKBN-K
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK23KBN-K(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK23KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK23KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK23KBN-K(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK23KBN-K(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
      *@@@
      *
           EVALUATE  SYS-2010-KAKKBN-Y
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "01"
                  IF  (RECE02-KOHNUM(KOHFTN-IDX) =  "183"   )
                  AND (RECE02-SRYYM             >=  "200810")
                    MOVE  "1"  TO RECE02-EKF-KAKKBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAKKBN-Y(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK-TAIKBN-Y
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAKKBN-Y(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAKKBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAKKBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAKKBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAKKBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK31KBN-Y
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK31KBN-Y(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK31-TAIKBN-Y
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK31KBN-Y(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK31KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK31KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK31KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK31KBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK32KBN-Y
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "34"
                  IF  (RECE02-TEISYUTUSAKI   =   2         )
                  AND (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK32KBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK32KBN-Y(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK32-TAIKBN-Y
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK32KBN-Y(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK32KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK32KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK32KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK32KBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "2"
               EVALUATE  SYS-2010-KAK32-TAIKBN-Y
                 WHEN        "0"
                    MOVE  "2"  TO RECE02-EKF-KAK32KBN-Y(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "2"  TO RECE02-EKF-KAK32KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "2"  TO RECE02-EKF-KAK32KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "2"  TO RECE02-EKF-KAK32KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "2"  TO RECE02-EKF-KAK32KBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK41KBN-Y
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK41KBN-Y(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK41-TAIKBN-Y
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK41KBN-Y(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK41KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK41KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK41KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK41KBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK42KBN-Y
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK42KBN-Y(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK42-TAIKBN-Y
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK42KBN-Y(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK42KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK42KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK42KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK42KBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK43KBN-Y
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK43KBN-Y(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK43-TAIKBN-Y
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK43KBN-Y(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK43KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK43KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK43KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK43KBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK21KBN-Y
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "27"
                  IF  (RECE02-SRYYM         >=  "200804"   )
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK21KBN-Y(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK21-TAIKBN-Y
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-Y(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK21KBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK22KBN-Y
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK22KBN-Y(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK22-TAIKBN-Y
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK22KBN-Y(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK22KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK22KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK22KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK22KBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KAK23KBN-Y
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KAK23KBN-Y(KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KAK23-TAIKBN-Y
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KAK23KBN-Y(KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KAK23KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KAK23KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KAK23KBN-Y(KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KAK23KBN-Y(KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
      *@@@
      *
           EVALUATE  SYS-2010-KSINGKBN-K-G
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KSINGKBN-K
                                                     (KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KSING-TAIKBN-K-G
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KSINGKBN-K
                                                     (KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KSINGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KSINGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KSINGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KSINGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-KSINGKBN-Y-G
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-KSINGKBN-Y
                                                     (KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-KSING-TAIKBN-Y-G
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-KSINGKBN-Y
                                                     (KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-KSINGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-KSINGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-KSINGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-KSINGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-ENCHGKBN-K-G
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "01"
                  IF  (RECE02-KOHNUM(KOHFTN-IDX) =  "183"   )
                  AND (RECE02-SRYYM             >=  "200810")
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "27"
                  IF   RECE02-SRYYM             >=  "200804"
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "33"
                  IF  (RECE02-SRYYM             >=  "200610")
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "13"
                  IF  (RECE02-KOHNUM(KOHFTN-IDX) =
                         "180" OR "380" OR "181" OR "381"   )
                    MOVE  "3"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-ENCHG-TAIKBN-K-G
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "2"
               EVALUATE  SYS-2010-ENCHG-TAIKBN-K-G
                 WHEN        "0"
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "3"
               EVALUATE  SYS-2010-ENCHG-TAIKBN-K-G
                 WHEN        "0"
                    MOVE  "3"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "3"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "3"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "3"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "3"  TO RECE02-EKF-ENCHGKBN-K
                                                     (KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
           EVALUATE  SYS-2010-ENCHGKBN-Y-G
             WHEN      SPACE
               EVALUATE   SYS-1001-PREFNUM
                 WHEN     "01"
                  IF  (RECE02-KOHNUM(KOHFTN-IDX) =  "183"   )
                  AND (RECE02-SRYYM             >=  "200810")
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "27"
                  IF   RECE02-SRYYM             >=  "200804"
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN     "13"
                  IF  (RECE02-KOHNUM(KOHFTN-IDX) =
                         "180" OR "380" OR "181" OR "381"   )
                    MOVE  "3"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
             WHEN      "1"
               EVALUATE  SYS-2010-ENCHG-TAIKBN-Y-G
                 WHEN        "0"
                    MOVE  "1"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "1"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "1"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "1"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "1"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "2"
               EVALUATE  SYS-2010-ENCHG-TAIKBN-Y-G
                 WHEN        "0"
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "2"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
             WHEN      "3"
               EVALUATE  SYS-2010-ENCHG-TAIKBN-Y-G
                 WHEN        "0"
                    MOVE  "3"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                 WHEN        "1"
                  IF   RECE02-TEISYUTUSAKI  =  2 OR 6
                    MOVE  "3"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "2"
                  IF   RECE02-TEISYUTUSAKI  =  1
                    MOVE  "3"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "3"
                  IF   RECE02-TEISYUTUSAKI  =  2
                    MOVE  "3"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
                 WHEN        "4"
                  IF   RECE02-TEISYUTUSAKI  =  6
                    MOVE  "3"  TO RECE02-EKF-ENCHGKBN-Y
                                                     (KOHFTN-IDX + 1)
                  END-IF
               END-EVALUATE
           END-EVALUATE
      *
      *@@@
      *
           EVALUATE  SYS-2010-FTNHASUKBN-G
             WHEN      "0"
                    MOVE SPACE TO RECE02-EKF-FTNHASUKBN(KOHFTN-IDX + 1)
             WHEN      "1"
                    MOVE  "1"  TO RECE02-EKF-FTNHASUKBN(KOHFTN-IDX + 1)
           END-EVALUATE
      *
      *@@@
      *
           EVALUATE  SYS-2010-GNBKEIKBN-K-G
             WHEN      "2"
                    MOVE  "2"  TO RECE02-GNBKEIKBN-K-G(KOHFTN-IDX + 1)
           END-EVALUATE
      *
           .
       211R1-ETCKISAIFLGINF-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    その他記載フラグセット２
      *****************************************************************
       211R2-ETCKISAIFLGINF-SET2-SEC               SECTION.
      *
           EVALUATE   SYS-1001-PREFNUM
             WHEN     "29"
               IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
               AND (RECE02-KOHHBTNUM(KOHFTN-IDX)
                                 =  "71" OR "81" OR "91")
                 MOVE "1" TO
                       RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
               END-IF
             WHEN     "39"
               IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
               AND (RECE02-KOHHBTNUM(KOHFTN-IDX) =  "72")
               AND (RECE02-SRYYM         >=  "200510"   )
                 MOVE "1" TO
                       RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
               END-IF
           END-EVALUATE
           IF  (SYS-1001-PREFNUM          =  "42" )
           AND (RECE02-KOHNUM(KOHFTN-IDX) =  "186")
               MOVE "1" TO
                     RECE02-EKF-HKNFTNFLG-K(KOHFTN-IDX + 1)
               MOVE "1" TO
                     RECE02-EKF-HKNFTNFLG-Y(KOHFTN-IDX + 1)
           ELSE
             IF   RECE02-TEISYUTUSAKI   =   1
               MOVE "1" TO
                     RECE02-EKF-HKNFTNFLG-K(KOHFTN-IDX + 1)
               MOVE "1" TO
                     RECE02-EKF-HKNFTNFLG-Y(KOHFTN-IDX + 1)
             END-IF
           END-IF
      *
           EVALUATE   SYS-1001-PREFNUM
             WHEN     "33"
              IF  (RECE02-SRYYM             >=  "200610")
                MOVE  "2"  TO RECE02-EKF-ENCHGKBN-K
                                                 (KOHFTN-IDX + 1)
              END-IF
             WHEN     "13"
              IF  (RECE02-KOHNUM(KOHFTN-IDX) =
                     "180" OR "380" OR "181" OR "381"   )
              AND (RECE02-SRYYM             >=  "200604")
                MOVE  "3"  TO RECE02-EKF-ENCHGKBN-K
                                                 (KOHFTN-IDX + 1)
              END-IF
           END-EVALUATE
      *
           EVALUATE   SYS-1001-PREFNUM
             WHEN     "13"
              IF  (RECE02-KOHNUM(KOHFTN-IDX) =
                     "180" OR "380" OR "181" OR "381"   )
              AND (RECE02-SRYYM             >=  "200604")
                MOVE  "3"  TO RECE02-EKF-ENCHGKBN-Y
                                                 (KOHFTN-IDX + 1)
              END-IF
           END-EVALUATE
      *
           .
       211R2-ETCKISAIFLGINF-SET2-EXT.
           EXIT.
      *
      *****************************************************************
      *    その他記載フラグセットクリア
      *****************************************************************
       211R3-ETCKISAIFLGINF-KURIA-SEC               SECTION.
      *
           EVALUATE   SYS-1001-PREFNUM
             WHEN     "29"
              IF  (RECE02-TEISYUTUSAKI   =   2 OR 6   )
              AND (RECE02-KOHHBTNUM(KOHFTN-IDX) = "80")
              AND (RECE02-SRYYM          <  "201410"  )
                MOVE  SPACE TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
              END-IF
             WHEN     "32"
              IF ((RECE02-TEISYUTUSAKI   =   2 OR 6    ) AND
                  (RECE02-KOHNUM(KOHFTN-IDX) =  "790"  ) AND
                  (RECE02-SRYYM          <  "201107"   ))
              OR ((RECE02-TEISYUTUSAKI   =   2 OR 6    ) AND
                  (RECE02-KOHNUM(KOHFTN-IDX) =  "493"  ) AND
                  (RECE02-SRYYM          <  "201107"   ))
              OR ((RECE02-TEISYUTUSAKI   =   2 OR 6    ) AND
                  (RECE02-KOHNUM(KOHFTN-IDX) =
                     "625" OR "627" OR "628" OR "629"  ) AND
                  (RECE02-SRYYM          <  "201302"   ))
              OR ((RECE02-TEISYUTUSAKI   =   2 OR 6    ) AND
                  (RECE02-KOHNUM(KOHFTN-IDX) =  "393"  ) AND
                  (RECE02-SRYYM          <  "201007"   ))
                MOVE  SPACE TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
              END-IF
             WHEN     "35"
              IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
              AND (RECE02-KOHNUM(KOHFTN-IDX) =  "781"  )
              AND (RECE02-SRYYM          <  "201004"   )
                MOVE  SPACE TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
              END-IF
             WHEN     "39"
              IF  (RECE02-TEISYUTUSAKI   =   2 OR 6    )
              AND (RECE02-KOHHBTNUM(KOHFTN-IDX) =  "72")
              AND (RECE02-SRYYM          <  "200510"   )
                MOVE  SPACE TO RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)
              END-IF
           END-EVALUATE
      *
           EVALUATE   SYS-1001-PREFNUM
             WHEN     "01"
              IF  (RECE02-KOHNUM(KOHFTN-IDX) =  "183"   )
              AND (RECE02-SRYYM              <  "200810")
                MOVE  SPACE TO RECE02-EKF-KAKKBN-K(KOHFTN-IDX + 1)
              END-IF
           END-EVALUATE
      *
           EVALUATE   SYS-1001-PREFNUM
             WHEN     "01"
              IF  (RECE02-KOHNUM(KOHFTN-IDX) =  "183"   )
              AND (RECE02-SRYYM              <  "200810")
                MOVE  SPACE TO RECE02-EKF-KAKKBN-Y(KOHFTN-IDX + 1)
              END-IF
           END-EVALUATE
      *
           EVALUATE   SYS-1001-PREFNUM
             WHEN     "01"
              IF  (RECE02-KOHNUM(KOHFTN-IDX) =  "183"   )
              AND (RECE02-SRYYM              <  "200810")
                MOVE  SPACE TO RECE02-EKF-ENCHGKBN-K
                                                  (KOHFTN-IDX + 1)
              END-IF
             WHEN     "33"
              IF  (RECE02-SRYYM              <  "200610")
                MOVE  SPACE TO RECE02-EKF-ENCHGKBN-K
                                                  (KOHFTN-IDX + 1)
              END-IF
             WHEN     "13"
              IF  (RECE02-KOHNUM(KOHFTN-IDX) =
                     "180" OR "380" OR "181" OR "381"   )
              AND (RECE02-SRYYM              <  "200604")
                MOVE  SPACE TO RECE02-EKF-ENCHGKBN-K
                                                  (KOHFTN-IDX + 1)
              END-IF
           END-EVALUATE
      *
           EVALUATE   SYS-1001-PREFNUM
             WHEN     "01"
              IF  (RECE02-KOHNUM(KOHFTN-IDX) =  "183"   )
              AND (RECE02-SRYYM              <  "200810")
                MOVE  SPACE TO RECE02-EKF-ENCHGKBN-Y
                                                  (KOHFTN-IDX + 1)
              END-IF
             WHEN     "13"
              IF  (RECE02-KOHNUM(KOHFTN-IDX) =
                     "180" OR "380" OR "181" OR "381"   )
              AND (RECE02-SRYYM              <  "200604")
                MOVE  SPACE TO RECE02-EKF-ENCHGKBN-Y
                                                  (KOHFTN-IDX + 1)
              END-IF
           END-EVALUATE
      *
           .
       211R3-ETCKISAIFLGINF-KURIA-EXT.
           EXIT.
      *
      *****************************************************************
      *    法定外現物給付の設定編集
      *****************************************************************
       211Q-HOTEIGAI-HENSYU-SEC      SECTION.
      *
           IF    IDZ    =    1
      *
             PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                         UNTIL    KOHFTN-IDX     >    4
      *
              IF  (RECE02-HKNJANUM       NOT =      SPACE     )
              AND (RECE02-RJNHKNNUM          =      SPACE     )
              AND (RECE02-KOHNUM(KOHFTN-IDX) =  "010" OR "021")
      *
                 IF    RECE02-SRYYM        >=  "200804"
                    INITIALIZE                   SYSKANRI-REC
                    MOVE    "2012"           TO  SYS-KANRICD
                    MOVE    RECE02-HKNJANUM  TO  SYS-KBNCD
                    MOVE    RECE02-SRYYM     TO  SYS-STYUKYMD (1:6)
                    MOVE    "01"             TO  SYS-STYUKYMD (7:2)
                    MOVE    SYS-STYUKYMD     TO  SYS-EDYUKYMD
                    MOVE    "tbl_syskanri"   TO  WRK-MCP-TABLE
                    MOVE    "key10"          TO  WRK-MCP-PATHNAME
                    PERFORM 960-KANRIMST-READ-SEC
                    IF      FLG-SYSKANRI     =   ZERO
                      MOVE    MCPDATA-REC   TO  SYS-2012-REC
                    ELSE
                      INITIALIZE                SYS-2012-REC
                    END-IF
                    PERFORM   211Q1-HBTNUMKBN-SET-SEC
                 ELSE
                    PERFORM   211Q2-HBTNUMKBN-SET2-SEC
                 END-IF
      *
              END-IF
      *
             END-PERFORM
      *
           END-IF
      *
           .
       211Q-HOTEIGAI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    法定外現物給付の設定セット
      *****************************************************************
       211Q1-HBTNUMKBN-SET-SEC               SECTION.
      *
           IF  RECE02-KOHNUM(KOHFTN-IDX) = "010"
             EVALUATE  SYS-2012-HBTNUM10KBN
               WHEN      SPACE
               WHEN      "0"
                 PERFORM   211Q2-HBTNUMKBN-SET2-SEC
               WHEN      "1"
                 MOVE    "1"   TO   RECE02-HOTEIGAIFLG(KOHFTN-IDX + 1)
             END-EVALUATE
           END-IF
      *
           IF  RECE02-KOHNUM(KOHFTN-IDX) = "021"
             EVALUATE  SYS-2012-HBTNUM21KBN
               WHEN      SPACE
               WHEN      "0"
                 PERFORM   211Q2-HBTNUMKBN-SET2-SEC
               WHEN      "1"
                 MOVE    "1"   TO   RECE02-HOTEIGAIFLG(KOHFTN-IDX + 1)
             END-EVALUATE
           END-IF
      *
           .
       211Q1-HBTNUMKBN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    法定外現物給付の設定セット２
      *****************************************************************
       211Q2-HBTNUMKBN-SET2-SEC               SECTION.
      *
           IF ((RECE02-HKNJANUM(1:6) = "233064" OR "133280") AND
               (RECE02-SRYYM        <= "201103"            ))
           OR ((RECE02-HKNJANUM(1:6) = "283077"            ) AND
               (RECE02-SRYYM        <= "201111"            ))
           OR ((RECE02-HKNJANUM(1:6) =
                "133033" OR "133041" OR "133066" OR "133074" OR
                "133090" OR "133116" OR "133132" OR "133140" OR
                "133157" OR "133165" OR "133173" OR "133181" OR
                "133199" OR "133207" OR "133223" OR "133249" OR
                "133256" OR "133272"                       ) AND
               (RECE02-SRYYM        <= "201203"            ))
              IF  (SYS-1001-PREFNUM     = "29"    )
              AND (RECE02-HKNJANUM(1:6) = "133033")
                CONTINUE
              ELSE
                IF  RECE02-KOHNUM(KOHFTN-IDX) = "010" OR "021"
                  MOVE   "1"   TO   RECE02-HOTEIGAIFLG(KOHFTN-IDX + 1)
                END-IF
              END-IF
           END-IF
      *
           .
       211Q2-HBTNUMKBN-SET2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００４）
      *****************************************************************
       2104-RECE04-HENSYU-SEC                SECTION.
      *
           INITIALIZE                           SRYACCT-REC
grpsys     MOVE    RECE02-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    RECE02-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    RECE02-PTID          TO      ACCT-PTID
           MOVE    RECE02-SRYKA(IDX)    TO      ACCT-SRYKA
           MOVE    RECE02-SRYYM         TO      ACCT-SRYYM
           MOVE    SRYACCT-REC          TO      MCPDATA-REC
           MOVE    "tbl_sryacct"       TO  MCP-TABLE
           IF      WRK-PARA-PRTKBN     =   "4" OR "5" OR "9" OR "8"
               MOVE    "key62"             TO  WRK-SRYACCT-PATHNAME
           ELSE
               MOVE    "key32"             TO  WRK-SRYACCT-PATHNAME
           END-IF
           MOVE    WRK-SRYACCT-PATHNAME
                                       TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_sryacct"       TO   MCP-TABLE
               MOVE    WRK-SRYACCT-PATHNAME
                                           TO  MCP-PATHNAME
               PERFORM  900-SRYACCT-READ-SEC
               PERFORM  UNTIL
                  (FLG-SRYACCT        =    1)
                   PERFORM VARYING IDX1    FROM    1   BY  1
                           UNTIL   IDX1    >       10
                           OR      RECE02-HKNCOMBI (IDX1)  =   ZERO 
                       IF      ACCT-HKNCOMBI   =
                                               RECE02-HKNCOMBI (IDX1)
      *
                           MOVE   ZERO           TO  FLG-RINYAK
      *
                           IF    ACCT-JIHOKBN      = SPACE
                              PERFORM    21041-KUMIAWASE-HANBETU-SEC
                           END-IF
      *
                           IF   (ACCT-ZAITEN    NOT =    ZERO)    AND
                                (ACCT-ZAIKAISU  NOT =    ZERO)
                               MOVE  ZERO  TO   FLG-SHOSAISIN           
                               MOVE  ZERO  TO   FLG-SHOSAISIN-GEN
                               MOVE  ZERO  TO   WRK-SRYSURYO
                               MOVE  ZERO  TO   WRK-SRYSURYO2
                               MOVE  ZERO  TO   WRK-SRYSURYO3
                               MOVE  ZERO  TO   WRK-TANICD
                               MOVE  ZERO  TO   WRK-TANIMOJISU
                               MOVE  SPACE TO   WRK-TANINAME
                               MOVE  ZERO  TO   FLG-HOUSIJI-COM
                                                FLG-HOUTEN-COM
                                                FLG-SYOBYO-COM
                                                FLG-RYOYO-COM
                                                FLG-SYODOU-COM
                                                FLG-SAIDOU-COM
                                                FLG-NIKOCHIN-COM
                                                FLG-ZENSOKU-COM
                                                FLG-OSIN-COM
                                                FLG-ZAIHOU-COM
                                                FLG-TAHOKEN
                                                FLG-SYOUNI-COM
                                                FLG-KENSA-COM
                                                FLG-ZAIRIHA-COM
                                                FLG-ZAIKYO-COM
                                                FLG-BOKOHO-COM
                                                FLG-IZONSYO-COM
                                                FLG-NINRYO-COM
                                                FLG-NYUSEN-COM
                                                FLG-KIATU-COM
                                                FLG-GAIJIR-COM
      *
                               MOVE  ZERO  TO   WRK-FILMTEN
      *
                               MOVE  SPACE TO   WRK-FORMALNAME
                               MOVE  ZERO  TO   WRK-KZI058-TEN
                                                WRK-KZI058-TANICD
                                                WRK-KZI058-TANIMOJISU
                               MOVE  SPACE TO   WRK-KZI058-TANINAME
                               MOVE  ZERO  TO   FLG-WRITE05
                               MOVE  ZERO  TO   FLG-SETCOM
                               MOVE  ZERO  TO   WRK-SETCOM-JIDO
                               MOVE  ZERO  TO   WRK-SETCOM-JIDO2
                               MOVE  ZERO  TO   FLG-KIN-OKIKAE
                               MOVE  ZERO  TO   FLG-KIN-OKIKAE2
                               MOVE  ZERO  TO   FLG-KIN-OKIKAE3
                               MOVE  ZERO  TO   FLG-RIHA-OKIKAE
                               MOVE  ZERO  TO   FLG-HENSYU-NG
                               MOVE  ZERO  TO   FLG-HENSYU-NG2
                               MOVE  ZERO  TO   FLG-HENSYU-ARI
                               MOVE  ZERO  TO   FLG-ZAITAKU-CHECK
                               MOVE  ZERO  TO   FLG-SIPPU-COM
                               MOVE  ZERO  TO   FLG-SIPPU-ARI
                               MOVE  ZERO  TO   FLG-YKZ-PRTKBN
                               MOVE  ZERO  TO   FLG-KIZ-PRTKBN
                               IF  ACCT-JIHOKBN  =  SPACE
                                PERFORM 21042-RECE02-TOTALTEN-HEN-SEC
                               END-IF
                               PERFORM 21043-RECE04-TENSOU-SEC
                               PERFORM 21044-RECE05-HENSYU-SEC
                               IF    FLG-WRITE05  =   1
                                 PERFORM RECE04-WRITE-SEC
                               END-IF
                           ELSE
                             IF   ACCT-ZAIKAISU  NOT =    ZERO
                             AND  ACCT-JIHOKBN       =    SPACE
                               IF ( ACCT-SRYKBN  NOT =
                                    "24" AND "90" AND "92" AND
                                    "93" AND "97"                 )
                               OR ( ACCT-ZAIKBN  =   1            )
                                 IF  (ACCT-SRYCDTOTAL(1:12)  =
                                                    "000000999901")
                                 AND (ACCT-MEISAISU      =   1    )
                                      MOVE    1    TO      FLG-TOKKI
                                      PERFORM   21045-TOKKI-HENSYU-SEC
                                 ELSE
                                      MOVE  ZERO  TO   FLG-SHOSAISIN    
                                      MOVE  ZERO  TO   FLG-SHOSAISIN-GEN
                                      MOVE  ZERO  TO   WRK-SRYSURYO
                                      MOVE  ZERO  TO   WRK-SRYSURYO2
                                      MOVE  ZERO  TO   WRK-SRYSURYO3
                                      MOVE  ZERO  TO   WRK-TANICD
                                      MOVE  ZERO  TO   WRK-TANIMOJISU
                                      MOVE  SPACE TO   WRK-TANINAME
                                      MOVE  ZERO  TO   FLG-HOUSIJI-COM
                                                       FLG-HOUTEN-COM
                                                       FLG-SYOBYO-COM
                                                       FLG-RYOYO-COM
                                                       FLG-SYODOU-COM
                                                       FLG-SAIDOU-COM
                                                       FLG-NIKOCHIN-COM
                                                       FLG-ZENSOKU-COM
                                                       FLG-OSIN-COM
                                                       FLG-ZAIHOU-COM
                                                       FLG-TAHOKEN
                                                       FLG-SYOUNI-COM
                                                       FLG-KENSA-COM
                                                       FLG-ZAIRIHA-COM
                                                       FLG-ZAIKYO-COM
                                                       FLG-BOKOHO-COM
                                                       FLG-IZONSYO-COM
                                                       FLG-NINRYO-COM
                                                       FLG-NYUSEN-COM
                                                       FLG-KIATU-COM
                                                       FLG-GAIJIR-COM
      *
                                      MOVE  ZERO  TO   WRK-FILMTEN
      *
                                      MOVE  SPACE TO   WRK-FORMALNAME
                                      MOVE  ZERO  TO
                                                  WRK-KZI058-TEN
                                                  WRK-KZI058-TANICD
                                                  WRK-KZI058-TANIMOJISU
                                      MOVE  SPACE TO
                                                  WRK-KZI058-TANINAME
                                      MOVE  ZERO  TO   FLG-WRITE05
                                      MOVE  ZERO  TO   FLG-SETCOM
                                      MOVE  ZERO  TO   WRK-SETCOM-JIDO
                                      MOVE  ZERO  TO   WRK-SETCOM-JIDO2
                                      MOVE  ZERO  TO   FLG-KIN-OKIKAE
                                      MOVE  ZERO  TO   FLG-KIN-OKIKAE2
                                      MOVE  ZERO  TO   FLG-KIN-OKIKAE3
                                      MOVE  ZERO  TO   FLG-RIHA-OKIKAE
                                      MOVE  ZERO  TO   FLG-HENSYU-NG
                                      MOVE  ZERO  TO   FLG-HENSYU-NG2
                                      MOVE  ZERO  TO   FLG-HENSYU-ARI
                                      MOVE  ZERO  TO   FLG-ZAITAKU-CHECK
                                      MOVE  ZERO  TO   FLG-SIPPU-COM
                                      MOVE  ZERO  TO   FLG-SIPPU-ARI
                                      MOVE  ZERO  TO   FLG-YKZ-PRTKBN
                                      MOVE  ZERO  TO   FLG-KIZ-PRTKBN
                                      IF    ACCT-SRYKBN  =
                                            "60" OR "64" OR "80"
                                        PERFORM 21046-SINRYO-CHECK-SEC
                                      END-IF
                                      PERFORM   21043-RECE04-TENSOU-SEC
                                      PERFORM   21044-RECE05-HENSYU-SEC
                                      IF    FLG-WRITE05  =   1
                                        PERFORM RECE04-WRITE-SEC
                                      END-IF
                                 END-IF
                               END-IF
                             END-IF
                           END-IF
                           MOVE    10                TO  IDX1
                       END-IF
                   END-PERFORM          
                   MOVE    "tbl_sryacct"       TO   MCP-TABLE
                   MOVE    WRK-SRYACCT-PATHNAME
                                               TO  MCP-PATHNAME
                   PERFORM   900-SRYACCT-READ-SEC
               END-PERFORM
           ELSE
               DISPLAY   "SRYACCT SELECT ERR" 
           END-IF
      *
           MOVE    "tbl_sryacct"       TO   MCP-TABLE
           MOVE    WRK-SRYACCT-PATHNAME
                                       TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       2104-RECE04-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    組み合わせ判別（福祉用）主保険＋全国公費＋地方公費
      *****************************************************************
       21041-KUMIAWASE-HANBETU-SEC               SECTION.
      *
           INITIALIZE                 TBL-FUKUSHI
      *
           IF  RECE02-SYUKEIKBN(IDX1 2) = "0" OR SPACE
             CONTINUE
           ELSE
             EVALUATE  RECE02-SYUKEI-TAIKBN(IDX1 2)
               WHEN     "0"
                   PERFORM  210411-KUMIAWASE-HENSYU-SEC
               WHEN     "1"
                 IF   RECE02-TEISYUTUSAKI  =   2 OR 6
                   PERFORM  210411-KUMIAWASE-HENSYU-SEC
                 END-IF
               WHEN     "2"
                 IF   RECE02-TEISYUTUSAKI  =   1
                   PERFORM  210411-KUMIAWASE-HENSYU-SEC
                 END-IF
               WHEN     "3"
                 IF   RECE02-TEISYUTUSAKI  =   2
                   PERFORM  210411-KUMIAWASE-HENSYU-SEC
                 END-IF
               WHEN     "4"
                 IF   RECE02-TEISYUTUSAKI  =   6
                   PERFORM  210411-KUMIAWASE-HENSYU-SEC
                 END-IF
             END-EVALUATE
           END-IF
      *
           .
       21041-KUMIAWASE-HANBETU-EXT.
           EXIT.
      *
      *****************************************************************
      *    組み合わせ判別編集
      *****************************************************************
       210411-KUMIAWASE-HENSYU-SEC               SECTION.
      *
           EVALUATE  RECE02-SYUKEIKBN(IDX1 2)
              WHEN      "1"
              WHEN      "3"
                  IF   RECE02-KOHNUMHC(IDX1 2) =  RECE02-KOHNUM(2)
                  AND  RECE02-KOHIDHC(IDX1 2)  =  RECE02-KOHID(2)
                     MOVE  "1"  TO      RECE02-FUKUSHIFLG(3)
                     MOVE   1   TO      TBL-FUKUSHIFLG(2)
                     IF   RECE02-SYUKEIKBN(IDX1 2) = "3"
                      MOVE  1   TO      RECE02-FTNKBNFLG(IDX1 2)
                     END-IF
                  END-IF
                  IF   RECE02-KOHNUMHC(IDX1 2) =  RECE02-KOHNUM(3)
                  AND  RECE02-KOHIDHC(IDX1 2)  =  RECE02-KOHID(3)
                     MOVE  "1"  TO      RECE02-FUKUSHIFLG(4)
                     MOVE   1   TO      TBL-FUKUSHIFLG(2)
                     IF   RECE02-SYUKEIKBN(IDX1 2) = "3"
                      MOVE  1   TO      RECE02-FTNKBNFLG(IDX1 2)
                     END-IF
                  END-IF
                  IF   RECE02-KOHNUMHC(IDX1 2) =  RECE02-KOHNUM(4)
                  AND  RECE02-KOHIDHC(IDX1 2)  =  RECE02-KOHID(4)
                     MOVE  "1"  TO      RECE02-FUKUSHIFLG(5)
                     MOVE   1   TO      TBL-FUKUSHIFLG(2)
                     IF   RECE02-SYUKEIKBN(IDX1 2) = "3"
                      MOVE  1   TO      RECE02-FTNKBNFLG(IDX1 2)
                     END-IF
                  END-IF
              WHEN      "2"
              WHEN      "4"
                  IF   RECE02-KOHNUMHC(IDX1 2) =  RECE02-KOHNUM(2)
                  AND  RECE02-KOHIDHC(IDX1 2)  =  RECE02-KOHID(2)
                     MOVE  "2"  TO      RECE02-FUKUSHIFLG(3)
                     MOVE   2   TO      TBL-FUKUSHIFLG(2)
                     IF   RECE02-SYUKEIKBN(IDX1 2) = "4"
                      MOVE  1   TO      RECE02-FTNKBNFLG(IDX1 2)
                     END-IF
                  END-IF
                  IF   RECE02-KOHNUMHC(IDX1 2) =  RECE02-KOHNUM(3)
                  AND  RECE02-KOHIDHC(IDX1 2)  =  RECE02-KOHID(3)
                     MOVE  "2"  TO      RECE02-FUKUSHIFLG(4)
                     MOVE   2   TO      TBL-FUKUSHIFLG(2)
                     IF   RECE02-SYUKEIKBN(IDX1 2) = "4"
                      MOVE  1   TO      RECE02-FTNKBNFLG(IDX1 2)
                     END-IF
                  END-IF
                  IF   RECE02-KOHNUMHC(IDX1 2) =  RECE02-KOHNUM(4)
                  AND  RECE02-KOHIDHC(IDX1 2)  =  RECE02-KOHID(4)
                     MOVE  "2"  TO      RECE02-FUKUSHIFLG(5)
                     MOVE   2   TO      TBL-FUKUSHIFLG(2)
                     IF   RECE02-SYUKEIKBN(IDX1 2) = "4"
                      MOVE  1   TO      RECE02-FTNKBNFLG(IDX1 2)
                     END-IF
                  END-IF
           END-EVALUATE
      *
           IF   TBL-FUKUSHIFLG(2)   NOT = ZERO
             EVALUATE   SYS-1001-PREFNUM
               WHEN    "38"
                  IF   RECE02-TEISYUTUSAKI  =   2 OR 6
                     MOVE   1    TO     TBL-FUKUSHI-DAYFLG(2)
                  END-IF
               WHEN    "13"
                  IF  (RECE02-TEISYUTUSAKI     =   2     )
                  AND (RECE02-KOHNUMHC(IDX1 2) = "588"   )
                  AND (RECE02-SRYYM           >= "200910")
                     MOVE   1    TO     TBL-FUKUSHI-DAYFLG(2)
                  END-IF
               WHEN    "36"
                  IF  (RECE02-KOHNUMHC(IDX1 2) = "245"   )
                  AND (RECE02-KOHNUMHC(IDX1 3) = "748"   )
                  AND (RECE02-SRYYM           >= "200805")
                     IF   RECE02-KOHNUMHC(IDX1 3) =  RECE02-KOHNUM(2)
                     AND  RECE02-KOHIDHC(IDX1 3)  =  RECE02-KOHID(2)
                        EVALUATE  TBL-FUKUSHIFLG(2)
                          WHEN      1
                            MOVE    "1"   TO  RECE02-FUKUSHIFLG(3)
                          WHEN      2
                            MOVE    "2"   TO  RECE02-FUKUSHIFLG(3)
                        END-EVALUATE
                        MOVE   TBL-FUKUSHIFLG(2)
                                          TO  TBL-FUKUSHIFLG(3)
                        MOVE   RECE02-FTNKBNFLG(IDX1 2)
                                          TO  RECE02-FTNKBNFLG(IDX1 3)
                     END-IF
                     IF   RECE02-KOHNUMHC(IDX1 3) =  RECE02-KOHNUM(3)
                     AND  RECE02-KOHIDHC(IDX1 3)  =  RECE02-KOHID(3)
                        EVALUATE  TBL-FUKUSHIFLG(2)
                          WHEN      1
                            MOVE    "1"   TO  RECE02-FUKUSHIFLG(4)
                          WHEN      2
                            MOVE    "2"   TO  RECE02-FUKUSHIFLG(4)
                        END-EVALUATE
                        MOVE   TBL-FUKUSHIFLG(2)
                                          TO  TBL-FUKUSHIFLG(3)
                        MOVE   RECE02-FTNKBNFLG(IDX1 2)
                                          TO  RECE02-FTNKBNFLG(IDX1 3)
                     END-IF
                     IF   RECE02-KOHNUMHC(IDX1 3) =  RECE02-KOHNUM(4)
                     AND  RECE02-KOHIDHC(IDX1 3)  =  RECE02-KOHID(4)
                        EVALUATE  TBL-FUKUSHIFLG(2)
                          WHEN      1
                            MOVE    "1"   TO  RECE02-FUKUSHIFLG(5)
                          WHEN      2
                            MOVE    "2"   TO  RECE02-FUKUSHIFLG(5)
                        END-EVALUATE
                        MOVE   TBL-FUKUSHIFLG(2)
                                          TO  TBL-FUKUSHIFLG(3)
                        MOVE   RECE02-FTNKBNFLG(IDX1 2)
                                          TO  RECE02-FTNKBNFLG(IDX1 3)
                     END-IF
                  END-IF
             END-EVALUATE
           END-IF
      *
           .
       210411-KUMIAWASE-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送２（Ｆ００２）:トータル点編集
      *****************************************************************
       21042-RECE02-TOTALTEN-HEN-SEC                SECTION.               
      *
      ***  IF    (RECE02-HKNNUM          NOT =   SPACE)   OR
           IF    (RECE02-HKNNUMHC(IDX1)  NOT =   SPACE)   OR
                 (RECE02-RJNHKNNUM       NOT =   SPACE)
               IF        ACCT-SRYKBN        =    "95"   OR  "96"
                   CONTINUE
               ELSE
                IF         ACCT-ZAIKBN        =    2
                   COMPUTE  RECE2G-TOTALTEN(1) =
                            RECE2G-TOTALTEN(1) +
                           (ACCT-ZAITEN  *  ACCT-ZAIKAISU)
                   COMPUTE  RECE2G-HENTOTALTEN(1) =
                            RECE2G-HENTOTALTEN(1) +
                           (ACCT-ZAITEN  *  ACCT-ZAIKAISU)
                ELSE
                 IF   ACCT-SRYCDTOTAL(6:9) = "630010002"
                                          OR "630010005"
                                          OR "630010006"
                                          OR "630010007"
                   COMPUTE  RECE02-TOTALTEN(1) =  RECE02-TOTALTEN(1) -
                                                 (ACCT-ZAITEN  *  
                                                  ACCT-ZAIKAISU)
                   COMPUTE  RECE02-HENTOTALTEN(1) 
                                            =  RECE02-HENTOTALTEN(1) -
                                                 (ACCT-ZAITEN  *  
                                                  ACCT-ZAIKAISU)
                 ELSE
                   COMPUTE  RECE02-TOTALTEN(1) =  RECE02-TOTALTEN(1) +
                                                 (ACCT-ZAITEN  *  
                                                  ACCT-ZAIKAISU)
                   COMPUTE  RECE02-HENTOTALTEN(1) 
                                            =  RECE02-HENTOTALTEN(1) +
                                                 (ACCT-ZAITEN  *  
                                                  ACCT-ZAIKAISU)
                 END-IF
                END-IF
               END-IF
           END-IF
      *
           MOVE    IDX1    TO    HC-IDX
      *
           MOVE       ZERO              TO   KH-IDX
           PERFORM    VARYING   IDX2    FROM   1   BY   1
             UNTIL   (IDX2      >       4)
               MOVE   ZERO               TO        KH-IDX
               IF     RECE02-KOHNUMHC(HC-IDX IDX2)  NOT =  SPACE
                 IF   RECE02-KOHNUMHC(HC-IDX IDX2) =  RECE02-KOHNUM(1)
                 AND  RECE02-KOHIDHC(HC-IDX IDX2)  =  RECE02-KOHID(1)
                      MOVE    2          TO        KH-IDX
                 END-IF
                 IF   RECE02-KOHNUMHC(HC-IDX IDX2) =  RECE02-KOHNUM(2)
                 AND  RECE02-KOHIDHC(HC-IDX IDX2)  =  RECE02-KOHID(2)
                      MOVE    3          TO        KH-IDX
                 END-IF
                 IF   RECE02-KOHNUMHC(HC-IDX IDX2) =  RECE02-KOHNUM(3)
                 AND  RECE02-KOHIDHC(HC-IDX IDX2)  =  RECE02-KOHID(3)
                      MOVE    4          TO        KH-IDX
                 END-IF
                 IF   RECE02-KOHNUMHC(HC-IDX IDX2) =  RECE02-KOHNUM(4)
                 AND  RECE02-KOHIDHC(HC-IDX IDX2)  =  RECE02-KOHID(4)
                      MOVE    5          TO        KH-IDX
                 END-IF
      *
                 IF   KH-IDX             NOT =    ZERO
                  IF        ACCT-SRYKBN        =    "95"   OR  "96"
                     CONTINUE
                  ELSE
                   IF          ACCT-ZAIKBN        =    2
                     COMPUTE  RECE2G-HENTOTALTEN(KH-IDX) =
                              RECE2G-HENTOTALTEN(KH-IDX) +
                             (ACCT-ZAITEN  *  ACCT-ZAIKAISU)
                     IF     TBL-FUKUSHIFLG(IDX2)  NOT =  ZERO
                         CONTINUE
                     ELSE
                         COMPUTE  RECE2G-TOTALTEN(KH-IDX) =
                                  RECE2G-TOTALTEN(KH-IDX) +
                                 (ACCT-ZAITEN  *  ACCT-ZAIKAISU)
                     END-IF
                   ELSE
                     IF   ACCT-SRYCDTOTAL(6:9) = "630010002"
                                              OR "630010005"
                                              OR "630010006"
                                              OR "630010007"
                         COMPUTE  RECE02-HENTOTALTEN(KH-IDX) =
                                        RECE02-HENTOTALTEN(KH-IDX) -
                                             (ACCT-ZAITEN * 
                                              ACCT-ZAIKAISU)
                     ELSE
                         COMPUTE  RECE02-HENTOTALTEN(KH-IDX) =
                                        RECE02-HENTOTALTEN(KH-IDX) +
                                             (ACCT-ZAITEN * 
                                              ACCT-ZAIKAISU)
                     END-IF
                     IF     TBL-FUKUSHIFLG(IDX2)  NOT =  ZERO
                         CONTINUE
                     ELSE
                       IF   ACCT-SRYCDTOTAL(6:9) = "630010002"
                                                OR "630010005"
                                                OR "630010006"
                                                OR "630010007"
                         COMPUTE  RECE02-TOTALTEN(KH-IDX) =
                                              RECE02-TOTALTEN(KH-IDX) -
                                             (ACCT-ZAITEN * 
                                              ACCT-ZAIKAISU)
                       ELSE
                         COMPUTE  RECE02-TOTALTEN(KH-IDX) =
                                              RECE02-TOTALTEN(KH-IDX) +
                                             (ACCT-ZAITEN * 
                                              ACCT-ZAIKAISU)
                       END-IF
                     END-IF
                   END-IF
                  END-IF
                 END-IF
               END-IF  
           END-PERFORM
      *
           .
       21042-RECE02-TOTALTEN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００４）
      *****************************************************************
       21043-RECE04-TENSOU-SEC                SECTION.
      *
           MOVE    SPACE                TO      RECE04-REC
           INITIALIZE                           RECE04-REC
           MOVE    RECE02-KEY           TO      RECE04-KEY1
           MOVE    ZERO                 TO      RECE04-KOHBUNRI
           MOVE    ACCT-SRYKBN          TO      RECE04-SRYKBN
           MOVE    ACCT-ZAINUM          TO      RECE04-ZAINUM
           MOVE    ACCT-SRYCDTOTAL      TO      WRK-SRYCDTOTAL9
           IF      WRK-SRYCDTOTALX(6:9) =       "112011010"    OR
                                                "112705110"    OR
                                                "112705310"
               ADD     1                TO      WRK-ZAINUM
               MOVE    WRK-ZAINUM       TO      RECE04-ZAINUM
           END-IF
           MOVE    RECE02-PTNUM         TO      RECE04-PTNUM
      *
           MOVE    ACCT-SRYKA           TO      RECE04-SRYKA
           MOVE    ACCT-HKNCOMBI        TO      RECE04-HKNCOMBI
           MOVE    ACCT-JIHOKBN         TO      RECE04-JIHOKBN
           MOVE    ACCT-ZAITEN          TO      RECE04-ZAITEN
           MOVE    ACCT-SRYCDTOTAL      TO      RECE04-SRYCDTOTAL
           MOVE    ACCT-SURYOUTOTAL     TO      RECE04-SURYOUTOTAL
           MOVE    ACCT-MEISAISU        TO      RECE04-MEISAISU
           MOVE    ACCT-ZAIKAISU        TO      RECE04-ZAIKAISU
           MOVE    ACCT-SYUTEN1         TO      RECE04-SYUTEN1
           MOVE    ACCT-SYUTEN2         TO      RECE04-SYUTEN2
           MOVE    ACCT-YKZTEN          TO      RECE04-YKZTEN
           MOVE    ACCT-KIZAITEN        TO      RECE04-KIZAITEN
           MOVE    ACCT-DRCD            TO      RECE04-DRCD
           MOVE    ACCT-ZAIREQFLG       TO      RECE04-ZAIREQFLG
           MOVE    ACCT-TEIGENRATE      TO      RECE04-TEIGENRATE
           MOVE        ZERO             TO      WK-TAIHI-DAY
           MOVE        ZERO             TO      WK-TAIHI-FLG
           PERFORM     VARYING   IDX3   FROM    1    BY   1
                       UNTIL     IDX3   >      10
               PERFORM     VARYING   IDX2   FROM    1    BY   1
                           UNTIL     IDX2   >       31
                   MOVE    ACCT-DAY(IDX3 IDX2)  TO
                                            RECE04-KAISU (IDX3 IDX2)
                   IF    (WK-TAIHI-FLG               =  ZERO)
                   AND   (RECE04-KAISU(1 IDX2)   NOT =  ZERO)
                       MOVE     IDX2    TO      WK-TAIHI-DAY
                       MOVE     1       TO      WK-TAIHI-FLG
                   END-IF    
               END-PERFORM
           END-PERFORM
      *
           IF    FLG-RINYAK    NOT =    ZERO
                MOVE    FLG-RINYAK      TO      RECE04-SAFLG
           END-IF
      *
           .
       21043-RECE04-TENSOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの作成（Ｆ００５）
      *****************************************************************
       21044-RECE05-HENSYU-SEC               SECTION.
      *
           IF    (RECE02-SRYYM            >=  "201604")
           AND   (ACCT-SRYKBN              =  "23"    )
           AND   (ACCT-JIHOKBN             =   SPACE  )
             PERFORM 210444-SIPPU-CHECK-SEC
           END-IF
      *
           INITIALIZE     WRK-ORCSGETGE-OUT-AREA
           MOVE    ZERO                 TO      FLG-IRYORENKEI
           IF    ((WRK-PARA-PRTKBN  =  "9"                     ) AND
                  (RECE02-SRYYM         >=   "201204"          ))
           OR    ((WRK-PARA-PRTKBN  =  "2" OR "3" OR "4" OR "5") AND
                  (SYS-200501-INSPECT-GENERAL-KBN  =   "1"     ) AND
                  (RECE02-SRYYM         >=   "201204"          ))
           OR    ( FLG-SIPPU-ARI         =     1                )
             PERFORM 210443-IRYORENKEI-HENSYU-SEC
           END-IF
           MOVE    ZERO                 TO      IDX17
      *
           INITIALIZE                           SRYACT-REC
grpsys     MOVE    ACCT-HOSPNUM         TO      SRY-HOSPNUM
           MOVE    ACCT-NYUGAIKBN       TO      SRY-NYUGAIKBN
           MOVE    ACCT-PTID            TO      SRY-PTID
           MOVE    ACCT-SRYKA           TO      SRY-SRYKA
           MOVE    ACCT-SRYYM           TO      SRY-SRYYM
           MOVE    ACCT-ZAINUM          TO      SRY-ZAINUM
           MOVE    SRYACT-REC           TO      MCPDATA-REC
           MOVE    "tbl_sryact"         TO      MCP-TABLE
           MOVE    "key2"               TO      MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_sryact"         TO  MCP-TABLE
               MOVE    "key2"               TO  MCP-PATHNAME
               PERFORM  900-SRYACT-READ-SEC
               PERFORM  UNTIL  FLG-SRYACT    =    1
                   MOVE   ZERO   TO  FLG-ZANHAIKI
                                     FLG-FORMAL-KISAI
                   MOVE   ZERO   TO  WRK-RENNUM
                                     WRK-RENNUM2
                   MOVE   ZERO   TO  FLG-WRITE05X
                   PERFORM   210441-RECE05-TENSOU-SEC
                   IF  ACCT-JIHOKBN    =  SPACE
                   AND FLG-HENSYU-NG2  =  ZERO
                     PERFORM 210442-RECE02-HENSYU-SEC
                   END-IF
                   IF  FLG-WRITE05X  =  1
                      PERFORM  RECE05-WRITE-SEC
                      MOVE  1    TO  FLG-WRITE05
                   END-IF
                   IF  FLG-ZANHAIKI      =  1
                   OR  FLG-FORMAL-KISAI  =  1
                      PERFORM  RECE05-REWRITE-SEC
                   END-IF
                   MOVE    "tbl_sryact"         TO  MCP-TABLE
                   MOVE    "key2"               TO  MCP-PATHNAME
                   PERFORM   900-SRYACT-READ-SEC
               END-PERFORM
           ELSE
               DISPLAY   "SRYACT SELECT ERR" 
           END-IF
      *
           MOVE    "tbl_sryact"         TO  MCP-TABLE
           MOVE    "key2"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           IF     WRK-FILMTEN  NOT =  ZERO
                COMPUTE    RECE04-SYUTEN2  =  WRK-FILMTEN + 0.5
           END-IF
      *
           .
       21044-RECE05-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送（Ｆ００５）
      *****************************************************************
       210441-RECE05-TENSOU-SEC                SECTION.
      *
           INITIALIZE                   WRK-TNS-TAIHI-AREA
      *
           MOVE    SPACE                TO      RECE05-REC
           INITIALIZE                           RECE05-REC
           MOVE    RECE02-KEY           TO      RECE05-KEY1
           MOVE    ZERO                 TO      RECE05-KOHBUNRI
           MOVE    SRY-ZAINUM           TO      RECE05-ZAINUM
           IF      RECE04-ZAINUM        >       88888880
               MOVE   RECE04-ZAINUM     TO      RECE05-ZAINUM
           END-IF
           MOVE    SRY-RENNUM           TO      RECE05-RENNUM
           MOVE    RECE02-PTNUM         TO      RECE05-PTNUM
      *
           MOVE    SRY-SRYKA            TO      RECE05-SRYKA
           MOVE    SRY-SRYKBN           TO      RECE05-SRYKBN
           MOVE    SRY-SRYSYUKBN        TO      RECE05-SRYSYUKBN
                                                RECE04-SRYSYUKBN
           MOVE    SRY-JIHIMONEYTOTAL   TO      RECE05-JIHIMONEY
           MOVE    ZERO                 TO      FLG-OSINKBN
                                                IDX4
           PERFORM     VARYING   IDX2   FROM    1    BY   1
                       UNTIL    (IDX2      >    5)    OR
                                (SRY-SRYCD(IDX2)  =   SPACE)
      *
             ADD     1                  TO  IDX17
      *
             PERFORM 900-TENSU-TBL-SEC
      **     点数マスタ情報退避
             MOVE    TNS-CHUKSNTUBAN    TO  WRK-TNS-CHUKSNTUBAN(IDX2)
             MOVE    TNS-DATAKBN        TO  WRK-TNS-DATAKBN(IDX2)
             MOVE    TNS-TIMEKSNKBN     TO  WRK-TNS-TIMEKSNKBN(IDX2)
             MOVE    TNS-TEN            TO  WRK-TNS-TEN(IDX2)
             MOVE    TNS-GAITENTTLKBN   TO  WRK-TNS-GAITENTTLKBN(IDX2)
             MOVE    TNS-OSINKBN        TO  WRK-TNS-OSINKBN(IDX2)
             MOVE    TNS-KNSJISKBN      TO  WRK-TNS-KNSJISKBN(IDX2)
             MOVE    TNS-SRYCD          TO  WRK-TNS-SRYCD(IDX2)
      *
             IF     ( SRY-SRYCD(IDX2)(1:1)  =  "S"   )
                  COMPUTE   RECE04-MEISAISU  =  RECE04-MEISAISU
                                             -  1
             END-IF
      *
             IF       SRY-SRYCD(IDX2)  =  "099999909"
               IF     ACCT-JIHOKBN     =   SPACE
                  MOVE    1     TO    RECE02-ICBKINKSI-NASI
                  MOVE    2     TO    FLG-KIN-OKIKAE
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
             END-IF
             IF       SRY-SRYCD(IDX2)  =  "099999910"
               IF     ACCT-JIHOKBN     =   SPACE
                  MOVE    1     TO    RECE02-ICBKINKSI-ARI
                  MOVE    1     TO    FLG-KIN-OKIKAE
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
             END-IF
             IF       SRY-SRYCD(IDX2)  =  "099999921"
               IF     ACCT-JIHOKBN     =   SPACE
                  MOVE    1     TO    RECE02-KOHCHIKAN
                  MOVE    1     TO    FLG-KIN-OKIKAE2
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
             END-IF
             IF       SRY-SRYCD(IDX2)  =  "099999922"
               IF    (ACCT-JIHOKBN            =   SPACE)
               AND   (RECE02-DAISANFLG(IDX1)  =    1   )
                  MOVE    1     TO    FLG-KIN-OKIKAE3
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
             END-IF
             IF       SRY-SRYCD(IDX2)  =  "099999923" OR "099999924" OR
                                          "099999925" OR "099999931"
                  MOVE    1     TO    FLG-HENSYU-NG
             END-IF
             IF       SRY-SRYCD(IDX2)  =  "099999929"
                  MOVE    1     TO    FLG-HENSYU-NG
                  MOVE    1     TO    RECE02-SKYZEROFLG
             END-IF
             IF       SRY-SRYCD(IDX2)(1:5)  =
                      "09960" OR "09970" OR "09980" OR "09983"
                  MOVE    1     TO    FLG-HENSYU-NG
             END-IF
             IF       SRY-SRYCD(IDX2)  =  "099999935" OR "099999936" OR
                                          "099999937" OR "099999938" OR
                                          "099999939" OR "099999940" OR
                                          "099999941" OR "099999942" OR
                                          "099999943"
               IF     ACCT-JIHOKBN     =   SPACE
                  EVALUATE  SRY-SRYCD(IDX2)
                    WHEN     "099999935"
                      IF  RECE02-RIHA2-SINDAI(IDX1)   = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    1     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999936"
                      IF  RECE02-RIHA2-NOUKE(IDX1)    = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    2     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999937"
                      IF  RECE02-RIHA2-UNDOKI(IDX1)   = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    3     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999938"
                      IF  RECE02-RIHA2-KOKYUKI(IDX1)  = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    4     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999939"
                      IF  RECE02-RIHA2-SESSYOKU(IDX1) = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    5     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999940"
                      IF  RECE02-RIHA2-HAIYO(IDX1)    = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    6     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999941"
                      IF  RECE02-RIHA2-SINDAI9(IDX1)  = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    7     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999942"
                      IF  RECE02-RIHA2-KOKYUKI9(IDX1) = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    8     TO    FLG-RIHA-OKIKAE
                      END-IF
                    WHEN     "099999943"
                      IF  RECE02-RIHA2-HAIYO9(IDX1)   = 1
                        MOVE    1     TO    FLG-HENSYU-NG
                      ELSE
                        MOVE    9     TO    FLG-RIHA-OKIKAE
                      END-IF
                  END-EVALUATE
               ELSE
                  MOVE    1     TO    FLG-HENSYU-NG
               END-IF
             END-IF
             IF       SRY-SRYCD(IDX2)  =  "099140004" OR "099400001"
                                       OR "099400002" OR "099400003"
                  MOVE    1     TO    FLG-HENSYU-NG
             END-IF
             IF      (SRY-SRYCD(IDX2)  =  "099140011" OR "099140012")
             AND     (RECE02-SRYYM    >=  "201804"                  )
                  MOVE    1     TO    FLG-HENSYU-NG
             END-IF
      *
             IF       RECE02-DAISANFLG(IDX1)  =   1
               IF  (ACCT-SRYKBN             =  "80"   )
               AND (SRY-SRYCD(IDX2)(1:5)    =
                         "09591" OR "09592" OR "09593")
                 IF   (FLG-HENSYU-ARI      =    ZERO)
                 AND  (ACCT-JIHOKBN        =   SPACE)
                 AND  (ACCT-ZAITEN     NOT =    ZERO)
                 AND  (ACCT-ZAIKAISU   NOT =    ZERO)
                   COMPUTE  RECE02-TOTALTEN(1) =  RECE02-TOTALTEN(1) -
                                                 (ACCT-ZAITEN  *  
                                                  ACCT-ZAIKAISU)
                   COMPUTE  RECE02-HENTOTALTEN(1) 
                                            =  RECE02-HENTOTALTEN(1) -
                                                 (ACCT-ZAITEN  *  
                                                  ACCT-ZAIKAISU)
                   MOVE     1     TO     FLG-HENSYU-ARI
                 END-IF
                 MOVE       1     TO     FLG-HENSYU-NG2
               END-IF
             END-IF
      *
             IF     ACCT-SRYKBN      =  "98"
               IF  (WRK-PARA-PRTKBN  =  "9" OR "8"    )
               AND (ACCT-SRYCDTOTAL  =  00000099209910
                                    OR  00000099209911)
                 CONTINUE
               ELSE
                 IF  (SRY-RENNUM       =   1         )
                 AND (IDX2             =   1         )
                 AND (SRY-SRYCD(IDX2)  =  "830000052")
                     MOVE    1    TO     FLG-SIPPU-COM
                 ELSE
                   IF  FLG-SIPPU-COM   =   1
                     CONTINUE
                   ELSE
                     MOVE    1    TO     FLG-HENSYU-NG
                   END-IF
                 END-IF
                 IF  (SRY-RENNUM       =   1         )
                 AND (IDX2             =   1         )
                 AND (SRY-SRYCD(IDX2)  =  "830000052"
                                      OR  "099200201")
                   PERFORM  VARYING  IDX33  FROM  1  BY  1
                             UNTIL   IDX33   >   10
                     PERFORM  VARYING  IDX34  FROM  1  BY  1
                               UNTIL   IDX34   >   31
                       IF   ACCT-DAY(IDX33 IDX34)  NOT =  ZERO
                         MOVE    1    TO   RECE02-SIPPUCHKFLG
                         MOVE    1    TO   RECE02-SIPPUCHK(IDX33 IDX34)
                       END-IF
                     END-PERFORM
                   END-PERFORM
                 END-IF
               END-IF
             END-IF
      *
             IF     ((SRY-SRYCD(IDX2)(1:3)  =  "001") AND
                     (FLG-SIPPU-ARI         =  ZERO )       )
             OR     ((SRY-SRYCD(IDX2)(1:3)  =  "001") AND
                     (FLG-SIPPU-ARI         =   1   ) AND
                     (SYS-200501-COMPRESS-KBN
                                        NOT =  "1"  )       )
             OR     ((SRY-SRYCD(IDX2)(1:3)  =  "059") AND
                     (TNS-TEN               =  ZERO )       )
             OR     ( SRY-SRYCD(IDX2)(1:7)  =  "0992000"    )
             OR     ( SRY-SRYCD(IDX2)(1:4)  =  "0085"
                                            OR "0086"       )
             OR     ( FLG-KIN-OKIKAE    NOT =  ZERO         )
             OR     ( FLG-KIN-OKIKAE2   NOT =  ZERO         )
             OR     ( FLG-KIN-OKIKAE3   NOT =  ZERO         )
             OR     ( FLG-RIHA-OKIKAE   NOT =  ZERO         )
             OR     ( FLG-HENSYU-NG     NOT =  ZERO         )
             OR     ( FLG-HENSYU-NG2    NOT =  ZERO         )
             OR     ( SRY-SRYCD(IDX2)       =
                      "099209902" OR "099209904" OR
                      "099999903" OR "099999904" OR
                      "099999905" OR "099999906" OR
                      "099999907" OR "099999908" OR
                      "099200101" OR "099999926" OR
                      "099999927" OR "099999928" OR
                      "099999934" OR
                      "099208101" OR
                      "840000136" OR "840000140" OR
                      "099114001" OR "099140001" OR
                      "099140003" OR "099409905" OR
                      "099409906" OR "099409907" OR
                      "099409908" OR "099409909" OR
                      "099200301"                           )
             OR     ((SRY-SRYCD(IDX2)       =
                      "099209903" OR "099209905" OR
                      "099209906" OR "099209907" OR
                      "099209908"                          ) AND
                     (WRK-PARA-PRTKBN  NOT = "9" AND "8"   ))
      *
                  PERFORM   2104417-MEISAISU-HENSYU-SEC
      *
             END-IF
      *
             IF       SRY-SRYCD(IDX2)(1:7) = "0999901"
                  COMPUTE   RECE04-MEISAISU    =  RECE04-MEISAISU
                                               -  1
                  MOVE      SRY-SRYCD(IDX2)   TO  WRK-SRYCD
                  COMPUTE   RECE04-SRYCDTOTAL  =  RECE04-SRYCDTOTAL
                                               -  WRK-SRYCD
                  COMPUTE   RECE04-SURYOUTOTAL =  RECE04-SURYOUTOTAL
                                               -  1
                  MOVE    2    TO      FLG-TOKKI
                  PERFORM   21045-TOKKI-HENSYU-SEC
             END-IF
      *
             IF      SRY-SRYCD(IDX2)  =  "820000053" OR "820000054"
                                                     OR "820000055"
                  MOVE    3    TO      FLG-TOKKI
                  PERFORM   21045-TOKKI-HENSYU-SEC
             END-IF
      *
             IF   ACCT-ZAIKBN       =     1
               IF      SRY-SRYCD(IDX2)  =  "820000094" OR "630010011" OR
                                           "630010012" OR "630010013"
                  MOVE    9    TO      FLG-TOKKI
                  PERFORM   21045-TOKKI-HENSYU-SEC
               END-IF
               IF      SRY-SRYCD(IDX2)  =  "820000095"
                  MOVE   10    TO      FLG-TOKKI
                  PERFORM   21045-TOKKI-HENSYU-SEC
               END-IF
               IF     (RECE02-SRYYM    >=  "201411"   )
               AND    (SRY-SRYCD(IDX2)  =  "820000171")
                  MOVE   17    TO      FLG-TOKKI
                  PERFORM   21045-TOKKI-HENSYU-SEC
               END-IF
             END-IF
      *
      *      初診ダミー・再診ダミーの剤回数
             IF   (ACCT-SRYKBN     = "11" OR "12"              )
             AND  (SRY-SRYCD(IDX2) = "099110001" OR "099120001")
                ADD   ACCT-ZAIKAISU   TO   RECE02-DUMMYKAISU
             END-IF
      *
             IF      SRY-SRYCD(IDX2)(1:1)     =   "0" OR  "1" OR
                                                  "6" OR  "7" OR
                                                  "8"
      *
              IF     ( SRY-SRYCD(IDX2)(1:7)  =  "0999901"    )
              OR     ((SRY-SRYCD(IDX2)(1:3)  =  "001") AND
                      (FLG-SIPPU-ARI         =  ZERO )       )
              OR     ((SRY-SRYCD(IDX2)(1:3)  =  "001") AND
                      (FLG-SIPPU-ARI         =   1   ) AND
                      (SYS-200501-COMPRESS-KBN
                                         NOT =  "1"  )       )
              OR     ((SRY-SRYCD(IDX2)(1:3)  =  "059") AND
                      (TNS-TEN               =  ZERO )       )
              OR     ( SRY-SRYCD(IDX2)(1:7)  =  "0992000"    )
              OR     ( SRY-SRYCD(IDX2)(1:4)  =  "0085"
                                             OR "0086"       )
              OR     ( FLG-KIN-OKIKAE    NOT =  ZERO         )
              OR     ( FLG-KIN-OKIKAE2   NOT =  ZERO         )
              OR     ( FLG-KIN-OKIKAE3   NOT =  ZERO         )
              OR     ( FLG-RIHA-OKIKAE   NOT =  ZERO         )
              OR     ( FLG-HENSYU-NG     NOT =  ZERO         )
              OR     ( FLG-HENSYU-NG2    NOT =  ZERO         )
              OR     ( SRY-SRYCD(IDX2)       =
                       "099209902" OR "099209904" OR
                       "099999903" OR "099999904" OR
                       "099999905" OR "099999906" OR
                       "099999907" OR "099999908" OR
                       "099200101" OR "099999926" OR
                       "099999927" OR "099999928" OR
                       "099999934" OR
                       "099208101" OR
                       "840000136" OR "840000140" OR
                       "099114001" OR "099140001" OR
                       "099140003" OR "099409905" OR
                       "099409906" OR "099409907" OR
                       "099409908" OR "099409909" OR
                       "099200301"                           )
              OR     ((SRY-SRYCD(IDX2)       =
                       "099209903" OR "099209905" OR
                       "099209906" OR "099209907" OR
                       "099209908"                          ) AND
                      (WRK-PARA-PRTKBN  NOT = "9" AND "8"   ))
      *
               IF   FLG-KIN-OKIKAE   NOT =  ZERO
                 IF  WRK-TAIHI-ZAINUM  =  ZERO
                   MOVE   ACCT-ZAINUM     TO   WRK-TAIHI-ZAINUM
                 END-IF
                 IF  ACCT-ZAINUM  =  WRK-TAIHI-ZAINUM
                   MOVE   FLG-KIN-OKIKAE  TO   WRK-TAIHI-OKIKAE
                   IF  SRY-SRYCD(IDX2) = "099999910" OR "099999909"
                     CONTINUE
                   ELSE
                     PERFORM   2104415-ICHIBUCOM-HENSYU-SEC
                   END-IF
                 END-IF
               END-IF
               IF   FLG-KIN-OKIKAE2  NOT =  ZERO
                 IF  WRK-TAIHI-ZAINUM2 =  ZERO
                   MOVE   ACCT-ZAINUM     TO   WRK-TAIHI-ZAINUM2
                 END-IF
                 IF  ACCT-ZAINUM  =  WRK-TAIHI-ZAINUM2
                   MOVE   FLG-KIN-OKIKAE2 TO   WRK-TAIHI-OKIKAE2
                   IF  SRY-SRYCD(IDX2) = "099999921"
                     CONTINUE
                   ELSE
                     PERFORM   2104415-ICHIBUCOM-HENSYU2-SEC
                   END-IF
                 END-IF
               END-IF
               IF   FLG-KIN-OKIKAE3  NOT =  ZERO
                 IF  WRK-TAIHI-ZAINUM3 =  ZERO
                   MOVE   ACCT-ZAINUM     TO   WRK-TAIHI-ZAINUM3
                 END-IF
                 IF  ACCT-ZAINUM  =  WRK-TAIHI-ZAINUM3
                   IF  SRY-SRYCD(IDX2) = "099999922"
                     CONTINUE
                   ELSE
                     PERFORM   2104415-ICHIBUCOM-HENSYU3-SEC
                   END-IF
                 END-IF
               END-IF
               IF   FLG-RIHA-OKIKAE  NOT =  ZERO
                     PERFORM   2104418-RIHAYMD-HENSYU-SEC
               END-IF
      *
               IF   (ACCT-SRYKBN = "40" OR "50" OR "54" OR "60" OR
                                   "64" OR "70" OR "80"           )
               AND  (ACCT-KIZAITEN =  ZERO                        )
                 IF    SRY-SRYCD(IDX2)(1:3)  =  "059"
                 AND   TNS-TEN               =  ZERO
                   MOVE    1    TO    FLG-KIZ-PRTKBN
                 END-IF
               END-IF
      *
              ELSE
      *
               ADD     1                  TO    IDX4
      *
               MOVE    SRY-SRYCD(IDX2)    TO    RECE05-SRYCD(IDX4)
      *
               IF      SRY-SRYKBN         =     "12"
               AND     ACCT-JIHOKBN       =     SPACE
                   IF   SRY-SRYCD(IDX2)   =  "112009310" OR "112010250"
                                          OR "112009850" OR "112010750"
                                          OR "112703810" OR "112704550"
                                          OR "112704250" OR "112704950"
                                          OR "112007510" OR "112008050"
                                          OR "112008450" OR "112008950"
                                          OR "112702410" OR "112702850"
                                          OR "112703150" OR "112703550"
                        MOVE   "1"        TO    RECE02-SAISHIN-PRTKBN
                   END-IF
                   IF   SRY-SRYCD(IDX2)   =  "112011110" OR "112011210"
                                          OR "112012910" OR "112705410"
                                          OR "112707010" OR "112705210"
                                          OR "112706910"
                        MOVE   "1"        TO    RECE02-GAIRAIKSN-PRTKBN
                   END-IF
               END-IF
      *
               IF      SRY-SRYKBN         =     "13"
               AND     ACCT-JIHOKBN       =     SPACE
                   IF   SRY-SRYCD(IDX2)   =  "113001810" OR "113001910"
                                          OR "113002010" OR "113700610"
                                          OR "113700710" OR "113700810"
                                          OR "113029010"
                        MOVE   "1"        TO    RECE02-BEDSUFLG
                   END-IF
               END-IF
      *
               IF     SRY-SRYCD(IDX2)      =    "160177770"
                  MOVE   "1"              TO    RECE02-KENTAIKASANFLG
                  MOVE   99               TO    RECE04-KNSJISGRPKBN
               END-IF
               IF     RECE04-KNSJISGRPKBN  =    ZERO
                 IF    TNS-KNSJISGRPKBN = 1 OR 2 OR 3 OR 4 OR 5 OR 6
                  MOVE  TNS-KNSJISGRPKBN  TO    RECE04-KNSJISGRPKBN
                 END-IF
               END-IF
      *
               IF    ( SRY-SRYKBN         =     "60" OR "64" )
               AND   ( TNS-KNSJISKBN      =      2           )
                   MOVE    TNS-KNSJISKBN        TO  RECE04-KNSJISKBN
               END-IF
      *
               IF    ( SRY-SRYKBN   =  "14" OR "21" OR "22" OR "23" )
               AND   ( RECE04-ZAITEN     =     ZERO                 )
               AND   ( RECE04-SAFLG      =     SPACE                )
               AND   ( ACCT-ZAIKBN   NOT =     1                    )
                  IF   SRY-SRYCD(IDX2)   =     "820000046"
                     MOVE     "1"         TO    RECE04-SAFLG
                  END-IF
               END-IF
      *
               IF      ACCT-JIHOKBN  NOT =     SPACE
                  IF     RECE04-SAFLG   NOT =  SPACE
                        MOVE    "3"       TO    RECE04-TOYAKUFLG
                  ELSE
                    IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                    OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                        IF   RECE04-TOYAKUFLG = SPACE
                          MOVE  "4"       TO    RECE04-TOYAKUFLG
                        END-IF
                    ELSE
                        MOVE    "3"       TO    RECE04-TOYAKUFLG
                    END-IF
                  END-IF
               END-IF
      *
               IF    ( SRY-SRYKBN   =  "21" OR "22" OR "23" )
               AND   ( RECE04-ZAITEN     =     ZERO         )
               AND   ( ACCT-ZAIKBN   NOT =     1            )
               AND   ( ACCT-JIHOKBN      =     SPACE        )
                IF   ACCT-SRYCDTOTAL(6:9) = "630010002"
                                         OR "630010005"
                                         OR "630010006"
                                         OR "630010007"
                  CONTINUE
                ELSE
                  IF     RECE04-SAFLG   NOT =  SPACE
                        MOVE   SPACE      TO    RECE04-TOYAKUFLG
                  ELSE
                    IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                    OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                        IF   SRY-SRYSYUKBN  =  "212" OR "292" OR
                                               "222" OR "232" OR
                                               "295" OR "298"
                          IF   RECE04-TOYAKUFLG = SPACE
                            MOVE   "2"    TO    RECE04-TOYAKUFLG
                          END-IF
                        END-IF
                    ELSE
                        MOVE    "1"       TO    RECE04-TOYAKUFLG
                        IF   (RECE05-SRYCD(IDX4)(1:1) = "6"   )
                        AND  (WRK-ORCSGETGE-GENERICNAME(IDX17)
                                                  NOT =  SPACE)
                          IF    WRK-PARA-PRTKBN  = "9"
                             MOVE  "1"  TO  RECE05-INGAIFLG(IDX4)
                          ELSE
                           IF  (WRK-PARA-PRTKBN  =
                                            "2" OR "3" OR "4" OR "5")
                           AND (SYS-200501-INSPECT-GENERAL-KBN = "1")
                             MOVE  "1"  TO  RECE05-INGAIFLG-RECE(IDX4)
                           END-IF
                          END-IF
                          IF    FLG-SIPPU-ARI    =  1
                             MOVE  "1"  TO  RECE05-INGAIFLG-SIPPU(IDX4)
                          END-IF
                          MOVE  WRK-ORCSGETGE-YAKKAKJNCD(IDX17)
                                          TO    RECE05-YAKKAKJNCD(IDX4)
                          MOVE  WRK-ORCSGETGE-GENERIC-KBN(IDX17)
                                          TO    RECE05-GENERIC-KBN(IDX4)
                          MOVE  WRK-ORCSGETGE-GENERICNAME(IDX17)
                                          TO    RECE05-GENERICNAME(IDX4)
                          PERFORM  VARYING  IDX15  FROM  200  BY  -1
                                    UNTIL   IDX15   <     1
                            IF  RECE05-GENERICNAME(IDX4)(IDX15:1)
                                                        NOT =   SPACE
                               COMPUTE RECE05-GENERICYUKOKETA(IDX4) =
                                       IDX15  /  2
                               MOVE    1   TO  IDX15
                            END-IF
                          END-PERFORM
                        END-IF
                    END-IF
                  END-IF
      *
                  IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                  OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                      CONTINUE
                  ELSE
                      MOVE      1         TO    WRK-DAISAN-INGAI(IDX1)
                  END-IF
                END-IF
               END-IF
      *
               IF     FLG-SIPPU-ARI  =  1
      **********  １：院外分　２：院内分
                  IF   RECE04-ZAITEN  =   ZERO
                      MOVE  "1"         TO    RECE04-SIPPUFLG
                  ELSE
                      MOVE  "2"         TO    RECE04-SIPPUFLG
                  END-IF
                  IF  (SRY-SRYCD(IDX2)(1:1)  =  "6")
                  AND (TNS-MEIUSESKB         =   1 )
                      MOVE  "1"         TO    RECE05-SIPPUFLG(IDX4)
                  END-IF
                  IF   SRY-SRYCD(IDX2)(1:3)  =  "001"
                      MOVE  "810000001" TO    RECE05-SRYCD(IDX4)
                  END-IF
               END-IF
      *
               IF    ( SRY-SRYKBN        =     "14"  )
               AND   ( RECE04-ZAITEN     =     ZERO  )
               AND   ( ACCT-ZAIKBN   NOT =     1     )
               AND   ( ACCT-JIHOKBN      =     SPACE )
                  IF     RECE04-SAFLG   NOT =  SPACE
                        MOVE   SPACE      TO    RECE04-TOYAKUFLG
                  ELSE
                    IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                    OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                        IF   SRY-SRYSYUKBN  =  "148" OR "149"
                          IF   RECE04-TOYAKUFLG = SPACE
                            MOVE   "2"    TO    RECE04-TOYAKUFLG
                          END-IF
                        END-IF
                    ELSE
                        MOVE    "1"       TO    RECE04-TOYAKUFLG
                        IF   (RECE05-SRYCD(IDX4)(1:1) = "6"   )
                        AND  (WRK-ORCSGETGE-GENERICNAME(IDX17)
                                                  NOT =  SPACE)
                          IF    WRK-PARA-PRTKBN  =  "9"
                            MOVE  "1"  TO  RECE05-INGAIFLG(IDX4)
                          ELSE
                            MOVE  "1"  TO  RECE05-INGAIFLG-RECE(IDX4)
                          END-IF
                          MOVE  WRK-ORCSGETGE-YAKKAKJNCD(IDX17)
                                          TO    RECE05-YAKKAKJNCD(IDX4)
                          MOVE  WRK-ORCSGETGE-GENERIC-KBN(IDX17)
                                          TO    RECE05-GENERIC-KBN(IDX4)
                          MOVE  WRK-ORCSGETGE-GENERICNAME(IDX17)
                                          TO    RECE05-GENERICNAME(IDX4)
                          PERFORM  VARYING  IDX15  FROM  200  BY  -1
                                    UNTIL   IDX15   <     1
                            IF  RECE05-GENERICNAME(IDX4)(IDX15:1)
                                                        NOT =   SPACE
                               COMPUTE RECE05-GENERICYUKOKETA(IDX4) =
                                       IDX15  /  2
                               MOVE    1   TO  IDX15
                            END-IF
                          END-PERFORM
                        END-IF
                    END-IF
                  END-IF
      *
                  IF  (SRY-SRYCD(IDX2)(1:1)  =  "8"  )
                  OR  (SRY-SRYCD(IDX2)(1:3)  =  "008")
                      CONTINUE
                  ELSE
                      MOVE      1         TO    WRK-DAISAN-INGAI(IDX1)
                  END-IF
               END-IF
      *
               IF      SRY-SRYKBN   =   "99"
                  IF      SRY-SRYCD(IDX2)     =   "099140011"
                      MOVE     "1"        TO    RECE04-HOMONCOMFLG
                      MOVE  "810000001"   TO    RECE05-SRYCD(IDX4)
                  END-IF
                  IF      SRY-SRYCD(IDX2)     =   "099140012"
                      MOVE     "2"        TO    RECE04-HOMONCOMFLG
                      MOVE  "810000001"   TO    RECE05-SRYCD(IDX4)
                  END-IF
                  IF      RECE04-HOMONCOMFLG  =   "2"
                      MOVE     "1"        TO    RECE02-COMCNTFLG
                      MOVE     "1"        TO    RECE05-RECEDENFLG(IDX4)
                      MOVE     "1"        TO    RECE05-RECEPTFLG(IDX4)
                  END-IF
               END-IF
      *
               IF   (ACCT-SRYKBN = "40" OR "50" OR "54" OR "60" OR
                                   "64" OR "70" OR "80"           )
               AND  (ACCT-YKZTEN =  ZERO                          )
                 IF  ( SYS-200501-15-YKZ-PRTKBN  =  "0" )
                 OR  ((SYS-200501-15-YKZ-PRTKBN  =  "1") AND
                      (RECE02-SRYYM  <  "201204"       ))
                   IF    SRY-SRYCD(IDX2)(1:1)  =  "6"
                         MOVE   "1"    TO  RECE05-RECEDENFLG(IDX4)
                         MOVE   "1"    TO  RECE05-RECEPTFLG(IDX4)
                         MOVE    1     TO  FLG-YKZ-PRTKBN
                         PERFORM   2104417-MEISAISU-HENSYU-SEC
                   ELSE
                     IF  FLG-YKZ-PRTKBN  =  1
                       IF (( ACCT-ZAITEN           =  ZERO  ) AND
                           ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                            (SRY-SRYCD(IDX2)(1:3)  =  "008")))
                       OR (  SRY-MEISKYFLG(IDX2)   =  "2"    )
                         MOVE   "1"    TO  RECE05-RECEDENFLG(IDX4)
                         MOVE   "1"    TO  RECE05-RECEPTFLG(IDX4)
                         PERFORM   2104417-MEISAISU-HENSYU-SEC
                       ELSE
                         MOVE   ZERO   TO  FLG-YKZ-PRTKBN
                       END-IF
                     END-IF
                   END-IF
                 ELSE
                   IF    SRY-SRYCD(IDX2)(1:1)  =  "6"
                         MOVE   "1"    TO  RECE04-YKZKISAIFLG
                   END-IF
                 END-IF
               END-IF
      *
               IF   (ACCT-SRYKBN = "40" OR "50" OR "54" OR "60" OR
                                   "64" OR "70" OR "80"           )
               AND  (ACCT-KIZAITEN =  ZERO                        )
                   IF    SRY-SRYCD(IDX2)(1:1)  =  "7"
                   OR    SRY-SRYCD(IDX2)(1:3)  =  "058"
                     IF  ((ACCT-SRYKBN     = "70"                 ) AND
                          (TNS-DATAKBN     = "3"                  ))
                     OR  ((ACCT-SRYKBN     = "70"                 ) AND
                          (SRY-SRYCD(IDX2) = "799990070"          ))
                         MOVE   ZERO   TO  FLG-KIZ-PRTKBN
                     ELSE
                         MOVE   "1"    TO  RECE05-RECEDENFLG(IDX4)
                         MOVE   "1"    TO  RECE05-RECEPTFLG(IDX4)
                         MOVE    1     TO  FLG-KIZ-PRTKBN
                         PERFORM   2104417-MEISAISU-HENSYU-SEC
                     END-IF
                   ELSE
                     IF  FLG-KIZ-PRTKBN  =  1
                       IF (( ACCT-ZAITEN           =  ZERO  ) AND
                           ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                            (SRY-SRYCD(IDX2)(1:3)  =  "008")))
                       OR (  SRY-MEISKYFLG(IDX2)   =  "2"    )
                         MOVE   "1"    TO  RECE05-RECEDENFLG(IDX4)
                         MOVE   "1"    TO  RECE05-RECEPTFLG(IDX4)
                         PERFORM   2104417-MEISAISU-HENSYU-SEC
                       ELSE
                         MOVE   ZERO   TO  FLG-KIZ-PRTKBN
                       END-IF
                     END-IF
                   END-IF
               END-IF
      *
               IF     SRY-SRYCD(IDX2)  IS  NUMERIC
               AND    FLG-YKZ-PRTKBN   =   ZERO
               AND    FLG-KIZ-PRTKBN   =   ZERO
      *          IF  SRY-SRYCD(IDX2)(1:3) NOT = "001"
                   MOVE    SRY-SRYCD(IDX2)   TO  WRK-SRYCD
      *
                   MOVE     ZERO    TO    WRK-FUKA-KINGAKU
                   PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                             UNTIL   FUKA-IDX   >    9
                     MOVE   SRY-SRYCD(IDX2)(FUKA-IDX:1)
                                             TO  WRK-FUKA-VALUE
                     IF  WRK-FUKA-VALUE  =  ZERO
                       CONTINUE
                     ELSE
                       COMPUTE  RECE04-RUIKEITOTAL  =
                                RECE04-RUIKEITOTAL  +
                              ( WRK-FUKA-VALUE    * WRK-SRYCD)
                       COMPUTE  WRK-FUKA-KINGAKU    =
                                WRK-FUKA-KINGAKU    +
                              ((WRK-FUKA-VALUE^4) * FUKA-IDX
                                                  * SRY-SRYSURYO(IDX2))
                     END-IF
                   END-PERFORM
                   COMPUTE  RECE04-RUIKEITOTAL  =
                            RECE04-RUIKEITOTAL  +
                            WRK-FUKA-KINGAKU
      *
                   MOVE     ZERO    TO    WRK-FUKA-KINGAKU
                   PERFORM  VARYING  FUKA-IDX  FROM  1  BY  1
                             UNTIL   FUKA-IDX   >   10
                     MOVE   SRY-SRYSURYO(IDX2)(FUKA-IDX:1)
                                             TO  WRK-FUKA-VALUE
                     IF  WRK-FUKA-VALUE  =  ZERO
                       CONTINUE
                     ELSE
                       COMPUTE  WRK-FUKA-KINGAKU  =
                                WRK-FUKA-KINGAKU  +
                              ((WRK-FUKA-VALUE^4) * FUKA-IDX)
                     END-IF
                   END-PERFORM
                   COMPUTE  RECE04-RUIKEITOTAL  =
                            RECE04-RUIKEITOTAL  +
                            WRK-FUKA-KINGAKU
      *          END-IF
               END-IF
      *
               IF      SRY-SRYKBN = "40" OR "50" OR "54" OR "60" OR "64"
                  IF   SRY-SRYCD(IDX2)(1:1)  =  "7"
                  AND  TNS-DATAKBN           =  "3"
                         COMPUTE WRK-FILMTEN2   =
                                (TNS-TEN  * SRY-SRYSURYO(IDX2) / 10)
                         IF   TNS-JGNTEN  NOT =  ZERO
                         AND  TNS-JGNTEN   <  WRK-FILMTEN2
                             COMPUTE  WRK-FILMTEN  =
                                      WRK-FILMTEN  +
                                      TNS-JGNTEN
                         ELSE
                             COMPUTE  WRK-FILMTEN  =
                                      WRK-FILMTEN  +
                                      WRK-FILMTEN2
                         END-IF
                  END-IF
               END-IF
      *
               MOVE    SRY-SRYSURYO(IDX2) TO    RECE05-SRYSURYO(IDX4)
               MOVE    SRY-SRYKAISU(IDX2) TO    RECE05-SRYKAISU(IDX4)
               MOVE    SRY-MEISKYFLG(IDX2) TO   RECE05-MEISKYFLG(IDX4)
               MOVE    SRY-AUTOKBN(IDX2)  TO    RECE05-AUTOKBN(IDX4)
               MOVE    SRY-INPUTNUM(IDX2) TO    RECE05-INPUTNUM(IDX4)
      *
               IF      RECE02-RECESYUBETU  =  8888
               AND     SYS-2005-JIHITEKKSIKBN  =  "1"
                 IF      SRY-SRYKBN    =     "95" OR "96"
                   IF      SRY-SRYCD(IDX2)(1:3)  =  "095" OR "096"
                     IF      SRY-SRYCD(IDX2)(1:5)  =  "09500" OR "09600"
                                                  OR  "09591" OR "09691"
                                                  OR  "09592" OR "09692"
                                                  OR  "09593" OR "09693"
                                                  OR  "09594" OR "09694"
                          CONTINUE
                     ELSE
                       IF     TNS-TEN     NOT =  ZERO
                          ADD     TNS-TEN    TO   RECE04-SYUTEN1
                          MOVE    "1"        TO   RECE02-JIHTEKFLG
                       END-IF
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
      **診療実日数のカウントを行える剤であるかの判定
               IF      ACCT-JIHOKBN       =    SPACE
                 IF  ((ACCT-ZAITEN    NOT =    ZERO             ) AND
                      (ACCT-ZAIKAISU  NOT =    ZERO             ) AND
                      (ACCT-SRYKBN        =  "11"  OR  "12"  OR
                                             "13"  OR  "14"     ))
                 OR  ((ACCT-ZAITEN        =    ZERO             ) AND
                      (ACCT-ZAIKAISU  NOT =    ZERO             ) AND
                      (ACCT-SRYKBN        =  "11"  OR  "12"  OR
                                             "99"               ))
      *
                       IF ( (TNS-JITUDAY    =     2          ) AND      
                            (TNS-DAYCNT     =     1   OR   2 )    )     
                       OR (  SRY-SRYCD(IDX2)  =  "112700850"            
                                              OR "112003350"            
                                              OR "099409901"            
                                              OR "099999902"            
                                              OR "099110001"            
                                              OR "099120001"            
      *                              同日再診
                                              OR "112010150"
                                              OR "112010250"
                                              OR "112010350"
                                              OR "112010450"
                                              OR "112010550"
                                              OR "112704450"
                                              OR "112704550"
                                              OR "112704650"
                                              OR "112704750"
                                              OR "112010650"
                                              OR "112010750"
                                              OR "112010850"
                                              OR "112010950"
                                              OR "112012850"
                                              OR "112704850"
                                              OR "112704950"
                                              OR "112705050"
                                              OR "112706850"
                                              OR "112008850"
                                              OR "112008950"
                                              OR "112009050"
                                              OR "112009150"
                                              OR "112012550"
                                              OR "112703450"
                                              OR "112703550"
                                              OR "112703650"
                                              OR "112706550"
                                              OR "112008350"
                                              OR "112008450"
                                              OR "112008550"
                                              OR "112008650"
                                              OR "112008750"
                                              OR "112703050"
                                              OR "112703150"
                                              OR "112703250"
                                              OR "112703350"
      *
                                              OR "112011710"
                                              OR "112016550"
                                              OR "112011810"
                                              OR "112011910"
                                              OR "112012010"
                                              OR "112012210"
                                              OR "112705850"
                                              OR "112705950"
                                              OR "112706050"
      *
                                              OR "111011810"
                                              OR "111012610"
                                              OR "113013910"
                                              OR "113014010"
                                              OR "113014110"
                                              OR "112015810"
                                              OR "112015950"
                                              OR "112016210"
                                              OR "112016410"
                                              OR "113015810"
                                              OR "112016850"
                                              OR "112016950"
                                              OR "112017010"
                                              OR "112017150"
                                              OR "112017450"
      *
                                              OR "113018410"
                                              OR "111012810"
                                              OR "112017610"
                                              OR "113024810"
                                              OR "113025710"
                                              OR "112023210"
                                              OR "112023450"
                                              OR "112023750"
                                              OR "112023550"
                                              OR "112023850"
                                              OR "113031310"
                                              OR "113031410"      )
      *
                             MOVE    1      TO    FLG-SHOSAISIN         
      *
                       END-IF                                           
      *
                       IF    SRY-SRYCD(IDX2)  =  "099409903"
                             MOVE    1      TO    FLG-SHOSAISIN-GEN
                       END-IF
      *
                 END-IF
               END-IF
      *
               IF      TNS-SRYKBN         =     "80"
                   IF  TNS-GAITENTTLKBN   =     130
                       MOVE   "13"        TO    RECE04-SRYKBN
                                                RECE05-SRYKBN
                   END-IF
               END-IF
      *
               IF      FLG-SIPPU-COM      =     1
                       MOVE   "1"         TO    RECE04-SIPPUCOMFLG
                       MOVE   "80"        TO    RECE04-SRYKBN
                                                RECE05-SRYKBN
                       MOVE   "800"       TO    RECE04-SRYSYUKBN
                                                RECE05-SRYSYUKBN
               END-IF
      *
               IF      ACCT-JIHOKBN       =     SPACE
                  PERFORM  2104411-RECE05-COMCNT-HEN-SEC
               ELSE
                  IF   RECE04-SRYKBN      =     "50"
                     MOVE   "1"   TO    RECE04-FLG-SHUJUTU-COMMENT
                  END-IF
                  IF   RECE04-SRYKBN      =     "54"
                     MOVE   "1"   TO    RECE04-FLG-MASUI-COMMENT
                  END-IF
               END-IF
      *
               IF  SRY-SRYCD(IDX2)        =     "099309901"
                IF   ACCT-ZAIKBN  =  1
                  MOVE    "1"             TO  RECE05-RECEDENFLG(IDX4)
                  MOVE    "1"             TO  RECE05-RECEPTFLG(IDX4)
                  MOVE    ZERO            TO  RECE05-SRYSURYO(IDX4)
                ELSE
                  COMPUTE WRK-SRYSURYO2   =     WRK-SRYSURYO            
                                          +     0.99999                   
                  COMPUTE RECE05-SRYSURYO(IDX4)                         
                                          =     WRK-SRYSURYO2           
                                          -     WRK-SRYSURYO            
                  IF  RECE05-SRYSURYO(IDX4)  NOT = ZERO                 
                    MOVE  WRK-TANICD      TO    RECE05-TANICD(IDX4)     
                    MOVE  WRK-TANIMOJISU  TO    RECE05-TANIMOJISU(IDX4) 
                    MOVE  WRK-TANINAME    TO    RECE05-TANINAME(IDX4)   
                    IF    RECE05-RENNUM  >  1                           
                    AND   IDX4           =  1                           
                      MOVE    1           TO    FLG-ZANHAIKI            
                      COMPUTE  WRK-RENNUM  =  RECE05-RENNUM  -  1       
                      MOVE WRK-SRYSURYO2  TO  WRK-SRYSURYO3             
                    ELSE                                                
                      MOVE WRK-SRYSURYO2  TO  RECE05-SRYSURYO(IDX4 - 1) 
                    END-IF
                  ELSE
                    MOVE  "1"             TO  RECE05-RECEDENFLG(IDX4)
                    MOVE  "1"             TO  RECE05-RECEPTFLG(IDX4)
                  END-IF                                                
                END-IF
               ELSE                                                     
                  MOVE    SRY-SRYSURYO(IDX2)                            
                                          TO    WRK-SRYSURYO            
                  IF   TNS-TANICD  NOT = SPACE AND "000"
                    MOVE  TNS-TANICD      TO    RECE05-TANICD(IDX4)
                                                WRK-TANICD
                  END-IF
                  MOVE    TNS-TANIMOJISU  TO    RECE05-TANIMOJISU(IDX4)
                                                WRK-TANIMOJISU          
                  MOVE    TNS-TANINAME    TO    RECE05-TANINAME(IDX4)
                                                WRK-TANINAME            
               END-IF                                                   
      *********IF      TNS-TENSIKIBETU    =     1   OR   3
      *********    MOVE  TNS-TENSIKIBETU  TO   RECE05-TENSIKIBETU(IDX4)
      *********    MOVE  TNS-TEN          TO    RECE05-TEN(IDX4)
      *********END-IF
               MOVE  TNS-TENSIKIBETU  TO   RECE05-TENSIKIBETU(IDX4)
               MOVE  TNS-TEN          TO   RECE05-TEN(IDX4)
               IF      RECE02-NYUGAIKBN   =     "1"
                   MOVE  TNS-NYUTENTTLKBN TO    RECE05-TENTTLKBN(IDX4)
               ELSE
                   MOVE  TNS-GAITENTTLKBN TO    RECE05-TENTTLKBN(IDX4)
               END-IF
               IF     (SRY-SRYCD    (IDX2)(1:1)     =   "8"  )
               OR     (SRY-SRYCD    (IDX2)(1:3)     =   "008")
                  MOVE ZERO               TO    RECE05-YUKOKETA(IDX4)
               ELSE
                  MOVE TNS-YUKOKETA       TO    RECE05-YUKOKETA(IDX4)
               END-IF
               MOVE    TNS-DATAKBN        TO    RECE05-DATAKBN (IDX4)
               MOVE    TNS-HOUKNSKBN      TO    RECE05-HOUKNSKBN(IDX4)
               MOVE    TNS-KNSJISKBN      TO    RECE05-KNSJISKBN(IDX4)
               MOVE    TNS-CDKBN-KBN      TO    RECE05-CDKBN-KBN(IDX4)
               MOVE    TNS-CDKBN-SYO      TO    RECE05-CDKBN-SYO(IDX4)
               MOVE    TNS-CDKBN-BU       TO    RECE05-CDKBN-BU(IDX4)
               MOVE    TNS-CDKBN-KBNNUM   
                                      TO RECE05-CDKBN-KBNNUM(IDX4)
               MOVE    TNS-CDKBN-KBNNUM-EDA
                                      TO RECE05-CDKBN-KBNNUM-EDA(IDX4)
               MOVE    TNS-CDKBN-KOUBAN
                                      TO RECE05-CDKBN-KOUBAN(IDX4)
               MOVE    TNS-KOUHYOJYUNNUM  
                                      TO RECE05-KOUHYOJYUNNUM(IDX4)
               MOVE    TNS-SRYSYUKBN  TO RECE05-SRYSYUKBN-X  (IDX4)
               MOVE    TNS-KOKUJISKBKBN1  
                                      TO RECE05-KOKUJISKBKBN1(IDX4)
               MOVE    TNS-KOKUJISKBKBN2  
                                      TO RECE05-KOKUJISKBKBN2(IDX4)
               MOVE    TNS-TUSOKUGAIKBN
                                      TO RECE05-TUSOKUGAIKBN (IDX4)
               MOVE    TNS-TIMEKSNKBN TO RECE05-TIMEKSNKBN   (IDX4)
               MOVE    TNS-KZMCOMPSIKIBETU
                                      TO RECE05-KZMCOMPSIKIBETU(IDX4)
               MOVE    TNS-CHUKSNCD   TO RECE05-CHUKSNCD       (IDX4)
               MOVE    TNS-CHUKSNTUBAN
                                      TO RECE05-CHUKSNTUBAN    (IDX4)
               MOVE    TNS-KENTAICOMMENT
                                      TO RECE05-KENTAICOMMENT  (IDX4)
               MOVE    TNS-KNSJISGRPKBN
                                      TO RECE05-KNSJISGRPKBN   (IDX4)
               MOVE    TNS-TOKUKIZAISBT1
                                      TO RECE05-TOKUKIZAISBT1  (IDX4)
               MOVE    TNS-SANSOKBN   TO RECE05-SANSOKBN       (IDX4)
               IF      TNS-SRYCD (1:2)   =   "84"
                   PERFORM VARYING IDYY    FROM    1   BY  1
                           UNTIL   IDYY    >       10
                       MOVE    TNS-SSTKIJUNCD (IDYY)
                                           TO  RECE05-SSTKIJUNCD
                                                   (IDX4 IDYY)
                   END-PERFORM
               END-IF
      *
               IF    (TNS-SRYCD       =  "170022290"  OR
                                         "170022390"  OR
                                         "170022490")
               AND   (RECE02-SRYYM   <=  "201003"   )
                      MOVE   202      TO  RECE05-CDKBN-KBNNUM(IDX4)
                      MOVE   99       TO  RECE05-CDKBN-KOUBAN(IDX4)
               END-IF
               IF     TNS-SRYCD       =  "170016010"  OR
                                         "170020270"  OR  "170024470" OR
                                         "170024910"  OR  "170025010" OR
                                         "170025210"  OR  "170025310" OR
                                         "170025410"  OR  "170025510" OR
                                         "170025610"  OR  "170025710" OR
                                         "170025810"  OR  "170025910" OR
                                         "170026010"  OR  "170026110" OR
                                         "170026210"  OR  "170026310" OR
                                         "170026810"  OR
                                         "170000210"  OR  "170016910" OR
                                         "170017010"  OR  "170026710" OR
                                         "170028810"  OR
                                         "170035710"  OR  "170035810" OR
                                         "170035910"  OR  "170036010"
                      MOVE   203      TO  RECE05-CDKBN-KBNNUM(IDX4)
                      MOVE   99       TO  RECE05-CDKBN-KOUBAN(IDX4)
               END-IF
      *
               MOVE   TNS-SRYKBN      TO  RECE05-TNSSRYKBN(IDX4)
      *
               IF    (TNS-SRYCD       =  "170022290")
               AND   (RECE02-SRYYM   >=  "201004"   )
                      MOVE   "1"      TO  RECE04-GAZOGEN
               END-IF
      *
               IF   (((SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                      (SRY-SRYCD    (IDX2)(1:3)     =   "008")) AND
                     ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  ))
               OR   (( FLG-SIPPU-ARI                =    1    ) AND
                     ( SRY-SRYCD    (IDX2)(1:3)     =   "001" ) AND
                     ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  ))
grpsys             MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
                   MOVE    SRY-PTID             TO  PTCOM-PTID
                   MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
                   MOVE    SRY-SRYCD    (IDX2)  TO  PTCOM-SRYCD
                   MOVE    SRY-INPUTNUM (IDX2)  TO  PTCOM-RENNUM
                   PERFORM 950-PTCOM-READ-SEC
                   MOVE    PTCOM-INPUTCOMENT    TO  RECE05-NAME (IDX4)
                                                    RECE05-INPUTCOMENT
                                                                (IDX4)
      *
                   IF       SRY-SRYCD (IDX2)(1:1) = "8"
                       IF  (SRY-SRYCD (IDX2)(1:2) = "84" OR "85")
                       OR  (SRY-SRYCD (IDX2)(1:4) = "8311"      )
                         IF  PTCOM-INPUTCHI1  NOT =  SPACE
                           INITIALIZE              ORCSKANACHKAREA
                           MOVE    "2"             TO  KANACHK-SYORI 
                           STRING  PTCOM-INPUTCHI1 DELIMITED  BY  SPACE
                                   PTCOM-INPUTCHI2 DELIMITED  BY  SPACE
                                   PTCOM-INPUTCHI3 DELIMITED  BY  SPACE
                                   PTCOM-INPUTCHI4 DELIMITED  BY  SPACE
                                   INTO   KANACHK-MAE-INPUT
                           END-STRING
                           CALL    "ORCSKANACHK"   USING
                                                       ORCSKANACHKAREA
                           IF      KANACHK-RC      =   ZERO
                               MOVE    KANACHK-OUT-INPUT(1:KANACHK-MAX)
                                                   TO
                                           RECE05-INPUTCOMENT   (IDX4)
                           END-IF
                         ELSE
                               MOVE    SPACE       TO
                                           RECE05-INPUTCOMENT   (IDX4)
                         END-IF
                       ELSE
                           INITIALIZE                  ORCSKANACHKAREA
                           MOVE    "2"             TO  KANACHK-SYORI 
                           MOVE    TNS-NAME        TO  KANACHK-MAE-INPUT
                           CALL    "ORCSKANACHK"   USING
                                                       ORCSKANACHKAREA
                           IF    ( KANACHK-RC      =   ZERO )
                           AND   ( KANACHK-MAX     >   ZERO )
                               COMPUTE IDXX    =   KANACHK-MAX +   1
                               MOVE    PTCOM-INPUTCOMENT (IDXX:)
                                                       TO
                                           RECE05-INPUTCOMENT   (IDX4)
                           ELSE
                               MOVE    PTCOM-INPUTCOMENT
                                                       TO
                                           RECE05-INPUTCOMENT   (IDX4)
                           END-IF
                       END-IF
                   END-IF
      *
      ***          IF    RECE04-COMCDFLG   NOT =   "2"
      ***             MOVE   "1"           TO    RECE04-COMCDFLG
      ***          END-IF
               ELSE
                   MOVE    TNS-NAME        TO    RECE05-NAME    (IDX4)
                                                 RECE05-INPUTCOMENT
                                                                (IDX4)
                   MOVE    TNS-YUKOKETA    TO    RECE05-YUKOKETA(IDX4)
                   IF      TNS-SRYCD       =  "180706810" OR "180706910"
                                           OR "180707010" OR "180707110"
                                           OR "180707210" OR "180707310"
                                           OR "180707410" OR "180707510"
                         MOVE  "老人"    TO   RECE05-NAME(IDX4)(1:4)
                         MOVE  TNS-NAME  TO   RECE05-NAME(IDX4)(5:) 
                         COMPUTE  RECE05-YUKOKETA(IDX4) =
                                  RECE05-YUKOKETA(IDX4) + 2
                   END-IF
               END-IF
      *
               IF   ( ACCT-SRYKBN           =   "99"  )
               AND  ((SRY-SRYCD(IDX2)(1:1)  =   "8"  ) OR
                     (SRY-SRYCD(IDX2)(1:3)  =   "008"))
                IF  RECE02-HAICOMFLG  =  ZERO
                 MOVE       ZERO         TO  WRK-COL
                 INSPECT  RECE05-NAME(IDX4)  TALLYING  WRK-COL
                                             FOR ALL   "【配】",
                                                 ALL   "（配）",
                                                 ALL   "「配」"
                 IF      WRK-COL         >   ZERO
                     MOVE    1           TO  RECE02-HAICOMFLG
                 END-IF
                END-IF
                IF  RECE02-HAICOMFLG  =  ZERO
                 IF  ( RECE05-NAME(IDX4)(1:2) = "配" )
                 AND ((RECE05-NAME(IDX4)(5:2) = "回") OR
                      (RECE05-NAME(IDX4)(7:2) = "回") OR
                      (RECE05-NAME(IDX4)(9:2) = "回"))
                     MOVE    1           TO  RECE02-HAICOMFLG
                 END-IF
                END-IF
               END-IF
      *
               IF  SRY-SRYCD(IDX2)        =     "099309901"
                  IF  RECE05-SRYSURYO(IDX4)  NOT = ZERO
                    PERFORM  2104413-RECE05-SURYO-HEN-SEC
      *
                    MOVE    SPACE      TO  RECE05-NAME(IDX4)
                    MOVE    SPACE      TO  RECE05-INPUTCOMENT(IDX4)
      ***           STRING  TNS-NAME          DELIMITED  BY  " "
      ***                   "　"              DELIMITED  BY  SIZE
      ***                   WRK-SRYSURYOW     DELIMITED  BY  " "
      ***                   RECE05-TANINAME(IDX4)
      ***                                     DELIMITED  BY  " "
      ***                   INTO              RECE05-NAME(IDX4)
      ***           END-STRING
                    STRING  "（使用量　"      DELIMITED  BY  SIZE
                            WRK-SRYSURYOW     DELIMITED  BY  " "
                            RECE05-TANINAME(IDX4)
                                              DELIMITED  BY  " "
                            "　残量廃棄）"    DELIMITED  BY  SIZE
                            INTO              RECE05-NAME(IDX4)
                    END-STRING
                    MOVE  RECE05-NAME(IDX4)
                                       TO  RECE05-INPUTCOMENT(IDX4)
      *
      ***           MOVE  "810000001"  TO  RECE05-SRYCD(IDX4)
                    MOVE  ZERO         TO  RECE05-SRYSURYO(IDX4)
                    MOVE  ZERO         TO  RECE05-TANICD(IDX4)
                    MOVE  ZERO         TO  RECE05-TANIMOJISU(IDX4)
                    MOVE  SPACE        TO  RECE05-TANINAME(IDX4)
                    MOVE  ZERO         TO  RECE05-YUKOKETA(IDX4)
                    MOVE  "2"          TO  RECE05-MEISKYFLG(IDX4)
                  END-IF
               END-IF
      *
               IF          SRY-SRYKBN       =  "21" OR "22" OR "23"
                    IF    SRY-SRYCD(IDX2)  =  "630010002"
                                           OR "630010005"
                                           OR "630010006"
                                           OR "630010007"
                                           OR "820000047"
                                           OR "820000166"
                        MOVE     "2"       TO    RECE04-COMCDFLG
                    END-IF
               END-IF
               IF   ( SRY-SRYCD(IDX2)(1:1)  =   "8"   )
               OR   ( SRY-SRYCD(IDX2)(1:3)  =   "008" )
               OR   ((FLG-SIPPU-ARI         =    1   ) AND
                     (SRY-SRYCD(IDX2)(1:3)  =   "001"))
                    IF    RECE04-COMCDFLG   NOT =   "2"
                        MOVE     "1"       TO    RECE04-COMCDFLG
                    END-IF
               END-IF
      *
      ***      IF    RECE04-COMCDFLG       =   "2"
      ***        IF    SRY-SRYCD(IDX2)  =  "630010002"
      ***                               OR "630010005"
      ***                               OR "630010006"
      ***                               OR "630010007"
      ***                               OR "820000047"
      ***                               OR "820000166"
      ***          CONTINUE
      ***        ELSE
      ***          ADD   999               TO  WRK-SURYOU-COUNT
      ***          ADD   WRK-SURYOU-COUNT  TO  RECE04-SURYOUTOTAL
      ***        END-IF
      ***      END-IF
      *
               IF   (SRY-SRYKBN       =  "31" OR "32")
               AND  (ACCT-JIHOKBN     =  SPACE       )
                 IF        SRY-SRYCD(IDX2)  =    "130000510"
      ***                                  OR    "130000110"
      ***                                  OR    "130000310"
                                           OR    "130003510"
      ***                                  OR    "130003670"
                   MOVE    SPACE           TO    RECE05-NAME(IDX4)
                 END-IF
               END-IF
               IF  ( SRY-SRYSYUKBN         =  "334"       )
               AND ((SRY-SRYCD(IDX2)       =  "810000001") OR
                    (SRY-SRYCD(IDX2)(1:3)  =  "008"      ))
               AND ( FLG-HOUTEN-COM        =   ZERO       )
                    PERFORM  VARYING  IDV  FROM  1  BY  2
                            UNTIL  (IDV            >   300 )
                             OR    (FLG-HOUTEN-COM =     1 )
                      IF   RECE05-NAME(IDX4)(IDV:2)   =   "訪"
                         MOVE   SPACE  TO    RECE04-FLG-HOUTEN-COMMENT
                         MOVE    1     TO    FLG-HOUTEN-COM
                      END-IF
                    END-PERFORM
               END-IF
      *
               IF  ( SRY-SRYKBN     =  "60" OR "64" )
               AND ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                    (SRY-SRYCD(IDX2)(1:3)  =  "008"))
               AND ( FLG-KENSA-COM  =   ZERO        )
                 IF  SRY-SRYCD(IDX2) = "840000085" OR "840000087"
                    CONTINUE
                 ELSE
                    PERFORM  VARYING  IDV  FROM  1  BY  2
                              UNTIL  (IDV            >   300)
                               OR    (FLG-KENSA-COM  =    1 )
                      IF  RECE05-NAME(IDX4)(IDV:2)   =  "日"
                        MOVE   SPACE  TO  RECE04-FLG-KENSA-COMMENT
                        MOVE     1    TO  FLG-KENSA-COM
                      END-IF
                    END-PERFORM
                 END-IF
               END-IF
      *
               IF  ( SRY-SRYKBN       =  "14"       )
               AND ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                    (SRY-SRYCD(IDX2)(1:3)  =  "008"))
               AND ( FLG-ZAIRIHA-COM  =   ZERO      )
                    PERFORM  VARYING  IDV  FROM  1  BY  2
                              UNTIL  (IDV              >   300)
                               OR    (FLG-ZAIRIHA-COM  =    1 )
                      IF  RECE05-NAME(IDX4)(IDV:2)   =  "日"
                        MOVE   SPACE  TO  RECE04-FLG-ZAIRIHA-COMMENT
                        MOVE     1    TO  FLG-ZAIRIHA-COM
                      END-IF
                    END-PERFORM
               END-IF
      *
               IF  ( SRY-SRYKBN = "12" OR "13" OR
                                  "14" OR "80"      )
               AND ((SRY-SRYCD(IDX2)(1:1)  =  "8"  ) OR
                    (SRY-SRYCD(IDX2)(1:3)  =  "008"))
                 IF (RECE05-NAME(IDX4)(1:20) = "管理料等算定開始年月")
                 OR (RECE05-NAME(IDX4)(1:18) = "管理料算定開始年月"  )
                   MOVE   "1"   TO   RECE04-FLG-ONLINE3-COMMENT
                 END-IF
               END-IF
      *
               IF  SRY-SRYCD(IDX2)(1:3)     =   "058"
                 MOVE  TNS-FORMALYUKOKETA TO  RECE05-YUKOKETA(IDX4)
                 MOVE  TNS-FORMALNAME     TO  RECE05-NAME(IDX4)
                                              WRK-FORMALNAME
                 MOVE  "1"                TO  RECE05-RECEDENFLG(IDX4)
      *
                 MOVE     TNS-TEN         TO  WRK-KZI058-TEN
                 IF   TNS-TANICD  NOT = SPACE AND "000"
                    MOVE  TNS-TANICD      TO  WRK-KZI058-TANICD
                    MOVE  TNS-TANIMOJISU  TO  WRK-KZI058-TANIMOJISU
                    MOVE  TNS-TANINAME    TO  WRK-KZI058-TANINAME
                 END-IF
                 MOVE     ZERO            TO  RECE05-TEN(IDX4)
                 MOVE     ZERO            TO  RECE05-TANICD(IDX4)
                 MOVE     ZERO            TO  RECE05-TANIMOJISU(IDX4)
                 MOVE     SPACE           TO  RECE05-TANINAME(IDX4)
               END-IF
               IF  (SRY-SRYCD(IDX2)(1:1)    =   "7")
               AND (SRY-MEISKYFLG(IDX2)     =   "1")
                 IF   (SRY-SRYKBN  =   "70")
                 AND  (TNS-DATAKBN =   "3" )
                    IF    RECE05-RENNUM  >  1
                    AND   IDX4           =  1
                      MOVE    1           TO  FLG-FORMAL-KISAI
                      COMPUTE  WRK-RENNUM2 =  RECE05-RENNUM  -  1
                    ELSE
                      MOVE  "1"           TO  RECE05-RECEPTFLG(IDX4 - 1)
                    END-IF
                 ELSE
                    MOVE  WRK-FORMALNAME  TO  RECE05-RECEDENNAME(IDX4)
                    MOVE  "1"             TO  RECE05-RECEHENFLG(IDX4)
                    IF    WRK-KZI058-TEN  NOT = ZERO
                       MOVE   WRK-KZI058-TEN
                                          TO  RECE05-TEN(IDX4)
                    END-IF
                    IF   (WRK-KZI058-TANICD  NOT = ZERO)
                    AND  (RECE05-TANICD(IDX4)    = ZERO)
                       MOVE   WRK-KZI058-TANICD
                                          TO  RECE05-TANICD(IDX4)
                       MOVE   WRK-KZI058-TANIMOJISU
                                          TO  RECE05-TANIMOJISU(IDX4)
                       MOVE   WRK-KZI058-TANINAME
                                          TO  RECE05-TANINAME(IDX4)
                    END-IF
                 END-IF
               END-IF
      *
               IF  (SRY-SRYKBN         =  "99"       )
               AND (SRY-RENNUM         =   1         )
               AND (IDX2               =   1         )
               AND (SRY-SRYCD(IDX2)    =  "099999902")
                    MOVE      1         TO  FLG-TAHOKEN
      *
                    MOVE     ZERO       TO  FLG-ARI2
                    IF  RECE02-HKNNUM(1:2) = "98" OR "90" OR "91"
                      MOVE    1         TO  FLG-ARI2
                    ELSE
                      PERFORM 2104416-JYURRK-CHECK-SEC
                    END-IF
                    IF  FLG-ARI2 = ZERO
                      MOVE     "1"      TO  RECE05-RECEPTFLG(IDX4)
                      MOVE     "1"      TO  RECE05-RECEDENFLG(IDX4)
                      MOVE     "1"      TO  RECE04-TAHOKENNGFLG
                    END-IF
               END-IF
               IF  (FLG-TAHOKEN           =   1              )
               AND (SRY-RENNUM            =   1              )
               AND (IDX2                  =   2              )
               AND (SRY-SRYCD(IDX2)(1:4)  =  "0082"          )
               AND (RECE05-NAME(IDX4)(1:14)
                                          =  "保険名称変更：")
                  MOVE     "1"          TO  RECE05-RECEPTFLG(IDX4)
                  MOVE     "1"          TO  RECE05-RECEDENFLG(IDX4)
      *
                  MOVE      ZERO        TO  IDW3
                  PERFORM   VARYING   IDW   FROM   300   BY  -1
                             UNTIL    IDW     <    15
                       IF  RECE05-NAME(IDX4)(IDW:1)  NOT =  SPACE
                           COMPUTE IDW6       =  (IDW / 2) - 7
                           MOVE    IDW        TO  IDW3
                           MOVE    1          TO  IDW
                       END-IF
                  END-PERFORM
                  IF     IDW3    NOT =  ZERO
                    MOVE  SPACE TO RECE05-NAME(IDX4 - 1)
                    COMPUTE   IDW4  =  IDW3  -  14
                    MOVE  RECE05-NAME(IDX4)(15:IDW4)
                                TO RECE05-NAME(IDX4 - 1)(1:IDW4)
                    COMPUTE   IDW5  =  IDW4  +   1
                    MOVE  "にて診察料算定済"
                                TO RECE05-NAME(IDX4 - 1)(IDW5:16)
                    COMPUTE   RECE05-YUKOKETA(IDX4 - 1) =
                              RECE05-YUKOKETA(IDX4 - 1) -
                              3                         +
                              IDW6
                  END-IF
               END-IF
      *
               IF  RECE05-YUKOKETA(IDX4)  =  ZERO
                   PERFORM   VARYING   IDW   FROM   300   BY  -1
                           UNTIL   IDW   <   1
                       IF   RECE05-NAME(IDX4)(IDW:1)  NOT =   SPACE
                           COMPUTE RECE05-YUKOKETA(IDX4)  =
                                   IDW     /   2
                           MOVE    1          TO  IDW
                       END-IF
                   END-PERFORM
               END-IF
      *
      *        特定器材（画像診断のフィルム以外）のとき単価を編集
               IF      SRY-SRYCD (IDX2) (1:1)  =   "7"
                   IF   (  SRY-SRYCD (IDX2)         =
                                    "799990070"            OR
                                    "770020070"            OR
                                    "770030070"               )
      ***          OR   (  TNS-DATAKBN              =   "3"   )
                       CONTINUE
                   ELSE
      *********        SET     TBL-SANSO           TO  1
      *                SEARCH      TBL-SANSO-OCC   VARYING   TBL-SANSO
      *                     AT  END
      *                         MOVE    ZERO            TO  FLG-SANSO-OK
      *                     WHEN    SRY-SRYCD (IDX2)    =   TBL-SANSO-SRYCD
      *                                                          (TBL-SANSO)
      *                         MOVE    1               TO  FLG-SANSO-OK
      *                END-SEARCH
      *********        IF      FLG-SANSO-OK        =   "1"
                     IF      RECE05-TEN(IDX4)  =   ZERO
                       CONTINUE
                     ELSE
                       PERFORM 2104412-RECE05-TANKA-HEN-SEC
                       COMPUTE IDW =   RECE05-YUKOKETA(IDX4)  *  2 
                                                   +   3                    
                       MOVE    WRK-CHAR-N (1:WRK-CHAR-N-CNT)
                                                   TO
                                               RECE05-NAME(IDX4)(IDW:)   
                       COMPUTE RECE05-YUKOKETA(IDX4)
                                               =   RECE05-YUKOKETA(IDX4)
                                                   +   1   
                                                   +
                                                  (WRK-CHAR-N-CNT  /  2)
                     END-IF
                   END-IF
               END-IF        
      *----------------------------------------------------------------
      *        在宅部分のレセプト編集用に往診（特別往診）・夜間・
      *        深夜・緊急の剤判定を追加
      *----------------------------------------------------------------
               IF    SRY-SRYKBN     =  "14"
      *
                 IF  SRY-SRYCD(IDX2) =  "114001110"
                                    OR  "114012910"
                                    OR  "114018010"
                                    OR  "114030310"
                                    OR  "114042110"
                                    OR  "114042210"
                                    OR  "114042810"
                                    OR  "114046310"
                                    OR  "114001470"
                    MOVE        9         TO    FLG-OSINKBN
                 END-IF
      *
                 EVALUATE    SRY-SRYCD(IDX2)
      *往診（特別往診）
                   WHEN    "114000110"
                   WHEN    "114001610"
                   WHEN    "114000970"
                   WHEN    "114002470"
      ***          WHEN    "114002970"
                   IF  FLG-OSINKBN        NOT = 2  AND  3  AND  9
                       MOVE     1         TO    FLG-OSINKBN
                   END-IF
      *夜間
                   WHEN    "114000470"
                   WHEN    "114001970"
                   WHEN    "114011670"
                   WHEN    "114011970"
                   WHEN    "114017570"
                   WHEN    "114017870"
      *
                   WHEN    "114029270"
                   WHEN    "114029370"
                   WHEN    "114029470"
                   WHEN    "114029570"
                   WHEN    "114029970"
                   WHEN    "114030070"
                   WHEN    "114030170"
                   WHEN    "114030270"
                   IF  FLG-OSINKBN        NOT = 9
                       MOVE     2         TO    FLG-OSINKBN
                   END-IF
      *深夜・緊急
                   WHEN    "114000370"
                   WHEN    "114000570"
                   WHEN    "114001870"
                   WHEN    "114002070"
                   WHEN    "114011570"
                   WHEN    "114011770"
                   WHEN    "114011870"
                   WHEN    "114012070"
                   WHEN    "114017470"
                   WHEN    "114017770"
                   WHEN    "114017670"
                   WHEN    "114017970"
                   IF  FLG-OSINKBN        NOT = 9
                       MOVE     3         TO    FLG-OSINKBN
                   END-IF
                 END-EVALUATE
      *
                 IF    RECE02-SRYYM   >=  "201404"
                  EVALUATE    SRY-SRYCD(IDX2)
      *            往診
                   WHEN    "114000110"
                     PERFORM  VARYING  IDX19  FROM  2  BY  1
                               UNTIL   IDX19   >   10
                       COMPUTE  IDX21 = IDX19 - 1
                       PERFORM  VARYING  IDX20  FROM  1  BY  1
                                 UNTIL   IDX20   >   31
                        IF  ACCT-DAY(IDX19 IDX20) NOT = ZERO
                          ADD    ACCT-DAY(IDX19 IDX20)
                                   TO  TBL-ZAITAKU-KAISU(1 IDX21 IDX20)
                        END-IF
                       END-PERFORM
                     END-PERFORM
                     MOVE  1  TO  FLG-ZAITAKU-CHECK
      *            患家診療時間加算（往診）
                   WHEN    "114000970"
                    IF  FLG-ZAITAKU-CHECK = ZERO
                     PERFORM  VARYING  IDX19  FROM  2  BY  1
                               UNTIL   IDX19   >   10
                       COMPUTE  IDX21 = IDX19 - 1
                       PERFORM  VARYING  IDX20  FROM  1  BY  1
                                 UNTIL   IDX20   >   31
                        IF  ACCT-DAY(IDX19 IDX20) NOT = ZERO
                          ADD    ACCT-DAY(IDX19 IDX20)
                                   TO  TBL-ZAITAKU-KAISU(2 IDX21 IDX20)
                        END-IF
                       END-PERFORM
                     END-PERFORM
                    END-IF
      *            特別往診
                   WHEN    "114001610"
                     PERFORM  VARYING  IDX19  FROM  2  BY  1
                               UNTIL   IDX19   >   10
                       COMPUTE  IDX21 = IDX19 - 1
                       PERFORM  VARYING  IDX20  FROM  1  BY  1
                                 UNTIL   IDX20   >   31
                        IF  ACCT-DAY(IDX19 IDX20) NOT = ZERO
                          ADD    ACCT-DAY(IDX19 IDX20)
                                   TO  TBL-ZAITAKU-KAISU(3 IDX21 IDX20)
                        END-IF
                       END-PERFORM
                     END-PERFORM
                     MOVE  1  TO  FLG-ZAITAKU-CHECK
      *            患家診療時間加算（特別往診）
                   WHEN    "114002470"
                    IF  FLG-ZAITAKU-CHECK = ZERO
                     PERFORM  VARYING  IDX19  FROM  2  BY  1
                               UNTIL   IDX19   >   10
                       COMPUTE  IDX21 = IDX19 - 1
                       PERFORM  VARYING  IDX20  FROM  1  BY  1
                                 UNTIL   IDX20   >   31
                        IF  ACCT-DAY(IDX19 IDX20) NOT = ZERO
                          ADD    ACCT-DAY(IDX19 IDX20)
                                   TO  TBL-ZAITAKU-KAISU(4 IDX21 IDX20)
                        END-IF
                       END-PERFORM
                     END-PERFORM
                    END-IF
      *            在宅患者訪問診療料
                   WHEN    "114001110"
                   WHEN    "114012910"
                   WHEN    "114018010"
                   WHEN    "114030310"
                   WHEN    "114042110"
                   WHEN    "114042210"
                   WHEN    "114042810"
                   WHEN    "114046310"
                     PERFORM  VARYING  IDX19  FROM  2  BY  1
                               UNTIL   IDX19   >   10
                       COMPUTE  IDX21 = IDX19 - 1
                       PERFORM  VARYING  IDX20  FROM  1  BY  1
                                 UNTIL   IDX20   >   31
                        IF  ACCT-DAY(IDX19 IDX20) NOT = ZERO
                          ADD    ACCT-DAY(IDX19 IDX20)
                                   TO  TBL-ZAITAKU-KAISU(5 IDX21 IDX20)
                        END-IF
                       END-PERFORM
                     END-PERFORM
                     MOVE  1  TO  FLG-ZAITAKU-CHECK
      *            患家診療時間加算（在宅患者訪問診療料）
                   WHEN    "114001470"
                    IF  FLG-ZAITAKU-CHECK = ZERO
                     PERFORM  VARYING  IDX19  FROM  2  BY  1
                               UNTIL   IDX19   >   10
                       COMPUTE  IDX21 = IDX19 - 1
                       PERFORM  VARYING  IDX20  FROM  1  BY  1
                                 UNTIL   IDX20   >   31
                        IF  ACCT-DAY(IDX19 IDX20) NOT = ZERO
                          ADD    ACCT-DAY(IDX19 IDX20)
                                   TO  TBL-ZAITAKU-KAISU(6 IDX21 IDX20)
                        END-IF
                       END-PERFORM
                     END-PERFORM
                    END-IF
                  END-EVALUATE
                 END-IF
      *
               END-IF
      *
               MOVE    ACCT-ZAIKBN  TO  RECE04-ZAIKBN
      *
               IF      ACCT-ZAIKBN       =     1
                 MOVE   ZERO        TO  RECE05-SRYSURYO(IDX4)
                 MOVE   ZERO        TO  RECE05-TANICD(IDX4)
                 MOVE   ZERO        TO  RECE05-TANIMOJISU(IDX4)
                 MOVE   SPACE       TO  RECE05-TANINAME(IDX4)
                 IF  (SRY-SRYCD(IDX2)(1:1) = "6" OR "7")
                 OR  (SRY-SRYCD(IDX2)(1:3) = "059"     )
                 OR  (SRY-SRYCD(IDX2)(1:2) = "63"      )
                     MOVE  "1"          TO  RECE04-COMCDFLG
                     MOVE  "810000001"  TO  RECE05-SRYCD(IDX4)
                 END-IF
               END-IF
               IF      ACCT-ZAIKBN       =     2
                 MOVE   ZERO        TO  RECE05-SRYSURYO(IDX4)
                 MOVE   ZERO        TO  RECE05-TANICD(IDX4)
                 MOVE   ZERO        TO  RECE05-TANIMOJISU(IDX4)
                 MOVE   SPACE       TO  RECE05-TANINAME(IDX4)
               END-IF
      *
               PERFORM 2104414-SETCOM-HENSYU-SEC
      *
               IF   (RECE02-SRYYM           >= "201810")
               AND  (RECE05-SRYCD(IDX4)(1:4) = "8201"  )
                 MOVE   "1"         TO  RECE04-SENTAKUCOMFLG
               END-IF
      *
               IF    (RECE02-SRYYM         >=  "201704")
               AND   (SRY-SRYCD(IDX2)(1:3)  =  "059"   )
                 IF   (RECE02-RECESYUBETU  =
                                    "6666" OR "0000"      )
                 OR   (RECE02-ERR-ERRKBN   >   ZERO       )
                 OR   (SRY-SRYKBN          =  "95" OR "96")
      ***        OR   ((WRK-PARA-PRTKBN    =  "1"   ) AND
      ***              (ACCT-ZAITEN        =   ZERO )     )
                 OR   ((WRK-PARA-PRTKBN
                                       NOT =  "9"   ) AND
                       (RECE02-RECESYUBETU =  "8888")     )
                   CONTINUE
                 ELSE
                   MOVE     15      TO  RECE02-ERR-ERRKBN
                   DISPLAY "059 ERR:SRYCD=" SRY-SRYCD(IDX2)
                 END-IF
               END-IF
      *
               IF    (RECE02-SRYYM               >=  "201604")
               AND   (RECE02-ZAITAKU              =  "1"     )
               AND   (RECE02-DAISANFLG(IDX1)  NOT =   1      )
               AND   (RECE02-ZAITAKU-SANTEI-FLG   =  SPACE   )
                 PERFORM  VARYING  IDW11  FROM  1  BY  1
                           UNTIL   IDW11   >   TBL-ZAITAKU-MAX
                   IF   SRY-SRYCD(IDX2) = TBL-ZAITAKU(IDW11)
                     MOVE   "1"    TO   RECE02-ZAITAKU-SANTEI-FLG
                     MOVE   TBL-ZAITAKU-MAX  TO  IDW11
                   END-IF
                 END-PERFORM
               END-IF
      *
              END-IF
             END-IF  
           END-PERFORM
      *
           IF    IDX4    NOT =   ZERO
               MOVE    1     TO    FLG-WRITE05X
           END-IF
      *
           .
       210441-RECE05-TENSOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトコメントフラグ編集処理
      *****************************************************************
       2104411-RECE05-COMCNT-HEN-SEC               SECTION.
      *
           IF      RECE04-SRYKBN      =     "11" OR "12" OR "13"
              IF   SRY-SRYCD(IDX2)    =  "111012970" OR "111013070"
                                      OR "111013170" OR "111013270"
                                      OR "111013370" OR "111013470"
                                      OR "111013570" OR "111013670"
                                      OR "112021370" OR "112021470"
                                      OR "112021570" OR "112021670"
                                      OR "112022070" OR "112022170"
                                      OR "112022270" OR "112022370"
                                      OR "112022870" OR "112022470"
                                      OR "112022570" OR "112022670"
                                      OR "112022770" OR "112022970"
                                      OR "112023070" OR "112023170"
                                      OR "113024970" OR "113025070"
                                      OR "113025170" OR "113025270"
                                      OR "113025370" OR "113025470"
                                      OR "113025570" OR "113025870"
                                      OR "113025970" OR "113026070"
                                      OR "113026170" OR "113026270"
                                      OR "113026370" OR "113026470"
                 EVALUATE   RECE02-NINPUFLG
                    WHEN        0
                            MOVE    1    TO    RECE02-NINPUFLG
                    WHEN        2
                            MOVE    3    TO    RECE02-NINPUFLG
                 END-EVALUATE
              END-IF
           END-IF
           IF      RECE04-SRYKBN      =     "99"
              IF   SRY-SRYCD(IDX2)    =     "820100348"
                 EVALUATE   RECE02-NINPUFLG
                    WHEN        0
                            MOVE    2    TO    RECE02-NINPUFLG
                    WHEN        1
                            MOVE    3    TO    RECE02-NINPUFLG
                 END-EVALUATE
              END-IF
           END-IF
      *
           IF      RECE04-SRYKBN      =     "11"
      *       初診料算定科：
              IF ( SRY-SRYCD(IDX2)    =     "830000020"          )
              OR ((SRY-SRYCD(IDX2)    =     "111011810"         ) AND
                  (RECE02-SRYYM      >=     "201204"            ))
              OR ( SRY-SRYCD(IDX2)    =     "111012610"
                                     OR     "111012810"          )
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-SYOSANTEIKA-COMMENT
              END-IF
      *       初診（同日複数診療科）
              IF  (SRY-SRYCD(IDX2)    =     "111011810"
                                      OR    "111012610"
                                      OR    "111012810"         )
              AND (FLG-SYODOU-COM     =     ZERO                )
                   MOVE   "1"   TO    RECE04-FLG-SYODOU-COMMENT
                   MOVE   SRY-SRYKA   TO    RECE04-SYODOU-SRYKA(1)
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "830000024"
                   MOVE  SPACE  TO    RECE04-FLG-SYODOU-COMMENT
                   MOVE  SPACE  TO    RECE04-SYODOU-SRYKA(1)
                   MOVE    1    TO    FLG-SYODOU-COM
              END-IF
           END-IF
      *
           IF      RECE04-SRYKBN      =     "12"
      *       再診料算定科：
              IF   SRY-SRYCD(IDX2)    =     "830000021"
                                      OR    "112015810"
                                      OR    "112017010"
                                      OR    "112015950"
                                      OR    "112017150"
                                      OR    "112023550"
                                      OR    "112023850"
                                      OR    "112016210"
                                      OR    "112016410"
                                      OR    "112017610"
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-SAISANTEIKA-COMMENT
              END-IF
      *       電話再診
              IF  (SRY-SRYCD(IDX2)    =     "112009750"   OR
                                            "112009850"   OR
                                            "112009950"   OR
                                            "112010050"   OR
                                            "112012750"   OR
                                            "112704150"   OR
                                            "112704250"   OR
                                            "112704350"   OR
                                            "112706750"   OR
                                            "112010650"   OR
                                            "112010750"   OR
                                            "112010850"   OR
                                            "112010950"   OR
                                            "112012850"   OR
                                            "112704850"   OR
                                            "112704950"   OR
                                            "112705050"   OR
                                            "112706850"   OR
                                            "112007950"   OR
                                            "112008050"   OR
                                            "112008150"   OR
                                            "112008250"   OR
                                            "112012450"   OR
                                            "112702750"   OR
                                            "112702850"   OR
                                            "112702950"   OR
                                            "112706450"   OR
                                            "112008850"   OR
                                            "112008950"   OR
                                            "112009050"   OR
                                            "112009150"   OR
                                            "112012550"   OR
                                            "112703450"   OR
                                            "112703550"   OR
                                            "112703650"   OR
                                            "112706550"     )
              AND (RECE02-SRYYM       <     "201004"        )
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-DENWASAI-COMMENT
              END-IF
              IF ((SRY-SRYCD(IDX2)    =     "112007950"     ) AND
                  (RECE02-SRYYM       >=    "201004"        ))
              OR ((SRY-SRYCD(IDX2)    =     "112016750"     ) AND
                  (RECE02-SRYYM       >=    "201501"        ))
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-DENWASAI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "112023350"
                                         OR "112023650"
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-DENWASAI2-COMMENT
              END-IF
      *       同日再診
              IF  (SRY-SRYCD(IDX2)    =     "112010150"   OR
                                            "112010250"   OR
                                            "112010350"   OR
                                            "112010450"   OR
                                            "112010550"   OR
                                            "112704450"   OR
                                            "112704550"   OR
                                            "112704650"   OR
                                            "112704750"   OR
                                            "112010650"   OR
                                            "112010750"   OR
                                            "112010850"   OR
                                            "112010950"   OR
                                            "112012850"   OR
                                            "112704850"   OR
                                            "112704950"   OR
                                            "112705050"   OR
                                            "112706850"   OR
                                            "112008850"   OR
                                            "112008950"   OR
                                            "112009050"   OR
                                            "112009150"   OR
                                            "112012550"   OR
                                            "112703450"   OR
                                            "112703550"   OR
                                            "112703650"   OR
                                            "112706550"   OR
                                            "112008350"   OR
                                            "112008450"   OR
                                            "112008550"   OR
                                            "112008650"   OR
                                            "112008750"   OR
                                            "112703050"   OR
                                            "112703150"   OR
                                            "112703250"   OR
                                            "112703350"   OR
      *
                                            "112011710"   OR
                                            "112705850"     )
              AND (RECE02-SRYYM       <     "201004"        )
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-DOUJITUSAI-COMMENT
              END-IF
              IF ((SRY-SRYCD(IDX2)    =     "112008350"   OR
                                            "112011710"   OR
                                            "112016550"     ) AND
                  (RECE02-SRYYM       >=    "201004"        ))
              OR ((SRY-SRYCD(IDX2)    =     "112016850"     ) AND
                  (RECE02-SRYYM       >=    "201501"        ))
              OR ((SRY-SRYCD(IDX2)    =     "112017450"     ) AND
                  (RECE02-SRYYM       >=    "201501"        ))
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-DOUJITUSAI-COMMENT
              END-IF
      *       同日電話再診
              IF ((SRY-SRYCD(IDX2)    =     "112008850"     ) AND
                  (RECE02-SRYYM       >=    "201004"        ))
              OR ((SRY-SRYCD(IDX2)    =     "112016950"     ) AND
                  (RECE02-SRYYM       >=    "201501"        ))
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-DOUDENSAI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "112023450"
                                         OR "112023750"
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-DOUDENSAI2-COMMENT
              END-IF
      *       再診（４回目以降／人工腎臓）
              IF   SRY-SRYCD(IDX2)    =     "112009510"   OR
                                            "112009610"   OR
                                            "112012610"   OR
                                            "112704010"   OR
                                            "112706610"   OR
                                            "112010450"   OR
                                            "112010550"   OR
                                            "112704750"   OR
                                            "112007710"   OR
                                            "112007810"   OR
                                            "112012310"   OR
                                            "112702610"   OR
                                            "112706310"   OR
                                            "112008650"   OR
                                            "112008750"   OR
                                            "112703350"     
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-SAIJINKO-COMMENT
              END-IF
      *
      *       再診（同一日２科目）
              IF  (SRY-SRYCD(IDX2)    =     "112015810"
                                      OR    "112017010"
                                      OR    "112015950"
                                      OR    "112017150"
                                      OR    "112023550"
                                      OR    "112023850"
                                      OR    "112016210"
                                      OR    "112016410"
                                      OR    "112017610"      )
              AND (FLG-SAIDOU-COM     =     ZERO             )
                 MOVE   "1"        TO   RECE04-FLG-SAIDOU-COMMENT
                 MOVE   SRY-SRYKA  TO   RECE04-SAIDOU-SRYKA(1)
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "830000051"
                 MOVE   SPACE      TO   RECE04-FLG-SAIDOU-COMMENT
                 MOVE   SPACE      TO   RECE04-SAIDOU-SRYKA(1)
                 MOVE    1         TO   FLG-SAIDOU-COM
              END-IF
      *
      *       オンライン診療料
              IF   SRY-SRYCD(IDX2)    =     "112023210"
                 MOVE   "1"        TO   RECE04-FLG-ONLINE-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "820100006"
                 MOVE    1         TO   RECE04-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "820100007"
                 MOVE    2         TO   RECE04-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "820100008"
                 MOVE    3         TO   RECE04-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "820100009"
                 MOVE    4         TO   RECE04-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "820100010"
                 MOVE    5         TO   RECE04-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "820100011"
                 MOVE    6         TO   RECE04-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "820100012"
                 MOVE    7         TO   RECE04-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "820100013"
                 MOVE    8         TO   RECE04-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "820100014"
                 MOVE    9         TO   RECE04-FLG-ONLINE2-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "820100015"
                 MOVE    10        TO   RECE04-FLG-ONLINE2-COMMENT
              END-IF
           END-IF
      *
           IF      RECE04-SRYKBN      =     "40"
      *       人工腎臓
              IF   SRY-SRYCD(IDX2)    =     "140036710"   OR
                                            "140007710"
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-JINKOJIN-COMMENT
              END-IF
      *       介達牽引（発症日記載）
              IF   RECE02-SRYYM      >=    "200604"
              AND  RECE02-SRYYM      <=    "200803"
                IF   SRY-SRYCD(IDX2)  =     "140048010"
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-KAITATU-COMMENT
                END-IF
              END-IF
      *
              IF   RECE02-SRYYM      >=    "201004"
      *         人工腎臓等
                IF   SRY-SRYCD(IDX2)  =  "140007710" OR "140036710"
                                      OR "140051010" OR "140051110"
                                      OR "140008510" OR "140029850"
                                      OR "140008210" OR "140039210"
                                      OR "140052810" OR "140057810"
                                      OR "140057910" OR "140058010"
                                      OR "140058110" OR "140058210"
                                      OR "140058310" OR "140058410"
                                      OR "140058510" OR "140058610"
                                      OR "140059310" OR "140059410"
                                      OR "140059510"
                                      OR "140060210" OR "140060310"
                                      OR "140060410" OR "140060510"
                                      OR "140060610" OR "140060710"
                                      OR "140060810" OR "140060910"
                                      OR "140061010"
                        MOVE   "1"    TO    RECE04-FLG-JINZOU-COMMENT
                END-IF
      *         局所陰圧閉鎖処置
                IF    RECE02-SRYYM      >=    "201404"
                  IF   SRY-SRYCD(IDX2)  =     "140054270"
                                          OR  "140054370"
                                          OR  "140054470"
                        MOVE   "1"    TO    RECE04-FLG-KYOKUIN-COMMENT
                  END-IF
                ELSE
                 IF   RECE02-SRYYM      >=    "201204"
                  IF   SRY-SRYCD(IDX2)  =     "140052170"
                                          OR  "140052270"
                                          OR  "140052370"
                        MOVE   "1"    TO    RECE04-FLG-KYOKUIN-COMMENT
                  END-IF
                 ELSE
                  IF   SRY-SRYCD(IDX2)  =     "140052410"
                                          OR  "140051810"
                                          OR  "140051910"
                                          OR  "140052010"
                        MOVE   "1"    TO    RECE04-FLG-KYOKUIN-COMMENT
                  END-IF
                 END-IF
                END-IF
              END-IF
      *       磁気による膀胱等刺激法
              IF   RECE02-SRYYM    >=     "201404"
                IF  (SRY-SRYCD(IDX2)    =     "140055110"         )
                AND (FLG-BOKOHO-COM     =     ZERO                )
                   MOVE   "1"   TO    RECE04-FLG-BOKOHO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)    =     "840000085"
                   MOVE  SPACE  TO    RECE04-FLG-BOKOHO-COMMENT
                   MOVE    1    TO    FLG-BOKOHO-COM
                END-IF
              END-IF
      *       高気圧酸素治療
              IF  (SRY-SRYCD(IDX2)    =     "140057510"        )
              AND (FLG-KIATU-COM      =     ZERO               )
                   MOVE   "1"   TO    RECE04-FLG-KIATU-COMMENT
              END-IF
              IF  (SRY-SRYCD(IDX2)    =     "140057610"        )
              AND (FLG-KIATU-COM      =     ZERO               )
                   MOVE   "2"   TO    RECE04-FLG-KIATU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000085"
                                      OR    "840000086"
                                      OR    "840000045"
                   MOVE  SPACE  TO    RECE04-FLG-KIATU-COMMENT
                   MOVE    1    TO    FLG-KIATU-COM
              END-IF
           END-IF
      *
           IF      RECE04-SRYKBN      =     "80"
      *       リハビリ
              IF   SRY-SRYCD(IDX2)    =     "180706910"   OR
                                            "180022210"   OR
                                            "180706810"   OR
                                            "180022110"   OR
                                            "180707110"   OR
                                            "180022410"   OR
                                            "180707010"   OR
                                            "180022310"   OR
                                            "180707310"   OR
                                            "180022610"   OR
                                            "180707210"   OR
                                            "180022510"   OR
                                            "180707510"   OR
                                            "180022810"   OR
                                            "180707410"   OR
                                            "180022710"   OR
                                            "180708210"   OR
                                            "180023710"   OR
                                            "180708410"   OR
                                            "180023910"   OR
                                            "180708110"   OR
                                            "180023610"   OR
                                            "180708310"   OR
                                            "180023810"   OR
                                            "180024910"   OR
                                            "180024810"   OR
                                            "180025110"   OR
                                            "180025010"   OR
                                            "180025510"   OR
                                            "180025410"
      ****              MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-RIHABIRI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "180027410"           OR
                                            "180027510"           OR
                                            "180029110"           OR
                                            "180029210"           OR
                                            "180028010"           OR
                                            "180028110"           OR
                                            "180029710"           OR
                                            "180029810"           OR
                                            "180027610"           OR
                                            "180027710"           OR
                                            "180029310"           OR
                                            "180029410"           OR
                                            "180030810"           OR
                                            "180032410"           OR
                                            "180032510"           OR
                                            "180032610"           OR
                                            "180033910"           OR
                                            "180034010"           OR
                                            "180034110"           OR
                                            "180034210"           OR
                                            "180034310"           OR
                                            "180034410"           OR
                                            "180043430"           OR
                                            "180043530"           OR
                                            "180043630"           OR
                                            "180043730"           OR
                                            "180043830"           OR
                                            "180043930"           OR
                                            "180050330"           OR
                                            "180050430"           OR
                                            "180050530"           OR
                                            "180050730"           OR
                                            "180050930"           OR
                                            "180051130"           OR
                                            "180051230"           OR
                                            "180051330"           OR
                                            "180051430"           OR
                                            "180027810"           OR
                                            "180027910"           OR
                                            "180029510"           OR
                                            "180029610"           OR
                                            "180032710"           OR
                                            "180034510"           OR
                                            "180034610"           OR
                                            "180034710"           OR
                                            "180044030"           OR
                                            "180044130"           OR
                                            "180044230"           OR
                                            "180052730"           OR
                                            "180052830"           OR
                                            "180052930"           OR
                                            "180053130"           OR
                                            "180053330"           OR
                                            "180053530"           OR
                                            "180053630"           OR
                                            "180053730"           OR
                                            "180053830"           OR
                                            "180028210"           OR
                                            "180028310"           OR
                                            "180028410"           OR
                                            "180044610"           OR
                                            "180044710"           OR
                                            "180044810"           OR
                                            "180045010"           OR
                                            "180045210"           OR
                                            "180045410"           OR
                                            "180045530"           OR
                                            "180045630"           OR
                                            "180045730"           OR
                                            "180051530"           OR
                                            "180051630"           OR
                                            "180051730"           OR
                                            "180051930"           OR
                                            "180052130"           OR
                                            "180052330"           OR
                                            "180052430"           OR
                                            "180052530"           OR
                                            "180052630"           OR
                                            "180033110"
      ****              MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-RIHABIRI-COMMENT
              END-IF
              EVALUATE      SRY-SRYCD(IDX2)
                WHEN     "180029910"
                        MOVE   "2"    TO    RECE04-RIHABIRI-COMMENT
                WHEN     "180030010"
                        MOVE   "3"    TO    RECE04-RIHABIRI-COMMENT
                WHEN     "180030510"
                        MOVE   "4"    TO    RECE04-RIHABIRI-COMMENT
                WHEN     "180030610"
                        MOVE   "5"    TO    RECE04-RIHABIRI-COMMENT
                WHEN     "180030110"
                        MOVE   "6"    TO    RECE04-RIHABIRI-COMMENT
                WHEN     "180030210"
                        MOVE   "7"    TO    RECE04-RIHABIRI-COMMENT
                WHEN     "180030310"
                        MOVE   "8"    TO    RECE04-RIHABIRI-COMMENT
                WHEN     "180030410"
                        MOVE   "9"    TO    RECE04-RIHABIRI-COMMENT
              END-EVALUATE
      *       リハビリ（発症日記載）
              IF   RECE02-SRYYM      >=    "200604"
                IF   SRY-SRYCD(IDX2)  =     "180027410"
                                      OR    "180027510"
                                      OR    "180029110"
                                      OR    "180029210"
                                      OR    "180029910"
                                      OR    "180030010"
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-SINDAI-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE04-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE02-RIHA-SINDAI(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "180028010"
                                      OR    "180028110"
                                      OR    "180029710"
                                      OR    "180029810"
                                      OR    "180030510"
                                      OR    "180030610"
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-KOKYUKI-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE04-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE02-RIHA-KOKYUKI(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "180027610"
                                      OR    "180027710"
                                      OR    "180029310"
                                      OR    "180029410"
                                      OR    "180030110"
                                      OR    "180030210"
                                      OR    "180030810"
                                      OR    "180032410"
                                      OR    "180032510"
                                      OR    "180032610"
                                      OR    "180033910"
                                      OR    "180034010"
                                      OR    "180034110"
                                      OR    "180034210"
                                      OR    "180034310"
                                      OR    "180034410"
                                      OR    "180043430"
                                      OR    "180043530"
                                      OR    "180043630"
                                      OR    "180043730"
                                      OR    "180043830"
                                      OR    "180043930"
                                      OR    "180050330"
                                      OR    "180050430"
                                      OR    "180050530"
                                      OR    "180050730"
                                      OR    "180050930"
                                      OR    "180051130"
                                      OR    "180051230"
                                      OR    "180051330"
                                      OR    "180051430"
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-NOUKE-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE04-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE02-RIHA-NOUKE(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "180027810"
                                      OR    "180027910"
                                      OR    "180029510"
                                      OR    "180029610"
                                      OR    "180030310"
                                      OR    "180030410"
                                      OR    "180032710"
                                      OR    "180034510"
                                      OR    "180034610"
                                      OR    "180034710"
                                      OR    "180044030"
                                      OR    "180044130"
                                      OR    "180044230"
                                      OR    "180052730"
                                      OR    "180052830"
                                      OR    "180052930"
                                      OR    "180053130"
                                      OR    "180053330"
                                      OR    "180053530"
                                      OR    "180053630"
                                      OR    "180053730"
                                      OR    "180053830"
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-UNDOKI-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE04-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE02-RIHA-UNDOKI(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180017910"        )
                AND (RECE02-SRYYM    <=     "201803"           )
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-NANBYO-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE04-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE02-RIHA-NANBYO(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180028210"
                                      OR    "180028310"
                                      OR    "180028410"         )
                AND (RECE02-SRYYM    <=     "201803"            )
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-SYOGAI-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE04-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE02-RIHA-SYOGAI(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "180016610"
                                      OR    "180054310"
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-SESSYOKU-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE04-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE02-RIHA-SESSYOKU(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "180044610"
                                      OR    "180044710"
                                      OR    "180044810"
                                      OR    "180045010"
                                      OR    "180045210"
                                      OR    "180045410"
                                      OR    "180045530"
                                      OR    "180045630"
                                      OR    "180045730"
                                      OR    "180051530"
                                      OR    "180051630"
                                      OR    "180051730"
                                      OR    "180051930"
                                      OR    "180052130"
                                      OR    "180052330"
                                      OR    "180052430"
                                      OR    "180052530"
                                      OR    "180052630"
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-HAIYO-COMMENT
                        PERFORM  VARYING  IDX16  FROM  1  BY  1
                                  UNTIL   IDX16   >   31
                         IF  RECE04-KAISU(1 IDX16) NOT = ZERO
                          MOVE  1  TO  RECE02-RIHA-HAIYO(IDX1 IDX16)
                         END-IF
                        END-PERFORM
                END-IF
              END-IF
      *
              IF   (RECE02-SRYYM    >=   "201604"             )
              AND  (SRY-SRYCD(IDX2)  =   "180033870"
                                     OR  "180030770"          )
                IF   RECE04-SINDAI-COMMENT = "1"
                    MOVE   "1"    TO    RECE04-SINDAI9-COMMENT
                    PERFORM  VARYING  IDX16  FROM  1  BY  1
                              UNTIL   IDX16   >   31
                      IF  RECE04-KAISU(1 IDX16) NOT = ZERO
                        MOVE  1  TO  RECE02-RIHA-SINDAI9(IDX1 IDX16)
                      END-IF
                    END-PERFORM
                END-IF
                IF   RECE04-KOKYUKI-COMMENT = "1"
                    MOVE   "1"    TO    RECE04-KOKYUKI9-COMMENT
                    PERFORM  VARYING  IDX16  FROM  1  BY  1
                              UNTIL   IDX16   >   31
                      IF  RECE04-KAISU(1 IDX16) NOT = ZERO
                        MOVE  1  TO  RECE02-RIHA-KOKYUKI9(IDX1 IDX16)
                      END-IF
                    END-PERFORM
                END-IF
                IF   RECE04-HAIYO-COMMENT = "1"
                    MOVE   "1"    TO    RECE04-HAIYO9-COMMENT
                    PERFORM  VARYING  IDX16  FROM  1  BY  1
                              UNTIL   IDX16   >   31
                      IF  RECE04-KAISU(1 IDX16) NOT = ZERO
                        MOVE  1  TO  RECE02-RIHA-HAIYO9(IDX1 IDX16)
                      END-IF
                    END-PERFORM
                END-IF
              END-IF
      *
      *       認知療法・認知行動療法
              IF   RECE02-SRYYM      >=    "201004"
                IF  (SRY-SRYCD(IDX2)  =     "180033210"         )
                AND (FLG-NINRYO-COM   =     ZERO                )
                        MOVE   "1"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180035910"         )
                AND (FLG-NINRYO-COM   =     ZERO                )
                        MOVE   "2"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "188006210"         )
                AND (FLG-NINRYO-COM   =     ZERO                )
                        MOVE   "3"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "188007010"         )
                AND (FLG-NINRYO-COM   =     ZERO                )
                        MOVE   "4"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180047810"         )
                AND (FLG-NINRYO-COM   =     ZERO                )
                        MOVE   "5"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "188010610"         )
                AND (FLG-NINRYO-COM   =     ZERO                )
                        MOVE   "7"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180056410"         )
                AND (FLG-NINRYO-COM   =     ZERO                )
                        MOVE   "8"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
              END-IF
      *       精神科重症患者早期集中支援管理料
      *       精神科在宅患者支援管理料
              IF   RECE02-SRYYM      >=    "201604"
                IF  (SRY-SRYCD(IDX2)  =     "180057210"          )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "A"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180057310"          )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "B"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180057810"          )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "G"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180057910"          )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "H"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF   RECE02-SRYYM    >=    "202004"
                  IF  (SRY-SRYCD(IDX2)  =     "180057410"          )
                  AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "C"    TO    RECE04-FLG-NINRYO-COMMENT
                  END-IF
                  IF  (SRY-SRYCD(IDX2)  =     "180057510"          )
                  AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "D"    TO    RECE04-FLG-NINRYO-COMMENT
                  END-IF
                  IF  (SRY-SRYCD(IDX2)  =     "180057610"          )
                  AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "E"    TO    RECE04-FLG-NINRYO-COMMENT
                  END-IF
                  IF  (SRY-SRYCD(IDX2)  =     "180057710"          )
                  AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "F"    TO    RECE04-FLG-NINRYO-COMMENT
                  END-IF
                  IF  (SRY-SRYCD(IDX2)  =     "180058010"          )
                  AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "I"    TO    RECE04-FLG-NINRYO-COMMENT
                  END-IF
                  IF  (SRY-SRYCD(IDX2)  =     "180058110"          )
                  AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "J"    TO    RECE04-FLG-NINRYO-COMMENT
                  END-IF
                  IF  (SRY-SRYCD(IDX2)  =     "180064010"          )
                  AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "P"    TO    RECE04-FLG-NINRYO-COMMENT
                  END-IF
                  IF  (SRY-SRYCD(IDX2)  =     "180064110"          )
                  AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "Q"    TO    RECE04-FLG-NINRYO-COMMENT
                  END-IF
                END-IF
      *
                IF  (SRY-SRYCD(IDX2)  =     "180042110"          )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "K"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180042410"          )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "L"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180048710"          )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "M"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =     "180048810"          )
                AND (FLG-NINRYO-COM   =     ZERO                 )
                        MOVE   "N"    TO    RECE04-FLG-NINRYO-COMMENT
                END-IF
              END-IF
              IF     SRY-SRYCD(IDX2)  =     "840000097"
                        MOVE  SPACE   TO    RECE04-FLG-NINRYO-COMMENT
                        MOVE    1     TO    FLG-NINRYO-COM
              END-IF
      *
      *       通院・在宅精神療法（２０歳未満）加算
              IF   RECE02-SRYYM      >=    "201404"
      ***       IF   SRY-SRYCD(IDX2)  =     "180020570"
                IF    (TNS-DATAKBN             =    1 )
                AND   (TNS-CDKBN-KBN           =   "I")
                AND   (TNS-CDKBN-KBNNUM        =    2 )
                AND   (TNS-CDKBN-KBNNUM-EDA    =    0 )
                AND   (RECE02-AGE              <    20)
                  IF    (RECE02-AGE           =      19           )
                  AND   (RECE02-BIRTHDAY(5:2) =  RECE02-SRYYM(5:2))
                  AND   (RECE02-BIRTHDAY(7:2) NOT = "01"          )
                    PERFORM VARYING IDX22 FROM 1 BY 1
                             UNTIL (IDX22                      >  31)
                              OR   (RECE04-FLG-TUINZAI-COMMENT = "1")
                      IF   ACCT-DAY(1 IDX22)  NOT = ZERO
                        IF   IDX22 < RECE02-BIRTHDAY(7:2)
                          MOVE "1"    TO    RECE04-FLG-TUINZAI-COMMENT
                        END-IF
                      END-IF
                    END-PERFORM
                  ELSE
                        MOVE   "1"    TO    RECE04-FLG-TUINZAI-COMMENT
                  END-IF
                END-IF
              END-IF
              IF   RECE02-SRYYM      >=    "201604"
                IF   SRY-SRYCD(IDX2)  =     "180020570"
                                      OR    "180047270"
                                      OR    "180047370"
                        MOVE   "1"    TO    RECE04-FLG-TUINZAI2-COMMENT
                END-IF
              END-IF
      *       依存症集団療法
      *       疾患別等専門プログラム加算
      *       経頭蓋磁気刺激療法
              IF   RECE02-SRYYM      >=    "201604"
                IF  (SRY-SRYCD(IDX2)  =    "180047910" OR "188010710")
                AND (FLG-IZONSYO-COM  =    ZERO                      )
                        MOVE   "1"    TO    RECE04-FLG-IZONSYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =    "180056570" OR "188011270")
                AND (FLG-IZONSYO-COM  =    ZERO                      )
                        MOVE   "2"    TO    RECE04-FLG-IZONSYO-COMMENT
                END-IF
              END-IF
              IF   RECE02-SRYYM      >=    "202004"
                IF  (SRY-SRYCD(IDX2)  =    "180058710" OR "188011810")
                AND (FLG-IZONSYO-COM  =    ZERO                      )
                        MOVE   "3"    TO    RECE04-FLG-IZONSYO-COMMENT
                END-IF
                IF  (SRY-SRYCD(IDX2)  =    "180058650"               )
                AND (FLG-IZONSYO-COM  =    ZERO                      )
                        MOVE   "4"    TO    RECE04-FLG-IZONSYO-COMMENT
                END-IF
              END-IF
              IF   SRY-SRYCD(IDX2)  =     "840000076"
                        MOVE  SPACE   TO    RECE04-FLG-IZONSYO-COMMENT
                        MOVE    1     TO    FLG-IZONSYO-COM
              END-IF
      *
      *       精神科オンライン在宅管理料
              IF   SRY-SRYCD(IDX2)    =     "180058270"
                 MOVE   "4"        TO   RECE04-FLG-ONLINE-COMMENT
              END-IF
           END-IF
      *
           IF      RECE04-SRYKBN      =     "13"
              IF   SRY-SRYCD(IDX2)    =     "113006510"
                   MOVE   "1"   TO    RECE04-FLG-SHIDOU-COMMENT
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     "180000710"
              AND  FLG-SYOBYO-COM     =     ZERO
                   MOVE   "1"   TO    RECE04-FLG-SYOBYO-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000011"
                                      OR    "840000012"
                                      OR    "840000511"
                                      OR    "840000512"
                   MOVE  SPACE  TO    RECE04-FLG-SYOBYO-COMMENT
                   MOVE    1    TO    FLG-SYOBYO-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     "113004310"
              AND  FLG-RYOYO-COM      =     ZERO
                   MOVE   "1"   TO    RECE04-FLG-RYOYO-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000078"
                                      OR    "840000578"
                   MOVE  SPACE  TO    RECE04-FLG-RYOYO-COMMENT
                   MOVE    1    TO    FLG-RYOYO-COM
              END-IF
      *
              IF  (SRY-SRYCD(IDX2)    =     "113008310" OR "113008410"
                                      OR    "113008510" OR "113031610")
              AND (FLG-NIKOCHIN-COM   =     ZERO                      )
                   MOVE   "1"   TO    RECE04-FLG-NIKOCHIN-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000097"
                   MOVE  SPACE  TO    RECE04-FLG-NIKOCHIN-COMMENT
                   MOVE    1    TO    FLG-NIKOCHIN-COM
              END-IF
      *
              IF  (SRY-SRYCD(IDX2)    =     "113008070"
                                      OR    "113008170"          )
              AND (FLG-ZENSOKU-COM    =     ZERO                 )
                   MOVE   "1"   TO    RECE04-FLG-ZENSOKU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000098"
                   MOVE  SPACE  TO    RECE04-FLG-ZENSOKU-COMMENT
                   MOVE    1    TO    FLG-ZENSOKU-COM
              END-IF
      *
              IF   RECE02-SRYYM    >=     "200804"
                IF   (SRY-SRYCD(IDX2)   =     "113000810"         )
                AND  (FLG-SYOUNI-COM    =     ZERO                )
                   MOVE   "1"   TO    RECE04-FLG-SYOUNI-COMMENT
                   MOVE   "1"   TO    RECE02-SYOUNIFLG
                END-IF
                IF   (SRY-SRYCD(IDX2)   =     "113009910"
                                        OR    "113029410"         )
                AND  (FLG-SYOUNI-COM    =     ZERO                )
                   MOVE   "2"   TO    RECE04-FLG-SYOUNI-COMMENT
                END-IF
                IF    SRY-SRYCD(IDX2)   =     "840000104"
                                        OR    "840000604"
                   MOVE  SPACE  TO    RECE04-FLG-SYOUNI-COMMENT
                   MOVE    1    TO    FLG-SYOUNI-COM
                END-IF
              END-IF
      *
              IF  (RECE02-SRYYM      >=    "201004")
              AND (RECE02-SRYYM      <=    "202003")
                IF   RECE02-SRYYM    >=    "201604"
      *           遠隔モニタリング加算
                  IF   SRY-SRYCD(IDX2) =  "113018070"
                        MOVE   "1"    TO    RECE04-FLG-SINPESU-COMMENT
                  END-IF
                ELSE
      *           心臓ペースメーカー指導管理料（遠隔モニタリング）
                  IF   SRY-SRYCD(IDX2) =  "113001510"
                        MOVE   "1"    TO    RECE04-FLG-SINPESU-COMMENT
                  END-IF
                END-IF
              END-IF
              IF   RECE02-SRYYM      >=    "202004"
      *           遠隔モニタリング加算（ペースメーカー）
                  IF   SRY-SRYCD(IDX2) =  "113030470"
                        MOVE   "4"    TO    RECE04-FLG-SINPESU-COMMENT
                  END-IF
      *           遠隔モニタリング加算（植込型除細動器等）
                  IF   SRY-SRYCD(IDX2) =  "113030570"
                        MOVE   "5"    TO    RECE04-FLG-SINPESU-COMMENT
                  END-IF
              END-IF
              IF   RECE02-SRYYM      >=    "201004"
              AND  RECE02-SRYYM      <=    "201803"
      *         集団栄養食事指導料
                IF   SRY-SRYCD(IDX2)  =     "113003410"
                        MOVE   "1"    TO    RECE04-FLG-SYUEIYO-COMMENT
                END-IF
              END-IF
      *
              IF   RECE02-SRYYM      >=    "201204"
                IF   SRY-SRYCD(IDX2)  =     "113014610"
                        MOVE   "1"    TO    RECE04-FLG-NINSEN-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "113024310"
                        MOVE   "2"    TO    RECE04-FLG-NINSEN-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "113027910"
                        MOVE   "3"    TO    RECE04-FLG-NINSEN-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "113028310"
                        MOVE   "4"    TO    RECE04-FLG-NINSEN-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "113008710"
                                      OR    "113008610"
                        MOVE   "1"    TO    RECE02-COMCNTFLG
                        MOVE   "1"    TO    RECE04-FLG-TAKYO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "113014370"
                        MOVE   "1"    TO    RECE04-FLG-TAKYOKSN-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)  =     "113013910"
                                      OR    "113014010"
                                      OR    "113014110"
                        MOVE   "1"    TO    RECE04-FLG-GAIRIHA-COMMENT
                END-IF
              END-IF
      *       人工内耳機器調整加算
              IF   SRY-SRYCD(IDX2)   =  "113030670"
                   MOVE   "1"   TO    RECE04-FLG-JINNAI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)   =  "113030770"
                   MOVE   "2"   TO    RECE04-FLG-JINNAI-COMMENT
              END-IF
      *       外来排尿自立指導料
              IF  (SRY-SRYCD(IDX2)   =  "113032810"        )
              AND (FLG-GAIJIR-COM    =  ZERO               )
                   MOVE   "1"   TO    RECE04-FLG-GAIJIR-COMMENT
                   PERFORM  VARYING  IDX40  FROM  1  BY  1
                             UNTIL   IDX40    >  31
                     IF  ACCT-DAY(1 IDX40) NOT = ZERO
                       IF  RECE02-GAIJIRYMD  =  SPACE
                         MOVE  RECE02-SRYYM  TO  RECE02-GAIJIRYMD(1:6)
                         MOVE  IDX40         TO  RECE02-GAIJIRYMD(7:2)
                       ELSE
                         MOVE  RECE02-GAIJIRYMD(7:2)  TO  IDX41
                         IF    IDX40  <  IDX41
                           MOVE  IDX40       TO  RECE02-GAIJIRYMD(7:2)
                         END-IF
                       END-IF
                       MOVE    31    TO   IDX40
                     END-IF
                   END-PERFORM
              END-IF
              IF   SRY-SRYCD(IDX2)   =  "840000097"
                                     OR "840000086"
                   MOVE  SPACE  TO    RECE04-FLG-GAIJIR-COMMENT
                   MOVE    1    TO    FLG-GAIJIR-COM
              END-IF
      *       心臓ペースメーカー指導管理料（着用型自動除細動器）
      *       心臓ペースメーカー指導管理料（ロ・植込型除細動器移行期加算含む）
      *       がん患者指導管理料２・３
              IF   RECE02-SRYYM    >=     "201404"
                IF  (SRY-SRYCD(IDX2) =  "113015010"           )
                AND (RECE02-SRYYM   <=  "201803"              )
                   MOVE   "1"   TO    RECE04-FLG-SINPESUR-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2) =  "113015130"
                   MOVE   "2"   TO    RECE04-FLG-SINPESUR-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2) =  "113015310"
                   MOVE   "1"   TO    RECE04-FLG-GANSIDO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2) =  "113015410"
                   MOVE   "2"   TO    RECE04-FLG-GANSIDO-COMMENT
                END-IF
              END-IF
              IF  (RECE02-SRYYM    >=     "201604")
              AND (RECE02-SRYYM    <=     "202003")
                IF   SRY-SRYCD(IDX2) =  "113001610"
                   MOVE   "3"   TO    RECE04-FLG-SINPESUR-COMMENT
                END-IF
              END-IF
              IF   RECE02-SRYYM    >=     "202004"
                IF   SRY-SRYCD(IDX2) =  "113030210"
                   MOVE   "4"   TO    RECE04-FLG-SINPESUR-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2) =  "113030310"
                   MOVE   "5"   TO    RECE04-FLG-SINPESUR-COMMENT
                END-IF
              END-IF
      *       乳腺炎重症化予防ケア・指導料（初回）
      *       乳腺炎重症化予防ケア・指導料（２回目から４回目まで）
              IF   SRY-SRYCD(IDX2)    =     "113024410"
              AND  FLG-NYUSEN-COM     =     ZERO
                   MOVE   "1"   TO    RECE04-FLG-NYUSEN-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "113024510"
              AND  FLG-NYUSEN-COM     =     ZERO
                   MOVE   "2"   TO    RECE04-FLG-NYUSEN-COMMENT
                   MOVE   "1"   TO    RECE02-NYUSENFLG
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000086"
                   MOVE  SPACE  TO    RECE04-FLG-NYUSEN-COMMENT
                   MOVE    1    TO    FLG-NYUSEN-COM
              END-IF
      *
      *       オンライン医学管理料
              IF   SRY-SRYCD(IDX2)    =     "113023890"
                 MOVE   "2"        TO   RECE04-FLG-ONLINE-COMMENT
              END-IF
           END-IF
      *
           IF      RECE04-SRYKBN      =     "14"
              IF   SRY-SRYCD(IDX2)    =     "114008010"
              AND  FLG-HOUSIJI-COM    =     ZERO
                   MOVE   "1"   TO    RECE04-FLG-HOUSIJI-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000073"
                   MOVE  SPACE  TO    RECE04-FLG-HOUSIJI-COMMENT
                   MOVE    1    TO    FLG-HOUSIJI-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =     "114009410"
                   MOVE   "1"   TO    RECE04-FLG-HINKAI-COMMENT
              END-IF
      *
              IF  (SRY-SRYCD(IDX2)    =     "114000110"
                                      OR    "114001610"       )
              AND (FLG-OSIN-COM       =     ZERO              )
                   MOVE   "1"   TO    RECE04-FLG-OSIN-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000039"
                   MOVE  SPACE  TO    RECE04-FLG-OSIN-COMMENT
                   MOVE    1    TO    FLG-OSIN-COM
              END-IF
      *
              IF   SRY-SRYCD(IDX2)    =  "114012210" OR "114012310"
                                      OR "114012410" OR "114007510"
                                      OR "114013010" OR "114013110"
                                      OR "114013210" OR "114013310"
                                      OR "114018710" OR "114018810"
                                      OR "114018910" OR "114019010"
                                      OR "114019110" OR "114019210"
                                      OR "114019310" OR "114019410"
                                      OR "114023110" OR "114023210"
                                      OR "114023310" OR "114023410"
                                      OR "114023510" OR "114023610"
                                      OR "114023710" OR "114023810"
                                      OR "114023910" OR "114024010"
                                      OR "114024110" OR "114024210"
                                      OR "114024310" OR "114024410"
                                      OR "114024510" OR "114024610"
                                      OR "114024910" OR "114025010"
                                      OR "114025110" OR "114025210"
                                      OR "114025310" OR "114025410"
                                      OR "114025510" OR "114025610"
                                      OR "114025710" OR "114025810"
                                      OR "114025910" OR "114026010"
                                      OR "114026110" OR "114026210"
                                      OR "114026310" OR "114026410"
                                      OR "114030710" OR "114030810"
                                      OR "114030910" OR "114031010"
                                      OR "114031110" OR "114031210"
                                      OR "114031310" OR "114031410"
                                      OR "114031510" OR "114031610"
                                      OR "114031710" OR "114031810"
                                      OR "114031910" OR "114032010"
                                      OR "114032110" OR "114032210"
                                      OR "114032310" OR "114032410"
                                      OR "114032510" OR "114032610"
                                      OR "114032710" OR "114032810"
                                      OR "114032910" OR "114033010"
                                      OR "114033110" OR "114033210"
                                      OR "114033310" OR "114033410"
                                      OR "114033510" OR "114033610"
                                      OR "114033710" OR "114033810"
                                      OR "114033910" OR "114034010"
                                      OR "114034110" OR "114034210"
      *
                                      OR "114035510" OR "114035610"
                                      OR "114035710" OR "114035810"
                                      OR "114035910" OR "114036010"
                                      OR "114036110" OR "114036210"
                                      OR "114036310" OR "114036410"
                                      OR "114036510" OR "114036610"
                                      OR "114036710" OR "114036810"
                                      OR "114036910" OR "114037010"
                                      OR "114037110" OR "114037210"
                                      OR "114037310" OR "114037410"
                                      OR "114037510" OR "114037610"
                                      OR "114037710" OR "114037810"
                                      OR "114037910" OR "114038010"
                                      OR "114038110" OR "114038210"
                                      OR "114038310" OR "114038410"
                                      OR "114038510" OR "114038610"
                                      OR "114038710" OR "114038810"
                                      OR "114038910" OR "114039010"
      *
                                      OR "114001110" OR "114012910"
                                      OR "114018010" OR "114030310"
                                      OR "114042110" OR "114042210"
                                      OR "114042810" OR "114046310"
                   MOVE   "1"   TO    RECE02-COMCNTFLG
                   MOVE   "2"   TO    RECE04-FLG-OSIN-COMMENT
              END-IF
      *
              IF   (SRY-SRYCD(IDX2)   =     "114001110"
                                      OR    "114012910"
                                      OR    "114018010"
                                      OR    "114030310"
                                      OR    "114042110"
                                      OR    "114042210"
                                      OR    "114042810"
                                      OR    "114046310"         )
              AND  (FLG-ZAIHOU-COM    =     ZERO                )
                   MOVE   "1"   TO    RECE04-FLG-ZAIHOU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000066"
                   MOVE  SPACE  TO    RECE04-FLG-ZAIHOU-COMMENT
                   MOVE    1    TO    FLG-ZAIHOU-COM
              END-IF
      *
              IF   RECE02-SRYYM    >=     "201204"
                IF   SRY-SRYCD(IDX2) =  "114000110"
                                    OR  "114001610"
                   IF    (WRK-SISETU3168  =  1)
                   OR    (WRK-SISETU3055  =  1)
                   OR    (WRK-SISETU3056  =  1)
                       MOVE   "1"   TO    RECE02-COMCNTFLG
                       MOVE   "1"   TO    RECE04-FLG-ZAISIEN-COMMENT
                   END-IF
                   IF  RECE04-FLG-ZAISIEN-COMMENT = SPACE
                     IF  (WRK-SISETU3169  =  1)
                     OR  (WRK-SISETU3057  =  1)
                     OR  (WRK-SISETU3058  =  1)
                       MOVE   "1"   TO    RECE02-COMCNTFLG
                       MOVE   "2"   TO    RECE04-FLG-ZAISIEN-COMMENT
                     END-IF
                   END-IF
                END-IF
              ELSE
                IF   WRK-SISETU613   =  1
                  IF   RECE02-SRYYM   >=  "200604"
                  AND  RECE02-SRYYM   <=  "200803"
                      IF SRY-SRYCD(IDX2) =  "114001110"         OR
                                            "114011570"         OR
                                            "114011670"         OR
                                            "114011770"
                        MOVE   "1"   TO    RECE02-COMCNTFLG
                        MOVE   "1"   TO    RECE04-FLG-ZAISIEN-COMMENT
                      END-IF
                  END-IF
                  IF   RECE02-SRYYM   >=  "200804"
                      IF SRY-SRYCD(IDX2) =  "114011570"         OR
                                            "114011670"         OR
                                            "114011770"
                        MOVE   "1"   TO    RECE02-COMCNTFLG
                        MOVE   "1"   TO    RECE04-FLG-ZAISIEN-COMMENT
                      END-IF
                  END-IF
                ELSE
                  IF   WRK-SISETU695   =  1
                    IF   RECE02-SRYYM   >=  "200804"
                      IF SRY-SRYCD(IDX2) =  "114011570"         OR
                                            "114011670"         OR
                                            "114011770"
                        MOVE   "1"   TO    RECE02-COMCNTFLG
                        MOVE   "2"   TO    RECE04-FLG-ZAISIEN-COMMENT
                      END-IF
                    END-IF
                  END-IF
                END-IF
              END-IF
      *
              IF   RECE02-SRYYM    >=     "201204"
                IF   SRY-SRYCD(IDX2) =  "114020910"
                   MOVE   "1"   TO    RECE04-FLG-KAISYOKU-COMMENT
                END-IF
      ***       IF   SRY-SRYCD(IDX2) =  "114009710"
      ***          MOVE   "1"   TO    RECE04-FLG-YOUATU-COMMENT
      ***       END-IF
              END-IF
      *       在宅患者共同診療料
              IF   RECE02-SRYYM    >=     "201404"
                IF  (SRY-SRYCD(IDX2)    =     "114027610"
                                        OR    "114027710"
                                        OR    "114027810"
                                        OR    "114027910"         )
                AND (FLG-ZAIKYO-COM     =     ZERO                )
                   MOVE   "1"   TO    RECE04-FLG-ZAIKYO-COMMENT
                END-IF
                IF   SRY-SRYCD(IDX2)    =     "840000097"
                                        OR    "840000086"
                   MOVE  SPACE  TO    RECE04-FLG-ZAIKYO-COMMENT
                   MOVE    1    TO    FLG-ZAIKYO-COM
                END-IF
              END-IF
      *       在宅患者訪問リハビリテーション指導管理料
              IF   RECE02-SRYYM    >=     "201611"
                IF  (SRY-SRYCD(IDX2)    =     "114006410"
                                        OR    "114015010"          )
                AND (FLG-ZAIRIHA-COM    =     ZERO                 )
                   MOVE   "1"   TO    RECE04-FLG-ZAIRIHA-COMMENT
                END-IF
              END-IF
      *       在宅患者訪問薬剤管理指導料
              IF   SRY-SRYCD(IDX2)    =     "114044710"
                                      OR    "114044810"
                                      OR    "114044910"
                   MOVE   "1"   TO    RECE04-FLG-ZAIYAK-COMMENT
              END-IF
      *       遠隔モニタリング加算（在宅酸素療法指導管理料（その他））
      *       遠隔モニタリング加算（在宅持続陽圧呼吸療法指導管理料２）
              IF   SRY-SRYCD(IDX2)    =     "114045470"
                   MOVE   "A"   TO    RECE04-FLG-SINPESU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "114045670"
                   MOVE   "B"   TO    RECE04-FLG-SINPESU-COMMENT
              END-IF
      *       在宅酸素療法指導管理料（その他）
      *       在宅持続陽圧呼吸療法指導管理料２
              IF   SRY-SRYCD(IDX2)    =     "114003710"
                   MOVE   "A"   TO    RECE04-FLG-SINPESUR-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "114040810"
                   MOVE   "B"   TO    RECE04-FLG-SINPESUR-COMMENT
              END-IF
      *       在宅半固形栄養経管栄養法指導管理料
              IF  (SRY-SRYCD(IDX2)    =     "114045510"          )
              AND (FLG-NINRYO-COM     =     ZERO                 )
                   MOVE   "9"   TO    RECE04-FLG-NINRYO-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000097"
                   MOVE  SPACE  TO    RECE04-FLG-NINRYO-COMMENT
                   MOVE    1    TO    FLG-NINRYO-COM
              END-IF
      *
      *       オンライン在宅管理料（在医総管（月１回訪問診療））
              IF   SRY-SRYCD(IDX2)    =     "114043970"
                 MOVE   "3"        TO   RECE04-FLG-ONLINE-COMMENT
              END-IF
           END-IF
      *
           IF      RECE04-SRYKBN      =     "33"
              IF   SRY-SRYSYUKBN      =     "334"
              AND  FLG-HOUTEN-COM     =     ZERO
                   MOVE   "1"   TO    RECE04-FLG-HOUTEN-COMMENT
              END-IF
           END-IF
      *
           IF      RECE04-SRYKBN      =     "50"
              IF   RECE04-SYUTEN1     =     ZERO
                   MOVE   "1"   TO    RECE04-FLG-SHUJUTU-COMMENT
              END-IF
              IF   SRY-SRYSYUKBN      =     "510"
                   MOVE   "1"   TO    RECE04-FLG-SHUJUTU-COMMENT
              END-IF
              IF   SRY-SRYCD(IDX2)    =     "840000042"
                   MOVE   "1"   TO    RECE04-FLG-SHUJUTU-COMMENT
              END-IF
           END-IF
      *
           IF   RECE02-SRYYM      >=    "201004"
            IF     RECE04-SRYKBN      =     "54"
              IF   RECE04-SYUTEN1     =     ZERO
                   MOVE   "1"   TO    RECE04-FLG-MASUI-COMMENT
              END-IF
            END-IF
           END-IF
      *
           IF      RECE04-SRYKBN      =     "70"
              IF  (SRY-SRYCD(IDX2)    =  "170011710" OR "170011810"
                                      OR "170011910" OR "170012110"
                                      OR "170015550" OR "170015210"
                                      OR "170020110" OR "170022110"
                                      OR "170022290" OR "170022390"
                                      OR "170022490" OR "170023010"
                                      OR "170023110" OR "170023210"
                                      OR "170023310" OR "170023410"
                                      OR "170023510"               )
              AND (RECE02-SRYYM       <     "201004"               )
                   MOVE   "1"   TO    RECE04-FLG-CTMRI-COMMENT
              END-IF
              IF  (SRY-SRYCD(IDX2)    =  "170011710" OR "170011810"
                                      OR "170012110" OR "170015210"
                                      OR "170020110" OR "170028610"
                                      OR "170033410" OR "170033510"
                                      OR "170034910" OR "170035010")
              AND (RECE02-SRYYM       >=    "201004"               )
              AND (RECE02-SRYYM       <=    "202003"               )
                   MOVE   "1"   TO    RECE04-FLG-CTMRI-COMMENT
              END-IF
      *
              IF    SRY-SRYCD(IDX2)  =
                    "700010000" OR "700030000" OR "700050000" OR
                    "700080000" OR "700110000" OR "700140000" OR
                    "700290000" OR "700310000" OR "700330000" OR
                    "700710000" OR "700730000" OR "700750000" OR
                    "700780000" OR "700810000" OR "700840000" OR
                    "700870000" OR "700160000" OR "700180000" OR
                    "700190000" OR "700200000" OR "700210000" OR
                    "700220000" OR "700230000" OR "700240000" OR
                    "700250000" OR "700260000" OR "700270000" OR
                    "700280000" OR "700590000" OR "700600000" OR
                    "700630000" OR "700640000" OR "700650000" OR
                    "700680000" OR "729780000"
                IF    SRY-SRYKAISU(IDX2)  >   1
                   MOVE   "1"   TO    RECE04-FLG-FILM-COMMENT
                END-IF
              END-IF
           END-IF
      *
           IF      RECE04-SRYKBN      =     "60" OR "64"
              IF   (SRY-SRYCD(IDX2)   =     "160162350"
                                      OR    "160181250"
                                      OR    "160116310"        )
              AND  (FLG-KENSA-COM     =     ZERO               )
                   MOVE   "1"   TO    RECE04-FLG-KENSA-COMMENT
              END-IF
              IF    SRY-SRYCD(IDX2)   =     "160162350"
                   MOVE    1    TO    RECE02-KENSA-BNPFLG
              END-IF
              IF    SRY-SRYCD(IDX2)   =     "160181250"
                   MOVE    1    TO    RECE02-KENSA-NTPROFLG
              END-IF
              IF    SRY-SRYCD(IDX2)   =     "160116310"
                   MOVE    1    TO    RECE02-KENSA-ANPFLG
              END-IF
           END-IF
      *
           IF      RECE04-SRYKBN   =  "14" OR "40" OR "50" OR "54"
                                   OR "60" OR "70" OR "80" OR "64"
              SET     TBL-SANSO    TO      1
              SEARCH      TBL-SANSO-OCC   VARYING   TBL-SANSO
                   AT  END
                       MOVE    ZERO            TO  FLG-SANSO-OK
                   WHEN    SRY-SRYCD (IDX2)    =   TBL-SANSO-SRYCD
                                                        (TBL-SANSO)
                       MOVE    1               TO  FLG-SANSO-OK
              END-SEARCH
              IF      FLG-SANSO-OK        =    1
                   MOVE   "1"   TO    RECE04-FLG-SANSO-COMMENT
              END-IF
           END-IF
      *
           .
       2104411-RECE05-COMCNT-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    酸素の単価編集処理
      *****************************************************************
       2104412-RECE05-TANKA-HEN-SEC     SECTION.
      *
           MOVE    SPACE           TO  WRK-TANKA-X
      * 
      *    数字表示用編集（半角）
           MOVE    RECE05-TEN(IDX4)
                                   TO  WRK-TANKA
           MOVE    WRK-TANKA-S1    TO  WRK-TANKA-Z1
           MOVE    ZERO            TO  FLG-SP
           PERFORM   VARYING   IDY   FROM    2   BY  -1
                     UNTIL     IDY           =   ZERO
             IF  WRK-TANKA-S2(IDY:1) NOT =   ZERO
                 MOVE    1               TO  FLG-SP
             END-IF
             IF  FLG-SP                  =   1
                 MOVE    WRK-TANKA-S2(IDY:1)
                                         TO  WRK-TANKA-Z3(IDY:1)
             END-IF
           END-PERFORM
           IF  WRK-TANKA-Z3          NOT =   SPACE
               MOVE    "."               TO  WRK-TANKA-Z2
           END-IF
      *        
           INITIALIZE                      WRK-CHAR-HENKAN-AREA
           MOVE    WRK-TANKA-X         TO  WRK-CHAR-X
           MOVE    12                  TO  WRK-CHAR-CNT
           MOVE    1                   TO  WRK-CHAR-IDX
           MOVE    ZERO                TO  WRK-CHAR-N-CNT
      *     
           PERFORM VARYING     IDW     FROM    1   BY  1
                   UNTIL       IDW     >   WRK-CHAR-CNT
               IF      WRK-CHAR-X (IDW:1)  =   SPACE
                   CONTINUE
               ELSE        
                   IF    WRK-CHAR-X (IDW:1)  IS  NUMERIC
                       IF      WRK-CHAR-X (IDW:1)  =   "0"
                           MOVE    TBL-SUJI (10)
                                       TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       ELSE
                           MOVE    WRK-CHAR-X (IDW:1)  TO  NUM-IDX
                           MOVE    TBL-SUJI (NUM-IDX)
                                       TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       END-IF                    
                   ELSE
                       IF    WRK-CHAR-X (IDW:1)  =   "."
                           MOVE    "．"   TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       ELSE    
                           MOVE    "  "   TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       END-IF
                   END-IF    
                   ADD     2           TO  WRK-CHAR-IDX
                                           WRK-CHAR-N-CNT
               END-IF    
           END-PERFORM
      *
           IF      WRK-CHAR-N-CNT      >   ZERO
                   MOVE    "円"        TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                   ADD     2           TO  WRK-CHAR-N-CNT
           END-IF                             
      *
           .
       2104412-RECE05-TANKA-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    残量廃棄の数量編集処理
      *****************************************************************
       2104413-RECE05-SURYO-HEN-SEC     SECTION.
      *
           MOVE    SPACE           TO  WRK-SURYO-X
           MOVE    ZERO            TO  WRK-SURYOST
           MOVE    ZERO            TO  WRK-SURYOKETA
           MOVE    ZERO            TO  WRK-SURYOKETA1
           MOVE    ZERO            TO  WRK-SURYOKETA2
           MOVE    SPACE           TO  WRK-SURYO-N
           MOVE    SPACE           TO  WRK-SRYSURYOW
      *
      *    数字表示用編集（半角）
      ***  MOVE    RECE05-SRYSURYO(IDX4)  TO  WRK-SURYO
           MOVE    WRK-SRYSURYO           TO  WRK-SURYO
           MOVE    WRK-SURYO-S1           TO  WRK-SURYO-Z1
      *
           MOVE    ZERO            TO  FLG-SP
           PERFORM   VARYING   IDW   FROM    5   BY  -1
                      UNTIL    IDW   =   ZERO
             IF  WRK-SURYO-S2(IDW:1) NOT =   ZERO
                 MOVE    1         TO  FLG-SP
             END-IF
             IF  FLG-SP  =   1
                 MOVE    WRK-SURYO-S2(IDW:1)
                                   TO  WRK-SURYO-Z3(IDW:1)
             END-IF
           END-PERFORM
           IF  WRK-SURYO-Z3   NOT =  SPACE
               MOVE    "."         TO  WRK-SURYO-Z2
           END-IF
      *    表示文字数カウント
           PERFORM   VARYING   IDW   FROM    1   BY  1
                      UNTIL    IDW     >    11
             IF  WRK-SURYO-X(IDW:1)  NOT =  SPACE
                 IF  WRK-SURYOST           =   ZERO
                     MOVE    IDW   TO  WRK-SURYOST
                 END-IF
      *          数量桁数カウント(６桁目：ピリオド)
                 ADD     1         TO  WRK-SURYOKETA
                 IF  IDW    <   6
                     ADD     1     TO  WRK-SURYOKETA1
                 END-IF
                 IF  IDW    >   6
                     ADD     1     TO  WRK-SURYOKETA2
                 END-IF
             END-IF
           END-PERFORM
           IF  WRK-SURYOST  =   6
               MOVE   "0"          TO  WRK-SURYO-Z1(5:1)
               MOVE    5           TO  WRK-SURYOST
               MOVE    1           TO  WRK-SURYOKETA1
               ADD     1           TO  WRK-SURYOKETA
           END-IF
      *    全角変換
           IF  WRK-SURYOKETA1   >   ZERO
               INITIALIZE              WRK-CHAR-HENKAN-AREA
               MOVE    WRK-SURYO-Z1(WRK-SURYOST:WRK-SURYOKETA1)
                                       TO  WRK-CHAR-X
               MOVE    WRK-SURYOKETA1  TO  WRK-CHAR-CNT
      *
               MOVE    1               TO  WRK-CHAR-IDX
               PERFORM  VARYING  IDW   FROM    1   BY  1
                         UNTIL   IDW     >   WRK-CHAR-CNT
                   IF    WRK-CHAR-X(IDW:1)  IS  NUMERIC
                     IF    WRK-CHAR-X(IDW:1)  =   "0"
                        MOVE  TBL-SUJI(10)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     ELSE
                        MOVE  WRK-CHAR-X(IDW:1)  TO  NUM-IDX
                        MOVE  TBL-SUJI(NUM-IDX)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     END-IF
                   ELSE
                       MOVE    "  "    TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                   END-IF
                   ADD     2           TO  WRK-CHAR-IDX
               END-PERFORM
      *
               MOVE    WRK-CHAR-N      TO  WRK-SURYO-N1
           END-IF
           IF  WRK-SURYOKETA2   >   ZERO
               MOVE    "．"            TO  WRK-SURYO-N2
      *
               INITIALIZE              WRK-CHAR-HENKAN-AREA
               MOVE    WRK-SURYO-Z3(1:WRK-SURYOKETA2)
                                       TO  WRK-CHAR-X
               MOVE    WRK-SURYOKETA2  TO  WRK-CHAR-CNT
      *
               MOVE    1               TO  WRK-CHAR-IDX
               PERFORM  VARYING  IDW   FROM    1   BY  1
                         UNTIL   IDW     >   WRK-CHAR-CNT
                   IF    WRK-CHAR-X(IDW:1)  IS  NUMERIC
                     IF    WRK-CHAR-X(IDW:1)  =   "0"
                        MOVE  TBL-SUJI(10)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     ELSE
                        MOVE  WRK-CHAR-X(IDW:1)  TO  NUM-IDX
                        MOVE  TBL-SUJI(NUM-IDX)
                                       TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                     END-IF
                   ELSE
                       MOVE    "  "    TO  WRK-CHAR-N(WRK-CHAR-IDX:)
                   END-IF
                   ADD     2           TO  WRK-CHAR-IDX
               END-PERFORM
      *
               MOVE    WRK-CHAR-N      TO  WRK-SURYO-N3
           END-IF
      *
           STRING      WRK-SURYO-N1    DELIMITED   BY  " "
                       WRK-SURYO-N2    DELIMITED   BY  " "
                       WRK-SURYO-N3    DELIMITED   BY  " "
                       INTO            WRK-SRYSURYOW
           END-STRING
      *
           .
       2104413-RECE05-SURYO-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    関係コメント編集
      *****************************************************************
       2104414-SETCOM-HENSYU-SEC     SECTION.
      *
           IF   RECE05-MEISKYFLG(IDX4)  =  "2"
              IF   (FLG-SETCOM              =  1   )
              AND  (RECE05-RECEDENFLG(IDX4) = SPACE)
                 MOVE  "1"            TO  RECE04-SETCOMFLG
              ELSE
                 MOVE  SPACE          TO  RECE05-MEISKYFLG(IDX4)
              END-IF
           ELSE
              IF   (RECE05-SRYCD(IDX4)(1:1) = "1" OR "6" OR "7")
              OR   (RECE05-SRYCD(IDX4)(1:3) = "059"            )
                IF  RECE05-SRYCD(IDX4)(1:2) = "63"
                 CONTINUE
                ELSE
                 MOVE   1             TO  FLG-SETCOM
                END-IF
              END-IF
           END-IF
      *
      *****
      *
      *    特定薬剤治療管理料
           IF    RECE05-SRYCD(IDX4)   = "113000410" OR "113000510" OR
                                        "180000110" OR "180000210" OR
                                        "113023910"
                 MOVE   1             TO  WRK-SETCOM-JIDO
           END-IF
      *    悪性腫瘍特異物質治療管理料
           IF    RECE05-SRYCD(IDX4)   = "113001210" OR "113001310" OR
                                        "113002110"
                 MOVE   3             TO  WRK-SETCOM-JIDO
           END-IF
      *    初診（同日複数診療科）
           IF    RECE05-SRYCD(IDX4)   = "111011810"
                                     OR "111012610"
                                     OR "111012810"
                 MOVE   4             TO  WRK-SETCOM-JIDO
           END-IF
      *    傷病手当金意見書交付料
           IF    RECE05-SRYCD(IDX4)   = "180000710"
                 MOVE   6             TO  WRK-SETCOM-JIDO
           END-IF
      *    療養費同意書交付料
           IF    RECE05-SRYCD(IDX4)   = "113004310"
                 MOVE   7             TO  WRK-SETCOM-JIDO
           END-IF
      *    ニコチン依存症管理料（初回）
      *    ニコチン依存症管理料（２回目から４回目まで）
      *    ニコチン依存症管理料（５回目）
           IF    RECE05-SRYCD(IDX4)   = "113008310" OR "113008410"
                                     OR "113008510" OR "113031610"
                 MOVE   8             TO  WRK-SETCOM-JIDO
           END-IF
      *    重度喘息患者治療管理加算（１月目）
      *    重度喘息患者治療管理加算（２月目以降６月目まで）
           IF    RECE05-SRYCD(IDX4)   = "113008070"
                                     OR "113008170"
                 MOVE   9             TO  WRK-SETCOM-JIDO
           END-IF
      *    小児特定疾患カウンセリング料（１回目）
      *    小児特定疾患カウンセリング料（２回目）
           IF    RECE05-SRYCD(IDX4)   = "113000810"
                                     OR "113009910" OR "113029410"
                 MOVE   10            TO  WRK-SETCOM-JIDO
           END-IF
      *    訪問看護指示料
           IF    RECE05-SRYCD(IDX4)   = "114008010"
                 MOVE   11            TO  WRK-SETCOM-JIDO
           END-IF
      *    往診
      *    特別往診
           IF    RECE05-SRYCD(IDX4)   = "114000110"
                                     OR "114001610"
                 MOVE   13            TO  WRK-SETCOM-JIDO
           END-IF
      *    在宅患者訪問診療料
      *    在宅患者訪問診療料（居住系）
      *    在宅患者訪問診療料（同一建物居住者）（特定施設等入居者）
           IF    RECE05-SRYCD(IDX4)   = "114001110"
                                     OR "114012910"
                                     OR "114018010"
                                     OR "114030310"
                                     OR "114042110"
                                     OR "114042210"
                                     OR "114042810"
                                     OR "114046310"
                 MOVE   14            TO  WRK-SETCOM-JIDO
           END-IF
      *    認知療法・認知行動療法
      *    精神科重症患者早期集中支援管理料
      *    精神科在宅患者支援管理料
      *    在宅半固形栄養経管栄養法指導管理料
           IF    RECE05-SRYCD(IDX4)   = "180033210"
                                     OR "180035910"
                                     OR "188006210"
                                     OR "188007010"
                                     OR "180047810"
                                     OR "188010610"
                                     OR "180056410"
                                     OR "180042110"
                                     OR "180042410"
                                     OR "180048710"
                                     OR "180048810"
                                     OR "180057210"
                                     OR "180057310"
                                     OR "180057810"
                                     OR "180057910"
                                     OR "114045510"
                 MOVE   19            TO  WRK-SETCOM-JIDO
           END-IF
           IF   (RECE05-SRYCD(IDX4)   = "180057410" OR "180057510"
                                     OR "180057610" OR "180057710"
                                     OR "180058010" OR "180058110"
                                     OR "180064010" OR "180064110")
           AND  (RECE02-SRYYM        >= "202004"                  )
                 MOVE   19            TO  WRK-SETCOM-JIDO
           END-IF
      *    再診（同一日２科目）
           IF    RECE05-SRYCD(IDX4)   = "112015810"
                                     OR "112017010"
                                     OR "112015950"
                                     OR "112017150"
                                     OR "112023550"
                                     OR "112023850"
                                     OR "112016210"
                                     OR "112016410"
                                     OR "112017610"
                 MOVE   25            TO  WRK-SETCOM-JIDO
           END-IF
      *    在宅患者共同診療料
           IF    RECE05-SRYCD(IDX4)   = "114027610"
                                     OR "114027710"
                                     OR "114027810"
                                     OR "114027910"
                 MOVE   29            TO  WRK-SETCOM-JIDO
           END-IF
      *    依存症集団療法
           IF    RECE05-SRYCD(IDX4)   = "180047910" OR "188010710"
                                     OR "180058710" OR "188011810"
                 MOVE   33            TO  WRK-SETCOM-JIDO
           END-IF
      *    高気圧酸素治療
           IF    RECE05-SRYCD(IDX4)   = "140057510"
                                     OR "140057610"
                 MOVE   35            TO  WRK-SETCOM-JIDO
           END-IF
      *    乳腺炎重症化予防ケア・指導料（初回）
      *    乳腺炎重症化予防ケア・指導料（２回目から４回目まで）
           IF    RECE05-SRYCD(IDX4)   = "113024510"
                                     OR "113024410"
                 MOVE   37            TO  WRK-SETCOM-JIDO
           END-IF
      *    オンライン診療料
           IF    RECE05-SRYCD(IDX4)   = "112023210"
                 MOVE   38            TO  WRK-SETCOM-JIDO
           END-IF
      *    時間外緊急院内検査加算
           IF   (RECE05-SRYCD(IDX4)   = "160000210")
           AND  (RECE02-SRYYM        >= "201810"   )
                 MOVE   43            TO  WRK-SETCOM-JIDO
           END-IF
      *    時間外緊急院内画像診断加算
           IF   (RECE05-SRYCD(IDX4)   = "170016010")
           AND  (RECE02-SRYYM        >= "201810"   )
                 MOVE   44            TO  WRK-SETCOM-JIDO
           END-IF
      *    外来排尿自立指導料
           IF    RECE05-SRYCD(IDX4)   = "113032810"
                 MOVE   46            TO  WRK-SETCOM-JIDO
           END-IF
      *    経頭蓋磁気刺激療法
           IF   (RECE05-SRYCD(IDX4)   = "180058650")
           AND  (RECE02-SRYYM        >= "202004"   )
                 MOVE   47            TO  WRK-SETCOM-JIDO
           END-IF
      *
      *    特定薬剤治療管理加算（臓器移植月から３月）
           IF    RECE05-SRYCD(IDX4)   = "113000670" OR "113000770"
                                     OR "113029170" OR "113029270"
                                     OR "113029370"
                 MOVE   1             TO  WRK-SETCOM-JIDO2
           END-IF
      *    疾患別等専門プログラム加算
           IF    RECE05-SRYCD(IDX4)   = "180056570"
                                     OR "188011270"
                 MOVE   2             TO  WRK-SETCOM-JIDO2
           END-IF
      *
           IF  ((WRK-SETCOM-JIDO    =  1                        ) AND
                (RECE05-SRYCD(IDX4) = "830000014" OR "840000038"
                                                  OR "840000538"))
           OR  ((WRK-SETCOM-JIDO    =  3                        ) AND
                (RECE05-SRYCD(IDX4) = "830000015"               ))
           OR  ((WRK-SETCOM-JIDO    =  4                        ) AND
                (RECE05-SRYCD(IDX4) = "830000024"               ))
           OR  ((WRK-SETCOM-JIDO    =  6                        ) AND
                (RECE05-SRYCD(IDX4) = "840000011"
                                   OR "840000012"
                                   OR "840000511"
                                   OR "840000512"               ))
           OR  ((WRK-SETCOM-JIDO    =  7                        ) AND
                (RECE05-SRYCD(IDX4) = "840000078"
                                   OR "840000578"               ))
           OR  ((WRK-SETCOM-JIDO    =  8                        ) AND
                (RECE05-SRYCD(IDX4) = "840000097"               ))
           OR  ((WRK-SETCOM-JIDO    =  9                        ) AND
                (RECE05-SRYCD(IDX4) = "840000098"               ))
           OR  ((WRK-SETCOM-JIDO    =  10                       ) AND
                (RECE05-SRYCD(IDX4) = "840000104"
                                   OR "840000604"               ))
           OR  ((WRK-SETCOM-JIDO    =  11                       ) AND
                (RECE05-SRYCD(IDX4) = "840000073"               ))
           OR  ((WRK-SETCOM-JIDO    =  13                       ) AND
                (RECE05-SRYCD(IDX4) = "840000039"               ))
           OR  ((WRK-SETCOM-JIDO    =  14                       ) AND
                (RECE05-SRYCD(IDX4) = "840000066"               ))
           OR  ((WRK-SETCOM-JIDO    =  19                       ) AND
                (RECE05-SRYCD(IDX4) = "840000097"               ))
           OR  ((WRK-SETCOM-JIDO    =  25                       ) AND
                (RECE05-SRYCD(IDX4) = "830000051"               ))
           OR  ((WRK-SETCOM-JIDO    =  29                       ) AND
                (RECE05-SRYCD(IDX4) = "840000097"
                                   OR "840000086"               ))
           OR  ((WRK-SETCOM-JIDO    =  33                       ) AND
                (RECE05-SRYCD(IDX4) = "840000076"               ))
           OR  ((WRK-SETCOM-JIDO    =  35                       ) AND
                (RECE05-SRYCD(IDX4) = "840000085"
                                   OR "840000086"
                                   OR "840000045"               ))
           OR  ((WRK-SETCOM-JIDO    =  37                       ) AND
                (RECE05-SRYCD(IDX4) = "840000086"               ))
           OR  ((WRK-SETCOM-JIDO    =  38                       ) AND
                (RECE05-SRYCD(IDX4) = "820100006"
                                   OR "820100007"
                                   OR "820100008"
                                   OR "820100009"
                                   OR "820100010"
                                   OR "820100011"
                                   OR "820100012"
                                   OR "820100013"
                                   OR "820100014"
                                   OR "820100015"               ))
           OR  ((WRK-SETCOM-JIDO    =  43                       ) AND
                (RECE05-SRYCD(IDX4) = "840000044"               ))
           OR  ((WRK-SETCOM-JIDO    =  44                       ) AND
                (RECE05-SRYCD(IDX4) = "840000071"               ))
           OR  ((WRK-SETCOM-JIDO    =  46                       ) AND
                (RECE05-SRYCD(IDX4) = "840000097"
                                   OR "840000086"               ))
           OR  ((WRK-SETCOM-JIDO    =  47                       ) AND
                (RECE05-SRYCD(IDX4) = "840000076"               ))
      *
           OR  ((WRK-SETCOM-JIDO2   =  1                        ) AND
                (RECE05-SRYCD(IDX4) = "840000077"               ))
           OR  ((WRK-SETCOM-JIDO2   =  2                        ) AND
                (RECE05-SRYCD(IDX4) = "840000076"               ))
      *
                 MOVE  "1"              TO  RECE04-SETCOMFLG
                 MOVE  "2"              TO  RECE05-MEISKYFLG(IDX4)
                 MOVE  WRK-SETCOM-JIDO  TO  RECE05-SETCOMATFLG(IDX4)
                 IF  (WRK-SETCOM-JIDO2   =  1         )
                 AND (RECE05-SRYCD(IDX4) = "840000077")
                   MOVE    2            TO  RECE05-SETCOMATFLG(IDX4)
                 END-IF
                 IF  (WRK-SETCOM-JIDO2   =  2                   )
                 AND (RECE05-SRYCD(IDX4) = "840000076"          )
                   MOVE    40           TO  RECE05-SETCOMATFLG(IDX4)
                 END-IF
      *
           END-IF
      *
           IF    RECE05-INGAIFLG(IDX4)  =   "1"
      *
                 MOVE  "1"              TO  RECE04-SETCOMFLG
      *
           END-IF
      *
           .
       2104414-SETCOM-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    【レセプト】保険欄ー一部負担金記載ありコメント編集
      *****************************************************************
       2104415-ICHIBUCOM-HENSYU-SEC     SECTION.
      *
           MOVE    SPACE                  TO  WRK-INPUTCOMENT
           MOVE    SPACE                  TO  WRK-INPUTCOMENT2
           MOVE    ZERO                   TO  WRK-INPUTCOMENT-KIN
           MOVE    SPACE                  TO  WRK-INPUTCOMENT-KIN2
      *
           IF    ((SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                  (SRY-SRYCD    (IDX2)(1:3)     =   "008"))
           AND   ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  )
      *
             MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
             MOVE    SRY-PTID             TO  PTCOM-PTID
             MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
             MOVE    SRY-SRYCD    (IDX2)  TO  PTCOM-SRYCD
             MOVE    SRY-INPUTNUM (IDX2)  TO  PTCOM-RENNUM
             PERFORM 950-PTCOM-READ-SEC
             MOVE    PTCOM-INPUTCOMENT    TO  WRK-INPUTCOMENT
      *
             IF  WRK-INPUTCOMENT(1:12)  =  "（再掲上）："
             OR  WRK-INPUTCOMENT(1:12)  =  "（再掲下）："
             OR  WRK-INPUTCOMENT(1:12)  =  "（再掲３）："
             OR  WRK-INPUTCOMENT(1:12)  =  "（再掲４）："
             OR  WRK-INPUTCOMENT(1:12)  =  "保険負担金："
               MOVE  WRK-INPUTCOMENT(13:14)
                                          TO  WRK-INPUTCOMENT2
               IF  WRK-INPUTCOMENT2 = "　　　　　　　" OR SPACE
                 CONTINUE
               ELSE
                 PERFORM VARYING IDW7 FROM  1  BY  2
                          UNTIL  IDW7   >  14
                   COMPUTE  IDW8 = (IDW7 + 1) / 2
                   EVALUATE  WRK-INPUTCOMENT2(IDW7:2)
                     WHEN     "０"
                        MOVE   "0"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "１"
                        MOVE   "1"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "２"
                        MOVE   "2"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "３"
                        MOVE   "3"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "４"
                        MOVE   "4"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "５"
                        MOVE   "5"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "６"
                        MOVE   "6"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "７"
                        MOVE   "7"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "８"
                        MOVE   "8"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "９"
                        MOVE   "9"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     OTHER
                        MOVE    14  TO  IDW7
                   END-EVALUATE
                 END-PERFORM
                 IF  WRK-INPUTCOMENT-KIN2-T NOT = SPACE
                   MOVE    8    TO   IDW8
                   PERFORM VARYING IDW7 FROM  7  BY -1
                            UNTIL  IDW7   <   1
                     IF  WRK-INPUTCOMENT-KIN2-T(IDW7:1) = SPACE
                        CONTINUE
                     ELSE
                        COMPUTE  IDW8 = IDW8 - 1
                        MOVE  WRK-INPUTCOMENT-KIN2-T(IDW7:1)
                                TO   WRK-INPUTCOMENT-KIN-T(IDW8:1)
                     END-IF
                   END-PERFORM
                   IF  WRK-INPUTCOMENT(1:12)  =  "（再掲上）："
                     MOVE  ZERO        TO  RECE02-SAIKEI-CHIKAN-KIN1
                     MOVE  WRK-INPUTCOMENT-KIN
                                       TO  RECE02-SAIKEI-CHIKAN-KIN1
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "（再掲下）："
                     MOVE  ZERO        TO  RECE02-SAIKEI-CHIKAN-KIN2
                     MOVE  WRK-INPUTCOMENT-KIN
                                       TO  RECE02-SAIKEI-CHIKAN-KIN2
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "（再掲３）："
                     MOVE  ZERO        TO  RECE02-SAIKEI-CHIKAN-KIN3
                     MOVE  WRK-INPUTCOMENT-KIN
                                       TO  RECE02-SAIKEI-CHIKAN-KIN3
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "（再掲４）："
                     MOVE  ZERO        TO  RECE02-SAIKEI-CHIKAN-KIN4
                     MOVE  WRK-INPUTCOMENT-KIN
                                       TO  RECE02-SAIKEI-CHIKAN-KIN4
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "保険負担金："
                     MOVE  ZERO        TO  RECE02-HKN-CHIKAN-KIN
                     MOVE  WRK-INPUTCOMENT-KIN
                                       TO  RECE02-HKN-CHIKAN-KIN
                   END-IF
                 END-IF
               END-IF
             END-IF
      *
           END-IF
      *
           .
       2104415-ICHIBUCOM-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    【レセプト】公費欄ー一部負担金金額置換コメント編集
      *****************************************************************
       2104415-ICHIBUCOM-HENSYU2-SEC     SECTION.
      *
           MOVE    SPACE                  TO  WRK-INPUTCOMENT
           MOVE    SPACE                  TO  WRK-INPUTCOMENT2
           MOVE    ZERO                   TO  WRK-INPUTCOMENT-KIN
           MOVE    SPACE                  TO  WRK-INPUTCOMENT-KIN2
      *
           IF    ((SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                  (SRY-SRYCD    (IDX2)(1:3)     =   "008"))
           AND   ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  )
      *
             MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
             MOVE    SRY-PTID             TO  PTCOM-PTID
             MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
             MOVE    SRY-SRYCD    (IDX2)  TO  PTCOM-SRYCD
             MOVE    SRY-INPUTNUM (IDX2)  TO  PTCOM-RENNUM
             PERFORM 950-PTCOM-READ-SEC
             MOVE    PTCOM-INPUTCOMENT    TO  WRK-INPUTCOMENT
      *
             IF  WRK-INPUTCOMENT(1:12)  =  "公１負担金："
             OR  WRK-INPUTCOMENT(1:12)  =  "公２負担金："
             OR  WRK-INPUTCOMENT(1:12)  =  "公３負担金："
             OR  WRK-INPUTCOMENT(1:12)  =  "公４負担金："
             OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公１負担金："
             OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公２負担金："
             OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公３負担金："
             OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公４負担金："
               IF  WRK-INPUTCOMENT(1:12)  =  "公１負担金："
               OR  WRK-INPUTCOMENT(1:12)  =  "公２負担金："
               OR  WRK-INPUTCOMENT(1:12)  =  "公３負担金："
               OR  WRK-INPUTCOMENT(1:12)  =  "公４負担金："
                 MOVE  WRK-INPUTCOMENT(13:14)
                                          TO  WRK-INPUTCOMENT2
               END-IF
               IF  WRK-INPUTCOMENT(1:22)  =  "公費請求書公１負担金："
               OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公２負担金："
               OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公３負担金："
               OR  WRK-INPUTCOMENT(1:22)  =  "公費請求書公４負担金："
                 MOVE  WRK-INPUTCOMENT(23:14)
                                          TO  WRK-INPUTCOMENT2
               END-IF
               IF  WRK-INPUTCOMENT2 = "　　　　　　　" OR SPACE
                 CONTINUE
               ELSE
                 PERFORM VARYING IDW7 FROM  1  BY  2
                          UNTIL  IDW7   >  14
                   COMPUTE  IDW8 = (IDW7 + 1) / 2
                   EVALUATE  WRK-INPUTCOMENT2(IDW7:2)
                     WHEN     "０"
                        MOVE   "0"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "１"
                        MOVE   "1"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "２"
                        MOVE   "2"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "３"
                        MOVE   "3"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "４"
                        MOVE   "4"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "５"
                        MOVE   "5"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "６"
                        MOVE   "6"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "７"
                        MOVE   "7"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "８"
                        MOVE   "8"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "９"
                        MOVE   "9"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     OTHER
                        MOVE    14  TO  IDW7
                   END-EVALUATE
                 END-PERFORM
                 IF  WRK-INPUTCOMENT-KIN2-T NOT = SPACE
                   MOVE    8    TO   IDW8
                   PERFORM VARYING IDW7 FROM  7  BY -1
                            UNTIL  IDW7   <   1
                     IF  WRK-INPUTCOMENT-KIN2-T(IDW7:1) = SPACE
                        CONTINUE
                     ELSE
                        COMPUTE  IDW8 = IDW8 - 1
                        MOVE  WRK-INPUTCOMENT-KIN2-T(IDW7:1)
                                TO   WRK-INPUTCOMENT-KIN-T(IDW8:1)
                     END-IF
                   END-PERFORM
                   IF  WRK-INPUTCOMENT(1:12)  =  "公１負担金："
                     MOVE  ZERO     TO  RECE02-KOH-CHIKAN-KIN1
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE02-KOH-CHIKAN-KIN1
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "公２負担金："
                     MOVE  ZERO     TO  RECE02-KOH-CHIKAN-KIN2
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE02-KOH-CHIKAN-KIN2
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "公３負担金："
                     MOVE  ZERO     TO  RECE02-KOH-CHIKAN-KIN3
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE02-KOH-CHIKAN-KIN3
                   END-IF
                   IF  WRK-INPUTCOMENT(1:12)  =  "公４負担金："
                     MOVE  ZERO     TO  RECE02-KOH-CHIKAN-KIN4
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE02-KOH-CHIKAN-KIN4
                   END-IF
                   IF  WRK-INPUTCOMENT(1:22) = "公費請求書公１負担金："
                     MOVE  ZERO     TO  RECE02-SEI-CHIKAN-KIN1
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE02-SEI-CHIKAN-KIN1
                   END-IF
                   IF  WRK-INPUTCOMENT(1:22) = "公費請求書公２負担金："
                     MOVE  ZERO     TO  RECE02-SEI-CHIKAN-KIN2
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE02-SEI-CHIKAN-KIN2
                   END-IF
                   IF  WRK-INPUTCOMENT(1:22) = "公費請求書公３負担金："
                     MOVE  ZERO     TO  RECE02-SEI-CHIKAN-KIN3
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE02-SEI-CHIKAN-KIN3
                   END-IF
                   IF  WRK-INPUTCOMENT(1:22) = "公費請求書公４負担金："
                     MOVE  ZERO     TO  RECE02-SEI-CHIKAN-KIN4
                     MOVE  WRK-INPUTCOMENT-KIN
                                    TO  RECE02-SEI-CHIKAN-KIN4
                   END-IF
                 END-IF
               END-IF
             END-IF
      *
           END-IF
      *
           .
       2104415-ICHIBUCOM-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    【レセプト】（第三者行為）一部負担金金額置換コメント編集
      *****************************************************************
       2104415-ICHIBUCOM-HENSYU3-SEC     SECTION.
      *
           MOVE    SPACE                  TO  WRK-INPUTCOMENT
           MOVE    SPACE                  TO  WRK-INPUTCOMENT2
           MOVE    ZERO                   TO  WRK-INPUTCOMENT-KIN
           MOVE    SPACE                  TO  WRK-INPUTCOMENT-KIN2
      *
           IF    ((SRY-SRYCD    (IDX2)(1:1)     =   "8"  )  OR
                  (SRY-SRYCD    (IDX2)(1:3)     =   "008"))
           AND   ( SRY-INPUTNUM (IDX2)      NOT =   ZERO  )
      *
             MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
             MOVE    SRY-PTID             TO  PTCOM-PTID
             MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
             MOVE    SRY-SRYCD    (IDX2)  TO  PTCOM-SRYCD
             MOVE    SRY-INPUTNUM (IDX2)  TO  PTCOM-RENNUM
             PERFORM 950-PTCOM-READ-SEC
             MOVE    PTCOM-INPUTCOMENT    TO  WRK-INPUTCOMENT
      *
             IF  WRK-INPUTCOMENT(1:12)  =  "一部負担額："
               MOVE  WRK-INPUTCOMENT(13:14)
                                          TO  WRK-INPUTCOMENT2
               IF  WRK-INPUTCOMENT2 = "　　　　　　　" OR SPACE
                 CONTINUE
               ELSE
                 PERFORM VARYING IDW7 FROM  1  BY  2
                          UNTIL  IDW7   >  14
                   COMPUTE  IDW8 = (IDW7 + 1) / 2
                   EVALUATE  WRK-INPUTCOMENT2(IDW7:2)
                     WHEN     "０"
                        MOVE   "0"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "１"
                        MOVE   "1"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "２"
                        MOVE   "2"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "３"
                        MOVE   "3"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "４"
                        MOVE   "4"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "５"
                        MOVE   "5"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "６"
                        MOVE   "6"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "７"
                        MOVE   "7"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "８"
                        MOVE   "8"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     "９"
                        MOVE   "9"  TO  WRK-INPUTCOMENT-KIN2-T(IDW8:1)
                     WHEN     OTHER
                        MOVE    14  TO  IDW7
                   END-EVALUATE
                 END-PERFORM
                 IF  WRK-INPUTCOMENT-KIN2-T NOT = SPACE
                   MOVE    8    TO   IDW8
                   PERFORM VARYING IDW7 FROM  7  BY -1
                            UNTIL  IDW7   <   1
                     IF  WRK-INPUTCOMENT-KIN2-T(IDW7:1) = SPACE
                        CONTINUE
                     ELSE
                        COMPUTE  IDW8 = IDW8 - 1
                        MOVE  WRK-INPUTCOMENT-KIN2-T(IDW7:1)
                                TO   WRK-INPUTCOMENT-KIN-T(IDW8:1)
                     END-IF
                   END-PERFORM
                   MOVE    1    TO   RECE02-DAISAN-CHIKAN
                   MOVE  WRK-INPUTCOMENT-KIN
                                TO   RECE02-DAISAN-FTNMONEY
                 END-IF
               END-IF
             END-IF
      *
           END-IF
      *
           .
       2104415-ICHIBUCOM-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    受診履歴チェック
      *****************************************************************
       2104416-JYURRK-CHECK-SEC                 SECTION.
      *
           PERFORM  VARYING  IDX9  FROM  1  BY  1
                     UNTIL  (IDX9      >  31)
                      OR    (FLG-ARI2  =   1)
             IF  ACCT-DAY(1 IDX9)  NOT =  ZERO
               MOVE    ZERO                TO  FLG-ARI3
               MOVE    ZERO                TO  FLG-ARI4
      *
               PERFORM  VARYING  IDX31  FROM  1  BY  1
                         UNTIL  (IDX31               >   20  )
                          OR    (RECE02-SRYKA(IDX31) =  SPACE)
                          OR    (FLG-ARI2            =    1  )
      *
                 INITIALIZE                      JYURRK-REC
                 MOVE    RECE02-HOSPNUM      TO  JYURRK-HOSPNUM
                 MOVE    RECE02-PTID         TO  JYURRK-PTID
                 MOVE    RECE02-NYUGAIKBN    TO  JYURRK-NYUGAIKBN
                 MOVE    RECE02-SRYKA(IDX31) TO  JYURRK-SRYKA
                 MOVE    RECE02-SRYYM        TO  JYURRK-SRYYMD(1:6)
                 MOVE    IDX9                TO  JYURRK-SRYYMD(7:2)
                 MOVE    JYURRK-REC          TO  MCPDATA-REC
                 MOVE    "tbl_jyurrk"        TO  MCP-TABLE
                 MOVE    "key4"              TO  MCP-PATHNAME
                 PERFORM   900-DBSELECT-SEC
                 IF    MCP-RC  =  ZERO
                   MOVE    "tbl_jyurrk"      TO  MCP-TABLE
                   MOVE    "key4"            TO  MCP-PATHNAME
                   PERFORM   900-JYURRK-READ-SEC
                   PERFORM  UNTIL  (FLG-JYURRK  =  1)
                             OR    (FLG-ARI2    =  1)
                     IF    JYURRK-HKNKBN  NOT =  "0" AND "7"
                            MOVE     1       TO  FLG-ARI2
                     ELSE
                      IF   JYURRK-HKNKBN  =  "0"
                        INITIALIZE               HKNCOMBI-REC
                        MOVE  RECE02-HOSPNUM TO  COMB-HOSPNUM
                        MOVE  RECE02-PTID    TO  COMB-PTID
                        MOVE  JYURRK-HKNCOMBINUM
                                             TO  COMB-HKNCOMBINUM
                        MOVE  HKNCOMBI-REC   TO  MCPDATA-REC
                        PERFORM 900-HKNCOMBI-INV-SEC
                        IF    FLG-HKNCOMBI   =   ZERO
                          IF  COMB-HKNNUM(1:2) = "98" OR "90" OR "91"
                            MOVE     1       TO  FLG-ARI2
                          ELSE
                            MOVE     1       TO  FLG-ARI3
                          END-IF
                        END-IF
                      ELSE
                            MOVE     1       TO  FLG-ARI4
                      END-IF
                     END-IF
                     MOVE    "tbl_jyurrk"    TO  MCP-TABLE
                     MOVE    "key4"          TO  MCP-PATHNAME
                     PERFORM   900-JYURRK-READ-SEC
                   END-PERFORM
                 END-IF
                 MOVE    "tbl_jyurrk"        TO  MCP-TABLE
                 MOVE    "key4"              TO  MCP-PATHNAME
                 PERFORM   900-CLOSE-SEC
      *
               END-PERFORM
      *
               IF  FLG-ARI2 = ZERO
                 IF    FLG-ARI3  =   1
                 AND   FLG-ARI4  =   1
                   CONTINUE
                 ELSE
                   MOVE   1   TO   FLG-ARI2
                 END-IF
               END-IF
             END-IF
           END-PERFORM
      *
           .
       2104416-JYURRK-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    明細数等の編集
      *****************************************************************
       2104417-MEISAISU-HENSYU-SEC                 SECTION.
      *
           COMPUTE   RECE04-MEISAISU    =  RECE04-MEISAISU
                                        -  1
           MOVE      SRY-SRYCD(IDX2)   TO  WRK-SRYCD
           COMPUTE   RECE04-SRYCDTOTAL  =  RECE04-SRYCDTOTAL
                                        -  WRK-SRYCD
           COMPUTE   RECE04-SURYOUTOTAL =  RECE04-SURYOUTOTAL
                                        -  SRY-SRYSURYO(IDX2)
      *
           .
       2104417-MEISAISU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    リハ開始日編集
      *****************************************************************
       2104418-RIHAYMD-HENSYU-SEC                 SECTION.
      *
           MOVE      SPACE   TO  WRK-RIHA-YMD
           MOVE      SPACE   TO  WRK-RIHA-YMD-SEI
      *
           IF    SRY-SRYCD(IDX2) = "840000061" OR "840000561"
             MOVE    SRY-HOSPNUM          TO  PTCOM-HOSPNUM
             MOVE    SRY-PTID             TO  PTCOM-PTID
             MOVE    SRY-ZAINUM           TO  PTCOM-ZAINUM
             MOVE    SRY-SRYCD    (IDX2)  TO  PTCOM-SRYCD
             MOVE    SRY-INPUTNUM (IDX2)  TO  PTCOM-RENNUM
             PERFORM 950-PTCOM-READ-SEC
      *
             IF    SRY-SRYCD(IDX2) = "840000061"
               MOVE     "4"    TO    WRK-RIHA-YMD(1:1)
             END-IF
             IF    SRY-SRYCD(IDX2) = "840000561"
               MOVE     "5"    TO    WRK-RIHA-YMD(1:1)
             END-IF
             MOVE  PTCOM-INPUTCHI1(1:2)  TO  WRK-RIHA-YMD(2:2)
             MOVE  PTCOM-INPUTCHI2(1:2)  TO  WRK-RIHA-YMD(4:2)
             MOVE  PTCOM-INPUTCHI3(1:2)  TO  WRK-RIHA-YMD(6:2)
      *
             IF    WRK-RIHA-YMD  IS  NUMERIC
               INITIALIZE                   LNK-DAY1-AREA
               INITIALIZE                   STS-AREA-DAY
               MOVE    "12"           TO    LNK-DAY1-IRAI
               MOVE    WRK-RIHA-YMD   TO    LNK-DAY1-WYMD
               CALL    "ORCSDAY"      USING STS-AREA-DAY
                                            LNK-DAY1-AREA
               IF      STS-DAY-RC1    =     ZERO
                 MOVE  LNK-DAY1-YMD   TO  WRK-RIHA-YMD-SEI
               ELSE
                 MOVE  SPACE          TO  WRK-RIHA-YMD
               END-IF
             ELSE
               MOVE    SPACE          TO  WRK-RIHA-YMD
             END-IF
           END-IF
      *
           EVALUATE    FLG-RIHA-OKIKAE
             WHEN         1
               MOVE       1     TO  RECE02-RIHA2-SINDAI(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE02-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE02-RIHA2-SINYMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                     >   2  )
                              OR    (RECE02-RIHA2-SINYMD1(IDX1 IDW9)
                                                              = SPACE)
                              OR    (FLG-ARI5                 =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE02-RIHA2-SINYMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE02-RIHA2-SINYMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         2
               MOVE       1     TO  RECE02-RIHA2-NOUKE(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE02-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE02-RIHA2-NOUYMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                     >   2  )
                              OR    (RECE02-RIHA2-NOUYMD1(IDX1 IDW9)
                                                              = SPACE)
                              OR    (FLG-ARI5                 =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE02-RIHA2-NOUYMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE02-RIHA2-NOUYMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         3
               MOVE       1     TO  RECE02-RIHA2-UNDOKI(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE02-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE02-RIHA2-UNDYMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                     >   2  )
                              OR    (RECE02-RIHA2-UNDYMD1(IDX1 IDW9)
                                                              = SPACE)
                              OR    (FLG-ARI5                 =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE02-RIHA2-UNDYMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE02-RIHA2-UNDYMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         4
               MOVE       1     TO  RECE02-RIHA2-KOKYUKI(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE02-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE02-RIHA2-KOKYMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                     >   2  )
                              OR    (RECE02-RIHA2-KOKYMD1(IDX1 IDW9)
                                                              = SPACE)
                              OR    (FLG-ARI5                 =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE02-RIHA2-KOKYMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE02-RIHA2-KOKYMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         5
               MOVE       1     TO  RECE02-RIHA2-SESSYOKU(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE02-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE02-RIHA2-SESYMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                     >   2  )
                              OR    (RECE02-RIHA2-SESYMD1(IDX1 IDW9)
                                                              = SPACE)
                              OR    (FLG-ARI5                 =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE02-RIHA2-SESYMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE02-RIHA2-SESYMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         6
               MOVE       1     TO  RECE02-RIHA2-HAIYO(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE02-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE02-RIHA2-HAIYMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                     >   2  )
                              OR    (RECE02-RIHA2-HAIYMD1(IDX1 IDW9)
                                                              = SPACE)
                              OR    (FLG-ARI5                 =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE02-RIHA2-HAIYMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE02-RIHA2-HAIYMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         7
               MOVE       1     TO  RECE02-RIHA2-SINDAI9(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE02-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE02-RIHA2-SIN9YMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                      >   2  )
                              OR    (RECE02-RIHA2-SIN9YMD1(IDX1 IDW9)
                                                               = SPACE)
                              OR    (FLG-ARI5                  =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE02-RIHA2-SIN9YMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE02-RIHA2-SIN9YMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         8
               MOVE       1     TO  RECE02-RIHA2-KOKYUKI9(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE02-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE02-RIHA2-KOK9YMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                      >   2  )
                              OR    (RECE02-RIHA2-KOK9YMD1(IDX1 IDW9)
                                                               = SPACE)
                              OR    (FLG-ARI5                  =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE02-RIHA2-KOK9YMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE02-RIHA2-KOK9YMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
             WHEN         9
               MOVE       1     TO  RECE02-RIHA2-HAIYO9(IDX1)
               IF   WRK-RIHA-YMD-SEI  NOT = SPACE
                 IF   WRK-RIHA-YMD-SEI(1:6) = RECE02-SRYYM
                   MOVE   WRK-RIHA-YMD-SEI(7:2)  TO  IDW9
                   MOVE   1     TO  RECE02-RIHA2-HAI9YMD2(IDX1 IDW9)
                 ELSE
                   MOVE   ZERO  TO  FLG-ARI5
                   PERFORM  VARYING  IDW9  FROM  1  BY  1
                             UNTIL  (IDW9                      >   2  )
                              OR    (RECE02-RIHA2-HAI9YMD1(IDX1 IDW9)
                                                               = SPACE)
                              OR    (FLG-ARI5                  =   1  )
                     IF  WRK-RIHA-YMD-SEI =
                                    RECE02-RIHA2-HAI9YMD1(IDX1 IDW9)
                       MOVE  1  TO  FLG-ARI5
                     END-IF
                   END-PERFORM
                   IF    FLG-ARI5 = ZERO
                   AND   IDW9    <=  2
                     MOVE  WRK-RIHA-YMD-SEI
                                TO  RECE02-RIHA2-HAI9YMD1(IDX1 IDW9)
                   END-IF
                 END-IF
               END-IF
           END-EVALUATE
      *
           .
       2104418-RIHAYMD-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送２（Ｆ００２）
      *****************************************************************
       210442-RECE02-HENSYU-SEC               SECTION.
      *
      *    処方減回数の初期化
           MOVE   ZERO              TO   WRK-SYOHOU-KAISU
      *    処方せん減回数の初期化
           MOVE   ZERO              TO   WRK-SYOSEN-KAISU
      *    処方料（麻・向・毒・覚）の算定回数減算用領域の初期化
           MOVE   ZERO              TO   WRK-MADOKU-SHOHO
      *
      *    公費の分離表示用インデックスの確定
           MOVE          ZERO       TO     BUN-IDX
           MOVE          ZERO       TO     BUN-IDX6
      ***  IF    (RECE02-HKNNUM          NOT =   SPACE)   OR
           IF    (RECE02-HKNNUMHC(IDX1)  NOT =   SPACE)   OR
                 (RECE02-RJNHKNNUM       NOT =   SPACE)
               MOVE      1          TO     BUN-IDX
               IF   (RECE02-SEIHOFLG             =   "1"  )
               AND  (RECE02-SYUTANARIFLG         =    1   )
               AND  (RECE02-HKNNUMHC(IDX1)   NOT =   SPACE)
               AND  (RECE02-KOHNUMHC(IDX1 1)     =   SPACE)
               AND  (RECE02-KOHNUMHC(IDX1 2)     =   SPACE)
               AND  (RECE02-KOHNUMHC(IDX1 3)     =   SPACE)
               AND  (RECE02-KOHNUMHC(IDX1 4)     =   SPACE)
                  MOVE   6          TO     BUN-IDX6
               END-IF
               IF   FLG-SHOSAISIN        =       1                      
                    PERFORM    VARYING   ACCT-IDX   FROM   1    BY   1  
                               UNTIL    ACCT-IDX   >      31            
                      IF  ACCT-DAY(1 ACCT-IDX)   NOT =    ZERO          
                          MOVE    "1"       TO                          
                                        TBL-JNISSU-DAY(1 ACCT-IDX)      
                      END-IF                                            
                    END-PERFORM                                         
               END-IF
               IF   FLG-SHOSAISIN-GEN    =       1
                    PERFORM    VARYING   ACCT-IDX   FROM   1    BY   1
                               UNTIL    ACCT-IDX   >      31
                      IF  ACCT-DAY(1 ACCT-IDX)   NOT =    ZERO
                          MOVE    "1"       TO
                                        TBL-JNISSU-DAY-GEN(1 ACCT-IDX)
                      END-IF
                    END-PERFORM
               END-IF
           END-IF
      *    インデックス２
           MOVE          ZERO       TO     BUN-IDX2
           MOVE          IDX1       TO     HC-IDX
           PERFORM    VARYING   IDX2    FROM   1   BY   1
              UNTIL   (IDX2      >       4)
                     IF    RECE02-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE02-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE02-KOHNUM(1)
                      AND  RECE02-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE02-KOHID(1)
                           MOVE      2       TO     BUN-IDX2
                           IF   FLG-SHOSAISIN      =    1               
                               PERFORM VARYING ACCT-IDX FROM 1 BY 1     
                                    UNTIL    ACCT-IDX   >   31          
                                 IF  ACCT-DAY(1 ACCT-IDX) NOT =  ZERO   
                                       MOVE  "1"  TO
                                            TBL-JNISSU-DAY(2 ACCT-IDX)
                                 END-IF                                 
                               END-PERFORM                 
                           END-IF                                       
                           IF   FLG-SHOSAISIN-GEN  =    1
                               PERFORM VARYING ACCT-IDX FROM 1 BY 1
                                    UNTIL    ACCT-IDX   >   31
                                 IF  ACCT-DAY(1 ACCT-IDX) NOT =  ZERO
                                       MOVE  "1"  TO
                                        TBL-JNISSU-DAY-GEN(2 ACCT-IDX)
                                 END-IF
                               END-PERFORM
                           END-IF
                      END-IF
                     END-IF
           END-PERFORM
      *    インデックス３
           MOVE          ZERO       TO     BUN-IDX3
           MOVE          IDX1       TO     HC-IDX
           PERFORM    VARYING   IDX2    FROM   1   BY   1
              UNTIL   (IDX2      >       4)
                     IF    RECE02-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE02-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE02-KOHNUM(2)
                      AND  RECE02-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE02-KOHID(2)
                           MOVE      3       TO     BUN-IDX3
                           IF   FLG-SHOSAISIN      =    1               
                               PERFORM VARYING ACCT-IDX FROM 1 BY 1     
                                    UNTIL    ACCT-IDX   >   31          
                                 IF  ACCT-DAY(1 ACCT-IDX) NOT =  ZERO   
                                    IF   TBL-FUKUSHI-DAYFLG(IDX2)
                                                            NOT = ZERO
                                       CONTINUE
                                    ELSE
                                       MOVE  "1"  TO
                                            TBL-JNISSU-DAY(3 ACCT-IDX)
                                    END-IF
                                    MOVE  "1"  TO
                                            TBL-JNISSU2-DAY(3 ACCT-IDX)
                                 END-IF                                 
                               END-PERFORM                              
                           END-IF                                       
                           IF   FLG-SHOSAISIN-GEN  =    1
                               PERFORM VARYING ACCT-IDX FROM 1 BY 1
                                    UNTIL    ACCT-IDX   >   31
                                 IF  ACCT-DAY(1 ACCT-IDX) NOT =  ZERO
                                       MOVE  "1"  TO
                                        TBL-JNISSU-DAY-GEN(3 ACCT-IDX)
                                 END-IF
                               END-PERFORM
                           END-IF
                      END-IF
                     END-IF
           END-PERFORM
      *    インデックス４
           MOVE          ZERO       TO     BUN-IDX4
           MOVE          IDX1       TO     HC-IDX
           PERFORM    VARYING   IDX2    FROM   1   BY   1
              UNTIL   (IDX2      >       4)
                     IF    RECE02-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE02-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE02-KOHNUM(3)
                      AND  RECE02-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE02-KOHID(3)
                            MOVE      4       TO     BUN-IDX4
                           IF   FLG-SHOSAISIN      =    1               
                               PERFORM VARYING ACCT-IDX FROM 1 BY 1     
                                    UNTIL    ACCT-IDX   >   31          
                                 IF  ACCT-DAY(1 ACCT-IDX) NOT =  ZERO   
                                    IF   TBL-FUKUSHI-DAYFLG(IDX2)
                                                            NOT = ZERO
                                       CONTINUE
                                    ELSE
                                       MOVE  "1"  TO
                                            TBL-JNISSU-DAY(4 ACCT-IDX)
                                    END-IF
                                    MOVE  "1"  TO
                                            TBL-JNISSU2-DAY(4 ACCT-IDX)
                                 END-IF                                 
                               END-PERFORM                              
                           END-IF                                       
                           IF   FLG-SHOSAISIN-GEN  =    1
                               PERFORM VARYING ACCT-IDX FROM 1 BY 1
                                    UNTIL    ACCT-IDX   >   31
                                 IF  ACCT-DAY(1 ACCT-IDX) NOT =  ZERO
                                       MOVE  "1"  TO
                                        TBL-JNISSU-DAY-GEN(4 ACCT-IDX)
                                 END-IF
                               END-PERFORM
                           END-IF
                      END-IF
                     END-IF
           END-PERFORM
      *    インデックス５
           MOVE          ZERO       TO     BUN-IDX5
           MOVE          IDX1       TO     HC-IDX
           PERFORM    VARYING   IDX2    FROM   1   BY   1
              UNTIL   (IDX2      >       4)
                     IF    RECE02-KOHNUMHC(HC-IDX IDX2) NOT =  SPACE
                      IF   RECE02-KOHNUMHC(HC-IDX IDX2) =
                                                   RECE02-KOHNUM(4)
                      AND  RECE02-KOHIDHC(HC-IDX IDX2)  =
                                                   RECE02-KOHID(4)
                            MOVE      5       TO     BUN-IDX5
                           IF   FLG-SHOSAISIN      =    1               
                               PERFORM VARYING ACCT-IDX FROM 1 BY 1     
                                    UNTIL    ACCT-IDX   >   31          
                                 IF  ACCT-DAY(1 ACCT-IDX) NOT =  ZERO   
                                    IF   TBL-FUKUSHI-DAYFLG(IDX2)
                                                            NOT = ZERO
                                       CONTINUE
                                    ELSE
                                       MOVE  "1"  TO
                                            TBL-JNISSU-DAY(5 ACCT-IDX)
                                    END-IF
                                    MOVE  "1"  TO
                                            TBL-JNISSU2-DAY(5 ACCT-IDX)
                                 END-IF                                 
                               END-PERFORM                              
                           END-IF                                       
                           IF   FLG-SHOSAISIN-GEN  =    1
                               PERFORM VARYING ACCT-IDX FROM 1 BY 1
                                    UNTIL    ACCT-IDX   >   31
                                 IF  ACCT-DAY(1 ACCT-IDX) NOT =  ZERO
                                       MOVE  "1"  TO
                                        TBL-JNISSU-DAY-GEN(5 ACCT-IDX)
                                 END-IF
                               END-PERFORM
                           END-IF
                      END-IF
                     END-IF
           END-PERFORM
      *
           MOVE      ZERO       TO     WK-ZAIKAISU
           MOVE      ZERO       TO     WK-ZAITEN
           MOVE      ZERO       TO     WK-SYUTEN
           MOVE      ZERO       TO     WK-KIZAITEN
           MOVE      ZERO       TO     WK-YKZTEN
      *
           PERFORM   VARYING  IDX3   FROM   1   BY   1
                     UNTIL    (IDX3         >     5)        OR
                              (SRY-SRYCD(IDX3)   =   SPACE)
               IF    SRY-RENNUM     =     1
                   IF  IDX3         =     1
                       MOVE  ACCT-ZAIKAISU     TO   WK-ZAIKAISU
                       MOVE  ACCT-ZAITEN       TO   WK-ZAITEN
                       IF    SRY-SRYKBN  =  "40" OR "50" OR "60"
                                         OR "70" OR "80" OR "54"
                                         OR "64"
                                MOVE   ACCT-SYUTEN1   TO   WK-SYUTEN
                                COMPUTE   WK-YKZTEN   =
                                                      ACCT-KIZAITEN  +
                                                      ACCT-YKZTEN
                       END-IF
                       IF    SRY-SRYKBN     =  "14"
                           MOVE    ACCT-SYUTEN1   TO   WK-SYUTEN
                           MOVE    ACCT-KIZAITEN  TO   WK-KIZAITEN
                           MOVE    ACCT-YKZTEN    TO   WK-YKZTEN
                       END-IF
                   ELSE
                       IF ( SRY-SRYKBN   =  "21"  OR  "22"  OR  "23" OR
                                            "31"  OR  "32"  OR  "33" OR
                                            "40"  OR  "50"  OR  "54" OR
                                            "60"  OR  "70"  OR  "80" OR
                                            "13"  OR  "14"  OR  "64" OR
                                            "25"                     )
                       OR ((ACCT-ZAIKBN  =   2  ) AND
                           (SRY-SRYKBN   =  "12"))
                           MOVE  ZERO          TO   WK-ZAIKAISU
                           MOVE  ZERO          TO   WK-ZAITEN
                           MOVE  ZERO          TO   WK-SYUTEN
                           MOVE  ZERO          TO   WK-KIZAITEN
                           MOVE  ZERO          TO   WK-YKZTEN
                           MOVE  ZERO          TO   FLG-OSINKBN
                       END-IF
                   END-IF
               ELSE
                     MOVE    ZERO     TO    WK-ZAIKAISU
                     MOVE    ZERO     TO    WK-ZAITEN
                     MOVE    ZERO     TO    WK-SYUTEN
                     MOVE    ZERO     TO    WK-KIZAITEN
                     MOVE    ZERO     TO    WK-YKZTEN
                     MOVE    ZERO     TO    FLG-OSINKBN
               END-IF
               IF   (ACCT-ZAITEN    NOT =    ZERO)    AND
                    (ACCT-ZAIKAISU  NOT =    ZERO)
                     PERFORM   2104421-RECE-LEFT-SET-SEC
               END-IF
               IF  ( SRY-SRYKBN   =   "21"   OR   "22"   OR   "23"   OR
                                      "31"   OR   "32"   OR   "33"   OR
                                      "40"   OR   "50"   OR   "54"   OR
                                      "60"   OR   "70"   OR   "13"   OR
                                      "14"   OR   "64" )
               OR  ((ACCT-ZAIKBN  =    2  ) AND
                    (SRY-SRYKBN   =   "12"))
                     MOVE    6      TO    IDX3
               END-IF
           END-PERFORM
      *
      *    処方の算定回数から減算
           COMPUTE    RECE02-KAISU(19)   =    RECE02-KAISU(19)
                                         -    WRK-SYOHOU-KAISU
      *    処方せんの算定回数から減算
           COMPUTE    RECE02-KAISU(33)   =    RECE02-KAISU(33)
                                         -    WRK-SYOSEN-KAISU
      *    麻毒の算定回数から処方料（麻・向・毒・覚）の減算
           COMPUTE    RECE02-KAISU(20)   =    RECE02-KAISU(20)
                                         -    WRK-MADOKU-SHOHO
      *
           .
      *
       210442-RECE02-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送２（Ｆ００２）
      *****************************************************************
       2104421-RECE-LEFT-SET-SEC               SECTION.
      *
           EVALUATE    SRY-SRYKBN
      *    初診のレセ点数欄の編集
               WHEN    "11"
                   IF   WRK-TNS-CHUKSNTUBAN(IDX3)   =   "0"
                   AND  SRY-SRYCD(IDX3)(1:1)        =   "1"
                        ADD   WK-ZAIKAISU  TO   RECE02-KAISU(1)
                   END-IF
      *
      ***          IF   WRK-TNS-DATAKBN(IDX3)  =   2
      ***            EVALUATE    WRK-TNS-TIMEKSNKBN(IDX3)
      ***                WHEN    1
      ***                WHEN    5
      ***                    MOVE  "1"     TO   RECE02-SHOSHINTIME
      ***                WHEN    4
      ***                    MOVE  "2"     TO   RECE02-SHOSHINTIME
      ***                WHEN    3
      ***                    MOVE  "3"     TO   RECE02-SHOSHINTIME
      ***            END-EVALUATE
      ***          END-IF
      *
      *************１：時間外　２：深夜　３：休日　４：時間外・深夜
      *************５：時間外・休日　６：休日・深夜
      *************７：時間外・休日・深夜
                   IF   WRK-TNS-DATAKBN(IDX3)  =   2
                     EVALUATE    WRK-TNS-TIMEKSNKBN(IDX3)
                         WHEN    1
                         WHEN    5
                         WHEN    6
                             EVALUATE   RECE02-SHOSHINTIME
                               WHEN   SPACE
                                  MOVE  "1"     TO   RECE02-SHOSHINTIME
                               WHEN   "1"
                                  CONTINUE
                               WHEN   "2"
                                  MOVE  "4"     TO   RECE02-SHOSHINTIME
                               WHEN   "3"
                                  MOVE  "5"     TO   RECE02-SHOSHINTIME
                               WHEN   "4"
                                  CONTINUE
                               WHEN   "5"
                                  CONTINUE
                               WHEN   "6"
                                  MOVE  "7"     TO   RECE02-SHOSHINTIME
                               WHEN   "7"
                                  CONTINUE
                             END-EVALUATE
                         WHEN    4
                             EVALUATE   RECE02-SHOSHINTIME
                               WHEN   SPACE
                                  MOVE  "2"     TO   RECE02-SHOSHINTIME
                               WHEN   "1"
                                  MOVE  "4"     TO   RECE02-SHOSHINTIME
                               WHEN   "2"
                                  CONTINUE
                               WHEN   "3"
                                  MOVE  "6"     TO   RECE02-SHOSHINTIME
                               WHEN   "4"
                                  CONTINUE
                               WHEN   "5"
                                  MOVE  "7"     TO   RECE02-SHOSHINTIME
                               WHEN   "6"
                                  CONTINUE
                               WHEN   "7"
                                  CONTINUE
                             END-EVALUATE
                         WHEN    3
                             EVALUATE   RECE02-SHOSHINTIME
                               WHEN   SPACE
                                  MOVE  "3"     TO   RECE02-SHOSHINTIME
                               WHEN   "1"
                                  MOVE  "5"     TO   RECE02-SHOSHINTIME
                               WHEN   "2"
                                  MOVE  "6"     TO   RECE02-SHOSHINTIME
                               WHEN   "3"
                                  CONTINUE
                               WHEN   "4"
                                  MOVE  "7"     TO   RECE02-SHOSHINTIME
                               WHEN   "5"
                                  CONTINUE
                               WHEN   "6"
                                  CONTINUE
                               WHEN   "7"
                                  CONTINUE
                             END-EVALUATE
                     END-EVALUATE
                   END-IF
      *
                   IF    BUN-IDX        =   1
                       COMPUTE    RECE02-TENSU(1 BUN-IDX)  =
                                  RECE02-TENSU(1 BUN-IDX)  +
                       (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    RECE02-TENSU(1 BUN-IDX2)  =
                                  RECE02-TENSU(1 BUN-IDX2)  +
                       (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    RECE02-TENSU(1 BUN-IDX3)  =
                                  RECE02-TENSU(1 BUN-IDX3)  +
                       (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    RECE02-TENSU(1 BUN-IDX4)  =
                                  RECE02-TENSU(1 BUN-IDX4)  +
                       (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE    RECE02-TENSU(1 BUN-IDX5)  =
                                  RECE02-TENSU(1 BUN-IDX5)  +
                       (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE    RECE02-SYUTANTEN(1)  =
                                  RECE02-SYUTANTEN(1)  +
                       (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   COMPUTE        RECE02-ALLTENSU(1)   =
                                  RECE02-ALLTENSU(1)   +
                       (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
      *    再診のレセ点数欄の編集（集計方法変更後）
               WHEN    "12"
                 EVALUATE  WRK-TNS-GAITENTTLKBN(IDX3)
      *      （基本手技）
                   WHEN  120
                    IF    RECE02-SRYYM  >= "201804"
                       PERFORM  21044211-RECE-LEFT12-HEN-SEC
                    ELSE
                     IF   RECE02-SRYYM  <  "200306"
                       IF ( SRY-SRYCD(IDX3)      =   "112007170"  OR
                                                     "112702270"   )
                       OR ( WRK-TNS-CHUKSNTUBAN(IDX3)  NOT =  "0"  )
                       OR ( SRY-SRYCD(IDX3)(1:1)       NOT =  "1"  )
                           CONTINUE
                       ELSE
                           ADD   WK-ZAIKAISU    TO   RECE02-KAISU(2)
                       END-IF
                       IF    RECE02-KHNTEN(2)   =   ZERO
                         MOVE  WRK-TNS-TEN(IDX3)  TO   RECE02-KHNTEN(2)
                       ELSE
                         IF   RECE02-KHNTEN(2)  NOT =  WRK-TNS-TEN(IDX3)
                               MOVE   ZERO    TO   RECE02-KHNTEN(2)
                               MOVE   1       TO   FLG-KHNTEN2
                         END-IF
                       END-IF
                       IF    BUN-IDX        =   1
                            COMPUTE    RECE02-TENSU(2 BUN-IDX)  =
                                       RECE02-TENSU(2 BUN-IDX)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                            COMPUTE    RECE02-TENSU(2 BUN-IDX2)  =
                                       RECE02-TENSU(2 BUN-IDX2)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                            COMPUTE    RECE02-TENSU(2 BUN-IDX3)  =
                                       RECE02-TENSU(2 BUN-IDX3)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                            COMPUTE    RECE02-TENSU(2 BUN-IDX4)  =
                                       RECE02-TENSU(2 BUN-IDX4)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                            COMPUTE    RECE02-TENSU(2 BUN-IDX5)  =
                                       RECE02-TENSU(2 BUN-IDX5)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                            COMPUTE    RECE02-SYUTANTEN(2)  =
                                       RECE02-SYUTANTEN(2)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       COMPUTE         RECE02-ALLTENSU(2)   =
                                       RECE02-ALLTENSU(2)   +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                     ELSE
                       IF ( SRY-SRYCD(IDX3)      =   "112007170"  OR
                                                     "112702270"   )
                       OR ( WRK-TNS-CHUKSNTUBAN(IDX3)  NOT = "0"   )
                       OR ( SRY-SRYCD(IDX3)(1:1)       NOT = "1"   )
                           CONTINUE
                       ELSE
                           ADD   WK-ZAIKAISU    TO   RECE02-KAISU(2)
                           IF    SRY-SRYCD(IDX3)   =   "112015810"
                                                  OR   "112017010"
                                                  OR   "112015950"
                                                  OR   "112017150"
                                                  OR   "112016210"
                                                  OR   "112016410"
                                                  OR   "112017610"
                             ADD  WK-ZAIKAISU   TO   CNT-SAISIN-DOUJITU
                           ELSE
                             ADD  WK-ZAIKAISU   TO   CNT-SAISIN-ETC
                           END-IF
                       END-IF
      **
                       IF   FLG-NYUYOJI          =   ZERO
                       AND  SRY-SRYCD(IDX3)      =   "112000970"
                            MOVE     1       TO    FLG-NYUYOJI
                       END-IF
                       IF   FLG-NYUYOJI          =   2
                       AND  SRY-SRYCD(IDX3)      =   "112000970"
                            MOVE     9       TO    FLG-NYUYOJI
                       END-IF
                       IF   FLG-NYUYOJI          =   ZERO
                       AND  SRY-SRYCD(IDX3)      =   "112006970"
                            MOVE     2       TO    FLG-NYUYOJI
                       END-IF
                       IF   FLG-NYUYOJI          =   1
                       AND  SRY-SRYCD(IDX3)      =   "112006970"
                            MOVE     9       TO    FLG-NYUYOJI
                       END-IF
      *
                       IF   FLG-YOJI          =   ZERO
                       AND  SRY-SRYCD(IDX3)      =   "112001070"
                            MOVE     1       TO    FLG-YOJI
                       END-IF
                       IF   FLG-YOJI          =   2
                       AND  SRY-SRYCD(IDX3)      =   "112001070"
                            MOVE     9       TO    FLG-YOJI
                       END-IF
                       IF   FLG-YOJI          =   ZERO
                       AND  SRY-SRYCD(IDX3)      =   "112007070"
                            MOVE     2       TO    FLG-YOJI
                       END-IF
                       IF   FLG-YOJI          =   1
                       AND  SRY-SRYCD(IDX3)      =   "112007070"
                            MOVE     9       TO    FLG-YOJI
                       END-IF
      **
                       IF   FLG-NYUYOJI          =   ZERO
                       AND  SRY-SRYCD(IDX3)      =   "112006270"
                            MOVE     1       TO    FLG-NYUYOJI
                       END-IF
                       IF   FLG-NYUYOJI          =   2
                       AND  SRY-SRYCD(IDX3)      =   "112006270"
                            MOVE     9       TO    FLG-NYUYOJI
                       END-IF
                       IF   FLG-NYUYOJI          =   ZERO
                       AND  SRY-SRYCD(IDX3)      =   "112007270"
                            MOVE     2       TO    FLG-NYUYOJI
                       END-IF
                       IF   FLG-NYUYOJI          =   1
                       AND  SRY-SRYCD(IDX3)      =   "112007270"
                            MOVE     9       TO    FLG-NYUYOJI
                       END-IF
      *
                       IF   FLG-YOJI          =   ZERO
                       AND  SRY-SRYCD(IDX3)      =   "112006370"
                            MOVE     1       TO    FLG-YOJI
                       END-IF
                       IF   FLG-YOJI          =   2
                       AND  SRY-SRYCD(IDX3)      =   "112006370"
                            MOVE     9       TO    FLG-YOJI
                       END-IF
                       IF   FLG-YOJI          =   ZERO
                       AND  SRY-SRYCD(IDX3)      =   "112007370"
                            MOVE     2       TO    FLG-YOJI
                       END-IF
                       IF   FLG-YOJI          =   1
                       AND  SRY-SRYCD(IDX3)      =   "112007370"
                            MOVE     9       TO    FLG-YOJI
                       END-IF
      **
                       IF   RECE02-SRYYM  >= "200604"
                         IF  SRY-SRYCD(IDX3)  =  "112000970"        OR
                                                 "112006270"
                              COMPUTE  CNT-NYUYOJI  =  CNT-NYUYOJI
                                                    +  WK-ZAIKAISU
                              COMPUTE  CNT-NYUYOJI2 =  CNT-NYUYOJI2
                                                    +  WK-ZAIKAISU
                         END-IF
                         IF   RECE02-SRYYM  >= "201004"
                           IF  SRY-SRYCD(IDX3)  =  "112016070"
                              COMPUTE  CNT-JIKANTAI1 = CNT-JIKANTAI1
                                                     + WK-ZAIKAISU
                           END-IF
                           IF  SRY-SRYCD(IDX3)  =  "112015670"
                              COMPUTE  CNT-KOKENKSN =  CNT-KOKENKSN
                                                    +  WK-ZAIKAISU
                           END-IF
                           IF  SRY-SRYCD(IDX3)  =  "112016170"
                              COMPUTE  CNT-JIKANTAI3 = CNT-JIKANTAI3
                                                     + WK-ZAIKAISU
                           END-IF
                           IF  SRY-SRYCD(IDX3)  =  "112015770"
                              COMPUTE  CNT-MESAIKSN =  CNT-MESAIKSN
                                                    +  WK-ZAIKAISU
                           END-IF
                           IF  SRY-SRYCD(IDX3)  =  "112017270"
                              COMPUTE  CNT-CHIHOKATU = CNT-CHIHOKATU
                                                     + WK-ZAIKAISU
                           END-IF
                           IF  SRY-SRYCD(IDX3)  =  "112017570"
                              COMPUTE  CNT-CHIHOKAT2 = CNT-CHIHOKAT2
                                                     + WK-ZAIKAISU
                           END-IF
                         END-IF
                       ELSE
                         IF  SRY-SRYCD(IDX3)  =  "112000970"         OR
                                                 "112006970"         OR
                                                 "112006270"         OR
                                                 "112007270"
                              COMPUTE  CNT-NYUYOJI =   CNT-NYUYOJI
                                                   +   WK-ZAIKAISU
                         END-IF
                         IF  SRY-SRYCD(IDX3)  =  "112001070"         OR
                                                 "112007070"         OR
                                                 "112006370"         OR
                                                 "112007370"
                              COMPUTE  CNT-YOJI    =   CNT-YOJI
                                                   +   WK-ZAIKAISU
                         END-IF
                       END-IF
      **
                       IF ( SRY-SRYCD(IDX3)      =   "112007170"  OR
                                                     "112702270"   )
                       OR ( FLG-NYUYOJI          =   9             )
                       OR ( FLG-YOJI             =   9             )
                            MOVE   ZERO       TO    RECE02-KHNTEN(2)
                            MOVE   1          TO    FLG-KHNTEN2
                       ELSE
                         IF  SRY-SRYCD(IDX3)  =  "112000970"         OR
                                                 "112006970"         OR
                                                 "112001070"         OR
                                                 "112007070"         OR
                                                 "112006270"         OR
                                                 "112007270"         OR
                                                 "112006370"         OR
                                                 "112007370"
                            IF   FLG-YOJI-ARI  =  ZERO
                              ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                              MOVE     1       TO    FLG-YOJI-ARI
                            END-IF
                         ELSE
                          IF  (RECE02-SRYYM    >=  "201004"       )
                          AND (SRY-SRYCD(IDX3)  =  "112015670"    OR
                                                   "112015770"    OR
                                                   "112017270"    OR
                                                   "112017570"    OR
                                                   "112016070"    OR
                                                   "112016170"    )
                            EVALUATE  SRY-SRYCD(IDX3)
                              WHEN     "112016070"
                                IF   FLG-JIKANTAI1-ARI  =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                   TO  RECE02-KHNTEN(2)
                                  MOVE     1       TO  FLG-JIKANTAI1-ARI
                                END-IF
                              WHEN     "112015670"
                                IF   FLG-KOKENKSN-ARI   =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                   TO  RECE02-KHNTEN(2)
                                  MOVE     1       TO  FLG-KOKENKSN-ARI
                                END-IF
                              WHEN     "112016170"
                                IF   FLG-JIKANTAI3-ARI  =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                   TO  RECE02-KHNTEN(2)
                                  MOVE     1       TO  FLG-JIKANTAI3-ARI
                                END-IF
                              WHEN     "112015770"
                                IF   FLG-MESAIKSN-ARI   =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                   TO  RECE02-KHNTEN(2)
                                  MOVE     1       TO  FLG-MESAIKSN-ARI
                                END-IF
                              WHEN     "112017270"
                                IF   FLG-CHIHOKATU-ARI  =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                   TO  RECE02-KHNTEN(2)
                                  MOVE     1       TO  FLG-CHIHOKATU-ARI
                                END-IF
                              WHEN     "112017570"
                                IF   FLG-CHIHOKAT2-ARI  =  ZERO
                                  ADD  WRK-TNS-TEN(IDX3)
                                                   TO  RECE02-KHNTEN(2)
                                  MOVE     1       TO  FLG-CHIHOKAT2-ARI
                                END-IF
                            END-EVALUATE
                          ELSE
                            IF   FLG-SAISIN-ARI   =  ZERO
                              ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                              MOVE     1       TO    FLG-SAISIN-ARI
                            END-IF
                          END-IF
                         END-IF
                       END-IF
      **
                       IF    BUN-IDX        =   1
                            COMPUTE    RECE02-TENSU(2 BUN-IDX)  =
                                       RECE02-TENSU(2 BUN-IDX)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                            COMPUTE    RECE02-TENSU(2 BUN-IDX2)  =
                                       RECE02-TENSU(2 BUN-IDX2)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                            COMPUTE    RECE02-TENSU(2 BUN-IDX3)  =
                                       RECE02-TENSU(2 BUN-IDX3)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                            COMPUTE    RECE02-TENSU(2 BUN-IDX4)  =
                                       RECE02-TENSU(2 BUN-IDX4)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                            COMPUTE    RECE02-TENSU(2 BUN-IDX5)  =
                                       RECE02-TENSU(2 BUN-IDX5)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                            COMPUTE    RECE02-SYUTANTEN(2)  =
                                       RECE02-SYUTANTEN(2)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       COMPUTE         RECE02-ALLTENSU(2)   =
                                       RECE02-ALLTENSU(2)   +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                     END-IF
                    END-IF
      *      （外来管理加算）
                   WHEN  122
                        IF    RECE02-KHNTEN(3)   =   ZERO
                           MOVE  WRK-TNS-TEN(IDX3) TO  RECE02-KHNTEN(3)
                        ELSE
                           IF RECE02-KHNTEN(3) NOT = WRK-TNS-TEN(IDX3)
                              MOVE   ZERO    TO  RECE02-KHNTEN(3)
                              MOVE   1    TO  FLG-KHNTEN3
                           END-IF
                        END-IF
                        ADD    WK-ZAIKAISU   TO   RECE02-KAISU(3)
                        IF    BUN-IDX        =   1
                            COMPUTE    RECE02-TENSU(3 BUN-IDX)  =
                                       RECE02-TENSU(3 BUN-IDX)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                        END-IF
                        IF    BUN-IDX2       =   2
                            COMPUTE    RECE02-TENSU(3 BUN-IDX2)  =
                                       RECE02-TENSU(3 BUN-IDX2)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                        END-IF
                        IF    BUN-IDX3       =   3
                            COMPUTE    RECE02-TENSU(3 BUN-IDX3)  =
                                       RECE02-TENSU(3 BUN-IDX3)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                        END-IF
                        IF    BUN-IDX4       =   4
                            COMPUTE    RECE02-TENSU(3 BUN-IDX4)  =
                                       RECE02-TENSU(3 BUN-IDX4)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                        END-IF
                        IF    BUN-IDX5       =   5
                            COMPUTE    RECE02-TENSU(3 BUN-IDX5)  =
                                       RECE02-TENSU(3 BUN-IDX5)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                        END-IF
                        IF    BUN-IDX6       =   6
                            COMPUTE    RECE02-SYUTANTEN(3)  =
                                       RECE02-SYUTANTEN(3)  +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                        END-IF
                        COMPUTE        RECE02-ALLTENSU(3)   =
                                       RECE02-ALLTENSU(3)   +
                            (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
      *      （時間外）
                   WHEN  123
                                  IF    RECE02-KHNTEN(4)   =   ZERO
                                   MOVE  WRK-TNS-TEN(IDX3)    TO
                                                     RECE02-KHNTEN(4)
                                  ELSE
                                   IF RECE02-KHNTEN(4) NOT = 
                                                     WRK-TNS-TEN(IDX3)
                                        MOVE   ZERO    TO
                                                      RECE02-KHNTEN(4)
                                        MOVE   1    TO  FLG-KHNTEN4
                                   END-IF
                                  END-IF
                                  ADD   WK-ZAIKAISU  TO
                                                      RECE02-KAISU(4)
                                  IF   RECE02-SRYYM  >= "200604"
                                    IF SRY-SRYCD(IDX3) = "112015170" OR
                                                         "112015270" OR
                                                         "112015370" OR
                                                         "112015470" OR
                                                         "112014470" OR
                                                         "112014570" OR
                                                         "112014670" OR
                                                         "112014770" OR
                                                         "112014870" OR
                                                         "112014970" OR
                                                         "112015070" OR
                                                         "112014170" OR
                                                         "112014270" OR
                                                         "112014370"
                                        COMPUTE  CNT-NYUYOJI2 =
                                                 CNT-NYUYOJI2 +
                                                 WK-ZAIKAISU
                                    END-IF
                                  END-IF
                                  IF    BUN-IDX        =   1
                                     COMPUTE RECE02-TENSU(4 BUN-IDX) =
                                             RECE02-TENSU(4 BUN-IDX) +
                                     (WRK-TNS-TEN(IDX3) 
                                                     *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX2       =   2
                                     COMPUTE RECE02-TENSU(4 BUN-IDX2) =
                                             RECE02-TENSU(4 BUN-IDX2) +
                                     (WRK-TNS-TEN(IDX3)   
                                                     *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX3       =   3
                                     COMPUTE RECE02-TENSU(4 BUN-IDX3) =
                                             RECE02-TENSU(4 BUN-IDX3) +
                                     (WRK-TNS-TEN(IDX3)   
                                                     *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX4       =   4
                                     COMPUTE RECE02-TENSU(4 BUN-IDX4) =
                                             RECE02-TENSU(4 BUN-IDX4) +
                                     (WRK-TNS-TEN(IDX3)   
                                                     *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX5       =   5
                                     COMPUTE RECE02-TENSU(4 BUN-IDX5) =
                                             RECE02-TENSU(4 BUN-IDX5) +
                                     (WRK-TNS-TEN(IDX3)   
                                                     *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX6       =   6
                                     COMPUTE RECE02-SYUTANTEN(4)  =
                                             RECE02-SYUTANTEN(4)  +
                                     (WRK-TNS-TEN(IDX3)   
                                                     *   ACCT-ZAIKAISU)
                                  END-IF
                                  COMPUTE    RECE02-ALLTENSU(4)   =
                                             RECE02-ALLTENSU(4)   +
                                     (WRK-TNS-TEN(IDX3)
                                                     *   ACCT-ZAIKAISU)
      *      （休日）
                   WHEN  124
                                  IF    RECE02-KHNTEN(5)   =   ZERO
                                   MOVE  WRK-TNS-TEN(IDX3)    TO
                                                     RECE02-KHNTEN(5)
                                  ELSE
                                   IF RECE02-KHNTEN(5) NOT = 
                                                    WRK-TNS-TEN(IDX3)
                                        MOVE   ZERO    TO
                                                      RECE02-KHNTEN(5)
                                        MOVE   1     TO   FLG-KHNTEN5
                                   END-IF
                                  END-IF
                                  ADD   WK-ZAIKAISU   TO
                                                        RECE02-KAISU(5)
                                  IF   RECE02-SRYYM  >= "200604"
                                    IF SRY-SRYCD(IDX3) = "112015170" OR
                                                         "112015270" OR
                                                         "112015370" OR
                                                         "112015470" OR
                                                         "112014470" OR
                                                         "112014570" OR
                                                         "112014670" OR
                                                         "112014770" OR
                                                         "112014870" OR
                                                         "112014970" OR
                                                         "112015070" OR
                                                         "112014170" OR
                                                         "112014270" OR
                                                         "112014370"
                                        COMPUTE  CNT-NYUYOJI2 =
                                                 CNT-NYUYOJI2 +
                                                 WK-ZAIKAISU
                                    END-IF
                                  END-IF
                                  IF    BUN-IDX        =   1
                                    COMPUTE  RECE02-TENSU(5 BUN-IDX) =
                                             RECE02-TENSU(5 BUN-IDX) +
                                    (WRK-TNS-TEN(IDX3)   
                                                     *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX2       =   2
                                    COMPUTE  RECE02-TENSU(5 BUN-IDX2) =
                                             RECE02-TENSU(5 BUN-IDX2) +
                                    (WRK-TNS-TEN(IDX3)   
                                                     *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX3       =   3
                                    COMPUTE  RECE02-TENSU(5 BUN-IDX3) =
                                             RECE02-TENSU(5 BUN-IDX3) +
                                    (WRK-TNS-TEN(IDX3)   
                                                     *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX4       =   4
                                    COMPUTE  RECE02-TENSU(5 BUN-IDX4) =
                                             RECE02-TENSU(5 BUN-IDX4) +
                                    (WRK-TNS-TEN(IDX3)   
                                                     *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX5       =   5
                                    COMPUTE  RECE02-TENSU(5 BUN-IDX5) =
                                             RECE02-TENSU(5 BUN-IDX5) +
                                    (WRK-TNS-TEN(IDX3)   
                                                     *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX6       =   6
                                    COMPUTE  RECE02-SYUTANTEN(5)  =
                                             RECE02-SYUTANTEN(5)  +
                                    (WRK-TNS-TEN(IDX3)   
                                                     *   ACCT-ZAIKAISU)
                                  END-IF
                                  COMPUTE    RECE02-ALLTENSU(5)   =
                                             RECE02-ALLTENSU(5)   +
                                    (WRK-TNS-TEN(IDX3)
                                                     *   ACCT-ZAIKAISU)
      *      （深夜）
                   WHEN  125
                                  IF    RECE02-KHNTEN(6)   =   ZERO
                                   MOVE  WRK-TNS-TEN(IDX3)    TO
                                                     RECE02-KHNTEN(6)
                                  ELSE
                                   IF RECE02-KHNTEN(6) NOT = 
                                                     WRK-TNS-TEN(IDX3)
                                        MOVE   ZERO    TO
                                                      RECE02-KHNTEN(6)
                                        MOVE   1       TO   FLG-KHNTEN6
                                   END-IF
                                  END-IF
                                  ADD   WK-ZAIKAISU  TO
                                                      RECE02-KAISU(6)
                                  IF   RECE02-SRYYM  >= "200604"
                                    IF SRY-SRYCD(IDX3) = "112015170" OR
                                                         "112015270" OR
                                                         "112015370" OR
                                                         "112015470" OR
                                                         "112014470" OR
                                                         "112014570" OR
                                                         "112014670" OR
                                                         "112014770" OR
                                                         "112014870" OR
                                                         "112014970" OR
                                                         "112015070" OR
                                                         "112014170" OR
                                                         "112014270" OR
                                                         "112014370"
                                        COMPUTE  CNT-NYUYOJI2 =
                                                 CNT-NYUYOJI2 +
                                                 WK-ZAIKAISU
                                    END-IF
                                  END-IF
                                  IF    BUN-IDX        =   1
                                    COMPUTE  RECE02-TENSU(6 BUN-IDX) =
                                             RECE02-TENSU(6 BUN-IDX) +
                                    (WRK-TNS-TEN(IDX3)   
                                                    *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX2       =   2
                                    COMPUTE  RECE02-TENSU(6 BUN-IDX2) =
                                             RECE02-TENSU(6 BUN-IDX2) +
                                    (WRK-TNS-TEN(IDX3)   
                                                    *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX3       =   3
                                    COMPUTE  RECE02-TENSU(6 BUN-IDX3) =
                                             RECE02-TENSU(6 BUN-IDX3) +
                                    (WRK-TNS-TEN(IDX3)   
                                                    *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX4       =   4
                                    COMPUTE  RECE02-TENSU(6 BUN-IDX4) =
                                             RECE02-TENSU(6 BUN-IDX4) +
                                    (WRK-TNS-TEN(IDX3)   
                                                    *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX5       =   5
                                    COMPUTE  RECE02-TENSU(6 BUN-IDX5) =
                                             RECE02-TENSU(6 BUN-IDX5) +
                                    (WRK-TNS-TEN(IDX3)   
                                                    *   ACCT-ZAIKAISU)
                                  END-IF
                                  IF    BUN-IDX6       =   6
                                    COMPUTE  RECE02-SYUTANTEN(6)  =
                                             RECE02-SYUTANTEN(6)  +
                                    (WRK-TNS-TEN(IDX3)   
                                                    *   ACCT-ZAIKAISU)
                                  END-IF
                                  COMPUTE    RECE02-ALLTENSU(6)   =
                                             RECE02-ALLTENSU(6)   +
                                    (WRK-TNS-TEN(IDX3)
                                                    *   ACCT-ZAIKAISU)
      *      （その他）
                   WHEN  OTHER
                     IF    ACCT-ZAIKBN   =    2
                       MOVE   ZERO       TO    RECE02-KHNTEN(2)
                       MOVE   1          TO    FLG-KHNTEN2
                       IF    BUN-IDX        =   1
                            COMPUTE    RECE2G-TENSU(2 BUN-IDX)  =
                                       RECE2G-TENSU(2 BUN-IDX)  +
                                      (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                            COMPUTE    RECE2G-TENSU(2 BUN-IDX2)  =
                                       RECE2G-TENSU(2 BUN-IDX2)  +
                                      (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                            COMPUTE    RECE2G-TENSU(2 BUN-IDX3)  =
                                       RECE2G-TENSU(2 BUN-IDX3)  +
                                      (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                            COMPUTE    RECE2G-TENSU(2 BUN-IDX4)  =
                                       RECE2G-TENSU(2 BUN-IDX4)  +
                                      (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                            COMPUTE    RECE2G-TENSU(2 BUN-IDX5)  =
                                       RECE2G-TENSU(2 BUN-IDX5)  +
                                      (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                            COMPUTE    RECE2G-SYUTANTEN(2)  =
                                       RECE2G-SYUTANTEN(2)  +
                                      (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       COMPUTE         RECE2G-ALLTENSU(2)   =
                                       RECE2G-ALLTENSU(2)   +
                                      (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                 END-EVALUATE
      *    指導のレセ点数欄の編集
               WHEN    "13"
                 IF  ACCT-ZAIKBN   =    2
                   IF    BUN-IDX        =   1
                       COMPUTE    RECE2G-TENSU(7 BUN-IDX)  =
                                  RECE2G-TENSU(7 BUN-IDX)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    RECE2G-TENSU(7 BUN-IDX2)  =
                                  RECE2G-TENSU(7 BUN-IDX2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    RECE2G-TENSU(7 BUN-IDX3)  =
                                  RECE2G-TENSU(7 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    RECE2G-TENSU(7 BUN-IDX4)  =
                                  RECE2G-TENSU(7 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE    RECE2G-TENSU(7 BUN-IDX5)  =
                                  RECE2G-TENSU(7 BUN-IDX5)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE    RECE2G-SYUTANTEN(7)  =
                                  RECE2G-SYUTANTEN(7)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE        RECE2G-ALLTENSU(7)   =
                                  RECE2G-ALLTENSU(7)   +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   IF    BUN-IDX        =   1
                       COMPUTE    RECE02-TENSU(7 BUN-IDX)  =
                                  RECE02-TENSU(7 BUN-IDX)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    RECE02-TENSU(7 BUN-IDX2)  =
                                  RECE02-TENSU(7 BUN-IDX2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    RECE02-TENSU(7 BUN-IDX3)  =
                                  RECE02-TENSU(7 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    RECE02-TENSU(7 BUN-IDX4)  =
                                  RECE02-TENSU(7 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE    RECE02-TENSU(7 BUN-IDX5)  =
                                  RECE02-TENSU(7 BUN-IDX5)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE    RECE02-SYUTANTEN(7)  =
                                  RECE02-SYUTANTEN(7)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE        RECE02-ALLTENSU(7)   =
                                  RECE02-ALLTENSU(7)   +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                 END-IF
      *    在宅のレセ点数欄の編集
               WHEN    "14"
                 IF  ACCT-ZAIKBN   =    2
                   IF    BUN-IDX        =   1
                       COMPUTE    RECE2G-TENSU(12 BUN-IDX)  =
                                  RECE2G-TENSU(12 BUN-IDX)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE    RECE2G-TENSU(12 BUN-IDX2)  =
                                  RECE2G-TENSU(12 BUN-IDX2)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE    RECE2G-TENSU(12 BUN-IDX3)  =
                                  RECE2G-TENSU(12 BUN-IDX3)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE    RECE2G-TENSU(12 BUN-IDX4)  =
                                  RECE2G-TENSU(12 BUN-IDX4)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE    RECE2G-TENSU(12 BUN-IDX5)  =
                                  RECE2G-TENSU(12 BUN-IDX5)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE    RECE2G-SYUTANTEN(12)  =
                                  RECE2G-SYUTANTEN(12)  +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE        RECE2G-ALLTENSU(12)   =
                                  RECE2G-ALLTENSU(12)   +
                                 (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   MOVE      ZERO            TO   FLG-ZAITAKU
      *            往診・特別往診（時間加算）
                   IF    FLG-OSINKBN         =   1
                       MOVE         1        TO   FLG-ZAITAKU
                       ADD    WK-ZAIKAISU    TO   RECE02-KAISU(8)
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE02-TENSU(8 BUN-IDX)  =
                                     RECE02-TENSU(8 BUN-IDX)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE02-TENSU(8 BUN-IDX2)  =
                                     RECE02-TENSU(8 BUN-IDX2)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE02-TENSU(8 BUN-IDX3)  =
                                     RECE02-TENSU(8 BUN-IDX3)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE02-TENSU(8 BUN-IDX4)  =
                                     RECE02-TENSU(8 BUN-IDX4)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE02-TENSU(8 BUN-IDX5)  =
                                     RECE02-TENSU(8 BUN-IDX5)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE02-SYUTANTEN(8)  =
                                     RECE02-SYUTANTEN(8)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE02-ALLTENSU(8)   =
                                     RECE02-ALLTENSU(8)   +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            夜間
                   IF    FLG-OSINKBN         =    2
                       MOVE   1              TO   FLG-ZAITAKU
                       ADD    WK-ZAIKAISU    TO   RECE02-KAISU(9)
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE02-TENSU(9 BUN-IDX)  =
                                     RECE02-TENSU(9 BUN-IDX)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE02-TENSU(9 BUN-IDX2)  =
                                     RECE02-TENSU(9 BUN-IDX2)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE02-TENSU(9 BUN-IDX3)  =
                                     RECE02-TENSU(9 BUN-IDX3)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE02-TENSU(9 BUN-IDX4)  =
                                     RECE02-TENSU(9 BUN-IDX4)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE02-TENSU(9 BUN-IDX5)  =
                                     RECE02-TENSU(9 BUN-IDX5)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE02-SYUTANTEN(9)  =
                                     RECE02-SYUTANTEN(9)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE02-ALLTENSU(9)   =
                                     RECE02-ALLTENSU(9)   +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            深夜・緊急
                   IF    FLG-OSINKBN         =    3
                       MOVE   1              TO   FLG-ZAITAKU
                       ADD    WK-ZAIKAISU    TO   RECE02-KAISU(10)
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE02-TENSU(10 BUN-IDX)  =
                                     RECE02-TENSU(10 BUN-IDX)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE02-TENSU(10 BUN-IDX2)  =
                                     RECE02-TENSU(10 BUN-IDX2)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE02-TENSU(10 BUN-IDX3)  =
                                     RECE02-TENSU(10 BUN-IDX3)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE02-TENSU(10 BUN-IDX4)  =
                                     RECE02-TENSU(10 BUN-IDX4)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE02-TENSU(10 BUN-IDX5)  =
                                     RECE02-TENSU(10 BUN-IDX5)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE02-SYUTANTEN(10)  =
                                     RECE02-SYUTANTEN(10)  +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE02-ALLTENSU(10)   =
                                     RECE02-ALLTENSU(10)   +
                                    (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
      *            在宅患者訪問診療
                   IF (( WRK-TNS-OSINKBN(IDX3)   =     1          )  AND
                       ((SRY-SRYCD(IDX3)     NOT =    "114000110")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114001610")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114000970")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114002470")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114002970")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114000470")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114001970")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114011670")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114011970")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114000370")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114001570")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114001870")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114002070")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114011570")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114011770")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114011870")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114012070")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114017470")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114017570")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114017670")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114017770")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114017870")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114017970")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114029270")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114029370")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114029470")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114029570")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114029970")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114030070")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114030170")   AND
                        (SRY-SRYCD(IDX3)     NOT =    "114030270")))
                   OR (  FLG-OSINKBN             =     9           )
                       MOVE   1              TO   FLG-ZAITAKU
                       ADD    WK-ZAIKAISU    TO   RECE02-KAISU(11)
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE02-TENSU(11 BUN-IDX)  =
                                     RECE02-TENSU(11 BUN-IDX)  +
                           (WK-SYUTEN            *  WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE02-TENSU(11 BUN-IDX2)  =
                                     RECE02-TENSU(11 BUN-IDX2)  +
                           (WK-SYUTEN            *  WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE02-TENSU(11 BUN-IDX3)  =
                                     RECE02-TENSU(11 BUN-IDX3)  +
                           (WK-SYUTEN            *  WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE02-TENSU(11 BUN-IDX4)  =
                                     RECE02-TENSU(11 BUN-IDX4)  +
                           (WK-SYUTEN            *  WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE02-TENSU(11 BUN-IDX5)  =
                                     RECE02-TENSU(11 BUN-IDX5)  +
                           (WK-SYUTEN            *  WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE02-SYUTANTEN(11)  =
                                     RECE02-SYUTANTEN(11)  +
                           (WK-SYUTEN            *  WK-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE02-ALLTENSU(11)   =
                                     RECE02-ALLTENSU(11)   +
                           (WK-SYUTEN            *  WK-ZAIKAISU)
                   END-IF
      *            その他
                   IF    FLG-ZAITAKU    =   ZERO
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE02-TENSU(12 BUN-IDX)  =
                                     RECE02-TENSU(12 BUN-IDX)  +
                                    (WK-SYUTEN     *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE02-TENSU(12 BUN-IDX2)  =
                                     RECE02-TENSU(12 BUN-IDX2)  +
                                    (WK-SYUTEN     *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE02-TENSU(12 BUN-IDX3)  =
                                     RECE02-TENSU(12 BUN-IDX3)  +
                                    (WK-SYUTEN     *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE02-TENSU(12 BUN-IDX4)  =
                                     RECE02-TENSU(12 BUN-IDX4)  +
                                    (WK-SYUTEN     *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE02-TENSU(12 BUN-IDX5)  =
                                     RECE02-TENSU(12 BUN-IDX5)  +
                                    (WK-SYUTEN     *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE02-SYUTANTEN(12)  =
                                     RECE02-SYUTANTEN(12)  +
                                    (WK-SYUTEN     *   WK-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE02-ALLTENSU(12)   =
                                     RECE02-ALLTENSU(12)   +
                                    (WK-SYUTEN     *   WK-ZAIKAISU)
                   END-IF
      *            薬剤
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(13 BUN-IDX)  =
                                 RECE02-TENSU(13 BUN-IDX)  +
                                (WK-KIZAITEN *   WK-ZAIKAISU)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(13 BUN-IDX2)  =
                                 RECE02-TENSU(13 BUN-IDX2)  +
                                (WK-KIZAITEN *   WK-ZAIKAISU)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(13 BUN-IDX3)  =
                                 RECE02-TENSU(13 BUN-IDX3)  +
                                (WK-KIZAITEN *   WK-ZAIKAISU)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(13 BUN-IDX4)  =
                                 RECE02-TENSU(13 BUN-IDX4)  +
                                (WK-KIZAITEN *   WK-ZAIKAISU)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(13 BUN-IDX5)  =
                                 RECE02-TENSU(13 BUN-IDX5)  +
                                (WK-KIZAITEN *   WK-ZAIKAISU)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(13)  =
                                 RECE02-SYUTANTEN(13)  +
                                (WK-KIZAITEN *   WK-ZAIKAISU)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(13)   =
                                 RECE02-ALLTENSU(13)   +
                                (WK-KIZAITEN *   WK-ZAIKAISU)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                 END-IF
      *    投薬のレセ点数欄の編集
               WHEN    "21"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF    SRY-SRYCD(IDX3)  =  "630010002"
                                            OR "630010005"
                                            OR "630010006"
                                            OR "630010007"
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE02-TENSU(14 BUN-IDX)  =
                                     RECE02-TENSU(14 BUN-IDX)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE02-TENSU(14 BUN-IDX2)  =
                                     RECE02-TENSU(14 BUN-IDX2)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE02-TENSU(14 BUN-IDX3)  =
                                     RECE02-TENSU(14 BUN-IDX3)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE02-TENSU(14 BUN-IDX4)  =
                                     RECE02-TENSU(14 BUN-IDX4)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE02-TENSU(14 BUN-IDX5)  =
                                     RECE02-TENSU(14 BUN-IDX5)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE02-SYUTANTEN(14)  =
                                     RECE02-SYUTANTEN(14)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE02-ALLTENSU(14)   =
                                     RECE02-ALLTENSU(14)   -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                       ADD   WK-ZAIKAISU       TO   RECE02-KAISU(14)
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE02-TENSU(14 BUN-IDX)  =
                                     RECE02-TENSU(14 BUN-IDX)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE02-TENSU(14 BUN-IDX2)  =
                                     RECE02-TENSU(14 BUN-IDX2)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE02-TENSU(14 BUN-IDX3)  =
                                     RECE02-TENSU(14 BUN-IDX3)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE02-TENSU(14 BUN-IDX4)  =
                                     RECE02-TENSU(14 BUN-IDX4)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE02-TENSU(14 BUN-IDX5)  =
                                     RECE02-TENSU(14 BUN-IDX5)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE02-SYUTANTEN(14)  =
                                     RECE02-SYUTANTEN(14)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE02-ALLTENSU(14)   =
                                     RECE02-ALLTENSU(14)   +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   ELSE
                     IF   SRY-SRYCD(IDX3)     =    "099209901"
                       ADD   WK-ZAIKAISU       TO   RECE02-KAISU(14)
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE02-TENSU(14 BUN-IDX)  =
                                     RECE02-TENSU(14 BUN-IDX)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE02-TENSU(14 BUN-IDX2)  =
                                     RECE02-TENSU(14 BUN-IDX2)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE02-TENSU(14 BUN-IDX3)  =
                                     RECE02-TENSU(14 BUN-IDX3)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE02-TENSU(14 BUN-IDX4)  =
                                     RECE02-TENSU(14 BUN-IDX4)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE02-TENSU(14 BUN-IDX5)  =
                                     RECE02-TENSU(14 BUN-IDX5)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE02-SYUTANTEN(14)  =
                                     RECE02-SYUTANTEN(14)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE02-ALLTENSU(14)   =
                                     RECE02-ALLTENSU(14)   +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE   
                       IF    RECE02-KHNTEN(15)   =   ZERO
                          MOVE  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(15)
                       ELSE
                          IF   RECE02-KHNTEN(15) NOT = WRK-TNS-TEN(IDX3)
                               MOVE   ZERO    TO    RECE02-KHNTEN(15)
                               MOVE   1       TO    FLG-KHNTEN15
                          END-IF
                       END-IF
                       ADD    WK-ZAIKAISU    TO   RECE02-KAISU(15)
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE02-TENSU(15 BUN-IDX)  =
                                     RECE02-TENSU(15 BUN-IDX)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE02-TENSU(15 BUN-IDX2)  =
                                     RECE02-TENSU(15 BUN-IDX2)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE02-TENSU(15 BUN-IDX3)  =
                                     RECE02-TENSU(15 BUN-IDX3)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE02-TENSU(15 BUN-IDX4)  =
                                     RECE02-TENSU(15 BUN-IDX4)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE02-TENSU(15 BUN-IDX5)  =
                                     RECE02-TENSU(15 BUN-IDX5)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE02-SYUTANTEN(15)  =
                                     RECE02-SYUTANTEN(15)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE02-ALLTENSU(15)   =
                                     RECE02-ALLTENSU(15)   +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                     END-IF   
                   END-IF
               WHEN    "22"
                 IF    SRY-SRYCD(IDX3)      =  "630010005"
                                            OR "630010006"
                                            OR "630010007"
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(16 BUN-IDX)  =
                                 RECE02-TENSU(16 BUN-IDX)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(16 BUN-IDX2)  =
                                 RECE02-TENSU(16 BUN-IDX2)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(16 BUN-IDX3)  =
                                 RECE02-TENSU(16 BUN-IDX3)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(16 BUN-IDX4)  =
                                 RECE02-TENSU(16 BUN-IDX4)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(16 BUN-IDX5)  =
                                 RECE02-TENSU(16 BUN-IDX5)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(16)  =
                                 RECE02-SYUTANTEN(16)  -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(16)   =
                                 RECE02-ALLTENSU(16)   -
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                 ELSE
                   ADD    WK-ZAIKAISU    TO   RECE02-KAISU(16)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(16 BUN-IDX)  =
                                 RECE02-TENSU(16 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(16 BUN-IDX2)  =
                                 RECE02-TENSU(16 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(16 BUN-IDX3)  =
                                 RECE02-TENSU(16 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(16 BUN-IDX4)  =
                                 RECE02-TENSU(16 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(16 BUN-IDX5)  =
                                 RECE02-TENSU(16 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(16)  =
                                 RECE02-SYUTANTEN(16)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(16)   =
                                 RECE02-ALLTENSU(16)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                 END-IF
               WHEN    "23"
                   IF    (SRY-SRYCD(IDX3) (1:1)  = "6" OR "S" OR "8"
                                                       OR "7"       )
                   OR    (SRY-SRYCD(IDX3) (1:3)  = "001" OR "008"   
                                                         OR "059"   )
                   OR    (SRY-SRYCD(IDX3) (1:7)  = "0992000"        )
                   OR    (SRY-SRYCD(IDX3)        = "099999903"      )
                     IF    SRY-SRYCD(IDX3)  =  "630010005"
                                            OR "630010006"
                                            OR "630010007"
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE02-TENSU(17 BUN-IDX)  =
                                     RECE02-TENSU(17 BUN-IDX)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE02-TENSU(17 BUN-IDX2)  =
                                     RECE02-TENSU(17 BUN-IDX2)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE02-TENSU(17 BUN-IDX3)  =
                                     RECE02-TENSU(17 BUN-IDX3)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE02-TENSU(17 BUN-IDX4)  =
                                     RECE02-TENSU(17 BUN-IDX4)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE02-TENSU(17 BUN-IDX5)  =
                                     RECE02-TENSU(17 BUN-IDX5)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE02-SYUTANTEN(17)  =
                                     RECE02-SYUTANTEN(17)  -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE02-ALLTENSU(17)   =
                                     RECE02-ALLTENSU(17)   -
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                     ELSE
                       ADD    WK-ZAIKAISU    TO   RECE02-KAISU(17)
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE02-TENSU(17 BUN-IDX)  =
                                     RECE02-TENSU(17 BUN-IDX)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE02-TENSU(17 BUN-IDX2)  =
                                     RECE02-TENSU(17 BUN-IDX2)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE02-TENSU(17 BUN-IDX3)  =
                                     RECE02-TENSU(17 BUN-IDX3)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE02-TENSU(17 BUN-IDX4)  =
                                     RECE02-TENSU(17 BUN-IDX4)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE02-TENSU(17 BUN-IDX5)  =
                                     RECE02-TENSU(17 BUN-IDX5)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE02-SYUTANTEN(17)  =
                                     RECE02-SYUTANTEN(17)  +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE02-ALLTENSU(17)   =
                                     RECE02-ALLTENSU(17)   +
                                    (WK-ZAITEN   *   WK-ZAIKAISU)
                     END-IF
                   ELSE
                       IF    RECE02-KHNTEN(18)   =   ZERO
                          MOVE  WRK-TNS-TEN(IDX3) TO  RECE02-KHNTEN(18)
                       ELSE
                          IF   RECE02-KHNTEN(18) NOT = WRK-TNS-TEN(IDX3)
                               MOVE   ZERO    TO    RECE02-KHNTEN(18)
                               MOVE   1       TO    FLG-KHNTEN18
                          END-IF
                       END-IF
                       ADD    WK-ZAIKAISU    TO   RECE02-KAISU(18)
                       IF    BUN-IDX        =   1
                           COMPUTE   RECE02-TENSU(18 BUN-IDX)  =
                                     RECE02-TENSU(18 BUN-IDX)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX2       =   2
                           COMPUTE   RECE02-TENSU(18 BUN-IDX2)  =
                                     RECE02-TENSU(18 BUN-IDX2)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX3       =   3
                           COMPUTE   RECE02-TENSU(18 BUN-IDX3)  =
                                     RECE02-TENSU(18 BUN-IDX3)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX4       =   4
                           COMPUTE   RECE02-TENSU(18 BUN-IDX4)  =
                                     RECE02-TENSU(18 BUN-IDX4)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX5       =   5
                           COMPUTE   RECE02-TENSU(18 BUN-IDX5)  =
                                     RECE02-TENSU(18 BUN-IDX5)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       IF    BUN-IDX6       =   6
                           COMPUTE   RECE02-SYUTANTEN(18)  =
                                     RECE02-SYUTANTEN(18)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                       END-IF
                       COMPUTE       RECE02-ALLTENSU(18)   =
                                     RECE02-ALLTENSU(18)   +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
      *    処方のレセ点数欄の編集
               WHEN    "25"
                   IF  SRY-SRYCD(IDX3) = "120002170" OR "120002270" OR
                                         "120003170" OR "120003370" OR
                                         "120003870" OR
                                         "120004070" OR "120004170" OR
                                         "120004370" OR "120004470"
                      COMPUTE  WRK-SYOHOU-KAISU  =  WRK-SYOHOU-KAISU
                                                 +  ACCT-ZAIKAISU
                   END-IF
                   IF    WK-ZAITEN   NOT =  ZERO
                     IF    RECE02-KHNTEN(19)     = ZERO
                      MOVE  WK-ZAITEN     TO   RECE02-KHNTEN(19)
                     ELSE
                      IF   RECE02-KHNTEN(19) NOT = WK-ZAITEN
                            MOVE   ZERO   TO   RECE02-KHNTEN(19)
                            MOVE   1      TO   FLG-KHNTEN19
                      END-IF
                     END-IF
                   END-IF
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    ACCT-ZAIKAISU   TO    RECE02-KAISU(19)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(19 BUN-IDX)  =
                                 RECE02-TENSU(19 BUN-IDX)  +
                                (WK-ZAITEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(19 BUN-IDX2)  =
                                 RECE02-TENSU(19 BUN-IDX2)  +
                                (WK-ZAITEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(19 BUN-IDX3)  =
                                 RECE02-TENSU(19 BUN-IDX3)  +
                                (WK-ZAITEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(19 BUN-IDX4)  =
                                 RECE02-TENSU(19 BUN-IDX4)  +
                                (WK-ZAITEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(19 BUN-IDX5)  =
                                 RECE02-TENSU(19 BUN-IDX5)  +
                                (WK-ZAITEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(19)  =
                                 RECE02-SYUTANTEN(19)  +
                                (WK-ZAITEN   *   ACCT-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(19)   =
                                 RECE02-ALLTENSU(19)   +
                                (WK-ZAITEN   *   ACCT-ZAIKAISU)
      *    麻毒のレセ点数欄の編集
               WHEN    "26"
                   IF  (SRY-SRYCD(IDX3)(1:1)   = "S" OR "8" )
                   OR  (SRY-SRYCD(IDX3)(1:3)   = "008"      )
                   OR  (SRY-SRYCD(IDX3)        = "099999903")
                      CONTINUE
                   ELSE
                      ADD    WK-ZAIKAISU     TO    RECE02-KAISU(20)
                   END-IF
                   IF SRY-SRYCD(IDX3)      =    "120001310"
                    COMPUTE WRK-MADOKU-SHOHO = WRK-MADOKU-SHOHO +
                                               WK-ZAIKAISU 
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(20 BUN-IDX)  =
                                 RECE02-TENSU(20 BUN-IDX)  +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(20 BUN-IDX2)  =
                                 RECE02-TENSU(20 BUN-IDX2)  +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(20 BUN-IDX3)  =
                                 RECE02-TENSU(20 BUN-IDX3)  +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(20 BUN-IDX4)  =
                                 RECE02-TENSU(20 BUN-IDX4)  +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(20 BUN-IDX5)  =
                                 RECE02-TENSU(20 BUN-IDX5)  +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(20)  =
                                 RECE02-SYUTANTEN(20)  +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(20)   =
                                 RECE02-ALLTENSU(20)   +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
      *    調基のレセ点数欄の編集
               WHEN    "27"
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(21 BUN-IDX)  =
                                 RECE02-TENSU(21 BUN-IDX)  +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(21 BUN-IDX2)  =
                                 RECE02-TENSU(21 BUN-IDX2)  +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(21 BUN-IDX3)  =
                                 RECE02-TENSU(21 BUN-IDX3)  +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(21 BUN-IDX4)  =
                                 RECE02-TENSU(21 BUN-IDX4)  +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(21 BUN-IDX5)  =
                                 RECE02-TENSU(21 BUN-IDX5)  +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(21)  =
                                 RECE02-SYUTANTEN(21)  +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(21)   =
                                 RECE02-ALLTENSU(21)   +
                      (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
      *    皮下筋肉内注射のレセ点数欄の編集
               WHEN    "31"
                   ADD    WK-ZAIKAISU     TO   RECE02-KAISU(22)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(22 BUN-IDX)  =
                                 RECE02-TENSU(22 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(22 BUN-IDX2)  =
                                 RECE02-TENSU(22 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(22 BUN-IDX3)  =
                                 RECE02-TENSU(22 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(22 BUN-IDX4)  =
                                 RECE02-TENSU(22 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(22 BUN-IDX5)  =
                                 RECE02-TENSU(22 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(22)  =
                                 RECE02-SYUTANTEN(22)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(22)   =
                                 RECE02-ALLTENSU(22)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
      *    静脈内注射のレセ点数欄の編集
               WHEN    "32"
                   ADD    WK-ZAIKAISU     TO   RECE02-KAISU(23)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(23 BUN-IDX)  =
                                 RECE02-TENSU(23 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(23 BUN-IDX2)  =
                                 RECE02-TENSU(23 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(23 BUN-IDX3)  =
                                 RECE02-TENSU(23 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(23 BUN-IDX4)  =
                                 RECE02-TENSU(23 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(23 BUN-IDX5)  =
                                 RECE02-TENSU(23 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(23)  =
                                 RECE02-SYUTANTEN(23)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(23)   =
                                 RECE02-ALLTENSU(23)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
      *    その他注射のレセ点数欄の編集
               WHEN    "33"
                   ADD    WK-ZAIKAISU     TO   RECE02-KAISU(24)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(24 BUN-IDX)  =
                                 RECE02-TENSU(24 BUN-IDX)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(24 BUN-IDX2)  =
                                 RECE02-TENSU(24 BUN-IDX2)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(24 BUN-IDX3)  =
                                 RECE02-TENSU(24 BUN-IDX3)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(24 BUN-IDX4)  =
                                 RECE02-TENSU(24 BUN-IDX4)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(24 BUN-IDX5)  =
                                 RECE02-TENSU(24 BUN-IDX5)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(24)  =
                                 RECE02-SYUTANTEN(24)  +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(24)   =
                                 RECE02-ALLTENSU(24)   +
                                (WK-ZAITEN   *   WK-ZAIKAISU)
      *    処置のレセ点数欄の編集
               WHEN    "40"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE02-KAISU(25)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(25 BUN-IDX)  =
                                 RECE02-TENSU(25 BUN-IDX)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(25 BUN-IDX2)  =
                                 RECE02-TENSU(25 BUN-IDX2)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(25 BUN-IDX3)  =
                                 RECE02-TENSU(25 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(25 BUN-IDX4)  =
                                 RECE02-TENSU(25 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(25 BUN-IDX5)  =
                                 RECE02-TENSU(25 BUN-IDX5)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(25)  =
                                 RECE02-SYUTANTEN(25)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(25)   =
                                 RECE02-ALLTENSU(25)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(26 BUN-IDX)  =
                                 RECE02-TENSU(26 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(26 BUN-IDX2)  =
                                 RECE02-TENSU(26 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(26 BUN-IDX3)  =
                                 RECE02-TENSU(26 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(26 BUN-IDX4)  =
                                 RECE02-TENSU(26 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(26 BUN-IDX5)  =
                                 RECE02-TENSU(26 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(26)  =
                                 RECE02-SYUTANTEN(26)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(26)   =
                                 RECE02-ALLTENSU(26)   +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
      *    手術のレセ点数欄の編集
               WHEN    "50"
               WHEN    "54"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE02-KAISU(27)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(27 BUN-IDX)  =
                                 RECE02-TENSU(27 BUN-IDX)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(27 BUN-IDX2)  =
                                 RECE02-TENSU(27 BUN-IDX2)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(27 BUN-IDX3)  =
                                 RECE02-TENSU(27 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(27 BUN-IDX4)  =
                                 RECE02-TENSU(27 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(27 BUN-IDX5)  =
                                 RECE02-TENSU(27 BUN-IDX5)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(27)  =
                                 RECE02-SYUTANTEN(27)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(27)   =
                                 RECE02-ALLTENSU(27)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(28 BUN-IDX)  =
                                 RECE02-TENSU(28 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(28 BUN-IDX2)  =
                                 RECE02-TENSU(28 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(28 BUN-IDX3)  =
                                 RECE02-TENSU(28 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(28 BUN-IDX4)  =
                                 RECE02-TENSU(28 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(28 BUN-IDX5)  =
                                 RECE02-TENSU(28 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(28)  =
                                 RECE02-SYUTANTEN(28)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(28)   =
                                 RECE02-ALLTENSU(28)   +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
      *    検査のレセ点数欄の編集
               WHEN    "60"
               WHEN    "64"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE02-KAISU(29)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(29 BUN-IDX)  =
                                 RECE02-TENSU(29 BUN-IDX)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(29 BUN-IDX2)  =
                                 RECE02-TENSU(29 BUN-IDX2)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(29 BUN-IDX3)  =
                                 RECE02-TENSU(29 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(29 BUN-IDX4)  =
                                 RECE02-TENSU(29 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(29 BUN-IDX5)  =
                                 RECE02-TENSU(29 BUN-IDX5)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(29)  =
                                 RECE02-SYUTANTEN(29)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(29)   =
                                 RECE02-ALLTENSU(29)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    WRK-TNS-KNSJISKBN(IDX3)    =   2
                         COMPUTE   RECE02-KAISU(29)  =
                                   RECE02-KAISU(29)  -  
                                   WK-ZAIKAISU
                   END-IF
                   IF    WRK-TNS-SRYCD(IDX3)  =   "160101210"     OR
                                                  "160095710"     OR
                                                  "160095810"
                         IF   RECE02-KAISU(29)  NOT =  ZERO
                              COMPUTE   RECE02-KAISU(29)  =
                                        RECE02-KAISU(29)  -   
                                        WK-ZAIKAISU
                         END-IF
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(30 BUN-IDX)  =
                                 RECE02-TENSU(30 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(30 BUN-IDX2)  =
                                 RECE02-TENSU(30 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(30 BUN-IDX3)  =
                                 RECE02-TENSU(30 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(30 BUN-IDX4)  =
                                 RECE02-TENSU(30 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(30 BUN-IDX5)  =
                                 RECE02-TENSU(30 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(30)  =
                                 RECE02-SYUTANTEN(30)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(30)   =
                                 RECE02-ALLTENSU(30)   +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
      *    画像診断のレセ点数欄の編集
               WHEN    "70"
                   IF    WK-SYUTEN       NOT =   ZERO
                       ADD    WK-ZAIKAISU    TO   RECE02-KAISU(31)
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(31 BUN-IDX)  =
                                 RECE02-TENSU(31 BUN-IDX)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(31 BUN-IDX2)  =
                                 RECE02-TENSU(31 BUN-IDX2)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(31 BUN-IDX3)  =
                                 RECE02-TENSU(31 BUN-IDX3)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(31 BUN-IDX4)  =
                                 RECE02-TENSU(31 BUN-IDX4)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(31 BUN-IDX5)  =
                                 RECE02-TENSU(31 BUN-IDX5)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(31)  =
                                 RECE02-SYUTANTEN(31)  +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(31)   =
                                 RECE02-ALLTENSU(31)   +
                                (WK-SYUTEN   *   WK-ZAIKAISU)
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(32 BUN-IDX)  =
                                 RECE02-TENSU(32 BUN-IDX)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(32 BUN-IDX2)  =
                                 RECE02-TENSU(32 BUN-IDX2)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(32 BUN-IDX3)  =
                                 RECE02-TENSU(32 BUN-IDX3)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(32 BUN-IDX4)  =
                                 RECE02-TENSU(32 BUN-IDX4)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(32 BUN-IDX5)  =
                                 RECE02-TENSU(32 BUN-IDX5)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(32)  =
                                 RECE02-SYUTANTEN(32)  +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(32)   =
                                 RECE02-ALLTENSU(32)   +
                                (WK-YKZTEN   *   WK-ZAIKAISU)
      *    その他のレセ点数欄の編集
               WHEN    "80"
                   IF  SRY-SRYCD(IDX3) =  "120002470"
                                       OR "120002570"
                                       OR "120003270"
                                       OR "120003470"
                                       OR "120003570"
                                       OR "120003970"
                                       OR "120004270"
                                       OR "120004570"
                      COMPUTE  WRK-SYOSEN-KAISU  =  WRK-SYOSEN-KAISU
                                                 +  ACCT-ZAIKAISU
                   END-IF
                   IF SRY-SRYCD(IDX3)      =    "120002710"    OR
                                                "120002810"    OR
                                                "120002910"    OR
                                                "120003010"    OR
                                                "120003710"    OR
                                                "120002470"    OR
                                                "120002570"    OR
                                                "120003270"    OR
                                                "120003470"    OR
                                                "120003570"    OR
                                                "120003970"    OR
                                                "120004270"    OR
                                                "120004570"    OR
                                                "120004610"
                           ADD  ACCT-ZAIKAISU  TO  RECE02-KAISU(33)
                   END-IF
                   IF    BUN-IDX        =   1
                       IF   SRY-SRYCD(IDX3)   =  "120002710"    OR
                                                 "120002810"    OR
                                                 "120002910"    OR
                                                 "120003010"    OR
                                                 "120003710"    OR
                                                 "120002470"    OR
                                                 "120002570"    OR
                                                 "120003270"    OR
                                                 "120003470"    OR
                                                 "120003570"    OR
                                                 "120003970"    OR
                                                 "120004270"    OR
                                                 "120004570"    OR
                                                 "120004610"
                           COMPUTE   RECE02-TENSU(33 BUN-IDX)  =
                                     RECE02-TENSU(33 BUN-IDX)  +
                                    (WK-ZAITEN  *   ACCT-ZAIKAISU)
                       ELSE
                         COMPUTE     RECE02-TENSU(34 BUN-IDX)  =
                                     RECE02-TENSU(34 BUN-IDX)  +
                                    (WK-SYUTEN  *   ACCT-ZAIKAISU)
                         IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                           COMPUTE   RECE02-TENSU(7 BUN-IDX)  =
                                     RECE02-TENSU(7 BUN-IDX)  +
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE02-TENSU(34 BUN-IDX) =
                                     RECE02-TENSU(34 BUN-IDX) -
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                   END-IF
                   IF    BUN-IDX2       =   2
                       IF   SRY-SRYCD(IDX3)   =  "120002710"    OR
                                                 "120002810"    OR
                                                 "120002910"    OR
                                                 "120003010"    OR
                                                 "120003710"    OR
                                                 "120002470"    OR
                                                 "120002570"    OR
                                                 "120003270"    OR
                                                 "120003470"    OR
                                                 "120003570"    OR
                                                 "120003970"    OR
                                                 "120004270"    OR
                                                 "120004570"    OR
                                                 "120004610"
                           COMPUTE   RECE02-TENSU(33 BUN-IDX2)  =
                                     RECE02-TENSU(33 BUN-IDX2)  +
                                    (WK-ZAITEN  *   ACCT-ZAIKAISU)
                       ELSE
                         COMPUTE     RECE02-TENSU(34 BUN-IDX2)  =
                                     RECE02-TENSU(34 BUN-IDX2)  +
                                    (WK-SYUTEN  *   ACCT-ZAIKAISU)
                         IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                           COMPUTE   RECE02-TENSU(7 BUN-IDX2)  =
                                     RECE02-TENSU(7 BUN-IDX2)  +
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE02-TENSU(34 BUN-IDX2) =
                                     RECE02-TENSU(34 BUN-IDX2) -
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                   END-IF
                   IF    BUN-IDX3       =   3
                       IF   SRY-SRYCD(IDX3)   =  "120002710"    OR
                                                 "120002810"    OR
                                                 "120002910"    OR
                                                 "120003010"    OR
                                                 "120003710"    OR
                                                 "120002470"    OR
                                                 "120002570"    OR
                                                 "120003270"    OR
                                                 "120003470"    OR
                                                 "120003570"    OR
                                                 "120003970"    OR
                                                 "120004270"    OR
                                                 "120004570"    OR
                                                 "120004610"
                           COMPUTE   RECE02-TENSU(33 BUN-IDX3)  =
                                     RECE02-TENSU(33 BUN-IDX3)  +
                                    (WK-ZAITEN  *   ACCT-ZAIKAISU)
                       ELSE
                         COMPUTE     RECE02-TENSU(34 BUN-IDX3)  =
                                     RECE02-TENSU(34 BUN-IDX3)  +
                                    (WK-SYUTEN  *   ACCT-ZAIKAISU)
                         IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                           COMPUTE   RECE02-TENSU(7 BUN-IDX3)  =
                                     RECE02-TENSU(7 BUN-IDX3)  +
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE02-TENSU(34 BUN-IDX3) =
                                     RECE02-TENSU(34 BUN-IDX3) -
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                   END-IF
                   IF    BUN-IDX4       =   4
                       IF   SRY-SRYCD(IDX3)   =  "120002710"    OR
                                                 "120002810"    OR
                                                 "120002910"    OR
                                                 "120003010"    OR
                                                 "120003710"    OR
                                                 "120002470"    OR
                                                 "120002570"    OR
                                                 "120003270"    OR
                                                 "120003470"    OR
                                                 "120003570"    OR
                                                 "120003970"    OR
                                                 "120004270"    OR
                                                 "120004570"    OR
                                                 "120004610"
                           COMPUTE   RECE02-TENSU(33 BUN-IDX4)  =
                                     RECE02-TENSU(33 BUN-IDX4)  +
                                    (WK-ZAITEN  *   ACCT-ZAIKAISU)
                       ELSE
                         COMPUTE     RECE02-TENSU(34 BUN-IDX4)  =
                                     RECE02-TENSU(34 BUN-IDX4)  +
                                    (WK-SYUTEN  *   ACCT-ZAIKAISU)
                         IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                           COMPUTE   RECE02-TENSU(7 BUN-IDX4)  =
                                     RECE02-TENSU(7 BUN-IDX4)  +
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE02-TENSU(34 BUN-IDX4) =
                                     RECE02-TENSU(34 BUN-IDX4) -
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                   END-IF
                   IF    BUN-IDX5       =   5
                       IF   SRY-SRYCD(IDX3)   =  "120002710"    OR
                                                 "120002810"    OR
                                                 "120002910"    OR
                                                 "120003010"    OR
                                                 "120003710"    OR
                                                 "120002470"    OR
                                                 "120002570"    OR
                                                 "120003270"    OR
                                                 "120003470"    OR
                                                 "120003570"    OR
                                                 "120003970"    OR
                                                 "120004270"    OR
                                                 "120004570"    OR
                                                 "120004610"
                           COMPUTE   RECE02-TENSU(33 BUN-IDX5)  =
                                     RECE02-TENSU(33 BUN-IDX5)  +
                                    (WK-ZAITEN  *   ACCT-ZAIKAISU)
                       ELSE
                         COMPUTE     RECE02-TENSU(34 BUN-IDX5)  =
                                     RECE02-TENSU(34 BUN-IDX5)  +
                                    (WK-SYUTEN  *   ACCT-ZAIKAISU)
                         IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                           COMPUTE   RECE02-TENSU(7 BUN-IDX5)  =
                                     RECE02-TENSU(7 BUN-IDX5)  +
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE02-TENSU(34 BUN-IDX5) =
                                     RECE02-TENSU(34 BUN-IDX5) -
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                   END-IF
                   IF    BUN-IDX6       =   6
                       IF   SRY-SRYCD(IDX3)   =  "120002710"    OR
                                                 "120002810"    OR
                                                 "120002910"    OR
                                                 "120003010"    OR
                                                 "120003710"    OR
                                                 "120002470"    OR
                                                 "120002570"    OR
                                                 "120003270"    OR
                                                 "120003470"    OR
                                                 "120003570"    OR
                                                 "120003970"    OR
                                                 "120004270"    OR
                                                 "120004570"    OR
                                                 "120004610"
                           COMPUTE   RECE02-SYUTANTEN(33)  =
                                     RECE02-SYUTANTEN(33)  +
                                    (WK-ZAITEN  *   ACCT-ZAIKAISU)
                       ELSE
                         COMPUTE     RECE02-SYUTANTEN(34)  =
                                     RECE02-SYUTANTEN(34)  +
                                    (WK-SYUTEN  *   ACCT-ZAIKAISU)
                         IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                           COMPUTE   RECE02-SYUTANTEN(7)  =
                                     RECE02-SYUTANTEN(7)  +
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE02-SYUTANTEN(34)  =
                                     RECE02-SYUTANTEN(34)  -
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                         END-IF
                       END-IF
                   END-IF
                   IF   SRY-SRYCD(IDX3)   =      "120002710"    OR
                                                 "120002810"    OR
                                                 "120002910"    OR
                                                 "120003010"    OR
                                                 "120003710"    OR
                                                 "120002470"    OR
                                                 "120002570"    OR
                                                 "120003270"    OR
                                                 "120003470"    OR
                                                 "120003570"    OR
                                                 "120003970"    OR
                                                 "120004270"    OR
                                                 "120004570"    OR
                                                 "120004610"
                           COMPUTE   RECE02-ALLTENSU(33)   =
                                     RECE02-ALLTENSU(33)   +
                                    (WK-ZAITEN  *   ACCT-ZAIKAISU)
                   ELSE
                         COMPUTE     RECE02-ALLTENSU(34)   =
                                     RECE02-ALLTENSU(34)   +
                                    (WK-SYUTEN  *   ACCT-ZAIKAISU)
                         IF    WRK-TNS-GAITENTTLKBN(IDX3)   =    130
                           COMPUTE   RECE02-ALLTENSU(7)   =
                                     RECE02-ALLTENSU(7)   +
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                           COMPUTE   RECE02-ALLTENSU(34)  =
                                     RECE02-ALLTENSU(34)  -
                           (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
                         END-IF
                   END-IF
                   IF    BUN-IDX        =   1
                       COMPUTE   RECE02-TENSU(35 BUN-IDX)  =
                                 RECE02-TENSU(35 BUN-IDX)  +
                                (WK-YKZTEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX2       =   2
                       COMPUTE   RECE02-TENSU(35 BUN-IDX2)  =
                                 RECE02-TENSU(35 BUN-IDX2)  +
                                (WK-YKZTEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX3       =   3
                       COMPUTE   RECE02-TENSU(35 BUN-IDX3)  =
                                 RECE02-TENSU(35 BUN-IDX3)  +
                                (WK-YKZTEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX4       =   4
                       COMPUTE   RECE02-TENSU(35 BUN-IDX4)  =
                                 RECE02-TENSU(35 BUN-IDX4)  +
                                (WK-YKZTEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX5       =   5
                       COMPUTE   RECE02-TENSU(35 BUN-IDX5)  =
                                 RECE02-TENSU(35 BUN-IDX5)  +
                                (WK-YKZTEN   *   ACCT-ZAIKAISU)
                   END-IF
                   IF    BUN-IDX6       =   6
                       COMPUTE   RECE02-SYUTANTEN(35)  =
                                 RECE02-SYUTANTEN(35)  +
                                (WK-YKZTEN   *   ACCT-ZAIKAISU)
                   END-IF
                   COMPUTE       RECE02-ALLTENSU(35)   =
                                 RECE02-ALLTENSU(35)   +
                                (WK-YKZTEN   *   ACCT-ZAIKAISU)
           END-EVALUATE
           .
      *
       2104421-RECE-LEFT-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *
      *****************************************************************
       21044211-RECE-LEFT12-HEN-SEC               SECTION.
      *
           IF ( WRK-TNS-CHUKSNTUBAN(IDX3)  NOT = "0"   )
           OR ( SRY-SRYCD(IDX3)(1:1)       NOT = "1"   )
           OR ( SRY-SRYCD(IDX3) = "112021970"          )
             CONTINUE
           ELSE
             ADD   WK-ZAIKAISU      TO   RECE02-KAISU(2)
             IF    SRY-SRYCD(IDX3)   =   "112015810"
                                    OR   "112017010"
                                    OR   "112015950"
                                    OR   "112017150"
                                    OR   "112023550"
                                    OR   "112023850"
                                    OR   "112016210"
                                    OR   "112016410"
                                    OR   "112017610"
                 ADD  WK-ZAIKAISU   TO   CNT-SAISIN-DOUJITU
             ELSE
               IF  SRY-SRYCD(IDX3)   =   "112023210"
                 ADD  WK-ZAIKAISU   TO   CNT-SAISIN-ONLINE
               ELSE
                 ADD  WK-ZAIKAISU   TO   CNT-SAISIN-ETC
               END-IF
             END-IF
           END-IF
      *
           IF  SRY-SRYCD(IDX3)  =  "112000970"
                               OR  "112006270"
               COMPUTE  CNT-NYUYOJI   =  CNT-NYUYOJI
                                      +  WK-ZAIKAISU
               COMPUTE  CNT-NYUYOJI2  =  CNT-NYUYOJI2
                                      +  WK-ZAIKAISU
           END-IF
           IF  SRY-SRYCD(IDX3)  =  "112016070"
               COMPUTE  CNT-JIKANTAI1 =  CNT-JIKANTAI1
                                      +  WK-ZAIKAISU
           END-IF
           IF  SRY-SRYCD(IDX3)  =  "112015670"
               COMPUTE  CNT-KOKENKSN  =  CNT-KOKENKSN
                                      +  WK-ZAIKAISU
           END-IF
           IF  SRY-SRYCD(IDX3)  =  "112016170"
               COMPUTE  CNT-JIKANTAI3 =  CNT-JIKANTAI3
                                      +  WK-ZAIKAISU
           END-IF
           IF  SRY-SRYCD(IDX3)  =  "112015770"
               COMPUTE  CNT-MESAIKSN  =  CNT-MESAIKSN
                                      +  WK-ZAIKAISU
           END-IF
           IF  SRY-SRYCD(IDX3)  =  "112017270"
               COMPUTE  CNT-CHIHOKATU =  CNT-CHIHOKATU
                                      +  WK-ZAIKAISU
           END-IF
           IF  SRY-SRYCD(IDX3)  =  "112017570"
               COMPUTE  CNT-CHIHOKAT2 =  CNT-CHIHOKAT2
                                      +  WK-ZAIKAISU
           END-IF
           IF  SRY-SRYCD(IDX3)  =  "112021770"
               COMPUTE  CNT-CHIHOKAT3 =  CNT-CHIHOKAT3
                                      +  WK-ZAIKAISU
           END-IF
           IF  SRY-SRYCD(IDX3)  =  "112021870"
               COMPUTE  CNT-CHIHOKAT4 =  CNT-CHIHOKAT4
                                      +  WK-ZAIKAISU
           END-IF
           IF  SRY-SRYCD(IDX3)  =  "112021970"
               COMPUTE  CNT-YAKRENKEI =  CNT-YAKRENKEI
                                      +  WK-ZAIKAISU
           END-IF
           IF  SRY-SRYCD(IDX3)  =  "112022070"
               COMPUTE  CNT-NINPU     =  CNT-NINPU
                                      +  WK-ZAIKAISU
           END-IF
           IF  SRY-SRYCD(IDX3)  =  "112022870"
               COMPUTE  CNT-NINPU2    =  CNT-NINPU2
                                      +  WK-ZAIKAISU
           END-IF
      *
           IF  SRY-SRYCD(IDX3)  =  "112000970"
                               OR  "112006270"
              IF   FLG-YOJI-ARI  =  ZERO
                ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                MOVE     1             TO FLG-YOJI-ARI
              END-IF
           ELSE
              IF   SRY-SRYCD(IDX3)  =  "112015670"
                                   OR  "112015770"
                                   OR  "112017270"
                                   OR  "112017570"
                                   OR  "112016070"
                                   OR  "112016170"
                                   OR  "112021770"
                                   OR  "112021870"
                                   OR  "112021970"
                                   OR  "112022070"
                                   OR  "112022870"
                EVALUATE  SRY-SRYCD(IDX3)
                  WHEN     "112016070"
                    IF   FLG-JIKANTAI1-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                      MOVE     1             TO FLG-JIKANTAI1-ARI
                    END-IF
                  WHEN     "112015670"
                    IF   FLG-KOKENKSN-ARI   =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                      MOVE     1             TO FLG-KOKENKSN-ARI
                    END-IF
                  WHEN     "112016170"
                    IF   FLG-JIKANTAI3-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                      MOVE     1             TO FLG-JIKANTAI3-ARI
                    END-IF
                  WHEN     "112015770"
                    IF   FLG-MESAIKSN-ARI   =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                      MOVE     1             TO FLG-MESAIKSN-ARI
                    END-IF
                  WHEN     "112017270"
                    IF   FLG-CHIHOKATU-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                      MOVE     1             TO FLG-CHIHOKATU-ARI
                    END-IF
                  WHEN     "112017570"
                    IF   FLG-CHIHOKAT2-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                      MOVE     1             TO FLG-CHIHOKAT2-ARI
                    END-IF
                  WHEN     "112021770"
                    IF   FLG-CHIHOKAT3-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                      MOVE     1             TO FLG-CHIHOKAT3-ARI
                    END-IF
                  WHEN     "112021870"
                    IF   FLG-CHIHOKAT4-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                      MOVE     1             TO FLG-CHIHOKAT4-ARI
                    END-IF
                  WHEN     "112021970"
                    IF   FLG-YAKRENKEI-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                      MOVE     1             TO FLG-YAKRENKEI-ARI
                    END-IF
                  WHEN     "112022070"
                    IF   FLG-NINPU-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                      MOVE     1             TO FLG-NINPU-ARI
                    END-IF
                  WHEN     "112022870"
                    IF   FLG-NINPU2-ARI  =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                      MOVE     1             TO FLG-NINPU2-ARI
                    END-IF
                END-EVALUATE
              ELSE
                IF   FLG-SAISIN-ARI   =  ZERO
                      ADD  WRK-TNS-TEN(IDX3) TO RECE02-KHNTEN(2)
                      MOVE     1             TO FLG-SAISIN-ARI
                END-IF
              END-IF
           END-IF
      *
           IF    BUN-IDX   =   1
                COMPUTE    RECE02-TENSU(2 BUN-IDX)  =
                           RECE02-TENSU(2 BUN-IDX)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
           END-IF
           IF    BUN-IDX2  =   2
                COMPUTE    RECE02-TENSU(2 BUN-IDX2)  =
                           RECE02-TENSU(2 BUN-IDX2)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
           END-IF
           IF    BUN-IDX3  =   3
                COMPUTE    RECE02-TENSU(2 BUN-IDX3)  =
                           RECE02-TENSU(2 BUN-IDX3)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
           END-IF
           IF    BUN-IDX4  =   4
                COMPUTE    RECE02-TENSU(2 BUN-IDX4)  =
                           RECE02-TENSU(2 BUN-IDX4)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
           END-IF
           IF    BUN-IDX5  =   5
                COMPUTE    RECE02-TENSU(2 BUN-IDX5)  =
                           RECE02-TENSU(2 BUN-IDX5)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
           END-IF
           IF    BUN-IDX6  =   6
                COMPUTE    RECE02-SYUTANTEN(2)  =
                           RECE02-SYUTANTEN(2)  +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
           END-IF
           COMPUTE         RECE02-ALLTENSU(2)   =
                           RECE02-ALLTENSU(2)   +
                          (WRK-TNS-TEN(IDX3)   *   ACCT-ZAIKAISU)
      *
           .
      *
       21044211-RECE-LEFT12-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    医療情報連携編集
      *****************************************************************
       210443-IRYORENKEI-HENSYU-SEC               SECTION.
      *
           IF   (ACCT-SRYKBN       =  "14" OR "21" OR "22" OR "23")
           AND  (ACCT-ZAITEN       =  ZERO                        )
           AND  (ACCT-ZAIKBN   NOT =   1                          )
           AND  (ACCT-JIHOKBN      =  SPACE                       )
      *
             INITIALIZE                   SRYACT-REC
             MOVE    ACCT-HOSPNUM     TO  SRY-HOSPNUM
             MOVE    ACCT-NYUGAIKBN   TO  SRY-NYUGAIKBN
             MOVE    ACCT-PTID        TO  SRY-PTID
             MOVE    ACCT-SRYYM       TO  SRY-SRYYM
             MOVE    ACCT-ZAINUM      TO  SRY-ZAINUM
             MOVE    "820000046"      TO  SRY-SRYCD(1)
             MOVE    "820000046"      TO  SRY-SRYCD(2)
             MOVE    "820000046"      TO  SRY-SRYCD(3)
             MOVE    "820000046"      TO  SRY-SRYCD(4)
             MOVE    "820000046"      TO  SRY-SRYCD(5)
             MOVE    SRYACT-REC       TO  MCPDATA-REC
             MOVE    "tbl_sryact"     TO  MCP-TABLE
             MOVE    "key8"           TO  MCP-PATHNAME
             PERFORM 900-DBSELECT-SEC
             IF      MCP-RC   =   ZERO
               MOVE    "tbl_sryact"   TO  MCP-TABLE
               MOVE    "key8"         TO  MCP-PATHNAME
               PERFORM  900-SRYACT-READ-SEC
               IF   FLG-SRYACT  =  ZERO
                 CONTINUE
               ELSE
                 MOVE    1            TO  FLG-IRYORENKEI
               END-IF
             END-IF
             MOVE    "tbl_sryact"     TO  MCP-TABLE
             MOVE    "key8"           TO  MCP-PATHNAME
             PERFORM 900-CLOSE-SEC
      *
           END-IF
      *
           IF    FLG-IRYORENKEI   =   1
      *
             INITIALIZE                      ORCSGETGENERICAREA
             MOVE    RECE02-HOSPNUM      TO  ORCSGETGE-HOSPNUM
             MOVE    RECE02-PTID         TO  ORCSGETGE-PTID
             MOVE    RECE02-SRYYM        TO  ORCSGETGE-SRYYM
             MOVE    "2"                 TO  ORCSGETGE-NYUGAIKBN
             MOVE    ACCT-ZAINUM         TO  ORCSGETGE-ZAINUM
             MOVE    WRK-1030-KOUHATUKA  TO  ORCSGETGE-KOUHATUKA
             CALL    "ORCSGETGENERIC"    USING
                                         ORCSGETGENERICAREA
                                         SPA-AREA
             IF      ORCSGETGE-ERRCD     =   ZERO
               PERFORM   VARYING  IDX15    FROM    1   BY  1
                          UNTIL   IDX15     >     50
                 MOVE  ORCSGETGE-YAKKAKJNCD(IDX15)
                            TO  WRK-ORCSGETGE-YAKKAKJNCD(IDX15)
                 MOVE  ORCSGETGE-GENERIC-KBN(IDX15)
                            TO  WRK-ORCSGETGE-GENERIC-KBN(IDX15)
                 MOVE  ORCSGETGE-GENERICNAME(IDX15)
                            TO  WRK-ORCSGETGE-GENERICNAME(IDX15)
               END-PERFORM
             END-IF
      *
           END-IF
      *
           .
      *
       210443-IRYORENKEI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    湿布薬チェック
      *****************************************************************
       210444-SIPPU-CHECK-SEC               SECTION.
      *
           INITIALIZE                     SRYACT-REC
           MOVE    ACCT-HOSPNUM       TO  SRY-HOSPNUM
           MOVE    ACCT-NYUGAIKBN     TO  SRY-NYUGAIKBN
           MOVE    ACCT-PTID          TO  SRY-PTID
           MOVE    ACCT-SRYKA         TO  SRY-SRYKA
           MOVE    ACCT-SRYYM         TO  SRY-SRYYM
           MOVE    ACCT-ZAINUM        TO  SRY-ZAINUM
           MOVE    SRYACT-REC         TO  MCPDATA-REC
           MOVE    "tbl_sryact"       TO  MCP-TABLE
           MOVE    "key2"             TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_sryact"     TO  MCP-TABLE
             MOVE    "key2"           TO  MCP-PATHNAME
             PERFORM  900-SRYACT-READ-SEC
             PERFORM  UNTIL (FLG-SRYACT     =  1)
                       OR   (FLG-SIPPU-ARI  =  1)
      *
               PERFORM  VARYING  IDX2  FROM  1  BY  1
                         UNTIL  (IDX2            >   5   )
                          OR    (SRY-SRYCD(IDX2) =  SPACE)
                          OR    (FLG-SIPPU-ARI   =   1   )
                  PERFORM    900-TENSU-TBL-SEC
                  IF  (SRY-SRYCD(IDX2)(1:1)  =  "6")
                  AND (TNS-MEIUSESKB         =   1 )
                     MOVE    1        TO  FLG-SIPPU-ARI
                  END-IF
               END-PERFORM
      *
               MOVE    "tbl_sryact"   TO  MCP-TABLE
               MOVE    "key2"         TO  MCP-PATHNAME
               PERFORM   900-SRYACT-READ-SEC
             END-PERFORM
           END-IF
           MOVE    "tbl_sryact"       TO  MCP-TABLE
           MOVE    "key2"             TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
      *
       210444-SIPPU-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    特記事項の編集
      *****************************************************************
       21045-TOKKI-HENSYU-SEC                 SECTION.
      *
           MOVE     SPACE            TO      WRK-TOKKI
      *
           EVALUATE    FLG-TOKKI
             WHEN        1
              IF ACCT-JIHOKBN = SPACE
               EVALUATE    ACCT-SRYCDTOTAL
                   WHEN    00000099990101
                       MOVE    "01"      TO      WRK-TOKKI
                   WHEN    00000099990102
                       MOVE    "02"      TO      WRK-TOKKI
                   WHEN    00000099990103
                       MOVE    "03"      TO      WRK-TOKKI
                   WHEN    00000099990104
                       MOVE    "04"      TO      WRK-TOKKI
                   WHEN    00000099990105
                       MOVE    "05"      TO      WRK-TOKKI
                   WHEN    00000099990107
                       MOVE    "07"      TO      WRK-TOKKI
                   WHEN    00000099990108
                       MOVE    "08"      TO      WRK-TOKKI
                   WHEN    00000099990109
                       MOVE    "09"      TO      WRK-TOKKI
                   WHEN    00000099990110
                       MOVE    "10"      TO      WRK-TOKKI
                   WHEN    00000099990111
                       MOVE    "11"      TO      WRK-TOKKI
                   WHEN    00000099990112
                       MOVE    "12"      TO      WRK-TOKKI
                   WHEN    00000099990113
                       MOVE    "13"      TO      WRK-TOKKI
                   WHEN    00000099990114
                       MOVE    "14"      TO      WRK-TOKKI
                   WHEN    00000099990115
                       MOVE    "15"      TO      WRK-TOKKI
                   WHEN    00000099990116
                       MOVE    "16"      TO      WRK-TOKKI
                   WHEN    00000099990117
                       MOVE    "17"      TO      WRK-TOKKI
                   WHEN    00000099990118
                       MOVE    "18"      TO      WRK-TOKKI
                   WHEN    00000099990119
                       MOVE    "19"      TO      WRK-TOKKI
                   WHEN    00000099990120
                       MOVE    "20"      TO      WRK-TOKKI
                   WHEN    00000099990121
                       MOVE    "21"      TO      WRK-TOKKI
                   WHEN    00000099990125
                       MOVE    "25"      TO      WRK-TOKKI
                   WHEN    00000099990126
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN    00000099990127
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN    00000099990128
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN    00000099990129
                       MOVE    "29"      TO      WRK-TOKKI
                   WHEN    00000099990130
                       MOVE    "30"      TO      WRK-TOKKI
                   WHEN    00000099990136
                       MOVE    "36"      TO      WRK-TOKKI
                   WHEN    00000099990137
                       MOVE    "37"      TO      WRK-TOKKI
                   WHEN    00000099990138
                       MOVE    "38"      TO      WRK-TOKKI
                   WHEN    00000099990139
                       MOVE    "39"      TO      WRK-TOKKI
               END-EVALUATE
              END-IF
             WHEN        2
              IF ACCT-JIHOKBN = SPACE
               EVALUATE    SRY-SRYCD(IDX2)
                   WHEN    "099990101"
                       MOVE    "01"      TO      WRK-TOKKI
                   WHEN    "099990102"
                       MOVE    "02"      TO      WRK-TOKKI
                   WHEN    "099990103"
                       MOVE    "03"      TO      WRK-TOKKI
                   WHEN    "099990104"
                       MOVE    "04"      TO      WRK-TOKKI
                   WHEN    "099990105"
                       MOVE    "05"      TO      WRK-TOKKI
                   WHEN    "099990107"
                       MOVE    "07"      TO      WRK-TOKKI
                   WHEN    "099990108"
                       MOVE    "08"      TO      WRK-TOKKI
                   WHEN    "099990109"
                       MOVE    "09"      TO      WRK-TOKKI
                   WHEN    "099990110"
                       MOVE    "10"      TO      WRK-TOKKI
                   WHEN    "099990111"
                       MOVE    "11"      TO      WRK-TOKKI
                   WHEN    "099990112"
                       MOVE    "12"      TO      WRK-TOKKI
                   WHEN    "099990113"
                       MOVE    "13"      TO      WRK-TOKKI
                   WHEN    "099990114"
                       MOVE    "14"      TO      WRK-TOKKI
                   WHEN    "099990115"
                       MOVE    "15"      TO      WRK-TOKKI
                   WHEN    "099990116"
                       MOVE    "16"      TO      WRK-TOKKI
                   WHEN    "099990117"
                       MOVE    "17"      TO      WRK-TOKKI
                   WHEN    "099990118"
                       MOVE    "18"      TO      WRK-TOKKI
                   WHEN    "099990119"
                       MOVE    "19"      TO      WRK-TOKKI
                   WHEN    "099990120"
                       MOVE    "20"      TO      WRK-TOKKI
                   WHEN    "099990121"
                       MOVE    "21"      TO      WRK-TOKKI
                   WHEN    "099990125"
                       MOVE    "25"      TO      WRK-TOKKI
                   WHEN    "099990126"
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN    "099990127"
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN    "099990128"
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN    "099990129"
                       MOVE    "29"      TO      WRK-TOKKI
                   WHEN    "099990130"
                       MOVE    "30"      TO      WRK-TOKKI
                   WHEN    "099990136"
                       MOVE    "36"      TO      WRK-TOKKI
                   WHEN    "099990137"
                       MOVE    "37"      TO      WRK-TOKKI
                   WHEN    "099990138"
                       MOVE    "38"      TO      WRK-TOKKI
                   WHEN    "099990139"
                       MOVE    "39"      TO      WRK-TOKKI
               END-EVALUATE
              END-IF
             WHEN        3
              IF ACCT-JIHOKBN = SPACE
                       MOVE    "14"      TO      WRK-TOKKI
              END-IF
             WHEN        4
                       MOVE    "15"      TO      WRK-TOKKI
             WHEN        5
               EVALUATE   FLG-GENBUTU70
                   WHEN     1
                       MOVE    "17"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "18"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "19"      TO      WRK-TOKKI
               END-EVALUATE
             WHEN        6
                       MOVE    "21"      TO      WRK-TOKKI
             WHEN        7
               EVALUATE   FLG-TOKUSITU
                   WHEN     1
                       MOVE    "17"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "18"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "19"      TO      WRK-TOKKI
               END-EVALUATE
               IF    RECE02-SRYYM            >=  "201501"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-TOKUSITU-TOKKI
               END-IF
             WHEN        9
              IF ACCT-JIHOKBN = SPACE
                       MOVE    "11"      TO      WRK-TOKKI
              END-IF
             WHEN       10
              IF ACCT-JIHOKBN = SPACE
                       MOVE    "12"      TO      WRK-TOKKI
              END-IF
             WHEN       11
                       MOVE    "25"      TO      WRK-TOKKI
             WHEN       12
                       MOVE    "01"      TO      WRK-TOKKI
             WHEN       13
                       MOVE    "10"      TO      WRK-TOKKI
             WHEN       14
               EVALUATE   FLG-GENBUTU70-KBN
                   WHEN     11
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN     12
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN     21
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN     22
                       MOVE    "29"      TO      WRK-TOKKI
                   WHEN     31
                       MOVE    "30"      TO      WRK-TOKKI
               END-EVALUATE
             WHEN       15
               EVALUATE   FLG-TOKUSITU-KBN
                   WHEN     11
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN     12
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN     21
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN     22
                       MOVE    "29"      TO      WRK-TOKKI
                   WHEN     31
                       MOVE    "30"      TO      WRK-TOKKI
               END-EVALUATE
               IF    RECE02-SRYYM            >=  "201501"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-TOKUSITU-TOKKI
               END-IF
             WHEN       17
              IF ACCT-JIHOKBN = SPACE
                       MOVE    "36"      TO      WRK-TOKKI
              END-IF
             WHEN       19
               EVALUATE   FLG-KOUREI-GENEKIKBN
                   WHEN     1
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN     4
                       MOVE    "29"      TO      WRK-TOKKI
                   WHEN     5
                       MOVE    "30"      TO      WRK-TOKKI
               END-EVALUATE
             WHEN       20
               EVALUATE   FLG-KOUREI-GENEKIKBN
                   WHEN     1
                       MOVE    "26"      TO      WRK-TOKKI
                   WHEN     2
                       MOVE    "27"      TO      WRK-TOKKI
                   WHEN     3
                       MOVE    "28"      TO      WRK-TOKKI
                   WHEN     4
                       MOVE    "29"      TO      WRK-TOKKI
                   WHEN     5
                       MOVE    "30"      TO      WRK-TOKKI
               END-EVALUATE
               IF    RECE02-SRYYM            >=  "201808"
               AND   WRK-TOKKI            NOT =  SPACE
                   MOVE   WRK-TOKKI      TO      WRK-TOKUSITU-TOKKI
               END-IF
             WHEN       21
                       MOVE    "02"      TO      WRK-TOKKI
      *
             WHEN       96
                       MOVE    "96"      TO      WRK-TOKKI
             WHEN       97
                       MOVE    "97"      TO      WRK-TOKKI
           END-EVALUATE
      *
      *    既に同じ特記事項コードが編集済みのときはセットしない
           EVALUATE  WRK-TOKKI
             WHEN      "15"
               IF  (RECE02-SRYYM   >=  "200608")
               AND (RECE02-SRYYM   <=  "200812")
                   CONTINUE
               ELSE
                   GO  TO  21045-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "16"
               IF  (RECE02-SRYYM   <   "200610")
                   GO  TO  21045-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "17"
             WHEN      "18"
             WHEN      "19"
               IF  (RECE02-SRYYM   >=  "200704")
               AND (RECE02-SRYYM   <=  "201807")
                   CONTINUE
               ELSE
                   GO  TO  21045-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "20"
               IF  (RECE02-SRYYM   >=  "200804")
               AND (RECE02-SRYYM   <=  "201903")
                   CONTINUE
               ELSE
                   GO  TO  21045-TOKKI-HENSYU-EXT
               END-IF
             WHEN      "21"
               IF  (RECE02-SRYYM   <   "200901")
                   GO  TO  21045-TOKKI-HENSYU-EXT
               END-IF
           END-EVALUATE
           PERFORM VARYING TOKKI-IDX  FROM    1   BY  1
                   UNTIL ( TOKKI-IDX       >   5     )
               IF      RECE02-TOKKI (TOKKI-IDX)   =   SPACE
                   MOVE    WRK-TOKKI       TO  RECE02-TOKKI (TOKKI-IDX)
                   MOVE    5               TO  TOKKI-IDX
               ELSE
                   IF      WRK-TOKKI       =   RECE02-TOKKI (TOKKI-IDX)
                       MOVE    5               TO  TOKKI-IDX
                   END-IF 
               END-IF
           END-PERFORM
           .
       21045-TOKKI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    剤の診療内容チェック
      *****************************************************************
       21046-SINRYO-CHECK-SEC                 SECTION.
      *
      ***  PERFORM   VARYING   IDU   FROM   1   BY   1
           PERFORM   VARYING   IDU   FROM   2   BY   1
                      UNTIL  ( IDU   >   TBL-ZAICHECK-MAX )
                       OR    ( FLG-RINYAK  NOT =  ZERO    )
      *
              IF  ( IDU  =  1                                  )
              OR  ((IDU  =  2) AND (ACCT-SRYKBN = "60" OR "64"))
              OR  ((IDU  =  3) AND (ACCT-SRYKBN = "80"        ))
              OR  ((IDU  =  4) AND (ACCT-SRYKBN = "80"        ))
      *
                 INITIALIZE                   SRYACT-REC
grpsys           MOVE  RECE02-HOSPNUM     TO  SRY-HOSPNUM
                 MOVE  RECE02-NYUGAIKBN   TO  SRY-NYUGAIKBN
                 MOVE  RECE02-PTID        TO  SRY-PTID
                 MOVE  RECE02-SRYYM       TO  SRY-SRYYM
                 MOVE  ACCT-ZAINUM        TO  SRY-ZAINUM
                 MOVE  TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(1)
                 MOVE  TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(2)
                 MOVE  TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(3)
                 MOVE  TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(4)
                 MOVE  TBL-ZAICHECK(IDU)  TO  SRY-SRYCD(5)
                 MOVE  SRYACT-REC         TO  MCPDATA-REC
                 MOVE    "tbl_sryact"         TO      MCP-TABLE
                 MOVE    "key8"               TO      MCP-PATHNAME
grpsys           PERFORM 900-DBSELECT-SEC
                 IF      MCP-RC               =       ZERO
                     MOVE    "tbl_sryact"         TO  MCP-TABLE
                     MOVE    "key8"               TO  MCP-PATHNAME
                     PERFORM   900-SRYACT-READ-SEC
                     IF     FLG-SRYACT   =  ZERO
                         EVALUATE   IDU
                           WHEN      1
                             MOVE   1   TO  FLG-RINYAK
                           WHEN      2
                           WHEN      3
                           WHEN      4
                             MOVE   2   TO  FLG-RINYAK
                         END-EVALUATE
                     END-IF
                 END-IF
                 MOVE    "tbl_sryact"         TO  MCP-TABLE
                 MOVE    "key8"               TO  MCP-PATHNAME
                 PERFORM   900-CLOSE-SEC
      *
              END-IF
      *
           END-PERFORM
      *
           .
       21046-SINRYO-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７０歳未満現物給付（高額療養費合算対象チェック）
      *****************************************************************
       211S-GENBUTU70-GASSAN-CHK-SEC                SECTION.
      *
           INITIALIZE                        SYUNOU-REC
           MOVE    RECE02-HOSPNUM       TO   SYU-HOSPNUM
           MOVE    RECE02-NYUGAIKBN     TO   SYU-NYUGAIKBN
           MOVE    RECE02-PTID          TO   SYU-PTID
           MOVE    RECE02-SRYYM         TO   SYU-SRYYMD(1:6)
           MOVE    "__"                 TO   SYU-SRYYMD(7:2)
           MOVE    SYUNOU-REC           TO   MCPDATA-REC
           MOVE    "tbl_syunou"         TO   MCP-TABLE
           MOVE    "key26"              TO   MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =    ZERO
             MOVE    "tbl_syunou"       TO   MCP-TABLE
             MOVE    "key26"            TO   MCP-PATHNAME
             PERFORM  900-SYUNOU-READ-SEC
             PERFORM  UNTIL  (FLG-SYUNOU  =  1)
               PERFORM  VARYING  IDX1   FROM  1   BY  1
                         UNTIL  (IDX1                  >   10  )
                          OR    (RECE02-HKNCOMBI(IDX1) =   ZERO)
                 IF  SYU-HKNCOMBINUM  =  RECE02-HKNCOMBI(IDX1)
                   IF  (SYU-DENPJTIKBN         NOT =  "3")
                   AND (SYU-TOTAL-HKNTEN       NOT = ZERO)
                   AND (SYU-SKJ-FTNGAKU(2)     NOT = ZERO)
                    IF   RECE02-DAISANFLG(IDX1) =  1
                     IF   (RECE02-DAISAN-GAITO    =   1 OR 2)
                     AND  (RECE02-DAISAN-GENBUTU-GAITO  =  1)
                      PERFORM 211S1-GENBUTU70-GASSAN-HEN-SEC
                     END-IF
                    ELSE
                      PERFORM 211S1-GENBUTU70-GASSAN-HEN-SEC
                    END-IF
                   END-IF
                   MOVE    10           TO   IDX1
                 END-IF
               END-PERFORM
               MOVE      "tbl_syunou"   TO   MCP-TABLE
               MOVE      "key26"        TO   MCP-PATHNAME
               PERFORM    900-SYUNOU-READ-SEC
             END-PERFORM
           END-IF
           MOVE    "tbl_syunou"         TO   MCP-TABLE
           MOVE    "key26"              TO   MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
      *
           PERFORM  211S2-GENBUTU70-GASSAN-HAN-SEC
      *
           .
       211S-GENBUTU70-GASSAN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７０歳未満現物給付（高額療養費合算対象チェック）編集
      *****************************************************************
       211S1-GENBUTU70-GASSAN-HEN-SEC              SECTION.
      *
           IF  (SYU-SYUHKNNUM   NOT = SPACE)
           AND (RECE02-HKNNUM   NOT = SPACE)
             IF    (SYU-KOH1HKNNUM = SPACE OR "970")
             AND   (SYU-KOH2HKNNUM = SPACE         )
             AND   (SYU-KOH3HKNNUM = SPACE         )
             AND   (SYU-KOH4HKNNUM = SPACE         )
               ADD   SYU-TOTAL-HKNTEN  TO
                         WRK-SYUNOU-GEN70T-TOTAL-HKNTEN
             ELSE
               MOVE  SYU-HKNCOMBINUM   TO
                         WRK-SYUNOU-GEN70-HKNCOMBINUM(IDX1)
               ADD   SYU-TOTAL-HKNTEN  TO
                         WRK-SYUNOU-GEN70-TOTAL-HKNTEN(IDX1)
               MOVE  SYU-SYUHKNNUM     TO
                         WRK-SYUNOU-GEN70-SYUHKNNUM(IDX1)
               MOVE  SYU-KOH1HKNNUM    TO
                         WRK-SYUNOU-GEN70-KOH1HKNNUM(IDX1)
               ADD   SYU-KOH1COMPFTN   TO
                         WRK-SYUNOU-GEN70-KOH1COMPFTN(IDX1)
               MOVE  SYU-KOH2HKNNUM    TO
                         WRK-SYUNOU-GEN70-KOH2HKNNUM(IDX1)
               ADD   SYU-KOH2COMPFTN   TO
                         WRK-SYUNOU-GEN70-KOH2COMPFTN(IDX1)
               MOVE  SYU-KOH3HKNNUM    TO
                         WRK-SYUNOU-GEN70-KOH3HKNNUM(IDX1)
               ADD   SYU-KOH3COMPFTN   TO
                         WRK-SYUNOU-GEN70-KOH3COMPFTN(IDX1)
               MOVE  SYU-KOH4HKNNUM    TO
                         WRK-SYUNOU-GEN70-KOH4HKNNUM(IDX1)
               ADD   SYU-KOH4COMPFTN   TO
                         WRK-SYUNOU-GEN70-KOH4COMPFTN(IDX1)
               IF    SYU-SKJ-FTNGAKU(3)  =  9
                  MOVE    9            TO
                         WRK-SYUNOU-GEN70-GASSANFLG(IDX1)
               END-IF
             END-IF
           END-IF
      *
           .
       211S1-GENBUTU70-GASSAN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７０歳未満現物給付（高額療養費合算対象チェック）判定
      *****************************************************************
       211S2-GENBUTU70-GASSAN-HAN-SEC              SECTION.
      *
      *    主保険単独分の計算
           COMPUTE  WRK-FTNKEI = WRK-SYUNOU-GEN70T-TOTAL-HKNTEN
                               * 10
                               * RECE02-KYURATE
                               / 100
           IF    FLG-TOKU75  =  3
             IF  WRK-FTNKEI >= 10500
               MOVE    1    TO    WRK-SYUNOU-GEN70T-HANTEIFLG
             END-IF
           ELSE
             IF  WRK-FTNKEI >= 21000
               MOVE    1    TO    WRK-SYUNOU-GEN70T-HANTEIFLG
             END-IF
           END-IF
      *
      *    公費併用分の計算
           PERFORM   VARYING   IDX14   FROM   1   BY   1
                      UNTIL    IDX14     >   10
             IF   WRK-SYUNOU-GEN70-HKNCOMBINUM(IDX14)  NOT = SPACE
               IF  (WRK-SYUNOU-GEN70-KOH1HKNNUM(IDX14) =
                                                 "972" OR "974")
               AND (WRK-SYUNOU-GEN70-KOH2HKNNUM(IDX14) =  SPACE)
               AND (WRK-SYUNOU-GEN70-KOH3HKNNUM(IDX14) =  SPACE)
               AND (WRK-SYUNOU-GEN70-KOH4HKNNUM(IDX14) =  SPACE)
                 CONTINUE
               ELSE
                 COMPUTE  WRK-FTNKEI =
                            WRK-SYUNOU-GEN70-TOTAL-HKNTEN(IDX14)
                                     * 10
                                     * RECE02-KYURATE
                                     / 100
                 IF ((WRK-SYUNOU-GEN70-KOH1HKNNUM(IDX14)
                                         NOT = SPACE          ) AND
                     (WRK-SYUNOU-GEN70-KOH1HKNNUM(IDX14)
                                         NOT = "972" AND "974") AND
                     (WRK-SYUNOU-GEN70-KOH1COMPFTN(IDX14)
                                         NOT = ZERO           ))
                 OR ((WRK-SYUNOU-GEN70-KOH2HKNNUM(IDX14)
                                         NOT = SPACE          ) AND
                     (WRK-SYUNOU-GEN70-KOH2HKNNUM(IDX14)
                                         NOT = "972" AND "974") AND
                     (WRK-SYUNOU-GEN70-KOH2COMPFTN(IDX14)
                                         NOT = ZERO           ))
                 OR ((WRK-SYUNOU-GEN70-KOH3HKNNUM(IDX14)
                                         NOT = SPACE          ) AND
                     (WRK-SYUNOU-GEN70-KOH3HKNNUM(IDX14)
                                         NOT = "972" AND "974") AND
                     (WRK-SYUNOU-GEN70-KOH3COMPFTN(IDX14)
                                         NOT = ZERO           ))
                 OR ((WRK-SYUNOU-GEN70-KOH4HKNNUM(IDX14)
                                         NOT = SPACE          ) AND
                     (WRK-SYUNOU-GEN70-KOH4HKNNUM(IDX14)
                                         NOT = "972" AND "974") AND
                     (WRK-SYUNOU-GEN70-KOH4COMPFTN(IDX14)
                                         NOT = ZERO           ))
                   IF  FLG-TOKU75  =  3
                    IF  WRK-FTNKEI >= 10500
                      MOVE  1  TO WRK-SYUNOU-GEN70-HANTEIFLG(IDX14)
                    END-IF
                   ELSE
                    IF  WRK-FTNKEI >= 21000
                      MOVE  1  TO WRK-SYUNOU-GEN70-HANTEIFLG(IDX14)
                    END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-PERFORM
      *
           .
       211S2-GENBUTU70-GASSAN-HAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期チェック１
      *****************************************************************
       211T-CYOKI-CHECK-SEC                SECTION.
      *
           INITIALIZE                        SYUNOU-REC
           MOVE    RECE02-HOSPNUM       TO   SYU-HOSPNUM
           MOVE    RECE02-NYUGAIKBN     TO   SYU-NYUGAIKBN
           MOVE    RECE02-PTID          TO   SYU-PTID
           MOVE    RECE02-SRYYM         TO   SYU-SRYYMD(1:6)
           MOVE    "__"                 TO   SYU-SRYYMD(7:2)
           MOVE    SYUNOU-REC           TO   MCPDATA-REC
           MOVE    "tbl_syunou"         TO   MCP-TABLE
           MOVE    "key26"              TO   MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =    ZERO
             MOVE    "tbl_syunou"       TO   MCP-TABLE
             MOVE    "key26"            TO   MCP-PATHNAME
             PERFORM  900-SYUNOU-READ-SEC
             PERFORM  UNTIL  (FLG-SYUNOU  =  1)
               PERFORM  VARYING  IDX1   FROM  1   BY  1
                         UNTIL  (IDX1                  >   10  )
                          OR    (RECE02-HKNCOMBI(IDX1) =   ZERO)
                 IF  SYU-HKNCOMBINUM  =  RECE02-HKNCOMBI(IDX1)
                   IF  (SYU-DENPJTIKBN         NOT =  "3")
                   AND (SYU-TOTAL-HKNTEN       NOT = ZERO)
                   AND (RECE02-DAISANFLG(IDX1) NOT =   1 )
                       IF  (SYU-KOH-HKNNUM(1) =  "972")
                       OR  (SYU-KOH-HKNNUM(2) =  "972")
                       OR  (SYU-KOH-HKNNUM(3) =  "972")
                       OR  (SYU-KOH-HKNNUM(4) =  "972")
                         MOVE    ZERO   TO   FLG-CYOKI-CHECK2
                         MOVE    ZERO   TO   FLG-CYOKI-CHECK3
                         PERFORM 211T1-CYOKI-HENSYU-SEC
                         PERFORM 211T1-CYOKI-HENSYU2-SEC
                       END-IF
                   END-IF
                   MOVE    10           TO   IDX1
                 END-IF
               END-PERFORM
               MOVE      "tbl_syunou"   TO   MCP-TABLE
               MOVE      "key26"        TO   MCP-PATHNAME
               PERFORM    900-SYUNOU-READ-SEC
             END-PERFORM
           END-IF
           MOVE    "tbl_syunou"         TO   MCP-TABLE
           MOVE    "key26"              TO   MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
      *
           .
       211T-CYOKI-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期チェック１編集１
      *****************************************************************
       211T1-CYOKI-HENSYU-SEC              SECTION.
      *
           IF  (SYU-KOH-HKNNUM(1)(1:1)   =  "0")
           OR  (TBL-TOKATUKAIFLG2        =   1 )
             IF  (SYS-1001-PREFNUM     =  23     )
             AND (SYU-KOH-HKNNUM(1)    = "191"   )
             AND (RECE02-TEISYUTUSAKI  =  2 OR 6 )
             AND (RECE02-SRYYM        >= "201204")
                CONTINUE
             ELSE
                MOVE     1        TO   FLG-CYOKI-CHECK2
             END-IF
           ELSE
             IF  SYU-KOH-HKNNUM(1)(1:1)  >= "1" AND <=  "8"
                MOVE     2        TO   FLG-CYOKI-CHECK2
             END-IF
           END-IF
      *
           IF  ((FLG-CYOKI-CHECK2   =  1                     ) AND
                (RECE02-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(1)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(1)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(1) =  ZERO                  ))
           OR  ((FLG-CYOKI-CHECK2   =  1                     ) AND
                (RECE02-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(2)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(2)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(2) =  ZERO                  ))
           OR  ((FLG-CYOKI-CHECK2   =  1                     ) AND
                (RECE02-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(3)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(3)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(3) =  ZERO                  ))
           OR  ((FLG-CYOKI-CHECK2   =  1                     ) AND
                (RECE02-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(4)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(4)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(4) =  ZERO                  ))
               MOVE     1         TO   FLG-CYOKI-CHECK3
           END-IF
      *
           IF  ((FLG-CYOKI-CHECK2   =  2                     ) AND
                (RECE02-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(1)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(1)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (RECE02-EKF-HKNFTNFLG-K(2) = "1"             ))
           OR  ((FLG-CYOKI-CHECK2   =  2                     ) AND
                (RECE02-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(2)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(2)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (RECE02-EKF-HKNFTNFLG-K(3) = "1"             ))
           OR  ((FLG-CYOKI-CHECK2   =  2                     ) AND
                (RECE02-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(3)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(3)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (RECE02-EKF-HKNFTNFLG-K(4) = "1"             ))
           OR  ((FLG-CYOKI-CHECK2   =  2                     ) AND
                (RECE02-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(4)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(4)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (RECE02-EKF-HKNFTNFLG-K(5) = "1"             ))
               MOVE     1         TO   FLG-CYOKI-CHECK3
           END-IF
      *
           .
       211T1-CYOKI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期チェック１編集２
      *****************************************************************
       211T1-CYOKI-HENSYU2-SEC              SECTION.
      *
           IF    FLG-CYOKI-CHECK3   =   ZERO
      *        所得区分に準ずる集計分
             IF     (SYU-KOH-HKNNUM(1) = "972")
             AND    (SYU-KOH-HKNNUM(2) = SPACE)
             AND    (SYU-KOH-HKNNUM(3) = SPACE)
             AND    (SYU-KOH-HKNNUM(4) = SPACE)
                 ADD   SYU-TOTAL-HKNTEN
                                  TO   WRK-CYOKI-TOTAL-HKNTEN
             ELSE
               IF   (RECE02-KOHNUM(1)  = SYU-KOH-HKNNUM(1)      )
               AND  (RECE02-KOHNUM(1)  = RECE02-KOHNUMHC(IDX1 1))
               AND  (RECE02-KOHID(1)   = RECE02-KOHIDHC(IDX1 1) )
                 ADD   SYU-TOTAL-HKNTEN
                                  TO   WRK-CYOKI-TOTAL-HKNTEN2
               END-IF
             END-IF
           ELSE
      *        一律一般集計分
             IF    SYU-TOTAL-HKNTEN   NOT =  ZERO
               MOVE     1         TO   FLG-CYOKI-CHECK
               COMPUTE  WRK-FTNKEI = SYU-TOTAL-HKNTEN
                                   * 10
                                   * RECE02-KYURATE
                                   / 100
               COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
               COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
               COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
               COMPUTE  WRK-FTNKEI = WRK-FTNKEI
                                   + SYU-GRP-SGKMONEY
               ADD      WRK-FTNKEI
                                  TO   WRK-CYOKI-TOTAL-HKNKIN
             END-IF
           END-IF
      *
           .
       211T1-CYOKI-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期チェック２
      *****************************************************************
       211TX-CYOKI-CHECK2-SEC                SECTION.
      *
           INITIALIZE                        SYUNOU-REC
           MOVE    RECE02-HOSPNUM       TO   SYU-HOSPNUM
           MOVE    RECE02-NYUGAIKBN     TO   SYU-NYUGAIKBN
           MOVE    RECE02-PTID          TO   SYU-PTID
           MOVE    RECE02-SRYYM         TO   SYU-SRYYMD(1:6)
           MOVE    "__"                 TO   SYU-SRYYMD(7:2)
           MOVE    SYUNOU-REC           TO   MCPDATA-REC
           MOVE    "tbl_syunou"         TO   MCP-TABLE
           MOVE    "key69"              TO   MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =    ZERO
             MOVE    "tbl_syunou"       TO   MCP-TABLE
             MOVE    "key69"            TO   MCP-PATHNAME
             PERFORM  900-SYUNOU-READ-SEC
             PERFORM  UNTIL  (FLG-SYUNOU  =  1)
               PERFORM  VARYING  IDX1   FROM  1   BY  1
                         UNTIL  (IDX1                  >   10  )
                          OR    (RECE02-HKNCOMBI(IDX1) =   ZERO)
                 IF  SYU-HKNCOMBINUM  =  RECE02-HKNCOMBI(IDX1)
                   IF  (SYU-DENPJTIKBN         NOT =  "3")
                   AND (SYU-TOTAL-HKNTEN       NOT = ZERO)
                   AND (RECE02-DAISANFLG(IDX1) NOT =   1 )
                       IF  (SYU-KOH-HKNNUM(1) =  "972" OR "974")
                       OR  (SYU-KOH-HKNNUM(2) =  "972" OR "974")
                       OR  (SYU-KOH-HKNNUM(3) =  "972" OR "974")
                       OR  (SYU-KOH-HKNNUM(4) =  "972" OR "974")
                         PERFORM 211TX1-CYOKI-HENSYU1-SEC
                       END-IF
                   END-IF
                   MOVE    10           TO   IDX1
                 END-IF
               END-PERFORM
               MOVE      "tbl_syunou"   TO   MCP-TABLE
               MOVE      "key69"        TO   MCP-PATHNAME
               PERFORM    900-SYUNOU-READ-SEC
             END-PERFORM
           END-IF
           MOVE    "tbl_syunou"         TO   MCP-TABLE
           MOVE    "key69"              TO   MCP-PATHNAME
           PERFORM  900-CLOSE-SEC
      *
           PERFORM  VARYING  IDX1   FROM  1   BY  1
                     UNTIL   IDX1    >   10
             EVALUATE  WRK-SYUNOU-CYOKI-KOHFLG(IDX1)
               WHEN       1
                 ADD    1      TO    CNT-CYOKI-HENSYU1
               WHEN       2
                 ADD    1      TO    CNT-CYOKI-HENSYU2
             END-EVALUATE
           END-PERFORM
      *
           IF  (CNT-CYOKI-HENSYU1      =  1             )
           AND (CNT-CYOKI-HENSYU2      =  1             )
      *****AND (FLG-ZENKOKUKOHI-NISYU  =  ZERO OR 2 OR 4)
             PERFORM 211TX2-CYOKI-HENSYU2-SEC
           END-IF
      *
      *    マル長レセプト記載処理区分の編集
      *
           IF   (RECE02-SRYYM                >=  "202001")
           AND  (CNT-CYOKI-HENSYU1        NOT =  ZERO    )
           AND  (CNT-CYOKI-HENSYU2        NOT =  ZERO    )
           AND  (WRK-SYUNOU-CYOKI-KEISANFLG   =   1      )
           AND  (WRK-SYUNOU-CYOKI-KEISANFLG2  =  ZERO    )
             IF   (FLG-CYOKI-HENSYU   =   1  )
             AND  (FLG-CYOKI-HENSYU3  =  ZERO)
               CONTINUE
             ELSE
               MOVE    1    TO  FLG-CYOKI-HENSYU4
             END-IF
           END-IF
      *
           .
       211TX-CYOKI-CHECK2-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期チェック２編集１
      *****************************************************************
       211TX1-CYOKI-HENSYU1-SEC              SECTION.
      *
           IF    FLG-CYOKI-HENSYU2  =  ZERO
             MOVE   1   TO   FLG-CYOKI-HENSYU2
             IF  (SYU-KOH-HKNNUM(1) =  "972")
             OR  (SYU-KOH-HKNNUM(2) =  "972")
             OR  (SYU-KOH-HKNNUM(3) =  "972")
             OR  (SYU-KOH-HKNNUM(4) =  "972")
               EVALUATE   RECE02-ZAITAKU
                 WHEN      "1"
                   IF      RECE02-TEISYOTOKU  NOT =  SPACE
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE    4000   TO   WRK-KINGAKU
                     ELSE
                       MOVE    8000   TO   WRK-KINGAKU
                     END-IF
                   ELSE
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE    5000   TO   WRK-KINGAKU
                     ELSE
                       MOVE    10000  TO   WRK-KINGAKU
                     END-IF
                   END-IF
                 WHEN      "2"
                     IF  FLG-TOKU75 = 3
                       MOVE     5000  TO   WRK-KINGAKU
                     ELSE
                       MOVE    10000  TO   WRK-KINGAKU
                     END-IF
               END-EVALUATE
             ELSE
               EVALUATE   RECE02-ZAITAKU
                 WHEN      "1"
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE    10000  TO   WRK-KINGAKU
                     ELSE
                       MOVE    20000  TO   WRK-KINGAKU
                     END-IF
                 WHEN      "2"
                     IF  FLG-TOKU75 = 3
                       MOVE    10000  TO   WRK-KINGAKU
                     ELSE
                       MOVE    20000  TO   WRK-KINGAKU
                     END-IF
               END-EVALUATE
             END-IF
           END-IF
      *
           MOVE  SYU-HKNCOMBINUM
                      TO   WRK-SYUNOU-CYOKI-HKNCOMBINUM(IDX1)
      *
           IF   (SYU-KOH-HKNNUM(1) =  "972" OR "974")
           AND  (SYU-KOH-HKNNUM(2) =  SPACE         )
           AND  (SYU-KOH-HKNNUM(3) =  SPACE         )
           AND  (SYU-KOH-HKNNUM(4) =  SPACE         )
             MOVE  1  TO   WRK-SYUNOU-CYOKI-KOHFLG(IDX1)
      *
             COMPUTE  WRK-FTNKEI = SYU-TOTAL-HKNTEN
                                 * 10
                                 * RECE02-KYURATE
                                 / 100
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI
                                 + SYU-GRP-SGKMONEY
             IF   FTN-CYOKI-XX2  >=  WRK-KINGAKU
               IF  SYU-TOTAL-HKNTEN  NOT = ZERO
                 MOVE      1         TO  FLG-CYOKI-HENSYU3
               END-IF
             ELSE
               IF  FTN-CYOKI-XXX  >  WRK-KINGAKU
                 MOVE  WRK-KINGAKU   TO  FTN-CYOKI-XXX
               END-IF
               COMPUTE FTN-CYOKI-YYY = WRK-KINGAKU - FTN-CYOKI-XXX
               IF  WRK-FTNKEI     >  FTN-CYOKI-YYY
                 ADD  FTN-CYOKI-YYY  TO  FTN-CYOKI-XXX
               ELSE
                 ADD  WRK-FTNKEI     TO  FTN-CYOKI-XXX
               END-IF
             END-IF
           ELSE
             MOVE  2  TO   WRK-SYUNOU-CYOKI-KOHFLG(IDX1)
             MOVE  9999999           TO  FTN-CYOKI-XX2
           END-IF
      *
      ***  IF  FTN-CYOKI-XX2  >  WRK-KINGAKU
      ***    MOVE  WRK-KINGAKU   TO  FTN-CYOKI-XX2
      ***  END-IF
      ***  COMPUTE FTN-CYOKI-YY2 = WRK-KINGAKU - FTN-CYOKI-XX2
      ***  IF  WRK-FTNKEI     >  FTN-CYOKI-YY2
      ***    ADD  FTN-CYOKI-YY2  TO  FTN-CYOKI-XX2
      ***  ELSE
      ***    ADD  WRK-FTNKEI     TO  FTN-CYOKI-XX2
      ***  END-IF
      *
           IF   (RECE02-SRYYM     >=  "202001"      )
           AND  (SYU-KOH-HKNNUM(1) =  "972" OR "974")
           AND  (SYU-KOH-HKNNUM(2) =  SPACE         )
           AND  (SYU-KOH-HKNNUM(3) =  SPACE         )
           AND  (SYU-KOH-HKNNUM(4) =  SPACE         )
             IF  SYU-KOHTAIYKZKBN  =  "2"
               MOVE    1    TO    WRK-SYUNOU-CYOKI-KEISANFLG2
             ELSE
               MOVE    1    TO    WRK-SYUNOU-CYOKI-KEISANFLG
             END-IF
           END-IF
      *
           .
       211TX1-CYOKI-HENSYU1-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期チェック２編集２
      *    ＜月途中の公費適用前に「主保険＋長期」での診療があるか＞
      *****************************************************************
       211TX2-CYOKI-HENSYU2-SEC              SECTION.
      *
           PERFORM  VARYING  IDX1   FROM  1   BY  1
                     UNTIL   IDX1    >   10
             IF   WRK-SYUNOU-CYOKI-KOHFLG(IDX1)  NOT =  ZERO
               INITIALIZE                  HKNCOMBI-REC
               MOVE    RECE02-HOSPNUM  TO  COMB-HOSPNUM
               MOVE    RECE02-PTID     TO  COMB-PTID
               MOVE    WRK-SYUNOU-CYOKI-HKNCOMBINUM(IDX1)
                                       TO  COMB-HKNCOMBINUM
               MOVE    HKNCOMBI-REC    TO  MCPDATA-REC
               PERFORM 900-HKNCOMBI-INV-SEC
               IF      FLG-HKNCOMBI    =   ZERO
                 MOVE  RECE02-SRYYM
                          TO  WRK-SYUNOU-CYOKI-TEKSTYMD(IDX1)(1:6)
                 IF   COMB-TEKSTYMD(1:6)  >=  RECE02-SRYYM
                    MOVE   COMB-TEKSTYMD(7:2)
                          TO  WRK-SYUNOU-CYOKI-TEKSTYMD(IDX1)(7:2)
                 ELSE
                    MOVE   "01"
                          TO  WRK-SYUNOU-CYOKI-TEKSTYMD(IDX1)(7:2)
                 END-IF
      *
                 IF   WRK-SYUNOU-CYOKI-KOHFLG(IDX1) = 1
                    MOVE   WRK-SYUNOU-CYOKI-TEKSTYMD(IDX1)
                          TO  WRK-SYUNOU-CYOKI-TEKSTYMD-XXX
                 END-IF
               END-IF
             END-IF
           END-PERFORM
      *
           IF   WRK-SYUNOU-CYOKI-TEKSTYMD-XXX   NOT =  SPACE
             PERFORM  VARYING  IDX1   FROM  1   BY  1
                       UNTIL   IDX1    >   10
               IF   WRK-SYUNOU-CYOKI-KOHFLG(IDX1) = 2
                 IF   WRK-SYUNOU-CYOKI-TEKSTYMD-XXX
                                 < WRK-SYUNOU-CYOKI-TEKSTYMD(IDX1)
                   MOVE  1  TO  WRK-SYUNOU-CYOKI-HANTEIFLG
                 ELSE
                   MOVE  1  TO  WRK-SYUNOU-CYOKI-HANTEIFLG2
                 END-IF
               END-IF
             END-PERFORM
           END-IF
      *
           IF  (WRK-SYUNOU-CYOKI-HANTEIFLG  =  1  )
           AND (WRK-SYUNOU-CYOKI-HANTEIFLG2 = ZERO)
             IF    FTN-KOH-XXX   <   WRK-KINGAKU
               COMPUTE  WRK-SYUNOU-CYOKI-FTNMONEY2 = WRK-KINGAKU
                                                   - FTN-KOH-XXX
               IF  WRK-SYUNOU-CYOKI-FTNMONEY2 < FTN-CYOKI-XXX
                 MOVE   WRK-SYUNOU-CYOKI-FTNMONEY2
                               TO  WRK-SYUNOU-CYOKI-FTNMONEY
               ELSE
                 MOVE   FTN-CYOKI-XXX
                               TO  WRK-SYUNOU-CYOKI-FTNMONEY
               END-IF
               IF  WRK-SYUNOU-CYOKI-FTNMONEY  NOT = ZERO
                 ADD    WRK-SYUNOU-CYOKI-FTNMONEY
                               TO  FTN-KOH-XXX
                                   WRK-CHK-ICHIBUGAKU
                                   RECE02-FTNMONEY(1)
                 MOVE     1    TO  FLG-CYOKI-HENSYU
               END-IF
             END-IF
           END-IF
      *
           .
       211TX2-CYOKI-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルへの薬剤一部負担金セット（Ｆ００２）
      *****************************************************************
       2105-YKZFTN-SET-SEC                SECTION.
      *
           INITIALIZE                           SYUNOU-REC
grpsys     MOVE    RECE02-HOSPNUM       TO      SYU-HOSPNUM
           MOVE    RECE02-NYUGAIKBN     TO      SYU-NYUGAIKBN
           MOVE    RECE02-PTID          TO      SYU-PTID
           MOVE    RECE02-SRYKA(IDX)    TO      SYU-SRYKA
           MOVE    RECE02-SRYYM         TO      SYU-SRYYMD(1:6)
           MOVE    "__"                 TO      SYU-SRYYMD(7:2)
           MOVE    SYUNOU-REC           TO      MCPDATA-REC
           MOVE    "tbl_syunou"         TO      MCP-TABLE
           MOVE    "key16"              TO      MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_syunou"         TO      MCP-TABLE
               MOVE    "key16"              TO      MCP-PATHNAME
               PERFORM  900-SYUNOU-READ-SEC
               PERFORM  UNTIL
                        (FLG-SYUNOU             =    1)
                   PERFORM  VARYING  IDX1   FROM  1   BY  1
                             UNTIL   IDX1    >    10
                              OR   RECE02-HKNCOMBI (IDX1)   =   ZERO
                       IF    SYU-HKNCOMBINUM   =
                                            RECE02-HKNCOMBI (IDX1)
                         IF  SYU-DENPJTIKBN    NOT =  "3"
                           MOVE    ZERO   TO   FLG-HANTEI
                           IF  SYU-TOTAL-HKNTEN    NOT = ZERO
                             MOVE    1    TO   FLG-HANTEI
                           END-IF
      *
                           IF   RECE02-DAISANFLG(IDX1) =  1
                             IF   (RECE02-DAISAN-GAITO    =   1 OR 2)
                             AND  (RECE02-DAISAN-GENBUTU-GAITO  =  1)
                               PERFORM   21052-RECE02-HENSYU3-SEC
                               PERFORM   21052X-KOHJNISSUTBL-HENSYU-SEC
                               IF  SYU-BUNBENINFFLG  =  "1"
                                 PERFORM 21053-BUNBEN-TOKKI-HENSYU-SEC
                               END-IF
                             ELSE
                               IF  FLG-HANTEI  =  1
                                 PERFORM 21054-RECE02-HENSYU3-XXX-SEC
                               END-IF
                             END-IF
                           ELSE
                             PERFORM   21052-RECE02-HENSYU3-SEC
                             PERFORM   21052X-KOHJNISSUTBL-HENSYU-SEC
                             IF  SYU-BUNBENINFFLG  =  "1"
                               PERFORM 21053-BUNBEN-TOKKI-HENSYU-SEC
                             END-IF
                           END-IF
                         END-IF
                         MOVE    10             TO      IDX1
                       END-IF
                   END-PERFORM
                   MOVE    "tbl_syunou"         TO      MCP-TABLE
                   MOVE    "key16"              TO      MCP-PATHNAME
                   PERFORM   900-SYUNOU-READ-SEC
               END-PERFORM
           ELSE
               DISPLAY   "SYUNOU SELECT ERR"
           END-IF
      *
           MOVE    "tbl_syunou"         TO      MCP-TABLE
           MOVE    "key16"              TO      MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
           .
       2105-YKZFTN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送−薬剤一部負担金（Ｆ００２）
      *****************************************************************
       21052-RECE02-HENSYU3-SEC               SECTION.
      *
           IF  FLG-HANTEI  =  1
             IF    SYU-YKZKENNUM   =   1  OR  2  OR  5
                COMPUTE  WK-GENGAKU-KEISAN1 = SYU-TOTAL-HKNTEN
                                            * 10
                                            * RECE02-KYURATE
                                            / 100
                ADD   WK-GENGAKU-KEISAN1  TO  WK-GENGAKU-KEISAN2
      *
                COMPUTE  WK-GENGAKU-KEISAN1 = SYU-TOTAL-HKNTEN
                                            * 10
                                            * RECE02-KYURATE
                                            / 100
                COMPUTE  WK-GENGAKU-KEISAN1 = WK-GENGAKU-KEISAN1 +  5
                COMPUTE  WK-GENGAKU-KEISAN1 = WK-GENGAKU-KEISAN1 / 10
                COMPUTE  WK-GENGAKU-KEISAN1 = WK-GENGAKU-KEISAN1 * 10
                COMPUTE  WK-GENGAKU-KEISAN1 = WK-GENGAKU-KEISAN1
                                            + SYU-GRP-SGKMONEY
                ADD   WK-GENGAKU-KEISAN1  TO  WK-GENGAKU-KEISAN3
      *
                IF   (SYU-SYUHKNNUM   NOT =  SPACE)
                AND  (SYU-KOH1HKNNUM      =  SPACE)
                AND  (SYU-KOH2HKNNUM      =  SPACE)
                AND  (SYU-KOH3HKNNUM      =  SPACE)
                AND  (SYU-KOH4HKNNUM      =  SPACE)
                  CONTINUE
                ELSE
                  MOVE  1     TO   FLG-GENGAKU5
                END-IF
             END-IF
      *
             IF    SYU-YKZKENNUM  NOT = ZERO
               MOVE    1     TO   FLG-GENMEN-ARI
             ELSE
               MOVE    1     TO   FLG-GENMEN-NASI
               IF  SYU-KOH-HKNNUM(1)  = "970"
                 ADD   SYU-SYUCOMPFTN   TO  WRK-GENMEN-NASI-KIN
               ELSE
                 ADD   SYU-HKNTEKMONEY  TO  WRK-GENMEN-NASI-KIN
                 ADD   SYU-KOH-FTN      TO  WRK-GENMEN-NASI-KIN
               END-IF
             END-IF
      *
      *      請求額収納編集
             PERFORM   210526-SKY-SYUNOU-HENSYU-SEC
           END-IF
      *
      *    収納より総点数を集計
           ADD       SYU-TOTAL-HKNTEN   TO   RECE02-RJNGAIFTN
      *
           COMPUTE   RECE02-YKZFTN(1)   =    RECE02-YKZFTN(1)   +
                                             SYU-SYUCOMPYKZFTN
           IF      RECE02-SRYYM      >=  "200210"
             IF    RECE02-ZAITAKU  =   "1" OR "2"
               IF  SYU-SYUHKNNUM  NOT = SPACE
                EVALUATE  RECE02-ZAITAKU
                  WHEN      "1"
                    PERFORM     210521-HOKEN-FUTAN-HENSYU-SEC
                  WHEN      "2"
                    PERFORM     210525-HOKEN-FUTAN-HENSYU2-SEC
                END-EVALUATE
               END-IF
             ELSE                                                       
      *         船員保険（被保険者）＋通勤災害
                IF    RECE02-SENIN-TUUSAI     =    "1"
                  ADD    SYU-SYUCOMPFTN   TO   RECE02-FTNMONEY(1)
                END-IF
      *         老人減免
                IF    RECE02-RJNHKNNUM   NOT  =    SPACE
                AND   WK-GENGAKUKBN      NOT  =    ZERO
                   EVALUATE  WK-GENGAKUKBN
                     WHEN        1
                       IF    WK-GENGAKU-RITU  =  100
                          MOVE   1      TO   RECE02-RJNNYUFTN
                       ELSE
                          ADD    SYU-KOH1COMPFTN
                                        TO   RECE02-FTNMONEY(1)
                          MOVE   1      TO   RECE02-RJNNYUFTN
                       END-IF
                   END-EVALUATE
                ELSE
                 IF    RECE02-KOUREI-HANTEIFLG   =    "1"
                 AND   WK-GENGAKUKBN        NOT  =    ZERO
                   EVALUATE  WK-GENGAKUKBN
                     WHEN        1
                       IF    WK-GENGAKU-RITU  =  100
                          MOVE   1      TO   RECE02-RJNNYUFTN
                       ELSE
                          ADD    SYU-SYUCOMPFTN
                                        TO   RECE02-FTNMONEY(1)
                          MOVE   1      TO   RECE02-RJNNYUFTN
                       END-IF
                   END-EVALUATE
                 END-IF
                END-IF
                IF  (IDZ                 =     1    )
                AND (RECE02-SRYYM       >=  "201004")
                AND (SYU-SYUHKNNUM   NOT =   SPACE  )
                  IF    RECE02-SENIN-TUUSAI     =    "1"
                  OR    RECE02-RJNNYUFTN        =     1
                    CONTINUE
                  ELSE
                    MOVE    1    TO   FLG-WRKFILE-CLEAR
                    IF   RECE02-KOUREI-HANTEIFLG   =   "1"
                      PERFORM   210521-HOKEN-FUTAN-HENSYU-SEC
                    ELSE
                      PERFORM   210525-HOKEN-FUTAN-HENSYU2-SEC
                    END-IF
                  END-IF
                END-IF
             END-IF
           ELSE
             IF    RECE02-RJNHKNNUM    NOT =    SPACE
                ADD    SYU-KOH1COMPFTN  TO   RECE02-FTNMONEY(1)
             END-IF
      *      船員保険（被保険者）＋通勤災害
             IF    RECE02-SENIN-TUUSAI     =    "1"
                ADD    SYU-SYUCOMPFTN   TO   RECE02-FTNMONEY(1)
             END-IF
           END-IF
      *
           MOVE    IDX1            TO  HC-IDX
      *
           MOVE    ZERO            TO  KH-IDX
      *
           IF  FLG-HANTEI  =  1
            PERFORM    VARYING   IDX2    FROM   1   BY   1
              UNTIL    IDX2      >       4
              IF      RECE02-KOHNUMHC(HC-IDX IDX2)  NOT =  SPACE
                 IF   RECE02-KOHNUMHC(HC-IDX IDX2) =  RECE02-KOHNUM(1)
                 AND  RECE02-KOHIDHC(HC-IDX IDX2)  =  RECE02-KOHID(1)
                      MOVE    2          TO        KH-IDX
                      EVALUATE  TRUE
                          WHEN  RECE02-KOHNUM(1)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE02-KOHNUM(1)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE02-KOHNUM(1)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE02-KOHNUM(1)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
      *
                      PERFORM   210524-FTNMONEY-HENSYU-SEC
      *
                      PERFORM   210523-FTNMONEY-FTN-HENSYU-SEC
                 END-IF
                 IF   RECE02-KOHNUMHC(HC-IDX IDX2) =  RECE02-KOHNUM(2)
                 AND  RECE02-KOHIDHC(HC-IDX IDX2)  =  RECE02-KOHID(2)
                      MOVE    3          TO        KH-IDX
                      EVALUATE  TRUE
                          WHEN  RECE02-KOHNUM(2)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE02-KOHNUM(2)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE02-KOHNUM(2)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE02-KOHNUM(2)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
      *
                      PERFORM   210524-FTNMONEY-HENSYU-SEC
      *
                      PERFORM   210523-FTNMONEY-FTN-HENSYU-SEC
                 END-IF
                 IF   RECE02-KOHNUMHC(HC-IDX IDX2) =  RECE02-KOHNUM(3)
                 AND  RECE02-KOHIDHC(HC-IDX IDX2)  =  RECE02-KOHID(3)
                      MOVE    4          TO        KH-IDX
                      EVALUATE  TRUE
                          WHEN  RECE02-KOHNUM(3)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE02-KOHNUM(3)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE02-KOHNUM(3)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE02-KOHNUM(3)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
      *
                      PERFORM   210524-FTNMONEY-HENSYU-SEC
      *
                      PERFORM   210523-FTNMONEY-FTN-HENSYU-SEC
                 END-IF
                 IF   RECE02-KOHNUMHC(HC-IDX IDX2) =  RECE02-KOHNUM(4)
                 AND  RECE02-KOHIDHC(HC-IDX IDX2)  =  RECE02-KOHID(4)
                      MOVE    5          TO        KH-IDX
                      EVALUATE  TRUE
                          WHEN  RECE02-KOHNUM(4)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE02-KOHNUM(4)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE02-KOHNUM(4)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE02-KOHNUM(4)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
      *
                      PERFORM   210524-FTNMONEY-HENSYU-SEC
      *
                      PERFORM   210523-FTNMONEY-FTN-HENSYU-SEC
                 END-IF
              END-IF
            END-PERFORM
           END-IF
           .
       21052-RECE02-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送−薬剤一部負担金（Ｆ００２）
      *    （第三者行為）
      *****************************************************************
       21054-RECE02-HENSYU3-XXX-SEC               SECTION.
      *
           MOVE  1                  TO   FLG-GENMEN-NASI
           ADD   SYU-SYUCOMPFTN     TO   WRK-GENMEN-NASI-KIN
      *
      *  （１）（１００％−負担割合）分は、医保分の保険者負担に集計
      *  （２）負担割合分は、自賠責の保険者負担に集計
      *
           ADD   SYU-TOTAL-HKNTEN   TO   RECE02-SKYIRYO-TOTALTEN
      *
      ***  IF   WRK-DAISAN-DAISANKBN  =  "1"
      ***    COMPUTE  WRK-SKY-KEISAN6 =  SYU-TOTAL-HKNTEN
      ***                             *  10
      ***                             *  RECE02-KYURATE
      ***                             /  100
      ***    COMPUTE  WRK-SKY-KEISAN6 =
      ***             WRK-SKY-KEISAN6 +  5
      ***    COMPUTE  WRK-SKY-KEISAN6 =
      ***             WRK-SKY-KEISAN6 /  10
      ***    COMPUTE  WRK-SKY-KEISAN6 =
      ***             WRK-SKY-KEISAN6 *  10
      ***    COMPUTE  WRK-SKY-KEISAN  = (SYU-TOTAL-HKNTEN * 10)
      ***                             -  WRK-SKY-KEISAN6
      ***  ELSE
             COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                      *  10
                                      * (100 - RECE02-KYURATE)
                                      /  100
      ***  END-IF
           ADD   WRK-SKY-KEISAN     TO   RECE02-SKYIRYO-HOKENJA
      *
           .
       21054-RECE02-HENSYU3-XXX-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費受診日の編集
      *****************************************************************
       21052X-KOHJNISSUTBL-HENSYU-SEC               SECTION.
      *
           MOVE       IDX1              TO   HC-IDX
      *
           PERFORM    VARYING   IDX2    FROM   1   BY   1
             UNTIL    IDX2      >       4
              IF      RECE02-KOHNUMHC(HC-IDX IDX2)  NOT =  SPACE
                 IF   RECE02-KOHNUMHC(HC-IDX IDX2) =  RECE02-KOHNUM(1)
                 AND  RECE02-KOHIDHC(HC-IDX IDX2)  =  RECE02-KOHID(1)
                      EVALUATE  TRUE
                          WHEN  RECE02-KOHNUM(1)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE02-KOHNUM(1)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE02-KOHNUM(1)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE02-KOHNUM(1)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
                      MOVE      2             TO   IDX30
                      PERFORM   210522-KOHJNISSUTBL-SET-SEC
                 END-IF
                 IF   RECE02-KOHNUMHC(HC-IDX IDX2) =  RECE02-KOHNUM(2)
                 AND  RECE02-KOHIDHC(HC-IDX IDX2)  =  RECE02-KOHID(2)
                      EVALUATE  TRUE
                          WHEN  RECE02-KOHNUM(2)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE02-KOHNUM(2)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE02-KOHNUM(2)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE02-KOHNUM(2)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
                      MOVE      3             TO   IDX30
                      PERFORM   210522-KOHJNISSUTBL-SET-SEC
                 END-IF
                 IF   RECE02-KOHNUMHC(HC-IDX IDX2) =  RECE02-KOHNUM(3)
                 AND  RECE02-KOHIDHC(HC-IDX IDX2)  =  RECE02-KOHID(3)
                      EVALUATE  TRUE
                          WHEN  RECE02-KOHNUM(3)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE02-KOHNUM(3)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE02-KOHNUM(3)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE02-KOHNUM(3)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
                      MOVE      4             TO   IDX30
                      PERFORM   210522-KOHJNISSUTBL-SET-SEC
                 END-IF
                 IF   RECE02-KOHNUMHC(HC-IDX IDX2) =  RECE02-KOHNUM(4)
                 AND  RECE02-KOHIDHC(HC-IDX IDX2)  =  RECE02-KOHID(4)
                      EVALUATE  TRUE
                          WHEN  RECE02-KOHNUM(4)  =  SYU-KOH-HKNNUM(1)
                                MOVE     1    TO   IDX3
                          WHEN  RECE02-KOHNUM(4)  =  SYU-KOH-HKNNUM(2)
                                MOVE     2    TO   IDX3
                          WHEN  RECE02-KOHNUM(4)  =  SYU-KOH-HKNNUM(3)
                                MOVE     3    TO   IDX3
                          WHEN  RECE02-KOHNUM(4)  =  SYU-KOH-HKNNUM(4)
                                MOVE     4    TO   IDX3
                      END-EVALUATE
                      MOVE      5             TO   IDX30
                      PERFORM   210522-KOHJNISSUTBL-SET-SEC
                 END-IF
              END-IF
           END-PERFORM
      *
      *    ３歳児視覚聴覚精密健康診査（地域公費）の点数集計
           EVALUATE   SYS-1001-PREFNUM
             WHEN    "38"
               IF   (SYU-KOH-HKNNUM(1) = "394")
               OR   (SYU-KOH-HKNNUM(2) = "394")
               OR   (SYU-KOH-HKNNUM(3) = "394")
               OR   (SYU-KOH-HKNNUM(4) = "394")
                 IF  RECE02-TEISYUTUSAKI  =  2
                    MOVE   1                TO  RECE02-SEIKENFLG
                    ADD   SYU-TOTAL-HKNTEN  TO  RECE02-SEIKENTEN
                 END-IF
               END-IF
           END-EVALUATE
      *
           .
       21052X-KOHJNISSUTBL-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険分負担金額編集
      *****************************************************************
       210521-HOKEN-FUTAN-HENSYU-SEC               SECTION.
      *
           MOVE     ZERO    TO   FLG-KEISAN
           MOVE     ZERO    TO   FLG-KEISAN2
           MOVE     ZERO    TO   FLG-KEISAN3
      *
           MOVE     ZERO    TO   FLG-KGKIPNTAI
           MOVE     ZERO    TO   FLG-WRKFILE-KGKTAI
           IF    SYU-KOH-HKNNUM(1)(1:1)  >= "1" AND <= "8"
             IF  ((RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)) AND
                  (RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1) ))
             OR  ((RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)) AND
                  (RECE02-KOHID(2)  = RECE02-KOHIDHC(IDX1 1) ))
             OR  ((RECE02-KOHNUM(3) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE02-KOHNUM(3) = RECE02-KOHNUMHC(IDX1 1)) AND
                  (RECE02-KOHID(3)  = RECE02-KOHIDHC(IDX1 1) ))
             OR  ((RECE02-KOHNUM(4) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE02-KOHNUM(4) = RECE02-KOHNUMHC(IDX1 1)) AND
                  (RECE02-KOHID(4)  = RECE02-KOHIDHC(IDX1 1) ))
                 IF   FLG-WRKFILE-CLEAR  =  ZERO
                     MOVE    1    TO   FLG-KGKIPNTAI
                 END-IF
                 IF   FLG-WRKFILE-CLEAR  =  1
                     MOVE    1    TO   FLG-WRKFILE-KGKTAI
                 END-IF
             END-IF
           END-IF
      *
           COMPUTE  WRK-FTNKEI = SYU-TOTAL-HKNTEN
                               * 10
                               * RECE02-KYURATE
                               / 100
           IF   FLG-WRKFILE-CLEAR   =   ZERO
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
      *
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI
                                 + SYU-GRP-SGKMONEY
           END-IF
      *
           COMPUTE  WRK-FTNKEI-Z = SYU-TOTAL-HKNTEN
                                 * 10
                                 * 20
                                 / 100
      *
           IF  (( SYU-KOH-FTN         =   ZERO          ) AND
                ( SYU-KOH-HKNNUM(1)   =   SPACE OR "027") AND
                ( SYU-KOH-HKNNUM(2)   =   SPACE         ) AND
                ( SYU-KOH-HKNNUM(3)   =   SPACE         ) AND
                ( SYU-KOH-HKNNUM(4)   =   SPACE         ))
           OR  (  SYU-KOH-HKNNUM(1)   =   "970"          )
             IF    (FLG-WRKFILE-CLEAR   =  ZERO)
             AND   (FLG-HANTEI          =  1   )
               MOVE    1      TO    FLG-HOKENICHIBU-SYU
               IF    RECE02-RJNHKNNUM    NOT =    SPACE
                 ADD    SYU-KOH1COMPFTN  TO   RECE02-FTNMONEY(1)
                                              WRK-KOH-GAI
                                              WRK-KOH-GAI2
               ELSE
                 ADD    SYU-SYUCOMPFTN   TO   RECE02-FTNMONEY(1)
                                              WRK-KOH-GAI
                                              WRK-KOH-GAI2
               END-IF
               MOVE     1                TO   FLG-JYOGENKBN
               ADD      SYU-SYUCOMPFTN   TO   WRK-KOH-GAI-GEN70
               ADD      WRK-FTNKEI-Z     TO   WRK-KOH-GAI-GEN70-Z
               ADD      SYU-TOTAL-HKNTEN TO   WRK-KOH-GAI-GEN70-TEN
               ADD      SYU-TOTAL-HKNTEN TO   WRK-JYOGENKBN-TEN
                                              WRK-JYOGENKBN-TEN4
             END-IF
           ELSE
             IF  FLG-HANTEI  =  1
               MOVE    1      TO    FLG-HOKENICHIBU
             END-IF
             ADD    SYU-KOH-FTN          TO   WRK-KOH-FTN-GEN70
             IF  ((SYU-KOH-HKNNUM(1) = "012" OR "025") OR
                  (SYU-KOH-HKNNUM(2) = "012" OR "025") OR
                  (SYU-KOH-HKNNUM(3) = "012" OR "025") OR
                  (SYU-KOH-HKNNUM(4) = "012" OR "025"))
             AND ( FLG-ZENKOKUKOHI-NISYU    NOT =   5 )
              IF   SYU-SYUHKNNUM  NOT = SPACE
               MOVE        1         TO   FLG-JYOGENKBN2
               IF  FLG-TOKU75 = 1 OR 2
                 MOVE      4000      TO   WRK-KINGAKU
               ELSE
                 MOVE      8000      TO   WRK-KINGAKU
               END-IF
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
      ****     PERFORM     2105219-ICHIBUFTN-NISYU-HEN-SEC
              END-IF
             ELSE
               IF   ( SYU-KOH-HKNNUM(1) =   "972" )
               OR   ( SYU-KOH-HKNNUM(2) =   "972" )
               OR   ( SYU-KOH-HKNNUM(3) =   "972" )
               OR   ( SYU-KOH-HKNNUM(4) =   "972" )
                 IF  ((SYU-KOH-HKNNUM(1)(1:1)  = "0"  ) AND
                      (SYU-KOH-HKNNUM(1)   NOT = "027"))
                 OR  ( SYU-KOH-HKNNUM(2)(1:1)  = "0"   )
                 OR  ( SYU-KOH-HKNNUM(3)(1:1)  = "0"   )
                 OR  ( SYU-KOH-HKNNUM(4)(1:1)  = "0"   )
                 OR  ( TBL-TOKATUKAIFLG2       =  1    )
                 OR  ((FLG-ZENKOKUKOHI-NISYU   =  4              ) AND
                      (RECE02-KOHNUM(1) = "972"                  ) AND
                      (RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)      ) AND
                      (RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)) AND
                      (RECE02-KOHID(2)  = RECE02-KOHIDHC (IDX1 1)))
                 OR  ((FLG-ZENKOKUKOHI-NISYU   =  4              ) AND
                      (RECE02-KOHNUM(1) NOT = "972"              ) AND
                      (RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)      ) AND
                      (RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)) AND
                      (RECE02-KOHID(1)  = RECE02-KOHIDHC (IDX1 1)))
                   MOVE     1        TO   FLG-KEISAN-TOK1
                   MOVE     3        TO   FLG-KEISAN
                 ELSE
                   MOVE     1        TO   FLG-KEISAN-TOK2
                   MOVE     4        TO   FLG-KEISAN
                 END-IF
                 IF  (SYU-KOH-HKNNUM(1) =  "972")
                 AND (SYU-KOH-HKNNUM(2) =  SPACE)
                 AND (SYU-KOH-HKNNUM(3) =  SPACE)
                 AND (SYU-KOH-HKNNUM(4) =  SPACE)
                   ADD  SYU-KOH-FTN  TO   WRK-CYOKI-KOH-FTN
                 ELSE
                   IF  (SYU-KOH-HKNNUM(2)    =  "972"      )
                   AND (SYU-KOH1HKNFTNMONEY  >  SYU-KOH-FTN)
                     COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH1HKNFTNMONEY
                                                - SYU-KOH-FTN
                     COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                + WRK-CYOKI-KOH-FTN3
                   END-IF
                   IF  (SYU-KOH-HKNNUM(3)    =  "972"      )
                   AND (SYU-KOH2HKNFTNMONEY  >  SYU-KOH-FTN)
                     COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH2HKNFTNMONEY
                                                - SYU-KOH-FTN
                     COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                + WRK-CYOKI-KOH-FTN3
                   END-IF
                   IF  (SYU-KOH-HKNNUM(4)    =  "972"      )
                   AND (SYU-KOH3HKNFTNMONEY  >  SYU-KOH-FTN)
                     COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH3HKNFTNMONEY
                                                - SYU-KOH-FTN
                     COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                + WRK-CYOKI-KOH-FTN3
                   END-IF
                 END-IF
                 MOVE       1        TO   FLG-CYOKI-KINGAKU-SET
                 PERFORM    210521B-CYOKI-KINGAKU-SET-SEC
                 MOVE  WRK-KINGAKU   TO   WRK-CYOKI-JGNGAK
      *****      IF  FLG-ZENKOKUKOHI-NISYU  =  5
      *****         IF  RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)
      *****         AND RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)
      *****         AND RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1)
      *****           MOVE    5      TO   FLG-JYOGENKBN2
      *****           MOVE    WRK-KINGAKU
      *****                          TO   WRK-KINGAKU-GENBUTU2
      *****         END-IF
      *****      ELSE
                    IF  RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                    AND RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)
                    AND RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1)
                      MOVE    WRK-KINGAKU
                                     TO   WRK-KINGAKU-GENBUTU2-XXX
                    END-IF
                    IF ((RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)      ) AND
                        (RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)) AND
                        (RECE02-KOHID(2)  = RECE02-KOHIDHC(IDX1 1) ))
                    OR ((RECE02-KOHNUM(3) = SYU-KOH-HKNNUM(1)      ) AND
                        (RECE02-KOHNUM(3) = RECE02-KOHNUMHC(IDX1 1)) AND
                        (RECE02-KOHID(3)  = RECE02-KOHIDHC(IDX1 1) ))
                    OR ((RECE02-KOHNUM(4) = SYU-KOH-HKNNUM(1)      ) AND
                        (RECE02-KOHNUM(4) = RECE02-KOHNUMHC(IDX1 1)) AND
                        (RECE02-KOHID(4)  = RECE02-KOHIDHC(IDX1 1) ))
                      MOVE    WRK-KINGAKU
                                     TO   WRK-KINGAKU-GENBUTU4-XXX
                    END-IF
      *****      END-IF
                 IF    FLG-KEISAN   =    4
                   PERFORM    2105215-ICHIBUFTN-GEN-SEC
                 END-IF
                 PERFORM      2105211-ICHIBUFTN-KOH-SET-SEC
                 PERFORM      2105219-ICHIBUFTN-NISYU-HEN-SEC
               ELSE
                 IF      FLG-ZENKOH-ARI  =  ZERO
                   IF  FLG-WRKFILE-CLEAR  =  ZERO
                   OR  FLG-WRKFILE-KGKTAI =   1
                     IF   FLG-ZENKOKUKOHI-NISYU  =  4
                       IF  RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                       AND RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)
                       AND RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1)
                          MOVE    1    TO   FLG-KEISAN2
                       END-IF
                       IF  RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                       AND RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)
                       AND RECE02-KOHID(2)  = RECE02-KOHIDHC(IDX1 1)
                          MOVE    2    TO   FLG-KEISAN2
                       END-IF
                     END-IF
                     MOVE         4    TO   FLG-JYOGENKBN2
                     PERFORM   2105212-ICHIBUFTN-KOH-HEN1-SEC
                   ELSE
                     ADD    WRK-FTNKEI   TO   RECE02-FTNMONEY(1)
                   END-IF
                   IF  (RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1))
                   OR  (RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1))
                   OR  (RECE02-KOHNUM(3) = SYU-KOH-HKNNUM(1))
                   OR  (RECE02-KOHNUM(4) = SYU-KOH-HKNNUM(1))
                    CONTINUE
                   ELSE
                    IF (RECE02-KOHSKY-KOHNUM(1)
                                         = SYU-KOH-HKNNUM(1))
                    OR (RECE02-KOHSKY-KOHNUM(2)
                                         = SYU-KOH-HKNNUM(1))
                    OR (RECE02-KOHSKY-KOHNUM(3)
                                         = SYU-KOH-HKNNUM(1))
                    OR (RECE02-KOHSKY-KOHNUM(4)
                                         = SYU-KOH-HKNNUM(1))
                     ADD    SYU-TOTAL-HKNTEN
                                         TO   WRK-JYOGENKBN-TEN5
                    END-IF
                   END-IF
                 ELSE
                   IF  ((SYU-KOH-HKNNUM(1)(1:1)    = "0"  ) AND
                        (SYU-KOH-HKNNUM(1)     NOT = "027"))
                   OR  ( SYU-KOH-HKNNUM(2)(1:1)    = "0"   )
                   OR  ( SYU-KOH-HKNNUM(3)(1:1)    = "0"   )
                   OR  ( SYU-KOH-HKNNUM(4)(1:1)    = "0"   )
                   OR  ( TBL-TOKATUKAIFLG2         =  1    )
      *
                     IF  FLG-HANTEI  =  1
                       MOVE       1    TO   FLG-HOKENICHIBU7
                       IF   SYU-KOH-HKNNUM(1)(1:1) >= "1" AND <= "8"
                         IF  TBL-TOKATUKAIFLG2  =  1
                           CONTINUE
                         ELSE
                           MOVE   1    TO   FLG-HOKENICHIBU2
                         END-IF
                       END-IF
                       IF  (SYU-KOH-HKNNUM(2)(1:1) >= "1" AND <= "8")
                       OR  (SYU-KOH-HKNNUM(3)(1:1) >= "1" AND <= "8")
                       OR  (SYU-KOH-HKNNUM(4)(1:1) >= "1" AND <= "8")
                         MOVE     1    TO   FLG-HOKENICHIBU2
                       END-IF
                     END-IF
      *
                     IF   FLG-ZENKOKUKOHI-NISYU  =  1 OR 5
                       IF  RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                       AND RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)
                       AND RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1)
                          MOVE    1    TO   FLG-KEISAN2
                       END-IF
                       IF  RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                       AND RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)
                       AND RECE02-KOHID(2)  = RECE02-KOHIDHC(IDX1 1)
                          MOVE    2    TO   FLG-KEISAN2
                       END-IF
                     END-IF
                     PERFORM  2105216-TOKUSITU-HENSYU-SEC
                     ADD  SYU-TOTAL-HKNTEN
                                       TO   WRK-JYOGENKBN-TEN2
                   ELSE
                     IF  (( RECE02-KYURATE    =   30      ) OR
                          ((RECE02-KYURATE    =   20     ) AND
                           (RECE02-SRYYM      <  "200804")))
                     AND (( SYU-KOH-HKNNUM(1) =  "974"    ) OR
                          ( SYU-KOH-HKNNUM(2) =  "974"    ) OR
                          ( SYU-KOH-HKNNUM(3) =  "974"    ) OR
                          ( SYU-KOH-HKNNUM(4) =  "974"    ))
                       IF   RECE02-RJNGENMENKBN  =  SPACE
                         IF  FLG-TOKU75 = 1 OR 2
                           MOVE    10000  TO   WRK-KINGAKU
                         ELSE
                           MOVE    20000  TO   WRK-KINGAKU
                         END-IF
                       ELSE
                         MOVE      12000  TO   WRK-KINGAKU
                       END-IF
                       MOVE  WRK-KINGAKU  TO   WRK-CYOKI-JGNGAK
                       PERFORM     2105215-ICHIBUFTN-GEN-SEC
                       PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
                     ELSE
                       IF  FLG-HANTEI  =  1
                          MOVE   1      TO   FLG-HOKENICHIBU3
                       END-IF
                       IF  RECE02-RJNGENMENKBN  =   "1"
                          MOVE   1      TO   FLG-RJNGENMEN-CHIARI
                       END-IF
                       IF  FLG-ZENKOKUKOHI-NISYU  =  2 OR 4
                          MOVE   2      TO   FLG-KEISAN
                       ELSE
                          MOVE   1      TO   FLG-KEISAN
                       END-IF
                       IF  FLG-WRKFILE-CLEAR  =  ZERO
                       OR  FLG-WRKFILE-KGKTAI =   1
                         IF  FLG-JYOGENKBN = ZERO
                           MOVE      2       TO   FLG-JYOGENKBN
                         END-IF
                         MOVE        1       TO   FLG-JYOGENKBN3
                         PERFORM   2105212-ICHIBUFTN-KOH-HEN1-SEC
                       ELSE
                         ADD    WRK-FTNKEI   TO   RECE02-FTNMONEY(1)
                       END-IF
                       IF  (RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1))
                       OR  (RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1))
                       OR  (RECE02-KOHNUM(3) = SYU-KOH-HKNNUM(1))
                       OR  (RECE02-KOHNUM(4) = SYU-KOH-HKNNUM(1))
                        CONTINUE
                       ELSE
                        IF (RECE02-KOHSKY-KOHNUM(1)
                                             = SYU-KOH-HKNNUM(1))
                        OR (RECE02-KOHSKY-KOHNUM(2)
                                             = SYU-KOH-HKNNUM(1))
                        OR (RECE02-KOHSKY-KOHNUM(3)
                                             = SYU-KOH-HKNNUM(1))
                        OR (RECE02-KOHSKY-KOHNUM(4)
                                             = SYU-KOH-HKNNUM(1))
                         ADD    SYU-TOTAL-HKNTEN
                                      TO   WRK-JYOGENKBN-TEN5
                        END-IF
                       END-IF
                     END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF   SYU-SYUHKNNUM  NOT = SPACE
              ADD   SYU-KOH-FTN   TO   WRK-KOH-FTN
              IF  (SYU-SKJ-FTNGAKU(1)  =     1   )
              AND (RECE02-SRYYM       >= "201204")
                 MOVE    1   TO   FLG-GENBUTU-HANTEI
              END-IF
           END-IF
      *
           .
       210521-HOKEN-FUTAN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険分負担金額編集
      *****************************************************************
       210525-HOKEN-FUTAN-HENSYU2-SEC               SECTION.
      *
           MOVE     ZERO    TO   FLG-KEISAN
           MOVE     ZERO    TO   FLG-KEISAN2
           MOVE     ZERO    TO   FLG-KEISAN3
      *
           MOVE     ZERO    TO   FLG-KGKIPNTAI
           MOVE     ZERO    TO   FLG-WRKFILE-KGKTAI
           IF    SYU-KOH-HKNNUM(1)(1:1)  >= "1" AND <= "8"
             IF  ((RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)) AND
                  (RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1) ))
             OR  ((RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)) AND
                  (RECE02-KOHID(2)  = RECE02-KOHIDHC(IDX1 1) ))
             OR  ((RECE02-KOHNUM(3) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE02-KOHNUM(3) = RECE02-KOHNUMHC(IDX1 1)) AND
                  (RECE02-KOHID(3)  = RECE02-KOHIDHC(IDX1 1) ))
             OR  ((RECE02-KOHNUM(4) = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE02-KOHNUM(4) = RECE02-KOHNUMHC(IDX1 1)) AND
                  (RECE02-KOHID(4)  = RECE02-KOHIDHC(IDX1 1) ))
                 IF   FLG-WRKFILE-CLEAR  =  ZERO
                     MOVE    1    TO   FLG-KGKIPNTAI
                 END-IF
                 IF   FLG-WRKFILE-CLEAR  =  1
                     MOVE    1    TO   FLG-WRKFILE-KGKTAI
                 END-IF
             END-IF
           END-IF
      *
           COMPUTE  WRK-FTNKEI = SYU-TOTAL-HKNTEN
                               * 10
                               * RECE02-KYURATE
                               / 100
           IF   FLG-WRKFILE-CLEAR   =   ZERO
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
      *
             COMPUTE  WRK-FTNKEI = WRK-FTNKEI
                                 + SYU-GRP-SGKMONEY
           END-IF
      *
           IF  (( SYU-KOH-FTN         =   ZERO  ) AND
                ( SYU-KOH-HKNNUM(1)   =   SPACE ) AND
                ( SYU-KOH-HKNNUM(2)   =   SPACE ) AND
                ( SYU-KOH-HKNNUM(3)   =   SPACE ) AND
                ( SYU-KOH-HKNNUM(4)   =   SPACE ))
           OR  (  SYU-KOH-HKNNUM(1)   =   "970"  )
             IF    (FLG-WRKFILE-CLEAR   =  ZERO)
             AND   (FLG-HANTEI          =  1   )
                 MOVE      1             TO   FLG-HOKENICHIBU-SYU
                 ADD    SYU-SYUCOMPFTN   TO   RECE02-FTNMONEY(1)
                                              WRK-KOH-GAI
                                              WRK-KOH-GAI2
                 MOVE   1                TO   FLG-JYOGENKBN
                 IF ((WRK-SYUNOU-GEN70T-HANTEIFLG  =  1      ) AND
                     (RECE02-SRYYM                >= "201204"))
                 OR ((SYU-SKJ-FTNGAKU(2)       NOT = ZERO    ) AND
                     (RECE02-SRYYM                <= "201203"))
                     MOVE      1         TO   FLG-GENBUTU-TAISYOOK
                     ADD  SYU-TOTAL-HKNTEN
                                         TO   WRK-KOH-GAI-GEN70-TEN
                     ADD  SYU-TOTAL-HKNTEN
                                         TO   WRK-JYOGENKBN-TEN
                 END-IF
                 ADD    SYU-SYUCOMPFTN   TO   WRK-KOH-GAI-GEN70
                 ADD    SYU-TOTAL-HKNTEN TO   WRK-JYOGENKBN-TEN3
                                              WRK-JYOGENKBN-TEN4
             END-IF
             ADD        SYU-TOTAL-HKNTEN TO   WRK-JYOGENKBN-TEN6
           ELSE
             IF  FLG-HANTEI  =  1
               MOVE    1      TO    FLG-HOKENICHIBU
             END-IF
             IF ((WRK-SYUNOU-GEN70-HANTEIFLG(IDX1) = 1    ) AND
                 (RECE02-SRYYM     >= "201204"            ))
             OR ((WRK-SYUNOU-GEN70-GASSANFLG(IDX1) = 9    ) AND
                 (RECE02-SRYYM     >= "201204"            ))
             OR ((SYU-KOH-HKNNUM(1) = "972" OR "974"      ) AND
                 (SYU-KOH-HKNNUM(2) = SPACE               ) AND
                 (SYU-KOH-HKNNUM(3) = SPACE               ) AND
                 (SYU-KOH-HKNNUM(4) = SPACE               ) AND
                 (RECE02-SRYYM     >= "201204"            ))
             OR ((SYU-SKJ-FTNGAKU(2)   NOT = ZERO         ) AND
                 (RECE02-SRYYM     <= "201203"            ))
                 ADD    SYU-TOTAL-HKNTEN    TO  WRK-KOH-GAI-GEN70-TEN
                 ADD    SYU-TOTAL-HKNTEN    TO  WRK-JYOGENKBN-TEN
                 ADD    SYU-KOH-FTN         TO  WRK-KOH-FTN-GEN70
             END-IF
             IF  ((SYU-KOH-HKNNUM(1) = "012" OR "025") OR
                  (SYU-KOH-HKNNUM(2) = "012" OR "025") OR
                  (SYU-KOH-HKNNUM(3) = "012" OR "025") OR
                  (SYU-KOH-HKNNUM(4) = "012" OR "025"))
             AND ( FLG-ZENKOKUKOHI-NISYU    NOT =   5 )
              IF   SYU-SYUHKNNUM  NOT = SPACE
               MOVE       1          TO   FLG-JYOGENKBN2
      ****     IF  FLG-KOHYONKAIME = 1
      ****        IF  FLG-TOKU75 = 3
      ****          MOVE  12300      TO   WRK-KINGAKU
      ****        ELSE
      ****          MOVE  24600      TO   WRK-KINGAKU
      ****        END-IF
      ****     ELSE
                  IF  FLG-TOKU75 = 3
                    MOVE  17700      TO   WRK-KINGAKU
                  ELSE
                    MOVE  35400      TO   WRK-KINGAKU
                  END-IF
      ****     END-IF
               PERFORM    2105211-ICHIBUFTN-KOH-SET-SEC
      ****     PERFORM    2105219-ICHIBUFTN-NISYU-HEN-SEC
              END-IF
             ELSE
               IF   ( SYU-KOH-HKNNUM(1) =   "972" )
               OR   ( SYU-KOH-HKNNUM(2) =   "972" )
               OR   ( SYU-KOH-HKNNUM(3) =   "972" )
               OR   ( SYU-KOH-HKNNUM(4) =   "972" )
                 IF  ( SYU-KOH-HKNNUM(1)(1:1)  = "0")
                 OR  ( SYU-KOH-HKNNUM(2)(1:1)  = "0")
                 OR  ( SYU-KOH-HKNNUM(3)(1:1)  = "0")
                 OR  ( SYU-KOH-HKNNUM(4)(1:1)  = "0")
                 OR  ( TBL-TOKATUKAIFLG2       =  1 )
                 OR  ((FLG-ZENKOKUKOHI-NISYU   =  4              ) AND
                      (RECE02-KOHNUM(1) = "972"                  ) AND
                      (RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)      ) AND
                      (RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)) AND
                      (RECE02-KOHID(2)  = RECE02-KOHIDHC (IDX1 1)))
                 OR  ((FLG-ZENKOKUKOHI-NISYU   =  4              ) AND
                      (RECE02-KOHNUM(1) NOT = "972"              ) AND
                      (RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)      ) AND
                      (RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)) AND
                      (RECE02-KOHID(1)  = RECE02-KOHIDHC (IDX1 1)))
                   MOVE     1        TO   FLG-KEISAN-TOK1
                   MOVE     3        TO   FLG-KEISAN
                 ELSE
                   MOVE     1        TO   FLG-KEISAN-TOK2
                   MOVE     4        TO   FLG-KEISAN
                 END-IF
                 IF  (SYU-KOH-HKNNUM(1) =  "972")
                 AND (SYU-KOH-HKNNUM(2) =  SPACE)
                 AND (SYU-KOH-HKNNUM(3) =  SPACE)
                 AND (SYU-KOH-HKNNUM(4) =  SPACE)
                   ADD  SYU-KOH-FTN  TO   WRK-CYOKI-KOH-FTN
                 ELSE
                   IF  (SYU-KOH-HKNNUM(2)    =  "972"      )
                   AND (SYU-KOH1HKNFTNMONEY  >  SYU-KOH-FTN)
                     COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH1HKNFTNMONEY
                                                - SYU-KOH-FTN
                     COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                + WRK-CYOKI-KOH-FTN3
                   END-IF
                   IF  (SYU-KOH-HKNNUM(3)    =  "972"      )
                   AND (SYU-KOH2HKNFTNMONEY  >  SYU-KOH-FTN)
                     COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH2HKNFTNMONEY
                                                - SYU-KOH-FTN
                     COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                + WRK-CYOKI-KOH-FTN3
                   END-IF
                   IF  (SYU-KOH-HKNNUM(4)    =  "972"      )
                   AND (SYU-KOH3HKNFTNMONEY  >  SYU-KOH-FTN)
                     COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH3HKNFTNMONEY
                                                - SYU-KOH-FTN
                     COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                + WRK-CYOKI-KOH-FTN3
                   END-IF
                 END-IF
                 MOVE     2          TO   FLG-JYOGENKBN2
                 IF  FLG-TOKU75 = 3
                    MOVE  5000       TO   WRK-KINGAKU
                 ELSE
                    MOVE  10000      TO   WRK-KINGAKU
                 END-IF
                 MOVE  WRK-KINGAKU   TO   WRK-CYOKI-JGNGAK
      *****      IF  FLG-ZENKOKUKOHI-NISYU  =  5
      *****         IF  RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)
      *****         AND RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)
      *****         AND RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1)
      *****           MOVE    5      TO   FLG-JYOGENKBN2
      *****           MOVE    WRK-KINGAKU
      *****                          TO   WRK-KINGAKU-GENBUTU2
      *****         END-IF
      *****      ELSE
                    IF  RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                    AND RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)
                    AND RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1)
                      MOVE    WRK-KINGAKU
                                     TO   WRK-KINGAKU-GENBUTU2-XXX
                    END-IF
                    IF ((RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)      ) AND
                        (RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)) AND
                        (RECE02-KOHID(2)  = RECE02-KOHIDHC(IDX1 1) ))
                    OR ((RECE02-KOHNUM(3) = SYU-KOH-HKNNUM(1)      ) AND
                        (RECE02-KOHNUM(3) = RECE02-KOHNUMHC(IDX1 1)) AND
                        (RECE02-KOHID(3)  = RECE02-KOHIDHC(IDX1 1) ))
                    OR ((RECE02-KOHNUM(4) = SYU-KOH-HKNNUM(1)      ) AND
                        (RECE02-KOHNUM(4) = RECE02-KOHNUMHC(IDX1 1)) AND
                        (RECE02-KOHID(4)  = RECE02-KOHIDHC(IDX1 1) ))
                      MOVE    WRK-KINGAKU
                                     TO   WRK-KINGAKU-GENBUTU4-XXX
                    END-IF
      *****      END-IF
                 IF    FLG-KEISAN   =    4
                  PERFORM 2105215-ICHIBUFTN-GEN-SEC
                 END-IF
                 PERFORM  2105211-ICHIBUFTN-KOH-SET-SEC
                 PERFORM  2105219-ICHIBUFTN-NISYU-HEN-SEC
               ELSE
                 IF ( SYU-KOH-HKNNUM(1) =   "974" )
                 OR ( SYU-KOH-HKNNUM(2) =   "974" )
                 OR ( SYU-KOH-HKNNUM(3) =   "974" )
                 OR ( SYU-KOH-HKNNUM(4) =   "974" )
                   IF  ( SYU-KOH-HKNNUM(1)(1:1)  = "0")
                   OR  ( SYU-KOH-HKNNUM(2)(1:1)  = "0")
                   OR  ( SYU-KOH-HKNNUM(3)(1:1)  = "0")
                   OR  ( SYU-KOH-HKNNUM(4)(1:1)  = "0")
                   OR  ( TBL-TOKATUKAIFLG2       =  1 )
                   OR  ((FLG-ZENKOKUKOHI-NISYU   =  4              ) AND
                        (RECE02-KOHNUM(1) = "974"                  ) AND
                        (RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)      ) AND
                        (RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)) AND
                        (RECE02-KOHID(2)  = RECE02-KOHIDHC (IDX1 1)))
                   OR  ((FLG-ZENKOKUKOHI-NISYU   =  4              ) AND
                        (RECE02-KOHNUM(1) NOT = "974"              ) AND
                        (RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)      ) AND
                        (RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)) AND
                        (RECE02-KOHID(1)  = RECE02-KOHIDHC (IDX1 1)))
                      MOVE     1        TO   FLG-KEISAN-TOK1
                      MOVE     3        TO   FLG-KEISAN
                   ELSE
                      MOVE     1        TO   FLG-KEISAN-TOK2
                      MOVE     4        TO   FLG-KEISAN
                   END-IF
                   IF  (SYU-KOH-HKNNUM(1) =  "974")
                   AND (SYU-KOH-HKNNUM(2) =  SPACE)
                   AND (SYU-KOH-HKNNUM(3) =  SPACE)
                   AND (SYU-KOH-HKNNUM(4) =  SPACE)
                      ADD  SYU-KOH-FTN  TO   WRK-CYOKI-KOH-FTN
                   ELSE
                     IF  (SYU-KOH-HKNNUM(2)    =  "974"      )
                     AND (SYU-KOH1HKNFTNMONEY  >  SYU-KOH-FTN)
                       COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH1HKNFTNMONEY
                                                  - SYU-KOH-FTN
                       COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                  + WRK-CYOKI-KOH-FTN3
                     END-IF
                     IF  (SYU-KOH-HKNNUM(3)    =  "974"      )
                     AND (SYU-KOH2HKNFTNMONEY  >  SYU-KOH-FTN)
                       COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH2HKNFTNMONEY
                                                  - SYU-KOH-FTN
                       COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                  + WRK-CYOKI-KOH-FTN3
                     END-IF
                     IF  (SYU-KOH-HKNNUM(4)    =  "974"      )
                     AND (SYU-KOH3HKNFTNMONEY  >  SYU-KOH-FTN)
                       COMPUTE WRK-CYOKI-KOH-FTN3 = SYU-KOH3HKNFTNMONEY
                                                  - SYU-KOH-FTN
                       COMPUTE WRK-CYOKI-KOH-FTN2 = WRK-CYOKI-KOH-FTN2
                                                  + WRK-CYOKI-KOH-FTN3
                     END-IF
                   END-IF
                   MOVE      3          TO   FLG-JYOGENKBN2
                   IF  FLG-TOKU75 = 3
                      MOVE   10000      TO   WRK-KINGAKU
                   ELSE
                      MOVE   20000      TO   WRK-KINGAKU
                   END-IF
                   MOVE  WRK-KINGAKU    TO   WRK-CYOKI-JGNGAK
                   IF  RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                   AND RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)
                   AND RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1)
                      MOVE    WRK-KINGAKU
                                     TO   WRK-KINGAKU-GENBUTU2-XXX
                   END-IF
                   IF ((RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)      ) AND
                       (RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)) AND
                       (RECE02-KOHID(2)  = RECE02-KOHIDHC(IDX1 1) ))
                   OR ((RECE02-KOHNUM(3) = SYU-KOH-HKNNUM(1)      ) AND
                       (RECE02-KOHNUM(3) = RECE02-KOHNUMHC(IDX1 1)) AND
                       (RECE02-KOHID(3)  = RECE02-KOHIDHC(IDX1 1) ))
                   OR ((RECE02-KOHNUM(4) = SYU-KOH-HKNNUM(1)      ) AND
                       (RECE02-KOHNUM(4) = RECE02-KOHNUMHC(IDX1 1)) AND
                       (RECE02-KOHID(4)  = RECE02-KOHIDHC(IDX1 1) ))
                      MOVE    WRK-KINGAKU
                                     TO   WRK-KINGAKU-GENBUTU4-XXX
                   END-IF
                   IF    FLG-KEISAN   =    4
                    PERFORM  2105215-ICHIBUFTN-GEN-SEC
                   END-IF
                   PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
                   PERFORM   2105219-ICHIBUFTN-NISYU-HEN-SEC
                 ELSE
                   IF      FLG-ZENKOH-ARI  =  ZERO
                     IF  FLG-WRKFILE-CLEAR  =  ZERO
                     OR  FLG-WRKFILE-KGKTAI =   1
                       IF  FLG-ZENKOKUKOHI-NISYU  =  4
                         IF  RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                         AND RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)
                         AND RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1)
                            MOVE    1    TO   FLG-KEISAN2
                         END-IF
                         IF  RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                         AND RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)
                         AND RECE02-KOHID(2)  = RECE02-KOHIDHC(IDX1 1)
                            MOVE    2    TO   FLG-KEISAN2
                         END-IF
                       END-IF
                       MOVE        4       TO   FLG-JYOGENKBN2
                       PERFORM   2105213-ICHIBUFTN-KOH-HEN2-SEC
                     ELSE
                       ADD    WRK-FTNKEI   TO   RECE02-FTNMONEY(1)
                     END-IF
                     IF  (RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1))
                     OR  (RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1))
                     OR  (RECE02-KOHNUM(3) = SYU-KOH-HKNNUM(1))
                     OR  (RECE02-KOHNUM(4) = SYU-KOH-HKNNUM(1))
                      CONTINUE
                     ELSE
                      IF (RECE02-KOHSKY-KOHNUM(1)
                                           = SYU-KOH-HKNNUM(1))
                      OR (RECE02-KOHSKY-KOHNUM(2)
                                           = SYU-KOH-HKNNUM(1))
                      OR (RECE02-KOHSKY-KOHNUM(3)
                                           = SYU-KOH-HKNNUM(1))
                      OR (RECE02-KOHSKY-KOHNUM(4)
                                           = SYU-KOH-HKNNUM(1))
                       ADD  SYU-TOTAL-HKNTEN
                                           TO   WRK-JYOGENKBN-TEN5
                      END-IF
                     END-IF
                   ELSE
                     IF  ( SYU-KOH-HKNNUM(1)(1:1)  = "0" )
                     OR  ( SYU-KOH-HKNNUM(2)(1:1)  = "0" )
                     OR  ( SYU-KOH-HKNNUM(3)(1:1)  = "0" )
                     OR  ( SYU-KOH-HKNNUM(4)(1:1)  = "0" )
                     OR  ( TBL-TOKATUKAIFLG2       =  1  )
      *
                       IF  FLG-HANTEI  =  1
                         MOVE       1    TO   FLG-HOKENICHIBU7
                         IF   SYU-KOH-HKNNUM(1)(1:1) >= "1" AND <= "8"
                           IF  TBL-TOKATUKAIFLG2  =  1
                             CONTINUE
                           ELSE
                             MOVE   1    TO   FLG-HOKENICHIBU2
                           END-IF
                         END-IF
                         IF  (SYU-KOH-HKNNUM(2)(1:1) >= "1" AND <= "8")
                         OR  (SYU-KOH-HKNNUM(3)(1:1) >= "1" AND <= "8")
                         OR  (SYU-KOH-HKNNUM(4)(1:1) >= "1" AND <= "8")
                           MOVE     1    TO   FLG-HOKENICHIBU2
                         END-IF
                       END-IF
      *
                       IF  FLG-ZENKOKUKOHI-NISYU  =  1 OR 5
                         IF  RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)
                         AND RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)
                         AND RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1)
                            MOVE    1    TO   FLG-KEISAN2
                            IF   SYU-NYNSHOKAISU  =  1
                              MOVE  1    TO   FLG-JIRITU-CYUKANSOU1
                            END-IF
                         END-IF
                         IF  RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)
                         AND RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)
                         AND RECE02-KOHID(2)  = RECE02-KOHIDHC(IDX1 1)
                            MOVE    2    TO   FLG-KEISAN2
                            IF   SYU-NYNSHOKAISU  =  1
                              MOVE  1    TO   FLG-JIRITU-CYUKANSOU2
                            END-IF
                         END-IF
                       END-IF
                       PERFORM   2105217-TOKUSITU-HENSYU2-SEC
                       IF ((WRK-SYUNOU-GEN70-HANTEIFLG(IDX1) = 1) AND
                           (RECE02-SRYYM     >= "201204"        ))
                       OR ( RECE02-SRYYM     <= "201203"         )
                           MOVE       1    TO   FLG-HOKENICHIBU5
                           ADD  SYU-TOTAL-HKNTEN
                                           TO   WRK-JYOGENKBN-TEN2
                       END-IF
                     ELSE
                       IF   FLG-HANTEI  =  1
                          MOVE   1      TO   FLG-HOKENICHIBU3
                       END-IF
                       IF  FLG-ZENKOKUKOHI-NISYU  =   2 OR 4
                          MOVE   2      TO   FLG-KEISAN
                       ELSE
                          MOVE   1      TO   FLG-KEISAN
                       END-IF
                       IF  FLG-WRKFILE-CLEAR  =  ZERO
                       OR  FLG-WRKFILE-KGKTAI =   1
                         IF  FLG-JYOGENKBN = ZERO
                           MOVE      2       TO   FLG-JYOGENKBN
                         END-IF
                         MOVE        1       TO   FLG-JYOGENKBN3
                         PERFORM   2105213-ICHIBUFTN-KOH-HEN2-SEC
                       ELSE
                         ADD    WRK-FTNKEI   TO   RECE02-FTNMONEY(1)
                       END-IF
                       IF  (RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1))
                       OR  (RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1))
                       OR  (RECE02-KOHNUM(3) = SYU-KOH-HKNNUM(1))
                       OR  (RECE02-KOHNUM(4) = SYU-KOH-HKNNUM(1))
                        CONTINUE
                       ELSE
                        IF (RECE02-KOHSKY-KOHNUM(1)
                                             = SYU-KOH-HKNNUM(1))
                        OR (RECE02-KOHSKY-KOHNUM(2)
                                             = SYU-KOH-HKNNUM(1))
                        OR (RECE02-KOHSKY-KOHNUM(3)
                                             = SYU-KOH-HKNNUM(1))
                        OR (RECE02-KOHSKY-KOHNUM(4)
                                             = SYU-KOH-HKNNUM(1))
                         ADD    SYU-TOTAL-HKNTEN
                                      TO   WRK-TOTAL-HKNTEN
                         COMPUTE WRK-FTNKEI5 = WRK-TOTAL-HKNTEN
                                             * 10
                                             * RECE02-KYURATE
                                             / 100
                         IF    WRK-FTNKEI5 >= 21000
                           MOVE  1    TO   FLG-HOKENICHIBU6
                         END-IF
                         ADD    SYU-TOTAL-HKNTEN
                                      TO   WRK-JYOGENKBN-TEN5
                         ADD    SYU-TOTAL-HKNTEN
                                      TO   WRK-JYOGENKBN-TEN3
                        END-IF
                       END-IF
                       ADD   SYU-TOTAL-HKNTEN
                                      TO   WRK-JYOGENKBN-TEN6
                     END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF   SYU-SYUHKNNUM  NOT = SPACE
              ADD   SYU-KOH-FTN   TO   WRK-KOH-FTN
              IF  (SYU-SKJ-FTNGAKU(1)  =     1   )
              AND (RECE02-SRYYM       >= "201204")
                 MOVE    1   TO   FLG-GENBUTU-HANTEI
              END-IF
           END-IF
      *
           .
       210525-HOKEN-FUTAN-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額セット（公費含む場合）
      *****************************************************************
       2105211-ICHIBUFTN-KOH-SET-SEC               SECTION.
      *
           IF  FLG-KEISAN   NOT =  ZERO
             EVALUATE   FLG-KEISAN
               WHEN         1
                 IF  FTN-KOH-XX2  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX2
                 END-IF
                 COMPUTE  FTN-KOH-YY2  =   WRK-KINGAKU -  FTN-KOH-XX2
                 IF  WRK-FTNKEI   >   FTN-KOH-YY2
                      ADD    FTN-KOH-YY2    TO  RECE02-FTNMONEY(1)
                                                FTN-KOH-XX2
                                                WRK-KOH-GAI
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE02-FTNMONEY(1)
                                                FTN-KOH-XX2
                                                WRK-KOH-GAI
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN2
               WHEN         2
                 IF  FTN-KOH-XX4  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX4
                 END-IF
                 COMPUTE  FTN-KOH-YY4  =   WRK-KINGAKU -  FTN-KOH-XX4
                 IF  WRK-FTNKEI   >   FTN-KOH-YY4
                      ADD    FTN-KOH-YY4    TO  RECE02-FTNMONEY(1)
                                                FTN-KOH-XX4
                                                WRK-KOH-GAI
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE02-FTNMONEY(1)
                                                FTN-KOH-XX4
                                                WRK-KOH-GAI
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN4
               WHEN         3
                 MOVE        WRK-KINGAKU    TO  WRK-KINGAKU-TOK7
                 IF  FTN-KOH-XXX  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XXX
                 END-IF
                 COMPUTE  FTN-KOH-YYY  =   WRK-KINGAKU -  FTN-KOH-XXX
                 IF  WRK-FTNKEI   >   FTN-KOH-YYY
                      ADD    FTN-KOH-YYY    TO  RECE02-FTNMONEY(1)
                                                FTN-KOH-XXX
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE02-FTNMONEY(1)
                                                FTN-KOH-XXX
                 END-IF
                 IF  WRK-KINGAKU-TOK1  >  WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  WRK-KINGAKU-TOK1
                 END-IF
                 COMPUTE  WRK-KINGAKU-TOK3
                             =   WRK-KINGAKU -  WRK-KINGAKU-TOK1
                 IF  WRK-FTNKEI   >   WRK-KINGAKU-TOK3
                      ADD  WRK-KINGAKU-TOK3 TO  WRK-KINGAKU-TOK1
                 ELSE
                      ADD  WRK-FTNKEI       TO  WRK-KINGAKU-TOK1
                 END-IF
      *
                 IF  WRK-KINGAKU-TOK1X >  WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  WRK-KINGAKU-TOK1X
                 END-IF
                 COMPUTE  WRK-KINGAKU-TOK3
                             =   WRK-KINGAKU -  WRK-KINGAKU-TOK1X
                 IF  WRK-FTNKEI-Z >   WRK-KINGAKU-TOK3
                      ADD  WRK-KINGAKU-TOK3 TO  WRK-KINGAKU-TOK1X
                 ELSE
                      ADD  WRK-FTNKEI-Z     TO  WRK-KINGAKU-TOK1X
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN1
               WHEN         4
                 IF    WRK-KINGAKU  NOT =  ZERO
                   MOVE      WRK-KINGAKU    TO  WRK-KINGAKU-TOK8
                   IF    FTN-KOH-XXX  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XXX
                   END-IF
                   COMPUTE   FTN-KOH-YYY    =
                             WRK-KINGAKU    -  FTN-KOH-XXX
                   IF    WRK-FTNKEI   >   FTN-KOH-YYY
                      ADD    FTN-KOH-YYY    TO  RECE02-FTNMONEY(1)
                                                FTN-KOH-XXX
                   ELSE
                      ADD    WRK-FTNKEI     TO  RECE02-FTNMONEY(1)
                                                FTN-KOH-XXX
                   END-IF
                   IF  (SYU-KOH-HKNNUM(1) = "972" OR "974")
                   AND (SYU-KOH-HKNNUM(2) =  SPACE        )
                   AND (SYU-KOH-HKNNUM(3) =  SPACE        )
                   AND (SYU-KOH-HKNNUM(4) =  SPACE        )
                     CONTINUE
                   ELSE
                     IF  FTN-KOH-XX7  >   WRK-KINGAKU
                        MOVE WRK-KINGAKU    TO  FTN-KOH-XX7
                     END-IF
                     COMPUTE FTN-KOH-YY7    =
                             WRK-KINGAKU    -  FTN-KOH-XX7
                     IF  WRK-FTNKEI   >   FTN-KOH-YY7
                        ADD  FTN-KOH-YY7    TO  FTN-KOH-XX7
                     ELSE
                        ADD  WRK-FTNKEI     TO  FTN-KOH-XX7
                     END-IF
                   END-IF
      *
                   IF    FTN-KOH-XX7X >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX7X
                   END-IF
                   COMPUTE   FTN-KOH-YY7  =
                             WRK-KINGAKU  -  FTN-KOH-XX7X
                   IF    WRK-FTNKEI   >   FTN-KOH-YY7
                      ADD    FTN-KOH-YY7    TO  FTN-KOH-XX7X
                   ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX7X
                   END-IF
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN1
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN9
             END-EVALUATE
           ELSE
             EVALUATE   FLG-KEISAN2
               WHEN        ZERO
               WHEN         1
                 IF  FTN-KOH-XXX  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XXX
                 END-IF
                 COMPUTE  FTN-KOH-YYY  =   WRK-KINGAKU -  FTN-KOH-XXX
                 IF  WRK-FTNKEI   >   FTN-KOH-YYY
                      ADD    FTN-KOH-YYY    TO  RECE02-FTNMONEY(1)
                                                FTN-KOH-XXX
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE02-FTNMONEY(1)
                                                FTN-KOH-XXX
                 END-IF
      *
                 IF  FTN-KOH-XX8  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX8
                 END-IF
                 COMPUTE  FTN-KOH-YY8  =   WRK-KINGAKU -  FTN-KOH-XX8
                 IF  WRK-FTNKEI   >   FTN-KOH-YY8
                      ADD    FTN-KOH-YY8    TO  FTN-KOH-XX8
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX8
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN1
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN8
                 MOVE     1                 TO  FLG-XX8-TUUKA
               WHEN         2
                 IF  FTN-KOH-XX3  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX3
                 END-IF
                 COMPUTE  FTN-KOH-YY3  =   WRK-KINGAKU -  FTN-KOH-XX3
                 IF  WRK-FTNKEI   >   FTN-KOH-YY3
                      ADD    FTN-KOH-YY3    TO  RECE02-FTNMONEY(1)
                                                FTN-KOH-XX3
                                                WRK-KOH-GAI
                 ELSE
                      ADD    WRK-FTNKEI     TO  RECE02-FTNMONEY(1)
                                                FTN-KOH-XX3
                                                WRK-KOH-GAI
                 END-IF
      *@
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN3
                 MOVE     1                 TO  FLG-XX3-TUUKA
             END-EVALUATE
           END-IF
      *
           .
       2105211-ICHIBUFTN-KOH-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集１
      *****************************************************************
       2105212-ICHIBUFTN-KOH-HEN1-SEC               SECTION.
      *
           IF  ((SYU-KOH-HKNNUM(1)       = RECE02-KOHNUM(1)) AND
                (RECE02-KOHNUMHC(IDX1 1) = RECE02-KOHNUM(1)) AND
                (RECE02-KOHIDHC(IDX1 1)  = RECE02-KOHID(1) ) AND
                (RECE02-EKF-HKNFTNFLG-K(2) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = RECE02-KOHNUM(2)) AND
                (RECE02-KOHNUMHC(IDX1 1) = RECE02-KOHNUM(2)) AND
                (RECE02-KOHIDHC(IDX1 1)  = RECE02-KOHID(2) ) AND
                (RECE02-EKF-HKNFTNFLG-K(3) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = RECE02-KOHNUM(3)) AND
                (RECE02-KOHNUMHC(IDX1 1) = RECE02-KOHNUM(3)) AND
                (RECE02-KOHIDHC(IDX1 1)  = RECE02-KOHID(3) ) AND
                (RECE02-EKF-HKNFTNFLG-K(4) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = RECE02-KOHNUM(4)) AND
                (RECE02-KOHNUMHC(IDX1 1) = RECE02-KOHNUM(4)) AND
                (RECE02-KOHIDHC(IDX1 1)  = RECE02-KOHID(4) ) AND
                (RECE02-EKF-HKNFTNFLG-K(5) = "1"           ))
              CONTINUE
           ELSE
              MOVE    ZERO    TO    FLG-KGKIPNTAI
           END-IF
      *
           IF  ( FLG-KGKIPNTAI      =  1 )
           OR  ( FLG-WRKFILE-KGKTAI =  1 )
           OR  ( FLG-ZEROKOGAITO    =  1 )
              IF      RECE02-SRYYM   >=  "201808"
                  IF    FLG-TOKU75 = 1 OR 2
                    MOVE    9000       TO   WRK-KINGAKU
                  ELSE
                    MOVE    18000      TO   WRK-KINGAKU
                  END-IF
              ELSE
                IF    RECE02-SRYYM   >=  "201708"
                  IF    FLG-TOKU75 = 1 OR 2
                    MOVE    7000       TO   WRK-KINGAKU
                  ELSE
                    MOVE    14000      TO   WRK-KINGAKU
                  END-IF
                ELSE
                  IF    FLG-TOKU75 = 1 OR 2
                    MOVE    6000       TO   WRK-KINGAKU
                  ELSE
                    MOVE    12000      TO   WRK-KINGAKU
                  END-IF
                END-IF
              END-IF
              IF    FLG-KEISAN2 = 2
                MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
              ELSE
                MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
              END-IF
              PERFORM     2105215-ICHIBUFTN-GEN-SEC
              PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
              MOVE        1             TO   FLG-CHIIKI2
           ELSE
              IF  ((RECE02-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                   (RECE02-KOHNUM(1)   = RECE02-KOHNUMHC(IDX1 1)) AND
                   (RECE02-KOHID(1)    = RECE02-KOHIDHC(IDX1 1) ) AND
                   (TBL-TOKUSITUFLG(1) =  1                     ) AND
                   (RECE02-EKF-HKNFTNFLG-K2(2) = "0"            ))
              OR  ((RECE02-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                   (RECE02-KOHNUM(2)   = RECE02-KOHNUMHC(IDX1 1)) AND
                   (RECE02-KOHID(2)    = RECE02-KOHIDHC(IDX1 1) ) AND
                   (TBL-TOKUSITUFLG(2) =  1                     ) AND
                   (RECE02-EKF-HKNFTNFLG-K2(3) = "0"            ))
              OR  ((RECE02-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                   (RECE02-KOHNUM(3)   = RECE02-KOHNUMHC(IDX1 1)) AND
                   (RECE02-KOHID(3)    = RECE02-KOHIDHC(IDX1 1) ) AND
                   (TBL-TOKUSITUFLG(3) =  1                     ) AND
                   (RECE02-EKF-HKNFTNFLG-K2(4) = "0"            ))
              OR  ((RECE02-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                   (RECE02-KOHNUM(4)   = RECE02-KOHNUMHC(IDX1 1)) AND
                   (RECE02-KOHID(4)    = RECE02-KOHIDHC(IDX1 1) ) AND
                   (TBL-TOKUSITUFLG(4) =  1                     ) AND
                   (RECE02-EKF-HKNFTNFLG-K2(5) = "0"            ))
              OR  ((IDZ                =  2                     ) AND
                   (SYU-SKJ-FTNDAY(3)  =  1                     ))
                 PERFORM     2105212-ICHIBUFTN-KOH-HEN11-SEC
              ELSE
                 PERFORM     2105212-ICHIBUFTN-KOH-HEN12-SEC
              END-IF
           END-IF
      *
           .
       2105212-ICHIBUFTN-KOH-HEN1-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集１（１）
      *****************************************************************
       2105212-ICHIBUFTN-KOH-HEN11-SEC               SECTION.
      *
           IF    FLG-KEISAN2 = 2
             COMPUTE WRK-CHIHOU-KIN8 =  WRK-CHIHOU-KIN8
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN8  TO  WRK-CHIHOU-KIN
           ELSE
             COMPUTE WRK-CHIHOU-KIN7 =  WRK-CHIHOU-KIN7
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN7  TO  WRK-CHIHOU-KIN
           END-IF
      *
           EVALUATE   FLG-TOKUSITU
             WHEN       1
               IF     RECE02-SRYYM   >=  "201808"
                 EVALUATE   FLG-KOUREI-GENEKIKBN
                   WHEN        1
                     IF  FLG-TOKU75 = 1 OR 2
                       IF   WRK-CHIHOU-KIN   >  421000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN  - 421000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE    126300  TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF   WRK-CHIHOU-KIN   >  842000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN  - 842000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE    252600  TO   WRK-KINGAKU
                       END-IF
                     END-IF
                   WHEN        2
                     IF  FLG-TOKU75 = 1 OR 2
                       IF   WRK-CHIHOU-KIN   >  279000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN  - 279000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE     83700  TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF   WRK-CHIHOU-KIN   >  558000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN  - 558000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE    167400  TO   WRK-KINGAKU
                       END-IF
                     END-IF
                   WHEN        3
                     IF  FLG-TOKU75 = 1 OR 2
                       IF   WRK-CHIHOU-KIN   >  133500
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN  - 133500 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE     40050  TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF   WRK-CHIHOU-KIN   >  267000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN  - 267000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE     80100  TO   WRK-KINGAKU
                       END-IF
                     END-IF
                 END-EVALUATE
               ELSE
                IF    RECE02-SRYYM  >=  "201708"
                  IF  FLG-TOKU75 = 1 OR 2
                    MOVE     28800      TO   WRK-KINGAKU
                  ELSE
                    MOVE     57600      TO   WRK-KINGAKU
                  END-IF
                ELSE
                  IF  FLG-TOKU75 = 1 OR 2
                    MOVE     22200      TO   WRK-KINGAKU
                  ELSE
                    MOVE     44400      TO   WRK-KINGAKU
                  END-IF
                END-IF
               END-IF
             WHEN       2
               IF      RECE02-SRYYM   >=  "201808"
                  IF    FLG-TOKU75 = 1 OR 2
                    MOVE      9000      TO   WRK-KINGAKU
                  ELSE
                    MOVE     18000      TO   WRK-KINGAKU
                  END-IF
               ELSE
                  IF    RECE02-SRYYM   >=  "201708"
                    IF    FLG-TOKU75 = 1 OR 2
                      MOVE    7000      TO   WRK-KINGAKU
                    ELSE
                      MOVE   14000      TO   WRK-KINGAKU
                    END-IF
                  ELSE
                    IF    FLG-TOKU75 = 1 OR 2
                      MOVE    6000      TO   WRK-KINGAKU
                    ELSE
                      MOVE   12000      TO   WRK-KINGAKU
                    END-IF
                  END-IF
               END-IF
             WHEN       3
               IF  FLG-TOKU75 = 1 OR 2
                    MOVE      4000      TO   WRK-KINGAKU
               ELSE
                    MOVE      8000      TO   WRK-KINGAKU
               END-IF
           END-EVALUATE
      *
           IF    FLG-KEISAN2 = 2
             MOVE    WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
           ELSE
             MOVE    WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
           END-IF
      ***  PERFORM   2105215-ICHIBUFTN-GEN-SEC
           PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2105212-ICHIBUFTN-KOH-HEN11-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集１（２）
      *****************************************************************
       2105212-ICHIBUFTN-KOH-HEN12-SEC               SECTION.
      *
           IF   RECE02-TEISYOTOKU  NOT =  SPACE
             IF  FLG-TOKU75 = 1 OR 2
               MOVE        4000      TO   WRK-KINGAKU
             ELSE
               MOVE        8000      TO   WRK-KINGAKU
             END-IF
           ELSE
             IF   ((RECE02-KYURATE       =   30     ) AND
                   (RECE02-SRYYM        >=  "201808"))
             OR   ((RECE02-KYURATE       =   30     ) AND
                   (RECE02-SRYYM         <  "201808") AND
                   (RECE02-RJNGENMENKBN  =   SPACE  ))
             OR   ((RECE02-KYURATE       =   20     ) AND
                   (RECE02-SRYYM         <  "200804") AND
                   (RECE02-RJNGENMENKBN  =   SPACE  ))
               IF    FLG-KEISAN2 = 2
                 COMPUTE WRK-CHIHOU-KIN8 =  WRK-CHIHOU-KIN8
                                         + (SYU-TOTAL-HKNTEN * 10)
                 MOVE    WRK-CHIHOU-KIN8  TO  WRK-CHIHOU-KIN
               ELSE
                 COMPUTE WRK-CHIHOU-KIN7 =  WRK-CHIHOU-KIN7
                                         + (SYU-TOTAL-HKNTEN * 10)
                 MOVE    WRK-CHIHOU-KIN7  TO  WRK-CHIHOU-KIN
               END-IF
               IF        RECE02-SRYYM   >=  "201808"
                 EVALUATE   FLG-KOUREI-GENEKIKBN
                   WHEN        1
                     IF    FLG-KOHYONKAIME    =  1
                       IF  FLG-TOKU75 = 1 OR 2
                         MOVE    70050     TO   WRK-KINGAKU
                       ELSE
                         MOVE   140100     TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF  FLG-TOKU75 = 1 OR 2
                         IF   WRK-CHIHOU-KIN  >  421000
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN - 421000 ) * 0.01 )
                                                              + 0.5
                           COMPUTE  WRK-KINGAKU  = 126300
                                                 + WRK-KINGAKU2
                           MOVE     1      TO   FLG-KOUGAKU
                         ELSE
                           MOVE    126300  TO   WRK-KINGAKU
                         END-IF
                       ELSE
                         IF   WRK-CHIHOU-KIN  >  842000
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN - 842000 ) * 0.01 )
                                                              + 0.5
                           COMPUTE  WRK-KINGAKU  = 252600
                                                 + WRK-KINGAKU2
                           MOVE     1      TO   FLG-KOUGAKU
                         ELSE
                           MOVE    252600  TO   WRK-KINGAKU
                         END-IF
                       END-IF
                     END-IF
                   WHEN        2
                     IF    FLG-KOHYONKAIME    =  1
                       IF  FLG-TOKU75 = 1 OR 2
                         MOVE    46500     TO   WRK-KINGAKU
                       ELSE
                         MOVE    93000     TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF  FLG-TOKU75 = 1 OR 2
                         IF   WRK-CHIHOU-KIN  >  279000
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN - 279000 ) * 0.01 )
                                                              + 0.5
                           COMPUTE  WRK-KINGAKU  = 83700
                                                 + WRK-KINGAKU2
                           MOVE     1      TO   FLG-KOUGAKU
                         ELSE
                           MOVE     83700  TO   WRK-KINGAKU
                         END-IF
                       ELSE
                         IF   WRK-CHIHOU-KIN  >  558000
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN - 558000 ) * 0.01 )
                                                              + 0.5
                           COMPUTE  WRK-KINGAKU  = 167400
                                                 + WRK-KINGAKU2
                           MOVE     1      TO   FLG-KOUGAKU
                         ELSE
                           MOVE    167400  TO   WRK-KINGAKU
                         END-IF
                       END-IF
                     END-IF
                   WHEN        3
                     IF    FLG-KOHYONKAIME    =  1
                       IF  FLG-TOKU75 = 1 OR 2
                         MOVE    22200     TO   WRK-KINGAKU
                       ELSE
                         MOVE    44400     TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF  FLG-TOKU75 = 1 OR 2
                         IF   WRK-CHIHOU-KIN  >  133500
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN - 133500 ) * 0.01 )
                                                              + 0.5
                           COMPUTE  WRK-KINGAKU  = 40050
                                                 + WRK-KINGAKU2
                           MOVE     1      TO   FLG-KOUGAKU
                         ELSE
                           MOVE     40050  TO   WRK-KINGAKU
                         END-IF
                       ELSE
                         IF   WRK-CHIHOU-KIN  >  267000
                           COMPUTE  WRK-KINGAKU2 =
                                 (( WRK-CHIHOU-KIN - 267000 ) * 0.01 )
                                                              + 0.5
                           COMPUTE  WRK-KINGAKU  = 80100
                                                 + WRK-KINGAKU2
                           MOVE     1      TO   FLG-KOUGAKU
                         ELSE
                           MOVE     80100  TO   WRK-KINGAKU
                         END-IF
                       END-IF
                     END-IF
                 END-EVALUATE
               ELSE
                 IF      RECE02-SRYYM   >=  "201708"
                   IF    FLG-TOKU75 = 1 OR 2
                     MOVE    28800     TO   WRK-KINGAKU
                   ELSE
                     MOVE    57600     TO   WRK-KINGAKU
                   END-IF
                 ELSE
                   IF    RECE02-SRYYM   >=  "200610"
                     IF  FLG-TOKU75 = 1 OR 2
                       MOVE  22200     TO   WRK-KINGAKU
                     ELSE
                       MOVE  44400     TO   WRK-KINGAKU
                     END-IF
                   ELSE
                     MOVE    40200     TO   WRK-KINGAKU
                   END-IF
                 END-IF
               END-IF
             ELSE
               IF      RECE02-SRYYM   >=  "201808"
                 IF    FLG-TOKU75 = 1 OR 2
                   MOVE       9000     TO   WRK-KINGAKU
                 ELSE
                   MOVE      18000     TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF    RECE02-SRYYM   >=  "201708"
                   IF    FLG-TOKU75 = 1 OR 2
                     MOVE     7000     TO   WRK-KINGAKU
                   ELSE
                     MOVE    14000     TO   WRK-KINGAKU
                   END-IF
                 ELSE
                   IF    FLG-TOKU75 = 1 OR 2
                     MOVE     6000     TO   WRK-KINGAKU
                   ELSE
                     MOVE    12000     TO   WRK-KINGAKU
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
           IF    FLG-KEISAN2 = 2
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
           ELSE
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
           END-IF
           PERFORM     2105215-ICHIBUFTN-GEN-SEC
           PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2105212-ICHIBUFTN-KOH-HEN12-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集２
      *****************************************************************
       2105213-ICHIBUFTN-KOH-HEN2-SEC               SECTION.
      *
           IF  ((SYU-KOH-HKNNUM(1)       = RECE02-KOHNUM(1)) AND
                (RECE02-KOHNUMHC(IDX1 1) = RECE02-KOHNUM(1)) AND
                (RECE02-KOHIDHC(IDX1 1)  = RECE02-KOHID(1) ) AND
                (RECE02-EKF-HKNFTNFLG-Y(2) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = RECE02-KOHNUM(2)) AND
                (RECE02-KOHNUMHC(IDX1 1) = RECE02-KOHNUM(2)) AND
                (RECE02-KOHIDHC(IDX1 1)  = RECE02-KOHID(2) ) AND
                (RECE02-EKF-HKNFTNFLG-Y(3) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = RECE02-KOHNUM(3)) AND
                (RECE02-KOHNUMHC(IDX1 1) = RECE02-KOHNUM(3)) AND
                (RECE02-KOHIDHC(IDX1 1)  = RECE02-KOHID(3) ) AND
                (RECE02-EKF-HKNFTNFLG-Y(4) = "1"           ))
           OR  ((SYU-KOH-HKNNUM(1)       = RECE02-KOHNUM(4)) AND
                (RECE02-KOHNUMHC(IDX1 1) = RECE02-KOHNUM(4)) AND
                (RECE02-KOHIDHC(IDX1 1)  = RECE02-KOHID(4) ) AND
                (RECE02-EKF-HKNFTNFLG-Y(5) = "1"           ))
              CONTINUE
           ELSE
              MOVE    ZERO    TO    FLG-KGKIPNTAI
           END-IF
      *
           IF  ( FLG-KGKIPNTAI      =  1 )
           OR  ( FLG-WRKFILE-KGKTAI =  1 )
           OR  ( FLG-ZEROKOGAITO    =  1 )
      *
            MOVE     ZERO    TO   FLG-KOHYONKAIME-NO
            IF  (SYS-1001-PREFNUM   =  01            )
            AND (SYU-SYUHKNNUM  NOT = "060" AND "067")
            AND (SYU-KOH-HKNNUM(1)  = "141" OR "241" )
            AND (IDZ                =  1             )
            AND (RECE02-SRYYM      <= "200803"       )
               CONTINUE
            ELSE
               MOVE   1      TO   FLG-KOHYONKAIME-NO
            END-IF
            IF    FLG-KEISAN2 = 2
              COMPUTE WRK-CHIHOU-KIN8 =  WRK-CHIHOU-KIN8
                                      + (SYU-TOTAL-HKNTEN * 10)
              MOVE    WRK-CHIHOU-KIN8  TO  WRK-CHIHOU-KIN
            ELSE
              COMPUTE WRK-CHIHOU-KIN7 =  WRK-CHIHOU-KIN7
                                      + (SYU-TOTAL-HKNTEN * 10)
              MOVE    WRK-CHIHOU-KIN7  TO  WRK-CHIHOU-KIN
            END-IF
            IF  (FLG-KOHYONKAIME-NO  =  ZERO)
            AND (FLG-KOHYONKAIME     =   1  )
              IF  FLG-TOKU75 = 3
               MOVE   22200   TO   WRK-KINGAKU
              ELSE
               MOVE   44400   TO   WRK-KINGAKU
              END-IF
            ELSE
              IF  FLG-TOKU75 = 3
               IF   WRK-CHIHOU-KIN  >  133500
                  COMPUTE  WRK-KINGAKU2 =
                        (( WRK-CHIHOU-KIN -  133500 ) * 0.01 )
                                                      + 0.5
                  COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  MOVE     1      TO   FLG-KOUGAKU
               ELSE
                  MOVE     40050  TO   WRK-KINGAKU
               END-IF
              ELSE
               IF   WRK-CHIHOU-KIN  >  267000
                  COMPUTE  WRK-KINGAKU2 =
                        (( WRK-CHIHOU-KIN -  267000 ) * 0.01 )
                                                      + 0.5
                  COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  MOVE     1      TO   FLG-KOUGAKU
               ELSE
                  MOVE     80100  TO   WRK-KINGAKU
               END-IF
              END-IF
            END-IF
            IF    FLG-KEISAN2 = 2
              MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
            ELSE
              MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
            END-IF
            PERFORM   2105215-ICHIBUFTN-GEN-SEC
            PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
            MOVE      1               TO   FLG-CHIIKI2
           ELSE
             IF  ((RECE02-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE02-KOHNUM(1)   = RECE02-KOHNUMHC(IDX1 1)) AND
                  (RECE02-KOHID(1)    = RECE02-KOHIDHC(IDX1 1) ) AND
                  (TBL-TOKUSITUFLG(1) =  1                     ) AND
                  (RECE02-EKF-HKNFTNFLG-Y2(2) = "0"            ))
             OR  ((RECE02-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE02-KOHNUM(2)   = RECE02-KOHNUMHC(IDX1 1)) AND
                  (RECE02-KOHID(2)    = RECE02-KOHIDHC(IDX1 1) ) AND
                  (TBL-TOKUSITUFLG(2) =  1                     ) AND
                  (RECE02-EKF-HKNFTNFLG-Y2(3) = "0"            ))
             OR  ((RECE02-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE02-KOHNUM(3)   = RECE02-KOHNUMHC(IDX1 1)) AND
                  (RECE02-KOHID(3)    = RECE02-KOHIDHC(IDX1 1) ) AND
                  (TBL-TOKUSITUFLG(3) =  1                     ) AND
                  (RECE02-EKF-HKNFTNFLG-Y2(4) = "0"            ))
             OR  ((RECE02-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                  (RECE02-KOHNUM(4)   = RECE02-KOHNUMHC(IDX1 1)) AND
                  (RECE02-KOHID(4)    = RECE02-KOHIDHC(IDX1 1) ) AND
                  (TBL-TOKUSITUFLG(4) =  1                     ) AND
                  (RECE02-EKF-HKNFTNFLG-Y2(5) = "0"            ))
             OR  ((IDZ                =  2                     ) AND
                  (SYU-SKJ-FTNDAY(3)  =  1                     ))
                PERFORM   2105213-ICHIBUFTN-KOH-HEN23-SEC
             ELSE
                IF  RECE02-SRYYM  >= "201501"
                  PERFORM 2105213-ICHIBUFTN-KOH-HEN22-SEC
                ELSE
                  PERFORM 2105213-ICHIBUFTN-KOH-HEN21-SEC
                END-IF
             END-IF
           END-IF
      *
           .
       2105213-ICHIBUFTN-KOH-HEN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集２１（平成２６年１２月まで）
      *****************************************************************
       2105213-ICHIBUFTN-KOH-HEN21-SEC               SECTION.
      *
           IF    FLG-KEISAN2 = 2
             COMPUTE WRK-CHIHOU-KIN8 =  WRK-CHIHOU-KIN8
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN8  TO  WRK-CHIHOU-KIN
           ELSE
             COMPUTE WRK-CHIHOU-KIN7 =  WRK-CHIHOU-KIN7
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN7  TO  WRK-CHIHOU-KIN
           END-IF
      *
           EVALUATE     FLG-GENBUTU70
             WHEN           1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   83400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  250000 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  = 75000   +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE    75000   TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  500000 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  = 150000  +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE    150000  TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
             WHEN           2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU
                 ELSE
                  MOVE   44400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  133500 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN -  267000 ) * 0.01 )
                                                         + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                     MOVE     1      TO   FLG-KOUGAKU
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
             WHEN           3
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU
                 ELSE
                  MOVE   24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
           END-EVALUATE
      *
           IF    FLG-KEISAN2 = 2
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
           ELSE
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
           END-IF
           PERFORM   2105215-ICHIBUFTN-GEN-SEC
           PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2105213-ICHIBUFTN-KOH-HEN21-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集２２（平成２７年１月から）
      *****************************************************************
       2105213-ICHIBUFTN-KOH-HEN22-SEC               SECTION.
      *
           IF    FLG-KEISAN2 = 2
             COMPUTE WRK-CHIHOU-KIN8 =  WRK-CHIHOU-KIN8
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN8  TO  WRK-CHIHOU-KIN
           ELSE
             COMPUTE WRK-CHIHOU-KIN7 =  WRK-CHIHOU-KIN7
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN7  TO  WRK-CHIHOU-KIN
           END-IF
      *
           EVALUATE     FLG-GENBUTU70
             WHEN           1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE    70050   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    46500   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE   140100   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    93000   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN  >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN -  421000 ) * 0.01 )
                                                             + 0.5
                         COMPUTE  WRK-KINGAKU  = 126300 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN  >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN -  279000 ) * 0.01 )
                                                             + 0.5
                         COMPUTE  WRK-KINGAKU  =  83700 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN  >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN -  842000 ) * 0.01 )
                                                             + 0.5
                         COMPUTE  WRK-KINGAKU  = 252600 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN  >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN -  558000 ) * 0.01 )
                                                             + 0.5
                         COMPUTE  WRK-KINGAKU  = 167400 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 END-IF
               END-IF
             WHEN           2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    22200   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    22200   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    44400   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    44400   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN  >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN -  133500 ) * 0.01 )
                                                             + 0.5
                         COMPUTE  WRK-KINGAKU  =  40050 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN  >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN -  267000 ) * 0.01 )
                                                             + 0.5
                         COMPUTE  WRK-KINGAKU  =  80100 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               END-IF
             WHEN           3
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                       MOVE    12300   TO   WRK-KINGAKU
                 ELSE
                       MOVE    24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                       MOVE    17700   TO   WRK-KINGAKU
                 ELSE
                       MOVE    35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
           END-EVALUATE
      *
           IF    FLG-KEISAN2 = 2
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
           ELSE
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
           END-IF
           PERFORM   2105215-ICHIBUFTN-GEN-SEC
           PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2105213-ICHIBUFTN-KOH-HEN22-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集２３
      *****************************************************************
       2105213-ICHIBUFTN-KOH-HEN23-SEC               SECTION.
      *
           IF    FLG-KEISAN2 = 2
             COMPUTE WRK-CHIHOU-KIN8 =  WRK-CHIHOU-KIN8
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN8  TO  WRK-CHIHOU-KIN
           ELSE
             COMPUTE WRK-CHIHOU-KIN7 =  WRK-CHIHOU-KIN7
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN7  TO  WRK-CHIHOU-KIN
           END-IF
      *
           EVALUATE   FLG-TOKUSITU
             WHEN       1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN  >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN  -  421000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN  >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN  -  279000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN  >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN  -  842000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN  >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN  -  558000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 END-IF
             WHEN       2
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN  >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN  -  133500 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN  >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN  -  267000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
             WHEN       3
                 IF  FLG-TOKU75 = 3
                       MOVE    17700     TO   WRK-KINGAKU
                 ELSE
                       MOVE    35400     TO   WRK-KINGAKU
                 END-IF
           END-EVALUATE
      *
           IF    FLG-KEISAN2 = 2
             MOVE    WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU5
           ELSE
             MOVE    WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU
           END-IF
      ***  PERFORM   2105215-ICHIBUFTN-GEN-SEC
           PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
      *
           .
       2105213-ICHIBUFTN-KOH-HEN23-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集３
      *****************************************************************
       2105214-ICHIBUFTN-KOH-HEN3-SEC               SECTION.
      *
           EVALUATE   FLG-KEISAN2
             WHEN        ZERO
             WHEN         1
      ***>     IF  FLG-KOHYONKAIME = 1
      ***>        MOVE   44400   TO   WRK-KINGAKU
      ***>     ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN2  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN2  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
      ***>     END-IF
               PERFORM   210521C-KOH-SEIHEI-Y-SEC
               PERFORM   210527-KOHARI-CHECK-SEC
               IF  FLG-KOHARI-CHECK = 1
                 MOVE    WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
               END-IF
               PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
             WHEN         2
      ***>     IF  FLG-KOHYONKAIME = 1
      ***>        MOVE   44400   TO   WRK-KINGAKU
      ***>     ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN4  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN4  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
      ***>     END-IF
               PERFORM   210521C-KOH-SEIHEI-Y-SEC
               MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
               PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
           END-EVALUATE
      *
           .
       2105214-ICHIBUFTN-KOH-HEN3-EXT.
           EXIT.
      *
      *****************************************************************
      *    生保併用（７０歳未満）
      *****************************************************************
       210521C-KOH-SEIHEI-Y-SEC               SECTION.
      *
           IF  (SYU-KOH-HKNNUM(1) = "012" OR "025")
           OR  (SYU-KOH-HKNNUM(2) = "012" OR "025")
           OR  (SYU-KOH-HKNNUM(3) = "012" OR "025")
           OR  (SYU-KOH-HKNNUM(4) = "012" OR "025")
             IF   SYU-SYUHKNNUM  NOT = SPACE
               IF   (FLG-ZENKOKUKOHI-NISYU    =  5                 )
               AND  (RECE02-KOHNUM(1)(1:1)    = "0"                )
               AND  (RECE02-KOHNUM(1)     NOT = "012" AND "025"    )
               AND  (RECE02-TOTALTEN(1)       =  RECE02-TOTALTEN(2))
                 IF   FLG-ZENKOKUKOHI-NISYU-SC =  1
                   IF  FLG-TOKU75 = 3
                     MOVE  5000       TO   WRK-KINGAKU
                   ELSE
                     MOVE  10000      TO   WRK-KINGAKU
                   END-IF
                 END-IF
               ELSE
      ****       IF  FLG-KOHYONKAIME = 1
      ****         IF  FLG-TOKU75 = 3
      ****           MOVE  12300      TO   WRK-KINGAKU
      ****         ELSE
      ****           MOVE  24600      TO   WRK-KINGAKU
      ****         END-IF
      ****       ELSE
                   IF  FLG-TOKU75 = 3
                     MOVE  17700      TO   WRK-KINGAKU
                   ELSE
                     MOVE  35400      TO   WRK-KINGAKU
                   END-IF
      ****       END-IF
               END-IF
             END-IF
           END-IF
      *
           .
       210521C-KOH-SEIHEI-Y-EXT.
           EXIT.
      *
      *****************************************************************
      *    金額の減額
      *****************************************************************
       2105215-ICHIBUFTN-GEN-SEC               SECTION.
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
      *
              COMPUTE  WRK-FTNKEI = SYU-TOTAL-HKNTEN
                                  * 10
                                  * RECE02-KYURATE
                                  / 100
      *
              EVALUATE   WK-GENGAKUKBN
                WHEN        1
                  IF  WK-GENGAKUKBN-KEISAN  =  2
                    IF  RECE02-KYURATE  <= WK-GENGAKU-RITU
                        MOVE   ZERO     TO   WRK-FTNKEI
                    ELSE
                        COMPUTE  WRK-FTNKEI-XXX = SYU-TOTAL-HKNTEN
                                                * 10
                                                * WK-GENGAKU-RITU
                                                / 100
                        IF  WRK-FTNKEI > WRK-FTNKEI-XXX
                          COMPUTE  WRK-FTNKEI         =
                                   WRK-FTNKEI         -
                                   WRK-FTNKEI-XXX
                        ELSE
                          MOVE ZERO     TO   WRK-FTNKEI
                        END-IF
                    END-IF
                  ELSE
                    IF  WK-GENGAKU-RITU = 100
                        MOVE   ZERO     TO   WRK-FTNKEI
                    ELSE
                        COMPUTE  WK-GENGAKU-RITUX =
                                 100 - WK-GENGAKU-RITU
                        IF    WRK-FTNKEI  NOT = ZERO
                          COMPUTE  WRK-FTNKEI         =
                                   WRK-FTNKEI         *
                                   WK-GENGAKU-RITUX   /
                                   100
                        END-IF
                    END-IF
                  END-IF
                WHEN        2
                  MOVE     WRK-FTNKEI   TO   WRK-FTNKEI-GENGAKU
                  COMPUTE  WRK-FTNKEI-GENGAKU =
                           WRK-FTNKEI-GENGAKU +  5
                  COMPUTE  WRK-FTNKEI-GENGAKU =
                           WRK-FTNKEI-GENGAKU /  10
                  COMPUTE  WRK-FTNKEI-GENGAKU =
                           WRK-FTNKEI-GENGAKU *  10
      *
                  IF  WRK-FTNKEI < WK-GENGAKU-KIN2
                    MOVE   ZERO   TO   WRK-FTNKEI
                  ELSE
                    COMPUTE  WRK-FTNKEI     =
                             WRK-FTNKEI     -
                             WK-GENGAKU-KIN2
                  END-IF
      *
                  IF  WK-GENGAKU-KIN2  <=  WRK-FTNKEI-GENGAKU
                    MOVE   ZERO   TO   WK-GENGAKU-KIN2
                  ELSE
                    COMPUTE  WK-GENGAKU-KIN2   =
                             WK-GENGAKU-KIN2   -
                             WRK-FTNKEI-GENGAKU
                  END-IF
                WHEN        3
                WHEN        4
      ***          災２の対応
                   IF    SYU-YKZKENNUM   =  3  OR  4
                      MOVE   ZERO     TO   WRK-FTNKEI
                   END-IF
                WHEN        5
                  MOVE     WRK-FTNKEI   TO   WRK-FTNKEI-GENGAKU
                  COMPUTE  WRK-FTNKEI-GENGAKU =
                           WRK-FTNKEI-GENGAKU +  5
                  COMPUTE  WRK-FTNKEI-GENGAKU =
                           WRK-FTNKEI-GENGAKU /  10
                  COMPUTE  WRK-FTNKEI-GENGAKU =
                           WRK-FTNKEI-GENGAKU *  10
      *
                  IF  WRK-FTNKEI > WK-GENGAKU-KIN2
                    COMPUTE  WRK-FTNKEI     =
                             WK-GENGAKU-KIN2
                  END-IF
      *
                  IF  WK-GENGAKU-KIN2  <=  WRK-FTNKEI-GENGAKU
                    MOVE   ZERO   TO   WK-GENGAKU-KIN2
                  ELSE
                    COMPUTE  WK-GENGAKU-KIN2   =
                             WK-GENGAKU-KIN2   -
                             WRK-FTNKEI-GENGAKU
                  END-IF
              END-EVALUATE
              IF   FLG-WRKFILE-CLEAR   =   ZERO
                COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
                COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
                COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
      *
                COMPUTE  WRK-FTNKEI = WRK-FTNKEI
                                    + SYU-GRP-SGKMONEY
              END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
           AND  WK-GENGAKUKBN-KEISAN =   ZERO
      *
              EVALUATE   WK-GENGAKUKBN
                WHEN        1
                  IF  WK-GENGAKU-RITU = 100
                      MOVE   ZERO     TO   WRK-KINGAKU
                  ELSE
                      COMPUTE  WK-GENGAKU-RITUX =
                               100 - WK-GENGAKU-RITU
                      IF    WRK-KINGAKU  NOT = ZERO
                        IF  FLG-KOUGAKU = ZERO
                          COMPUTE  WRK-KINGAKU         =
                                   WRK-KINGAKU         *
                                   WK-GENGAKU-RITUX    /
                                   100
                          COMPUTE  WRK-KINGAKU  = WRK-KINGAKU  +  5
                          COMPUTE  WRK-KINGAKU  = WRK-KINGAKU  / 10
                          COMPUTE  WRK-KINGAKU  = WRK-KINGAKU  * 10
                        ELSE
                          COMPUTE  WRK-KINGAKU         =
                                  (WRK-KINGAKU         *
                                   WK-GENGAKU-RITUX    /
                                   100) + 0.5
                        END-IF
                      END-IF
                  END-IF
                WHEN        2
                  IF  WRK-KINGAKU < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   WRK-KINGAKU
                  ELSE
                    COMPUTE  WRK-KINGAKU    =
                             WRK-KINGAKU    -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN        3
                WHEN        4
      ***          災２の対応
      **>             MOVE   ZERO     TO   WRK-KINGAKU
                      CONTINUE
                WHEN        5
                  IF  WRK-KINGAKU > WK-GENGAKU-KIN
                    COMPUTE  WRK-KINGAKU    =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
      *
           END-IF
      *
           .
       2105215-ICHIBUFTN-GEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の編集（高齢者）
      *****************************************************************
       2105216-TOKUSITU-HENSYU-SEC               SECTION.
      *
           IF  ((RECE02-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(1)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(1)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(1) =  1                     ))
           OR  ((RECE02-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(2)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(2)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(2) =  1                     ))
           OR  ((RECE02-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(3)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(3)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(3) =  1                     ))
           OR  ((RECE02-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(4)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(4)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(4) =  1                     ))
      ***  OR  ((RECE02-KOHNUM(1)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE02-KOHNUM(1)   = RECE02-KOHNUMHC(IDX1 2)) AND
      ***       (RECE02-KOHID(1)    = RECE02-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(1) =  1                     ))
      ***  OR  ((RECE02-KOHNUM(2)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE02-KOHNUM(2)   = RECE02-KOHNUMHC(IDX1 2)) AND
      ***       (RECE02-KOHID(2)    = RECE02-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(2) =  1                     ))
      ***  OR  ((RECE02-KOHNUM(3)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE02-KOHNUM(3)   = RECE02-KOHNUMHC(IDX1 2)) AND
      ***       (RECE02-KOHID(3)    = RECE02-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(3) =  1                     ))
      ***  OR  ((RECE02-KOHNUM(4)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE02-KOHNUM(4)   = RECE02-KOHNUMHC(IDX1 2)) AND
      ***       (RECE02-KOHID(4)    = RECE02-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(4) =  1                     ))
           OR  ((IDZ                =  2                     ) AND
                (SYU-SKJ-FTNDAY(3)  =  1                     ))
              MOVE           5         TO   FLG-JYOGENKBN2
              PERFORM  21052161-TOKUSITU-HENSYU1-SEC
           ELSE
            IF  ((RECE02-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE02-KOHNUM(1)   = RECE02-KOHNUMHC(IDX1 1)) AND
                 (RECE02-KOHID(1)    = RECE02-KOHIDHC(IDX1 1) ) AND
                 (SYS-1001-PREFNUM   =  23                    ) AND
                 (RECE02-KOHNUM(1)   = "191"                  ) AND
                 (RECE02-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE02-SRYYM      >=  "201204"              ) AND
                 (RECE02-SRYYM      <=  "201509"              ))
            OR  ((RECE02-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE02-KOHNUM(2)   = RECE02-KOHNUMHC(IDX1 1)) AND
                 (RECE02-KOHID(2)    = RECE02-KOHIDHC(IDX1 1) ) AND
                 (SYS-1001-PREFNUM   =  23                    ) AND
                 (RECE02-KOHNUM(2)   = "191"                  ) AND
                 (RECE02-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE02-SRYYM      >=  "201204"              ) AND
                 (RECE02-SRYYM      <=  "201509"              ))
            OR  ((RECE02-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE02-KOHNUM(3)   = RECE02-KOHNUMHC(IDX1 1)) AND
                 (RECE02-KOHID(3)    = RECE02-KOHIDHC(IDX1 1) ) AND
                 (SYS-1001-PREFNUM   =  23                    ) AND
                 (RECE02-KOHNUM(3)   = "191"                  ) AND
                 (RECE02-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE02-SRYYM      >=  "201204"              ) AND
                 (RECE02-SRYYM      <=  "201509"              ))
            OR  ((RECE02-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE02-KOHNUM(4)   = RECE02-KOHNUMHC(IDX1 1)) AND
                 (RECE02-KOHID(4)    = RECE02-KOHIDHC(IDX1 1) ) AND
                 (SYS-1001-PREFNUM   =  23                    ) AND
                 (RECE02-KOHNUM(4)   = "191"                  ) AND
                 (RECE02-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE02-SRYYM      >=  "201204"              ) AND
                 (RECE02-SRYYM      <=  "201509"              ))
              MOVE           5         TO   FLG-JYOGENKBN2
              PERFORM  21052162-TOKUSITU-HENSYU2-SEC
            ELSE
              MOVE           5         TO   FLG-JYOGENKBN2
              PERFORM  21052163-TOKUSITU-HENSYU3-SEC
            END-IF
           END-IF
      *
           .
       2105216-TOKUSITU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の編集１（高齢者）
      *****************************************************************
       21052161-TOKUSITU-HENSYU1-SEC               SECTION.
      *
           IF    FLG-KEISAN2 = 2
             COMPUTE WRK-CHIHOU-KIN4 =  WRK-CHIHOU-KIN4
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN4  TO  WRK-CHIHOU-KIN5
           ELSE
             COMPUTE WRK-CHIHOU-KIN2 =  WRK-CHIHOU-KIN2
                                     + (SYU-TOTAL-HKNTEN * 10)
             MOVE    WRK-CHIHOU-KIN2  TO  WRK-CHIHOU-KIN5
           END-IF
      *
           EVALUATE   FLG-TOKUSITU
             WHEN       1
               IF     RECE02-SRYYM   >=  "201808"
                 EVALUATE   FLG-KOUREI-GENEKIKBN
                   WHEN        1
                     IF  FLG-TOKU75 = 1 OR 2
                       IF   WRK-CHIHOU-KIN5  >  421000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN5 - 421000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE    126300  TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF   WRK-CHIHOU-KIN5  >  842000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN5 - 842000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE    252600  TO   WRK-KINGAKU
                       END-IF
                     END-IF
                   WHEN        2
                     IF  FLG-TOKU75 = 1 OR 2
                       IF   WRK-CHIHOU-KIN5  >  279000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN5 - 279000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE     83700  TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF   WRK-CHIHOU-KIN5  >  558000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN5 - 558000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE    167400  TO   WRK-KINGAKU
                       END-IF
                     END-IF
                   WHEN        3
                     IF  FLG-TOKU75 = 1 OR 2
                       IF   WRK-CHIHOU-KIN5  >  133500
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN5 - 133500 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE     40050  TO   WRK-KINGAKU
                       END-IF
                     ELSE
                       IF   WRK-CHIHOU-KIN5  >  267000
                         COMPUTE WRK-KINGAKU2 =
                              (( WRK-CHIHOU-KIN5 - 267000 ) * 0.01 )
                                                            + 0.5
                         COMPUTE WRK-KINGAKU =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE     80100  TO   WRK-KINGAKU
                       END-IF
                     END-IF
                 END-EVALUATE
               ELSE
                 IF   RECE02-SRYYM   >=  "201708"
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    28800      TO   WRK-KINGAKU
                   ELSE
                     MOVE    57600      TO   WRK-KINGAKU
                   END-IF
                 ELSE
                   IF  FLG-TOKU75 = 1 OR 2
                     MOVE    22200      TO   WRK-KINGAKU
                   ELSE
                     MOVE    44400      TO   WRK-KINGAKU
                   END-IF
                 END-IF
               END-IF
             WHEN       2
               IF      RECE02-SRYYM   >=  "201808"
                 IF    FLG-TOKU75 = 1 OR 2
                   MOVE       9000      TO   WRK-KINGAKU
                 ELSE
                   MOVE      18000      TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF    RECE02-SRYYM   >=  "201708"
                   IF    FLG-TOKU75 = 1 OR 2
                     MOVE     7000      TO   WRK-KINGAKU
                   ELSE
                     MOVE    14000      TO   WRK-KINGAKU
                   END-IF
                 ELSE
                   IF    FLG-TOKU75 = 1 OR 2
                     MOVE     6000      TO   WRK-KINGAKU
                   ELSE
                     MOVE    12000      TO   WRK-KINGAKU
                   END-IF
                 END-IF
               END-IF
             WHEN       3
               IF  FLG-TOKU75 = 1 OR 2
                     MOVE     4000      TO   WRK-KINGAKU
               ELSE
                     MOVE     8000      TO   WRK-KINGAKU
               END-IF
           END-EVALUATE
           PERFORM   21052164-KOH-SEIHEI-K-SEC
      *
           IF    FLG-KEISAN2 = 2
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU4
           ELSE
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU2
           END-IF
           PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
      *
           .
       21052161-TOKUSITU-HENSYU1-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の編集２（高齢者）
      *****************************************************************
       21052162-TOKUSITU-HENSYU2-SEC               SECTION.
      *
           IF   RECE02-TEISYOTOKU  NOT =  SPACE
             IF  FLG-TOKU75 = 1 OR 2
               MOVE       4000   TO   WRK-KINGAKU
             ELSE
               MOVE       8000   TO   WRK-KINGAKU
             END-IF
           ELSE
             IF   ((RECE02-KYURATE       =   30     ) AND
                   (RECE02-RJNGENMENKBN  =   SPACE  ))
             OR   ((RECE02-KYURATE       =   20     ) AND
                   (RECE02-SRYYM         <  "200804") AND
                   (RECE02-RJNGENMENKBN  =   SPACE  ))
               IF  FLG-TOKU75 = 1 OR 2
                 MOVE    22200   TO   WRK-KINGAKU
               ELSE
                 MOVE    44400   TO   WRK-KINGAKU
               END-IF
             ELSE
               IF    FLG-TOKU75 = 1 OR 2
                 MOVE     6000   TO   WRK-KINGAKU
               ELSE
                 MOVE    12000   TO   WRK-KINGAKU
               END-IF
             END-IF
           END-IF
           PERFORM   21052164-KOH-SEIHEI-K-SEC
      *
           IF    FLG-KEISAN2 = 2
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU4
           ELSE
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU2
           END-IF
           PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
      *
           .
       21052162-TOKUSITU-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の編集３（高齢者）
      *****************************************************************
       21052163-TOKUSITU-HENSYU3-SEC               SECTION.
      *
           IF      RECE02-SRYYM   >=  "201808"
             IF    FLG-TOKU75 = 1 OR 2
               MOVE      9000     TO   WRK-KINGAKU
             ELSE
               MOVE     18000     TO   WRK-KINGAKU
             END-IF
           ELSE
             IF    RECE02-SRYYM   >=  "201708"
               IF    FLG-TOKU75 = 1 OR 2
                 MOVE    7000     TO   WRK-KINGAKU
               ELSE
                 MOVE   14000     TO   WRK-KINGAKU
               END-IF
             ELSE
               IF    FLG-TOKU75 = 1 OR 2
                 MOVE    6000     TO   WRK-KINGAKU
               ELSE
                 MOVE   12000     TO   WRK-KINGAKU
               END-IF
             END-IF
           END-IF
           PERFORM   21052164-KOH-SEIHEI-K-SEC
      *
           IF    FLG-KEISAN2 = 2
             MOVE      WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU4
           ELSE
             PERFORM   210527-KOHARI-CHECK-SEC
             IF  FLG-KOHARI-CHECK = 1
               MOVE    WRK-KINGAKU   TO   WRK-KINGAKU-GENBUTU2
             END-IF
           END-IF
           PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
      *
           .
       21052163-TOKUSITU-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    生保併用（高齢者）
      *****************************************************************
       21052164-KOH-SEIHEI-K-SEC               SECTION.
      *
           IF  (SYU-KOH-HKNNUM(1) = "012" OR "025")
           OR  (SYU-KOH-HKNNUM(2) = "012" OR "025")
           OR  (SYU-KOH-HKNNUM(3) = "012" OR "025")
           OR  (SYU-KOH-HKNNUM(4) = "012" OR "025")
             IF   SYU-SYUHKNNUM  NOT = SPACE
                IF   (FLG-ZENKOKUKOHI-NISYU    =  5                 )
                AND  (RECE02-KOHNUM(1)(1:1)    = "0"                )
                AND  (RECE02-KOHNUM(1)     NOT = "012" AND "025"    )
                AND  (RECE02-TOTALTEN(1)       =  RECE02-TOTALTEN(2))
                  IF  FLG-ZENKOKUKOHI-NISYU-SC =  1
                    MOVE       2     TO   FLG-CYOKI-KINGAKU-SET
                    PERFORM    210521B-CYOKI-KINGAKU-SET-SEC
                  END-IF
                ELSE
                  IF   FLG-TOKU75 = 1 OR 2
                    MOVE    4000     TO   WRK-KINGAKU
                  ELSE
                    MOVE    8000     TO   WRK-KINGAKU
                  END-IF
                END-IF
             END-IF
           END-IF
      *
           .
       21052164-KOH-SEIHEI-K-EXT.
           EXIT.
      *
      *****************************************************************
      *    特定疾患等の編集（７０歳未満）
      *****************************************************************
       2105217-TOKUSITU-HENSYU2-SEC               SECTION.
      *
           IF  ((RECE02-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(1)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(1)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(1) =  1                     ))
           OR  ((RECE02-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(2)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(2)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(2) =  1                     ))
           OR  ((RECE02-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(3)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(3)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(3) =  1                     ))
           OR  ((RECE02-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(4)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(4)    = RECE02-KOHIDHC(IDX1 1) ) AND
                (TBL-TOKUSITUFLG(4) =  1                     ))
      ***  OR  ((RECE02-KOHNUM(1)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE02-KOHNUM(1)   = RECE02-KOHNUMHC(IDX1 2)) AND
      ***       (RECE02-KOHID(1)    = RECE02-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(1) =  1                     ))
      ***  OR  ((RECE02-KOHNUM(2)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE02-KOHNUM(2)   = RECE02-KOHNUMHC(IDX1 2)) AND
      ***       (RECE02-KOHID(2)    = RECE02-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(2) =  1                     ))
      ***  OR  ((RECE02-KOHNUM(3)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE02-KOHNUM(3)   = RECE02-KOHNUMHC(IDX1 2)) AND
      ***       (RECE02-KOHID(3)    = RECE02-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(3) =  1                     ))
      ***  OR  ((RECE02-KOHNUM(4)   = SYU-KOH-HKNNUM(2)      ) AND
      ***       (RECE02-KOHNUM(4)   = RECE02-KOHNUMHC(IDX1 2)) AND
      ***       (RECE02-KOHID(4)    = RECE02-KOHIDHC(IDX1 2) ) AND
      ***       (TBL-TOKUSITUFLG(4) =  1                     ))
           OR  ((IDZ                =  2                     ) AND
                (SYU-SKJ-FTNDAY(3)  =  1                     ))
              MOVE      5      TO   FLG-JYOGENKBN2
              IF  RECE02-SRYYM  >= "201501"
                PERFORM 2105218-ICHIBUFTN-KOH-HEN5-SEC
              ELSE
                PERFORM 2105218-ICHIBUFTN-KOH-HEN4-SEC
              END-IF
           ELSE
            IF  ((RECE02-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE02-KOHNUM(1)   = RECE02-KOHNUMHC(IDX1 1)) AND
                 (RECE02-KOHID(1)    = RECE02-KOHIDHC(IDX1 1) ) AND
                 (SYS-1001-PREFNUM   =  23                    ) AND
                 (RECE02-KOHNUM(1)   = "191"                  ) AND
                 (RECE02-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE02-SRYYM      >=  "201204"              ) AND
                 (RECE02-SRYYM      <=  "201509"              ))
            OR  ((RECE02-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE02-KOHNUM(2)   = RECE02-KOHNUMHC(IDX1 1)) AND
                 (RECE02-KOHID(2)    = RECE02-KOHIDHC(IDX1 1) ) AND
                 (SYS-1001-PREFNUM   =  23                    ) AND
                 (RECE02-KOHNUM(2)   = "191"                  ) AND
                 (RECE02-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE02-SRYYM      >=  "201204"              ) AND
                 (RECE02-SRYYM      <=  "201509"              ))
            OR  ((RECE02-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE02-KOHNUM(3)   = RECE02-KOHNUMHC(IDX1 1)) AND
                 (RECE02-KOHID(3)    = RECE02-KOHIDHC(IDX1 1) ) AND
                 (SYS-1001-PREFNUM   =  23                    ) AND
                 (RECE02-KOHNUM(3)   = "191"                  ) AND
                 (RECE02-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE02-SRYYM      >=  "201204"              ) AND
                 (RECE02-SRYYM      <=  "201509"              ))
            OR  ((RECE02-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                 (RECE02-KOHNUM(4)   = RECE02-KOHNUMHC(IDX1 1)) AND
                 (RECE02-KOHID(4)    = RECE02-KOHIDHC(IDX1 1) ) AND
                 (SYS-1001-PREFNUM   =  23                    ) AND
                 (RECE02-KOHNUM(4)   = "191"                  ) AND
                 (RECE02-TEISYUTUSAKI  =  2 OR 6              ) AND
                 (RECE02-SRYYM      >=  "201204"              ) AND
                 (RECE02-SRYYM      <=  "201509"              ))
              MOVE      5      TO   FLG-JYOGENKBN2
              IF  RECE02-SRYYM  >= "201501"
                PERFORM 2105218-ICHIBUFTN-KOH-HEN5X-SEC
              ELSE
                PERFORM 2105218-ICHIBUFTN-KOH-HEN4X-SEC
              END-IF
            ELSE
              MOVE      5      TO   FLG-JYOGENKBN2
              PERFORM   2105214-ICHIBUFTN-KOH-HEN3-SEC
            END-IF
           END-IF
      *
           .
       2105217-TOKUSITU-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集４（平成２６年１２月まで）
      *****************************************************************
       2105218-ICHIBUFTN-KOH-HEN4-SEC               SECTION.
      *
           EVALUATE   FLG-TOKUSITU
            WHEN       1
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN2  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  250000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  75000  +  WRK-KINGAKU2
                  ELSE
                     MOVE     75000  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN2  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  500000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  150000 +  WRK-KINGAKU2
                  ELSE
                     MOVE     150000 TO   WRK-KINGAKU
                  END-IF
                 END-IF
                 PERFORM   210521C-KOH-SEIHEI-Y-SEC
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
                 PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
              WHEN         2
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN4  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  250000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  75000  +  WRK-KINGAKU2
                  ELSE
                     MOVE     75000  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN4  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  500000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  150000 +  WRK-KINGAKU2
                  ELSE
                     MOVE     150000 TO   WRK-KINGAKU
                  END-IF
                 END-IF
                 PERFORM   210521C-KOH-SEIHEI-Y-SEC
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
                 PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
             END-EVALUATE
      *
            WHEN       2
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN2  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN2  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
                 PERFORM   210521C-KOH-SEIHEI-Y-SEC
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
                 PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
              WHEN         2
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN4  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN4  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
                 PERFORM   210521C-KOH-SEIHEI-Y-SEC
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
                 PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
             END-EVALUATE
      *
            WHEN       3
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
                 PERFORM   210521C-KOH-SEIHEI-Y-SEC
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
                 PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
              WHEN         2
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
                 PERFORM   210521C-KOH-SEIHEI-Y-SEC
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
                 PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
             END-EVALUATE
      *
           END-EVALUATE
      *
           .
       2105218-ICHIBUFTN-KOH-HEN4-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集４（特例）（平成２６年１２月まで）
      *****************************************************************
       2105218-ICHIBUFTN-KOH-HEN4X-SEC               SECTION.
      *
           EVALUATE   FLG-GENBUTU70
            WHEN       1
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   83400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN2  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  250000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  75000  +  WRK-KINGAKU2
                  ELSE
                     MOVE     75000  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN2  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  500000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  150000 +  WRK-KINGAKU2
                  ELSE
                     MOVE     150000 TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM     210521C-KOH-SEIHEI-Y-SEC
               MOVE        WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
              WHEN         2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   83400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN4  >  250000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  250000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  75000  +  WRK-KINGAKU2
                  ELSE
                     MOVE     75000  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN4  >  500000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  500000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  150000 +  WRK-KINGAKU2
                  ELSE
                     MOVE     150000 TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM     210521C-KOH-SEIHEI-Y-SEC
               MOVE        WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
             END-EVALUATE
      *
            WHEN       0
            WHEN       2
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU
                 ELSE
                  MOVE   44400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN2  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN2  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN2 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM     210521C-KOH-SEIHEI-Y-SEC
               MOVE        WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
              WHEN         2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU
                 ELSE
                  MOVE   44400   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN4  >  133500
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  133500 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  40050  +  WRK-KINGAKU2
                  ELSE
                     MOVE     40050  TO   WRK-KINGAKU
                  END-IF
                 ELSE
                  IF   WRK-CHIHOU-KIN4  >  267000
                     COMPUTE  WRK-KINGAKU2 =
                           (( WRK-CHIHOU-KIN4 -  267000 ) * 0.01 )
                                                          + 0.5
                     COMPUTE  WRK-KINGAKU  =  80100  +  WRK-KINGAKU2
                  ELSE
                     MOVE     80100  TO   WRK-KINGAKU
                  END-IF
                 END-IF
               END-IF
               PERFORM     210521C-KOH-SEIHEI-Y-SEC
               MOVE        WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
             END-EVALUATE
      *
            WHEN       3
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU
                 ELSE
                  MOVE   24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
               PERFORM     210521C-KOH-SEIHEI-Y-SEC
               MOVE        WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
              WHEN         2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU
                 ELSE
                  MOVE   24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU
                 ELSE
                  MOVE   35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
               PERFORM     210521C-KOH-SEIHEI-Y-SEC
               MOVE        WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
             END-EVALUATE
      *
           END-EVALUATE
      *
           .
       2105218-ICHIBUFTN-KOH-HEN4X-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集５（平成２７年１月から）
      *****************************************************************
       2105218-ICHIBUFTN-KOH-HEN5-SEC               SECTION.
      *
           EVALUATE   FLG-TOKUSITU
            WHEN       1
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN2 >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  421000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN2 >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  279000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN2 >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  842000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN2 >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  558000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 END-IF
                 PERFORM   210521C-KOH-SEIHEI-Y-SEC
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
                 PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
              WHEN         2
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN4 >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  421000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN4 >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  279000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN4 >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  842000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN4 >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  558000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 END-IF
                 PERFORM   210521C-KOH-SEIHEI-Y-SEC
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
                 PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
             END-EVALUATE
      *
            WHEN       2
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN2 >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  133500 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN2 >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  267000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
                 PERFORM   210521C-KOH-SEIHEI-Y-SEC
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
                 PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
              WHEN         2
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN4 >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  133500 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN4 >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  267000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
                 PERFORM   210521C-KOH-SEIHEI-Y-SEC
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
                 PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
             END-EVALUATE
      *
            WHEN       3
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
                 IF  FLG-TOKU75 = 3
                       MOVE    17700   TO   WRK-KINGAKU
                 ELSE
                       MOVE    35400   TO   WRK-KINGAKU
                 END-IF
                 PERFORM   210521C-KOH-SEIHEI-Y-SEC
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
                 PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
              WHEN         2
                 IF  FLG-TOKU75 = 3
                       MOVE    17700   TO   WRK-KINGAKU
                 ELSE
                       MOVE    35400   TO   WRK-KINGAKU
                 END-IF
                 PERFORM   210521C-KOH-SEIHEI-Y-SEC
                 MOVE      WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
                 PERFORM   2105211-ICHIBUFTN-KOH-SET-SEC
             END-EVALUATE
      *
           END-EVALUATE
      *
           .
       2105218-ICHIBUFTN-KOH-HEN5-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額編集５（特例）（平成２７年１月から）
      *****************************************************************
       2105218-ICHIBUFTN-KOH-HEN5X-SEC               SECTION.
      *
           EVALUATE   FLG-GENBUTU70
            WHEN       1
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE    70050   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    46500   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE   140100   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    93000   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN2 >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  421000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN2 >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  279000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN2 >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  842000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN2 >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  558000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 END-IF
               END-IF
               PERFORM     210521C-KOH-SEIHEI-Y-SEC
               MOVE        WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
              WHEN         2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE    70050   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    46500   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE   140100   TO   WRK-KINGAKU
                     WHEN      12
                       MOVE    93000   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN4 >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  421000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 126300 + WRK-KINGAKU2
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN4 >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  279000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  83700 + WRK-KINGAKU2
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN4 >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  842000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 252600 + WRK-KINGAKU2
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN4 >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  558000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  = 167400 + WRK-KINGAKU2
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU
                       END-IF
                   END-EVALUATE
                 END-IF
               END-IF
               PERFORM     210521C-KOH-SEIHEI-Y-SEC
               MOVE        WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
             END-EVALUATE
      *
            WHEN       0
            WHEN       2
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    22200   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    22200   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    44400   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    44400   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN2  =  WRK-CHIHOU-KIN2
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN2 >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  133500 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN2 >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN2 -  267000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               END-IF
               PERFORM     210521C-KOH-SEIHEI-Y-SEC
               MOVE        WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
              WHEN         2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    22200   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    22200   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    44400   TO   WRK-KINGAKU
                     WHEN      22
                       MOVE    44400   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               ELSE
                 COMPUTE   WRK-CHIHOU-KIN4  =  WRK-CHIHOU-KIN4
                                            + (SYU-TOTAL-HKNTEN * 10)
                 IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN4 >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  133500 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  40050 + WRK-KINGAKU2
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU
                   END-EVALUATE
                 ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN4 >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN4 -  267000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU  =  80100 + WRK-KINGAKU2
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU
                   END-EVALUATE
                 END-IF
               END-IF
               PERFORM     210521C-KOH-SEIHEI-Y-SEC
               MOVE        WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
             END-EVALUATE
      *
            WHEN       3
      *
             EVALUATE   FLG-KEISAN2
              WHEN        ZERO
              WHEN         1
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                       MOVE    12300   TO   WRK-KINGAKU
                 ELSE
                       MOVE    24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                       MOVE    17700   TO   WRK-KINGAKU
                 ELSE
                       MOVE    35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
               PERFORM     210521C-KOH-SEIHEI-Y-SEC
               MOVE        WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU2
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
              WHEN         2
               IF  FLG-KOHYONKAIME = 1
                 IF  FLG-TOKU75 = 3
                       MOVE    12300   TO   WRK-KINGAKU
                 ELSE
                       MOVE    24600   TO   WRK-KINGAKU
                 END-IF
               ELSE
                 IF  FLG-TOKU75 = 3
                       MOVE    17700   TO   WRK-KINGAKU
                 ELSE
                       MOVE    35400   TO   WRK-KINGAKU
                 END-IF
               END-IF
               PERFORM     210521C-KOH-SEIHEI-Y-SEC
               MOVE        WRK-KINGAKU TO   WRK-KINGAKU-GENBUTU4
               PERFORM     2105211-ICHIBUFTN-KOH-SET-SEC
             END-EVALUATE
      *
           END-EVALUATE
      *
           .
       2105218-ICHIBUFTN-KOH-HEN5X-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期＋２種の編集
      *****************************************************************
       2105219-ICHIBUFTN-NISYU-HEN-SEC               SECTION.
      *
           EVALUATE  FLG-ZENKOKUKOHI-NISYU
              WHEN       1
              WHEN       5
               IF  RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)
               AND RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)
               AND RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1)
                  MOVE    1    TO   FLG-KEISAN3
               END-IF
               IF  RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)
               AND RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)
               AND RECE02-KOHID(2)  = RECE02-KOHIDHC(IDX1 1)
                  MOVE    2    TO   FLG-KEISAN3
               END-IF
               PERFORM   210521A-ICHIBUFTN-KOH-SET2-SEC
              WHEN       8
               IF  RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1)
               AND RECE02-KOHNUM(1) = RECE02-KOHNUMHC(IDX1 1)
               AND RECE02-KOHID(1)  = RECE02-KOHIDHC(IDX1 1)
                  MOVE    1    TO   FLG-KEISAN3
               END-IF
               IF  RECE02-KOHNUM(3) = SYU-KOH-HKNNUM(1)
               AND RECE02-KOHNUM(3) = RECE02-KOHNUMHC(IDX1 1)
               AND RECE02-KOHID(3)  = RECE02-KOHIDHC(IDX1 1)
                  MOVE    2    TO   FLG-KEISAN3
               END-IF
               PERFORM   210521A-ICHIBUFTN-KOH-SET2-SEC
              WHEN       9
               IF  RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1)
               AND RECE02-KOHNUM(2) = RECE02-KOHNUMHC(IDX1 1)
               AND RECE02-KOHID(2)  = RECE02-KOHIDHC(IDX1 1)
                  MOVE    1    TO   FLG-KEISAN3
               END-IF
               IF  RECE02-KOHNUM(3) = SYU-KOH-HKNNUM(1)
               AND RECE02-KOHNUM(3) = RECE02-KOHNUMHC(IDX1 1)
               AND RECE02-KOHID(3)  = RECE02-KOHIDHC(IDX1 1)
                  MOVE    2    TO   FLG-KEISAN3
               END-IF
               PERFORM   210521A-ICHIBUFTN-KOH-SET2-SEC
           END-EVALUATE
      *
           .
       2105219-ICHIBUFTN-NISYU-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の一部負担金額セット（長期＋２種）
      *****************************************************************
       210521A-ICHIBUFTN-KOH-SET2-SEC               SECTION.
      *
           EVALUATE   FLG-KEISAN3
             WHEN         1
                 IF  FTN-KOH-XX5  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX5
                 END-IF
                 COMPUTE  FTN-KOH-YY5  =   WRK-KINGAKU -  FTN-KOH-XX5
                 IF  WRK-FTNKEI   >   FTN-KOH-YY5
                      ADD    FTN-KOH-YY5    TO  FTN-KOH-XX5
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX5
                 END-IF
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN5
                 MOVE     1                 TO  FLG-XX5-TUUKA
             WHEN         2
                 IF  FTN-KOH-XX6  >   WRK-KINGAKU
                      MOVE   WRK-KINGAKU    TO  FTN-KOH-XX6
                 END-IF
                 COMPUTE  FTN-KOH-YY6  =   WRK-KINGAKU -  FTN-KOH-XX6
                 IF  WRK-FTNKEI   >   FTN-KOH-YY6
                      ADD    FTN-KOH-YY6    TO  FTN-KOH-XX6
                 ELSE
                      ADD    WRK-FTNKEI     TO  FTN-KOH-XX6
                 END-IF
                 ADD      SYU-TOTAL-HKNTEN  TO  WRK-KOH-GAI-GEN70-TEN6
                 MOVE     1                 TO  FLG-XX6-TUUKA
           END-EVALUATE
      *
           .
       210521A-ICHIBUFTN-KOH-SET2-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期金額セット
      *****************************************************************
       210521B-CYOKI-KINGAKU-SET-SEC               SECTION.
      *
           MOVE    ZERO    TO   WRK-CYOKI-TOTAL-HKNKIN-X
           MOVE    ZERO    TO   WRK-CYOKI-TOTAL-HKNKIN-X2
           MOVE    ZERO    TO   FLG-CYOKI-CHECK4
           IF   (RECE02-TEISYOTOKU  NOT =  SPACE)
           AND  (FLG-WRKFILE-CLEAR      =  ZERO )
           AND  (FLG-CYOKI-CHECK    NOT =  ZERO )
             IF   (FLG-ZENKOKUKOHI-NISYU    =  5                 )
             AND  (RECE02-KOHNUM(1)(1:1)    = "0"                )
             AND  (RECE02-KOHNUM(1)     NOT = "012" AND "025"    )
             AND  (RECE02-TOTALTEN(1)       =  RECE02-TOTALTEN(2))
             AND  (FLG-ZENKOKUKOHI-NISYU-SC =  1                 )
               MOVE     99999     TO  WRK-CYOKI-TOTAL-HKNKIN-X
             ELSE
               MOVE     WRK-CYOKI-TOTAL-HKNKIN
                                  TO  WRK-CYOKI-TOTAL-HKNKIN-X
               IF  FLG-CYOKI-HENSYU  =  1
                 IF   FLG-TOKU75  = 1 OR 2
                   IF   WRK-SYUNOU-CYOKI-FTNMONEY  <  4000
                     COMPUTE  WRK-CYOKI-TOTAL-HKNKIN-X2 =
                              4000                      -
                              WRK-SYUNOU-CYOKI-FTNMONEY
                   ELSE
                     MOVE  ZERO   TO  WRK-CYOKI-TOTAL-HKNKIN-X2
                   END-IF
                 ELSE
                   IF   WRK-SYUNOU-CYOKI-FTNMONEY  <  8000
                     COMPUTE  WRK-CYOKI-TOTAL-HKNKIN-X2 =
                              8000                      -
                              WRK-SYUNOU-CYOKI-FTNMONEY
                   ELSE
                     MOVE  ZERO   TO  WRK-CYOKI-TOTAL-HKNKIN-X2
                   END-IF
                 END-IF
                 IF   WRK-CYOKI-TOTAL-HKNKIN-X
                                  <=  WRK-CYOKI-TOTAL-HKNKIN-X2
                     MOVE    1    TO  FLG-CYOKI-CHECK4
                 ELSE
                     MOVE   ZERO  TO  FLG-CYOKI-CHECK4
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF    FLG-ZEROKOGAITO  =  1
             IF  FLG-CYOKI-KINGAKU-SET  =  1
               MOVE    3    TO   FLG-JYOGENKBN2
               MOVE    1    TO   FLG-CYOKI
             END-IF
             IF  FLG-TOKU75 = 1 OR 2
               MOVE  5000   TO   WRK-KINGAKU
             ELSE
               MOVE  10000  TO   WRK-KINGAKU
             END-IF
           ELSE
            IF  ((RECE02-TEISYOTOKU  NOT =  SPACE) AND
                 (FLG-WRKFILE-CLEAR      =  ZERO ) AND
                 (FLG-CYOKI-CHECK        =  ZERO ))
            OR  ((RECE02-TEISYOTOKU  NOT =  SPACE) AND
                 (FLG-WRKFILE-CLEAR      =  ZERO ) AND
                 (FLG-CYOKI-CHECK    NOT =  ZERO ) AND
                 (FLG-TOKU75   NOT =  1 AND 2    ) AND
                 (WRK-CYOKI-TOTAL-HKNKIN-X
                                        <=  8000 ) AND
                 (FLG-CYOKI-HENSYU       =  ZERO ))
            OR  ((RECE02-TEISYOTOKU  NOT =  SPACE) AND
                 (FLG-WRKFILE-CLEAR      =  ZERO ) AND
                 (FLG-CYOKI-CHECK    NOT =  ZERO ) AND
                 (FLG-TOKU75       =  1 OR  2    ) AND
                 (WRK-CYOKI-TOTAL-HKNKIN-X
                                        <=  4000 ) AND
                 (FLG-CYOKI-HENSYU       =  ZERO ))
            OR  ((RECE02-TEISYOTOKU  NOT =  SPACE) AND
                 (FLG-WRKFILE-CLEAR      =  ZERO ) AND
                 (FLG-CYOKI-CHECK    NOT =  ZERO ) AND
                 (WRK-CYOKI-TOTAL-HKNTEN2
                                     NOT =  ZERO ))
             IF  FLG-CYOKI-KINGAKU-SET  =  1
               MOVE    2      TO   FLG-JYOGENKBN2
             END-IF
             IF  FLG-TOKU75 = 1 OR 2
               MOVE    4000   TO   WRK-KINGAKU
             ELSE
               MOVE    8000   TO   WRK-KINGAKU
             END-IF
            ELSE
             IF  ((RECE02-TEISYOTOKU  NOT =  SPACE) AND
                  (FLG-WRKFILE-CLEAR      =  ZERO ) AND
                  (FLG-CYOKI-CHECK    NOT =  ZERO ) AND
                  (FLG-TOKU75   NOT =  1 AND 2    ) AND
                  (WRK-CYOKI-TOTAL-HKNKIN-X
                                          >  8000 ) AND
                  (SYU-KOH-HKNNUM(1)      =  "972") AND
                  (SYU-KOH-HKNNUM(2)      =  SPACE) AND
                  (SYU-KOH-HKNNUM(3)      =  SPACE) AND
                  (SYU-KOH-HKNNUM(4)      =  SPACE) AND
                  (SYU-TOTAL-HKNTEN   NOT =  ZERO ) AND
                  (FLG-CYOKI-HENSYU       =  ZERO ))
             OR  ((RECE02-TEISYOTOKU  NOT =  SPACE) AND
                  (FLG-WRKFILE-CLEAR      =  ZERO ) AND
                  (FLG-CYOKI-CHECK    NOT =  ZERO ) AND
                  (FLG-TOKU75       =  1 OR  2    ) AND
                  (WRK-CYOKI-TOTAL-HKNKIN-X
                                          >  4000 ) AND
                  (SYU-KOH-HKNNUM(1)      =  "972") AND
                  (SYU-KOH-HKNNUM(2)      =  SPACE) AND
                  (SYU-KOH-HKNNUM(3)      =  SPACE) AND
                  (SYU-KOH-HKNNUM(4)      =  SPACE) AND
                  (SYU-TOTAL-HKNTEN   NOT =  ZERO ) AND
                  (FLG-CYOKI-HENSYU       =  ZERO ))
               IF  FLG-CYOKI-KINGAKU-SET  =  1
                 MOVE    1    TO   FLG-CYOKI2
               END-IF
               MOVE    ZERO   TO   WRK-KINGAKU
             ELSE
               IF  (RECE02-TEISYOTOKU  NOT =  SPACE)
               AND (FLG-WRKFILE-CLEAR      =  ZERO )
               AND (FLG-CYOKI-CHECK    NOT =  ZERO )
               AND (WRK-CYOKI-TOTAL-HKNTEN
                                       NOT =  ZERO )
               AND (FLG-CYOKI-HENSYU       =   1   )
                 PERFORM   210521B1-CYOKI-KINGAKU-SET2-SEC
               ELSE
                 IF  FLG-CYOKI-KINGAKU-SET  =  1
                   MOVE    3    TO   FLG-JYOGENKBN2
                   MOVE    1    TO   FLG-CYOKI
                 END-IF
                 IF  FLG-TOKU75 = 1 OR 2
                   MOVE  5000   TO   WRK-KINGAKU
                 ELSE
                   MOVE  10000  TO   WRK-KINGAKU
                 END-IF
               END-IF
             END-IF
            END-IF
           END-IF
      *
           .
       210521B-CYOKI-KINGAKU-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    長期金額セット
      *****************************************************************
       210521B1-CYOKI-KINGAKU-SET2-SEC               SECTION.
      *
           IF      FLG-CYOKI-CHECK4  =  1
             IF  FLG-CYOKI-KINGAKU-SET  =  1
               MOVE    2      TO   FLG-JYOGENKBN2
             END-IF
             IF  FLG-TOKU75 = 1 OR 2
               MOVE    4000   TO   WRK-KINGAKU
             ELSE
               MOVE    8000   TO   WRK-KINGAKU
             END-IF
           ELSE
             IF   (SYU-KOH-HKNNUM(1)      =  "972")
             AND  (SYU-KOH-HKNNUM(2)      =  SPACE)
             AND  (SYU-KOH-HKNNUM(3)      =  SPACE)
             AND  (SYU-KOH-HKNNUM(4)      =  SPACE)
             AND  (SYU-TOTAL-HKNTEN   NOT =  ZERO )
             AND  (FLG-CYOKI-HENSYU3      =   1   )
               IF  FLG-CYOKI-KINGAKU-SET  =  1
                 MOVE    1    TO   FLG-CYOKI2
               END-IF
               MOVE    ZERO   TO   WRK-KINGAKU
             ELSE
               IF  FLG-CYOKI-KINGAKU-SET  =  1
                 MOVE    3    TO   FLG-JYOGENKBN2
                 MOVE    1    TO   FLG-CYOKI
               END-IF
               IF  FLG-TOKU75 = 1 OR 2
                 MOVE  5000   TO   WRK-KINGAKU
               ELSE
                 MOVE  10000  TO   WRK-KINGAKU
               END-IF
             END-IF
           END-IF
      *
           .
       210521B1-CYOKI-KINGAKU-SET2-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費実日数テーブル情報のセット
      *****************************************************************
       210522-KOHJNISSUTBL-SET-SEC               SECTION.
      *
           EVALUATE   SYS-1001-PREFNUM
      *
             WHEN    "38"
      *
               IF   SYU-KOH-HKNNUM(IDX3)(1:1) = "1" OR "2" OR "3" OR
                                                "4" OR "5" OR "6" OR
                                                "7" OR "8"
                    MOVE   SYU-SRYYMD(7:2)  TO   IDX8
                    MOVE     1   TO   TBL-CHIIKI-SANTEI-FLG(IDX30 IDX8)
                    IF  SYU-TOTAL-HKNTEN  NOT = ZERO
                      MOVE   2   TO   TBL-CHIIKI-SANTEI-FLG(IDX30 IDX8)
                    END-IF
               END-IF
      *
           END-EVALUATE
      *
           .
       210522-KOHJNISSUTBL-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    負担金額（一部負担額）項目の編集
      *****************************************************************
       210523-FTNMONEY-FTN-HENSYU-SEC               SECTION.
      *
      *    老人保険＋原爆
           IF      RECE02-SRYYM      >=  "200404"
           AND     RECE02-SRYYM      <=  "200803"
              IF   ( RECE02-ZAITAKU            =    SPACE )  AND
                   ( RECE02-RJNHKNNUM      NOT =    SPACE )  AND
                   ( SYU-KOH-HKNNUM(IDX3)      =    "019" )
      *
                    EVALUATE   IDX3
                      WHEN      2
                        COMPUTE  WRK-FTNKEI-FTN  =  SYU-TOTAL-HKNTEN
                                                 *  10
                                                 *  RECE02-KYURATE
                                                 /  100
                        ADD      WRK-FTNKEI-FTN  TO
                                         RECE02-FTNMONEY-FTN(KH-IDX)
      *
                      WHEN      3
                      WHEN      4
                        MOVE    SYU-KOH-COMPFTN(IDX3 - 1)
                                                 TO   WRK-FTNKEI-FTN
                        ADD      WRK-FTNKEI-FTN  TO
                                         RECE02-FTNMONEY-FTN(KH-IDX)
                    END-EVALUATE
      *
                    IF   ( SYU-KOH-HKNNUM(1) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(2) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(3) =   "972" )  OR
                         ( SYU-KOH-HKNNUM(4) =   "972" )
                       IF    RECE02-FTNMONEY-FTN(KH-IDX)   >   10000
                          MOVE   10000  TO  RECE02-FTNMONEY-FTN(KH-IDX)
                       END-IF
                    ELSE
                       IF    RECE02-FTNMONEY-FTN(KH-IDX)   >   12000
                          MOVE   12000  TO  RECE02-FTNMONEY-FTN(KH-IDX)
                       END-IF
                    END-IF
      *
              END-IF
           END-IF
      *
      *    宮城県乳幼児
      *    北海道精神助成
      *
           MOVE     ZERO     TO    FLG-MIYAGI
      *
           EVALUATE   SYS-1001-PREFNUM
      *
             WHEN    "04"
      *
               IF    RECE02-SRYYM         >=   "200510"
               AND   RECE02-SRYYM         <=   "200803"
      *
                 IF  SYU-KOH-HKNNUM(IDX3)  =  "183" OR "383" OR "483"
      *
                     IF  RECE02-KOHFTNJANUM(KH-IDX - 1)(1:7) = "8304102"
                           MOVE     1    TO     FLG-MIYAGI
                     END-IF
                     IF  RECE02-KOHFTNJANUM(KH-IDX - 1)(1:7) = "8304125"
                       IF  RECE02-SRYYM   >=   "200610"
                           CONTINUE
                       ELSE
                           MOVE     2    TO     FLG-MIYAGI
                       END-IF
                     END-IF
      *
                     IF    FLG-MIYAGI    NOT  =    ZERO
      *
                        MOVE   FLG-MIYAGI  TO  TBL-KEISAN-FLG(KH-IDX)
      *
                        EVALUATE   IDX3
                          WHEN      1
                            ADD   SYU-SYUCOMPFTN-ENTANI
                                         TO  TBL-KEISAN-ENTANI(KH-IDX)
                          WHEN      2
                          WHEN      3
                          WHEN      4
                            ADD   SYU-KOH-COMPFTN-ENTANI(IDX3 - 1)
                                         TO  TBL-KEISAN-ENTANI(KH-IDX)
                        END-EVALUATE
      *
                     END-IF
      *
                 END-IF
      *
               END-IF
      *
             WHEN    "01"
      *
               IF    RECE02-SRYYM         >=   "200604"
               AND   RECE02-SRYYM         <=   "200803"
      *
                 IF  SYU-KOH-HKNNUM(IDX3)  =  "121"
      *
                     MOVE        1    TO  TBL-KEISAN-FLG(KH-IDX)
      *
                     EVALUATE   IDX3
                       WHEN      1
                         ADD   SYU-SYUCOMPFTN-ENTANI
                                      TO  TBL-KEISAN-ENTANI(KH-IDX)
                       WHEN      2
                       WHEN      3
                       WHEN      4
                         ADD   SYU-KOH-COMPFTN-ENTANI(IDX3 - 1)
                                      TO  TBL-KEISAN-ENTANI(KH-IDX)
                     END-EVALUATE
      *
                 END-IF
      *
               END-IF
      *
             WHEN    "32"
      *
               IF    RECE02-SRYYM         >=   "200708"
               AND   RECE02-SRYYM         <=   "201409"
      *
                 IF  SYU-KOH-HKNNUM(IDX3)  =  "191"
      *
                     MOVE        1    TO  TBL-KEISAN-FLG(KH-IDX)
      *
                     ADD   SYU-KOH-COMPFTN-ENTANI(IDX3)
                                      TO  TBL-KEISAN-ENTANI(KH-IDX)
      *
                 END-IF
      *
               END-IF
      *
           END-EVALUATE
      *
           .
       210523-FTNMONEY-FTN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    負担金額（一部負担額）項目の編集
      *****************************************************************
       210524-FTNMONEY-HENSYU-SEC               SECTION.
      *
           IF       RECE02-SRYYM      >=  "200604"
      *
              IF  (SYS-1001-PREFNUM  =   32                    )
              AND (RECE02-KOHNUM(KH-IDX - 1)
                            =  "190" OR "290" OR "191" OR "291")
              AND (RECE02-SRYYM     >=  "201410"               )
              AND (IDX3             <=   3                     )
                COMPUTE   IDX-NEXT   =   IDX3   +   1
                IF  SYU-KOH-HKNNUM(IDX-NEXT)(1:1) >=  "1" AND <=  "8"
                  PERFORM   2105241-KOHHBTNUM-CHECK-SEC
                  IF  RECE02-KOHHBTNUM(KH-IDX - 1) =  WRK-KOHHBTNUM
                   MOVE   IDX-NEXT  TO   IDX3
                  END-IF
                END-IF
              END-IF
      *
              COMPUTE  RECE02-YKZFTN(KH-IDX) = RECE02-YKZFTN(KH-IDX)
                                             + SYU-KOH-COMPYKZFTN(IDX3)
              ADD      1      TO   RECE02-KOHKENSU(KH-IDX - 1)
              IF  (( RECE02-ZAITAKU             =  "1" OR "2"     ) AND
                   ((RECE02-KOHNUM(KH-IDX - 1)  =  "015" OR "016"
                                                OR "051" OR "021"
                                                OR "024" OR "079"
                                                OR "052" OR "012"
                                                OR "025" OR "038") OR
                    (TBL-TOKATUKAIFLG(KH-IDX - 1)   =  1         )))
              OR  (( RECE02-ZAITAKU             =  "1" OR "2"     ) AND
                   ( RECE02-KOHNUM(KH-IDX - 1)  =  "054"          ) AND
                   ( RECE02-SRYYM              >=  "201501"       ))
              OR  (( RECE02-ZAITAKU             =  "1" OR "2"     ) AND
                   ( WRK-KOHJGNGET-TEKIYOFLG(KH-IDX - 1)  =  1    ))
              OR  (  TBL-HKNFTNDATA-FLG(KH-IDX - 1) =  1           )
                IF  ((RECE02-ZAITAKU                 =  "2") AND
                     (WRK-SYUNOU-GEN70-HANTEIFLG(IDX1)
                                                     = ZERO) AND
                     (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
                                                 NOT = ZERO) AND
                     (TBL-HKNFTNDATA-FLG(KH-IDX - 1) = ZERO) AND
                     (RECE02-SRYYM              >= "201204"))
                OR  ((RECE02-ZAITAKU                 =  "2") AND
                     (RECE02-KOHNUM(KH-IDX - 1)
                             =  "015"  OR  "016"  OR  "021") AND
                     (TBL-HKNFTNDATA-JGNXXX(KH-IDX - 1)
                                        = 9999999 OR 999999))
                  ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                           RECE02-FTNMONEY(KH-IDX)
                                           RECE02-FTNMONEY-KOJ(KH-IDX)
                  ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                        WRK-TAIHI-FTNMONEY(KH-IDX)
                                        WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                  ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                        WRK-TAIHI-FTNMONEY2(KH-IDX)
                  MOVE   1   TO   WRK-KOGAKU-TAISYOGAI(KH-IDX - 1)
                  IF   ( RECE02-ZAITAKU = "1" OR "2"          )
                  AND  ((RECE02-KOHNUM(KH-IDX - 1)(1:1) = "0") OR
                        (TBL-TOKATUKAIFLG(KH-IDX - 1)   =  1 ))
                  AND  ( IDX3                           =  1  )
                    ADD SYU-KOH-COMPFTN(IDX3)      TO
                                           RECE02-KOHFTNKIN(IDX1 IDX3)
                  END-IF
                ELSE
                  ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                           RECE02-FTNMONEY(KH-IDX)
                                           RECE02-FTNMONEY-KOJ(KH-IDX)
                  ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                        WRK-TAIHI-FTNMONEY(KH-IDX)
                                        WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                  IF   ( RECE02-ZAITAKU = "1" OR "2"          )
                  AND  ((RECE02-KOHNUM(KH-IDX - 1)(1:1) = "0") OR
                        (TBL-TOKATUKAIFLG(KH-IDX - 1)   =  1 ))
                  AND  ( IDX3                           =  1  )
                    ADD SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                           RECE02-KOHFTNKIN(IDX1 IDX3)
                  END-IF
                  IF  (TBL-HKNFTNDATA-FLG(KH-IDX - 1)  =  1)
                  AND (IDX3                            =  1)
                  AND (SYU-NYNSHOKAISU                 =  9)
                     COMPUTE  WRK-TAIHI-FTNMONEY-SAGAKU(KH-IDX) =
                              WRK-TAIHI-FTNMONEY-SAGAKU(KH-IDX) +
                             (SYU-KOH-HKNFTNMONEY(IDX3) -
                                         SYU-KOH-COMPFTN(IDX3))
                     MOVE    1    TO    TBL-HKNFTNDATA-FLG2(KH-IDX - 1)
                  END-IF
                END-IF
              ELSE
                IF   (RECE02-EKF-ENCHGKBN-K(KH-IDX) NOT = SPACE)
                OR   (RECE02-EKF-ENCHGKBN-Y(KH-IDX) NOT = SPACE)
                  IF   RECE02-KOUREI-HANTEIFLG   =   "1"
                    EVALUATE   RECE02-EKF-ENCHGKBN-K(KH-IDX)
                      WHEN       SPACE
                        ADD   SYU-KOH-COMPFTN(IDX3)        TO
                                      RECE02-FTNMONEY(KH-IDX)
                                      RECE02-FTNMONEY-KOJ(KH-IDX)
                      WHEN       "1"
                        ADD   SYU-KOH-HKNFTNMONEY(IDX3)    TO
                                      RECE02-FTNMONEY(KH-IDX)
                                      RECE02-FTNMONEY-KOJ(KH-IDX)
                      WHEN       "2"
                      WHEN       "3"
                        IF    RECE02-ZAITAKU  =  "1"
                          ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                      RECE02-FTNMONEY(KH-IDX)
                                      RECE02-FTNMONEY-KOJ(KH-IDX)
                          ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                      WRK-TAIHI-FTNMONEY(KH-IDX)
                                      WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                        ELSE
                          ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                      RECE02-FTNMONEY(KH-IDX)
                                      RECE02-FTNMONEY-KOJ(KH-IDX)
                        END-IF
                    END-EVALUATE
                  ELSE
                    EVALUATE   RECE02-EKF-ENCHGKBN-Y(KH-IDX)
                      WHEN       SPACE
                        ADD   SYU-KOH-COMPFTN(IDX3)        TO
                                      RECE02-FTNMONEY(KH-IDX)
                                      RECE02-FTNMONEY-KOJ(KH-IDX)
                      WHEN       "1"
                        ADD   SYU-KOH-HKNFTNMONEY(IDX3)    TO
                                      RECE02-FTNMONEY(KH-IDX)
                                      RECE02-FTNMONEY-KOJ(KH-IDX)
                      WHEN       "2"
                      WHEN       "3"
                        IF    RECE02-ZAITAKU  =  "2"
                          ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                      RECE02-FTNMONEY(KH-IDX)
                                      RECE02-FTNMONEY-KOJ(KH-IDX)
                          ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                      WRK-TAIHI-FTNMONEY(KH-IDX)
                                      WRK-TAIHI-FTNMONEY-KOJ(KH-IDX)
                        ELSE
                          ADD   SYU-KOH-COMPFTN(IDX3)      TO
                                      RECE02-FTNMONEY(KH-IDX)
                                      RECE02-FTNMONEY-KOJ(KH-IDX)
                        END-IF
                    END-EVALUATE
                  END-IF
                ELSE
                  IF    (RECE02-ZAITAKU             =  SPACE)
                  AND   (RECE02-KOHNUM(KH-IDX - 1)  =  "010")
                      ADD   SYU-KOH-COMPFTN(IDX3)  TO
                                           RECE02-FTNMONEY-KOJ(KH-IDX)
                  ELSE
                    IF   RECE02-KOHNUM(KH-IDX - 1)  =  "019"
                      IF    SYU-KOH-COMPFTN-ENTANI(IDX3) NOT = ZERO
                        MOVE  1       TO  RECE02-GENBAKU-TOKFLG
                        ADD   SYU-KOH-COMPFTN-ENTANI(IDX3)
                                      TO  RECE02-GENBAKU-FTNKIN(IDX1)
                        MOVE  KH-IDX  TO  RECE02-GENBAKU-IDX(IDX1)
                      END-IF
                    ELSE
                      IF  (RECE02-EKF-FTNHASUKBN(KH-IDX)      = "1")
                      AND (RECE02-HON-GAIKFTNRATE(KH-IDX - 1)(3:1)
                                                          NOT = "0")
                        COMPUTE  WRK-CHIIKI-ENTANI            =
                                 SYU-KOH-COMPFTN-ENTANI(IDX3) +
                                 0.9
                        ADD   WRK-CHIIKI-ENTANI
                                      TO  RECE02-FTNMONEY(KH-IDX)
                                          RECE02-FTNMONEY-KOJ(KH-IDX)
                      ELSE
                        ADD   SYU-KOH-COMPFTN(IDX3)
                                      TO  RECE02-FTNMONEY(KH-IDX)
                                          RECE02-FTNMONEY-KOJ(KH-IDX)
                        IF   (RECE02-ZAITAKU = "1" OR "2"         )
                        AND  (RECE02-KOHNUM(KH-IDX - 1)(1:1) = "0")
                        AND  (IDX3                           =  1 )
                          ADD SYU-KOH-COMPFTN(IDX3)
                                      TO  RECE02-KOHFTNKIN(IDX1 IDX3)
                        END-IF
                      END-IF
                    END-IF
                  END-IF
                END-IF
              END-IF
      *
              COMPUTE  WRK-TAIHI-FTNMONEY-EN(KH-IDX)  =
                       WRK-TAIHI-FTNMONEY-EN(KH-IDX)  +
                      (SYU-KOH-COMPFTN-ENTANI(IDX3)   + 0.9)
              COMPUTE  WRK-TAIHI-FTNMONEY-EN2(KH-IDX) =
                       WRK-TAIHI-FTNMONEY-EN2(KH-IDX) +
                       SYU-KOH-COMPFTN-ENTANI(IDX3)
      *
              IF    ( RECE02-KOHNUM(KH-IDX - 1) =
                                     "010" OR "012" OR "015" OR
                                     "016" OR "021" OR "024" OR
                                     "051" OR "052" OR "079" OR
                                     "025" OR "038"             )
              OR    ((RECE02-KOHNUM(KH-IDX - 1) =  "054"       ) AND
                     (RECE02-SRYYM             >=  "201501"    ))
                EVALUATE   RECE02-KOHNUM(KH-IDX - 1)
                  WHEN       "010"
                    MOVE     5                  TO   WRK-KYURATE2
                    PERFORM  2105243-KOH-KEISAN1-SEC
                    PERFORM  2105242-KOH-GEN-KEISAN-SEC
      *
                    MOVE     5                  TO   WRK-KYURATE2
                    PERFORM  2105244-KOH-KEISAN2-SEC
                  WHEN       "012"
                  WHEN       "051"
                  WHEN       "025"
                  WHEN       "038"
                    IF  ((FLG-ZENKI-TOKUREI             =   1  ) AND
                         (RECE02-KOHNUM(KH-IDX - 1)     = "051"))
                    OR  ((FLG-ZENKI-TOKUREI             =   1  ) AND
                         (RECE02-KOHNUM(KH-IDX - 1)     = "038"))
                      MOVE   20                 TO   WRK-KYURATE2
                    ELSE
                      MOVE   RECE02-KYURATE     TO   WRK-KYURATE2
                    END-IF
                    PERFORM  2105243-KOH-KEISAN1-SEC
                    PERFORM  2105242-KOH-GEN-KEISAN-SEC
      *
                    MOVE     RECE02-KYURATE     TO   WRK-KYURATE2
                    PERFORM  2105244-KOH-KEISAN2-SEC
                  WHEN       "015"
                  WHEN       "016"
                  WHEN       "021"
                  WHEN       "024"
                  WHEN       "079"
                    MOVE     10                 TO   WRK-KYURATE2
                    PERFORM  2105243-KOH-KEISAN1-SEC
                    PERFORM  2105242-KOH-GEN-KEISAN-SEC
      *
                    MOVE     10                 TO   WRK-KYURATE2
                    PERFORM  2105244-KOH-KEISAN2-SEC
                  WHEN       "052"
                  WHEN       "054"
                    IF  ((FLG-ZENKI-TOKUREI         =  1      ) AND
                         (RECE02-KOHNUM(KH-IDX - 1) = "054"   ) AND
                         (RECE02-SRYYM             >= "201501"))
                    OR  ((RECE02-KYURATE           >=  20     ) AND
                         (RECE02-SRYYM             >= "201501"))
                      MOVE   20                 TO   WRK-KYURATE2
                    ELSE
                      MOVE   RECE02-KYURATE     TO   WRK-KYURATE2
                    END-IF
                    PERFORM  2105243-KOH-KEISAN1-SEC
                    PERFORM  2105242-KOH-GEN-KEISAN-SEC
      *
                    IF   (RECE02-KYURATE           >=  20     )
                    AND  (RECE02-SRYYM             >= "201501")
                      MOVE   20                 TO   WRK-KYURATE2
                    ELSE
                      MOVE   RECE02-KYURATE     TO   WRK-KYURATE2
                    END-IF
                    PERFORM  2105244-KOH-KEISAN2-SEC
                END-EVALUATE
              END-IF
      *
              IF  ((SYS-1001-PREFNUM          =  13  ) AND
                   (RECE02-KOHNUM(KH-IDX - 1) = "151"))
              OR  ((SYS-1001-PREFNUM          =  23  ) AND
                   (RECE02-KOHNUM(KH-IDX - 1) = "191") AND
                   (RECE02-SRYYM         >=  "200910"))
              OR  ((SYS-1001-PREFNUM          =  23
                                              OR 24  ) AND
                   (RECE02-KOHNUM(KH-IDX - 1) = "152") AND
                   (RECE02-SRYYM         >=  "201104") AND
                   (RECE02-SRYYM         <=  "201412"))
                    IF    FLG-ZENKI-TOKUREI  =   1
                      MOVE   20                 TO   WRK-KYURATE2
                    ELSE
                      MOVE   RECE02-KYURATE     TO   WRK-KYURATE2
                    END-IF
                    PERFORM  2105243-KOH-KEISAN1-SEC
                    PERFORM  2105242-KOH-GEN-KEISAN-SEC
      *
                    MOVE     RECE02-KYURATE     TO   WRK-KYURATE2
                    PERFORM  2105244-KOH-KEISAN2-SEC
              END-IF
      *
              IF    WRK-KOHJGNGET-TEKIYOFLG(KH-IDX - 1)  =   1
                    IF  (FLG-ZENKI-TOKUREI  =  1 )
                    OR  (RECE02-KYURATE    >=  20)
                      MOVE   20                 TO   WRK-KYURATE2
                    ELSE
                      MOVE   RECE02-KYURATE     TO   WRK-KYURATE2
                    END-IF
                    PERFORM  2105243-KOH-KEISAN1-SEC
                    PERFORM  2105242-KOH-GEN-KEISAN-SEC
      *
                    IF   RECE02-KYURATE    >=  20
                      MOVE   20                 TO   WRK-KYURATE2
                    ELSE
                      MOVE   RECE02-KYURATE     TO   WRK-KYURATE2
                    END-IF
                    PERFORM  2105244-KOH-KEISAN2-SEC
              END-IF
      *
              IF   RECE02-KOHNUM(KH-IDX - 1)  =  "051"
              AND  FLG-KOH                NOT =   2
                    MOVE     1    TO    FLG-KOH
              END-IF
              IF   RECE02-KOHNUM(KH-IDX - 1)  =  "010"
                    MOVE     2    TO    FLG-KOH
              END-IF
           ELSE
              COMPUTE  RECE02-YKZFTN(KH-IDX) = RECE02-YKZFTN(KH-IDX)
                                             + SYU-KOH-COMPYKZFTN(IDX3)
              ADD      1      TO   RECE02-KOHKENSU(KH-IDX - 1)
              IF    (RECE02-SRYYM              >=  "200404"      )
              AND   (RECE02-ZAITAKU             =  "1" OR "2"    )
              AND   (RECE02-KOHNUM(KH-IDX - 1)  =  "015" OR "016"
                                                         OR "051")
                  ADD   SYU-KOH-HKNFTNMONEY(IDX3)  TO
                                           RECE02-FTNMONEY(KH-IDX)
                                           RECE02-FTNMONEY-KOJ(KH-IDX)
              ELSE
                  IF    (RECE02-ZAITAKU             =  SPACE         )
                  AND   (RECE02-KOHNUM(KH-IDX - 1)  =  "010" OR "021")
                      ADD   SYU-KOH-COMPFTN(IDX3)  TO
                                           RECE02-FTNMONEY-KOJ(KH-IDX)
                  ELSE
                      ADD   SYU-KOH-COMPFTN(IDX3)  TO
                                           RECE02-FTNMONEY(KH-IDX)
                                           RECE02-FTNMONEY-KOJ(KH-IDX)
                  END-IF
              END-IF
      *
              IF   RECE02-KOHNUM(KH-IDX - 1)  =  "051"
              AND  FLG-KOH                NOT =   2
                    MOVE     1    TO    FLG-KOH
              END-IF
              IF   RECE02-KOHNUM(KH-IDX - 1)  =  "010"  OR  "021"
                    MOVE     2    TO    FLG-KOH
              END-IF
           END-IF
      *
           .
       210524-FTNMONEY-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    法別番号チェック
      *****************************************************************
       2105241-KOHHBTNUM-CHECK-SEC               SECTION.
      *
           MOVE     SPACE    TO    WRK-KOHHBTNUM
           MOVE     ZERO     TO    FLG-ARI
           PERFORM  VARYING  IDX24   FROM    1   BY  1
                     UNTIL  (IDX24             >  100 )
                      OR    (WRK-HKNNUM(IDX24) = SPACE)
                      OR    (FLG-ARI           =  1   )
             IF  SYU-KOH-HKNNUM(IDX-NEXT) = WRK-HKNNUM(IDX24)
                MOVE    1    TO    FLG-ARI
                MOVE    WRK-HKNNUM-KOHHBTNUM(IDX24)
                             TO    WRK-KOHHBTNUM
             END-IF
           END-PERFORM
           IF    FLG-ARI  =   ZERO
             INITIALIZE                     HKNNUM-REC
             MOVE    RECE02-HOSPNUM     TO  HKN-HOSPNUM
             MOVE    SYU-KOH-HKNNUM(IDX-NEXT)
                                        TO  HKN-HKNNUM
             MOVE    RECE02-SRYYM       TO  HKN-TEKSTYMD(1:6)
                                            HKN-TEKEDYMD(1:6)
             MOVE    "01"               TO  HKN-TEKSTYMD(7:2)
                                            HKN-TEKEDYMD(7:2)
             MOVE    "00"               TO  HKN-PAYKBN
             MOVE    HKNNUM-REC         TO  MCPDATA-REC
             MOVE    "tbl_hknnum"       TO  MCP-TABLE
             MOVE    "key"              TO  MCP-PATHNAME
             PERFORM   900-DBSELECT-SEC
             IF     MCP-RC   =   ZERO
               MOVE  "tbl_hknnum"       TO  MCP-TABLE
               MOVE  "key"              TO  MCP-PATHNAME
               PERFORM 900-DBFETCH-SEC
               IF   MCP-RC   =   ZERO
                 MOVE    MCPDATA-REC    TO  HKNNUM-REC
                 IF  IDX24 <= 100
                   MOVE  HKN-HKNNUM     TO  WRK-HKNNUM(IDX24)
                   MOVE  HKN-HBTNUM     TO  WRK-HKNNUM-KOHHBTNUM(IDX24)
                 END-IF
                 MOVE    HKN-HBTNUM     TO  WRK-KOHHBTNUM
               END-IF
             END-IF
             MOVE    "tbl_hknnum"       TO  MCP-TABLE
             MOVE    "key"              TO  MCP-PATHNAME
             PERFORM   900-CLOSE-SEC
           END-IF
      *
           .
       2105241-KOHHBTNUM-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費に関わる一部負担金の減免計算
      *****************************************************************
       2105242-KOH-GEN-KEISAN-SEC               SECTION.
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
      *
              COMPUTE  WRK-TAIHI-GENKIN2 = SYU-TOTAL-HKNTEN
                                         * 10
                                         * WRK-KYURATE2
                                         / 100
      *
              EVALUATE   WK-GENGAKUKBN
                WHEN        1
                  IF  WK-GENGAKUKBN-KEISAN  =  2
                    CONTINUE
                  ELSE
                    IF  WK-GENGAKU-RITU = 100
                        MOVE   ZERO     TO   WRK-TAIHI-GENKIN2
                    ELSE
                        COMPUTE  WK-GENGAKU-RITUX =
                                 100 - WK-GENGAKU-RITU
                        IF    WRK-TAIHI-GENKIN2  NOT = ZERO
                          COMPUTE  WRK-TAIHI-GENKIN2  =
                                   WRK-TAIHI-GENKIN2  *
                                   WK-GENGAKU-RITUX   /
                                   100
                        END-IF
                    END-IF
                  END-IF
                WHEN        2
                  MOVE  WRK-TAIHI-GENKIN2  TO  WRK-FTNKEI-GENGAKU2
                  COMPUTE  WRK-FTNKEI-GENGAKU2 =
                           WRK-FTNKEI-GENGAKU2 +  5
                  COMPUTE  WRK-FTNKEI-GENGAKU2 =
                           WRK-FTNKEI-GENGAKU2 /  10
                  COMPUTE  WRK-FTNKEI-GENGAKU2 =
                           WRK-FTNKEI-GENGAKU2 *  10
      *
                  IF  WRK-TAIHI-GENKIN2 < WK-GENGAKU-KIN3
                    MOVE   ZERO   TO   WRK-TAIHI-GENKIN2
                  ELSE
                    COMPUTE  WRK-TAIHI-GENKIN2  =
                             WRK-TAIHI-GENKIN2  -
                             WK-GENGAKU-KIN3
                  END-IF
      *
                  IF  WK-GENGAKU-KIN3  <=  WRK-FTNKEI-GENGAKU2
                    MOVE   ZERO   TO   WK-GENGAKU-KIN3
                  ELSE
                    COMPUTE  WK-GENGAKU-KIN3   =
                             WK-GENGAKU-KIN3   -
                             WRK-FTNKEI-GENGAKU2
                  END-IF
                WHEN        3
                WHEN        4
                      MOVE   ZERO     TO   WRK-TAIHI-GENKIN2
                WHEN        5
                  MOVE  WRK-TAIHI-GENKIN2  TO  WRK-FTNKEI-GENGAKU2
                  COMPUTE  WRK-FTNKEI-GENGAKU2 =
                           WRK-FTNKEI-GENGAKU2 +  5
                  COMPUTE  WRK-FTNKEI-GENGAKU2 =
                           WRK-FTNKEI-GENGAKU2 /  10
                  COMPUTE  WRK-FTNKEI-GENGAKU2 =
                           WRK-FTNKEI-GENGAKU2 *  10
      *
                  IF  WRK-TAIHI-GENKIN2 > WK-GENGAKU-KIN3
                    COMPUTE  WRK-TAIHI-GENKIN2  =
                             WK-GENGAKU-KIN3
                  END-IF
      *
                  IF  WK-GENGAKU-KIN3  <=  WRK-FTNKEI-GENGAKU2
                    MOVE   ZERO   TO   WK-GENGAKU-KIN3
                  ELSE
                    COMPUTE  WK-GENGAKU-KIN3   =
                             WK-GENGAKU-KIN3   -
                             WRK-FTNKEI-GENGAKU2
                  END-IF
              END-EVALUATE
              ADD      WRK-TAIHI-GENKIN2  TO
                                  WRK-TAIHI-GENKIN-EN-GEN(KH-IDX - 1)
              MOVE     WRK-TAIHI-GENKIN2  TO
                                  WRK-TAIHI-GENKIN4
              COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 +  5
              COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 / 10
              COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 * 10
              ADD      WRK-TAIHI-GENKIN4  TO
                                  WRK-TAIHI-GENKIN-GEN(KH-IDX - 1)
      *
           END-IF
      *
           .
       2105242-KOH-GEN-KEISAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費に関わる一部負担金の計算１
      *****************************************************************
       2105243-KOH-KEISAN1-SEC               SECTION.
      *
           COMPUTE  WRK-TAIHI-GENKIN2 = SYU-TOTAL-HKNTEN
                                      * 10
                                      * WRK-KYURATE2
                                      / 100
      *
           ADD      WRK-TAIHI-GENKIN2  TO
                               WRK-TAIHI-GENKIN-EN(KH-IDX - 1)
           MOVE     WRK-TAIHI-GENKIN2  TO
                               WRK-TAIHI-GENKIN4
           COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 +  5
           COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 / 10
           COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 * 10
           ADD      WRK-TAIHI-GENKIN4  TO
                               WRK-TAIHI-GENKIN(KH-IDX - 1)
      *
           .
       2105243-KOH-KEISAN1-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費に関わる一部負担金の計算２
      *****************************************************************
       2105244-KOH-KEISAN2-SEC               SECTION.
      *
           COMPUTE  WRK-TAIHI-GENKIN2 = SYU-TOTAL-HKNTEN
                                      * 10
                                      * WRK-KYURATE2
                                      / 100
      *
           MOVE     WRK-TAIHI-GENKIN2  TO
                               WRK-TAIHI-GENKIN4
           COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 +  5
           COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 / 10
           COMPUTE  WRK-TAIHI-GENKIN4 = WRK-TAIHI-GENKIN4 * 10
           ADD      WRK-TAIHI-GENKIN4  TO
                               WRK-TAIHI-GENKIN9(KH-IDX - 1)
      *
           .
       2105244-KOH-KEISAN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       210526-SKY-SYUNOU-HENSYU-SEC               SECTION.
      *
           ADD   SYU-TOTAL-HKNTEN   TO   RECE02-SKYIRYO-TOTALTEN
      *
           IF   SYU-SYUHKNNUM   NOT =  SPACE
              COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                       *  10
                                       * (100 - RECE02-KYURATE)
                                       /  100
              IF   RECE02-RECESYUBETU  =  "6666"
                 MOVE  ZERO             TO   WRK-SKY-KEISAN
              END-IF
              ADD      WRK-SKY-KEISAN   TO   RECE02-SKYIRYO-HOKENJA
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-HOKENJA
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                       *  10
                                       *  RECE02-KYURATE
                                       /  100
              IF   RECE02-RECESYUBETU  =  "6666"
                 COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                          *  10
              END-IF
      *
              IF    SYU-YKZKENNUM   =  3  OR  4
                ADD    WRK-SKY-KEISAN   TO   RECE02-SKYIRYO-HOKENJA
                ADD    WRK-SKY-KEISAN   TO   WRK-SKY-HOKENJA
              ELSE
                COMPUTE  WRK-SKY-KEISAN  =   WRK-SKY-KEISAN +  5
                COMPUTE  WRK-SKY-KEISAN  =   WRK-SKY-KEISAN / 10
                COMPUTE  WRK-SKY-KEISAN  =   WRK-SKY-KEISAN * 10
      *
                ADD    WRK-SKY-KEISAN   TO   WRK-SKY-ICHIBUFTN
                ADD    SYU-GRP-SGKMONEY TO   WRK-SKY-ICHIBUFTN
      *
                IF     SYU-KOH-HKNNUM(1) = "970"
                  COMPUTE  WRK-SKY-KEISAN  =   SYU-SYUCOMPFTN
                ELSE
                  COMPUTE  WRK-SKY-KEISAN  =   SYU-HKNTEKMONEY
                                           +   SYU-KOH-FTN
                END-IF
                ADD    WRK-SKY-KEISAN   TO   WRK-SKY-FTNMONEY
                IF  (SYU-KOH-HKNNUM(1) = SPACE OR "970")
                AND (SYU-KOH-HKNNUM(2) = SPACE         )
                AND (SYU-KOH-HKNNUM(3) = SPACE         )
                AND (SYU-KOH-HKNNUM(4) = SPACE         )
                  ADD  WRK-SKY-KEISAN   TO   WRK-SKY-FTNMONEY3
                END-IF
      *
                IF     FLG-KOHSKY-ARI     =  1
                  IF  (SYU-KOH-HKNNUM(1)  =   SPACE OR "970" OR
                                              "972" OR "974"    )
                  AND (SYU-KOH-HKNNUM(2)  =   SPACE             )
                  AND (SYU-KOH-HKNNUM(3)  =   SPACE             )
                  AND (SYU-KOH-HKNNUM(4)  =   SPACE             )
                    ADD    WRK-SKY-KEISAN
                                        TO   WRK-SKY-FTNMONEY-JYOKEN
                  END-IF
                END-IF
      *
                IF     SYU-KOH-HKNNUM(1) = "970"
                  ADD  SYU-SYUCOMPFTN   TO   RECE02-SKYIRYO-ICHIBUFTN
                ELSE
                  ADD  SYU-HKNTEKMONEY  TO   RECE02-SKYIRYO-ICHIBUFTN
                  ADD  SYU-KOH-FTN      TO   RECE02-SKYIRYO-ICHIBUFTN
                END-IF
              END-IF
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                       *  10
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-ZENGAKU
      *
              IF  (SYU-KOH-HKNNUM(1) = SPACE OR "970")
              AND (SYU-KOH-HKNNUM(2) = SPACE         )
              AND (SYU-KOH-HKNNUM(3) = SPACE         )
              AND (SYU-KOH-HKNNUM(4) = SPACE         )
                CONTINUE
              ELSE
                IF    SYU-YKZKENNUM   =  3  OR  4
                  COMPUTE   WRK-SKY-KEISAN =  SYU-TOTAL-HKNTEN
                                           *  10
                  ADD       WRK-SKY-KEISAN   TO  WRK-SKY-HOKENJA-KOH
                ELSE
                  COMPUTE   WRK-SKY-KEISAN =  SYU-TOTAL-HKNTEN
                                           *  10
                                           * (100 - RECE02-KYURATE)
                                           /  100
                  ADD       WRK-SKY-KEISAN   TO  WRK-SKY-HOKENJA-KOH
                END-IF
      *
                COMPUTE   WRK-SKY-KEISAN =  SYU-TOTAL-HKNTEN
                                         *  10
                ADD       WRK-SKY-KEISAN   TO  WRK-SKY-ZENGAKU-KOH
      *
                PERFORM   2105262-SKY-SYUNOU-HENSYU4-SEC
      *
                IF     FLG-KOHSKY-ARI     =  1
                  IF  (SYU-KOH-HKNNUM(1)  =   "972" OR "974")
                  AND (SYU-KOH-HKNNUM(2)  =   SPACE         )
                  AND (SYU-KOH-HKNNUM(3)  =   SPACE         )
                  AND (SYU-KOH-HKNNUM(4)  =   SPACE         )
                    ADD   SYU-KOH-FTN-ENTANI
                                     TO  WRK-SKY-FTNMONEY-KOH-JYOKEN
                  END-IF
                END-IF
      *
                IF  (RECE02-KOHNUM(1) = SYU-KOH-HKNNUM(1))
                OR  (RECE02-KOHNUM(2) = SYU-KOH-HKNNUM(1))
                OR  (RECE02-KOHNUM(3) = SYU-KOH-HKNNUM(1))
                OR  (RECE02-KOHNUM(4) = SYU-KOH-HKNNUM(1))
                  CONTINUE
                ELSE
                  IF (RECE02-KOHSKY-KOHNUM(1) = SYU-KOH-HKNNUM(1))
                  OR (RECE02-KOHSKY-KOHNUM(2) = SYU-KOH-HKNNUM(1))
                  OR (RECE02-KOHSKY-KOHNUM(3) = SYU-KOH-HKNNUM(1))
                  OR (RECE02-KOHSKY-KOHNUM(4) = SYU-KOH-HKNNUM(1))
                    IF  (SYU-KOH-HKNNUM(1)(1:1) >=  "1" AND <=  "8")
                    AND (SYU-JYO-COMPFTN     NOT =   ZERO          )
                    AND (RECE02-SRYYM           >=  "201010"       )
                    AND (IDZ                     =   1             )
                    AND (FLG-SKY-TOKKOH          =   ZERO          )
                       PERFORM   2105261-SKY-SYUNOU-HENSYU2-SEC
                    END-IF
                  END-IF
                END-IF
              END-IF
      *
              IF    FLG-KOHSKY-ARI  =  1
                PERFORM  VARYING  IDX36  FROM  4  BY  -1
                          UNTIL   IDX36    <   1
                  IF  ( SYU-KOH-HKNNUM(IDX36) NOT = SPACE        )
                  AND ((SYU-KOH-HKNNUM(IDX36) = RECE02-KOHNUM(1)) OR
                       (SYU-KOH-HKNNUM(IDX36) = RECE02-KOHNUM(2)) OR
                       (SYU-KOH-HKNNUM(IDX36) = RECE02-KOHNUM(3)) OR
                       (SYU-KOH-HKNNUM(IDX36) = RECE02-KOHNUM(4)))
                    IF  SYU-KOH-HKNNUM(IDX36) = "972" OR "974"
                      CONTINUE
                    ELSE
                      ADD   SYU-KOH-HKNFTNMONEY(IDX36)
                                   TO  WRK-KOHSKY-XXX-COMPFTN-RUI
                      ADD   SYU-KOH-COMPFTN-ENTANI(IDX36)
                                   TO  WRK-KOHSKY-XXX-COMPFTN-EN-RUI
                      MOVE  1      TO  WRK-KOHSKY-XXX-FLG(IDX1)
                      MOVE  1      TO  IDX36
                    END-IF
                  ELSE
                    IF  ( SYU-KOH-HKNNUM(IDX36) NOT = SPACE       )
                    AND ((SYU-KOH-HKNNUM(IDX36) =
                                          RECE02-KOHSKY-KOHNUM(1)) OR
                         (SYU-KOH-HKNNUM(IDX36) =
                                          RECE02-KOHSKY-KOHNUM(2)) OR
                         (SYU-KOH-HKNNUM(IDX36) =
                                          RECE02-KOHSKY-KOHNUM(3)) OR
                         (SYU-KOH-HKNNUM(IDX36) =
                                          RECE02-KOHSKY-KOHNUM(4)))
                      MOVE  2      TO  WRK-KOHSKY-XXX-FLG(IDX1)
                    END-IF
                  END-IF
                END-PERFORM
              END-IF
           ELSE
              COMPUTE  WRK-SKY-KEISAN  =  SYU-TOTAL-HKNTEN
                                       *  10
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-ZENGAKU2
      *
              COMPUTE  WRK-SKY-KEISAN  =  SYU-HKNTEKMONEY
                                       +  SYU-KOH-FTN
              ADD      WRK-SKY-KEISAN   TO   WRK-SKY-FTNMONEY2
      *
              ADD      SYU-HKNTEKMONEY  TO   RECE02-SKYIRYO-ICHIBUFTN
              ADD      SYU-KOH-FTN      TO   RECE02-SKYIRYO-ICHIBUFTN
           END-IF
      *
           .
       210526-SKY-SYUNOU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集（システム管理２０１０編集）
      *****************************************************************
       2105261-SKY-SYUNOU-HENSYU2-SEC               SECTION.
      *
           INITIALIZE                    SYSKANRI-REC
           MOVE    "2010"            TO  SYS-KANRICD
           MOVE    SYU-KOH-HKNNUM(1) TO  SYS-KBNCD
           MOVE    RECE02-SRYYM      TO  SYS-STYUKYMD (1:6)
           MOVE    "01"              TO  SYS-STYUKYMD (7:2)
           MOVE    SYS-STYUKYMD      TO  SYS-EDYUKYMD
           MOVE    "tbl_syskanri"    TO  WRK-MCP-TABLE
           MOVE    "key10"           TO  WRK-MCP-PATHNAME
           PERFORM 960-KANRIMST-READ-SEC
           IF      FLG-SYSKANRI     =   ZERO
              MOVE    MCPDATA-REC    TO  SYS-2010-REC
           ELSE
              INITIALIZE                 SYS-2010-REC
           END-IF
      *
           PERFORM   21052611-SKY-SYUNOU-HENSYU3-SEC
      *
           .
       2105261-SKY-SYUNOU-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集（システム管理２０１０編集）
      *****************************************************************
       21052611-SKY-SYUNOU-HENSYU3-SEC               SECTION.
      *
           IF   RECE02-SRYYM  >= "201010"
             EVALUATE  SYS-2010-NINNASIKBN
               WHEN      SPACE
                 EVALUATE   SYS-1001-PREFNUM
                   WHEN      "04"
                     IF   SYU-KOH1HKNNUM  =  "583" OR "683" OR "783"
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                     IF  (SYU-KOH1HKNNUM  =  "363" OR "563")
                     AND (RECE02-SRYYM   >=  "201201"      )
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                     IF  (SYU-KOH1HKNNUM  =  "263" OR "463")
                     AND (RECE02-SRYYM   >=  "201201"      )
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                     END-IF
                     IF  (SYU-KOH1HKNNUM  =  "763"         )
                     AND (RECE02-SRYYM   >=  "201310"      )
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                     IF  (SYU-KOH1HKNNUM  =  "663"         )
                     AND (RECE02-SRYYM   >=  "201310"      )
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                     END-IF
                   WHEN      "10"
                     IF  (SYU-KOH1HKNNUM  =  "145" OR "245" OR "146"
                                          OR "246" OR "143" OR "243")
                     AND (RECE02-SRYYM   >=  "201104"               )
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                       OR ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM        =  "060") AND
                           (RECE02-HKNJANUM(7:2) =  SPACE) AND
                           (RECE02-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                     END-IF
                   WHEN      "11"
                     IF  (SYU-KOH1HKNNUM  =  "772"                  )
                     AND (RECE02-SRYYM   >=  "201304"               )
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                   WHEN      "12"
                     IF  (SYU-KOH1HKNNUM  =  "263" OR "363" OR "463")
                     AND (RECE02-SRYYM   >=  "201203"               )
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                   WHEN      "40"
                     IF   SYU-KOH1HKNNUM  =  "383"
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                   WHEN      "44"
                     IF   SYU-KOH1HKNNUM  =  "183" OR "283"
                         MOVE     1     TO    FLG-SKY-TOKKOH
                     END-IF
                 END-EVALUATE
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
               WHEN       "5"
               WHEN       "6"
               WHEN       "7"
               WHEN       "8"
                 EVALUATE   SYS-2010-NINNASI-TAIKBN
                   WHEN      "0"
                         MOVE     1     TO    FLG-SKY-TOKKOH
                   WHEN      "1"
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                       OR ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM        =  "060") AND
                           (RECE02-HKNJANUM(7:2) =  SPACE) AND
                           (RECE02-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                   WHEN      "2"
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                   WHEN      "3"
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM        =  "060") AND
                           (RECE02-HKNJANUM(7:2) =  SPACE) AND
                           (RECE02-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           IF   RECE02-SRYYM  >= "201104"
             EVALUATE  SYS-2010-NINJYOKBN
               WHEN      SPACE
               WHEN       "0"
                 EVALUATE   SYS-1001-PREFNUM
                   WHEN      "10"
                     IF   SYU-KOH1HKNNUM  =  "145" OR "245" OR "146"
                                          OR "246" OR "143" OR "243"
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                       OR ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM        =  "060") AND
                           (RECE02-HKNJANUM(7:2) =  SPACE) AND
                           (RECE02-HKNJANUM(3:1) =  "3"  ))
                         IF   RECE02-SRYYM  <= "201412"
                           MOVE     1     TO    FLG-SKY-TOKKOH
                         END-IF
                       END-IF
                     END-IF
                 END-EVALUATE
               WHEN       "1"
               WHEN       "2"
                 EVALUATE   SYS-2010-NINJYO-TAIKBN
                   WHEN      "0"
                         MOVE     1     TO    FLG-SKY-TOKKOH
                   WHEN      "1"
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                       OR ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM        =  "060") AND
                           (RECE02-HKNJANUM(7:2) =  SPACE) AND
                           (RECE02-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                   WHEN      "2"
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                   WHEN      "3"
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM        =  "060") AND
                           (RECE02-HKNJANUM(7:2) =  SPACE) AND
                           (RECE02-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           IF   RECE02-SRYYM  >= "201808"
             EVALUATE  SYS-2010-NINNASIKBN-K
               WHEN       "2"
                 EVALUATE   SYS-2010-NINNASI-TAIKBN-K
                   WHEN      "0"
                         MOVE     1     TO    FLG-SKY-TOKKOH
                   WHEN      "1"
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                       OR ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM        =  "060") AND
                           (RECE02-HKNJANUM(7:2) =  SPACE) AND
                           (RECE02-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                   WHEN      "2"
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM    NOT =
                                "060" AND "067" AND "039"))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                   WHEN      "3"
                       IF ((RECE02-HKNNUM    NOT =  SPACE) AND
                           (RECE02-HKNNUM        =  "060") AND
                           (RECE02-HKNJANUM(7:2) =  SPACE) AND
                           (RECE02-HKNJANUM(3:1) =  "3"  ))
                         MOVE     1     TO    FLG-SKY-TOKKOH
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           EVALUATE   SYS-1001-PREFNUM
             WHEN      "04"
              IF  (SYU-KOH1HKNNUM  =
                             "363" OR "563" OR "263" OR "463")
              AND (RECE02-SRYYM    <  "201201"               )
                         MOVE    ZERO   TO    FLG-SKY-TOKKOH
              END-IF
              IF  (SYU-KOH1HKNNUM  =           "663" OR "763")
              AND (RECE02-SRYYM    <  "201310"               )
                         MOVE    ZERO   TO    FLG-SKY-TOKKOH
              END-IF
             WHEN      "10"
              IF  (SYU-KOH1HKNNUM  =  "145" OR "245" OR "146"
                                   OR "246" OR "143" OR "243")
              AND (RECE02-SRYYM    <  "201104"               )
                         MOVE    ZERO   TO    FLG-SKY-TOKKOH
              END-IF
             WHEN      "11"
              IF  (SYU-KOH1HKNNUM  =  "772"   )
              AND (RECE02-SRYYM    <  "201304")
                         MOVE    ZERO   TO    FLG-SKY-TOKKOH
              END-IF
             WHEN      "12"
              IF  (SYU-KOH1HKNNUM  =  "263" OR "363" OR "463")
              AND (RECE02-SRYYM    <  "201203"               )
                         MOVE    ZERO   TO    FLG-SKY-TOKKOH
              END-IF
           END-EVALUATE
      *
           .
       21052611-SKY-SYUNOU-HENSYU3-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       2105262-SKY-SYUNOU-HENSYU4-SEC               SECTION.
      *
           MOVE     ZERO         TO     FLG-CHIIKI3
           PERFORM  VARYING  IDX36  FROM  4  BY  -1
                     UNTIL   IDX36    <   1
             IF  (SYU-KOH-HKNNUM(IDX36) NOT = SPACE          )
             AND (SYU-KOH-HKNNUM(IDX36) NOT = "972" AND "974")
               IF  (SYU-KOH-HKNNUM(IDX36) = RECE02-KOHNUM(1))
               OR  (SYU-KOH-HKNNUM(IDX36) = RECE02-KOHNUM(2))
               OR  (SYU-KOH-HKNNUM(IDX36) = RECE02-KOHNUM(3))
               OR  (SYU-KOH-HKNNUM(IDX36) = RECE02-KOHNUM(4))
                 IF SYU-KOH-HKNNUM(IDX36)(1:1) >= "1" AND <= "8"
                   PERFORM    21052621-SKY-SYUNOU-HENSYU5-SEC
                   MOVE   1   TO  FLG-CHIIKI3
                 END-IF
               ELSE
                 IF  (SYU-KOH-HKNNUM(IDX36) =
                                      RECE02-KOHSKY-KOHNUM(1))
                 OR  (SYU-KOH-HKNNUM(IDX36) =
                                      RECE02-KOHSKY-KOHNUM(2))
                 OR  (SYU-KOH-HKNNUM(IDX36) =
                                      RECE02-KOHSKY-KOHNUM(3))
                 OR  (SYU-KOH-HKNNUM(IDX36) =
                                      RECE02-KOHSKY-KOHNUM(4))
                   PERFORM    21052622-SKY-SYUNOU-HENSYU6-SEC
                   MOVE   2   TO  FLG-CHIIKI3
                 END-IF
               END-IF
               MOVE       1   TO  IDX36
             END-IF
           END-PERFORM
           IF  FLG-CHIIKI3  =  ZERO
                   ADD    SYU-KOH-FTN-ENTANI
                              TO  WRK-SKY-FTNMONEY-KOH
           END-IF
      *
           COMPUTE  WRK-CHIIKI-ENTANI   =
                    SYU-KOH-FTN-ENTANI  +
                    0.9
           ADD   WRK-CHIIKI-ENTANI
                       TO  WRK-SKY-FTNMONEY-KOH2
           ADD   SYU-KOH-FTN
                       TO  WRK-SKY-FTNMONEY-KOH3
      *
           .
       2105262-SKY-SYUNOU-HENSYU4-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       21052621-SKY-SYUNOU-HENSYU5-SEC               SECTION.
      *
           IF   ((SYU-KOH-HKNNUM(IDX36)  =  RECE02-KOHNUM(1)) AND
                 (RECE02-HON-GAIKFTNRATE(1)(3:1)  NOT = "0" ) AND
                 (RECE02-EKF-FTNHASUKBN(2)            = "1" ))
           OR   ((SYU-KOH-HKNNUM(IDX36)  =  RECE02-KOHNUM(2)) AND
                 (RECE02-HON-GAIKFTNRATE(2)(3:1)  NOT = "0" ) AND
                 (RECE02-EKF-FTNHASUKBN(3)            = "1" ))
           OR   ((SYU-KOH-HKNNUM(IDX36)  =  RECE02-KOHNUM(3)) AND
                 (RECE02-HON-GAIKFTNRATE(3)(3:1)  NOT = "0" ) AND
                 (RECE02-EKF-FTNHASUKBN(4)            = "1" ))
           OR   ((SYU-KOH-HKNNUM(IDX36)  =  RECE02-KOHNUM(4)) AND
                 (RECE02-HON-GAIKFTNRATE(4)(3:1)  NOT = "0" ) AND
                 (RECE02-EKF-FTNHASUKBN(5)            = "1" ))
             COMPUTE  WRK-CHIIKI-ENTANI    =
                      SYU-KOH-FTN-ENTANI   +   0.9
             ADD   WRK-CHIIKI-ENTANI  TO  WRK-SKY-FTNMONEY-KOH
           ELSE
             COMPUTE  WRK-CHIIKI-ENTANI    =
                      SYU-KOH-FTN-ENTANI
             ADD   WRK-CHIIKI-ENTANI  TO  WRK-SKY-FTNMONEY-KOH
           END-IF
      *
           .
       21052621-SKY-SYUNOU-HENSYU5-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額収納編集
      *****************************************************************
       21052622-SKY-SYUNOU-HENSYU6-SEC               SECTION.
      *
           IF   ((SYS-1001-PREFNUM       =  43              ) AND
                 (SYU-KOH-HKNNUM(IDX36)  = "143" OR "342"   ) AND
                 (RECE02-SRYYM          >= "200912"         ))
           OR   ((SYS-1001-PREFNUM       =  43              ) AND
                 (SYU-KOH-HKNNUM(IDX36)  = "443"            ) AND
                 (RECE02-SRYYM          >= "201608"         ))
             COMPUTE  WRK-CHIIKI-ENTANI    =
                      SYU-KOH-FTN-ENTANI   +   0.9
             ADD   WRK-CHIIKI-ENTANI  TO  WRK-SKY-FTNMONEY-KOH
           ELSE
             COMPUTE  WRK-CHIIKI-ENTANI    =
                      SYU-KOH-FTN-ENTANI
             ADD   WRK-CHIIKI-ENTANI  TO  WRK-SKY-FTNMONEY-KOH
           END-IF
      *
           .
       21052622-SKY-SYUNOU-HENSYU6-EXT.
           EXIT.
      *
      *****************************************************************
      *    該当保険組み合わせに含まれている公費が
      *    レセプト記載対象となっているか
      *****************************************************************
       210527-KOHARI-CHECK-SEC      SECTION.
      *
           MOVE    ZERO   TO   FLG-KOHARI-CHECK
           IF  ((RECE02-KOHNUM(1)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(1)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(1)    = RECE02-KOHIDHC(IDX1 1) ))
           OR  ((RECE02-KOHNUM(2)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(2)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(2)    = RECE02-KOHIDHC(IDX1 1) ))
           OR  ((RECE02-KOHNUM(3)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(3)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(3)    = RECE02-KOHIDHC(IDX1 1) ))
           OR  ((RECE02-KOHNUM(4)   = SYU-KOH-HKNNUM(1)      ) AND
                (RECE02-KOHNUM(4)   = RECE02-KOHNUMHC(IDX1 1)) AND
                (RECE02-KOHID(4)    = RECE02-KOHIDHC(IDX1 1) ))
             MOVE    1    TO   FLG-KOHARI-CHECK
           END-IF
      *
           .
       210527-KOHARI-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    分娩特記事項編集
      *****************************************************************
       21053-BUNBEN-TOKKI-HENSYU-SEC      SECTION.
      *
           IF   (FLG-BUNBEN-SET  =   ZERO   )
           AND  (RECE02-SRYYM   >=  "200910")
              IF ( RECE02-HKNNUM(1:2)   =  "98"  OR "90"  OR "91" )
              OR ( RECE02-HKNNUM        =  "039" OR "040"         )
              OR ((RECE02-HKNNUM        =  "002") AND
                  (RECE02-HOJOKBN   NOT =  SPACE)                 )
                CONTINUE
              ELSE
                INITIALIZE                    BUNBEN-REC
                MOVE    RECE02-HOSPNUM    TO  BUNBEN-HOSPNUM
                MOVE    RECE02-PTID       TO  BUNBEN-PTID
                MOVE    "2"               TO  BUNBEN-NYUGAIKBN
                MOVE    SYU-DENPNUM       TO  BUNBEN-RRKNUM
                MOVE    BUNBEN-REC        TO  MCPDATA-REC
                MOVE    "tbl_bunben"      TO  MCP-TABLE
                MOVE    "key3"            TO  MCP-PATHNAME
                PERFORM   900-DBSELECT-SEC
                IF      MCP-RC            =   ZERO
                  MOVE  "tbl_bunben"      TO  MCP-TABLE
                  MOVE  "key3"            TO  MCP-PATHNAME
                  PERFORM 900-DBFETCH-SEC
                  IF    MCP-RC            =   ZERO
                    MOVE   MCPDATA-REC    TO  BUNBEN-REC
                    IF   (BUNBEN-RIYOUKBN    =   "1")
                    AND  (BUNBEN-BUNBENKBN   =   "2")
                       MOVE     11        TO  FLG-TOKKI
                       PERFORM  21045-TOKKI-HENSYU-SEC
                       MOVE     1         TO  FLG-BUNBEN-SET
                    END-IF
                  END-IF
                END-IF
                MOVE    "tbl_bunben"      TO  MCP-TABLE
                MOVE    "key3"            TO  MCP-PATHNAME
                PERFORM   900-CLOSE-SEC
              END-IF
           END-IF
      *
           .
       21053-BUNBEN-TOKKI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの項目転送２（Ｆ００２）:実日数編集
      *****************************************************************
       2106-JNISSU-SET-SEC                    SECTION.                       
      *
      *実日数から減する
           PERFORM    VARYING    HKN-IDX    FROM   1   BY   1
                       UNTIL     HKN-IDX    >      5
             PERFORM    VARYING    ACCT-IDX    FROM    1   BY   1
                         UNTIL     ACCT-IDX    >      31
                IF  (TBL-JNISSU-DAY(HKN-IDX ACCT-IDX)      NOT =  SPACE)
                AND (TBL-JNISSU-DAY-GEN(HKN-IDX ACCT-IDX)  NOT =  SPACE)
                    MOVE  SPACE  TO  TBL-JNISSU-DAY(HKN-IDX ACCT-IDX)
                END-IF
             END-PERFORM
           END-PERFORM
      *
           PERFORM    VARYING    HKN-IDX    FROM   3   BY   1
                       UNTIL     HKN-IDX    >      5
             PERFORM    VARYING    ACCT-IDX    FROM    1   BY   1
                         UNTIL     ACCT-IDX    >      31
                IF  (TBL-JNISSU2-DAY(HKN-IDX ACCT-IDX)     NOT =  SPACE)
                AND (TBL-JNISSU-DAY-GEN(HKN-IDX ACCT-IDX)  NOT =  SPACE)
                    MOVE  SPACE  TO  TBL-JNISSU2-DAY(HKN-IDX ACCT-IDX)
                END-IF
             END-PERFORM
           END-PERFORM
      *
           PERFORM    VARYING    HKN-IDX    FROM   1   BY   1
                       UNTIL     HKN-IDX    >      5
             PERFORM    VARYING    ACCT-IDX    FROM    1   BY   1
                         UNTIL     ACCT-IDX    >      31
                IF   TBL-JNISSU-DAY(HKN-IDX ACCT-IDX)      NOT =  SPACE
                    MOVE   "1"   TO  TBL-JNISSU-DAY-M(ACCT-IDX)
                END-IF
             END-PERFORM
           END-PERFORM
      *
      *実日数編集
           PERFORM    VARYING    HKN-IDX    FROM   1   BY   1
                      UNTIL      HKN-IDX    >      5
               PERFORM    VARYING    ACCT-IDX    FROM    1   BY   1
                          UNTIL      ACCT-IDX    >     31
                    IF    TBL-JNISSU-DAY(HKN-IDX ACCT-IDX)
                                        NOT =  SPACE
                          ADD    1      TO    RECE02-JNISSU(HKN-IDX)
                    END-IF
               END-PERFORM
           END-PERFORM
      *
           PERFORM    VARYING    HKN-IDX    FROM   3   BY   1
                      UNTIL      HKN-IDX    >      5
               PERFORM    VARYING    ACCT-IDX    FROM    1   BY   1
                          UNTIL      ACCT-IDX    >     31
                    IF    TBL-JNISSU2-DAY(HKN-IDX ACCT-IDX)
                                        NOT =  SPACE
                          ADD    1      TO    TBL-JNISSU2-MON(HKN-IDX)
                    END-IF
               END-PERFORM
           END-PERFORM
      *
           PERFORM    VARYING    ACCT-IDX    FROM    1   BY   1
                      UNTIL      ACCT-IDX    >     31
                    IF    TBL-JNISSU-DAY-M(ACCT-IDX)
                                        NOT =  SPACE
                          ADD    1      TO    RECE02-SKYIRYO-NISSU
                    END-IF
           END-PERFORM
      *
      *実日数テーブル編集
           PERFORM    VARYING    HKN-IDX    FROM   1   BY   1
                      UNTIL      HKN-IDX    >      5
               PERFORM    VARYING    ACCT-IDX    FROM    1   BY   1
                          UNTIL      ACCT-IDX    >     31
                    IF    TBL-JNISSU-DAY(HKN-IDX ACCT-IDX)
                                        NOT =  SPACE
                          MOVE   "1"    TO    RECE02-JNISSUTBL(ACCT-IDX)
                    END-IF
               END-PERFORM
           END-PERFORM
      *公費実日数テーブル編集
           PERFORM    VARYING    HKN-IDX    FROM   1   BY   1
                      UNTIL      HKN-IDX    >      5
             PERFORM    VARYING    ACCT-IDX    FROM    1   BY   1
                        UNTIL      ACCT-IDX    >     31
               IF   TBL-CHIIKI-SANTEI-FLG(HKN-IDX ACCT-IDX) =   2
                    MOVE   "2"    TO    RECE02-KOHJNISSUTBL(ACCT-IDX)
               END-IF
               IF  (TBL-CHIIKI-SANTEI-FLG(HKN-IDX ACCT-IDX) =   1  )
               AND (RECE02-JNISSUTBL(ACCT-IDX)              =  "1" )
               AND (RECE02-KOHJNISSUTBL(ACCT-IDX)       NOT =  "2" )
               AND (RECE02-HENTOTALTEN(HKN-IDX)         NOT =  ZERO)
                    MOVE   "1"    TO    RECE02-KOHJNISSUTBL(ACCT-IDX)
               END-IF
             END-PERFORM
           END-PERFORM
      *
      ***
      *
           IF    RECE02-FUKUSHIFLG(3)  =  "2"
              IF  (RECE02-KOHNUM(2)(1:1) >= "1" AND <= "8")
              AND (RECE02-TOTALTEN(3)     =  ZERO         )
                 MOVE  RECE02-HENTOTALTEN(3)  TO  RECE02-TOTALTEN(3)
              END-IF
              IF  (RECE02-KOHNUM(2)(1:1) >= "1" AND <= "8")
              AND (RECE02-JNISSU(3)       =  ZERO         )
                 MOVE  TBL-JNISSU2-MON(3)     TO  RECE02-JNISSU(3)
              END-IF
           END-IF
           IF    RECE02-FUKUSHIFLG(4)  =  "2"
              IF  (RECE02-KOHNUM(3)(1:1) >= "1" AND <= "8")
              AND (RECE02-TOTALTEN(4)     =  ZERO         )
                 MOVE  RECE02-HENTOTALTEN(4)  TO  RECE02-TOTALTEN(4)
              END-IF
              IF  (RECE02-KOHNUM(3)(1:1) >= "1" AND <= "8")
              AND (RECE02-JNISSU(4)       =  ZERO         )
                 MOVE  TBL-JNISSU2-MON(4)     TO  RECE02-JNISSU(4)
              END-IF
           END-IF
           IF    RECE02-FUKUSHIFLG(5)  =  "2"
              IF  (RECE02-KOHNUM(4)(1:1) >= "1" AND <= "8")
              AND (RECE02-TOTALTEN(5)     =  ZERO         )
                 MOVE  RECE02-HENTOTALTEN(5)  TO  RECE02-TOTALTEN(5)
              END-IF
              IF  (RECE02-KOHNUM(4)(1:1) >= "1" AND <= "8")
              AND (RECE02-JNISSU(5)       =  ZERO         )
                 MOVE  TBL-JNISSU2-MON(5)     TO  RECE02-JNISSU(5)
              END-IF
           END-IF
      *
           .
       2106-JNISSU-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルの基本点数部分のクリア処理（Ｆ００２）
      *****************************************************************
       2107-KHNTEN-CLEAR-SEC               SECTION.
      *
           IF        FLG-KHNTEN2        =    1
               MOVE    ZERO             TO   RECE02-KHNTEN(2)
           END-IF
           IF        FLG-KHNTEN3        =    1
               MOVE    ZERO             TO   RECE02-KHNTEN(3)
           END-IF
           IF        FLG-KHNTEN4        =    1
               MOVE    ZERO             TO   RECE02-KHNTEN(4)
           END-IF
           IF        FLG-KHNTEN5        =    1
               MOVE    ZERO             TO   RECE02-KHNTEN(5)
           END-IF
           IF        FLG-KHNTEN6        =    1
               MOVE    ZERO             TO   RECE02-KHNTEN(6)
           END-IF
           IF        FLG-KHNTEN15        =    1
               MOVE    ZERO             TO   RECE02-KHNTEN(15)
           END-IF
           IF        FLG-KHNTEN18        =    1
               MOVE    ZERO             TO   RECE02-KHNTEN(18)
           END-IF
           IF        FLG-KHNTEN19        =    1
               MOVE    ZERO             TO   RECE02-KHNTEN(19)
           END-IF
      *
           .
       2107-KHNTEN-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト中間ファイルのぶん点数部分のクリア処理（Ｆ００２）
      *****************************************************************
       2108-BUNTENSU-CLEAR-SEC               SECTION.                        
      *
      *    インデックス２
           IF (RECE02-HENTOTALTEN(2)   NOT =  ZERO)           AND
              (RECE02-HENTOTALTEN(1)   NOT =  RECE02-HENTOTALTEN(2))
               CONTINUE
           ELSE
               PERFORM    VARYING    HKN-IDX    FROM   1   BY   1
                          UNTIL      HKN-IDX    >      50
                       MOVE   ZERO   TO   RECE02-TENSU(HKN-IDX 2)
               END-PERFORM
           END-IF
      *    インデックス３
           IF (RECE02-HENTOTALTEN(3)   NOT =  ZERO)           AND
              (RECE02-HENTOTALTEN(1)   NOT =  RECE02-HENTOTALTEN(3))
               CONTINUE
           ELSE
               PERFORM    VARYING    HKN-IDX    FROM   1   BY   1
                          UNTIL      HKN-IDX    >      50
                       MOVE   ZERO   TO   RECE02-TENSU(HKN-IDX 3)
               END-PERFORM
           END-IF
      *    インデックス４
           IF (RECE02-HENTOTALTEN(4)   NOT =  ZERO)           AND
              (RECE02-HENTOTALTEN(1)   NOT =  RECE02-HENTOTALTEN(4))
               CONTINUE
           ELSE
               PERFORM    VARYING    HKN-IDX    FROM   1   BY   1
                          UNTIL      HKN-IDX    >      50
                       MOVE   ZERO   TO   RECE02-TENSU(HKN-IDX 4)
               END-PERFORM
           END-IF
      *    インデックス５
           IF (RECE02-HENTOTALTEN(5)   NOT =  ZERO)           AND
              (RECE02-HENTOTALTEN(1)   NOT =  RECE02-HENTOTALTEN(5))
               CONTINUE
           ELSE
               PERFORM    VARYING    HKN-IDX    FROM   1   BY   1
                          UNTIL      HKN-IDX    >      50
                       MOVE   ZERO   TO   RECE02-TENSU(HKN-IDX 5)
               END-PERFORM
           END-IF
      *
           .
       2108-BUNTENSU-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    在宅総合・在宅末期一部負担金再掲の計算処理
      *****************************************************************
       2109-SAIKEI-KEISAN-SEC               SECTION.
      *
           IF   (FLG-ZENKOKUKOHI-NISYU    =  5                 )
           AND  (RECE02-KOHNUM(1)(1:1)    = "0"                )
           AND  (RECE02-KOHNUM(1)     NOT = "012" AND "025"    )
           AND  (RECE02-TOTALTEN(1)       =  RECE02-TOTALTEN(2))
           AND  (FLG-ZENKOKUKOHI-NISYU-SC =  1                 )
           AND  (RECE02-SRYYM            >= "201204"           )
             IF  FLG-ZENKI-TOKUREI = 1
               MOVE    20              TO   WRK-KYURATE3
             ELSE
               MOVE    RECE02-KYURATE  TO   WRK-KYURATE3
             END-IF
             COMPUTE   WRK-KEISAN10  =  RECE02-TOTALTEN(1)
                                     *  10
                                     *  WRK-KYURATE3
                                     /  100
             IF  FLG-TOKU75 = 1 OR 2 OR 3
               IF   5000   <  WRK-KEISAN10
                    MOVE     21      TO   FLG-TOKKI
                    PERFORM  21045-TOKKI-HENSYU-SEC
               END-IF
             ELSE
               IF   10000  <  WRK-KEISAN10
                    MOVE     21      TO   FLG-TOKKI
                    PERFORM  21045-TOKKI-HENSYU-SEC
               END-IF
             END-IF
           END-IF
      *
      *    請求点数から第三者行為の点数を差し引く
      *
           MOVE     RECE02-TOTALTEN(1)   TO   WRK-TAIHI-TOTALTEN
           IF   (RECE02-DAISAN-GAITO    =   1 OR 2)
           AND  (RECE02-DAISAN-GENBUTU-GAITO  =  1)
             CONTINUE
           ELSE
             COMPUTE  WRK-TAIHI-TOTALTEN = WRK-TAIHI-TOTALTEN
                                         - RECE02-DAISAN-TOTALTEN
           END-IF
      *
           IF   FLG-ZENKOKUKOHI-NISYU2  =  1
              MOVE     ZERO     TO    FLG-KEISAN-TOK1
                                      FLG-KEISAN-TOK2
           END-IF
      *
           IF   FLG-KEISAN-TOK1  =  1
           AND  FLG-KEISAN-TOK2  =  1
              IF     FTN-KOH-XXX    >  WRK-CHK-ICHIBUGAKU
                COMPUTE  WRK-KINGAKU-TOK9 = FTN-KOH-XXX
                                          - WRK-CHK-ICHIBUGAKU
              ELSE
                MOVE      ZERO     TO  WRK-KINGAKU-TOK9
              END-IF
      *
              COMPUTE  WRK-KINGAKU-TOK3 = WRK-CHK-ICHIBUGAKU
                                        + WRK-KINGAKU-TOK1
              IF  WRK-KINGAKU-TOK3  >  WRK-KINGAKU-TOK7
                 MOVE  WRK-KINGAKU-TOK7  TO  FTN-KOH-XXX
                 IF    WRK-KINGAKU-TOK7  >   WRK-CHK-ICHIBUGAKU
                   COMPUTE  WRK-KINGAKU-TOK4 = WRK-KINGAKU-TOK7
                                             - WRK-CHK-ICHIBUGAKU
                 ELSE
                   MOVE   ZERO     TO  WRK-KINGAKU-TOK4
                 END-IF
              ELSE
                 MOVE  WRK-KINGAKU-TOK3  TO  FTN-KOH-XXX
                 MOVE  WRK-KINGAKU-TOK1  TO  WRK-KINGAKU-TOK4
                 IF    FLG-ZENKI-TOKUREI  =   1
                    COMPUTE  WRK-KINGAKU-TOK1X =
                             WRK-KINGAKU-TOK1X +  5
                    COMPUTE  WRK-KINGAKU-TOK1X =
                             WRK-KINGAKU-TOK1X / 10
                    COMPUTE  WRK-KINGAKU-TOK1X =
                             WRK-KINGAKU-TOK1X * 10
                    MOVE  WRK-KINGAKU-TOK1X
                                         TO  WRK-KINGAKU-TOK4
                 END-IF
              END-IF
      *
              IF  FLG-CYOKI-HENSYU  =  1
                 ADD   WRK-SYUNOU-CYOKI-FTNMONEY
                                         TO  WRK-KOH-GAI
              ELSE
               IF  WRK-KINGAKU-TOK9  >  WRK-KINGAKU-TOK4
                 COMPUTE    WRK-KINGAKU-TOK5 = WRK-KINGAKU-TOK9
                                             - WRK-KINGAKU-TOK4
                 ADD   WRK-KINGAKU-TOK5  TO  WRK-KOH-GAI
               END-IF
              END-IF
           END-IF
      *
           IF   FLG-KEISAN-TOK1            =  ZERO
           AND  FLG-KEISAN-TOK2            =  1
           AND  FTN-KOH-XX8                =  ZERO
           AND  FLG-ZENKOKUKOHI-NISYU  NOT =  4
            IF    FLG-XX8-TUUKA  =  ZERO
              COMPUTE  WRK-KINGAKU-TOK3 = WRK-CHK-ICHIBUGAKU
                                        + FTN-KOH-XX7
              IF  WRK-KINGAKU-TOK3  >  WRK-KINGAKU-TOK8
                 MOVE  WRK-KINGAKU-TOK8  TO  FTN-KOH-XXX
              ELSE
                 MOVE  WRK-KINGAKU-TOK3  TO  FTN-KOH-XXX
              END-IF
            ELSE
              MOVE   FTN-KOH-XX8   TO   FTN-KOH-XXX
              MOVE    5     TO   FLG-JYOGENKBN2
              MOVE   WRK-KINGAKU-GENBUTU4-XXX
                            TO   WRK-KINGAKU-GENBUTU4
              MOVE   WRK-KOH-GAI-GEN70-TEN8
                            TO   WRK-KOH-GAI-GEN70-TEN1
              MOVE   WRK-KOH-GAI-GEN70-TEN9
                            TO   WRK-KOH-GAI-GEN70-TEN3
            END-IF
           END-IF
      *
           IF   FLG-KEISAN-TOK1            =  ZERO
           AND  FLG-KEISAN-TOK2            =  1
           AND  FTN-KOH-XX8                =  ZERO
           AND  FLG-ZENKOKUKOHI-NISYU      =  4
              MOVE   FTN-KOH-XX4   TO   FTN-KOH-XXX
           END-IF
           IF   FLG-KEISAN-TOK1     =  ZERO
           AND  FLG-KEISAN-TOK2     =  1
           AND  FTN-KOH-XX8     NOT =  ZERO
              MOVE   FTN-KOH-XX8   TO   FTN-KOH-XXX
              MOVE    5     TO   FLG-JYOGENKBN2
              MOVE   WRK-KINGAKU-GENBUTU4-XXX
                            TO   WRK-KINGAKU-GENBUTU4
              MOVE   WRK-KOH-GAI-GEN70-TEN8
                            TO   WRK-KOH-GAI-GEN70-TEN1
              MOVE   WRK-KOH-GAI-GEN70-TEN9
                            TO   WRK-KOH-GAI-GEN70-TEN3
           END-IF
      *
           IF  ((FTN-KOH-XX5   NOT =   ZERO) AND
                (FTN-KOH-XX6       =   ZERO) AND
                (FTN-KOH-XX8       =   ZERO) AND
                (FTN-KOH-XX3   NOT =   ZERO))
           OR  ((FTN-KOH-XX5       =   ZERO) AND
                (FTN-KOH-XX6       =   ZERO) AND
                (FTN-KOH-XX8       =   ZERO) AND
                (FTN-KOH-XX3   NOT =   ZERO) AND
                (FLG-XX5-TUUKA NOT =   ZERO))
           OR  ((FTN-KOH-XX5   NOT =   ZERO) AND
                (FTN-KOH-XX6       =   ZERO) AND
                (FTN-KOH-XX8       =   ZERO) AND
                (FTN-KOH-XX3       =   ZERO) AND
                (FLG-XX3-TUUKA NOT =   ZERO))
             MOVE    5      TO   FLG-JYOGENKBN2
             MOVE    WRK-KINGAKU-GENBUTU2-XXX
                            TO   WRK-KINGAKU-GENBUTU2
             MOVE    WRK-KOH-GAI-GEN70-TEN5
                            TO   WRK-KOH-GAI-GEN70-TEN1
           END-IF
      *
           IF  ((FTN-KOH-XX5       =   ZERO) AND
                (FTN-KOH-XX6   NOT =   ZERO) AND
                (FTN-KOH-XX8   NOT =   ZERO) AND
                (FTN-KOH-XX3       =   ZERO))
           OR  ((FTN-KOH-XX5       =   ZERO) AND
                (FTN-KOH-XX6   NOT =   ZERO) AND
                (FTN-KOH-XX8       =   ZERO) AND
                (FTN-KOH-XX3       =   ZERO) AND
                (FLG-XX8-TUUKA NOT =   ZERO))
           OR  ((FTN-KOH-XX5       =   ZERO) AND
                (FTN-KOH-XX6       =   ZERO) AND
                (FTN-KOH-XX8   NOT =   ZERO) AND
                (FTN-KOH-XX3       =   ZERO) AND
                (FLG-XX6-TUUKA NOT =   ZERO))
             MOVE    FTN-KOH-XX8   TO   FTN-KOH-XXX
             MOVE    5      TO   FLG-JYOGENKBN2
             MOVE    WRK-KINGAKU-GENBUTU4-XXX
                            TO   WRK-KINGAKU-GENBUTU4
             MOVE    WRK-KOH-GAI-GEN70-TEN8
                            TO   WRK-KOH-GAI-GEN70-TEN1
             MOVE    WRK-KOH-GAI-GEN70-TEN6
                            TO   WRK-KOH-GAI-GEN70-TEN3
           END-IF
      *
           IF     (RECE02-SRYYM       >=  "201204")
           AND    (RECE02-ZAITAKU      =  "1"     )
           AND    (FLG-ZENKI-TOKUREI   =   1      )
             MOVE    20              TO   WRK-KYURATE
           ELSE
             MOVE    RECE02-KYURATE  TO   WRK-KYURATE
           END-IF
           COMPUTE  WRK-KOH-GAI-GEN70-KIN  = WRK-KOH-GAI-GEN70-TEN
                                           * 10
                                           * WRK-KYURATE
                                           / 100
           COMPUTE  WRK-KOH-GAI-GEN70-KIN1 = WRK-KOH-GAI-GEN70-TEN1
                                           * 10
                                           * WRK-KYURATE
                                           / 100
           COMPUTE  WRK-KOH-GAI-GEN70-KIN2 = WRK-KOH-GAI-GEN70-TEN2
                                           * 10
                                           * WRK-KYURATE
                                           / 100
           COMPUTE  WRK-KOH-GAI-GEN70-KIN3 = WRK-KOH-GAI-GEN70-TEN3
                                           * 10
                                           * WRK-KYURATE
                                           / 100
           COMPUTE  WRK-KOH-GAI-GEN70-KIN4 = WRK-KOH-GAI-GEN70-TEN4
                                           * 10
                                           * WRK-KYURATE
                                           / 100
      *
           COMPUTE  WRK-KOH-GAI-GEN70-KIN5 = WRK-KOH-GAI-GEN70-KIN1
                                           + WRK-CHK-ICHIBUGAKU2
      *
           MOVE    ZERO   TO   WRK-KEISAN-YYY
      *
           IF      RECE02-ZAITAKU  =  "2"
      *
               IF    ( FLG-JYOGENKBN2    =   5 )
               AND   ( FLG-KOHYONKAIME   =   1 )
                  PERFORM   21091-KOHIHEIYO-KEISAN-SEC
               END-IF
      *
               IF      FLG-JYOGENKBN   =   1
                MOVE     WRK-JYOGENKBN-TEN  TO  WRK-HANTEI-TOTALTEN
      ***       IF   FLG-ZEROKOGAITO   =   1
      ***         PERFORM  21094X-JYOGENGAKU-HENSYU2-SEC
      ***       ELSE
                  PERFORM  21094-JYOGENGAKU-HENSYU-SEC
      ***       END-IF
               END-IF
      *
               MOVE    9999999    TO   WRK-CHK-KINGAKU
               MOVE    9999999    TO   WRK-CHK-KINGAKU2
               MOVE    9999999    TO   WRK-CHK-KINGAKU3
               EVALUATE  FLG-JYOGENKBN  ALSO  FLG-JYOGENKBN2
                 WHEN       1           ALSO     ZERO
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                 WHEN       ANY         ALSO     1
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
      ****         IF  FLG-KOHYONKAIME = 1
      ****          IF  FLG-TOKU75 = 3
      ****           MOVE  12300                TO  WRK-CHK-KINGAKU2
      ****          ELSE
      ****           MOVE  24600                TO  WRK-CHK-KINGAKU2
      ****          END-IF
      ****         ELSE
                    IF  FLG-TOKU75 = 3
                     MOVE  17700                TO  WRK-CHK-KINGAKU2
                    ELSE
                     MOVE  35400                TO  WRK-CHK-KINGAKU2
                    END-IF
      ****         END-IF
                 WHEN       ZERO        ALSO     2
                   IF  FLG-TOKU75 = 3
                     MOVE    5000               TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       1           ALSO     2
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 3
                     MOVE    5000               TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       2           ALSO     2
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 3
                     MOVE    5000               TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       ZERO        ALSO     3
                   IF  FLG-TOKU75 = 3
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    20000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       1           ALSO     3
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 3
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    20000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       2           ALSO     3
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 3
                     MOVE    10000              TO  WRK-CHK-KINGAKU2
                   ELSE
                     MOVE    20000              TO  WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       ZERO        ALSO     4
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU5 TO  WRK-CHK-KINGAKU3
                 WHEN       1           ALSO     4
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU5 TO  WRK-CHK-KINGAKU3
                 WHEN       ZERO        ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
                 WHEN       1           ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
                 WHEN       2           ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
               END-EVALUATE
               IF   ( FTN-KOH-XX3     NOT =  ZERO )
               OR   ( FTN-KOH-XX6     NOT =  ZERO )
               OR   ((FLG-KEISAN-TOK1     =  ZERO) AND
                     (FLG-KEISAN-TOK2     =  1   ) AND
                     (FTN-KOH-XX8     NOT =  ZERO))
               OR   ((FLG-KEISAN-TOK1     =  ZERO) AND
                     (FLG-KEISAN-TOK2     =  1   ) AND
                     (FTN-KOH-XX8         =  ZERO) AND
                     (FLG-ZENKOKUKOHI-NISYU
                                      NOT =  4   ) AND
                     (FLG-XX8-TUUKA   NOT =  ZERO))
                   CONTINUE
               ELSE
                   MOVE    9999999              TO  WRK-CHK-KINGAKU3
               END-IF
      *
               IF  (WRK-CHK-KINGAKU    NOT = 9999999)
               AND (WRK-CHK-KINGAKU2       = 9999999)
                 MOVE   WRK-CHK-KINGAKU   TO   WRK-CHK-KEIKASOCHI1
                 IF  ( FLG-JYOGENKBN             =  1       )
                 AND ( FLG-GENBUTU-TAISYOOK      =  ZERO    )
                     MOVE   9999999  TO   WRK-CHK-KEIKASOCHI1
                 END-IF
                 IF  (WRK-KOH-GAI-GEN70-KIN >  WRK-CHK-KEIKASOCHI1)
                    CONTINUE
                 ELSE
                    MOVE    "3"      TO   RECE02-ZAITAKU
                 END-IF
               END-IF
               IF  (WRK-CHK-KINGAKU        = 9999999)
               AND (WRK-CHK-KINGAKU2   NOT = 9999999)
                IF   FLG-KEISAN-TOK1  =  1
                AND  FLG-KEISAN-TOK2  =  1
                 IF  (WRK-KOH-GAI-GEN70-KIN1 >  WRK-CHK-KINGAKU2)
                    CONTINUE
                 ELSE
                    MOVE    "3"      TO   RECE02-ZAITAKU
                 END-IF
                ELSE
                 IF  (WRK-KOH-GAI-GEN70-KIN1 >  WRK-CHK-KINGAKU2)
                 OR  (WRK-KOH-GAI-GEN70-KIN3 >  WRK-CHK-KINGAKU3)
                 OR  (WRK-KOH-GAI-GEN70-KIN5 >  WRK-CHK-KINGAKU2)
                    CONTINUE
                 ELSE
                    MOVE    "3"      TO   RECE02-ZAITAKU
                 END-IF
                END-IF
               END-IF
               IF  (WRK-CHK-KINGAKU    NOT = 9999999)
               AND (WRK-CHK-KINGAKU2   NOT = 9999999)
                IF   FLG-JYOGENKBN  =  1
                  MOVE  WRK-CHK-KINGAKU  TO  WRK-CHK-KEIKASOCHI1
                  IF  ( FLG-GENBUTU-TAISYOOK      =  ZERO    )
                    MOVE   9999999       TO  WRK-CHK-KEIKASOCHI1
                  END-IF
                  IF  (WRK-KOH-GAI-GEN70-KIN >  WRK-CHK-KEIKASOCHI1)
                    MOVE   ZERO          TO  WRK-CHK-KEIKASOCHI1
                  ELSE
                    IF  WK-GENGAKUKBN  NOT =  ZERO
                      MOVE WRK-KINGAKU3  TO  WRK-CHK-KEIKASOCHI1
                    END-IF
                  END-IF
                  COMPUTE  WRK-CHK-KEIKASOCHIXX  =  WRK-KOH-GAI-GEN70
                                                 +  WRK-KOH-FTN-GEN70
                  IF   (FLG-JYOGENKBN2 = 5 )
                  AND  (FLG-JYOGENKBN3 = 1 )
                    MOVE   WRK-KINGAKU-GENBUTU
                                         TO  WRK-CHK-KINGAKU
                  END-IF
                ELSE
                  MOVE     9999999       TO  WRK-CHK-KEIKASOCHI1
                END-IF
                IF   WRK-JYOGENKBN-TEN5  NOT = ZERO
                  COMPUTE WRK-JYOGENKBN-TEN9 =
                          WRK-JYOGENKBN-TEN4 +
                          WRK-JYOGENKBN-TEN5
                  COMPUTE WRK-FTNKEI6 = WRK-JYOGENKBN-TEN9
                                      * 10
                                      * RECE02-KYURATE
                                      / 100
                  IF  ((WRK-FTNKEI6     >=   21000  ) AND
                       (RECE02-SRYYM    >=  "201204"))
                  OR  ( RECE02-SRYYM    <=  "201203" )
                    COMPUTE WRK-HANTEI-TOTALTEN =
                            WRK-JYOGENKBN-TEN4  +
                            WRK-JYOGENKBN-TEN5  +
                            WRK-JYOGENKBN-TEN2
                    PERFORM  21094-JYOGENGAKU-HENSYU-SEC
                    IF  WRK-JYOGENKBN-TEN2  NOT = ZERO
                        IF  (((RECE02-KOHNUM(1)(1:1) = "0"   ) AND
                              (RECE02-KOHNUM(1)
                                       NOT = "012" AND "025" ))  OR
                             ( TBL-TOKATUKAIFLG(1)   =  1     ))
                        AND (  RECE02-KOHNUM(2)       = SPACE  )
                        AND (  RECE02-KOHNUM(3)       = SPACE  )
                        AND (  RECE02-KOHNUM(4)       = SPACE  )
                        AND (  RECE02-HKNCOMBI(2) NOT = ZERO   )
                        AND (  WRK-TAIHI-TOTALTEN
                                       NOT = RECE02-TOTALTEN(2))
                        AND (  RECE02-TOTALTEN(2) NOT = ZERO   )
                          IF WRK-KINGAKU-GENBUTU3 > RECE02-FTNMONEY(2)
                            COMPUTE  WRK-CHK-KOKIGAK9      =
                                     WRK-KINGAKU-GENBUTU3  -
                                     RECE02-FTNMONEY(2)
                          ELSE
                            MOVE   ZERO   TO   WRK-CHK-KOKIGAK9
                          END-IF
                          IF   WRK-CHK-KOKIGAK9  <  WRK-FTNKEI6
                            MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                          END-IF
                        END-IF
                    ELSE
                        IF  WRK-KINGAKU-GENBUTU3 <  WRK-FTNKEI6
                            MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                        END-IF
                    END-IF
                  END-IF
                END-IF
      *
                COMPUTE  WRK-CHK-KOKIGAK4 = RECE02-TOTALTEN(2)
                                          + RECE02-HENTOTALTEN(3)
                IF  (((RECE02-KOHNUM(1)(1:1)  = "0"             ) AND
                      (RECE02-KOHNUM(1)   NOT = "012" AND "025" )) OR
                     ( TBL-TOKATUKAIFLG(1)    =  1               ))
                AND (  RECE02-KOHNUM(2)(1:1) >= "1" AND <= "8"    )
                AND (  TBL-TOKATUKAIFLG(2)    =  ZERO             )
                AND (  RECE02-KOHNUM(3)       =  SPACE            )
                AND (  RECE02-KOHNUM(4)       =  SPACE            )
                AND (  RECE02-HKNCOMBI(2) NOT = ZERO              )
                AND (  WRK-TAIHI-TOTALTEN NOT = RECE02-TOTALTEN(2))
                AND (  RECE02-TOTALTEN(2) NOT = ZERO              )
                AND (( WRK-TAIHI-TOTALTEN = WRK-CHK-KOKIGAK4     ) OR
                     ( WRK-TAIHI-TOTALTEN = RECE02-HENTOTALTEN(3)))
                AND (  WRK-JYOGENKBN-TEN2 NOT = ZERO              )
                AND (  FLG-ZENKOKUKOHI-NISYU4 =  1                )
                  COMPUTE WRK-JYOGENKBN-TEN9 =
                          WRK-TAIHI-TOTALTEN -
                          RECE02-TOTALTEN(2)
                  COMPUTE WRK-FTNKEI6 = WRK-JYOGENKBN-TEN9
                                      * 10
                                      * RECE02-KYURATE
                                      / 100
                  IF  ((WRK-FTNKEI6     >=   21000  ) AND
                       (RECE02-SRYYM    >=  "201204"))
                  OR  ( RECE02-SRYYM    <=  "201203" )
                    MOVE  WRK-TAIHI-TOTALTEN TO  WRK-HANTEI-TOTALTEN
                    PERFORM  21094-JYOGENGAKU-HENSYU-SEC
                    IF WRK-KINGAKU-GENBUTU3 > RECE02-FTNMONEY(2)
                      COMPUTE  WRK-CHK-KOKIGAK9      =
                               WRK-KINGAKU-GENBUTU3  -
                               RECE02-FTNMONEY(2)
                    ELSE
                      MOVE   ZERO   TO   WRK-CHK-KOKIGAK9
                    END-IF
                    IF   WRK-CHK-KOKIGAK9  <  WRK-FTNKEI6
                      MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                    END-IF
                  END-IF
                END-IF
      *
                IF   FLG-KEISAN-TOK1  =  1
                AND  FLG-KEISAN-TOK2  =  1
                 IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                 OR  (WRK-KOH-GAI-GEN70-KIN1 >  WRK-CHK-KINGAKU2   )
                    CONTINUE
                 ELSE
                    MOVE    "3"      TO   RECE02-ZAITAKU
                 END-IF
                ELSE
                 IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                 OR  (WRK-KOH-GAI-GEN70-KIN1 >  WRK-CHK-KINGAKU2   )
                 OR  (WRK-KOH-GAI-GEN70-KIN3 >  WRK-CHK-KINGAKU3   )
                 OR  (WRK-KOH-GAI-GEN70-KIN2 >  WRK-CHK-KINGAKU    )
                 OR  (WRK-KOH-GAI-GEN70-KIN4 >  WRK-CHK-KINGAKU    )
                    CONTINUE
                 ELSE
                    MOVE    "3"      TO   RECE02-ZAITAKU
                 END-IF
                END-IF
               END-IF
               IF  (WRK-CHK-KINGAKU        = 9999999)
               AND (WRK-CHK-KINGAKU2       = 9999999)
                    MOVE    "3"      TO   RECE02-ZAITAKU
               END-IF
      *
      ***      IF  (FLG-ZENKOKUKOHI-NISYU4  =   1      )
      ***      AND (RECE02-ZAITAKU          =  "3"     )
      ***      AND (WRK-CHK-KINGAKU     NOT =   9999999)
      ***      AND (WRK-CHK-KINGAKU2    NOT =   9999999)
      ***        COMPUTE  WRK-CHK-KOKIGAK4 = RECE02-TOTALTEN(2)
      ***                                  + RECE02-HENTOTALTEN(3)
      ***        IF  (((RECE02-KOHNUM(1)(1:1) = "0"            ) AND
      ***              (RECE02-KOHNUM(1)  NOT = "012" AND "025"))  OR
      ***             ( TBL-TOKATUKAIFLG(1)   =  1              ) )
      ***        AND (RECE02-KOHNUM(2)(1:1)  >= "1" AND <= "8"    )
      ***        AND (TBL-TOKATUKAIFLG(2)     = ZERO              )
      ***        AND (RECE02-KOHNUM(3)        = SPACE             )
      ***        AND (RECE02-KOHNUM(4)        = SPACE             )
      ***        AND (RECE02-HKNCOMBI(2)  NOT = ZERO              )
      ***        AND (WRK-TAIHI-TOTALTEN  NOT = RECE02-TOTALTEN(2))
      ***        AND (RECE02-TOTALTEN(2)  NOT = ZERO              )
      ***        AND ((WRK-TAIHI-TOTALTEN   =  WRK-CHK-KOKIGAK4 ) OR
      ***             (WRK-TAIHI-TOTALTEN   =
      ***                                  RECE02-HENTOTALTEN(3)) )
      *
      ***            IF   WRK-CHK-KINGAKU  >  RECE02-FTNMONEY(2)
      ***              COMPUTE  WRK-CHK-KOKIGAK = WRK-CHK-KINGAKU
      ***                                       - RECE02-FTNMONEY(2)
      ***            ELSE
      ***              MOVE     ZERO     TO   WRK-CHK-KOKIGAK
      ***            END-IF
      ***            IF  (WRK-KOH-GAI-GEN70-KIN2 >  WRK-CHK-KOKIGAK)
      ***            OR  (WRK-KOH-GAI-GEN70-KIN4 >  WRK-CHK-KOKIGAK)
      ***               MOVE    "2"      TO   RECE02-ZAITAKU
      ***            END-IF
      *
      ***        END-IF
      ***      END-IF
      *
               IF  (WRK-KEISAN-YYY    NOT =  ZERO)
               AND (RECE02-ZAITAKU        =  "3" )
                    MOVE    "2"      TO   RECE02-ZAITAKU
               END-IF
      *
               IF  (FLG-GENBUTU-HANTEI    =   1  )
               AND (FLG-GENBUTU-HANTEI2   =   1  )
               AND (RECE02-ZAITAKU        =  "3" )
                    MOVE    "2"      TO   RECE02-ZAITAKU
               END-IF
      *
               IF  (FLG-GENBUTU-HANTEI    =   1  )
               AND (FLG-SYSCHK            =   1  )
               AND (RECE02-ZAITAKU        =  "3" )
                    MOVE    "2"      TO   RECE02-ZAITAKU
               END-IF
      *
               IF  (FLG-GENBUTU-HANTEI    =   1  )
               AND (FLG-NYUSYO            =   1  )
               AND (RECE02-ZAITAKU        =  "3" )
                    MOVE    "2"      TO   RECE02-ZAITAKU
               END-IF
      *
               IF  (FLG-GENBUTU-HANTEI    =   1  )
               AND (RECE02-RECEIPT-KBN(4:1)
                                          =  "2" )
               AND (RECE02-ZAITAKU        =  "3" )
                    MOVE    "2"      TO   RECE02-ZAITAKU
               END-IF
      *
               IF   (SYS-1001-PREFNUM  =  19     )
               AND  (RECE02-SRYYM     <= "201203")
                IF ( RECE02-KOHHBTNUM(1) =  "41"        )
                OR ((RECE02-KOHNUM(1)  = "051" OR "091") AND
                    (RECE02-KOHHBTNUM(2) =  "41"       ) AND
                    (RECE02-SRYYM       >=  "200804"   ))
                    MOVE    "3"      TO   RECE02-ZAITAKU
                END-IF
               END-IF
      *
               IF  (RECE02-EKF-KSINGKBN-Y(2) = "1")
               OR  (RECE02-EKF-KSINGKBN-Y(3) = "1")
               OR  (RECE02-EKF-KSINGKBN-Y(4) = "1")
               OR  (RECE02-EKF-KSINGKBN-Y(5) = "1")
                    MOVE    "3"      TO   RECE02-ZAITAKU
               END-IF
      *
               IF   WK-GENGAKUKBN    =   3 OR 4
                    MOVE    "3"      TO   RECE02-ZAITAKU
               END-IF
      *
               EVALUATE  WRK-TAIHI-OKIKAE
                 WHEN        1
                     IF  RECE02-ZAITAKU  = "2"
                       CONTINUE
                     ELSE
                       MOVE   "2"      TO   RECE02-ZAITAKU
                       MOVE    2       TO   RECE02-ICBKINKSI-ARI
                     END-IF
                 WHEN        2
                     IF  RECE02-ZAITAKU  = "3"
                       CONTINUE
                     ELSE
                       MOVE   "3"      TO   RECE02-ZAITAKU
                       MOVE    2       TO   RECE02-ICBKINKSI-NASI
                     END-IF
               END-EVALUATE
      *
               IF      RECE02-ZAITAKU  =  "3"
                 MOVE     ZERO    TO    RECE02-FTNMONEY(1)
                 PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                           UNTIL   KOHFTN-IDX   >    4
                  IF     TBL-HKNFTNDATA-FLG(KOHFTN-IDX)  NOT =  1
                   IF  ( RECE02-KOHNUM(KOHFTN-IDX) =
                              "015" OR "016" OR "051" OR "021" OR
                              "024" OR "079" OR "052" OR "012" OR
                              "025" OR "038"                       )
                   OR  ((RECE02-KOHNUM(KOHFTN-IDX) =  "054"       ) AND
                        (RECE02-SRYYM             >=  "201501"    ))
                   OR  ( WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)  =  1 )
                   OR  ( RECE02-EKF-ENCHGKBN-Y(KOHFTN-IDX + 1)
                                                    = "2" OR "3"   )
                   OR  ( TBL-TOKATUKAIFLG(KOHFTN-IDX)   =  1       )
                      MOVE  WRK-TAIHI-FTNMONEY    (KOHFTN-IDX + 1)
                                TO  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                      MOVE  WRK-TAIHI-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                                TO  RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                   END-IF
                   IF    RECE02-KOHNUM(KOHFTN-IDX) = "010"
                      MOVE  ZERO    TO  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                   END-IF
                  END-IF
                 END-PERFORM
               END-IF
      *
           END-IF
      *
      *    高齢者の現物給付チェック
           IF     (RECE02-SRYYM   <=  "201203")
           AND    (RECE02-ZAITAKU  =  "1"     )
      *
               IF  (RECE02-EKF-KSINGKBN-K(2) = "1")
               OR  (RECE02-EKF-KSINGKBN-K(3) = "1")
               OR  (RECE02-EKF-KSINGKBN-K(4) = "1")
               OR  (RECE02-EKF-KSINGKBN-K(5) = "1")
                    MOVE    "4"      TO   RECE02-ZAITAKU
               END-IF
      *
               IF   WK-GENGAKUKBN    =   3 OR 4
                    MOVE    "4"      TO   RECE02-ZAITAKU
               END-IF
               IF   WK-GENGAKUKBN    =   1 OR 2 OR 5
                    MOVE    "1"      TO   RECE02-ZAITAKU
               END-IF
      *
               EVALUATE  WRK-TAIHI-OKIKAE
                 WHEN        1
                     IF  RECE02-ZAITAKU  = "1"
                       CONTINUE
                     ELSE
                       MOVE   "1"      TO   RECE02-ZAITAKU
                       MOVE    2       TO   RECE02-ICBKINKSI-ARI
                     END-IF
                 WHEN        2
                     IF  RECE02-ZAITAKU  = "4"
                       CONTINUE
                     ELSE
                       MOVE   "4"      TO   RECE02-ZAITAKU
                       MOVE    2       TO   RECE02-ICBKINKSI-NASI
                     END-IF
               END-EVALUATE
      *
               IF      RECE02-ZAITAKU  =  "4"
                 MOVE     ZERO    TO    RECE02-FTNMONEY(1)
                 PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                           UNTIL   KOHFTN-IDX   >    4
                   IF   TBL-HKNFTNDATA-FLG(KOHFTN-IDX)  NOT =  1
                     IF ( RECE02-KOHNUM(KOHFTN-IDX) =
                               "015" OR "016" OR "051" OR "021" OR
                               "024" OR "079" OR "052" OR "012" OR
                               "025" OR "038"                       )
                     OR ((RECE02-KOHNUM(KOHFTN-IDX) =  "054"       ) AND
                         (RECE02-SRYYM             >=  "201501"    ))
                     OR ( WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)  =  1 )
                     OR ( RECE02-EKF-ENCHGKBN-K(KOHFTN-IDX + 1)
                                                     = "2" OR "3"   )
                     OR ( TBL-TOKATUKAIFLG(KOHFTN-IDX)   =  1       )
                       MOVE  WRK-TAIHI-FTNMONEY    (KOHFTN-IDX + 1)
                                 TO  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                       MOVE  WRK-TAIHI-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                                 TO  RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                     END-IF
                     IF    RECE02-KOHNUM(KOHFTN-IDX) = "010"
                       MOVE  ZERO    TO  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                     END-IF
                   END-IF
                 END-PERFORM
               END-IF
      *
           END-IF
      *
           IF     (RECE02-SRYYM   >=  "201204")
           AND    (RECE02-ZAITAKU  =  "1"     )
      *
               IF      FLG-JYOGENKBN   =   1
                MOVE     WRK-JYOGENKBN-TEN  TO  WRK-HANTEI-TOTALTEN
      ***       IF   FLG-ZEROKOGAITO   =   1
      ***         PERFORM  21094X-JYOGENGAKU-HENSYU2-SEC
      ***       ELSE
                  PERFORM  21094-JYOGENGAKU-HENSYU-SEC
      ***       END-IF
      *
                IF   WK-GENGAKUKBN    NOT =   ZERO
                  EVALUATE   WK-GENGAKUKBN
                    WHEN        1
                     IF  WK-GENGAKUKBN-KEISAN  =  2
                       IF  RECE02-KYURATE  <= WK-GENGAKU-RITU
                           MOVE   ZERO     TO   WRK-KOH-GAI-GEN70-Z
                       ELSE
                           COMPUTE  WRK-FTNKEI-XXX =
                                    WRK-KOH-GAI-GEN70-TEN
                                                   * 10
                                                   * WK-GENGAKU-RITU
                                                   / 100
                           IF  WRK-KOH-GAI-GEN70-Z > WRK-FTNKEI-XXX
                             COMPUTE  WRK-KOH-GAI-GEN70-Z   =
                                      WRK-KOH-GAI-GEN70-Z   -
                                      WRK-FTNKEI-XXX
                           ELSE
                             MOVE ZERO     TO   WRK-KOH-GAI-GEN70-Z
                           END-IF
                       END-IF
                     ELSE
                       IF  WK-GENGAKU-RITU = 100
                           MOVE   ZERO     TO   WRK-KOH-GAI-GEN70-Z
                       ELSE
                           COMPUTE  WK-GENGAKU-RITUX =
                                    100 - WK-GENGAKU-RITU
                           IF    WRK-KOH-GAI-GEN70-Z  NOT = ZERO
                             COMPUTE  WRK-KOH-GAI-GEN70-Z   =
                                      WRK-KOH-GAI-GEN70-Z   *
                                      WK-GENGAKU-RITUX      /
                                      100
                           END-IF
                       END-IF
                     END-IF
                    WHEN        2
                     IF  WRK-KOH-GAI-GEN70-Z < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WRK-KOH-GAI-GEN70-Z
                     ELSE
                       COMPUTE  WRK-KOH-GAI-GEN70-Z    =
                                WRK-KOH-GAI-GEN70-Z    -
                                WK-GENGAKU-KIN
                     END-IF
                    WHEN        3
                    WHEN        4
                         MOVE   ZERO     TO   WRK-KOH-GAI-GEN70-Z
                    WHEN        5
                     IF  WRK-KOH-GAI-GEN70-Z > WK-GENGAKU-KIN
                       COMPUTE  WRK-KOH-GAI-GEN70-Z    =
                                WK-GENGAKU-KIN
                     END-IF
                  END-EVALUATE
                END-IF
               END-IF
      *
               MOVE    9999999    TO   WRK-CHK-KINGAKU
               MOVE    9999999    TO   WRK-CHK-KINGAKU2
               MOVE    9999999    TO   WRK-CHK-KINGAKU3
               EVALUATE  FLG-JYOGENKBN  ALSO  FLG-JYOGENKBN2
                 WHEN       1           ALSO     ZERO
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                 WHEN       ANY         ALSO     1
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 1 OR 2
                      MOVE      4000      TO   WRK-CHK-KINGAKU2
                   ELSE
                      MOVE      8000      TO   WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       ZERO        ALSO     2
                   IF  FLG-TOKU75 = 1 OR 2
                      MOVE      4000      TO   WRK-CHK-KINGAKU2
                   ELSE
                      MOVE      8000      TO   WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       1           ALSO     2
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 1 OR 2
                      MOVE      4000      TO   WRK-CHK-KINGAKU2
                   ELSE
                      MOVE      8000      TO   WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       2           ALSO     2
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 1 OR 2
                      MOVE      4000      TO   WRK-CHK-KINGAKU2
                   ELSE
                      MOVE      8000      TO   WRK-CHK-KINGAKU2
                   END-IF
                 WHEN       ZERO        ALSO     3
                   IF  FLG-TOKU75 = 1 OR 2
                     IF   FLG-CYOKI2 = 1
                       MOVE     4000      TO   WRK-CHK-KINGAKU2
                     ELSE
                       MOVE     5000      TO   WRK-CHK-KINGAKU2
                     END-IF
                   ELSE
                     IF   FLG-CYOKI2 = 1
                       MOVE     8000      TO   WRK-CHK-KINGAKU2
                     ELSE
                       MOVE     10000     TO   WRK-CHK-KINGAKU2
                     END-IF
                   END-IF
                 WHEN       1           ALSO     3
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 1 OR 2
                     IF   FLG-CYOKI2 = 1
                       MOVE     4000      TO   WRK-CHK-KINGAKU2
                     ELSE
                       MOVE     5000      TO   WRK-CHK-KINGAKU2
                     END-IF
                   ELSE
                     IF   FLG-CYOKI2 = 1
                       MOVE     8000      TO   WRK-CHK-KINGAKU2
                     ELSE
                       MOVE     10000     TO   WRK-CHK-KINGAKU2
                     END-IF
                   END-IF
                 WHEN       2           ALSO     3
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU
                   IF  FLG-TOKU75 = 1 OR 2
                     IF   FLG-CYOKI2 = 1
                       MOVE     4000      TO   WRK-CHK-KINGAKU2
                     ELSE
                       MOVE     5000      TO   WRK-CHK-KINGAKU2
                     END-IF
                   ELSE
                     IF   FLG-CYOKI2 = 1
                       MOVE     8000      TO   WRK-CHK-KINGAKU2
                     ELSE
                       MOVE     10000     TO   WRK-CHK-KINGAKU2
                     END-IF
                   END-IF
                 WHEN       ZERO        ALSO     4
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU5 TO  WRK-CHK-KINGAKU3
                 WHEN       1           ALSO     4
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU5 TO  WRK-CHK-KINGAKU3
                 WHEN       ZERO        ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
                 WHEN       1           ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU3 TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
                 WHEN       2           ALSO     5
                   MOVE    WRK-KINGAKU-GENBUTU  TO  WRK-CHK-KINGAKU
                   MOVE    WRK-KINGAKU-GENBUTU2 TO  WRK-CHK-KINGAKU2
                   MOVE    WRK-KINGAKU-GENBUTU4 TO  WRK-CHK-KINGAKU3
               END-EVALUATE
               IF   ( FTN-KOH-XX3     NOT =  ZERO )
               OR   ( FTN-KOH-XX6     NOT =  ZERO )
               OR   ((FLG-KEISAN-TOK1     =  ZERO) AND
                     (FLG-KEISAN-TOK2     =  1   ) AND
                     (FTN-KOH-XX8     NOT =  ZERO))
               OR   ((FLG-KEISAN-TOK1     =  ZERO) AND
                     (FLG-KEISAN-TOK2     =  1   ) AND
                     (FTN-KOH-XX8         =  ZERO) AND
                     (FLG-ZENKOKUKOHI-NISYU
                                      NOT =  4   ) AND
                     (FLG-XX8-TUUKA   NOT =  ZERO))
                   CONTINUE
               ELSE
                   MOVE    9999999              TO  WRK-CHK-KINGAKU3
               END-IF
      *
               IF   FLG-ZENKI-TOKUREI   =   1
                 COMPUTE  WRK-KOH-GAI-GEN70-Z =
                          WRK-KOH-GAI-GEN70-Z +  5
                 COMPUTE  WRK-KOH-GAI-GEN70-Z =
                          WRK-KOH-GAI-GEN70-Z / 10
                 COMPUTE  WRK-KOH-GAI-GEN70-Z =
                          WRK-KOH-GAI-GEN70-Z * 10
                 MOVE   WRK-KOH-FTN-GEN70
                                    TO    WRK-KOH-FTN-GEN70-Z
      ***        IF   RECE02-KOHNUM(1)    NOT =  SPACE
      ***        AND  RECE02-KOHNUM(2)        =  SPACE
      ***        AND  RECE02-KOHNUM(3)        =  SPACE
      ***        AND  RECE02-KOHNUM(4)        =  SPACE
      ***        AND  FLG-HOKENICHIBU-SYU     =   1
      ***        AND  WRK-JYOGENKBN-TEN2  NOT =  ZERO
      ***        AND  WRK-JYOGENKBN-TEN5      =  ZERO
      ***          MOVE       1     TO    KOHFTN-IDX
      ***          IF  ( RECE02-KOHNUM(KOHFTN-IDX)   = "051" )
      ***          OR  ( RECE02-KOHNUM(KOHFTN-IDX)   = "038" )
      ***          OR  ((SYS-1001-PREFNUM            =  13  ) AND
      ***               (RECE02-KOHNUM(KOHFTN-IDX)   = "151"))
      ***          OR  ((SYS-1001-PREFNUM            =  23  ) AND
      ***               (RECE02-KOHNUM(KOHFTN-IDX)   = "191") AND
      ***               (RECE02-TEISYUTUSAKI         =   1  ))
      ***          OR  ((RECE02-KOHNUM(KOHFTN-IDX)   = "054") AND
      ***               (RECE02-SRYYM           >=  "201501"))
      ***          OR  ( WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)
      ***                                            =   1   )
      ***            MOVE     1     TO    FLG-ZENKI-CHECK
      ***            PERFORM  21093-ZENKI-TOKUREI-OKIKAE-SEC
      ***            MOVE     WRK-ZENKI-FTNMONEY
      ***                           TO    WRK-KOH-FTN-GEN70-Z
      ***          END-IF
      ***        END-IF
                 MOVE    20              TO   WRK-KYURATE
                 COMPUTE WRK-CHK-KEIKASOCHIXX9 = WRK-KOH-GAI-GEN70-Z
                                               + WRK-KOH-FTN-GEN70-Z
               ELSE
                 MOVE    RECE02-KYURATE  TO   WRK-KYURATE
                 COMPUTE WRK-CHK-KEIKASOCHIXX9 = WRK-KOH-GAI-GEN70
                                               + WRK-KOH-FTN-GEN70
               END-IF
      *
               IF  (WRK-CHK-KINGAKU    NOT = 9999999)
               AND (WRK-CHK-KINGAKU2       = 9999999)
                   MOVE   WRK-CHK-KINGAKU   TO   WRK-CHK-KEIKASOCHI1
                   IF  (WRK-KOH-GAI-GEN70-KIN >  WRK-CHK-KEIKASOCHI1)
                        CONTINUE
                   ELSE
                        MOVE    "4"      TO   RECE02-ZAITAKU
                   END-IF
               END-IF
      *
               IF  (WRK-CHK-KINGAKU        = 9999999)
               AND (WRK-CHK-KINGAKU2   NOT = 9999999)
                   IF   FLG-KEISAN-TOK1  =  1
                   AND  FLG-KEISAN-TOK2  =  1
                     IF  (WRK-KOH-GAI-GEN70-KIN1 >  WRK-CHK-KINGAKU2)
                        CONTINUE
                     ELSE
                        MOVE    "4"      TO   RECE02-ZAITAKU
                     END-IF
                   ELSE
                     IF  (WRK-KOH-GAI-GEN70-KIN1 >  WRK-CHK-KINGAKU2)
                     OR  (WRK-KOH-GAI-GEN70-KIN3 >  WRK-CHK-KINGAKU3)
                     OR  (WRK-KOH-GAI-GEN70-KIN5 >  WRK-CHK-KINGAKU2)
                        CONTINUE
                     ELSE
                        MOVE    "4"      TO   RECE02-ZAITAKU
                     END-IF
                   END-IF
               END-IF
      *
               IF  (WRK-CHK-KINGAKU    NOT = 9999999)
               AND (WRK-CHK-KINGAKU2   NOT = 9999999)
                   IF   FLG-JYOGENKBN  =  1
                     MOVE  WRK-CHK-KINGAKU  TO  WRK-CHK-KEIKASOCHI1
                     IF  (WRK-KOH-GAI-GEN70-KIN >  WRK-CHK-KEIKASOCHI1)
                       MOVE   ZERO          TO  WRK-CHK-KEIKASOCHI1
                     ELSE
                       IF  WK-GENGAKUKBN  NOT =  ZERO
                         MOVE WRK-KINGAKU3  TO  WRK-CHK-KEIKASOCHI1
                       END-IF
                     END-IF
                     MOVE WRK-CHK-KEIKASOCHIXX9 TO WRK-CHK-KEIKASOCHIXX
                     IF   (FLG-JYOGENKBN2 = 5 )
                     AND  (FLG-JYOGENKBN3 = 1 )
                       MOVE   WRK-KINGAKU-GENBUTU
                                            TO  WRK-CHK-KINGAKU
                     END-IF
                   ELSE
                       MOVE   9999999       TO  WRK-CHK-KEIKASOCHI1
                   END-IF
      *
                   IF   WRK-JYOGENKBN-TEN5  NOT = ZERO
                     COMPUTE WRK-JYOGENKBN-TEN9 =
                             WRK-JYOGENKBN-TEN4 +
                             WRK-JYOGENKBN-TEN5
                     COMPUTE WRK-FTNKEI6 = WRK-JYOGENKBN-TEN9
                                         * 10
                                         * WRK-KYURATE
                                         / 100
                     COMPUTE WRK-HANTEI-TOTALTEN =
                             WRK-JYOGENKBN-TEN4  +
                             WRK-JYOGENKBN-TEN5  +
                             WRK-JYOGENKBN-TEN2
                     PERFORM  21094-JYOGENGAKU-HENSYU-SEC
                     IF  WRK-JYOGENKBN-TEN2  NOT = ZERO
                         IF  (((RECE02-KOHNUM(1)(1:1) = "0"   ) AND
                               (RECE02-KOHNUM(1)
                                        NOT = "012" AND "025" ))  OR
                              ( TBL-TOKATUKAIFLG(1)   =  1     ))
                         AND (  RECE02-KOHNUM(2)       = SPACE  )
                         AND (  RECE02-KOHNUM(3)       = SPACE  )
                         AND (  RECE02-KOHNUM(4)       = SPACE  )
                         AND (  RECE02-HKNCOMBI(2) NOT = ZERO   )
                         AND (  WRK-TAIHI-TOTALTEN
                                        NOT = RECE02-TOTALTEN(2))
                         AND (  RECE02-TOTALTEN(2) NOT = ZERO   )
                           IF WRK-KINGAKU-GENBUTU3 > RECE02-FTNMONEY(2)
                             COMPUTE  WRK-CHK-KOKIGAK9      =
                                      WRK-KINGAKU-GENBUTU3  -
                                      RECE02-FTNMONEY(2)
                           ELSE
                             MOVE   ZERO   TO   WRK-CHK-KOKIGAK9
                           END-IF
                           IF   WRK-CHK-KOKIGAK9  <  WRK-FTNKEI6
                             MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                           END-IF
                         END-IF
                     ELSE
                         IF  WRK-KINGAKU-GENBUTU3 <  WRK-FTNKEI6
                             MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                         END-IF
                     END-IF
                   END-IF
      *
                   COMPUTE  WRK-CHK-KOKIGAK4 = RECE02-TOTALTEN(2)
                                             + RECE02-HENTOTALTEN(3)
                   IF  (((RECE02-KOHNUM(1)(1:1)  = "0"             ) AND
                         (RECE02-KOHNUM(1)   NOT = "012" AND "025" )) OR
                        ( TBL-TOKATUKAIFLG(1)    =  1               ))
                   AND (  RECE02-KOHNUM(2)(1:1) >= "1" AND <= "8"    )
                   AND (  TBL-TOKATUKAIFLG(2)    =  ZERO             )
                   AND (  RECE02-KOHNUM(3)       =  SPACE            )
                   AND (  RECE02-KOHNUM(4)       =  SPACE            )
                   AND (  RECE02-HKNCOMBI(2) NOT = ZERO              )
                   AND (  WRK-TAIHI-TOTALTEN NOT = RECE02-TOTALTEN(2))
                   AND (  RECE02-TOTALTEN(2) NOT = ZERO              )
                   AND (( WRK-TAIHI-TOTALTEN = WRK-CHK-KOKIGAK4     ) OR
                        ( WRK-TAIHI-TOTALTEN = RECE02-HENTOTALTEN(3)))
                   AND (  WRK-JYOGENKBN-TEN2 NOT = ZERO              )
                   AND (  FLG-ZENKOKUKOHI-NISYU4 =  1                )
                     COMPUTE WRK-JYOGENKBN-TEN9 =
                             WRK-TAIHI-TOTALTEN -
                             RECE02-TOTALTEN(2)
                     COMPUTE WRK-FTNKEI6 = WRK-JYOGENKBN-TEN9
                                         * 10
                                         * WRK-KYURATE
                                         / 100
      ***            MOVE  WRK-TAIHI-TOTALTEN TO  WRK-HANTEI-TOTALTEN
                     MOVE  WRK-JYOGENKBN-TEN9 TO  WRK-HANTEI-TOTALTEN
                     PERFORM  21094-JYOGENGAKU-HENSYU-SEC
                     IF WRK-KINGAKU-GENBUTU3 > RECE02-FTNMONEY(2)
                       COMPUTE  WRK-CHK-KOKIGAK9      =
                                WRK-KINGAKU-GENBUTU3  -
                                RECE02-FTNMONEY(2)
                     ELSE
                       MOVE   ZERO   TO   WRK-CHK-KOKIGAK9
                     END-IF
                     IF   WRK-CHK-KOKIGAK9  <  WRK-FTNKEI6
                       MOVE   ZERO   TO   WRK-CHK-KEIKASOCHI1
                     END-IF
                   END-IF
      *
                   IF   FLG-KEISAN-TOK1  =  1
                   AND  FLG-KEISAN-TOK2  =  1
                     IF (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                     OR (WRK-KOH-GAI-GEN70-KIN1 >  WRK-CHK-KINGAKU2   )
                        CONTINUE
                     ELSE
                        MOVE    "4"      TO   RECE02-ZAITAKU
                     END-IF
                   ELSE
                     IF (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                     OR (WRK-KOH-GAI-GEN70-KIN1 >  WRK-CHK-KINGAKU2   )
                     OR (WRK-KOH-GAI-GEN70-KIN3 >  WRK-CHK-KINGAKU3   )
                     OR (WRK-KOH-GAI-GEN70-KIN2 >  WRK-CHK-KINGAKU    )
                     OR (WRK-KOH-GAI-GEN70-KIN4 >  WRK-CHK-KINGAKU    )
                        CONTINUE
                     ELSE
                        MOVE    "4"      TO   RECE02-ZAITAKU
                     END-IF
                   END-IF
               END-IF
      *
               IF  (WRK-CHK-KINGAKU        = 9999999)
               AND (WRK-CHK-KINGAKU2       = 9999999)
                        MOVE    "4"      TO   RECE02-ZAITAKU
               END-IF
      *
      ***      IF  (FLG-ZENKOKUKOHI-NISYU4  =   1      )
      ***      AND (RECE02-ZAITAKU          =  "4"     )
      ***      AND (WRK-CHK-KINGAKU     NOT =   9999999)
      ***      AND (WRK-CHK-KINGAKU2    NOT =   9999999)
      ***        COMPUTE  WRK-CHK-KOKIGAK4 = RECE02-TOTALTEN(2)
      ***                                  + RECE02-HENTOTALTEN(3)
      ***        IF  (((RECE02-KOHNUM(1)(1:1) = "0"            ) AND
      ***              (RECE02-KOHNUM(1)  NOT = "012" AND "025"))  OR
      ***             ( TBL-TOKATUKAIFLG(1)   =  1              ) )
      ***        AND (RECE02-KOHNUM(2)(1:1)  >= "1" AND <= "8"    )
      ***        AND (TBL-TOKATUKAIFLG(2)     = ZERO              )
      ***        AND (RECE02-KOHNUM(3)        = SPACE             )
      ***        AND (RECE02-KOHNUM(4)        = SPACE             )
      ***        AND (RECE02-HKNCOMBI(2)  NOT = ZERO              )
      ***        AND (WRK-TAIHI-TOTALTEN  NOT = RECE02-TOTALTEN(2))
      ***        AND (RECE02-TOTALTEN(2)  NOT = ZERO              )
      ***        AND ((WRK-TAIHI-TOTALTEN   =  WRK-CHK-KOKIGAK4 ) OR
      ***             (WRK-TAIHI-TOTALTEN   =
      ***                                  RECE02-HENTOTALTEN(3)) )
      *
      ***            IF   WRK-CHK-KINGAKU  >  RECE02-FTNMONEY(2)
      ***              COMPUTE  WRK-CHK-KOKIGAK = WRK-CHK-KINGAKU
      ***                                       - RECE02-FTNMONEY(2)
      ***            ELSE
      ***              MOVE     ZERO     TO   WRK-CHK-KOKIGAK
      ***            END-IF
      ***            IF  (WRK-KOH-GAI-GEN70-KIN2 >  WRK-CHK-KOKIGAK)
      ***            OR  (WRK-KOH-GAI-GEN70-KIN4 >  WRK-CHK-KOKIGAK)
      ***               MOVE    "1"      TO   RECE02-ZAITAKU
      ***            END-IF
      *
      ***        END-IF
      ***      END-IF
      *
               IF  (FLG-GENBUTU-HANTEI    =   1  )
               AND (FLG-GENBUTU-HANTEI2   =   1  )
               AND (RECE02-ZAITAKU        =  "4" )
                    MOVE    "1"      TO   RECE02-ZAITAKU
               END-IF
      *
               IF  (FLG-GENBUTU-HANTEI    =   1  )
               AND (FLG-SYSCHK            =   1  )
               AND (RECE02-ZAITAKU        =  "4" )
                    MOVE    "1"      TO   RECE02-ZAITAKU
               END-IF
      *
               IF  (FLG-GENBUTU-HANTEI    =   1  )
               AND (FLG-NYUSYO            =   1  )
               AND (RECE02-ZAITAKU        =  "4" )
                    MOVE    "1"      TO   RECE02-ZAITAKU
               END-IF
      *
               IF  (FLG-GENBUTU-HANTEI    =   1  )
               AND (RECE02-RECEIPT-KBN(4:1)
                                          =  "2" )
               AND (RECE02-ZAITAKU        =  "4" )
                    MOVE    "1"      TO   RECE02-ZAITAKU
               END-IF
      *
               IF  (WK-GENGAKUKBN           =  ZERO)
               AND (RECE02-ZAITAKU          =  "4" )
               AND (RECE02-GNBKEIKBN-K-G(2) =  "2" )
                 IF  (RECE02-KOHNUM(1)(1:1) >= "1" AND <= "8"    )
                 AND (RECE02-KOHNUM(2)       =  SPACE            )
                 AND (RECE02-KOHNUM(3)       =  SPACE            )
                 AND (RECE02-KOHNUM(4)       =  SPACE            )
                 AND (WRK-TAIHI-TOTALTEN NOT = RECE02-TOTALTEN(2))
                 AND (RECE02-TOTALTEN(2) NOT = ZERO              )
                   MOVE     WRK-TAIHI-TOTALTEN  TO  WRK-HANTEI-TOTALTEN
                   PERFORM  21094-JYOGENGAKU-HENSYU-SEC
                   COMPUTE  WRK-FTNKEI7  = WRK-TAIHI-TOTALTEN
                                         * 10
                                         * WRK-KYURATE
                                         / 100
                   IF   WRK-FTNKEI7  >  WRK-KINGAKU3
                      MOVE    "1"    TO   RECE02-ZAITAKU
                   END-IF
                 END-IF
               END-IF
      *
               IF  (RECE02-EKF-KSINGKBN-K(2) = "1")
               OR  (RECE02-EKF-KSINGKBN-K(3) = "1")
               OR  (RECE02-EKF-KSINGKBN-K(4) = "1")
               OR  (RECE02-EKF-KSINGKBN-K(5) = "1")
                    MOVE    "4"      TO   RECE02-ZAITAKU
               END-IF
      *
               IF   WK-GENGAKUKBN    =   3 OR 4
                    MOVE    "4"      TO   RECE02-ZAITAKU
               END-IF
               IF  (WK-GENGAKUKBN    =   1 OR 2 OR 5)
               AND (RECE02-SRYYM    <=  "201807"    )
                    MOVE    "1"      TO   RECE02-ZAITAKU
               END-IF
      *
               EVALUATE  WRK-TAIHI-OKIKAE
                 WHEN        1
                     IF  RECE02-ZAITAKU  = "1"
                       CONTINUE
                     ELSE
                       MOVE   "1"      TO   RECE02-ZAITAKU
                       MOVE    2       TO   RECE02-ICBKINKSI-ARI
                     END-IF
                 WHEN        2
                     IF  RECE02-ZAITAKU  = "4"
                       CONTINUE
                     ELSE
                       MOVE   "4"      TO   RECE02-ZAITAKU
                       MOVE    2       TO   RECE02-ICBKINKSI-NASI
                     END-IF
               END-EVALUATE
      *
               IF      RECE02-ZAITAKU  =  "4"
                 MOVE     ZERO    TO    RECE02-FTNMONEY(1)
                 PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                           UNTIL   KOHFTN-IDX   >    4
                   IF   TBL-HKNFTNDATA-FLG(KOHFTN-IDX)  NOT =  1
                     IF ( RECE02-KOHNUM(KOHFTN-IDX) =
                               "015" OR "016" OR "051" OR "021" OR
                               "024" OR "079" OR "052" OR "012" OR
                               "025" OR "038"                       )
                     OR ((RECE02-KOHNUM(KOHFTN-IDX) =  "054"       ) AND
                         (RECE02-SRYYM             >=  "201501"    ))
                     OR ( WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)  =  1 )
                     OR ( RECE02-EKF-ENCHGKBN-K(KOHFTN-IDX + 1)
                                                     = "2" OR "3"   )
                     OR ( TBL-TOKATUKAIFLG(KOHFTN-IDX)   =  1       )
                       MOVE  WRK-TAIHI-FTNMONEY    (KOHFTN-IDX + 1)
                                 TO  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                       MOVE  WRK-TAIHI-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                                 TO  RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                     END-IF
                     IF    RECE02-KOHNUM(KOHFTN-IDX) = "010"
                       MOVE  ZERO    TO  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                     END-IF
                   END-IF
                 END-PERFORM
               END-IF
      *
           END-IF
      *
           PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                     UNTIL    KOHFTN-IDX     >    4
             IF ((RECE02-EKF-ENCHGKBN-K(KOHFTN-IDX + 1) = "3") AND
                 (RECE02-ZAITAKU                        = "1") AND
                 (FLG-KOUGAKU                           =  1 ))
             OR ((RECE02-EKF-ENCHGKBN-Y(KOHFTN-IDX + 1) = "3") AND
                 (RECE02-ZAITAKU                        = "2") AND
                 (FLG-KOUGAKU                           =  1 ))
      *
               MOVE  WRK-TAIHI-FTNMONEY    (KOHFTN-IDX + 1)
                         TO  RECE02-FTNMONEY(KOHFTN-IDX + 1)
               MOVE  WRK-TAIHI-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                         TO  RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)
      *
             END-IF
           END-PERFORM
      *
      ************
      *
           IF   FTN-KOH-XXX    >    WRK-CHK-ICHIBUGAKU
                COMPUTE  FTN-KOH-XXX = FTN-KOH-XXX - WRK-CHK-ICHIBUGAKU
           ELSE
                MOVE     ZERO    TO    FTN-KOH-XXX
           END-IF
      ***
           IF   RECE02-ZAITAKU         =  "2"
             IF   WRK-KEISAN-YYY    NOT =  ZERO
               IF   WRK-KEISAN-YYY   <   RECE02-FTNMONEY(1)
                  COMPUTE  RECE02-FTNMONEY(1) =  RECE02-FTNMONEY(1)
                                              -  WRK-KEISAN-YYY
               ELSE
                  MOVE     ZERO    TO    RECE02-FTNMONEY(1)
               END-IF
               IF   WRK-KEISAN-YYY   <   FTN-KOH-XXX
                  COMPUTE  FTN-KOH-XXX        =  FTN-KOH-XXX
                                              -  WRK-KEISAN-YYY
               ELSE
                  MOVE     ZERO    TO    FTN-KOH-XXX
               END-IF
             END-IF
           END-IF
      *
           PERFORM  2109A-CHIHO-ICHIBUFTN-HEN-SEC
      *
           MOVE    999999999   TO   WRK-FTNMONEY-MAE
           PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                     UNTIL   KOHFTN-IDX   >    4
      *         ７０歳代前半軽減特例措置対応
                IF  ((FLG-ZENKI-TOKUREI           =   1  ) AND
                     (RECE02-KOHNUM(KOHFTN-IDX)   = "051"))
                OR  ((FLG-ZENKI-TOKUREI           =   1  ) AND
                     (RECE02-KOHNUM(KOHFTN-IDX)   = "038"))
                OR  ((FLG-ZENKI-TOKUREI           =   1  ) AND
                     (SYS-1001-PREFNUM            =  13  ) AND
                     (RECE02-KOHNUM(KOHFTN-IDX)   = "151"))
                OR  ((FLG-ZENKI-TOKUREI           =   1     ) AND
                     (SYS-1001-PREFNUM            =  23     ) AND
                     (RECE02-KOHNUM(KOHFTN-IDX)   = "191"   ) AND
                     (RECE02-SRYYM               >= "200910") AND
                     (RECE02-SRYYM               <= "201108"))
                OR  ((FLG-ZENKI-TOKUREI           =   1     ) AND
                     (SYS-1001-PREFNUM            =  23     ) AND
                     (RECE02-KOHNUM(KOHFTN-IDX)   = "191"   ) AND
                     (RECE02-TEISYUTUSAKI         =   1     ) AND
                     (RECE02-SRYYM               >= "201109"))
                OR  ((FLG-ZENKI-TOKUREI           =   1     ) AND
                     (RECE02-KOHNUM(KOHFTN-IDX)   = "054"   ) AND
                     (RECE02-SRYYM               >= "201501"))
                OR  ((FLG-ZENKI-TOKUREI           =   1     ) AND
                     (WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)
                                                  =   1     ))
                   IF   KOHFTN-IDX =  1
                     MOVE  RECE02-FTNMONEY(2)  TO  WRK-FTNMONEY-MAE
                   END-IF
                   MOVE     ZERO     TO    FLG-ZENKI-CHECK
                   PERFORM  21093-ZENKI-TOKUREI-OKIKAE-SEC
                ELSE
                   IF   RECE02-ZAITAKU  =  "1" OR "2"
                     IF  (RECE02-KOHNUM(KOHFTN-IDX) = "024" OR "079")
                     AND (TBL-HKNFTNDATA-FLG(KOHFTN-IDX)   =  1     )
                     AND (SYS-200501-GENBUTU-ICHIBU-KSIKBN = "1"    )
                       COMPUTE RECE02-FTNMONEY(KOHFTN-IDX + 1) =
                               RECE02-FTNMONEY(KOHFTN-IDX + 1) +  5
                       COMPUTE RECE02-FTNMONEY(KOHFTN-IDX + 1) =
                               RECE02-FTNMONEY(KOHFTN-IDX + 1) / 10
                       COMPUTE RECE02-FTNMONEY(KOHFTN-IDX + 1) =
                               RECE02-FTNMONEY(KOHFTN-IDX + 1) * 10
                       PERFORM  2109A-CHIHO-ICHIBUFTN-HEN-SEC
                     END-IF
                   ELSE
                     IF   TBL-HKNFTNDATA-FLG(KOHFTN-IDX)  =  1
      ***              IF   TBL-HKNFTNDATA-JGN(KOHFTN-IDX)
      ***                            = RECE02-FTNMONEY(KOHFTN-IDX + 1)
      ***                CONTINUE
      ***              ELSE
                         PERFORM  21095-KOH-ICHIBUFTN-HENSYU-SEC
                         PERFORM  2109A-CHIHO-ICHIBUFTN-HEN-SEC
      ***              END-IF
                     END-IF
                   END-IF
                END-IF
           END-PERFORM
      *
      *    減免公費対応
           IF  (WK-GENGAKUKBN    NOT =   ZERO )
           AND (WK-GENGAKUKBN    NOT = 3 AND 4)
             IF  (RECE02-SRYYM        >= "200709")
             AND (RECE02-HKNNUM    NOT =  SPACE  )
               IF ( RECE02-KOHNUM(1) =
                    "010" OR "012" OR "015" OR "016" OR
                    "021" OR "024" OR "051" OR "052" OR
                    "079" OR "025" OR "038"             )
               OR ((RECE02-KOHNUM(1) = "054"           ) AND
                   (RECE02-SRYYM    >= "201501"        ))
               OR ( TBL-TOKATUKAIFLG(1)   =  1          )
                 IF  RECE02-KOHNUM(1)    = "010"
                   IF   RECE02-ZAITAKU   = "1" OR "2"
                      PERFORM  21092-GENGAKU-OKIKAE-SEC
                   END-IF
                 ELSE
                   IF  ( SYS-1001-PREFNUM  =   01          )
                   AND ( RECE02-KOHNUM(1)  =  "051"        )
                   AND ((RECE02-KOHJKYSNUM(1)(1:2) >= "91"
                                               AND <= "95") OR
                        (RECE02-KOHJKYSNUM(1)(1:2) >= "71"
                                               AND <= "88"))
                   AND ( RECE02-SRYYM      <  "200810"     )
                      CONTINUE
                   ELSE
                      PERFORM  21092-GENGAKU-OKIKAE-SEC
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      ***
           MOVE     ZERO     TO    FLG-SAIKEI-KISAI
           EVALUATE   SYS-1001-PREFNUM
             WHEN       "01"
               IF  (RECE02-SRYYM   >=  "200510")
               AND (RECE02-SRYYM   <   "200810")
                 PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                           UNTIL   KOHFTN-IDX   >    4
                   IF  ( RECE02-KOHNUM(KOHFTN-IDX) =  "051"         )
                   AND ((RECE02-KOHJKYSNUM(KOHFTN-IDX)(1:2) >= "91"
                                                        AND <= "95") OR
                        (RECE02-KOHJKYSNUM(KOHFTN-IDX)(1:2) >= "71"
                                                        AND <= "88"))
                       MOVE     1     TO    FLG-SAIKEI-KISAI
                   END-IF
                 END-PERFORM
               END-IF
           END-EVALUATE
           PERFORM  VARYING  KOHFTN-IDX  FROM  1  BY  1
                     UNTIL   KOHFTN-IDX   >    4
             IF ((RECE02-EKF-KAKKBN-K(KOHFTN-IDX + 1) = "1") AND
                 (RECE02-ZAITAKU                      = "1"))
             OR ((RECE02-EKF-KAKKBN-Y(KOHFTN-IDX + 1) = "1") AND
                 (RECE02-ZAITAKU                      = "2"))
                       MOVE     1     TO    FLG-SAIKEI-KISAI
             END-IF
           END-PERFORM
      *
           MOVE    999999999   TO   WRK-FTNMONEY-ATO
           IF   RECE02-ZAITAKU  =  SPACE  OR  "3"  OR  "4"
                  MOVE     ZERO          TO  RECE02-ZAITAKU-SAIKEI
                                             RECE02-ZAITAKU-SAIKEI2
                                             FLG-ZENKOKUKOHI-NISYU
           ELSE
              IF    RECE02-KOHNUM(1)  =  SPACE
              AND   RECE02-KOHNUM(2)  =  SPACE
              AND   RECE02-KOHNUM(3)  =  SPACE
              AND   RECE02-KOHNUM(4)  =  SPACE
                  MOVE     ZERO          TO  RECE02-ZAITAKU-SAIKEI
                                             RECE02-ZAITAKU-SAIKEI2
                                             FLG-ZENKOKUKOHI-NISYU
              ELSE
                  IF  FLG-KOH  =   2
                     ADD   WRK-KOH-GAI   TO  RECE02-FTNMONEY(2)
                                             RECE02-FTNMONEY-KOJ(2)
                     MOVE  RECE02-FTNMONEY(2)
                                         TO  WRK-FTNMONEY-ATO
                  END-IF
                  MOVE     FTN-KOH-XXX   TO  RECE02-ZAITAKU-SAIKEI
      *
                  IF  RECE02-KOHNUM(1)    = SPACE
                     MOVE   ZERO         TO  RECE02-ZAITAKU-SAIKEI
                  ELSE
                    IF  (FLG-SAIKEI-KISAI  NOT =  ZERO               )
                    OR  (FLG-ZENKOKUKOHI-NISYU =  1 OR 2 OR 3 OR 4 OR
                                                  5 OR 8 OR 9        )
                         CONTINUE
                    ELSE
                      IF  (RECE02-KOHNUM(1)   NOT = "972" AND "974")
                      AND (RECE02-TOTALTEN(1) = RECE02-TOTALTEN(2) )
                      AND (FTN-KOH-XXX        = RECE02-FTNMONEY(1) )
                           MOVE  ZERO    TO  RECE02-ZAITAKU-SAIKEI
                      END-IF
      *
                      IF  (RECE02-KOHNUM(1)       = "972" OR  "974")
                      AND (RECE02-KOHNUM(2)   NOT = "972" AND "974")
                      AND (RECE02-TOTALTEN(1) = RECE02-TOTALTEN(3) )
                      AND (FTN-KOH-XXX        = RECE02-FTNMONEY(1) )
                           MOVE  ZERO    TO  RECE02-ZAITAKU-SAIKEI
                      END-IF
      *
                      IF  (RECE02-KOHNUM(1)   NOT = "972" AND "974")
                      AND (RECE02-KOHNUM(1)   NOT =  SPACE         )
                      AND (RECE02-TOTALTEN(2)     =  ZERO          )
                      AND (FTN-KOH-XXX        = RECE02-FTNMONEY(1) )
                           MOVE  ZERO    TO  RECE02-ZAITAKU-SAIKEI
                      END-IF
      *
                      IF  (RECE02-KOHNUM(1)       = "972" OR  "974")
                      AND (RECE02-KOHNUM(2)   NOT = "972" AND "974")
                      AND (RECE02-KOHNUM(2)   NOT =  SPACE         )
                      AND (RECE02-TOTALTEN(3)     =  ZERO          )
                      AND (FTN-KOH-XXX        = RECE02-FTNMONEY(1) )
                           MOVE  ZERO    TO  RECE02-ZAITAKU-SAIKEI
                      END-IF
      *
                      IF ((RECE02-KOHNUM(1)     NOT = SPACE  ) AND
                          (RECE02-RECESKYKBN(1) NOT = SPACE  ) AND
                          (RECE02-KOHNUM(2)  =  SPACE        ))
                      OR ((RECE02-KOHNUM(1)     NOT = SPACE  ) AND
                          (RECE02-RECESKYKBN(1) NOT = SPACE  ) AND
                          (RECE02-KOHNUM(2)     NOT = SPACE  ) AND
                          (RECE02-RECESKYKBN(2) NOT = SPACE  ) AND
                          (RECE02-KOHNUM(3)  =  SPACE        ))
                      OR ((RECE02-KOHNUM(1)     NOT = SPACE  ) AND
                          (RECE02-RECESKYKBN(1) NOT = SPACE  ) AND
                          (RECE02-KOHNUM(2)     NOT = SPACE  ) AND
                          (RECE02-RECESKYKBN(2) NOT = SPACE  ) AND
                          (RECE02-KOHNUM(3)     NOT = SPACE  ) AND
                          (RECE02-RECESKYKBN(3) NOT = SPACE  ) AND
                          (RECE02-KOHNUM(4)  =  SPACE        ))
                      OR ((RECE02-KOHNUM(1)     NOT = SPACE  ) AND
                          (RECE02-RECESKYKBN(1) NOT = SPACE  ) AND
                          (RECE02-KOHNUM(2)     NOT = SPACE  ) AND
                          (RECE02-RECESKYKBN(2) NOT = SPACE  ) AND
                          (RECE02-KOHNUM(3)     NOT = SPACE  ) AND
                          (RECE02-RECESKYKBN(3) NOT = SPACE  ) AND
                          (RECE02-KOHNUM(4)     NOT = SPACE  ) AND
                          (RECE02-RECESKYKBN(4) NOT = SPACE  ))
                           MOVE  ZERO    TO  RECE02-ZAITAKU-SAIKEI
                      END-IF
                    END-IF
                  END-IF
      *
                  MOVE     ZERO          TO  WRK-CYOKI-KEISAN8
                  IF  FTN-KOH-XX3   NOT =   ZERO
                    MOVE   FTN-KOH-XX3   TO  RECE02-ZAITAKU-SAIKEI2
                    IF  (FLG-KOH           =   2   )
                    AND (RECE02-KOHNUM(2)  =  "010")
                      COMPUTE WRK-CYOKI-KEISAN3 = RECE02-FTNMONEY(1)
                                                - FTN-KOH-XX3
                      ADD WRK-CYOKI-KEISAN3 TO RECE02-FTNMONEY(3)
                                               RECE02-FTNMONEY-KOJ(3)
                      MOVE  WRK-CYOKI-KEISAN3
                                            TO WRK-CYOKI-KEISAN8
                    END-IF
                  ELSE
                   IF FTN-KOH-XX4   NOT =   ZERO
                    MOVE   FTN-KOH-XX4   TO  RECE02-ZAITAKU-SAIKEI2
                   ELSE
                    MOVE   ZERO          TO  RECE02-ZAITAKU-SAIKEI2
                   END-IF
                  END-IF
      *
                  IF  ((FTN-KOH-XX5    NOT =  ZERO) AND
                       (FTN-KOH-XX6    NOT =  ZERO) AND
                       (FTN-KOH-XX3        =  ZERO) AND
                       (FTN-KOH-XX8        =  ZERO))
                  OR  ((FTN-KOH-XX5        =  ZERO) AND
                       (FTN-KOH-XX6    NOT =  ZERO) AND
                       (FTN-KOH-XX3        =  ZERO) AND
                       (FTN-KOH-XX8        =  ZERO) AND
                       (FLG-XX5-TUUKA  NOT =  ZERO))
                    MOVE   FTN-KOH-XX5   TO  RECE02-ZAITAKU-SAIKEI
                    MOVE   FTN-KOH-XX6   TO  RECE02-ZAITAKU-SAIKEI2
                    IF  (FLG-KOH           =   2   )
                    AND (RECE02-KOHNUM(1)  =  "010")
                      COMPUTE RECE02-FTNMONEY(2)     =
                              RECE02-FTNMONEY(2)     - WRK-KOH-GAI
                      COMPUTE RECE02-FTNMONEY-KOJ(2) =
                              RECE02-FTNMONEY-KOJ(2) - WRK-KOH-GAI
                      COMPUTE WRK-CYOKI-KEISAN3 = RECE02-FTNMONEY(1)
                                                - FTN-KOH-XX5
                      ADD WRK-CYOKI-KEISAN3 TO RECE02-FTNMONEY(2)
                                               RECE02-FTNMONEY-KOJ(2)
                    END-IF
                    IF  (FLG-KOH           =   2   )
                    AND (RECE02-KOHNUM(2)  =  "010")
                      COMPUTE WRK-CYOKI-KEISAN3 = RECE02-FTNMONEY(1)
                                                - FTN-KOH-XX6
                      ADD WRK-CYOKI-KEISAN3 TO RECE02-FTNMONEY(3)
                                               RECE02-FTNMONEY-KOJ(3)
                    END-IF
      *
      ***           IF     FLG-KOH  =   2
                      COMPUTE WRK-CYOKI-KEISAN  = RECE02-FTNMONEY(1)
                                                - WRK-KOH-GAI2
                      COMPUTE WRK-CYOKI-KEISAN2 = FTN-KOH-XX5
                                                + FTN-KOH-XX6
                      IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
                        COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                                  - FTN-KOH-XX5
                        IF  WRK-CYOKI-KEISAN3  <  FTN-KOH-XX6
                          MOVE  WRK-CYOKI-KEISAN3
                                        TO   RECE02-ZAITAKU-SAIKEI2
                          IF    WRK-CYOKI-KEISAN3  = ZERO
                             MOVE   1   TO   RECE02-SAIKEIZEROKSI2
                          END-IF
                        END-IF
                      END-IF
      ***           END-IF
                  END-IF
      *
                  IF  ((FTN-KOH-XX5   NOT =   ZERO) AND
                       (FTN-KOH-XX6       =   ZERO) AND
                       (FTN-KOH-XX8       =   ZERO) AND
                       (FTN-KOH-XX3   NOT =   ZERO))
                  OR  ((FTN-KOH-XX5       =   ZERO) AND
                       (FTN-KOH-XX6       =   ZERO) AND
                       (FTN-KOH-XX8       =   ZERO) AND
                       (FTN-KOH-XX3   NOT =   ZERO) AND
                       (FLG-XX5-TUUKA NOT =   ZERO))
                    COMPUTE RECE02-FTNMONEY(1) = WRK-KOH-GAI2
                                               + FTN-KOH-XX5
                                               + FTN-KOH-XX3
      **************MOVE   FTN-KOH-XX5   TO  RECE02-ZAITAKU-SAIKEI
                    MOVE   FTN-KOH-XX3   TO  RECE02-ZAITAKU-SAIKEI2
                    IF  (FLG-KOH           =   2   )
                    AND (RECE02-KOHNUM(1)  =  "010")
                      COMPUTE RECE02-FTNMONEY(2)     =
                              RECE02-FTNMONEY(2)     - WRK-KOH-GAI
                      COMPUTE RECE02-FTNMONEY-KOJ(2) =
                              RECE02-FTNMONEY-KOJ(2) - WRK-KOH-GAI
                      COMPUTE WRK-CYOKI-KEISAN3 = RECE02-FTNMONEY(1)
                                                - FTN-KOH-XX5
                      ADD WRK-CYOKI-KEISAN3 TO RECE02-FTNMONEY(2)
                                               RECE02-FTNMONEY-KOJ(2)
                    END-IF
                    IF  (FLG-KOH           =   2   )
                    AND (RECE02-KOHNUM(2)  =  "010")
                      COMPUTE RECE02-FTNMONEY(3)
                                              = RECE02-FTNMONEY(3)
                                              - WRK-CYOKI-KEISAN8
                      COMPUTE RECE02-FTNMONEY-KOJ(3)
                                              = RECE02-FTNMONEY-KOJ(3)
                                              - WRK-CYOKI-KEISAN8
                      COMPUTE WRK-CYOKI-KEISAN3 = RECE02-FTNMONEY(1)
                                                - FTN-KOH-XX3
                      ADD WRK-CYOKI-KEISAN3 TO RECE02-FTNMONEY(3)
                                               RECE02-FTNMONEY-KOJ(3)
                    END-IF
                  END-IF
                  IF  ((FTN-KOH-XX5       =   ZERO) AND
                       (FTN-KOH-XX6   NOT =   ZERO) AND
                       (FTN-KOH-XX8   NOT =   ZERO) AND
                       (FTN-KOH-XX3       =   ZERO))
                  OR  ((FTN-KOH-XX5       =   ZERO) AND
                       (FTN-KOH-XX6   NOT =   ZERO) AND
                       (FTN-KOH-XX8       =   ZERO) AND
                       (FTN-KOH-XX3       =   ZERO) AND
                       (FLG-XX8-TUUKA NOT =   ZERO))
                    COMPUTE RECE02-FTNMONEY(1) = WRK-KOH-GAI2
                                               + FTN-KOH-XX8
                                               + FTN-KOH-XX6
      **************MOVE   FTN-KOH-XX8   TO  RECE02-ZAITAKU-SAIKEI
                    MOVE   FTN-KOH-XX6   TO  RECE02-ZAITAKU-SAIKEI2
                    IF  (FLG-KOH           =   2   )
                    AND (RECE02-KOHNUM(1)  =  "010")
                      COMPUTE RECE02-FTNMONEY(2)     =
                              RECE02-FTNMONEY(2)     - WRK-KOH-GAI
                      COMPUTE RECE02-FTNMONEY-KOJ(2) =
                              RECE02-FTNMONEY-KOJ(2) - WRK-KOH-GAI
                      COMPUTE WRK-CYOKI-KEISAN3  = RECE02-FTNMONEY(1)
                                                 - FTN-KOH-XX8
                      ADD WRK-CYOKI-KEISAN3 TO RECE02-FTNMONEY(2)
                                               RECE02-FTNMONEY-KOJ(2)
                    END-IF
                    IF  (FLG-KOH           =   2   )
                    AND (RECE02-KOHNUM(2)  =  "010")
                      COMPUTE WRK-CYOKI-KEISAN3 = RECE02-FTNMONEY(1)
                                                - FTN-KOH-XX6
                      ADD WRK-CYOKI-KEISAN3 TO RECE02-FTNMONEY(3)
                                               RECE02-FTNMONEY-KOJ(3)
                    END-IF
                  END-IF
      *
                  IF ((FLG-KEISAN-TOK1            =  ZERO) AND
                      (FLG-KEISAN-TOK2            =  1   ) AND
                      (FTN-KOH-XX8            NOT =  ZERO))
                  OR ((FLG-KEISAN-TOK1            =  ZERO) AND
                      (FLG-KEISAN-TOK2            =  1   ) AND
                      (FTN-KOH-XX8                =  ZERO) AND
                      (FLG-ZENKOKUKOHI-NISYU  NOT =  4   ) AND
                      (FLG-XX8-TUUKA          NOT =  ZERO))
                    COMPUTE RECE02-FTNMONEY(1) = WRK-KOH-GAI2
                                               + FTN-KOH-XX8
                                               + FTN-KOH-XX7X
      **************MOVE   FTN-KOH-XX8   TO  RECE02-ZAITAKU-SAIKEI
                    IF  FLG-ZENKOKUKOHI-NISYU  =   2
                      MOVE FTN-KOH-XX7   TO  RECE02-ZAITAKU-SAIKEI2
                    END-IF
                    IF  (FLG-KOH           =   2   )
                    AND (RECE02-KOHNUM(1)  =  "010")
                      COMPUTE RECE02-FTNMONEY(2)     =
                              RECE02-FTNMONEY(2)     - WRK-KOH-GAI
                      COMPUTE RECE02-FTNMONEY-KOJ(2) =
                              RECE02-FTNMONEY-KOJ(2) - WRK-KOH-GAI
                      COMPUTE WRK-CYOKI-KEISAN3  = RECE02-FTNMONEY(1)
                                                 - FTN-KOH-XX8
                      ADD WRK-CYOKI-KEISAN3 TO RECE02-FTNMONEY(2)
                                               RECE02-FTNMONEY-KOJ(2)
                    END-IF
                  END-IF
      *
                  IF   FLG-KEISAN-TOK1        =  ZERO
                  AND  FLG-KEISAN-TOK2        =  1
                  AND  FTN-KOH-XX8            =  ZERO
                  AND  FLG-ZENKOKUKOHI-NISYU  =  4
                    COMPUTE RECE02-FTNMONEY(1) = WRK-KOH-GAI2
                                               + FTN-KOH-XX4
                                               + FTN-KOH-XX7X
      ************* MOVE   FTN-KOH-XX4   TO  RECE02-ZAITAKU-SAIKEI
                    MOVE   FTN-KOH-XX7   TO  RECE02-ZAITAKU-SAIKEI2
                    MOVE   ZERO          TO  FTN-KOH-XX4
                  END-IF
      *
                  IF  ((FLG-KEISAN-TOK1        =   1  ) AND
                       (FLG-KEISAN-TOK2        =   1  ) AND
                       (FLG-ZENKOKUKOHI-NISYU3 =   1  ))
                  OR  ((FLG-KEISAN-TOK1        =   1  ) AND
                       (FLG-KEISAN-TOK2        =   1  ) AND
                       (FTN-KOH-XX8            =  ZERO) AND
                       (FLG-ZENKOKUKOHI-NISYU  =   4  ))
                   IF  FLG-CYOKI-HENSYU  =  1
                    IF  FLG-ZENKOKUKOHI-NISYU  =  2 OR 4
                      MOVE   ZERO   TO  RECE02-ZAITAKU-SAIKEI2
                      MOVE    1     TO  RECE02-SAIKEIZEROKSI2
                    END-IF
                   ELSE
                    COMPUTE WRK-CYOKI-KEISAN  = RECE02-FTNMONEY(1)
                                              - WRK-KOH-GAI2
                    COMPUTE WRK-CYOKI-KEISAN2 = FTN-KOH-XXX
                                              + FTN-KOH-XX7
                    COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                              - FTN-KOH-XXX
      *
                    IF   FLG-KOH  =   2
                     COMPUTE  WRK-CYOKI-KEISAN5 = RECE02-FTNMONEY(2)
                                                - WRK-KOH-GAI
                    ELSE
                     IF  WRK-FTNMONEY-MAE  NOT = 999999999
                       MOVE WRK-FTNMONEY-MAE   TO WRK-CYOKI-KEISAN5
                     ELSE
                       MOVE RECE02-FTNMONEY(2) TO WRK-CYOKI-KEISAN5
                     END-IF
                    END-IF
      *
                    IF   WRK-CYOKI-JGNGAK  >  WRK-CYOKI-KEISAN5
                     COMPUTE  WRK-CYOKI-KEISAN6 = WRK-CYOKI-JGNGAK
                                                - WRK-CYOKI-KEISAN5
                    ELSE
                     MOVE     ZERO             TO WRK-CYOKI-KEISAN6
                    END-IF
      *
                    IF   (RECE02-TEISYOTOKU  NOT =  SPACE)
                    AND  (RECE02-ZAITAKU         =  "1"  )
                    AND  (FLG-ZENKOKUKOHI-NISYU4 =   4   )
                      IF  FLG-TOKU75 = 1 OR 2
                       IF   4000  >  WRK-CYOKI-KEISAN5
                         COMPUTE WRK-CYOKI-KEISAN6 = 4000
                                                   - WRK-CYOKI-KEISAN5
                       ELSE
                         MOVE    ZERO             TO WRK-CYOKI-KEISAN6
                       END-IF
                      ELSE
                       IF   8000  >  WRK-CYOKI-KEISAN5
                         COMPUTE WRK-CYOKI-KEISAN6 = 8000
                                                   - WRK-CYOKI-KEISAN5
                       ELSE
                         MOVE    ZERO             TO WRK-CYOKI-KEISAN6
                       END-IF
                      END-IF
                    END-IF
      *
                    IF  FLG-ZENKOKUKOHI-NISYU  =   2 OR 4
                      MOVE  FTN-KOH-XX7  TO  RECE02-ZAITAKU-SAIKEI2
                      IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
                      AND   WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7
                          IF   FLG-ZENKOKUKOHI-NISYU4  =  2 OR 3 OR 4
                            IF  (FTN-KOH-XX7      > WRK-CYOKI-KEISAN6)
                            AND (FLG-ZENKOKUKOHI-NISYU4  =  2 OR 4   )
                             MOVE WRK-CYOKI-KEISAN6
                                                TO  WRK-CYOKI-KEISAN7
                             MOVE WRK-CYOKI-KEISAN6
                                          TO   RECE02-ZAITAKU-SAIKEI2
                            ELSE
                             MOVE  FTN-KOH-XX7  TO  WRK-CYOKI-KEISAN7
                            END-IF
                            IF  WRK-CYOKI-KEISAN7 > WRK-CYOKI-KEISAN3
                             COMPUTE WRK-CYOKI-KEISAN4
                                                  = WRK-CYOKI-KEISAN7
                                                  - WRK-CYOKI-KEISAN3
                            ELSE
                             MOVE  ZERO         TO  WRK-CYOKI-KEISAN4
                            END-IF
                            ADD   WRK-CYOKI-KEISAN4
                                          TO   RECE02-FTNMONEY(1)
                            IF     FLG-KOH  =   2
                              ADD WRK-CYOKI-KEISAN4
                                          TO   RECE02-FTNMONEY(2)
                                               RECE02-FTNMONEY-KOJ(2)
                            END-IF
                          ELSE
                            MOVE  WRK-CYOKI-KEISAN3
                                          TO   RECE02-ZAITAKU-SAIKEI2
                          END-IF
                      END-IF
                      IF    RECE02-ZAITAKU-SAIKEI2 = ZERO
                         MOVE     1       TO   RECE02-SAIKEIZEROKSI2
                      END-IF
                    END-IF
      *
                    IF  FLG-ZENKOKUKOHI-NISYU  =   ZERO
                      IF    WRK-CYOKI-KEISAN   <  WRK-CYOKI-KEISAN2
                      AND   WRK-CYOKI-KEISAN3  <  FTN-KOH-XX7
                        IF   FLG-ZENKOKUKOHI-NISYU4  =  2 OR 3 OR 4
                            IF  (FTN-KOH-XX7      > WRK-CYOKI-KEISAN6)
                            AND (FLG-ZENKOKUKOHI-NISYU4  =  2 OR 4   )
                             MOVE WRK-CYOKI-KEISAN6
                                                TO  WRK-CYOKI-KEISAN7
                            ELSE
                             MOVE  FTN-KOH-XX7  TO  WRK-CYOKI-KEISAN7
                            END-IF
                            IF  WRK-CYOKI-KEISAN7 > WRK-CYOKI-KEISAN3
                             COMPUTE WRK-CYOKI-KEISAN4
                                                  = WRK-CYOKI-KEISAN7
                                                  - WRK-CYOKI-KEISAN3
                            ELSE
                             MOVE  ZERO         TO  WRK-CYOKI-KEISAN4
                            END-IF
                            ADD   WRK-CYOKI-KEISAN4
                                          TO   RECE02-FTNMONEY(1)
                            IF     FLG-KOH  =   2
                              ADD WRK-CYOKI-KEISAN4
                                          TO   RECE02-FTNMONEY(2)
                                               RECE02-FTNMONEY-KOJ(2)
                            END-IF
                        END-IF
                      END-IF
                    END-IF
                   END-IF
                  END-IF
      *
                  IF   RECE02-CYOKI-KSIKBN  =  "1"
                  OR   FLG-CYOKI-HENSYU4    =   1
                    COMPUTE WRK-CYOKI-KEISAN  = RECE02-FTNMONEY(1)
                                              - WRK-KOH-GAI2
                    COMPUTE WRK-CYOKI-KEISAN2 = RECE02-ZAITAKU-SAIKEI
                                              + RECE02-ZAITAKU-SAIKEI2
                    IF   WRK-CYOKI-KEISAN   >   WRK-CYOKI-KEISAN2
                      COMPUTE WRK-CYOKI-KEISAN3 = WRK-CYOKI-KEISAN
                                                - WRK-CYOKI-KEISAN2
                    ELSE
                      MOVE    ZERO    TO    WRK-CYOKI-KEISAN3
                    END-IF
                    IF   WRK-CYOKI-KOH-FTN  >   WRK-CYOKI-KOH-FTN2
                      COMPUTE WRK-CYOKI-KOH-FTN = WRK-CYOKI-KOH-FTN
                                                - WRK-CYOKI-KOH-FTN2
                    ELSE
                      MOVE    ZERO    TO    WRK-CYOKI-KOH-FTN
                    END-IF
                    IF   WRK-CYOKI-KOH-FTN  >   WRK-CYOKI-KEISAN3
                      COMPUTE WRK-CYOKI-KEISAN4 = WRK-CYOKI-KOH-FTN
                                                - WRK-CYOKI-KEISAN3
                      IF   RECE02-CYOKI-KSIKBN  =  "1"
                        ADD     WRK-CYOKI-KEISAN4
                                      TO    RECE02-FTNMONEY(1)
                        IF   FLG-KOH  =   2
                          ADD   WRK-CYOKI-KEISAN4
                                      TO    RECE02-FTNMONEY(2)
                                            RECE02-FTNMONEY-KOJ(2)
                        END-IF
                      ELSE
                        COMPUTE  WRK-SKY-FTNMONEY-XXX =
                                 WRK-SKY-FTNMONEY-XXX +
                                 WRK-CYOKI-KEISAN4
                        DISPLAY  "6:WRK-SKY-FTNMONEY-XXX="
                                    WRK-SKY-FTNMONEY-XXX
                      END-IF
                    END-IF
                  END-IF
              END-IF
      *
              IF  (FLG-CYOKI-HENSYU        =    1  )
              AND (RECE02-ZAITAKU-SAIKEI   =   ZERO)
                IF ( RECE02-KOHNUM(1)  =  SPACE         )
                OR ((RECE02-KOHNUM(1)     NOT = SPACE  ) AND
                    (RECE02-RECESKYKBN(1) NOT = SPACE  ) AND
                    (RECE02-KOHNUM(2)  =  SPACE        ))
                OR ((RECE02-KOHNUM(1)     NOT = SPACE  ) AND
                    (RECE02-RECESKYKBN(1) NOT = SPACE  ) AND
                    (RECE02-KOHNUM(2)     NOT = SPACE  ) AND
                    (RECE02-RECESKYKBN(2) NOT = SPACE  ) AND
                    (RECE02-KOHNUM(3)  =  SPACE        ))
                OR ((RECE02-KOHNUM(1)     NOT = SPACE  ) AND
                    (RECE02-RECESKYKBN(1) NOT = SPACE  ) AND
                    (RECE02-KOHNUM(2)     NOT = SPACE  ) AND
                    (RECE02-RECESKYKBN(2) NOT = SPACE  ) AND
                    (RECE02-KOHNUM(3)     NOT = SPACE  ) AND
                    (RECE02-RECESKYKBN(3) NOT = SPACE  ) AND
                    (RECE02-KOHNUM(4)  =  SPACE        ))
                OR ((RECE02-KOHNUM(1)     NOT = SPACE  ) AND
                    (RECE02-RECESKYKBN(1) NOT = SPACE  ) AND
                    (RECE02-KOHNUM(2)     NOT = SPACE  ) AND
                    (RECE02-RECESKYKBN(2) NOT = SPACE  ) AND
                    (RECE02-KOHNUM(3)     NOT = SPACE  ) AND
                    (RECE02-RECESKYKBN(3) NOT = SPACE  ) AND
                    (RECE02-KOHNUM(4)     NOT = SPACE  ) AND
                    (RECE02-RECESKYKBN(4) NOT = SPACE  ))
                  CONTINUE
                ELSE
                  MOVE    1    TO    RECE02-SAIKEIZEROKSI1
                END-IF
              END-IF
           END-IF
           IF      RECE02-SRYYM           >=  "200804"
             IF    RECE02-ZAITAKU-SAIKEI   =   ZERO
             AND   RECE02-SAIKEIZEROKSI1   =   ZERO
               IF  (  RECE02-ZAITAKU            = "1" OR "2"       )
               AND (  FLG-ZENKOKUKOHI-NISYU     = ZERO             )
               AND (((RECE02-KOHNUM(1)      NOT = SPACE          ) AND
                     (RECE02-KOHNUM(1)      NOT = "972" AND "974") AND
                     (RECE02-TOTALTEN(2)        = ZERO           ) AND
                     (RECE02-FTNMONEY(1)    NOT = ZERO           ))  OR
                    ((RECE02-KOHNUM(1)          = "972" OR "974" ) AND
                     (RECE02-KOHNUM(2)      NOT = SPACE          ) AND
                     (RECE02-KOHNUM(2)      NOT = "972" AND "974") AND
                     (RECE02-TOTALTEN(3)        = ZERO           ) AND
                     (RECE02-FTNMONEY(1)    NOT = ZERO           )))
                  MOVE      1           TO  RECE02-SAIKEIZEROKSI1
               ELSE
                  MOVE     999999999    TO  RECE02-ZAITAKU-SAIKEI
               END-IF
             END-IF
             IF    RECE02-ZAITAKU-SAIKEI2  =   ZERO
             AND   RECE02-SAIKEIZEROKSI2   =   ZERO
                IF   FLG-ZENKOKUKOHI-NISYU =  1 OR 2 OR 3 OR 4 OR
                                              5 OR 8 OR 9
                  MOVE      1           TO  RECE02-SAIKEIZEROKSI2
                ELSE
                  MOVE     999999999    TO  RECE02-ZAITAKU-SAIKEI2
                END-IF
             END-IF
             MOVE          999999999    TO  RECE02-ZAITAKU-SAIKEI3
             MOVE          999999999    TO  RECE02-ZAITAKU-SAIKEI4
      *
             IF      RECE02-ZAITAKU-SAIKEI     = 999999999
               IF ((RECE02-SAIKEIZEROKSI2      = 1                 ) AND
                   (RECE02-ZAITAKU-SAIKEI2 NOT = 999999999         ))
               OR ((RECE02-SAIKEIZEROKSI2      = ZERO              ) AND
                   (RECE02-ZAITAKU-SAIKEI2 NOT = 999999999 AND ZERO))
                  MOVE     ZERO         TO  RECE02-ZAITAKU-SAIKEI
                  MOVE      1           TO  RECE02-SAIKEIZEROKSI1
               END-IF
             END-IF
           END-IF
      *
           IF      RECE02-RJNGENMENKBN   =   "1"
      *
               COMPUTE  WRK-CHK-KEISAN1 = WRK-KOH-FTN         +  5
               COMPUTE  WRK-CHK-KEISAN1 = WRK-CHK-KEISAN1     / 10
               COMPUTE  WRK-CHK-KEISAN1 = WRK-CHK-KEISAN1     * 10
      *
               COMPUTE  WRK-CHK-KEISAN2 = WRK-CHK-KOHFTNGAKU  +  5
               COMPUTE  WRK-CHK-KEISAN2 = WRK-CHK-KEISAN2     / 10
               COMPUTE  WRK-CHK-KEISAN2 = WRK-CHK-KEISAN2     * 10
      *
               COMPUTE  WRK-CHK-KEIKASOCHIXX
                                  =   WRK-KOH-GAI2  +  WRK-CHK-KEISAN1
      *
               MOVE          12000    TO    WRK-CHK-KINGAKU
               IF    FLG-CYOKI   =    1
                   MOVE      10000    TO    WRK-CHK-KINGAKU2
               ELSE
                   MOVE      12000    TO    WRK-CHK-KINGAKU2
               END-IF
               MOVE          12000    TO    WRK-CHK-KINGAKU3
      *
               COMPUTE  WRK-CHK-KEIKASOCHI1  =  WRK-CHK-KINGAKU -
                                               (WRK-CHK-FTNGAKU +
                                                WRK-CHK-KEISAN2)
               COMPUTE  WRK-CHK-KEIKASOCHI2  =  WRK-CHK-KINGAKU2 -
                                                WRK-CHK-ICHIBUGAKU
               COMPUTE  WRK-CHK-KEIKASOCHI3  =  WRK-CHK-KINGAKU3 -
                                                WRK-CHK-ICHIBUGAKU
               IF   WRK-CHK-KEIKASOCHI1  <   ZERO
                    MOVE   ZERO    TO   WRK-CHK-KEIKASOCHI1
               END-IF
               IF   WRK-CHK-KEIKASOCHI2  <   ZERO
                    MOVE   ZERO    TO   WRK-CHK-KEIKASOCHI2
               END-IF
               IF   WRK-CHK-KEIKASOCHI3  <   ZERO
                    MOVE   ZERO    TO   WRK-CHK-KEIKASOCHI3
               END-IF
               IF   FLG-ZENKOH-ARI  =  ZERO
                 IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                 OR  (FTN-KOH-XXX           >=  WRK-CHK-KEIKASOCHI3)
                      MOVE    4    TO      FLG-TOKKI
                      PERFORM   21045-TOKKI-HENSYU-SEC
                 END-IF
               ELSE
                 IF  FLG-RJNGENMEN-CHIARI    =  ZERO
                   IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                   OR  (FTN-KOH-XXX           >=  WRK-CHK-KEIKASOCHI2)
                   OR  (FTN-KOH-XX3           >=  WRK-CHK-KEIKASOCHI2)
                      MOVE    4    TO      FLG-TOKKI
                      PERFORM   21045-TOKKI-HENSYU-SEC
                   END-IF
                 ELSE
                   IF  (WRK-CHK-KEIKASOCHIXX  >=  WRK-CHK-KEIKASOCHI1)
                   OR  (FTN-KOH-XXX           >=  WRK-CHK-KEIKASOCHI2)
                   OR  (FTN-KOH-XX3           >=  WRK-CHK-KEIKASOCHI2)
                   OR  (FTN-KOH-XX2           >=  WRK-CHK-KEIKASOCHI3)
                   OR  (FTN-KOH-XX4           >=  WRK-CHK-KEIKASOCHI3)
                      MOVE    4    TO      FLG-TOKKI
                      PERFORM   21045-TOKKI-HENSYU-SEC
                   END-IF
                 END-IF
               END-IF
               IF   WK-GENGAKUKBN    NOT =   ZERO
                      MOVE    4    TO      FLG-TOKKI
                      PERFORM   21045-TOKKI-HENSYU-SEC
               END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN   =   ZERO
      *
            IF      RECE02-SRYYM      >=  "200210"
             IF  (RECE02-ZAITAKU       =  "1" OR "2")
             AND (RECE02-KOHNUM(1)     =  SPACE     )
             AND (RECE02-KOHNUM(2)     =  SPACE     )
             AND (RECE02-KOHNUM(3)     =  SPACE     )
             AND (RECE02-KOHNUM(4)     =  SPACE     )
             AND (FLG-HOKENICHIBU  NOT =  ZERO      )
                 MOVE     WRK-TAIHI-TOTALTEN  TO  WRK-HANTEI-TOTALTEN
                 IF   FLG-ZEROKOGAITO  =   1
                   PERFORM  21094X-JYOGENGAKU-HENSYU2-SEC
                 ELSE
                   PERFORM  21094-JYOGENGAKU-HENSYU-SEC
                 END-IF
                 IF     RECE02-FTNMONEY(1)   >  WRK-KINGAKU3
                       COMPUTE  WRK-SKY-FTNMONEY-XXX =
                                WRK-SKY-FTNMONEY-XXX +
                               (RECE02-FTNMONEY(1)   -  WRK-KINGAKU3)
                       DISPLAY  "1:WRK-SKY-FTNMONEY-XXX="
                                   WRK-SKY-FTNMONEY-XXX
      *                地方公費がレセプト請求でない場合の対処
                       IF   RECE02-SRYYM   >=  "202001"
                         COMPUTE  WRK-SKY-FTNMONEY-XX2 =
                                  WRK-SKY-FTNMONEY-XX2 +
                                 (RECE02-FTNMONEY(1)   -  WRK-KINGAKU3)
                         DISPLAY  "1:WRK-SKY-FTNMONEY-XX2="
                                     WRK-SKY-FTNMONEY-XX2
                       END-IF
                       MOVE   WRK-KINGAKU3   TO  RECE02-FTNMONEY(1)
                       IF   RECE02-RJNGENMENKBN   =   "1"
                          MOVE    4    TO      FLG-TOKKI
                          PERFORM   21045-TOKKI-HENSYU-SEC
                       END-IF
                 END-IF
             END-IF
      *
             IF  (RECE02-ZAITAKU         = "1" OR "2"        )
             AND (((RECE02-KOHNUM(1)(1:1) = "0"            ) AND
                   (RECE02-KOHNUM(1)  NOT = "012" AND "025"))  OR
                  ( TBL-TOKATUKAIFLG(1)   =  1              ))
             AND (RECE02-KOHNUM(2)       = SPACE             )
             AND (RECE02-KOHNUM(3)       = SPACE             )
             AND (RECE02-KOHNUM(4)       = SPACE             )
             AND (RECE02-HKNCOMBI(2) NOT = ZERO              )
             AND (WRK-TAIHI-TOTALTEN NOT = RECE02-TOTALTEN(2))
             AND (RECE02-TOTALTEN(2) NOT = ZERO              )
             AND ((FLG-HOKENICHIBU2  NOT = ZERO             )  OR
                  (FLG-HOKENICHIBU3  NOT = ZERO             ))
                 MOVE     ZERO    TO   FLG-CHIIKI
                 MOVE     1       TO   FLG-CHIIKIX
                 PERFORM  21096-HOKEN-ICHIBUFTN-CHK-SEC
             END-IF
      *
      ***    IF  (RECE02-ZAITAKU         = "1" OR "2"        )
      ***    AND (((RECE02-KOHNUM(1)(1:1) = "0"            ) AND
      ***          (RECE02-KOHNUM(1)  NOT = "012" AND "025"))  OR
      ***         ( TBL-TOKATUKAIFLG(1)   =  1              ))
      ***    AND (RECE02-KOHNUM(2)(1:1) >= "1" AND <= "8"    )
      ***    AND (TBL-TOKATUKAIFLG(2)    = ZERO              )
      ***    AND (RECE02-KOHNUM(3)       = SPACE             )
      ***    AND (RECE02-KOHNUM(4)       = SPACE             )
      ***    AND (RECE02-HKNCOMBI(2) NOT = ZERO              )
      ***    AND (WRK-TAIHI-TOTALTEN NOT = RECE02-TOTALTEN(2))
      ***    AND (RECE02-TOTALTEN(2) NOT = ZERO              )
      ***    AND (FLG-HOKENICHIBU2   NOT = ZERO              )
      ***    AND (FLG-HOKENICHIBU3       = ZERO              )
      ***    AND (FLG-HOKENICHIBU-SYU    =  1                )
      ***        MOVE     ZERO    TO   FLG-CHIIKI
      ***        MOVE     ZERO    TO   FLG-CHIIKIX
      ***        PERFORM  21096-HOKEN-ICHIBUFTN-CHK-SEC
      ***    END-IF
      *
             COMPUTE  WRK-CHK-KOKIGAK4  = RECE02-TOTALTEN(2)
                                        + RECE02-HENTOTALTEN(3)
             COMPUTE  WRK-CHK-KOKIGAK   = WRK-TAIHI-TOTALTEN
                                        - WRK-JYOGENKBN-TEN6
             IF  (RECE02-ZAITAKU         =  "2"              )
             AND (FLG-JIRITU-CYUKANSOU1  =   1               )
             AND (FLG-JIRITU-CYUKANSOU2  =   1               )
             AND (WRK-CHK-KOKIGAK        =   WRK-CHK-KOKIGAK4)
               MOVE   WRK-CHK-KOKIGAK   TO   WRK-HANTEI-TOTALTEN
               PERFORM  21094X-JYOGENGAKU-HENSYU2-SEC
               IF     WRK-KINGAKU-GENBUTU3  >  RECE02-ZAITAKU-SAIKEI
                 COMPUTE  WRK-CHK-KOKIGAK2   =  WRK-KINGAKU-GENBUTU3
                                             -  RECE02-ZAITAKU-SAIKEI
                 COMPUTE  WRK-CHK-KOKIGAK10  =  RECE02-ZAITAKU-SAIKEI2
                                             -  WRK-CHK-KOKIGAK2
                 MOVE     WRK-CHK-KOKIGAK2  TO  RECE02-ZAITAKU-SAIKEI2
                 COMPUTE  RECE02-FTNMONEY(1) =  RECE02-FTNMONEY(1)
                                             -  WRK-CHK-KOKIGAK10
               END-IF
             END-IF
      *
             IF  (RECE02-ZAITAKU         = "2"               )
             AND (RECE02-KOHNUM(1)
                             =  "015"  OR  "016"  OR  "021"  )
             AND (TBL-HKNFTNDATA-JGNXXX(1)
                                         = 9999999 OR 999999 )
             AND (RECE02-KOHNUM(2)       = SPACE             )
             AND (RECE02-KOHNUM(3)       = SPACE             )
             AND (RECE02-KOHNUM(4)       = SPACE             )
             AND (RECE02-HKNCOMBI(2) NOT = ZERO              )
             AND (WRK-TAIHI-TOTALTEN NOT = RECE02-TOTALTEN(2))
             AND (RECE02-TOTALTEN(2) NOT = ZERO              )
             AND (FLG-HOKENICHIBU2       = ZERO              )
             AND (FLG-HOKENICHIBU3       = ZERO              )
             AND (FLG-HOKENICHIBU7       =  1                )
             AND (FLG-HOKENICHIBU-SYU    =  1                )
                 MOVE     ZERO    TO   FLG-CHIIKI
                 MOVE     ZERO    TO   FLG-CHIIKIX
                 PERFORM  21096-HOKEN-ICHIBUFTN-CHK-SEC
             END-IF
      *
             COMPUTE  WRK-CHK-KOKIGAK4 = RECE02-TOTALTEN(2)
                                       + RECE02-HENTOTALTEN(3)
             IF  (RECE02-ZAITAKU          = "1" OR "2"        )
             AND (((RECE02-KOHNUM(1)(1:1) = "0"            ) AND
                   (RECE02-KOHNUM(1)  NOT = "012" AND "025"))  OR
                  ( TBL-TOKATUKAIFLG(1)   =  1              ) )
             AND (RECE02-KOHNUM(2)(1:1)  >= "1" AND <= "8"    )
             AND (TBL-TOKATUKAIFLG(2)     = ZERO              )
             AND (RECE02-KOHNUM(3)        = SPACE             )
             AND (RECE02-KOHNUM(4)        = SPACE             )
             AND (RECE02-HKNCOMBI(2)  NOT = ZERO              )
             AND (WRK-TAIHI-TOTALTEN  NOT = RECE02-TOTALTEN(2))
             AND (RECE02-TOTALTEN(2)  NOT = ZERO              )
             AND ((WRK-TAIHI-TOTALTEN   =  WRK-CHK-KOKIGAK4 ) OR
                  (WRK-TAIHI-TOTALTEN   =
                                       RECE02-HENTOTALTEN(3)) )
             AND (FLG-ZENKOKUKOHI-NISYU4  =  1                )
                 MOVE     1       TO   FLG-CHIIKI
                 MOVE     ZERO    TO   FLG-CHIIKIX
                 PERFORM  21096-HOKEN-ICHIBUFTN-CHK-SEC
             END-IF
            END-IF
      *
            IF  (RECE02-ZAITAKU          =  "1")
            AND (RECE02-GNBKEIKBN-K-G(2) =  "2")
                 IF  (RECE02-KOHNUM(1)(1:1) >= "1" AND <= "8"    )
                 AND (RECE02-KOHNUM(2)       =  SPACE            )
                 AND (RECE02-KOHNUM(3)       =  SPACE            )
                 AND (RECE02-KOHNUM(4)       =  SPACE            )
                 AND (WRK-TAIHI-TOTALTEN NOT = RECE02-TOTALTEN(2))
                 AND (RECE02-TOTALTEN(2) NOT = ZERO              )
                   MOVE     WRK-TAIHI-TOTALTEN  TO  WRK-HANTEI-TOTALTEN
                   PERFORM  21094-JYOGENGAKU-HENSYU-SEC
                   IF   RECE02-FTNMONEY(1)  >  WRK-KINGAKU3
                     COMPUTE  WRK-CHK-KOKIGAK = RECE02-FTNMONEY(1)
                                              - WRK-KINGAKU3
                     MOVE   WRK-KINGAKU3   TO  RECE02-FTNMONEY(1)
                     IF RECE02-ZAITAKU-SAIKEI > WRK-CHK-KOKIGAK
                       COMPUTE  RECE02-ZAITAKU-SAIKEI =
                                RECE02-ZAITAKU-SAIKEI - WRK-CHK-KOKIGAK
                     ELSE
                       MOVE     ZERO       TO  RECE02-ZAITAKU-SAIKEI
                       MOVE      1         TO  RECE02-SAIKEIZEROKSI1
                     END-IF
                   END-IF
                 END-IF
            END-IF
      *
            EVALUATE   SYS-1001-PREFNUM
      *      群馬県地方公費
             WHEN    "10"
               IF  (RECE02-SRYYM        >=  "200804"  )
               AND (RECE02-TEISYUTUSAKI  =   2  OR  6 )
               AND (RECE02-ZAITAKU       =  "1" OR "2")
                 IF  (RECE02-KOHNUM(1)(1:1) >= "1" AND <= "8"    )
                 AND (RECE02-KOHNUM(2)       =  SPACE            )
                 AND (RECE02-KOHNUM(3)       =  SPACE            )
                 AND (RECE02-KOHNUM(4)       =  SPACE            )
                 AND (WRK-TAIHI-TOTALTEN NOT = RECE02-TOTALTEN(2))
                 AND (RECE02-TOTALTEN(2) NOT = ZERO              )
                   MOVE     WRK-TAIHI-TOTALTEN  TO  WRK-HANTEI-TOTALTEN
                   PERFORM  21094-JYOGENGAKU-HENSYU-SEC
                   IF   RECE02-FTNMONEY(1)  >  WRK-KINGAKU3
                     COMPUTE   WRK-SKY-KEISAN3 = WRK-KINGAKU3
                                               / 2
                     COMPUTE   WRK-SKY-KEISAN4 = RECE02-ZAITAKU-SAIKEI
                                               - WRK-SKY-KEISAN3
                     COMPUTE   WRK-SKY-FTNMONEY-XXX =
                               WRK-SKY-FTNMONEY-XXX +
                             ((RECE02-FTNMONEY(1)   -  WRK-KINGAKU3)
                                                    -  WRK-SKY-KEISAN4)
                     DISPLAY   "2:WRK-SKY-FTNMONEY-XXX="
                                  WRK-SKY-FTNMONEY-XXX
                     MOVE   WRK-KINGAKU3   TO  RECE02-FTNMONEY(1)
                     IF   RECE02-RJNGENMENKBN   =   "1"
                       MOVE    4    TO      FLG-TOKKI
                       PERFORM   21045-TOKKI-HENSYU-SEC
                     END-IF
                   END-IF
                   MOVE  999999999  TO   RECE02-ZAITAKU-SAIKEI
                 END-IF
               END-IF
      *      愛媛県地方公費
             WHEN    "38"
               IF  (RECE02-SRYYM        >=  "200804"  )
               AND (RECE02-TEISYUTUSAKI  =   2  OR  6 )
               AND (RECE02-ZAITAKU       =  "1" OR "2")
                 IF  (RECE02-KOHNUM(1)(1:1) >= "1" AND <= "8"    )
                 AND (RECE02-KOHNUM(2)       =  SPACE            )
                 AND (RECE02-KOHNUM(3)       =  SPACE            )
                 AND (RECE02-KOHNUM(4)       =  SPACE            )
                 AND (WRK-TAIHI-TOTALTEN NOT = RECE02-TOTALTEN(2))
                 AND (RECE02-TOTALTEN(2) NOT = ZERO              )
                   MOVE     WRK-TAIHI-TOTALTEN  TO  WRK-HANTEI-TOTALTEN
                   PERFORM  21094-JYOGENGAKU-HENSYU-SEC
                   IF   RECE02-FTNMONEY(1)  >  WRK-KINGAKU3
                     COMPUTE  WRK-CHK-KOKIGAK = RECE02-FTNMONEY(1)
                                              - WRK-KINGAKU3
                     MOVE   WRK-KINGAKU3   TO  RECE02-FTNMONEY(1)
                     IF RECE02-ZAITAKU-SAIKEI > WRK-CHK-KOKIGAK
                       COMPUTE  RECE02-ZAITAKU-SAIKEI =
                                RECE02-ZAITAKU-SAIKEI - WRK-CHK-KOKIGAK
                     ELSE
                       MOVE     ZERO       TO  RECE02-ZAITAKU-SAIKEI
                       MOVE      1         TO  RECE02-SAIKEIZEROKSI1
                     END-IF
                   END-IF
                 END-IF
                 IF  (RECE02-KOHNUM(1)       = "972" OR "974"    )
                 AND (RECE02-KOHNUM(2)(1:1) >= "1" AND <= "8"    )
                 AND (RECE02-KOHNUM(3)       =  SPACE            )
                 AND (RECE02-KOHNUM(4)       =  SPACE            )
                 AND (WRK-TAIHI-TOTALTEN     = RECE02-TOTALTEN(2))
                 AND (WRK-TAIHI-TOTALTEN NOT = RECE02-TOTALTEN(3))
                 AND (RECE02-TOTALTEN(3) NOT = ZERO              )
                 AND (FLG-CYOKI-HENSYU       = ZERO              )
                   EVALUATE   RECE02-ZAITAKU
                     WHEN      "1"
                       IF   RECE02-KOHNUM(1) = "972"
                         IF     (RECE02-TEISYOTOKU  NOT =  SPACE)
      *****              AND    (FLG-CYOKI-CHECK        =  ZERO )
                           IF  FLG-TOKU75 = 1 OR 2
                             MOVE    4000   TO   WRK-KINGAKU3
                           ELSE
                             MOVE    8000   TO   WRK-KINGAKU3
                           END-IF
                         ELSE
                           IF  FLG-TOKU75 = 1 OR 2
                             MOVE    5000   TO   WRK-KINGAKU3
                           ELSE
                             MOVE    10000  TO   WRK-KINGAKU3
                           END-IF
                         END-IF
                       ELSE
                           IF  FLG-TOKU75 = 1 OR 2
                             MOVE    10000  TO   WRK-KINGAKU3
                           ELSE
                             MOVE    20000  TO   WRK-KINGAKU3
                           END-IF
                       END-IF
                     WHEN      "2"
                       IF   RECE02-KOHNUM(1) = "972"
                           IF  FLG-TOKU75 = 3
                             MOVE     5000  TO   WRK-KINGAKU3
                           ELSE
                             MOVE    10000  TO   WRK-KINGAKU3
                           END-IF
                       ELSE
                           IF  FLG-TOKU75 = 3
                             MOVE    10000  TO   WRK-KINGAKU3
                           ELSE
                             MOVE    20000  TO   WRK-KINGAKU3
                           END-IF
                       END-IF
                   END-EVALUATE
                   IF   RECE02-FTNMONEY(1)  =  WRK-KINGAKU3
                     COMPUTE  WRK-CHK-KOKIGAK = 
                          (WRK-TAIHI-TOTALTEN - RECE02-TOTALTEN(3))
                                              * 10
                                              * RECE02-KYURATE
                                              / 100
                     COMPUTE  WRK-CHK-KOKIGAK = WRK-CHK-KOKIGAK +  5
                     COMPUTE  WRK-CHK-KOKIGAK = WRK-CHK-KOKIGAK / 10
                     COMPUTE  WRK-CHK-KOKIGAK = WRK-CHK-KOKIGAK * 10
                     IF  RECE02-ZAITAKU-SAIKEI > WRK-CHK-KOKIGAK
                       COMPUTE  RECE02-ZAITAKU-SAIKEI =
                                RECE02-ZAITAKU-SAIKEI - WRK-CHK-KOKIGAK
                     ELSE
                       MOVE   ZERO            TO  RECE02-ZAITAKU-SAIKEI
                       MOVE    1              TO  RECE02-SAIKEIZEROKSI1
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *      東京都地方公費
             WHEN    "13"
               IF  (RECE02-SRYYM        >=  "200804"  )
               AND (RECE02-TEISYUTUSAKI  =   2  OR  6 )
               AND (RECE02-ZAITAKU       =  "1" OR "2")
                 IF  (RECE02-KOHNUM(1)(1:1) >= "1" AND <= "8"    )
                 AND (TBL-TOKATUKAIFLG(1)    =  ZERO             )
      ***********IF  (RECE02-KOHNUM(1)   =  "282"                )
                 AND (RECE02-KOHNUM(2)   =  SPACE                )
                 AND (RECE02-KOHNUM(3)   =  SPACE                )
                 AND (RECE02-KOHNUM(4)   =  SPACE                )
                 AND (WRK-TAIHI-TOTALTEN NOT = RECE02-TOTALTEN(2))
                 AND (RECE02-TOTALTEN(2) NOT = ZERO              )
                   MOVE     WRK-TAIHI-TOTALTEN  TO  WRK-HANTEI-TOTALTEN
                   PERFORM  21094-JYOGENGAKU-HENSYU-SEC
                   IF   RECE02-FTNMONEY(1)  >  WRK-KINGAKU3
                     COMPUTE  WRK-SKY-FTNMONEY-XXX =
                              WRK-SKY-FTNMONEY-XXX +
                             (RECE02-FTNMONEY(1)   -  WRK-KINGAKU3)
                     DISPLAY  "3:WRK-SKY-FTNMONEY-XXX="
                                 WRK-SKY-FTNMONEY-XXX
                     MOVE   WRK-KINGAKU3   TO  RECE02-FTNMONEY(1)
      ***************IF RECE02-FTNMONEY(1)  >  RECE02-ZAITAKU-SAIKEI
      ***************   CONTINUE
      ***************ELSE
      ***************   MOVE   999999999   TO  RECE02-ZAITAKU-SAIKEI
      ***************END-IF
                     IF   RECE02-RJNGENMENKBN   =   "1"
                       MOVE    4    TO      FLG-TOKKI
                       PERFORM   21045-TOKKI-HENSYU-SEC
                     END-IF
                   END-IF
                 END-IF
               END-IF
            END-EVALUATE
      *
      *     保険欄の括弧再掲（下）金額加算
            PERFORM       21099-SAIKEIKIN-KASAN-SEC
      *
           ELSE
      *
            IF   (WK-GENGAKUKBN   =   3  OR  4)
            AND  (RECE02-SRYYM   >=   "201101")
            AND  (IDZ             =   1       )
              IF   RECE02-ZAITAKU       =  "1" OR "2"
                 MOVE     ZERO        TO   RECE02-FTNMONEY(1)
                 MOVE     999999999   TO   RECE02-ZAITAKU-SAIKEI
                 MOVE     999999999   TO   RECE02-ZAITAKU-SAIKEI2
              END-IF
            END-IF
      *
           END-IF
      *
           IF   WK-GENGAKUKBN   =   ZERO
           AND  RECE02-SRYYM   >=  "200210"
      *
             COMPUTE  WRK-CHK-KOKIGAK4  = RECE02-TOTALTEN(2)
                                        + RECE02-HENTOTALTEN(3)
             COMPUTE  WRK-CHK-KOKIGAK   = WRK-TAIHI-TOTALTEN
                                        - WRK-JYOGENKBN-TEN6
             IF  (RECE02-ZAITAKU         =  SPACE            )
             AND (FLG-JIRITU-CYUKANSOU1  =   1               )
             AND (FLG-JIRITU-CYUKANSOU2  =   1               )
             AND (WRK-CHK-KOKIGAK        =   WRK-CHK-KOKIGAK4)
               MOVE   WRK-CHK-KOKIGAK   TO   WRK-HANTEI-TOTALTEN
               PERFORM  21094X-JYOGENGAKU-HENSYU2-SEC
               IF     WRK-KINGAKU-GENBUTU3  >  WRK-JIRITU-SAIKEI
                 COMPUTE  WRK-CHK-KOKIGAK2     =  WRK-KINGAKU-GENBUTU3
                                               -  WRK-JIRITU-SAIKEI
                 COMPUTE  WRK-CHK-KOKIGAK10    =  WRK-JIRITU-SAIKEI2
                                               -  WRK-CHK-KOKIGAK2
                 COMPUTE  RECE02-FTNMONEY-SKY  =  RECE02-FTNMONEY-SKY
                                               -  WRK-CHK-KOKIGAK10
               END-IF
             END-IF
      *
           END-IF
      *
           IF   (IDZ               =     1      )
           AND  (RECE02-SRYYM     >=  "201004"  )
           AND  (RECE02-ZAITAKU    =  "1" OR "2")
             MOVE   RECE02-FTNMONEY(1)   TO   RECE02-FTNMONEY-SKY
             IF     RECE02-ZAITAKU-SAIKEI  =  999999999
               MOVE   ZERO               TO   WRK-SAIKEI-TAIHI
             ELSE
               MOVE   RECE02-ZAITAKU-SAIKEI
                                         TO   WRK-SAIKEI-TAIHI
             END-IF
           END-IF
      *
           .
       2109-SAIKEI-KEISAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    公費併用時の計算処理（７０歳未満）
      *****************************************************************
       21091-KOHIHEIYO-KEISAN-SEC               SECTION.
      *
           EVALUATE   FLG-GENBUTU70
             WHEN        1
             WHEN        2
               IF  FLG-TOKU75 = 3
                MOVE    22200   TO   WRK-KEISAN-XXX
               ELSE
                MOVE    44400   TO   WRK-KEISAN-XXX
               END-IF
             WHEN        3
               IF  FLG-TOKU75 = 3
                MOVE    12300   TO   WRK-KEISAN-XXX
               ELSE
                MOVE    24600   TO   WRK-KEISAN-XXX
               END-IF
           END-EVALUATE
      *
           MOVE     1      TO     KOHFTN-IDX
           MOVE    ZERO    TO     WRK-KEISAN9
      *
      ***  PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
      ***              UNTIL    KOHFTN-IDX     >    4
      *
             IF    RECE02-KOHNUM(KOHFTN-IDX) = "010" OR "015" OR "016"
                                            OR "021" OR "024" OR "079"
                                            OR "038"
               IF  RECE02-FTNMONEY(KOHFTN-IDX + 1)  <  WRK-KEISAN-XXX
                CONTINUE
               ELSE
                EVALUATE  RECE02-KOHNUM(KOHFTN-IDX)
                 WHEN      "010"
                    COMPUTE WRK-KEISAN1 =
                            RECE02-TOTALTEN(KOHFTN-IDX + 1) * 10
                    IF  FLG-TOKU75 = 3
                     IF  WRK-KEISAN1  >  967890
                       COMPUTE WRK-KEISAN2 =
                            (( WRK-KEISAN1 - 133500 ) * 0.01 ) + 0.5
                       COMPUTE WRK-KEISAN3 = 40050 + WRK-KEISAN2
                     ELSE
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.05
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                     END-IF
                    ELSE
                     IF  WRK-KEISAN1  >  1935690
                       COMPUTE WRK-KEISAN2 =
                            (( WRK-KEISAN1 - 267000 ) * 0.01 ) + 0.5
                       COMPUTE WRK-KEISAN3 = 80100 + WRK-KEISAN2
                     ELSE
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.05
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
                       COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                     END-IF
                    END-IF
                    IF   WRK-KEISAN3  >  WRK-KEISAN-XXX
                       COMPUTE WRK-KEISAN9 = WRK-KEISAN3
                                           - WRK-KEISAN-XXX
                    ELSE
                       MOVE    ZERO     TO   WRK-KEISAN9
                    END-IF
                    ADD    WRK-KEISAN9  TO   WRK-KEISAN-YYY
                 WHEN      "015"
                 WHEN      "016"
                 WHEN      "021"
                    PERFORM  21111-KOHFTN-KINGAKU-SEC
                    IF   WRK-GAIJGNGAK  =  9999999 OR 999999
                      COMPUTE WRK-KEISAN1 =
                              RECE02-TOTALTEN(KOHFTN-IDX + 1) * 10
                      IF  FLG-TOKU75 = 3
                       IF  WRK-KEISAN1 >  430140
                         COMPUTE WRK-KEISAN2 =
                              (( WRK-KEISAN1 - 133500 ) * 0.01 ) + 0.5
                         COMPUTE WRK-KEISAN3 = 40050 + WRK-KEISAN2
                       ELSE
                         COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.1
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                       END-IF
                      ELSE
                       IF  WRK-KEISAN1 >  860340
                         COMPUTE WRK-KEISAN2 =
                              (( WRK-KEISAN1 - 267000 ) * 0.01 ) + 0.5
                         COMPUTE WRK-KEISAN3 = 80100 + WRK-KEISAN2
                       ELSE
                         COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.1
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
      ***                COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                       END-IF
                      END-IF
                      IF   WRK-KEISAN3  >  WRK-KEISAN-XXX
                         COMPUTE WRK-KEISAN9 = WRK-KEISAN3
                                             - WRK-KEISAN-XXX
                      ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                      END-IF
                    ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                    END-IF
                    ADD      WRK-KEISAN9  TO   WRK-KEISAN-YYY
                 WHEN      "024"
                 WHEN      "079"
                    PERFORM  21111-KOHFTN-KINGAKU-SEC
                    IF   WRK-GAIJGNGAK  >  WRK-KEISAN-XXX
                      COMPUTE WRK-KEISAN1 =
                              RECE02-TOTALTEN(KOHFTN-IDX + 1) * 10
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * 0.1
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                      IF      WRK-KEISAN3 > WRK-GAIJGNGAK
                         MOVE  WRK-GAIJGNGAK  TO  WRK-KEISAN3
                      END-IF
                      IF   WRK-KEISAN3  >  WRK-KEISAN-XXX
                         COMPUTE WRK-KEISAN9 = WRK-KEISAN3
                                             - WRK-KEISAN-XXX
                      ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                      END-IF
                    ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                    END-IF
                    ADD      WRK-KEISAN9  TO   WRK-KEISAN-YYY
                 WHEN      "038"
                    PERFORM  21111-KOHFTN-KINGAKU-SEC
                    IF   WRK-GAIJGNGAK  >  WRK-KEISAN-XXX
                      COMPUTE WRK-KEISAN1 =
                              RECE02-TOTALTEN(KOHFTN-IDX + 1) * 10
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN1 * RECE02-KYURATE
                                                        / 100
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 +  5
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 / 10
                      COMPUTE WRK-KEISAN3 = WRK-KEISAN3 * 10
                      IF      WRK-KEISAN3 > WRK-GAIJGNGAK
                         MOVE  WRK-GAIJGNGAK  TO  WRK-KEISAN3
                      END-IF
                      IF   WRK-KEISAN3  >  WRK-KEISAN-XXX
                         COMPUTE WRK-KEISAN9 = WRK-KEISAN3
                                             - WRK-KEISAN-XXX
                      ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                      END-IF
                    ELSE
                         MOVE    ZERO     TO   WRK-KEISAN9
                    END-IF
                    ADD      WRK-KEISAN9  TO   WRK-KEISAN-YYY
                END-EVALUATE
               END-IF
             END-IF
      *
      ***  END-PERFORM
      *
           .
       21091-KOHIHEIYO-KEISAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    減免公費対応
      *****************************************************************
       21092-GENGAKU-OKIKAE-SEC               SECTION.
      *
           MOVE      1       TO     FLG-GENGAKU-OKIKAE
           MOVE      1       TO     IDX10
           PERFORM   211F1-JGNGAK-SET-SEC
      *
      *    公費上限
           MOVE      ZERO         TO   WRK-JYOGEN-KOH
                                       WRK-JYOGEN-KOH9
                                       WRK-JIRITU-TAFTNRUIKEI
                                       WRK-JIRITU-CYUKANSOU
           MOVE      ZERO         TO   FLG-IRYOHI70K
           MOVE      ZERO         TO   FLG-KOUGAKUCYO-GEN70K
      *
           IF    RECE02-KOHNUM(1)    =  "010"
             IF   RECE02-ZAITAKU   =   "1"
                MOVE   WRK-KOH-GENDOGAKU    TO  WRK-JYOGEN-KOH
             END-IF
             IF  FLG-GENBUTU70   NOT =  ZERO
                MOVE   WRK-GEN70-GENDOGAKU  TO  WRK-JYOGEN-KOH
                EVALUATE  WRK-GEN70-GENDOGAKU
                  WHEN       80100
                  WHEN       40050
                     MOVE  1      TO   FLG-IRYOHI70K
                END-EVALUATE
             END-IF
             IF   RECE02-HOTEIGAIFLG(2) = "1"
                MOVE   ZERO                 TO  WRK-JYOGEN-KOH
                MOVE   ZERO                 TO  FLG-IRYOHI70K
             END-IF
           ELSE
             INITIALIZE                     LNK-ORCSJGNGET-REC
             MOVE   RECE02-HOSPNUM      TO  LNK-ORCSJGNGET-HOSPNUM
             MOVE   RECE02-NYUGAIKBN    TO  LNK-ORCSJGNGET-NYUGAIKBN
             MOVE   RECE02-PTID         TO  LNK-ORCSJGNGET-PTID
             MOVE   RECE02-KOHNUM(1)    TO  LNK-ORCSJGNGET-KOHHKNNUM
             MOVE   RECE02-KOHID(1)     TO  LNK-ORCSJGNGET-KOHID
             MOVE   RECE02-SRYYM        TO  LNK-ORCSJGNGET-SRYYM
             IF     RECE02-KOHNUM(1)(1:1) >=  "1" AND <=  "8"
               MOVE   WRK-KOHJGNGET-TAISYOKBN(1)
                                        TO  LNK-ORCSJGNGET-SETKBN
               MOVE   WRK-KOHJGNGET-TEKIYOFLG(1)
                                        TO  LNK-ORCSJGNGET-SETKBN2
             END-IF
      *
             CALL    "ORCSJGNGET"       USING
                                        LNK-ORCSJGNGET-REC
                                        SPA-AREA
      *
             IF     LNK-ORCSJGNGET-RC   =   ZERO
               MOVE    LNK-ORCSJGNGET-GAIJGNGAK
                                        TO  WRK-JYOGEN-KOH
                                            WRK-JYOGEN-KOH9
               MOVE    LNK-ORCSJGNGET-TAFTNRUIKEI
                                        TO  WRK-JIRITU-TAFTNRUIKEI
             END-IF
      *
             IF  (RECE02-ZAITAKU            =   "1")
             OR  (RECE02-KOUREI-HANTEIFLG   =   "1")
                 IF  RECE02-KOHNUM(1) = "012" OR "025"
                   IF    WRK-JYOGEN-KOH  >  WRK-SEIHO-GENDO
                      MOVE  WRK-SEIHO-GENDO   TO   WRK-JYOGEN-KOH
                   END-IF
                 ELSE
                   IF ( RECE02-KOHNUM(1) =
                        "015" OR "016" OR "021" OR "024" OR
                        "079" OR "038"                        )
                   OR ((RECE02-KOHNUM(1) =  "052" OR "054"   ) AND
                       (RECE02-SRYYM    >=  "201501"         ))
                     CONTINUE
                   ELSE
                     IF  WRK-JYOGEN-KOH  >  WRK-KOH-GENDOGAKU
                      MOVE  WRK-KOH-GENDOGAKU TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                 END-IF
             END-IF
             IF  FLG-GENBUTU70   NOT =   ZERO
                 IF  RECE02-KOHNUM(1) = "012" OR "025"
                   IF    WRK-JYOGEN-KOH  >  WRK-SEIHO-GENDO70
                      MOVE  WRK-SEIHO-GENDO70    TO   WRK-JYOGEN-KOH
                   END-IF
                 ELSE
                   IF ( RECE02-KOHNUM(1) =
                        "015" OR "016" OR "021" OR "024" OR
                        "079" OR "038"                        )
                   OR ((RECE02-KOHNUM(1) =  "052" OR "054"   ) AND
                       (RECE02-SRYYM    >=  "201501"         ))
                     CONTINUE
                   ELSE
                     IF  WRK-JYOGEN-KOH  >  WRK-GEN70-GENDOGAKU
                      MOVE  WRK-GEN70-GENDOGAKU  TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                 END-IF
             END-IF
             IF ( RECE02-KOHNUM(1) =  "015" OR "016" OR "021" OR
                                      "024" OR "079" OR "038" OR
                                      "012" OR "025"             )
             OR ((RECE02-KOHNUM(1) =  "052" OR "054"            ) AND
                 (RECE02-SRYYM    >=  "201501"                  ))
                 CONTINUE
             ELSE
                 IF   (RECE02-KOHNUM(2) = "972")
                 OR   (RECE02-KOHNUM(3) = "972")
                 OR   (RECE02-KOHNUM(4) = "972")
                   IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO
                       MOVE  WRK-CYOKI-GENDO   TO  WRK-JYOGEN-KOH
                   END-IF
                 END-IF
                 IF   (RECE02-KOHNUM(2) = "974")
                 OR   (RECE02-KOHNUM(3) = "974")
                 OR   (RECE02-KOHNUM(4) = "974")
                   IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO2
                       MOVE  WRK-CYOKI-GENDO2  TO  WRK-JYOGEN-KOH
                   END-IF
                 END-IF
             END-IF
             IF  RECE02-KOHNUM(1) = "015" OR "016" OR "021"
                   IF  WRK-JYOGEN-KOH = 9999999 OR 999999
                      MOVE  1     TO  WRK-JIRITU-CYUKANSOU
                   ELSE
                      MOVE  2     TO  WRK-JIRITU-CYUKANSOU
                      IF WRK-JIRITU-TAFTNRUIKEI < WRK-JYOGEN-KOH
                       COMPUTE WRK-JYOGEN-KOH = WRK-JYOGEN-KOH
                                              - WRK-JIRITU-TAFTNRUIKEI
                      ELSE
                       MOVE    ZERO    TO   WRK-JYOGEN-KOH
                      END-IF
      *               <** NYUINFTN**>
                   END-IF
                   IF  (RECE02-ZAITAKU            =   "1")
                   OR  (RECE02-KOUREI-HANTEIFLG   =   "1")
                     IF  WRK-JYOGEN-KOH  >  WRK-KOH-GENDOGAKU
                        MOVE  WRK-KOH-GENDOGAKU TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                   IF  FLG-GENBUTU70 NOT =   ZERO
                     IF  WRK-JYOGEN-KOH  >  WRK-GEN70-GENDOGAKU
                        MOVE  WRK-GEN70-GENDOGAKU
                                                TO   WRK-JYOGEN-KOH
                        EVALUATE  WRK-GEN70-GENDOGAKU
                          WHEN       80100
                          WHEN       40050
                             MOVE    2          TO   FLG-IRYOHI70K
                        END-EVALUATE
                     END-IF
                   END-IF
                   IF   (RECE02-KOHNUM(2) = "972")
                   OR   (RECE02-KOHNUM(3) = "972")
                   OR   (RECE02-KOHNUM(4) = "972")
                     IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO
                         MOVE  WRK-CYOKI-GENDO   TO  WRK-JYOGEN-KOH
                         MOVE  ZERO              TO  FLG-IRYOHI70K
                     END-IF
                   END-IF
                   IF   (RECE02-KOHNUM(2) = "974")
                   OR   (RECE02-KOHNUM(3) = "974")
                   OR   (RECE02-KOHNUM(4) = "974")
                     IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO2
                         MOVE  WRK-CYOKI-GENDO2  TO  WRK-JYOGEN-KOH
                         MOVE  ZERO              TO  FLG-IRYOHI70K
                     END-IF
                   END-IF
                   IF    WRK-JYOGEN-KOH = 9999999 OR 999999
                     IF  FLG-TOKU75 = 1 OR 2 OR 3
                         MOVE  40050   TO   WRK-JYOGEN-KOH
                     ELSE
                         MOVE  80100   TO   WRK-JYOGEN-KOH
                     END-IF
                     MOVE    3         TO   FLG-IRYOHI70K
                   END-IF
             END-IF
             IF ( RECE02-KOHNUM(1) =  "024" OR "079" OR "038" )
             OR ((RECE02-KOHNUM(1) =  "052" OR "054"         ) AND
                 (RECE02-SRYYM    >=  "201501"               ))
                   IF ( RECE02-KOHNUM(1) =  "038"          )
                   OR ((RECE02-KOHNUM(1) =  "052" OR "054") AND
                       (RECE02-SRYYM    >=  "201501"      ))
                     IF  WRK-JIRITU-TAFTNRUIKEI  <  WRK-JYOGEN-KOH
                        COMPUTE WRK-JYOGEN-KOH = WRK-JYOGEN-KOH
                                               - WRK-JIRITU-TAFTNRUIKEI
                     ELSE
                        MOVE    ZERO    TO   WRK-JYOGEN-KOH
                     END-IF
      *              <** NYUINFTN**>
                   END-IF
                   IF  (RECE02-ZAITAKU            =   "1")
                   OR  (RECE02-KOUREI-HANTEIFLG   =   "1")
                     IF  WRK-JYOGEN-KOH  >  WRK-KOH-GENDOGAKU
                        MOVE  WRK-KOH-GENDOGAKU TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                   IF  FLG-GENBUTU70 NOT =   ZERO
                     IF  WRK-JYOGEN-KOH  >  WRK-GEN70-GENDOGAKU
                        MOVE  WRK-GEN70-GENDOGAKU
                                                TO   WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                   IF   (RECE02-KOHNUM(2) = "972")
                   OR   (RECE02-KOHNUM(3) = "972")
                   OR   (RECE02-KOHNUM(4) = "972")
                     IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO
                         MOVE  WRK-CYOKI-GENDO   TO  WRK-JYOGEN-KOH
                     END-IF
                   END-IF
                   IF   (RECE02-KOHNUM(2) = "974")
                   OR   (RECE02-KOHNUM(3) = "974")
                   OR   (RECE02-KOHNUM(4) = "974")
                     IF   WRK-JYOGEN-KOH   >  WRK-CYOKI-GENDO2
                         MOVE  WRK-CYOKI-GENDO2  TO  WRK-JYOGEN-KOH
                     END-IF
                   END-IF
             END-IF
           END-IF
      *
      *    公費上限＋＠
           IF     FLG-IRYOHI70K    =  1
              COMPUTE  WRK-KOUREI-IRYOHI70 = RECE02-TOTALTEN(2)
                                           * 10
              IF  FLG-TOKU75 = 1 OR 2 OR 3
                IF  WRK-KOUREI-IRYOHI70 >  133500
                   COMPUTE WRK-KOUREI-IRYOHI70X =
                        (( WRK-KOUREI-IRYOHI70 - 133500 ) * 0.01 ) + 0.5
                   COMPUTE  WRK-JYOGEN-KOH   =   WRK-JYOGEN-KOH
                                             +   WRK-KOUREI-IRYOHI70X
                   IF   WRK-KOUREI-IRYOHI70  >  967890
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              ELSE
                IF  WRK-KOUREI-IRYOHI70 >  267000
                   COMPUTE WRK-KOUREI-IRYOHI70X =
                        (( WRK-KOUREI-IRYOHI70 - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  WRK-JYOGEN-KOH   =   WRK-JYOGEN-KOH
                                             +   WRK-KOUREI-IRYOHI70X
                   IF   WRK-KOUREI-IRYOHI70  >  1935690
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              END-IF
           END-IF
           IF     FLG-IRYOHI70K    =  2  OR  3
              COMPUTE  WRK-KOUREI-IRYOHI70 = RECE02-TOTALTEN(2)
                                           * 10
              IF  FLG-TOKU75 = 1 OR 2 OR 3
                IF  WRK-KOUREI-IRYOHI70 >  133500
                   COMPUTE WRK-KOUREI-IRYOHI70X =
                        (( WRK-KOUREI-IRYOHI70 - 133500 ) * 0.01 ) + 0.5
                   COMPUTE  WRK-JYOGEN-KOH   =   WRK-JYOGEN-KOH
                                             +   WRK-KOUREI-IRYOHI70X
                   IF   WRK-KOUREI-IRYOHI70  >   430140
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              ELSE
                IF  WRK-KOUREI-IRYOHI70 >  267000
                   COMPUTE WRK-KOUREI-IRYOHI70X =
                        (( WRK-KOUREI-IRYOHI70 - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  WRK-JYOGEN-KOH   =   WRK-JYOGEN-KOH
                                             +   WRK-KOUREI-IRYOHI70X
                   IF   WRK-KOUREI-IRYOHI70  >   860340
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                END-IF
              END-IF
           END-IF
      *
           MOVE   WRK-TAIHI-GENKIN(1)  TO   WRK-TAIHI-GENKIN-XXX
           COMPUTE  WRK-TAIHI-GENKIN-XXX-EN   =
                    WRK-TAIHI-GENKIN-EN(1)    +
                    0.9
      *
      *    公費の負担計算
           IF   WRK-JYOGEN-KOH   =    ZERO
               MOVE    ZERO    TO   WRK-FTNKEI-KOH
           ELSE
               IF  (RECE02-ZAITAKU   =   "1" OR "2")
      ***      OR  (RECE02-KOHNUM(1) =   "012"     )
                 IF   FLG-KOUGAKUCYO-GEN70K  =  1
                    MOVE   WRK-JYOGEN-KOH       TO WRK-FTNKEI-KOH
                 ELSE
                  IF  (RECE02-ZAITAKU          =   "2")
                  AND (WRK-KOGAKU-TAISYOGAI(1) =    1 )
                    IF     WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN-XXX-EN
                      MOVE  WRK-JYOGEN-KOH      TO WRK-FTNKEI-KOH
                    ELSE
                      MOVE  WRK-TAIHI-GENKIN-XXX-EN
                                                TO WRK-FTNKEI-KOH
                    END-IF
                  ELSE
                    IF     WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN-XXX
                      MOVE  WRK-JYOGEN-KOH      TO WRK-FTNKEI-KOH
                    ELSE
                      MOVE  WRK-TAIHI-GENKIN-XXX
                                                TO WRK-FTNKEI-KOH
                    END-IF
                  END-IF
                 END-IF
               ELSE
                 IF        WRK-JYOGEN-KOH  <    WRK-TAIHI-GENKIN-XXX-EN
                      MOVE  WRK-JYOGEN-KOH      TO WRK-FTNKEI-KOH
                 ELSE
                      MOVE  WRK-TAIHI-GENKIN-XXX-EN
                                                TO WRK-FTNKEI-KOH
                 END-IF
               END-IF
           END-IF
      *
           IF  ((WK-GENGAKUKBN      NOT =   2  ) AND
                (RECE02-FTNMONEY(2)     =  ZERO))
           OR  ((WK-GENGAKUKBN          =   2  ) AND
                (WRK-JYOGEN-KOH9        =  ZERO))
            CONTINUE
           ELSE
            IF   RECE02-ZAITAKU   =   "1" OR "2"
              MOVE   RECE02-FTNMONEY(2)      TO  WRK-TAIHI-GENKIN3
              MOVE   WRK-FTNKEI-KOH          TO  RECE02-FTNMONEY(2)
                                                 RECE02-FTNMONEY-KOJ(2)
              IF    RECE02-FTNMONEY(2)    NOT =  ZERO
              AND   RECE02-ZAITAKU            =  "1"
                IF   RECE02-FTNMONEY(2) > WRK-TAIHI-GENKIN3
                  COMPUTE  WRK-TAIHI-GENKIN4 = RECE02-FTNMONEY(2)
                                             - WRK-TAIHI-GENKIN3
                ELSE
                  MOVE     ZERO        TO  WRK-TAIHI-GENKIN4
                END-IF
                IF   RECE02-FTNMONEY(1) > WRK-TAIHI-GENKIN4
                  COMPUTE  RECE02-FTNMONEY(1) =  RECE02-FTNMONEY(1)
                                              -  WRK-TAIHI-GENKIN4
                ELSE
                  MOVE     ZERO        TO  RECE02-FTNMONEY(1)
                END-IF
                IF   FTN-KOH-XXX        > WRK-TAIHI-GENKIN4
                  COMPUTE  FTN-KOH-XXX        =  FTN-KOH-XXX
                                              -  WRK-TAIHI-GENKIN4
                ELSE
                  MOVE     ZERO        TO  FTN-KOH-XXX
                END-IF
              END-IF
            ELSE
              MOVE   WRK-FTNKEI-KOH          TO  RECE02-FTNMONEY(2)
                                                 RECE02-FTNMONEY-KOJ(2)
            END-IF
           END-IF
      *
           .
       21092-GENGAKU-OKIKAE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ７０歳代前半軽減特例措置対応
      *****************************************************************
       21093-ZENKI-TOKUREI-OKIKAE-SEC               SECTION.
      *
           MOVE      1       TO     FLG-GENGAKU-OKIKAE
           MOVE   KOHFTN-IDX TO     IDX10
           PERFORM   211F1-JGNGAK-SET-SEC
      *
      *    公費上限
           MOVE   TBL-HKNFTNDATA-JGN(KOHFTN-IDX)
                                          TO   WRK-JYOGEN-KOH
      ****
           IF    WK-GENGAKUKBN    NOT =  ZERO
           AND   WK-GENGAKUKBN-KEISAN =  ZERO
            IF  ((RECE02-KOHNUM(KOHFTN-IDX)      = "051") AND
                 (TBL-DOTANDOKU-FLG(KOHFTN-IDX)  =   1  ))
            OR  ((SYS-1001-PREFNUM               =  13  ) AND
                 (RECE02-KOHNUM(KOHFTN-IDX)      = "151") AND
                 (RECE02-SRYYM               <  "200905"))
             CONTINUE
            ELSE
             IF  WRK-KOH-GENDOGAKU   NOT =  ZERO
                 EVALUATE   WK-GENGAKUKBN
                   WHEN        1
                     IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO     TO   WRK-KOH-GENDOGAKU
                     ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  WRK-KOH-GENDOGAKU   =
                                  WRK-KOH-GENDOGAKU   *
                                  WK-GENGAKU-RITUX    /
                                  100
                     END-IF
                   WHEN        2
                     IF  WRK-KOH-GENDOGAKU < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WRK-KOH-GENDOGAKU
                     ELSE
                       COMPUTE  WRK-KOH-GENDOGAKU     =
                                WRK-KOH-GENDOGAKU     -
                                WK-GENGAKU-KIN
                     END-IF
                   WHEN        3
                   WHEN        4
                         MOVE   ZERO     TO   WRK-KOH-GENDOGAKU
                   WHEN        5
                     IF  WRK-KOH-GENDOGAKU > WK-GENGAKU-KIN
                       COMPUTE  WRK-KOH-GENDOGAKU     =
                                WK-GENGAKU-KIN
                     END-IF
                 END-EVALUATE
                 COMPUTE  WRK-KOH-GENDOGAKU  =
                          WRK-KOH-GENDOGAKU  +   5
                 COMPUTE  WRK-KOH-GENDOGAKU  =
                          WRK-KOH-GENDOGAKU  /  10
                 COMPUTE  WRK-KOH-GENDOGAKU  =
                          WRK-KOH-GENDOGAKU  *  10
             END-IF
             IF  WRK-JYOGEN-KOH   NOT =  ZERO
                 EVALUATE   WK-GENGAKUKBN
                   WHEN        1
                     IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO     TO   WRK-JYOGEN-KOH
                     ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  WRK-JYOGEN-KOH      =
                                  WRK-JYOGEN-KOH      *
                                  WK-GENGAKU-RITUX    /
                                  100
                     END-IF
                   WHEN        2
                     IF  WRK-JYOGEN-KOH < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WRK-JYOGEN-KOH
                     ELSE
                       COMPUTE  WRK-JYOGEN-KOH     =
                                WRK-JYOGEN-KOH     -
                                WK-GENGAKU-KIN
                     END-IF
                   WHEN        3
                   WHEN        4
                         MOVE   ZERO     TO   WRK-JYOGEN-KOH
                   WHEN        5
                     IF  WRK-JYOGEN-KOH > WK-GENGAKU-KIN
                       COMPUTE  WRK-JYOGEN-KOH     =
                                WK-GENGAKU-KIN
                     END-IF
                 END-EVALUATE
                 COMPUTE  WRK-JYOGEN-KOH = WRK-JYOGEN-KOH +  5
                 COMPUTE  WRK-JYOGEN-KOH = WRK-JYOGEN-KOH / 10
                 COMPUTE  WRK-JYOGEN-KOH = WRK-JYOGEN-KOH * 10
             END-IF
            END-IF
           END-IF
      *
           MOVE     WRK-TAIHI-GENKIN(KOHFTN-IDX)
                                     TO   WRK-TAIHI-GENKIN-XXX
           COMPUTE  WRK-TAIHI-GENKIN-XXX-EN         =
                    WRK-TAIHI-GENKIN-EN(KOHFTN-IDX) +
                    0.9
      *
           IF   ((RECE02-KOHNUM(KOHFTN-IDX)      = "051") AND
                 (TBL-DOTANDOKU-FLG(KOHFTN-IDX)  =   1  ))
           OR   ((SYS-1001-PREFNUM               =  13  ) AND
                 (RECE02-KOHNUM(KOHFTN-IDX)      = "151") AND
                 (RECE02-SRYYM               <  "200905"))
             CONTINUE
           ELSE
             IF   WK-GENGAKUKBN    NOT =   ZERO
               MOVE     WRK-TAIHI-GENKIN-GEN(KOHFTN-IDX)
                                     TO   WRK-TAIHI-GENKIN-XXX
               COMPUTE  WRK-TAIHI-GENKIN-XXX-EN             =
                        WRK-TAIHI-GENKIN-EN-GEN(KOHFTN-IDX) +
                        0.9
             END-IF
           END-IF
      *
           IF ( RECE02-KOHNUM(KOHFTN-IDX) = "038"         )
           OR ((RECE02-KOHNUM(KOHFTN-IDX) = "054"        ) AND
               (RECE02-SRYYM             >= "201501"     ))
           OR ( WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX) =   1 )
              IF  TBL-HKNFTNDATA-TAF(KOHFTN-IDX)   <  WRK-JYOGEN-KOH
                  COMPUTE  WRK-JYOGEN-KOH =
                           WRK-JYOGEN-KOH -
                           TBL-HKNFTNDATA-TAF(KOHFTN-IDX)
              ELSE
                  MOVE     ZERO          TO   WRK-JYOGEN-KOH
              END-IF
      ***     IF  TBL-HKNFTNDATA-NYUIN(KOHFTN-IDX) <  WRK-JYOGEN-KOH
      ***         COMPUTE  WRK-JYOGEN-KOH =
      ***                  WRK-JYOGEN-KOH -
      ***                  TBL-HKNFTNDATA-NYUIN(KOHFTN-IDX)
      ***     ELSE
      ***         MOVE     ZERO          TO   WRK-JYOGEN-KOH
      ***     END-IF
           END-IF
      *
           IF  (  RECE02-ZAITAKU                 =  SPACE )
           AND (((RECE02-KOHNUM(KOHFTN-IDX)      = "051") AND
                 (TBL-DOTANDOKU-FLG(KOHFTN-IDX)  =   1  ))
             OR ((SYS-1001-PREFNUM               =  13  ) AND
                 (RECE02-KOHNUM(KOHFTN-IDX)      = "151") AND
                 (RECE02-SRYYM               <  "200905")))
             CONTINUE
           ELSE
             IF  WRK-JYOGEN-KOH  >  WRK-KOH-GENDOGAKU
                MOVE   WRK-KOH-GENDOGAKU  TO   WRK-JYOGEN-KOH
             END-IF
           END-IF
      *
      *    公費の負担計算
           MOVE     ZERO     TO    WRK-ZENKI-FTNMONEY
           IF    FLG-ZENKI-CHECK   =   ZERO
              IF  ((WK-GENGAKUKBN                NOT =   2    ) AND
                   (RECE02-FTNMONEY(KOHFTN-IDX + 1)  =  ZERO  ))
              OR  ((WK-GENGAKUKBN                    =   2    ) AND
                   (TBL-HKNFTNDATA-JGN(KOHFTN-IDX)   =  ZERO  ))
              OR  ( TBL-HKNFTNDATA-FLG(KOHFTN-IDX)   =  1 OR 2 )
                IF   RECE02-ZAITAKU              NOT =  "1"
                AND  TBL-HKNFTNDATA-FLG(KOHFTN-IDX)  =   1
                  IF  WRK-JYOGEN-KOH = RECE02-FTNMONEY(KOHFTN-IDX + 1)
                    CONTINUE
                  ELSE
                    PERFORM  21095-KOH-ICHIBUFTN-HENSYU-SEC
                    PERFORM  2109A-CHIHO-ICHIBUFTN-HEN-SEC
                  END-IF
                END-IF
              ELSE
                IF   WRK-JYOGEN-KOH   =    ZERO
                  MOVE      ZERO             TO  WRK-FTNKEI-KOH
                ELSE
                  IF  RECE02-ZAITAKU   =   "1"
                    IF WRK-JYOGEN-KOH < WRK-TAIHI-GENKIN-XXX
                      MOVE  WRK-JYOGEN-KOH   TO  WRK-FTNKEI-KOH
                    ELSE
                      MOVE  WRK-TAIHI-GENKIN-XXX
                                             TO  WRK-FTNKEI-KOH
                    END-IF
                  ELSE
                    IF WRK-JYOGEN-KOH < WRK-TAIHI-GENKIN-XXX-EN
                      MOVE  WRK-JYOGEN-KOH   TO  WRK-FTNKEI-KOH
                    ELSE
                      MOVE  WRK-TAIHI-GENKIN-XXX-EN
                                             TO  WRK-FTNKEI-KOH
                    END-IF
                  END-IF
                END-IF
                MOVE        WRK-FTNKEI-KOH   TO
                                 RECE02-FTNMONEY    (KOHFTN-IDX + 1)
                                 RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)
              END-IF
           ELSE
              IF  ((WK-GENGAKUKBN                NOT =   2    ) AND
                   (RECE02-FTNMONEY(KOHFTN-IDX + 1)  =  ZERO  ))
              OR  ((WK-GENGAKUKBN                    =   2    ) AND
                   (TBL-HKNFTNDATA-JGN(KOHFTN-IDX)   =  ZERO  ))
              OR  ( TBL-HKNFTNDATA-FLG(KOHFTN-IDX)   =  1 OR 2 )
                MOVE   RECE02-FTNMONEY(KOHFTN-IDX + 1)
                                   TO    WRK-ZENKI-FTNMONEY
              ELSE
                IF     WRK-JYOGEN-KOH   =    ZERO
                  MOVE    ZERO     TO    WRK-FTNKEI-KOH
                ELSE
                  IF   WRK-JYOGEN-KOH  <  WRK-TAIHI-GENKIN-XXX
                    MOVE   WRK-JYOGEN-KOH  TO   WRK-FTNKEI-KOH
                  ELSE
                    MOVE   WRK-TAIHI-GENKIN-XXX
                                           TO   WRK-FTNKEI-KOH
                  END-IF
                END-IF
                MOVE   WRK-FTNKEI-KOH      TO   WRK-ZENKI-FTNMONEY
              END-IF
           END-IF
      *
           .
       21093-ZENKI-TOKUREI-OKIKAE-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額編集
      *****************************************************************
       21094-JYOGENGAKU-HENSYU-SEC               SECTION.
      *
           MOVE     ZERO     TO   FLG-KOUGAKU2
           MOVE     ZERO     TO   WRK-KINGAKU3
           MOVE     ZERO     TO   WRK-KINGAKU-GENBUTU3
      *
           EVALUATE   RECE02-ZAITAKU
            WHEN        "1"
      *     (RECE02-GNBKEIKBN-K-G(2) = "2") のチェック
            WHEN        "4"
              IF     RECE02-TEISYOTOKU   NOT =  SPACE
                IF  FLG-TOKU75 = 1 OR 2
                     MOVE  4000    TO   WRK-KINGAKU3
                ELSE
                     MOVE  8000    TO   WRK-KINGAKU3
                END-IF
              ELSE
                IF   ((RECE02-KYURATE       =   30     ) AND
                      (RECE02-SRYYM        >=  "201808"))
                OR   ((RECE02-KYURATE       =   30     ) AND
                      (RECE02-SRYYM         <  "201808") AND
                      (RECE02-RJNGENMENKBN  =   SPACE  ))
                OR   ((RECE02-KYURATE       =   20     ) AND
                      (RECE02-SRYYM         <  "200804") AND
                      (RECE02-RJNGENMENKBN  =   SPACE  ))
                  IF        RECE02-SRYYM   >=  "201808"
                    EVALUATE   FLG-KOUREI-GENEKIKBN
                      WHEN        1
                         IF    FLG-KOHYONKAIME    =  1
                           IF  FLG-TOKU75 = 1 OR 2
                             MOVE    70050     TO   WRK-KINGAKU3
                           ELSE
                             MOVE   140100     TO   WRK-KINGAKU3
                           END-IF
                         ELSE
                           COMPUTE WRK-CHIHOU-KIN6     =
                                   WRK-HANTEI-TOTALTEN * 10
                           IF  FLG-TOKU75 = 1 OR 2
                             IF   WRK-CHIHOU-KIN6  >  421000
                               COMPUTE  WRK-KINGAKU2 =
                                     (( WRK-CHIHOU-KIN6 - 421000 )
                                                        * 0.01 ) + 0.5
                               COMPUTE  WRK-KINGAKU3  = 126300
                                                      + WRK-KINGAKU2
                               MOVE     1      TO   FLG-KOUGAKU2
                             ELSE
                               MOVE    126300  TO   WRK-KINGAKU3
                             END-IF
                           ELSE
                             IF   WRK-CHIHOU-KIN6  >  842000
                               COMPUTE  WRK-KINGAKU2 =
                                     (( WRK-CHIHOU-KIN6 - 842000 )
                                                        * 0.01 ) + 0.5
                               COMPUTE  WRK-KINGAKU3  = 252600
                                                      + WRK-KINGAKU2
                               MOVE     1      TO   FLG-KOUGAKU2
                             ELSE
                               MOVE    252600  TO   WRK-KINGAKU3
                             END-IF
                           END-IF
                         END-IF
                      WHEN        2
                         IF    FLG-KOHYONKAIME    =  1
                           IF  FLG-TOKU75 = 1 OR 2
                             MOVE    46500     TO   WRK-KINGAKU3
                           ELSE
                             MOVE    93000     TO   WRK-KINGAKU3
                           END-IF
                         ELSE
                           COMPUTE WRK-CHIHOU-KIN6     =
                                   WRK-HANTEI-TOTALTEN * 10
                           IF  FLG-TOKU75 = 1 OR 2
                             IF   WRK-CHIHOU-KIN6  >  279000
                               COMPUTE  WRK-KINGAKU2 =
                                     (( WRK-CHIHOU-KIN6 - 279000 )
                                                        * 0.01 ) + 0.5
                               COMPUTE  WRK-KINGAKU3  = 83700
                                                      + WRK-KINGAKU2
                               MOVE     1      TO   FLG-KOUGAKU2
                             ELSE
                               MOVE     83700  TO   WRK-KINGAKU3
                             END-IF
                           ELSE
                             IF   WRK-CHIHOU-KIN6  >  558000
                               COMPUTE  WRK-KINGAKU2 =
                                     (( WRK-CHIHOU-KIN6 - 558000 )
                                                        * 0.01 ) + 0.5
                               COMPUTE  WRK-KINGAKU3  = 167400
                                                      + WRK-KINGAKU2
                               MOVE     1      TO   FLG-KOUGAKU2
                             ELSE
                               MOVE    167400  TO   WRK-KINGAKU3
                             END-IF
                           END-IF
                         END-IF
                      WHEN        3
                         IF    FLG-KOHYONKAIME    =  1
                           IF  FLG-TOKU75 = 1 OR 2
                             MOVE    22200     TO   WRK-KINGAKU3
                           ELSE
                             MOVE    44400     TO   WRK-KINGAKU3
                           END-IF
                         ELSE
                           COMPUTE WRK-CHIHOU-KIN6     =
                                   WRK-HANTEI-TOTALTEN * 10
                           IF  FLG-TOKU75 = 1 OR 2
                             IF   WRK-CHIHOU-KIN6  >  133500
                               COMPUTE  WRK-KINGAKU2 =
                                     (( WRK-CHIHOU-KIN6 - 133500 )
                                                        * 0.01 ) + 0.5
                               COMPUTE  WRK-KINGAKU3  = 40050
                                                      + WRK-KINGAKU2
                               MOVE     1      TO   FLG-KOUGAKU2
                             ELSE
                               MOVE     40050  TO   WRK-KINGAKU3
                             END-IF
                           ELSE
                             IF   WRK-CHIHOU-KIN6  >  267000
                               COMPUTE  WRK-KINGAKU2 =
                                     (( WRK-CHIHOU-KIN6 - 267000 )
                                                        * 0.01 ) + 0.5
                               COMPUTE  WRK-KINGAKU3  = 80100
                                                      + WRK-KINGAKU2
                               MOVE     1      TO   FLG-KOUGAKU2
                             ELSE
                               MOVE     80100  TO   WRK-KINGAKU3
                             END-IF
                           END-IF
                         END-IF
                    END-EVALUATE
                  ELSE
                    IF      RECE02-SRYYM   >=  "201708"
                      IF    FLG-TOKU75 = 1 OR 2
                        MOVE    28800   TO   WRK-KINGAKU3
                      ELSE
                        MOVE    57600   TO   WRK-KINGAKU3
                      END-IF
                    ELSE
                      IF    RECE02-SRYYM   >=  "200610"
                        IF  FLG-TOKU75 = 1 OR 2
                          MOVE  22200   TO   WRK-KINGAKU3
                        ELSE
                          MOVE  44400   TO   WRK-KINGAKU3
                        END-IF
                      ELSE
                        MOVE    40200   TO   WRK-KINGAKU3
                      END-IF
                    END-IF
                  END-IF
                ELSE
                  IF        RECE02-SRYYM   >=  "201808"
                    IF    FLG-TOKU75 = 1 OR 2
                      MOVE       9000   TO   WRK-KINGAKU3
                    ELSE
                      MOVE      18000   TO   WRK-KINGAKU3
                    END-IF
                  ELSE
                    IF      RECE02-SRYYM   >=  "201708"
                      IF    FLG-TOKU75 = 1 OR 2
                        MOVE     7000   TO   WRK-KINGAKU3
                      ELSE
                        MOVE    14000   TO   WRK-KINGAKU3
                      END-IF
                    ELSE
                      IF    FLG-TOKU75 = 1 OR 2
                        MOVE     6000   TO   WRK-KINGAKU3
                      ELSE
                        MOVE    12000   TO   WRK-KINGAKU3
                      END-IF
                    END-IF
                  END-IF
                END-IF
              END-IF
            WHEN        "2"
              IF  RECE02-SRYYM  >= "201501"
                PERFORM 21094-JYOGENGAKU-HENSYU2-SEC
              ELSE
                PERFORM 21094-JYOGENGAKU-HENSYU1-SEC
              END-IF
           END-EVALUATE
      *
      *
           MOVE   WRK-KINGAKU3   TO   WRK-KINGAKU-GENBUTU3
      *
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
           AND  WK-GENGAKUKBN-KEISAN =   ZERO
             EVALUATE   WK-GENGAKUKBN
               WHEN        1
                 IF  WK-GENGAKU-RITU = 100
                   MOVE   ZERO   TO   WRK-KINGAKU3
                 ELSE
                   COMPUTE WK-GENGAKU-RITUX = 100 - WK-GENGAKU-RITU
                   IF    WRK-KINGAKU3  NOT = ZERO
                     IF  FLG-KOUGAKU2 = ZERO
                       COMPUTE WRK-KINGAKU3 =
                               WRK-KINGAKU3 * WK-GENGAKU-RITUX / 100
                       COMPUTE WRK-KINGAKU3 = WRK-KINGAKU3 +  5
                       COMPUTE WRK-KINGAKU3 = WRK-KINGAKU3 / 10
                       COMPUTE WRK-KINGAKU3 = WRK-KINGAKU3 * 10
                     ELSE
                       COMPUTE WRK-KINGAKU3 =
                              (WRK-KINGAKU3 * WK-GENGAKU-RITUX / 100)
                                                               + 0.5
                     END-IF
                   END-IF
                 END-IF
               WHEN        2
                 IF  WRK-KINGAKU3 < WK-GENGAKU-KIN
                   MOVE   ZERO   TO   WRK-KINGAKU3
                 ELSE
                   COMPUTE  WRK-KINGAKU3     =
                            WRK-KINGAKU3     -
                            WK-GENGAKU-KIN
                 END-IF
               WHEN        3
               WHEN        4
                 MOVE   ZERO     TO   WRK-KINGAKU3
               WHEN        5
                 IF  WRK-KINGAKU3 > WK-GENGAKU-KIN
                   COMPUTE  WRK-KINGAKU3     =
                            WK-GENGAKU-KIN
                 END-IF
             END-EVALUATE
           END-IF
      *
           .
       21094-JYOGENGAKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額編集１（平成２６年１２月まで）
      *****************************************************************
       21094-JYOGENGAKU-HENSYU1-SEC               SECTION.
      *
           EVALUATE    FLG-GENBUTU70
             WHEN           1
               IF  FLG-KOHYONKAIME = 1
                IF  FLG-TOKU75 = 3
                  MOVE   41700   TO   WRK-KINGAKU3
                ELSE
                  MOVE   83400   TO   WRK-KINGAKU3
                END-IF
               ELSE
                COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
                IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN6  >  250000
                    COMPUTE  WRK-KINGAKU2 =
                          (( WRK-CHIHOU-KIN6 - 250000 ) * 0.01 )
                                                        + 0.5
                    COMPUTE  WRK-KINGAKU3 = 75000  + WRK-KINGAKU2
                    MOVE    1       TO   FLG-KOUGAKU2
                  ELSE
                    MOVE    75000   TO   WRK-KINGAKU3
                  END-IF
                ELSE
                  IF   WRK-CHIHOU-KIN6  >  500000
                    COMPUTE  WRK-KINGAKU2 =
                          (( WRK-CHIHOU-KIN6 - 500000 ) * 0.01 )
                                                        + 0.5
                    COMPUTE  WRK-KINGAKU3 = 150000 + WRK-KINGAKU2
                    MOVE    1       TO   FLG-KOUGAKU2
                  ELSE
                    MOVE    150000  TO   WRK-KINGAKU3
                  END-IF
                END-IF
               END-IF
             WHEN           2
               IF  FLG-KOHYONKAIME = 1
                IF  FLG-TOKU75 = 3
                  MOVE   22200   TO   WRK-KINGAKU3
                ELSE
                  MOVE   44400   TO   WRK-KINGAKU3
                END-IF
               ELSE
                COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
                IF  FLG-TOKU75 = 3
                  IF   WRK-CHIHOU-KIN6  >  133500
                    COMPUTE  WRK-KINGAKU2 =
                          (( WRK-CHIHOU-KIN6 - 133500 ) * 0.01 )
                                                        + 0.5
                    COMPUTE  WRK-KINGAKU3 = 40050  + WRK-KINGAKU2
                    MOVE    1       TO   FLG-KOUGAKU2
                  ELSE
                    MOVE    40050   TO   WRK-KINGAKU3
                  END-IF
                ELSE
                  IF   WRK-CHIHOU-KIN6  >  267000
                    COMPUTE  WRK-KINGAKU2 =
                          (( WRK-CHIHOU-KIN6 - 267000 ) * 0.01 )
                                                        + 0.5
                    COMPUTE  WRK-KINGAKU3 = 80100  + WRK-KINGAKU2
                    MOVE    1       TO   FLG-KOUGAKU2
                  ELSE
                    MOVE    80100   TO   WRK-KINGAKU3
                  END-IF
                END-IF
               END-IF
             WHEN           3
               IF  FLG-KOHYONKAIME = 1
                IF  FLG-TOKU75 = 3
                  MOVE   12300   TO   WRK-KINGAKU3
                ELSE
                  MOVE   24600   TO   WRK-KINGAKU3
                END-IF
               ELSE
                IF  FLG-TOKU75 = 3
                  MOVE   17700   TO   WRK-KINGAKU3
                ELSE
                  MOVE   35400   TO   WRK-KINGAKU3
                END-IF
               END-IF
           END-EVALUATE
      *
           .
       21094-JYOGENGAKU-HENSYU1-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額編集２（平成２７年１月から）
      *****************************************************************
       21094-JYOGENGAKU-HENSYU2-SEC               SECTION.
      *
           EVALUATE    FLG-GENBUTU70
             WHEN           1
               IF  FLG-KOHYONKAIME = 1
                IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE    70050   TO   WRK-KINGAKU3
                     WHEN      12
                       MOVE    46500   TO   WRK-KINGAKU3
                   END-EVALUATE
                ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       MOVE   140100   TO   WRK-KINGAKU3
                     WHEN      12
                       MOVE    93000   TO   WRK-KINGAKU3
                   END-EVALUATE
                END-IF
               ELSE
                COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
                IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN6 >  421000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 -  421000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU3 = 126300 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU2
                       ELSE
                         MOVE   126300   TO   WRK-KINGAKU3
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN6 >  279000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 -  279000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU3 =  83700 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU2
                       ELSE
                         MOVE    83700   TO   WRK-KINGAKU3
                       END-IF
                   END-EVALUATE
                ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF   WRK-CHIHOU-KIN6 >  842000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 -  842000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU3 = 252600 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU2
                       ELSE
                         MOVE   252600   TO   WRK-KINGAKU3
                       END-IF
                     WHEN      12
                       IF   WRK-CHIHOU-KIN6  >  558000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 -  558000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU3 = 167400 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU2
                       ELSE
                         MOVE   167400   TO   WRK-KINGAKU3
                       END-IF
                   END-EVALUATE
                END-IF
               END-IF
             WHEN           2
               IF  FLG-KOHYONKAIME = 1
                IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    22200   TO   WRK-KINGAKU3
                     WHEN      22
                       MOVE    22200   TO   WRK-KINGAKU3
                   END-EVALUATE
                ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       MOVE    44400   TO   WRK-KINGAKU3
                     WHEN      22
                       MOVE    44400   TO   WRK-KINGAKU3
                   END-EVALUATE
                END-IF
               ELSE
                COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
                IF  FLG-TOKU75 = 3
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN6 >  133500
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 -  133500 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU3 =  40050 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU2
                       ELSE
                         MOVE    40050   TO   WRK-KINGAKU3
                       END-IF
                     WHEN      22
                         MOVE    28800   TO   WRK-KINGAKU3
                   END-EVALUATE
                ELSE
                   EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      21
                       IF   WRK-CHIHOU-KIN6 >  267000
                         COMPUTE  WRK-KINGAKU2 =
                               (( WRK-CHIHOU-KIN6 -  267000 ) * 0.01 )
                                                              + 0.5
                         COMPUTE  WRK-KINGAKU3 =  80100 + WRK-KINGAKU2
                         MOVE     1      TO   FLG-KOUGAKU2
                       ELSE
                         MOVE    80100   TO   WRK-KINGAKU3
                       END-IF
                     WHEN      22
                         MOVE    57600   TO   WRK-KINGAKU3
                   END-EVALUATE
                END-IF
               END-IF
             WHEN           3
               IF  FLG-KOHYONKAIME = 1
                IF  FLG-TOKU75 = 3
                       MOVE    12300   TO   WRK-KINGAKU3
                ELSE
                       MOVE    24600   TO   WRK-KINGAKU3
                END-IF
               ELSE
                IF  FLG-TOKU75 = 3
                       MOVE    17700   TO   WRK-KINGAKU3
                ELSE
                       MOVE    35400   TO   WRK-KINGAKU3
                END-IF
               END-IF
           END-EVALUATE
      *
           .
       21094-JYOGENGAKU-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額編集（０１公）他
      *****************************************************************
       21094X-JYOGENGAKU-HENSYU2-SEC               SECTION.
      *
           MOVE     ZERO     TO   FLG-KOUGAKU2
           MOVE     ZERO     TO   WRK-KINGAKU3
           MOVE     ZERO     TO   WRK-KINGAKU-GENBUTU3
      *
           EVALUATE   RECE02-ZAITAKU
             WHEN        "1"
               IF      RECE02-SRYYM   >=  "201808"
                 IF    FLG-TOKU75 = 1 OR 2
                   MOVE      9000      TO   WRK-KINGAKU3
                 ELSE
                   MOVE     18000      TO   WRK-KINGAKU3
                 END-IF
               ELSE
                 IF    RECE02-SRYYM   >=  "201708"
                   IF    FLG-TOKU75 = 1 OR 2
                     MOVE    7000      TO   WRK-KINGAKU3
                   ELSE
                     MOVE   14000      TO   WRK-KINGAKU3
                   END-IF
                 ELSE
                   IF    FLG-TOKU75 = 1 OR 2
                     MOVE    6000      TO   WRK-KINGAKU3
                   ELSE
                     MOVE   12000      TO   WRK-KINGAKU3
                   END-IF
                 END-IF
               END-IF
             WHEN        "2"
             WHEN        " "
               COMPUTE  WRK-CHIHOU-KIN6 = WRK-HANTEI-TOTALTEN * 10
               IF  FLG-TOKU75 = 3
                 IF   WRK-CHIHOU-KIN6  >  133500
                   COMPUTE  WRK-KINGAKU2 =
                      (( WRK-CHIHOU-KIN6 -  133500 ) * 0.01 )
                                                     + 0.5
                   COMPUTE WRK-KINGAKU3 =  40050 + WRK-KINGAKU2
                   MOVE    1       TO  FLG-KOUGAKU2
                 ELSE
                   MOVE    40050   TO  WRK-KINGAKU3
                 END-IF
               ELSE
                 IF   WRK-CHIHOU-KIN6  >  267000
                   COMPUTE  WRK-KINGAKU2 =
                      (( WRK-CHIHOU-KIN6 -  267000 ) * 0.01 )
                                                     + 0.5
                   COMPUTE WRK-KINGAKU3 =  80100 + WRK-KINGAKU2
                   MOVE    1       TO  FLG-KOUGAKU2
                 ELSE
                   MOVE    80100   TO  WRK-KINGAKU3
                 END-IF
               END-IF
           END-EVALUATE
      *
      *
           MOVE   WRK-KINGAKU3   TO   WRK-KINGAKU-GENBUTU3
      *
      *
           IF   WK-GENGAKUKBN    NOT =   ZERO
           AND  WK-GENGAKUKBN-KEISAN =   ZERO
             EVALUATE   WK-GENGAKUKBN
               WHEN        1
                 IF  WK-GENGAKU-RITU = 100
                   MOVE   ZERO   TO   WRK-KINGAKU3
                 ELSE
                   COMPUTE WK-GENGAKU-RITUX = 100 - WK-GENGAKU-RITU
                   IF    WRK-KINGAKU3  NOT = ZERO
                     IF  FLG-KOUGAKU2 = ZERO
                       COMPUTE WRK-KINGAKU3 =
                               WRK-KINGAKU3 * WK-GENGAKU-RITUX / 100
                       COMPUTE WRK-KINGAKU3 = WRK-KINGAKU3 +  5
                       COMPUTE WRK-KINGAKU3 = WRK-KINGAKU3 / 10
                       COMPUTE WRK-KINGAKU3 = WRK-KINGAKU3 * 10
                     ELSE
                       COMPUTE WRK-KINGAKU3 =
                              (WRK-KINGAKU3 * WK-GENGAKU-RITUX / 100)
                                                               + 0.5
                     END-IF
                   END-IF
                 END-IF
               WHEN        2
                 IF  WRK-KINGAKU3 < WK-GENGAKU-KIN
                   MOVE   ZERO   TO   WRK-KINGAKU3
                 ELSE
                   COMPUTE  WRK-KINGAKU3     =
                            WRK-KINGAKU3     -
                            WK-GENGAKU-KIN
                 END-IF
               WHEN        3
               WHEN        4
                 MOVE   ZERO     TO   WRK-KINGAKU3
               WHEN        5
                 IF  WRK-KINGAKU3 > WK-GENGAKU-KIN
                   COMPUTE  WRK-KINGAKU3     =
                            WK-GENGAKU-KIN
                 END-IF
             END-EVALUATE
           END-IF
      *
           .
       21094X-JYOGENGAKU-HENSYU2-EXT.
           EXIT.
      *
      *****************************************************************
      *    上限額のある全国公費の一部負担金編集
      *****************************************************************
       21095-KOH-ICHIBUFTN-HENSYU-SEC               SECTION.
      *
           MOVE    ZERO    TO   WRK-KOH-KINGAKU
      *
           IF   RECE02-KOHNUM(KOHFTN-IDX) =
                "015" OR "016" OR "024" OR "079" OR "021"
             COMPUTE  WRK-KOH-KINGAKU = RECE02-TOTALTEN(KOHFTN-IDX + 1)
                                      * 10
                                      * 10
                                      / 100
           END-IF
      *
           IF ( RECE02-KOHNUM(KOHFTN-IDX) =
                "038" OR "051" OR "012" OR "025"          )
           OR ((SYS-1001-PREFNUM          =   13         ) AND
               (RECE02-KOHNUM(KOHFTN-IDX) =  "151"       ))
           OR ((SYS-1001-PREFNUM          =   23         ) AND
               (RECE02-KOHNUM(KOHFTN-IDX) =  "191"       ) AND
               (RECE02-SRYYM             >=  "200910"    ))
           OR ((SYS-1001-PREFNUM          =   23 OR 24   ) AND
               (RECE02-KOHNUM(KOHFTN-IDX) =  "152"       ) AND
               (RECE02-SRYYM             >=  "201104"    ) AND
               (RECE02-SRYYM             <=  "201412"    ))
             COMPUTE  WRK-KOH-KINGAKU = RECE02-TOTALTEN(KOHFTN-IDX + 1)
                                      * 10
                                      * RECE02-KYURATE
                                      / 100
           END-IF
      *
           IF  (RECE02-KOHNUM(KOHFTN-IDX) =  "052" OR "054")
           OR  (WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)  =   1 )
            IF  (RECE02-KYURATE    >=   20     )
            AND (RECE02-SRYYM      >=  "201501")
             COMPUTE  WRK-KOH-KINGAKU = RECE02-TOTALTEN(KOHFTN-IDX + 1)
                                      * 10
                                      * 20
                                      / 100
            ELSE
             COMPUTE  WRK-KOH-KINGAKU = RECE02-TOTALTEN(KOHFTN-IDX + 1)
                                      * 10
                                      * RECE02-KYURATE
                                      / 100
            END-IF
           END-IF
      *
           IF   WRK-KOH-KINGAKU   NOT = ZERO
            IF    WRK-KOH-KINGAKU < RECE02-FTNMONEY(KOHFTN-IDX + 1)
                MOVE  WRK-KOH-KINGAKU  TO
                                  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)
            ELSE
              IF  WRK-KOH-KINGAKU = WRK-TAIHI-FTNMONEY(KOHFTN-IDX + 1)
                MOVE  WRK-KOH-KINGAKU  TO
                                  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)
              ELSE
                IF  (WRK-TAIHI-GENKIN9(KOHFTN-IDX)
                                  = RECE02-FTNMONEY(KOHFTN-IDX + 1))
                AND (WRK-TAIHI-FTNMONEY(KOHFTN-IDX + 1)
                                  = RECE02-FTNMONEY(KOHFTN-IDX + 1))
                AND (TBL-HKNFTNDATA-JGN(KOHFTN-IDX)
                              NOT = RECE02-FTNMONEY(KOHFTN-IDX + 1))
                  MOVE  WRK-KOH-KINGAKU  TO
                                  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                END-IF
              END-IF
            END-IF
      *     全国公費の月上限額到達日の収納データがある
            IF   TBL-HKNFTNDATA-FLG2(KOHFTN-IDX) =  1
               COMPUTE WRK-KEISAN4 = WRK-TAIHI-FTNMONEY(KOHFTN-IDX + 1)
                                   + WRK-TAIHI-FTNMONEY-SAGAKU
                                                       (KOHFTN-IDX + 1)
               IF  RECE02-FTNMONEY(KOHFTN-IDX + 1) NOT = WRK-KEISAN4
                 DISPLAY   "BE="  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                 MOVE WRK-KEISAN4 TO
                                  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                 DISPLAY   "AF="  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                 IF   WRK-KOH-KINGAKU < RECE02-FTNMONEY(KOHFTN-IDX + 1)
                   MOVE  WRK-KOH-KINGAKU TO
                                  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                                  RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                   DISPLAY "AF2=" RECE02-FTNMONEY(KOHFTN-IDX + 1)
                 END-IF
               END-IF
            END-IF
           END-IF
      *
           .
       21095-KOH-ICHIBUFTN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄一部負担金チェック
      *****************************************************************
       21096-HOKEN-ICHIBUFTN-CHK-SEC               SECTION.
      *
           MOVE     ZERO    TO   FLG-HOKENICHIBU-CHK
           IF   RECE02-SRYYM   <=  "201203"
             IF  (RECE02-ZAITAKU        = "2" )
             AND (FLG-HOKENICHIBU5  NOT = ZERO)
                   MOVE     1     TO    FLG-HOKENICHIBU-CHK
             END-IF
           ELSE
             IF  (RECE02-ZAITAKU        = "2" )
             AND (FLG-HOKENICHIBU5  NOT = ZERO)
                IF  FLG-HOKENICHIBU6  NOT = ZERO
                   MOVE     1     TO    FLG-HOKENICHIBU-CHK
                ELSE
      *************COMPUTE WRK-FTNKEI5 = WRK-JYOGENKBN-TEN3
                   COMPUTE WRK-FTNKEI5 = WRK-JYOGENKBN-TEN6
                                       * 10
                                       * RECE02-KYURATE
                                       / 100
                   IF    WRK-FTNKEI5  >=  21000
                      MOVE     1     TO    FLG-HOKENICHIBU-CHK
                   END-IF
                END-IF
             END-IF
           END-IF
      *
           EVALUATE  RECE02-ZAITAKU
             WHEN      "1"
                 COMPUTE  WRK-HANTEI-TOTALTEN = WRK-TAIHI-TOTALTEN
                                              - RECE02-TOTALTEN(2)
             WHEN      "2"
               IF    FLG-HOKENICHIBU-CHK  =  1
                 MOVE   WRK-TAIHI-TOTALTEN  TO  WRK-HANTEI-TOTALTEN
               ELSE
                 COMPUTE  WRK-HANTEI-TOTALTEN = WRK-TAIHI-TOTALTEN
                                              - RECE02-TOTALTEN(2)
               END-IF
           END-EVALUATE
           IF   FLG-CHIIKI   =   1
           AND  FLG-CHIIKI2  =   1
             PERFORM  21094X-JYOGENGAKU-HENSYU2-SEC
           ELSE
             PERFORM  21094-JYOGENGAKU-HENSYU-SEC
           END-IF
           IF   FLG-KOH  =   2
             IF  WRK-FTNMONEY-ATO  NOT = 999999999
               COMPUTE  WRK-CHK-KOKIGAK2 = WRK-FTNMONEY-ATO
                                         - WRK-KOH-GAI
             ELSE
               COMPUTE  WRK-CHK-KOKIGAK2 = RECE02-FTNMONEY(2)
                                         - WRK-KOH-GAI
             END-IF
           ELSE
             IF  WRK-FTNMONEY-MAE  NOT = 999999999
               MOVE  WRK-FTNMONEY-MAE    TO  WRK-CHK-KOKIGAK2
             ELSE
               MOVE  RECE02-FTNMONEY(2)  TO  WRK-CHK-KOKIGAK2
               IF   (RECE02-ZAITAKU          = "2")
               AND  (WRK-KOGAKU-TAISYOGAI(1) =  1 )
                 MOVE  WRK-TAIHI-FTNMONEY2(2)
                                         TO  WRK-CHK-KOKIGAK2
               END-IF
             END-IF
           END-IF
      *
           EVALUATE  RECE02-ZAITAKU
             WHEN      "1"
                 IF   WRK-KINGAKU3  >  WRK-CHK-KOKIGAK2
                   COMPUTE  WRK-CHK-KOKIGAK5  =  WRK-KINGAKU3
                                              -  WRK-CHK-KOKIGAK2
                 ELSE
                   MOVE     ZERO         TO    WRK-CHK-KOKIGAK5
                 END-IF
             WHEN      "2"
               IF    FLG-HOKENICHIBU-CHK  =  1
                 IF   WRK-KINGAKU3  >  WRK-CHK-KOKIGAK2
                   COMPUTE  WRK-CHK-KOKIGAK5  =  WRK-KINGAKU3
                                              -  WRK-CHK-KOKIGAK2
                 ELSE
                   MOVE     ZERO         TO    WRK-CHK-KOKIGAK5
                 END-IF
               ELSE
                 MOVE     WRK-KINGAKU3   TO    WRK-CHK-KOKIGAK5
               END-IF
           END-EVALUATE
      *
           COMPUTE  WRK-HANTEI-TOTALTEN = WRK-TAIHI-TOTALTEN
                                        - RECE02-TOTALTEN(2)
           COMPUTE  WRK-CHK-KOKIGAK6 = WRK-HANTEI-TOTALTEN
                                     * 10
                                     * RECE02-KYURATE
                                     / 100
           COMPUTE  WRK-CHK-KOKIGAK6 = WRK-CHK-KOKIGAK6 +  5
           COMPUTE  WRK-CHK-KOKIGAK6 = WRK-CHK-KOKIGAK6 / 10
           COMPUTE  WRK-CHK-KOKIGAK6 = WRK-CHK-KOKIGAK6 * 10
      *
           IF   WRK-CHK-KOKIGAK5  >  WRK-CHK-KOKIGAK6
             MOVE   WRK-CHK-KOKIGAK6   TO  WRK-CHK-KOKIGAK7
           ELSE
             MOVE   WRK-CHK-KOKIGAK5   TO  WRK-CHK-KOKIGAK7
           END-IF
      *
           COMPUTE  WRK-CHK-KOKIGAK = RECE02-FTNMONEY(1)
                                    - FTN-KOH-XXX
           IF   WRK-CHK-KOKIGAK  NOT =  WRK-CHK-KOKIGAK7
             IF  (FLG-HOKENICHIBU2  NOT = ZERO)
             AND (FLG-HOKENICHIBU3      = ZERO)
             AND (FLG-HOKENICHIBU-SYU   =  1  )
                  COMPUTE  WRK-SKY-FTNMONEY-XXX =
                           WRK-SKY-FTNMONEY-XXX +
                          (RECE02-FTNMONEY(1)   -
                           (WRK-CHK-KOKIGAK7    +    FTN-KOH-XXX))
                  DISPLAY  "5:WRK-SKY-FTNMONEY-XXX="
                              WRK-SKY-FTNMONEY-XXX
      *           地方公費がレセプト請求でない場合の対処
                  IF   RECE02-SRYYM   >=  "202001"
                  AND  FLG-CHIIKIX     =   1
                    COMPUTE  WRK-SKY-FTNMONEY-XX2 =
                             WRK-SKY-FTNMONEY-XX2 +
                            (RECE02-FTNMONEY(1)   -
                             (WRK-CHK-KOKIGAK7    +    FTN-KOH-XXX))
                    DISPLAY  "5:WRK-SKY-FTNMONEY-XX2="
                                WRK-SKY-FTNMONEY-XX2
                  END-IF
             END-IF
      *
             COMPUTE  RECE02-FTNMONEY(1) = WRK-CHK-KOKIGAK7
                                         + FTN-KOH-XXX
      *
             IF     (FLG-CHIIKI                  =   1        )
             AND    (RECE02-SRYYM               >=  "200804"  )
             AND    (RECE02-ZAITAKU-SAIKEI2  NOT =   999999999)
               MOVE  WRK-CHK-KOKIGAK7  TO  RECE02-ZAITAKU-SAIKEI2
               IF    RECE02-ZAITAKU-SAIKEI2  =   ZERO
                  MOVE       1         TO  RECE02-SAIKEIZEROKSI2
               END-IF
             END-IF
      *
             IF   FLG-KOH  =   2
               COMPUTE  RECE02-FTNMONEY(2) = WRK-CHK-KOKIGAK2
                                           + WRK-CHK-KOKIGAK7
             END-IF
      *
             IF   FLG-HOKENICHIBU-SYU    = ZERO
             AND  FLG-HOKENICHIBU2   NOT = ZERO
             AND  FLG-HOKENICHIBU3   NOT = ZERO
                  MOVE   1    TO   RECE02-RJNNYUKOHFTN(3)
             END-IF
           END-IF
      *
           .
       21096-HOKEN-ICHIBUFTN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の括弧再掲（下）金額加算
      *****************************************************************
       21099-SAIKEIKIN-KASAN-SEC               SECTION.
      *
           IF   FLG-ZENKOKUKOHI-NISYU   =   2
             IF  (((RECE02-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE02-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))
             AND (  RECE02-KOHNUM(2)(1:1) >=  "1" AND <= "8"   )
             AND (  TBL-TOKATUKAIFLG(2)    =  ZERO             )
               IF  (WRK-TAIHI-TOTALTEN   =  RECE02-HENTOTALTEN(3))
               OR  (CNT-HKNCOMBI-KOHARI  =   1                   )
                 MOVE       1      TO     FLG-ZENKOKUKOHI-NISYU6
                 IF   FLG-ZENKOKUKOHI-NISYU5 = 2
                      PERFORM       210991-SAIKEIKIN-KASAN2-SEC
                 END-IF
               ELSE
                      CONTINUE
      *####           PERFORM       210992-SAIKEIKIN-KASAN3-SEC
               END-IF
             END-IF
             IF  (  RECE02-KOHNUM(1)(1:1)  =  "0"              )
             AND (  RECE02-KOHNUM(1)   NOT =  "012" AND "025"  )
             AND (  RECE02-KOHNUM(2)       =  "972" OR "974"   )
             AND (  RECE02-KOHNUM(3)(1:1) >=  "1" AND <= "8"   )
             AND (  TBL-TOKATUKAIFLG(3)    =  ZERO             )
               IF  (WRK-TAIHI-TOTALTEN   =  RECE02-HENTOTALTEN(4))
               OR  (CNT-HKNCOMBI-KOHARI  =   1                   )
                 MOVE       1      TO     FLG-ZENKOKUKOHI-NISYU6
                 IF   FLG-ZENKOKUKOHI-NISYU5 = 2
                      PERFORM       210991-SAIKEIKIN-KASAN2-SEC
                 END-IF
               ELSE
                      CONTINUE
      *####           PERFORM       210992-SAIKEIKIN-KASAN3-SEC
               END-IF
             END-IF
             IF  (  RECE02-KOHNUM(1)       =  "972" OR "974"   )
             AND (  TBL-TOKATUKAIFLG(2)    =   1               )
             AND (  RECE02-KOHNUM(3)(1:1) >=  "1" AND <= "8"   )
             AND (  TBL-TOKATUKAIFLG(3)    =  ZERO             )
               IF  (WRK-TAIHI-TOTALTEN   =  RECE02-HENTOTALTEN(4))
               OR  (CNT-HKNCOMBI-KOHARI  =   1                   )
                 MOVE       1      TO     FLG-ZENKOKUKOHI-NISYU6
                 IF   FLG-ZENKOKUKOHI-NISYU5 = 2
                      PERFORM       210991-SAIKEIKIN-KASAN2-SEC
                 END-IF
               ELSE
                      CONTINUE
      *####           PERFORM       210992-SAIKEIKIN-KASAN3-SEC
               END-IF
             END-IF
           END-IF
      *
           IF   FLG-ZENKOKUKOHI-NISYU   =   3
             IF  (((RECE02-KOHNUM(1)(1:1)  =  "0"            ) AND
                   (RECE02-KOHNUM(1)   NOT =  "012" AND "025")) OR
                  ( TBL-TOKATUKAIFLG(1)    =   1              ))
             AND (  RECE02-KOHNUM(2)(1:1) >=  "1" AND <= "8"   )
             AND (  TBL-TOKATUKAIFLG(2)    =  ZERO             )
                 MOVE       1      TO     FLG-ZENKOKUKOHI-NISYU6
                 IF   FLG-ZENKOKUKOHI-NISYU5 = 3
                      PERFORM       210991-SAIKEIKIN-KASAN2-SEC
                 END-IF
             END-IF
             IF  (  RECE02-KOHNUM(1)(1:1)  =  "0"              )
             AND (  RECE02-KOHNUM(1)   NOT =  "012" AND "025"  )
             AND (  RECE02-KOHNUM(2)       =  "972" OR "974"   )
             AND (  RECE02-KOHNUM(3)(1:1) >=  "1" AND <= "8"   )
             AND (  TBL-TOKATUKAIFLG(3)    =  ZERO             )
                 MOVE       1      TO     FLG-ZENKOKUKOHI-NISYU6
                 IF   FLG-ZENKOKUKOHI-NISYU5 = 4
                      PERFORM       210991-SAIKEIKIN-KASAN2-SEC
                 END-IF
             END-IF
             IF  (  RECE02-KOHNUM(1)       =  "972" OR "974"   )
             AND (  TBL-TOKATUKAIFLG(2)    =   1               )
             AND (  RECE02-KOHNUM(3)(1:1) >=  "1" AND <= "8"   )
             AND (  TBL-TOKATUKAIFLG(3)    =  ZERO             )
                 MOVE       1      TO     FLG-ZENKOKUKOHI-NISYU6
                 IF   FLG-ZENKOKUKOHI-NISYU5 = 4
                      PERFORM       210991-SAIKEIKIN-KASAN2-SEC
                 END-IF
             END-IF
           END-IF
      *
           IF   FLG-ZENKOKUKOHI-NISYU   =   1 OR 8 OR 9
             IF  ((((RECE02-KOHNUM(1)(1:1)  =  "0"            ) AND
                    (RECE02-KOHNUM(1)   NOT =  "012" AND "025")) OR
                   ( TBL-TOKATUKAIFLG(1)    =   1              )) AND
                  (((RECE02-KOHNUM(2)(1:1)  =  "0"            ) AND
                    (RECE02-KOHNUM(2)   NOT =  "012" AND "025")) OR
                   ( TBL-TOKATUKAIFLG(2)    =   1              )) AND
                  (  RECE02-KOHNUM(3)(1:1) >=  "1" AND <= "8"   ) AND
                  (  TBL-TOKATUKAIFLG(3)    =  ZERO             ))
             OR  ((((RECE02-KOHNUM(1)(1:1)  =  "0"            ) AND
                    (RECE02-KOHNUM(1)   NOT =  "012" AND "025")) OR
                   ( TBL-TOKATUKAIFLG(1)    =   1              )) AND
                  (((RECE02-KOHNUM(2)(1:1)  =  "0"            ) AND
                    (RECE02-KOHNUM(2)   NOT =  "012" AND "025")) OR
                   ( TBL-TOKATUKAIFLG(2)    =   1              )) AND
                  (  RECE02-KOHNUM(3)       =  "972" OR "974"   ) AND
                  (  RECE02-KOHNUM(4)(1:1) >=  "1" AND <= "8"   ) AND
                  (  TBL-TOKATUKAIFLG(4)    =  ZERO             ))
             OR  ((  RECE02-KOHNUM(1)(1:1)  =  "0"              ) AND
                  (  RECE02-KOHNUM(1)   NOT =  "012" AND "025"  ) AND
                  (  RECE02-KOHNUM(2)       =  "972" OR "974"   ) AND
                  (  TBL-TOKATUKAIFLG(3)    =   1               ) AND
                  (  RECE02-KOHNUM(4)(1:1) >=  "1" AND <= "8"   ) AND
                  (  TBL-TOKATUKAIFLG(4)    =  ZERO             ))
             OR  ((  RECE02-KOHNUM(1)       =  "972" OR "974"   ) AND
                  (  TBL-TOKATUKAIFLG(2)    =   1               ) AND
                  (  TBL-TOKATUKAIFLG(3)    =   1               ) AND
                  (  RECE02-KOHNUM(4)(1:1) >=  "1" AND <= "8"   ) AND
                  (  TBL-TOKATUKAIFLG(4)    =  ZERO             ))
                    CONTINUE
      *####         PERFORM       210992-SAIKEIKIN-KASAN3-SEC
             END-IF
           END-IF
      *
           .
       21099-SAIKEIKIN-KASAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の括弧再掲（下）金額加算
      *****************************************************************
       210991-SAIKEIKIN-KASAN2-SEC               SECTION.
      *
           IF   FLG-KOH  =   2
             IF  WRK-FTNMONEY-ATO  NOT = 999999999
               COMPUTE  WRK-CHK-KOKIGAK8 = WRK-FTNMONEY-ATO
                                         - WRK-KOH-GAI
             ELSE
               COMPUTE  WRK-CHK-KOKIGAK8 = RECE02-FTNMONEY(2)
                                         - WRK-KOH-GAI
             END-IF
           ELSE
             IF  WRK-FTNMONEY-MAE  NOT = 999999999
               MOVE  WRK-FTNMONEY-MAE   TO  WRK-CHK-KOKIGAK8
             ELSE
               MOVE  RECE02-FTNMONEY(2) TO  WRK-CHK-KOKIGAK8
             END-IF
           END-IF
           COMPUTE  RECE02-ZAITAKU-SAIKEI2 =
                    RECE02-ZAITAKU-SAIKEI2 +
                    WRK-CHK-KOKIGAK8
      ***  IF    RECE02-ZAITAKU-SAIKEI2  =  ZERO
      ***     MOVE     1     TO   RECE02-SAIKEIZEROKSI2
      ***  ELSE
      ***     MOVE    ZERO   TO   RECE02-SAIKEIZEROKSI2
      ***  END-IF
      *
           .
       210991-SAIKEIKIN-KASAN2-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険欄の括弧再掲（下）金額加算２
      *****************************************************************
       210992-SAIKEIKIN-KASAN3-SEC               SECTION.
      *
           MOVE      1       TO   FLG-ZENKOKUKOHI-NISYU6
           MOVE     ZERO     TO   IDY7
           PERFORM  VARYING  IDY5  FROM  2  BY  1
                     UNTIL  (IDY5                    >   5  )
                      OR    (RECE02-KOHNUM(IDY5 - 1) = SPACE)
             IF   RECE02-KOHNUM(IDY5 - 1) = "972" OR "974"
               CONTINUE
             ELSE
               ADD   1       TO   IDY7
             END-IF
             IF   RECE02-EKF-SAIKEIKSI(IDY5) = "1"
               MOVE       ZERO     TO   FLG-CHECK-OK
               MOVE       ZERO     TO   WRK-KASANKIN
               PERFORM  VARYING  IDY6  FROM  1  BY  1
                          UNTIL (IDY6                  >  10 )
                           OR   (RECE02-HKNCOMBI(IDY6) = ZERO)
                 IF  (RECE02-KOHNUM(IDY5 - 1) =
                                       RECE02-KOHNUMHC(IDY6 2))
                 AND (RECE02-KOHID (IDY5 - 1) =
                                       RECE02-KOHIDHC (IDY6 2))
                   IF ((RECE02-KOHNUMHC(IDY6 1)(1:1) = "0"  ) AND
                       (RECE02-KOHNUMHC(IDY6 1)  NOT =
                                             "012" AND "025")) 
                   OR ((SYS-1001-PREFNUM             =  13  ) AND
                       (RECE02-KOHNUMHC(IDY6 1)      = "151") AND
                       (RECE02-SRYYM             >= "200905"))
                   OR ((SYS-1001-PREFNUM             =  23  ) AND
                       (RECE02-KOHNUMHC(IDY6 1)      = "191") AND
                       (RECE02-SRYYM             >= "200910"))
                   OR ((SYS-1001-PREFNUM       =  23 OR 24  ) AND
                       (RECE02-KOHNUMHC(IDY6 1)      = "152") AND
                       (RECE02-SRYYM             >= "201104") AND
                       (RECE02-SRYYM             <= "201412"))
                     MOVE    1     TO   FLG-CHECK-OK
                     IF   RECE02-EKF-KINGAKKSN(IDY5) = "1"
                       COMPUTE WRK-KASANKIN = WRK-KASANKIN
                                            + RECE02-KOHFTNKIN(IDY6 1)
                     END-IF
                   END-IF
                 END-IF
               END-PERFORM
               IF    FLG-CHECK-OK  =  1
                 EVALUATE    IDY5
                   WHEN       3
                         ADD    WRK-KASANKIN
                                       TO   RECE02-ZAITAKU-SAIKEI2
                   WHEN       4
                     EVALUATE  IDY7
                       WHEN      2
                         ADD    WRK-KASANKIN
                                       TO   RECE02-ZAITAKU-SAIKEI2
                       WHEN      3
                         MOVE   ZERO   TO   RECE02-ZAITAKU-SAIKEI3
                         MOVE    1     TO   RECE02-SAIKEIZEROKSI3
                         ADD    WRK-KASANKIN
                                       TO   RECE02-ZAITAKU-SAIKEI3
                     END-EVALUATE
                   WHEN       5
                     EVALUATE  IDY7
                       WHEN      2
                         ADD    WRK-KASANKIN
                                       TO   RECE02-ZAITAKU-SAIKEI2
                       WHEN      3
                         MOVE   ZERO   TO   RECE02-ZAITAKU-SAIKEI3
                         MOVE    1     TO   RECE02-SAIKEIZEROKSI3
                         ADD    WRK-KASANKIN
                                       TO   RECE02-ZAITAKU-SAIKEI3
                       WHEN      4
                         MOVE   ZERO   TO   RECE02-ZAITAKU-SAIKEI4
                         MOVE    1     TO   RECE02-SAIKEIZEROKSI4
                         ADD    WRK-KASANKIN
                                       TO   RECE02-ZAITAKU-SAIKEI4
                     END-EVALUATE
                 END-EVALUATE
               END-IF
             END-IF
           END-PERFORM
      *
           .
       210992-SAIKEIKIN-KASAN3-EXT.
           EXIT.
      *
      *****************************************************************
      *    全国公費併用時の地方公費一部負担金編集
      *****************************************************************
       2109A-CHIHO-ICHIBUFTN-HEN-SEC               SECTION.
      *
           IF  (((RECE02-KOHNUM(1)(1:1) = "0"            ) AND
                 (RECE02-KOHNUM(1)  NOT = "012" AND "025"))  OR
                ( TBL-TOKATUKAIFLG(1)   =  1              ))
           AND (RECE02-KOHNUM(2)(1:1) >= "1" AND <= "8"    )
           AND (TBL-TOKATUKAIFLG(2)    = ZERO              )
           AND (RECE02-TOTALTEN(2)  = RECE02-HENTOTALTEN(3))
            MOVE   1   TO   IDX38
            MOVE   2   TO   IDX39
            PERFORM  2109A1-CHIHO-ICHIBUFTN-HEN1-SEC
            IF    FLG-OK = ZERO
             IF   (WRK-TAIHI-FTNMONEY-EN(2) =
                                     WRK-TAIHI-FTNMONEY-EN(3) )
             AND  (WRK-TAIHI-FTNMONEY-EN(2)  NOT = ZERO       )
             AND  (RECE02-FTNMONEY(2)        NOT = ZERO       )
                MOVE  RECE02-FTNMONEY(2)     TO  RECE02-FTNMONEY(3)
                MOVE  RECE02-FTNMONEY-KOJ(2) TO  RECE02-FTNMONEY-KOJ(3)
             END-IF
             IF    RECE02-FTNMONEY(2)            = ZERO
             AND   RECE02-FTNMONEY-KOJ(2)        = ZERO
                MOVE  ZERO                   TO  RECE02-FTNMONEY(3)
                                                 RECE02-FTNMONEY-KOJ(3)
             END-IF
            END-IF
           END-IF
      *
           IF  ((RECE02-KOHNUM(1)(1:1) = "0"            ) AND
                (RECE02-KOHNUM(1)  NOT = "012" AND "025")  )
           AND (RECE02-KOHNUM(2)       = "972" OR "974"    )
           AND (RECE02-KOHNUM(3)(1:1) >= "1" AND <= "8"    )
           AND (TBL-TOKATUKAIFLG(3)    = ZERO              )
           AND (RECE02-TOTALTEN(2)  = RECE02-HENTOTALTEN(4))
            MOVE   1   TO   IDX38
            MOVE   3   TO   IDX39
            PERFORM  2109A1-CHIHO-ICHIBUFTN-HEN1-SEC
            IF    FLG-OK = ZERO
             IF   (WRK-TAIHI-FTNMONEY-EN(2) =
                                     WRK-TAIHI-FTNMONEY-EN(4) )
             AND  (WRK-TAIHI-FTNMONEY-EN(2)  NOT = ZERO       )
             AND  (RECE02-FTNMONEY(2)        NOT = ZERO       )
                MOVE  RECE02-FTNMONEY(2)     TO  RECE02-FTNMONEY(4)
                MOVE  RECE02-FTNMONEY-KOJ(2) TO  RECE02-FTNMONEY-KOJ(4)
             END-IF
             IF    RECE02-FTNMONEY(2)            = ZERO
             AND   RECE02-FTNMONEY-KOJ(2)        = ZERO
                MOVE  ZERO                   TO  RECE02-FTNMONEY(4)
                                                 RECE02-FTNMONEY-KOJ(4)
             END-IF
            END-IF
           END-IF
      *
           IF  (RECE02-KOHNUM(1)       = "972" OR "974"    )
           AND (TBL-TOKATUKAIFLG(2)    =  1                )
           AND (RECE02-KOHNUM(3)(1:1) >= "1" AND <= "8"    )
           AND (TBL-TOKATUKAIFLG(3)    = ZERO              )
           AND (RECE02-TOTALTEN(3)  = RECE02-HENTOTALTEN(4))
            MOVE   2   TO   IDX38
            MOVE   3   TO   IDX39
            PERFORM  2109A1-CHIHO-ICHIBUFTN-HEN1-SEC
            IF    FLG-OK = ZERO
             IF   (WRK-TAIHI-FTNMONEY-EN(3) =
                                     WRK-TAIHI-FTNMONEY-EN(4) )
             AND  (WRK-TAIHI-FTNMONEY-EN(3)  NOT = ZERO       )
             AND  (RECE02-FTNMONEY(3)        NOT = ZERO       )
                MOVE  RECE02-FTNMONEY(3)     TO  RECE02-FTNMONEY(4)
                MOVE  RECE02-FTNMONEY-KOJ(3) TO  RECE02-FTNMONEY-KOJ(4)
             END-IF
             IF    RECE02-FTNMONEY(3)            = ZERO
             AND   RECE02-FTNMONEY-KOJ(3)        = ZERO
                MOVE  ZERO                   TO  RECE02-FTNMONEY(4)
                                                 RECE02-FTNMONEY-KOJ(4)
             END-IF
            END-IF
           END-IF
      *
           .
       2109A-CHIHO-ICHIBUFTN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    全国公費併用時の地方公費一部負担金編集
      *****************************************************************
       2109A1-CHIHO-ICHIBUFTN-HEN1-SEC               SECTION.
      *
           MOVE    ZERO   TO   FLG-OK
           IF   RECE02-HKNCOMBI(2)  =  ZERO
            CONTINUE
           ELSE
            PERFORM  VARYING  IDX37  FROM  1  BY  1
                      UNTIL  (IDX37                  >  10 )
                       OR    (RECE02-HKNCOMBI(IDX37) = ZERO)
                       OR    (FLG-OK                 =  1  )
             IF ((RECE02-KOHNUMHC(IDX37 1) =  RECE02-KOHNUM(IDX38)) AND
                 (RECE02-KOHIDHC (IDX37 1) =  RECE02-KOHID (IDX38)))
             OR ((RECE02-KOHNUMHC(IDX37 2) =  RECE02-KOHNUM(IDX38)) AND
                 (RECE02-KOHIDHC (IDX37 2) =  RECE02-KOHID (IDX38)))
             OR ((RECE02-KOHNUMHC(IDX37 3) =  RECE02-KOHNUM(IDX38)) AND
                 (RECE02-KOHIDHC (IDX37 3) =  RECE02-KOHID (IDX38)))
             OR ((RECE02-KOHNUMHC(IDX37 4) =  RECE02-KOHNUM(IDX38)) AND
                 (RECE02-KOHIDHC (IDX37 4) =  RECE02-KOHID (IDX38)))
              IF ((RECE02-KOHNUMHC(IDX37 1) =  RECE02-KOHNUM(IDX39)) AND
                  (RECE02-KOHIDHC (IDX37 1) =  RECE02-KOHID (IDX39)))
              OR ((RECE02-KOHNUMHC(IDX37 2) =  RECE02-KOHNUM(IDX39)) AND
                  (RECE02-KOHIDHC (IDX37 2) =  RECE02-KOHID (IDX39)))
              OR ((RECE02-KOHNUMHC(IDX37 3) =  RECE02-KOHNUM(IDX39)) AND
                  (RECE02-KOHIDHC (IDX37 3) =  RECE02-KOHID (IDX39)))
              OR ((RECE02-KOHNUMHC(IDX37 4) =  RECE02-KOHNUM(IDX39)) AND
                  (RECE02-KOHIDHC (IDX37 4) =  RECE02-KOHID (IDX39)))
                CONTINUE
              ELSE
                MOVE   1   TO   FLG-OK
              END-IF
             ELSE
              IF ((RECE02-KOHNUMHC(IDX37 1) =  RECE02-KOHNUM(IDX39)) AND
                  (RECE02-KOHIDHC (IDX37 1) =  RECE02-KOHID (IDX39)))
              OR ((RECE02-KOHNUMHC(IDX37 2) =  RECE02-KOHNUM(IDX39)) AND
                  (RECE02-KOHIDHC (IDX37 2) =  RECE02-KOHID (IDX39)))
              OR ((RECE02-KOHNUMHC(IDX37 3) =  RECE02-KOHNUM(IDX39)) AND
                  (RECE02-KOHIDHC (IDX37 3) =  RECE02-KOHID (IDX39)))
              OR ((RECE02-KOHNUMHC(IDX37 4) =  RECE02-KOHNUM(IDX39)) AND
                  (RECE02-KOHIDHC (IDX37 4) =  RECE02-KOHID (IDX39)))
                MOVE   1   TO   FLG-OK
              END-IF
             END-IF
            END-PERFORM
           END-IF
      *
           .
       2109A1-CHIHO-ICHIBUFTN-HEN1-EXT.
           EXIT.
      *
      *****************************************************************
      *    乳幼児・幼児のコメントフラグセット
      *****************************************************************
       2110-NYUYOJI-COMENTFLG-SET-SEC               SECTION.
      *
           IF   RECE02-SRYYM  >= "200604"
             IF   ((CNT-SAISIN-ETC      NOT =  ZERO) AND
                   (CNT-SAISIN-DOUJITU  NOT =  ZERO))
             OR   ((CNT-SAISIN-ETC      NOT =  ZERO) AND
                   (CNT-SAISIN-ONLINE   NOT =  ZERO))
             OR   ((CNT-SAISIN-DOUJITU  NOT =  ZERO) AND
                   (CNT-SAISIN-ONLINE   NOT =  ZERO))
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
             END-IF
             IF    (CNT-NYUYOJI         NOT =  ZERO        )
             AND   (CNT-SAISIN-ETC      NOT =  CNT-NYUYOJI )
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
             END-IF
             IF     RECE02-NYUYOJIFLG       =  SPACE
               IF  (CNT-NYUYOJI2        NOT =  ZERO        )
               AND (CNT-SAISIN-ETC      NOT =  CNT-NYUYOJI2)
                     MOVE     "1"        TO   RECE02-NYUYOJIFLG
               END-IF
             END-IF
             IF   RECE02-SRYYM  >= "201004"
               IF    (CNT-JIKANTAI1    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-JIKANTAI1)
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
               END-IF
               IF    (CNT-KOKENKSN     NOT =  ZERO        )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-KOKENKSN)
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
               END-IF
               IF    (CNT-JIKANTAI3    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-JIKANTAI3)
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
               END-IF
               IF    (CNT-MESAIKSN     NOT =  ZERO        )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-MESAIKSN)
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
               END-IF
               IF    (CNT-CHIHOKATU    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-CHIHOKATU)
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
               END-IF
               IF    (CNT-CHIHOKAT2    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-CHIHOKAT2)
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
               END-IF
               IF    (CNT-CHIHOKAT3    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-CHIHOKAT3)
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
               END-IF
               IF    (CNT-CHIHOKAT4    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-CHIHOKAT4)
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
               END-IF
               IF    (CNT-YAKRENKEI    NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-YAKRENKEI)
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
               END-IF
               IF    (CNT-NINPU        NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-NINPU    )
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
               END-IF
               IF    (CNT-NINPU2       NOT =  ZERO         )
               AND   (CNT-SAISIN-ETC   NOT =  CNT-NINPU2   )
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
               END-IF
             END-IF
           ELSE
             IF     RECE02-NYUYOJIFLG      =  SPACE
               IF     CNT-NYUYOJI      NOT =  ZERO
                 IF   RECE02-KAISU(2)  NOT =  CNT-NYUYOJI
                     MOVE     "1"        TO   RECE02-NYUYOJIFLG
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
                 END-IF
               END-IF
             END-IF
             IF     RECE02-NYUYOJIFLG      =  SPACE
               IF     CNT-YOJI         NOT =  ZERO
                 IF   RECE02-KAISU(2)  NOT =  CNT-YOJI
                     MOVE     "2"        TO   RECE02-NYUYOJIFLG
                     MOVE   ZERO         TO   RECE02-KHNTEN(2)
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           .
       2110-NYUYOJI-COMENTFLG-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    一部負担金額の置き換え等
      *****************************************************************
       2111-ICHIBUFUTAN-OKIKAE-SEC               SECTION.
      *
           IF    RECE02-ZAITAKU     =  "1" OR "2"
              CONTINUE
           ELSE
              IF  (RECE02-KOHNUM(1) =  "010"         )
              AND (RECE02-KOHNUM(2) =  "012" OR "025")
              AND (RECE02-KOHNUM(3) =  SPACE         )
              AND (RECE02-KOHNUM(4) =  SPACE         )
                 MOVE     2    TO    KOHFTN-IDX
                 PERFORM  21111-KOHFTN-KINGAKU-SEC
                 IF  (WRK-GAIJGNGAK  NOT =  ZERO              )
                 AND (WRK-GAIJGNGAK  >
                               RECE02-FTNMONEY(KOHFTN-IDX + 1))
                    IF WRK-GAIJGNGAK  >
                              WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1)
                      COMPUTE RECE02-FTNMONEY(KOHFTN-IDX + 1)        =
                              WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                              0.5
                      COMPUTE RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                              WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                              0.5
                    ELSE
                      COMPUTE RECE02-FTNMONEY(KOHFTN-IDX + 1)        =
                              WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1)
                      COMPUTE RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                              WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1)
                    END-IF
                 END-IF
              END-IF
           END-IF
      *
           EVALUATE   SYS-1001-PREFNUM
      *
             WHEN    "01"
      *
                IF     (RECE02-KOHNUM(1)    =  "051" OR "091")
                AND    (RECE02-KOHHBTNUM(2) =  "41"          )
                AND    (RECE02-SRYYM       <=  "200803"      )
      *
                   COMPUTE  WRK-FTNKEI =  RECE02-TOTALTEN(3)
                                       *  10
                                       *  RECE02-HON-GAIKFTNRATE(2)
                                       /  100
                   MOVE RECE02-FTNMONEY(3) TO RECE02-KOH-SAIKEI
                   MOVE 1                  TO RECE02-KOH-SAIKEIFLG
                   MOVE WRK-FTNKEI         TO RECE02-FTNMONEY(3)
                                              RECE02-FTNMONEY-KOJ(3)
      *
                END-IF
      *
             WHEN    "05"
      *
                IF   RECE02-SRYYM   >=  "200508"
                  PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                            UNTIL    KOHFTN-IDX     >    4
                    IF  (RECE02-KOHNUM(KOHFTN-IDX) =
                          "374" OR "474" OR "280"                 )
                    AND (RECE02-HON-GAIMNAIJGNGAK(KOHFTN-IDX)
                                 > RECE02-FTNMONEY(KOHFTN-IDX + 1))
                      IF RECE02-HON-GAIMNAIJGNGAK(KOHFTN-IDX) >
                                WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1)
                        COMPUTE RECE02-FTNMONEY(KOHFTN-IDX + 1)        =
                                WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                                0.5
                        COMPUTE RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                                WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                                0.5
                      ELSE
                        COMPUTE RECE02-FTNMONEY(KOHFTN-IDX + 1)        =
                                WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1)
                        COMPUTE RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                                WRK-TAIHI-FTNMONEY-EN(KOHFTN-IDX + 1)
      *
                        COMPUTE WRK-KOH-KINGAKU                        =
                                RECE02-TOTALTEN(KOHFTN-IDX + 1)        *
                                10                                     *
                                RECE02-KYURATE                         /
                                100
                        COMPUTE WRK-KOH-KINGAKU                        =
                               (WRK-KOH-KINGAKU * 0.5) + 0.5
                        IF  WRK-KOH-KINGAKU
                                 < RECE02-FTNMONEY(KOHFTN-IDX + 1)
                           COMPUTE RECE02-FTNMONEY(KOHFTN-IDX + 1)     =
                                   WRK-KOH-KINGAKU
                           COMPUTE RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1) =
                                   WRK-KOH-KINGAKU
                        END-IF
                      END-IF
                      MOVE    RECE02-FTNMONEY(KOHFTN-IDX + 1)
                                            TO  WRK-SKY-FTNMONEY-KOH
                    END-IF
                  END-PERFORM
                END-IF
      *
             WHEN    "13"
      *
                IF   RECE02-SRYYM   >=  "200710"
                AND  RECE02-SRYYM   <=  "200909"
                  PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                            UNTIL    KOHFTN-IDX     >    4
                    IF   RECE02-KOHNUM(KOHFTN-IDX) = "588"
                      COMPUTE  RECE02-FTNMONEY(KOHFTN-IDX + 1)        =
                               WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                               0.5
                      COMPUTE  RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                               WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                               0.5
                    END-IF
                  END-PERFORM
                END-IF
      *
                IF   RECE02-ZAITAKU  =  SPACE
                  PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                            UNTIL    KOHFTN-IDX     >    4
                    IF  (RECE02-KOHNUM(KOHFTN-IDX) = 
                          "180" OR "380" OR "181" OR "381"        )
                    AND (RECE02-HON-GAIMNAIJGNGAK(KOHFTN-IDX)
                                 > RECE02-FTNMONEY(KOHFTN-IDX + 1))
                      COMPUTE  RECE02-FTNMONEY(KOHFTN-IDX + 1)        =
                               WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                               0.5
                      COMPUTE  RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)    =
                               WRK-TAIHI-FTNMONEY-EN2(KOHFTN-IDX + 1) +
                               0.5
                    END-IF
                  END-PERFORM
                END-IF
      *
             WHEN    "40"
      *
                PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                            UNTIL    KOHFTN-IDX     >    4
      *
                   IF   RECE02-KOHHBTNUM(KOHFTN-IDX) =  "41"
      *
                          COMPUTE  WRK-FTNKEI =
                                   WRK-TAIHI-FTNMONEY-EN2
                                                  (KOHFTN-IDX + 1)
                          COMPUTE  WRK-FTNKEI = WRK-FTNKEI +  5
                          COMPUTE  WRK-FTNKEI = WRK-FTNKEI / 10
                          COMPUTE  WRK-FTNKEI = WRK-FTNKEI * 10
      *
                          MOVE     WRK-FTNKEI   TO
                                   RECE02-FTNMONEY(KOHFTN-IDX + 1)
                                   RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)
      *
                   END-IF
      *
                END-PERFORM
      *
           END-EVALUATE
      *
      *    公費一部負担金レセ記載フラグの編集
      *    公費一部負担金０円記載フラグの編集
      *
           PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                       UNTIL    KOHFTN-IDX     >    4
      *
              IF   RECE02-KOHNUM(KOHFTN-IDX)(1:1) >=  "1" AND <=  "8"
      *
                IF  (RECE02-HON-GAIDJGNGAK(KOHFTN-IDX)    NOT = ZERO)
                OR  (RECE02-HON-GAIDJGNCNT(KOHFTN-IDX)    NOT = ZERO)
                OR  (RECE02-HON-GAIMNAIJGNGAK(KOHFTN-IDX) NOT = ZERO)
                OR  (RECE02-HON-GAIMGAIJGNGAK(KOHFTN-IDX) NOT = ZERO)
                OR  (RECE02-HON-GAIMJGNCNT(KOHFTN-IDX)    NOT = ZERO)
                OR  (RECE02-HON-GAIKJGNGAK(KOHFTN-IDX)    NOT = ZERO)
                    MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                END-IF
      *
                IF    RECE02-SRYYM        >=  "200404"
                  IF ((SYS-1001-PREFNUM          =   05           ) AND
                      (RECE02-KOHNUM(KOHFTN-IDX) =  "174"         ))
                  OR ((SYS-1001-PREFNUM          =   12           ) AND
                      (RECE02-KOHNUM(KOHFTN-IDX) =  "183"         ))
                  OR ((SYS-1001-PREFNUM          =   34           ) AND
                      (RECE02-KOHNUM(KOHFTN-IDX) =  "391" OR "392"))
                    MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE02-SRYYM        >=  "200610"
                  IF  (SYS-1001-PREFNUM          =   25      )
                  AND (RECE02-KOHNUM(KOHFTN-IDX)(1:1)
                                          >=  "1" AND <=  "8")
                    MOVE  "1" TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF  (SYS-1001-PREFNUM          =   33      )
                  AND (RECE02-KOHNUM(KOHFTN-IDX)(1:1)
                                          >=  "1" AND <=  "8")
                    MOVE  "1" TO  RECE02-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE02-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE02-EKF-OCRFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1" TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE02-SRYYM        >=  "200810"
                  IF  (SYS-1001-PREFNUM          =   01  )
                  AND (RECE02-KOHNUM(KOHFTN-IDX) =  "183")
                    MOVE "1" TO  RECE02-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE02-SRYYM        >=  "201610"
                  IF  (SYS-1001-PREFNUM          =   36  )
                  AND (RECE02-KOHNUM(KOHFTN-IDX) =  "149")
                    IF  RECE02-TOTALTEN(KOHFTN-IDX + 1) = ZERO
                      MOVE SPACE TO RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    END-IF
                  END-IF
                END-IF
      *
                IF   WRK-KOHJGNGET-TAISYOKBN(KOHFTN-IDX)  NOT = ZERO
                   IF  (SYS-1001-PREFNUM          =   28  )
                   AND (RECE02-KOHNUM(KOHFTN-IDX) =  "186")
                     MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                   ELSE
                     MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                     MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                     IF ((SYS-1001-PREFNUM          =   01  ) AND
                         (RECE02-KOHNUM(KOHFTN-IDX) =  "183"))
                     OR ((SYS-1001-PREFNUM          =   23  ) AND
                         (RECE02-KOHNUM(KOHFTN-IDX) =  "191"))
                       IF  RECE02-KOHFTNJANUM(KOHFTN-IDX)(5:3)  = "602"
                         CONTINUE
                       ELSE
                         MOVE SPACE TO RECE02-KISAIFLG(KOHFTN-IDX + 1)
                         MOVE SPACE TO
                                   RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                       END-IF
                     END-IF
                   END-IF
                END-IF
      *
                PERFORM   21114-ETCHENSYU-SEC
      *
                IF    RECE02-SRYYM        >=  "201410"
                   IF  (SYS-1001-PREFNUM   =  32             )
                   AND (RECE02-KOHNUM(KOHFTN-IDX)(1:1)
                                          >=  "1" AND <=  "8")
                         MOVE SPACE TO
                                   RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                   END-IF
                END-IF
      *
                IF   (RECE02-MJK-ZEROKISAIFLG(KOHFTN-IDX + 1) =  "2")
                AND  (RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)     =  "1")
                  MOVE  SPACE TO RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                END-IF
                IF   (RECE02-MJK-JNISSUFLG(KOHFTN-IDX + 1)   =  "2")
                AND  (RECE02-EKF-JNISSUFLG(KOHFTN-IDX + 1)   =  "1")
                  MOVE  SPACE TO RECE02-EKF-JNISSUFLG(KOHFTN-IDX + 1)
                END-IF
                IF   (RECE02-MJK-TOTALTENFLG(KOHFTN-IDX + 1) =  "2")
                AND  (RECE02-EKF-TOTALTENFLG(KOHFTN-IDX + 1) =  "1")
                  MOVE  SPACE TO RECE02-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                END-IF
                IF   (RECE02-MJK-KISAIFLG(KOHFTN-IDX + 1)    =  "2")
                AND  (RECE02-KISAIFLG(KOHFTN-IDX + 1)        =  "1")
                  MOVE  SPACE TO RECE02-KISAIFLG(KOHFTN-IDX + 1)
                END-IF
                IF   (RECE02-MJK-OCRFLG(KOHFTN-IDX + 1)      =  "2")
                AND  (RECE02-EKF-OCRFLG(KOHFTN-IDX + 1)      =  "1")
                  MOVE  SPACE TO RECE02-EKF-OCRFLG(KOHFTN-IDX + 1)
                END-IF
      *
              ELSE
      *
                IF    RECE02-SRYYM        >=  "200404"
                  IF   RECE02-KOHNUM(KOHFTN-IDX) =  "015" OR "016"
                                                          OR "051"
                    MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF   RECE02-KOHNUM(KOHFTN-IDX) =  "012"
                    MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE SPACE  TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF  (RECE02-KOHNUM(KOHFTN-IDX) =  "010" OR "021")
                  AND (RECE02-HOTEIGAIFLG(KOHFTN-IDX + 1) = "1"   )
                    MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE02-SRYYM        >=  "200504"
                  IF   RECE02-KOHNUM(KOHFTN-IDX) =  "052"
                    MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF   (RECE02-SRYYM        >=  "200510")
                AND  (RECE02-SRYYM        <=  "200809")
                  IF  ( SYS-1001-PREFNUM          =   01   )
                  AND ( RECE02-KOHNUM(KOHFTN-IDX) =  "051" )
                  AND ((RECE02-KOHJKYSNUM(KOHFTN-IDX)(1:2)
                                      >= "91" AND <= "95" ) OR
                       (RECE02-KOHJKYSNUM(KOHFTN-IDX)(1:2)
                                      >= "71" AND <= "88" ))
                    MOVE  "1" TO  RECE02-EKF-TOTALTENFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE02-SRYYM        >=  "200604"
                  IF   RECE02-KOHNUM(KOHFTN-IDX) =  "021"
                    MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF   RECE02-KOHNUM(KOHFTN-IDX) =  "012"
                    MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    IF   ( KOHFTN-IDX        =     1   )
                    AND  ( RECE02-HKNNUM     =   SPACE )
                    AND  ( RECE02-KOHNUM(2)  =   SPACE )
                    AND  ( RECE02-KOHNUM(3)  =   SPACE )
                    AND  ( RECE02-KOHNUM(4)  =   SPACE )
                     MOVE SPACE TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    END-IF
                  END-IF
                END-IF
      *
                IF    RECE02-SRYYM        >=  "200610"
                  IF   RECE02-KOHNUM(KOHFTN-IDX) =  "024" OR "079"
                    MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE02-SRYYM        >=  "200704"
                  IF  (RECE02-ZAITAKU            =  "1" OR "2")
                  AND (RECE02-KOHNUM(KOHFTN-IDX) =  "010"     )
                    MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE02-SRYYM        >=  "200804"
                  IF   RECE02-KOHNUM(KOHFTN-IDX) =  "038" OR "025"
                    MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                  IF   RECE02-KOHNUM(KOHFTN-IDX) =  "025"
                    IF   ( KOHFTN-IDX        =     1   )
                    AND  ( RECE02-HKNNUM     =   SPACE )
                    AND  ( RECE02-KOHNUM(2)  =   SPACE )
                    AND  ( RECE02-KOHNUM(3)  =   SPACE )
                    AND  ( RECE02-KOHNUM(4)  =   SPACE )
                     MOVE SPACE TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                    END-IF
                  END-IF
                END-IF
      *
                IF    RECE02-SRYYM        >=  "201501"
                  IF   RECE02-KOHNUM(KOHFTN-IDX) =  "054"
                    MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE02-SRYYM        >=  "202004"
                  IF   RECE02-KOHNUM(KOHFTN-IDX) =  "093"
                    MOVE  "1"   TO  RECE02-KISAIFLG(KOHFTN-IDX + 1)
                    MOVE  "1"   TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
                IF    RECE02-SRYYM        >=  "200804"
                  IF  (RECE02-HKNNUM       =   SPACE               )
                  AND (RECE02-KOHNUM(KOHFTN-IDX) =
                       "015" OR "016" OR "021" OR "024" OR "038" OR
                       "051" OR "052" OR "054" OR "079" OR
                       "012" OR "025"                              )
                  AND (TBL-HKNFTNDATA-JGNXXX(KOHFTN-IDX) = ZERO    )
                  AND (RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1) = "1"   )
                  AND (SYS-200501-KOUHI-ICHIBU-KSIKBN      = "0"   )
                    MOVE SPACE  TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
                  END-IF
                END-IF
      *
              END-IF
      *
           END-PERFORM
      *
           PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                       UNTIL    KOHFTN-IDX     >    4
      *
             IF  (RECE02-EKF-FTNKEIFLG(KOHFTN-IDX + 1)    =  "1")
             AND (RECE02-FTNMONEY(KOHFTN-IDX + 1)     NOT = ZERO)
                MOVE  ZERO  TO  RECE02-FTNMONEY(KOHFTN-IDX + 1)
                MOVE  SPACE TO  RECE02-ZEROKISAIFLG(KOHFTN-IDX + 1)
             END-IF
      *
           END-PERFORM
      *
      *    一部負担金・食事療養費標準負担額区分の編集
      *
           IF    ((RECE02-SRYYM          >=  "201204") AND
                  (RECE02-ZAITAKU     NOT =   SPACE  ) AND
                  (RECE02-TEISYOTOKU  NOT =   SPACE  ))
           OR    ((RECE02-SRYYM          <   "201204") AND
                  (RECE02-TEISYOTOKU  NOT =   SPACE  ))
               EVALUATE    RECE02-TEISYOTOKU
                   WHEN    "1"
                   WHEN    "4"
                       MOVE    "3"   TO   RECE02-SHOKUJIFTNKBN
                   WHEN    "2"
                       MOVE    "1"   TO   RECE02-SHOKUJIFTNKBN
               END-EVALUATE
      **@      IF   (RECE02-SRYYM      >=  "201204"  )
      **@      AND  (RECE02-ZAITAKU     =  "2" OR "3")
      **@      AND  (RECE02-TEISYOTOKU  =  "1" OR "4")
      **@              MOVE    "1"   TO   RECE02-SHOKUJIFTNKBN
      **@              DISPLAY "SHOKUJIFTNKBN OKIKAE"
      **@      END-IF
           END-IF
           PERFORM  VARYING   KOHFTN-IDX   FROM   1   BY   1
                     UNTIL    KOHFTN-IDX     >    4
             EVALUATE  RECE02-TEISYOTOKU2(KOHFTN-IDX)
               WHEN    "1"
                 MOVE   "3"  TO   RECE02-SHOKUJIFTNKBN2(KOHFTN-IDX)
               WHEN    "2"
                 MOVE   "1"  TO   RECE02-SHOKUJIFTNKBN2(KOHFTN-IDX)
             END-EVALUATE
           END-PERFORM
      *
      *    在総診＋老人保険＋全国公費
           IF      RECE02-SRYYM      >=  "200404"
           AND     RECE02-SRYYM      <=  "200803"
      *
             PERFORM    VARYING   KOHFTN-IDX   FROM   1   BY   1
                         UNTIL    KOHFTN-IDX     >    4
      *
               IF  ( RECE02-ZAITAKU                  =  "1" OR "2" ) AND
                   ( RECE02-RJNHKNNUM            NOT =  SPACE      ) AND
                   ( RECE02-KOHNUM(KOHFTN-IDX)(1:1)  =  "0"        )
                  MOVE   FTN-KOH-XXX  TO
                                  RECE02-FTNMONEY-FTN(KOHFTN-IDX + 1)
               END-IF
      *
             END-PERFORM
      *
           END-IF
      *
      *    宮城県乳幼児
      *    北海道精神補助
      *
           EVALUATE   SYS-1001-PREFNUM
      *
             WHEN    "04"
      *
               IF   RECE02-SRYYM    >=   "200510"
               AND  RECE02-SRYYM    <=   "200803"
      *
                 PERFORM    VARYING   KOHFTN-IDX   FROM   2   BY   1
                             UNTIL    KOHFTN-IDX     >    5
      *
                   IF   TBL-KEISAN-FLG(KOHFTN-IDX)   NOT =  ZERO
      *
                      EVALUATE   TBL-KEISAN-FLG(KOHFTN-IDX)
                        WHEN         1
                            IF   RECE02-SRYYM   <=    "200603"
                               MOVE   0.25    TO     WRK-KEISU
                            END-IF
                            IF ( RECE02-SRYYM    >=   "200604" ) AND
                               ( RECE02-SRYYM    <=   "200703" )
                               MOVE   0.50    TO     WRK-KEISU
                            END-IF
                            IF ( RECE02-SRYYM    >=   "200704" ) AND
                               ( RECE02-SRYYM    <=   "200803" )
                               MOVE   0.75    TO     WRK-KEISU
                            END-IF
                            IF   RECE02-SRYYM    >=   "200804"
                               MOVE   1.00    TO     WRK-KEISU
                            END-IF
                        WHEN         2
                            MOVE      0.50    TO     WRK-KEISU
                      END-EVALUATE
      *
                      MOVE      TBL-KEISAN-ENTANI(KOHFTN-IDX)
                                              TO     WRK-KEISAN-COMPFTN
      *
                      COMPUTE   WRK-JYOSEIGAKU      =
                                WRK-KEISAN-COMPFTN  *  WRK-KEISU
                      COMPUTE   RECE02-FTNMONEY(KOHFTN-IDX)     =
                                WRK-KEISAN-COMPFTN  -  WRK-JYOSEIGAKU
                      COMPUTE   RECE02-FTNMONEY-KOJ(KOHFTN-IDX) =
                                WRK-KEISAN-COMPFTN  -  WRK-JYOSEIGAKU
      *
                   END-IF
      *
                 END-PERFORM
      *
               END-IF
      *
             WHEN    "01"
      *
               IF   RECE02-SRYYM    >=   "200604"
               AND  RECE02-SRYYM    <=   "200803"
      *
                 PERFORM    VARYING   KOHFTN-IDX   FROM   2   BY   1
                             UNTIL    KOHFTN-IDX     >    5
      *
                   IF   TBL-KEISAN-FLG(KOHFTN-IDX)   NOT =  ZERO
      *
                      MOVE      TBL-KEISAN-ENTANI(KOHFTN-IDX)
                                              TO     WRK-KEISAN-COMPFTN
      *
                      COMPUTE   WRK-JYOSEIGAKU      =
                                WRK-KEISAN-COMPFTN  *  0.5
                      COMPUTE   RECE02-FTNMONEY(KOHFTN-IDX)     =
                                WRK-KEISAN-COMPFTN  -  WRK-JYOSEIGAKU
                      COMPUTE   RECE02-FTNMONEY-KOJ(KOHFTN-IDX) =
                                WRK-KEISAN-COMPFTN  -  WRK-JYOSEIGAKU
      *
                   END-IF
      *
                 END-PERFORM
      *
               END-IF
      *
           END-EVALUATE
      *
           .
       2111-ICHIBUFUTAN-OKIKAE-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者公費負担（金額）取込み処理
      *****************************************************************
       21111-KOHFTN-KINGAKU-SEC               SECTION.
      *
           MOVE      ZERO             TO  WRK-GAIJGNGAK
      *
      *    公費月上限額取得
           INITIALIZE                     LNK-ORCSJGNGET-REC
grpsys     MOVE   RECE02-HOSPNUM      TO  LNK-ORCSJGNGET-HOSPNUM
           MOVE   RECE02-NYUGAIKBN    TO  LNK-ORCSJGNGET-NYUGAIKBN
           MOVE   RECE02-PTID         TO  LNK-ORCSJGNGET-PTID
           MOVE   RECE02-KOHNUM(KOHFTN-IDX)
                                      TO  LNK-ORCSJGNGET-KOHHKNNUM
           MOVE   RECE02-KOHID(KOHFTN-IDX)
                                      TO  LNK-ORCSJGNGET-KOHID
           MOVE   RECE02-SRYYM        TO  LNK-ORCSJGNGET-SRYYM
           IF     RECE02-KOHNUM(KOHFTN-IDX)(1:1) >=  "1" AND <=  "8"
              MOVE   WRK-KOHJGNGET-TAISYOKBN(KOHFTN-IDX)
                                      TO  LNK-ORCSJGNGET-SETKBN
              MOVE   WRK-KOHJGNGET-TEKIYOFLG(KOHFTN-IDX)
                                      TO  LNK-ORCSJGNGET-SETKBN2
           END-IF
      *
           CALL    "ORCSJGNGET"       USING
                                      LNK-ORCSJGNGET-REC
                                      SPA-AREA
      *
           IF     LNK-ORCSJGNGET-RC   =   ZERO
             MOVE    LNK-ORCSJGNGET-GAIJGNGAK
                                      TO  WRK-GAIJGNGAK
           END-IF
      *
           .
       21111-KOHFTN-KINGAKU-EXT.
           EXIT.
      *
      *****************************************************************
      *    その他編集
      *****************************************************************
       21114-ETCHENSYU-SEC               SECTION.
      *
           EVALUATE   SYS-1001-PREFNUM
      *
            WHEN    "32"
      *
             IF  (RECE02-SRYYM                    >=   "200708")
             AND (RECE02-SRYYM                    <=   "201409")
             AND (RECE02-KOHNUM(KOHFTN-IDX)        =   "191"   )
             AND (RECE02-KYURATE                   =    10     )
      *
              IF ((RECE02-TEISYOTOKU2(KOHFTN-IDX)  NOT =   SPACE  ) AND
                  (RECE02-SRYYM                       >=  "200708") AND
                  (RECE02-KOHFTNJANUM(KOHFTN-IDX)(5:3) =  "001"   ) AND
                  (RECE02-TOTALTEN(KOHFTN-IDX + 1)     <   4000   ))
              OR ((RECE02-TEISYOTOKU2(KOHFTN-IDX)  NOT =   SPACE  ) AND
                  (RECE02-SRYYM                       >=  "200904") AND
                  (RECE02-KOHFTNJANUM(KOHFTN-IDX)(5:3) =  "005"   ) AND
                  (RECE02-TOTALTEN(KOHFTN-IDX + 1)     <   4000   ))
              OR ((RECE02-TEISYOTOKU2(KOHFTN-IDX)  NOT =   SPACE  ) AND
                  (RECE02-SRYYM                       >=  "200912") AND
                  (RECE02-KOHFTNJANUM(KOHFTN-IDX)(5:3) =  "002"   ) AND
                  (RECE02-TOTALTEN(KOHFTN-IDX + 1)     <   4000   ))
              OR ((RECE02-TEISYOTOKU2(KOHFTN-IDX)      =   SPACE  ) AND
                  (RECE02-SRYYM                       >=  "200912") AND
                  (RECE02-KOHFTNJANUM(KOHFTN-IDX)(5:3) =  "002"   ) AND
                  (RECE02-TOTALTEN(KOHFTN-IDX + 1)     <  12000   ))
              OR ((RECE02-TEISYOTOKU2(KOHFTN-IDX)  NOT =   SPACE  ) AND
                  (RECE02-SRYYM                       >=  "201302") AND
                  (RECE02-KOHFTNJANUM(KOHFTN-IDX)(5:3) =  "003"   ) AND
                  (RECE02-TOTALTEN(KOHFTN-IDX + 1)     <   4000   ))
              OR ((RECE02-TEISYOTOKU2(KOHFTN-IDX)      =   SPACE  ) AND
                  (RECE02-SRYYM                       >=  "201302") AND
                  (RECE02-KOHFTNJANUM(KOHFTN-IDX)(5:3) =  "003"   ) AND
                  (RECE02-TOTALTEN(KOHFTN-IDX + 1)     <  12000   ))
                IF  RECE02-ZAITAKU =  "1"
                   CONTINUE
                ELSE
                   IF  TBL-KEISAN-FLG(KOHFTN-IDX + 1) = 1
                      MOVE  TBL-KEISAN-ENTANI(KOHFTN-IDX + 1)  TO
                              RECE02-FTNMONEY(KOHFTN-IDX + 1)
                              RECE02-FTNMONEY-KOJ(KOHFTN-IDX + 1)
                   END-IF
                END-IF
              END-IF
      *
             END-IF
      *
           END-EVALUATE
      *
           .
       21114-ETCHENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    包括点数の治験減点分編集
      *****************************************************************
       211H-GENTEN-HENSYU-SEC      SECTION.
      *
      *    再診のレセ点数の編集（減点）
           IF   RECE02-TENSU(2 1)  >=  RECE2G-TENSU(2 1)
             COMPUTE  RECE02-TENSU(2 1)  =
                      RECE02-TENSU(2 1)  -  RECE2G-TENSU(2 1)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(2 1)
           END-IF
           IF   RECE02-TENSU(2 2)  >=  RECE2G-TENSU(2 2)
             COMPUTE  RECE02-TENSU(2 2)  =
                      RECE02-TENSU(2 2)  -  RECE2G-TENSU(2 2)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(2 2)
           END-IF
           IF   RECE02-TENSU(2 3)  >=  RECE2G-TENSU(2 3)
             COMPUTE  RECE02-TENSU(2 3)  =
                      RECE02-TENSU(2 3)  -  RECE2G-TENSU(2 3)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(2 3)
           END-IF
           IF   RECE02-TENSU(2 4)  >=  RECE2G-TENSU(2 4)
             COMPUTE  RECE02-TENSU(2 4)  =
                      RECE02-TENSU(2 4)  -  RECE2G-TENSU(2 4)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(2 4)
           END-IF
           IF   RECE02-TENSU(2 5)  >=  RECE2G-TENSU(2 5)
             COMPUTE  RECE02-TENSU(2 5)  =
                      RECE02-TENSU(2 5)  -  RECE2G-TENSU(2 5)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(2 5)
           END-IF
           IF   RECE02-SYUTANTEN(2)  >=  RECE2G-SYUTANTEN(2)
             COMPUTE  RECE02-SYUTANTEN(2)  =
                      RECE02-SYUTANTEN(2)  -  RECE2G-SYUTANTEN(2)
           ELSE
             MOVE     ZERO    TO   RECE02-SYUTANTEN(2)
           END-IF
           IF   RECE02-ALLTENSU(2)   >=  RECE2G-ALLTENSU(2)
             COMPUTE  RECE02-ALLTENSU(2)   =
                      RECE02-ALLTENSU(2)   -  RECE2G-ALLTENSU(2)
           ELSE
             MOVE     ZERO    TO   RECE02-ALLTENSU(2)
           END-IF
      *
      *    指導のレセ点数の編集（減点）
           IF   RECE02-TENSU(7 1)  >=  RECE2G-TENSU(7 1)
             COMPUTE  RECE02-TENSU(7 1)  =
                      RECE02-TENSU(7 1)  -  RECE2G-TENSU(7 1)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(7 1)
           END-IF
           IF   RECE02-TENSU(7 2)  >=  RECE2G-TENSU(7 2)
             COMPUTE  RECE02-TENSU(7 2)  =
                      RECE02-TENSU(7 2)  -  RECE2G-TENSU(7 2)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(7 2)
           END-IF
           IF   RECE02-TENSU(7 3)  >=  RECE2G-TENSU(7 3)
             COMPUTE  RECE02-TENSU(7 3)  =
                      RECE02-TENSU(7 3)  -  RECE2G-TENSU(7 3)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(7 3)
           END-IF
           IF   RECE02-TENSU(7 4)  >=  RECE2G-TENSU(7 4)
             COMPUTE  RECE02-TENSU(7 4)  =
                      RECE02-TENSU(7 4)  -  RECE2G-TENSU(7 4)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(7 4)
           END-IF
           IF   RECE02-TENSU(7 5)  >=  RECE2G-TENSU(7 5)
             COMPUTE  RECE02-TENSU(7 5)  =
                      RECE02-TENSU(7 5)  -  RECE2G-TENSU(7 5)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(7 5)
           END-IF
           IF   RECE02-SYUTANTEN(7)  >=  RECE2G-SYUTANTEN(7)
             COMPUTE  RECE02-SYUTANTEN(7)  =
                      RECE02-SYUTANTEN(7)  -  RECE2G-SYUTANTEN(7)
           ELSE
             MOVE     ZERO    TO   RECE02-SYUTANTEN(7)
           END-IF
           IF   RECE02-ALLTENSU(7)   >=  RECE2G-ALLTENSU(7)
             COMPUTE  RECE02-ALLTENSU(7)   =
                      RECE02-ALLTENSU(7)   -  RECE2G-ALLTENSU(7)
           ELSE
             MOVE     ZERO    TO   RECE02-ALLTENSU(7)
           END-IF
      *
      *    在宅のレセ点数の編集（減点）
           IF   RECE02-TENSU(12 1)  >=  RECE2G-TENSU(12 1)
             COMPUTE  RECE02-TENSU(12 1)  =
                      RECE02-TENSU(12 1)  -  RECE2G-TENSU(12 1)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(12 1)
           END-IF
           IF   RECE02-TENSU(12 2)  >=  RECE2G-TENSU(12 2)
             COMPUTE  RECE02-TENSU(12 2)  =
                      RECE02-TENSU(12 2)  -  RECE2G-TENSU(12 2)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(12 2)
           END-IF
           IF   RECE02-TENSU(12 3)  >=  RECE2G-TENSU(12 3)
             COMPUTE  RECE02-TENSU(12 3)  =
                      RECE02-TENSU(12 3)  -  RECE2G-TENSU(12 3)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(12 3)
           END-IF
           IF   RECE02-TENSU(12 4)  >=  RECE2G-TENSU(12 4)
             COMPUTE  RECE02-TENSU(12 4)  =
                      RECE02-TENSU(12 4)  -  RECE2G-TENSU(12 4)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(12 4)
           END-IF
           IF   RECE02-TENSU(12 5)  >=  RECE2G-TENSU(12 5)
             COMPUTE  RECE02-TENSU(12 5)  =
                      RECE02-TENSU(12 5)  -  RECE2G-TENSU(12 5)
           ELSE
             MOVE     ZERO    TO   RECE02-TENSU(12 5)
           END-IF
           IF   RECE02-SYUTANTEN(12)  >=  RECE2G-SYUTANTEN(12)
             COMPUTE  RECE02-SYUTANTEN(12)  =
                      RECE02-SYUTANTEN(12)  -  RECE2G-SYUTANTEN(12)
           ELSE
             MOVE     ZERO    TO   RECE02-SYUTANTEN(12)
           END-IF
           IF   RECE02-ALLTENSU(12)   >=  RECE2G-ALLTENSU(12)
             COMPUTE  RECE02-ALLTENSU(12)   =
                      RECE02-ALLTENSU(12)   -  RECE2G-ALLTENSU(12)
           ELSE
             MOVE     ZERO    TO   RECE02-ALLTENSU(12)
           END-IF
      *
      *    合計点数の編集（減点）
           COMPUTE  RECE02-TOTALTEN(1)    =
                    RECE02-TOTALTEN(1)    -  RECE2G-TOTALTEN(1)
           COMPUTE  RECE02-HENTOTALTEN(1) =
                    RECE02-HENTOTALTEN(1) -  RECE2G-HENTOTALTEN(1)
           COMPUTE  RECE02-TOTALTEN(2)    =
                    RECE02-TOTALTEN(2)    -  RECE2G-TOTALTEN(2)
           COMPUTE  RECE02-HENTOTALTEN(2) =
                    RECE02-HENTOTALTEN(2) -  RECE2G-HENTOTALTEN(2)
           COMPUTE  RECE02-TOTALTEN(3)    =
                    RECE02-TOTALTEN(3)    -  RECE2G-TOTALTEN(3)
           COMPUTE  RECE02-HENTOTALTEN(3) =
                    RECE02-HENTOTALTEN(3) -  RECE2G-HENTOTALTEN(3)
           COMPUTE  RECE02-TOTALTEN(4)    =
                    RECE02-TOTALTEN(4)    -  RECE2G-TOTALTEN(4)
           COMPUTE  RECE02-HENTOTALTEN(4) =
                    RECE02-HENTOTALTEN(4) -  RECE2G-HENTOTALTEN(4)
           COMPUTE  RECE02-TOTALTEN(5)    =
                    RECE02-TOTALTEN(5)    -  RECE2G-TOTALTEN(5)
           COMPUTE  RECE02-HENTOTALTEN(5) =
                    RECE02-HENTOTALTEN(5) -  RECE2G-HENTOTALTEN(5)
      *
           .
       211H-GENTEN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    分点編集
      *****************************************************************
       211K-BUNTENSU-HENSYU-SEC               SECTION.
      *
           IF    RECE02-FUKUSHIFLG(3)  =  "2"
              IF  (RECE02-KOHNUM(2)(1:1)  >= "1" AND <= "8"  )
              AND (RECE02-HENTOTALTEN(3) = RECE02-TOTALTEN(3))
                  MOVE   SPACE   TO   RECE02-FUKUSHIFLG(3)
                  MOVE   2       TO   KOHFTN-IDX
                  PERFORM  211K1-FTNKBNFLG-CLEAR-SEC
              END-IF
           END-IF
           IF    RECE02-FUKUSHIFLG(4)  =  "2"
              IF  (RECE02-KOHNUM(3)(1:1)  >= "1" AND <= "8"  )
              AND (RECE02-HENTOTALTEN(4) = RECE02-TOTALTEN(4))
                  MOVE   SPACE   TO   RECE02-FUKUSHIFLG(4)
                  MOVE   3       TO   KOHFTN-IDX
                  PERFORM  211K1-FTNKBNFLG-CLEAR-SEC
              END-IF
           END-IF
           IF    RECE02-FUKUSHIFLG(5)  =  "2"
              IF  (RECE02-KOHNUM(4)(1:1)  >= "1" AND <= "8"  )
              AND (RECE02-HENTOTALTEN(5) = RECE02-TOTALTEN(5))
                  MOVE   SPACE   TO   RECE02-FUKUSHIFLG(5)
                  MOVE   4       TO   KOHFTN-IDX
                  PERFORM  211K1-FTNKBNFLG-CLEAR-SEC
              END-IF
           END-IF
      *
           PERFORM    VARYING   KOHFTN-IDX   FROM   3   BY   1
                       UNTIL    KOHFTN-IDX     >    5
      *
             IF   RECE02-FUKUSHIFLG(KOHFTN-IDX)   NOT =  SPACE
                IF   (RECE02-KOHNUM(1)   = "972" OR "974")
                AND  (KOHFTN-IDX         >   3           )
                  IF   RECE02-TOTALTEN(KOHFTN-IDX) = ZERO
                    PERFORM    VARYING   KOHFTN-IDX2   FROM   1   BY   1
                                UNTIL    KOHFTN-IDX2     >   50
                       MOVE  ZERO  TO
                                RECE02-TENSU(KOHFTN-IDX2 KOHFTN-IDX)
                    END-PERFORM
                  ELSE
                    PERFORM    VARYING   KOHFTN-IDX2   FROM   1   BY   1
                                UNTIL    KOHFTN-IDX2     >   50
                       COMPUTE  RECE02-TENSU(KOHFTN-IDX2 KOHFTN-IDX) =
                                RECE02-TENSU(KOHFTN-IDX2 1)          -
                                RECE02-TENSU(KOHFTN-IDX2 3)
                    END-PERFORM
                  END-IF
                ELSE
                  IF   RECE02-TOTALTEN(KOHFTN-IDX) = ZERO
                    PERFORM    VARYING   KOHFTN-IDX2   FROM   1   BY   1
                                UNTIL    KOHFTN-IDX2     >   50
                       MOVE  ZERO  TO
                                RECE02-TENSU(KOHFTN-IDX2 KOHFTN-IDX)
                    END-PERFORM
                  ELSE
                    PERFORM    VARYING   KOHFTN-IDX2   FROM   1   BY   1
                                UNTIL    KOHFTN-IDX2     >   50
                       COMPUTE  RECE02-TENSU(KOHFTN-IDX2 KOHFTN-IDX) =
                                RECE02-TENSU(KOHFTN-IDX2 1)          -
                                RECE02-TENSU(KOHFTN-IDX2 2)
                    END-PERFORM
                  END-IF
                END-IF
             END-IF
      *
           END-PERFORM
      *
           .
       211K-BUNTENSU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセ電用負担区分編集フラグクリア
      *****************************************************************
       211K1-FTNKBNFLG-CLEAR-SEC               SECTION.
      *
           PERFORM  VARYING  IDX13   FROM    1   BY  1
                     UNTIL  (IDX13                   >   10 )
                       OR   (RECE02-HKNCOMBI(IDX13)  =  ZERO)
      *
             IF  (RECE02-KOHNUMHC(IDX13 2) = RECE02-KOHNUM(KOHFTN-IDX))
             AND (RECE02-KOHIDHC(IDX13 2)  = RECE02-KOHID(KOHFTN-IDX) )
               MOVE      ZERO   TO   RECE02-FTNKBNFLG(IDX13 2)
               IF   (SYS-1001-PREFNUM         = "36"    )
               AND  (RECE02-KOHNUMHC(IDX13 2) = "245"   )
               AND  (RECE02-KOHNUMHC(IDX13 3) = "748"   )
               AND  (RECE02-SRYYM            >= "200805")
                  MOVE   ZERO   TO   RECE02-FTNKBNFLG(IDX13 3)
               END-IF
             END-IF
      *
           END-PERFORM
      *
           .
       211K1-FTNKBNFLG-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    災害該当者の判定
      *****************************************************************
       211L-SAIGAI-TAISYO-HANTEI-SEC      SECTION.
      *
           IF     RECE02-HKNNUM   NOT =   SPACE
             IF  (RECE02-HKNNUM(1:2)  =   "98"  OR "90"  OR "91" )
               CONTINUE
             ELSE
               MOVE      RECE02-SRYYM       TO   WK-GENGAKU-YM
               IF   RECE02-TEKSTYMD(1:6)  >=  RECE02-SRYYM
                  MOVE   RECE02-TEKSTYMD(7:2)
                                            TO   WK-GENGAKU-DD
               ELSE
                  MOVE   01                 TO   WK-GENGAKU-DD
               END-IF
      *
               MOVE      RECE02-SRYYM       TO   WK-GENGAKU2-YM
               IF   RECE02-TEKEDYMD-X(1:6) >  RECE02-SRYYM
                 INITIALIZE                      STS-AREA-DAY
                 INITIALIZE                      LNK-DAY7-AREA
                 MOVE   "71"                TO   LNK-DAY7-IRAI
                 MOVE   RECE02-SRYYM        TO   LNK-DAY7-YM
                 CALL   "ORCSDAY"         USING  STS-AREA-DAY
                                                 LNK-DAY7-AREA
                 MOVE   LNK-DAY7-KOYOMI     TO   WRK-EDYMD
                 MOVE   WRK-EDYMD(7:2)      TO   WK-GENGAKU2-DD
               ELSE
                 MOVE   RECE02-TEKEDYMD-X(7:2)
                                            TO   WK-GENGAKU2-DD
               END-IF
      *
               MOVE      RECE02-SRYYM       TO   WK-GENGAKU3-YM
               IF   RECE02-TEKSTYMD-X(1:6)  >=  RECE02-SRYYM
                  MOVE   RECE02-TEKSTYMD-X(7:2)
                                            TO   WK-GENGAKU3-DD
               ELSE
                  MOVE   01                 TO   WK-GENGAKU3-DD
               END-IF
      *
               PERFORM  211L1-SAIGAI-TAISYO-HENSYU-SEC
             END-IF
           ELSE
               MOVE      RECE02-SRYYM       TO   WK-GENGAKU-YM
               IF   RECE02-KOHTEKSTYMD(1)(1:6)
                                          >=  RECE02-SRYYM
                  MOVE   RECE02-KOHTEKSTYMD(1)(7:2)
                                            TO   WK-GENGAKU-DD
               ELSE
                  MOVE   01                 TO   WK-GENGAKU-DD
               END-IF
      *
               MOVE      RECE02-SRYYM       TO   WK-GENGAKU2-YM
               IF   RECE02-KOHTEKEDYMD(1)(1:6)
                                           >  RECE02-SRYYM
                 INITIALIZE                      STS-AREA-DAY
                 INITIALIZE                      LNK-DAY7-AREA
                 MOVE   "71"                TO   LNK-DAY7-IRAI
                 MOVE   RECE02-SRYYM        TO   LNK-DAY7-YM
                 CALL   "ORCSDAY"         USING  STS-AREA-DAY
                                                 LNK-DAY7-AREA
                 MOVE   LNK-DAY7-KOYOMI     TO   WRK-EDYMD
                 MOVE   WRK-EDYMD(7:2)      TO   WK-GENGAKU2-DD
               ELSE
                 MOVE   RECE02-KOHTEKEDYMD(1)(7:2)
                                            TO   WK-GENGAKU2-DD
               END-IF
      *
               MOVE     "99999999"          TO   WK-GENGAKU3-YMD
      *
               PERFORM  211L1-SAIGAI-TAISYO-HENSYU-SEC
           END-IF
      *
           .
       211L-SAIGAI-TAISYO-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    災害該当者の編集
      *****************************************************************
       211L1-SAIGAI-TAISYO-HENSYU-SEC      SECTION.
      *
           MOVE     SPACE    TO     WK-CHECK-TEKSTYMD
           MOVE     SPACE    TO     WK-CHECK-TEKEDYMD
      *
           INITIALIZE                       PTKOHINF-REC
           MOVE    RECE02-HOSPNUM       TO  PTKOH-HOSPNUM
           MOVE    RECE02-PTID          TO  PTKOH-PTID
           MOVE    "959"                TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC         TO  MCPDATA-REC
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key4"               TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC               =   ZERO
              MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
              MOVE    "key4"             TO  MCP-PATHNAME
              PERFORM  900-PTKOHINF-READ-SEC
              PERFORM  UNTIL   FLG-PTKOHINF    =   1
                IF ((PTKOH-TEKSTYMD  <=   WK-GENGAKU-YMD ) AND
                    (WK-GENGAKU-YMD  <=   PTKOH-TEKEDYMD ) AND
                    (PTKOH-SAKJOKBN   =   SPACE          ))
                OR ((PTKOH-TEKSTYMD  <=   WK-GENGAKU2-YMD) AND
                    (WK-GENGAKU2-YMD <=   PTKOH-TEKEDYMD ) AND
                    (PTKOH-SAKJOKBN   =   SPACE          ))
                OR ((PTKOH-TEKSTYMD  <=   WK-GENGAKU3-YMD) AND
                    (WK-GENGAKU3-YMD <=   PTKOH-TEKEDYMD ) AND
                    (WK-GENGAKU3-YMD NOT = "99999999"    ) AND
                    (PTKOH-SAKJOKBN   =   SPACE          ))
                  MOVE     1             TO  FLG-SAIGAI-TAISYO
      *
                  MOVE  PTKOH-TEKSTYMD   TO  WK-CHECK-TEKSTYMD
                  IF    PTKOH-TEKSTYMD(1:6)  <  RECE02-SRYYM
                    MOVE  RECE02-SRYYM   TO  WK-CHECK-TEKSTYMD(1:6)
                    MOVE  "01"           TO  WK-CHECK-TEKSTYMD(7:2)
                  END-IF
                  MOVE  PTKOH-TEKEDYMD   TO  WK-CHECK-TEKEDYMD
                  IF    PTKOH-TEKEDYMD(1:6)  >  RECE02-SRYYM
                    MOVE  RECE02-SRYYM   TO  WK-CHECK-TEKEDYMD(1:6)
                    MOVE  "31"           TO  WK-CHECK-TEKEDYMD(7:2)
                  END-IF
      *
                  MOVE     1             TO  FLG-PTKOHINF
                ELSE
                  MOVE    "tbl_ptkohinf" TO  MCP-TABLE
                  MOVE    "key4"         TO  MCP-PATHNAME
                  PERFORM  900-PTKOHINF-READ-SEC
                END-IF
              END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
           MOVE    "key4"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           MOVE     ZERO      TO  FLG-CHECK-ARI
           IF   FLG-SAIGAI-TAISYO  =  1
              PERFORM  211711-GENGAKU-CHECK-SEC
              IF   FLG-CHECK-ARI  =  ZERO
                MOVE   ZERO   TO  FLG-SAIGAI-TAISYO
              END-IF
           END-IF
      *
           .
       211L1-SAIGAI-TAISYO-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    減免適用チェック
      *****************************************************************
       2120-GENMEN-TEK-CHECK-SEC      SECTION.
      *
           IF   (WK-GENGAKUKBN             =   1  )
           AND  (WK-GENGAKUKBN-KEISAN  NOT =  ZERO)
           AND  (FLG-GENGAKU5              =  ZERO)
      *
             IF      RECE02-ZAITAKU  =  "1" OR "2"
               IF      FLG-JYOGENKBN   =   1
                  MOVE   WRK-JYOGENKBN-TEN     TO  WRK-HANTEI-TOTALTEN
      ***         IF   FLG-ZEROKOGAITO   =   1
      ***           PERFORM  21094X-JYOGENGAKU-HENSYU2-SEC
      ***         ELSE
                    PERFORM  21094-JYOGENGAKU-HENSYU-SEC
      ***         END-IF
                  MOVE   WRK-KINGAKU-GENBUTU3  TO  WK-GENGAKU-KEISAN9
               END-IF
             END-IF
      *
             IF   WK-GENGAKU-KEISAN9  NOT =  ZERO
             AND  WK-GENGAKU-KEISAN9      =  RECE02-FTNMONEY(1)
                   MOVE    ZERO    TO   RECE02-GENMENKBN
                   MOVE    ZERO    TO   RECE02-GENGAKURATE
                   MOVE    ZERO    TO   RECE02-GENMEN-COM
                   MOVE    ZERO    TO   WK-GENGAKUKBN
             END-IF
      *
           END-IF
      *
           IF   (WK-GENGAKUKBN   =    5  )
           AND  (FLG-GENGAKU5    =   ZERO)
      *
             IF      RECE02-ZAITAKU  =  "1" OR "2"
               IF      FLG-JYOGENKBN   =   1
                  MOVE   WRK-JYOGENKBN-TEN     TO  WRK-HANTEI-TOTALTEN
      ***         IF   FLG-ZEROKOGAITO   =   1
      ***           PERFORM  21094X-JYOGENGAKU-HENSYU2-SEC
      ***         ELSE
                    PERFORM  21094-JYOGENGAKU-HENSYU-SEC
      ***         END-IF
                  MOVE   WRK-KINGAKU-GENBUTU3  TO  WK-GENGAKU-KEISAN9
               END-IF
             END-IF
      *
             IF   WK-GENGAKU-KEISAN9  NOT =  ZERO
               IF   WK-GENGAKU-KEISAN9  <=  RECE02-GENGAKU
                   MOVE    ZERO    TO   RECE02-GENMENKBN
                   MOVE    ZERO    TO   RECE02-GENGAKU
                   MOVE    ZERO    TO   RECE02-GENMEN-COM
                   MOVE    ZERO    TO   WK-GENGAKUKBN
               ELSE
                 IF   RECE02-GENGAKU  >=  WK-GENGAKU-KEISAN3
                   MOVE    ZERO    TO   RECE02-GENMENKBN
                   MOVE    ZERO    TO   RECE02-GENGAKU
                   MOVE    ZERO    TO   RECE02-GENMEN-COM
                   MOVE    ZERO    TO   WK-GENGAKUKBN
                 ELSE
                   IF   WK-GENGAKU-KEISAN9  <  WK-GENGAKU-KEISAN3
                     MOVE  WK-GENGAKU-KEISAN9
                                   TO   WK-GENGAKU-KEISAN3
                   END-IF
                 END-IF
               END-IF
             ELSE
                 IF   RECE02-GENGAKU  >=  WK-GENGAKU-KEISAN3
                   MOVE    ZERO    TO   RECE02-GENMENKBN
                   MOVE    ZERO    TO   RECE02-GENGAKU
                   MOVE    ZERO    TO   RECE02-GENMEN-COM
                   MOVE    ZERO    TO   WK-GENGAKUKBN
                 END-IF
             END-IF
      *
           END-IF
      *
      **>  IF   (WK-GENGAKUKBN   =    5)
      **>  AND  (FLG-GENGAKU5    =    1)
      **>        IF   RECE02-GENGAKU  >=  WK-GENGAKU-KEISAN3
      **>          MOVE    ZERO    TO   RECE02-GENMENKBN
      **>          MOVE    ZERO    TO   RECE02-GENGAKU
      **>          MOVE    ZERO    TO   RECE02-GENMEN-COM
      **>          MOVE    ZERO    TO   WK-GENGAKUKBN
      **>        END-IF
      **>  END-IF
      *
           IF  ((WK-GENGAKUKBN             =   1  ) AND
                (WK-GENGAKUKBN-KEISAN  NOT =  ZERO) AND
                (FLG-GENGAKU5              =   1  ))
           OR  ((WK-GENGAKUKBN             =   2  ) AND
                (FLG-GENGAKU5              =   1  ))
           OR  ((WK-GENGAKUKBN             =   5  ) AND
                (FLG-GENGAKU5              =   1  ))
             DISPLAY "WK-GENGAKUKBN="  WK-GENGAKUKBN
             DISPLAY "WK-GENGAKUKBN-KEISAN="  WK-GENGAKUKBN-KEISAN
             DISPLAY "公費併用の保険組み合わせ有"
           END-IF
      *
           .
       2120-GENMEN-TEK-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ワークファイルクリア
      *****************************************************************
       211M-WRKFILE-CLEAR-SEC      SECTION.
      *
           IF  (IDZ                 =     1    )
           AND (RECE02-SRYYM       >=  "201004")
              MOVE   RECE02-FTNMONEY(1)  TO   RECE02-FTNMONEY-SKY
      *
              MOVE   FTN-KOH-XXX           TO  WRK-SAIKEI-TAIHI
      *
              IF   ((FTN-KOH-XX5            NOT =  ZERO) AND
                    (FTN-KOH-XX6            NOT =  ZERO) AND
                    (FTN-KOH-XX3                =  ZERO) AND
                    (FTN-KOH-XX8                =  ZERO))
              OR   ((FTN-KOH-XX5                =  ZERO) AND
                    (FTN-KOH-XX6            NOT =  ZERO) AND
                    (FTN-KOH-XX3                =  ZERO) AND
                    (FTN-KOH-XX8                =  ZERO) AND
                    (FLG-XX5-TUUKA          NOT =  ZERO))
                MOVE    FTN-KOH-XX5        TO  WRK-SAIKEI-TAIHI
              END-IF
              IF   FLG-KEISAN-TOK1  =  1
              AND  FLG-KEISAN-TOK2  =  1
                COMPUTE  WRK-KINGAKU-TOK3 = WRK-CHK-ICHIBUGAKU
                                          + WRK-KINGAKU-TOK1
                IF  WRK-KINGAKU-TOK3  >  WRK-KINGAKU-TOK7
                   MOVE  WRK-KINGAKU-TOK7  TO  WRK-SAIKEI-TAIHI
                ELSE
                   MOVE  WRK-KINGAKU-TOK3  TO  WRK-SAIKEI-TAIHI
                END-IF
              END-IF
              IF     FLG-KEISAN-TOK1            =  ZERO
              AND    FLG-KEISAN-TOK2            =  1
              AND    FTN-KOH-XX8                =  ZERO
              AND    FLG-ZENKOKUKOHI-NISYU  NOT =  4
              AND    FLG-XX8-TUUKA              =  ZERO
                COMPUTE  WRK-KINGAKU-TOK3 = WRK-CHK-ICHIBUGAKU
                                          + FTN-KOH-XX7
                IF  WRK-KINGAKU-TOK3  >  WRK-KINGAKU-TOK8
                   MOVE  WRK-KINGAKU-TOK8  TO  WRK-SAIKEI-TAIHI
                ELSE
                   MOVE  WRK-KINGAKU-TOK3  TO  WRK-SAIKEI-TAIHI
                END-IF
              END-IF
              IF     FLG-KEISAN-TOK1            =  ZERO
              AND    FLG-KEISAN-TOK2            =  1
              AND    FTN-KOH-XX8                =  ZERO
              AND    FLG-ZENKOKUKOHI-NISYU      =  4
                MOVE    FTN-KOH-XX4        TO  WRK-SAIKEI-TAIHI
              END-IF
              IF   ((FLG-KEISAN-TOK1            =  ZERO) AND
                    (FLG-KEISAN-TOK2            =  1   ) AND
                    (FTN-KOH-XX8            NOT =  ZERO))
              OR   ((FLG-KEISAN-TOK1            =  ZERO) AND
                    (FLG-KEISAN-TOK2            =  1   ) AND
                    (FTN-KOH-XX8                =  ZERO) AND
                    (FLG-ZENKOKUKOHI-NISYU  NOT =  4   ) AND
                    (FLG-XX8-TUUKA          NOT =  ZERO))
              OR   ((FTN-KOH-XX5                =  ZERO) AND
                    (FTN-KOH-XX6            NOT =  ZERO) AND
                    (FTN-KOH-XX8            NOT =  ZERO) AND
                    (FTN-KOH-XX3                =  ZERO))
              OR   ((FTN-KOH-XX5                =  ZERO) AND
                    (FTN-KOH-XX6            NOT =  ZERO) AND
                    (FTN-KOH-XX8                =  ZERO) AND
                    (FTN-KOH-XX3                =  ZERO) AND
                    (FLG-XX8-TUUKA          NOT =  ZERO))
              OR   ((FTN-KOH-XX5                =  ZERO) AND
                    (FTN-KOH-XX6                =  ZERO) AND
                    (FTN-KOH-XX8            NOT =  ZERO) AND
                    (FTN-KOH-XX3                =  ZERO) AND
                    (FLG-XX6-TUUKA          NOT =  ZERO))
                MOVE    FTN-KOH-XX8        TO  WRK-SAIKEI-TAIHI
              END-IF
      *
              IF   FLG-WRKFILE-CLEAR   =   1
                MOVE   FTN-KOH-XXX       TO   WRK-JIRITU-SAIKEI
                MOVE   FTN-KOH-XX3       TO   WRK-JIRITU-SAIKEI2
                MOVE   ZERO              TO   RECE02-FTNMONEY(1)
                MOVE   ZERO              TO   FLG-KEISAN-TOK1
                MOVE   ZERO              TO   FLG-KEISAN-TOK2
                MOVE   ZERO              TO   FTN-KOH-XXX
                MOVE   ZERO              TO   FTN-KOH-XX2
                MOVE   ZERO              TO   FTN-KOH-XX3
                MOVE   ZERO              TO   FTN-KOH-XX4
                MOVE   ZERO              TO   FTN-KOH-XX5
                MOVE   ZERO              TO   FTN-KOH-XX6
                MOVE   ZERO              TO   FTN-KOH-XX7
                MOVE   ZERO              TO   FTN-KOH-XX7X
                MOVE   ZERO              TO   FTN-KOH-XX8
              END-IF
           END-IF
      *
           .
       211M-WRKFILE-CLEAR-EXT.
           EXIT.
      *
      *****************************************************************
      *    請求額情報編集
      *****************************************************************
       211N-SKY-HENSYU-SEC      SECTION.
      *
      **   減免の免除・支払猶予以外は、災２の請求額情報編集は未対応
      *
           IF   (IDZ             =    1    )
           AND  (RECE02-SRYYM   >= "201004")
      *      主保険がある保険組み合わせ
             IF    (WRK-SKY-ZENGAKU      >  ZERO            )
             AND   (WRK-SKY-ICHIBUFTN    >  WRK-SKY-FTNMONEY)
               MOVE    ZERO    TO   FLG-KGK
               IF     RECE02-ZAITAKU  =  "1" OR "2"
                 COMPUTE      WRK-SKY-KEISAN  = WRK-SKY-ZENGAKU
                                              - WRK-SKY-HOKENJA
                 IF    (WRK-SKY-ICHIBUFTN  >  RECE02-FTNMONEY-SKY)
                 AND   (WRK-SKY-KEISAN     >  RECE02-FTNMONEY-SKY)
                   COMPUTE    WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                              - RECE02-FTNMONEY-SKY
                   IF   WRK-CHK-ICHIBUGAKU2  NOT =  ZERO
                     IF  WRK-SKY-FTNMONEY  >  RECE02-FTNMONEY-SKY
                       COMPUTE WRK-SKY-KEISAN5 = WRK-SKY-FTNMONEY
                                               - RECE02-FTNMONEY-SKY
                       IF  WRK-SKY-KEISAN2 > WRK-SKY-KEISAN5
                         COMPUTE WRK-SKY-KEISAN2 = WRK-SKY-KEISAN2
                                                 - WRK-SKY-KEISAN5
                       ELSE
                         MOVE    ZERO   TO   WRK-SKY-KEISAN2
                       END-IF
                     END-IF
                   END-IF
                   ADD    WRK-SKY-KEISAN2  TO  RECE02-SKYIRYO-HOKENJA
                 END-IF
                 IF   RECE02-SKYIRYO-HOKENJA > WRK-SKY-FTNMONEY-XX2
                   COMPUTE  RECE02-SKYIRYO-HOKENJA  =
                            RECE02-SKYIRYO-HOKENJA  -
                            WRK-SKY-FTNMONEY-XX2
                 ELSE
                   MOVE   ZERO             TO  RECE02-SKYIRYO-HOKENJA
                 END-IF
               ELSE
                 IF  (RECE02-ZAITAKU      =  SPACE)
                 OR  (WK-GENGAKUKBN   NOT =  ZERO )
                   IF   WRK-SKY-ZENGAKU-KOH   =   ZERO
                     COMPUTE    WRK-SKY-KEISAN  = WRK-SKY-ZENGAKU
                                                - WRK-SKY-HOKENJA
                     IF   WRK-SKY-KEISAN  >  WRK-SKY-FTNMONEY
                       COMPUTE  WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                                - WRK-SKY-FTNMONEY
                       ADD   WRK-SKY-KEISAN2
                                        TO  RECE02-SKYIRYO-HOKENJA
                     END-IF
                   ELSE
                     IF  (RECE02-ZAITAKU  NOT =  SPACE)
                     AND (WK-GENGAKUKBN   NOT =  ZERO )
                       IF   RECE02-FTNMONEY-SKY  >  WRK-SKY-FTNMONEY3
                         COMPUTE RECE02-FTNMONEY-SKY =
                                 RECE02-FTNMONEY-SKY -
                                 WRK-SKY-FTNMONEY3
                       ELSE
                         MOVE    ZERO        TO  RECE02-FTNMONEY-SKY
                       END-IF
                     END-IF
                     COMPUTE   WRK-SKY-KEISAN  = WRK-SKY-ZENGAKU-KOH
                                               - WRK-SKY-HOKENJA-KOH
                     IF   WRK-SKY-KEISAN  >  RECE02-FTNMONEY-SKY
                       COMPUTE WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                               - RECE02-FTNMONEY-SKY
                       ADD   WRK-SKY-KEISAN2
                                      TO  RECE02-SKYIRYO-HOKENJA
                       MOVE    1             TO  FLG-KGK
                     END-IF
                     IF   WK-GENGAKUKBN   NOT =  ZERO
                       COMPUTE   WRK-SKY-KEISAN5 = WRK-SKY-ZENGAKU
                                                 - WRK-SKY-ZENGAKU-KOH
                       COMPUTE   WRK-SKY-KEISAN6 = WRK-SKY-HOKENJA
                                                 - WRK-SKY-HOKENJA-KOH
                       COMPUTE   WRK-SKY-KEISAN  = WRK-SKY-KEISAN5
                                                 - WRK-SKY-KEISAN6
                       IF   WRK-SKY-KEISAN  >  WRK-SKY-FTNMONEY3
                         COMPUTE WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                                 - WRK-SKY-FTNMONEY3
                         ADD   WRK-SKY-KEISAN2
                                        TO  RECE02-SKYIRYO-HOKENJA
                       END-IF
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               MOVE WRK-SKY-FTNMONEY    TO  WRK-SKY-FTNMONEY9
               IF   WRK-SKY-FTNMONEY >= WRK-SKY-FTNMONEY-XXX
                 COMPUTE  WRK-SKY-FTNMONEY9         =
                          WRK-SKY-FTNMONEY          -
                          WRK-SKY-FTNMONEY-XXX
                 IF   RECE02-SRYYM   >=  "202001"
                   CONTINUE
                 ELSE
                   COMPUTE  RECE02-SKYIRYO-ICHIBUFTN  =
                            RECE02-SKYIRYO-ICHIBUFTN  -
                            WRK-SKY-FTNMONEY-XXX
                 END-IF
               END-IF
               IF  WRK-SKY-FTNMONEY-KOH2 = WRK-SKY-FTNMONEY-KOH3
                 COMPUTE    WRK-SKY-FTNMONEY-KOH9     =
                            WRK-SKY-FTNMONEY-KOH3
               ELSE
                 COMPUTE    WRK-SKY-FTNMONEY-KOH9     =
                            WRK-SKY-FTNMONEY-KOH      +
                            0.9
               END-IF
      *
               IF    FLG-KOHSKY-ARI  =  1
                 MOVE WRK-SKY-FTNMONEY-JYOKEN
                                        TO  WRK-SKY-FTNMONEY9-JYOKEN
                 IF   WRK-SKY-FTNMONEY-JYOKEN
                                     >= WRK-SKY-FTNMONEY-XXX
                   COMPUTE  WRK-SKY-FTNMONEY9-JYOKEN  =
                            WRK-SKY-FTNMONEY-JYOKEN   -
                            WRK-SKY-FTNMONEY-XXX
                 END-IF
                 COMPUTE    WRK-SKY-FTNMONEY-KOH9-JYOKEN =
                            WRK-SKY-FTNMONEY-KOH-JYOKEN  +
                            0.9
                 COMPUTE    WRK-KOHSKY-XXX-COMPFTN-EN-RUI9 =
                            WRK-KOHSKY-XXX-COMPFTN-EN-RUI  +
                            0.9
                 PERFORM  VARYING  IDX36  FROM  1  BY  1
                           UNTIL   IDX36    >  10
                   EVALUATE   WRK-KOHSKY-XXX-FLG(IDX36)
                     WHEN         1
                       MOVE     1   TO   WRK-KOHSKY-XXX-FLG-RUI1
                     WHEN         2
                       MOVE     1   TO   WRK-KOHSKY-XXX-FLG-RUI2
                   END-EVALUATE
                 END-PERFORM
               END-IF
      *
               IF   WRK-SKY-ZENGAKU-KOH  >  ZERO
                 IF     RECE02-ZAITAKU  =  "1" OR "2"
                   IF     RECE02-FTNMONEY-SKY
                                          >  WRK-SKY-FTNMONEY9
                     COMPUTE   WRK-SKY-KEISAN2 = RECE02-FTNMONEY-SKY
                                               - WRK-SKY-FTNMONEY9
                     ADD    WRK-SKY-KEISAN2  TO  RECE02-SKYIRYO-KOHFTN
                     IF     FLG-KOHSKY-ARI  =  1
                       MOVE WRK-SKY-KEISAN2  TO  WRK-SKY-SKYIRYO-KOHFTN
                       IF   WRK-KOHSKY-XXX-FLG-RUI1  =  ZERO
                       AND  WRK-KOHSKY-XXX-FLG-RUI2  =   1
                         MOVE  WRK-SKY-SKYIRYO-KOHFTN
                                   TO  RECE02-SKYIRYO-KOHFTN-KOHSKY
                       ELSE
                         COMPUTE   WRK-SKY-KEISAN2     =
                                   RECE02-FTNMONEY-SKY -
                                   WRK-SKY-FTNMONEY9-JYOKEN
                         IF   WRK-KOHSKY-XXX-FLG-RUI1  =  1
                         AND  WRK-KOHSKY-XXX-FLG-RUI2  =  1
                           MOVE    WRK-SAIKEI-TAIHI
                                     TO  WRK-SKY-KEISAN2
                         END-IF
                         IF   WRK-SKY-KEISAN2
                                   >= WRK-KOHSKY-XXX-COMPFTN-RUI
                           COMPUTE   WRK-SKY-KEISAN3 =
                                     WRK-SKY-KEISAN2 -
                                     WRK-KOHSKY-XXX-COMPFTN-RUI
                           IF   WRK-SKY-SKYIRYO-KOHFTN
                                   >= WRK-SKY-KEISAN3
                             COMPUTE   RECE02-SKYIRYO-KOHFTN-KOHSKY =
                                       WRK-SKY-SKYIRYO-KOHFTN       -
                                       WRK-SKY-KEISAN3
                           END-IF
                         END-IF
                       END-IF
                     END-IF
                   END-IF
                 ELSE
                   IF   FLG-KGK   =   1
                     IF   RECE02-FTNMONEY-SKY
                                          >  WRK-SKY-FTNMONEY-KOH9
                       COMPUTE WRK-SKY-KEISAN2 = RECE02-FTNMONEY-SKY
                                               - WRK-SKY-FTNMONEY-KOH9
                       ADD  WRK-SKY-KEISAN2  TO  RECE02-SKYIRYO-KOHFTN
                       IF     FLG-KOHSKY-ARI  =  1
                         MOVE WRK-SKY-KEISAN2
                                             TO  WRK-SKY-SKYIRYO-KOHFTN
                         IF   WRK-KOHSKY-XXX-FLG-RUI1  =  ZERO
                         AND  WRK-KOHSKY-XXX-FLG-RUI2  =   1
                           MOVE  WRK-SKY-SKYIRYO-KOHFTN
                                     TO  RECE02-SKYIRYO-KOHFTN-KOHSKY
                         ELSE
                           COMPUTE   WRK-SKY-KEISAN2     =
                                     RECE02-FTNMONEY-SKY -
                                     WRK-SKY-FTNMONEY-KOH9-JYOKEN
                           IF   WRK-KOHSKY-XXX-FLG-RUI1  =  1
                           AND  WRK-KOHSKY-XXX-FLG-RUI2  =  1
                             MOVE    WRK-SAIKEI-TAIHI
                                       TO  WRK-SKY-KEISAN2
                           END-IF
                           IF   WRK-SKY-KEISAN2
                                     >= WRK-KOHSKY-XXX-COMPFTN-EN-RUI9
                             COMPUTE   WRK-SKY-KEISAN3 =
                                       WRK-SKY-KEISAN2 -
                                       WRK-KOHSKY-XXX-COMPFTN-EN-RUI9
                             IF   WRK-SKY-SKYIRYO-KOHFTN
                                     >= WRK-SKY-KEISAN3
                               COMPUTE   RECE02-SKYIRYO-KOHFTN-KOHSKY =
                                         WRK-SKY-SKYIRYO-KOHFTN       -
                                         WRK-SKY-KEISAN3
                             END-IF
                           END-IF
                         END-IF
                       END-IF
                     ELSE
                       COMPUTE WRK-SKY-KEISAN2 = WRK-SKY-FTNMONEY-KOH9
                                               - RECE02-FTNMONEY-SKY
                       IF  RECE02-SKYIRYO-HOKENJA > WRK-SKY-KEISAN2
                         COMPUTE RECE02-SKYIRYO-HOKENJA =
                                 RECE02-SKYIRYO-HOKENJA -
                                 WRK-SKY-KEISAN2
                       ELSE
                         MOVE    ZERO    TO    RECE02-SKYIRYO-HOKENJA
                       END-IF
                     END-IF
                   ELSE
                     COMPUTE   WRK-SKY-KEISAN  = WRK-SKY-ZENGAKU-KOH
                                               - WRK-SKY-HOKENJA-KOH
                     IF   FLG-SKY-TOKKOH   =   1
                       COMPUTE WRK-SKY-KEISAN  = WRK-SKY-KEISAN +  5
                       COMPUTE WRK-SKY-KEISAN  = WRK-SKY-KEISAN / 10
                       COMPUTE WRK-SKY-KEISAN  = WRK-SKY-KEISAN * 10
                     END-IF
                     IF   WRK-SKY-KEISAN  >  WRK-SKY-FTNMONEY-KOH9
                       COMPUTE WRK-SKY-KEISAN2 = WRK-SKY-KEISAN
                                               - WRK-SKY-FTNMONEY-KOH9
                       ADD  WRK-SKY-KEISAN2  TO  RECE02-SKYIRYO-KOHFTN
                       IF     FLG-KOHSKY-ARI  =  1
                         MOVE WRK-SKY-KEISAN2
                                             TO  WRK-SKY-SKYIRYO-KOHFTN
                         IF   WRK-KOHSKY-XXX-FLG-RUI1  =  ZERO
                         AND  WRK-KOHSKY-XXX-FLG-RUI2  =   1
                           MOVE  WRK-SKY-SKYIRYO-KOHFTN
                                     TO  RECE02-SKYIRYO-KOHFTN-KOHSKY
                         ELSE
                           COMPUTE   WRK-SKY-KEISAN2     =
                                     WRK-SKY-KEISAN      -
                                     WRK-SKY-FTNMONEY-KOH9-JYOKEN
                           IF   WRK-KOHSKY-XXX-FLG-RUI1  =  1
                           AND  WRK-KOHSKY-XXX-FLG-RUI2  =  1
                             MOVE    WRK-SAIKEI-TAIHI
                                       TO  WRK-SKY-KEISAN2
                           END-IF
                           IF   WRK-SKY-KEISAN2
                                     >= WRK-KOHSKY-XXX-COMPFTN-EN-RUI9
                             COMPUTE   WRK-SKY-KEISAN3 =
                                       WRK-SKY-KEISAN2 -
                                       WRK-KOHSKY-XXX-COMPFTN-EN-RUI9
                             IF   WRK-SKY-SKYIRYO-KOHFTN
                                     >= WRK-SKY-KEISAN3
                               COMPUTE   RECE02-SKYIRYO-KOHFTN-KOHSKY =
                                         WRK-SKY-SKYIRYO-KOHFTN       -
                                         WRK-SKY-KEISAN3
                             END-IF
                           END-IF
                         END-IF
                       END-IF
                     END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF
      *      主保険がない保険組み合わせ
             IF    (WRK-SKY-ZENGAKU2     >  ZERO             )
             AND   (WRK-SKY-ZENGAKU2     >  WRK-SKY-FTNMONEY2)
               COMPUTE    WRK-SKY-KEISAN2  =  WRK-SKY-ZENGAKU2
                                           -  WRK-SKY-FTNMONEY2
               ADD    WRK-SKY-KEISAN2   TO  RECE02-SKYIRYO-KOHFTN
             END-IF
           ELSE
             INITIALIZE        RECE02-SKYIRYO-INF
           END-IF
      *
           .
       211N-SKY-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    再掲・一部負担金置き換え編集
      *****************************************************************
       211U-ICHIBUFUTAN-OKIKAE2-SEC      SECTION.
      *
           IF  (IDZ                 =   1        )
           AND (RECE02-ZAITAKU      =  "1" OR "2")
           AND (WRK-TAIHI-OKIKAE    =   1        )
      *      再掲上置き換え
             IF  ( RECE02-KOHNUM(1)           =  SPACE     )
             OR  ((RECE02-SAIKEI-CHIKAN-KIN1  =  009999999) AND
                  (RECE02-ZAITAKU-SAIKEI      =  999999999))
                 MOVE   123456789   TO   RECE02-SAIKEI-CHIKAN-KIN1
             END-IF
             IF    RECE02-SAIKEI-CHIKAN-KIN1  =  123456789
                 CONTINUE
             ELSE
               IF  RECE02-SAIKEI-CHIKAN-KIN1  =  009999999
                 MOVE   999999999   TO   RECE02-ZAITAKU-SAIKEI
               ELSE
                 MOVE      1        TO   RECE02-SAIKEIZEROKSI1
                 MOVE   RECE02-SAIKEI-CHIKAN-KIN1
                                    TO   RECE02-ZAITAKU-SAIKEI
               END-IF
             END-IF
      *      再掲下置き換え
             IF  ( RECE02-KOHNUM(2)           =  SPACE     )
             OR  ((RECE02-SAIKEI-CHIKAN-KIN2  =  009999999) AND
                  (RECE02-ZAITAKU-SAIKEI2     =  999999999))
                 MOVE   123456789   TO   RECE02-SAIKEI-CHIKAN-KIN2
             END-IF
             IF    RECE02-SAIKEI-CHIKAN-KIN2  =  123456789
                 CONTINUE
             ELSE
               IF  RECE02-SAIKEI-CHIKAN-KIN2  =  009999999
                 MOVE   999999999   TO   RECE02-ZAITAKU-SAIKEI2
               ELSE
                 MOVE      1        TO   RECE02-SAIKEIZEROKSI2
                 MOVE   RECE02-SAIKEI-CHIKAN-KIN2
                                    TO   RECE02-ZAITAKU-SAIKEI2
               END-IF
             END-IF
      *      再掲３置き換え
             IF  ( RECE02-KOHNUM(3)           =  SPACE     )
             OR  ((RECE02-SAIKEI-CHIKAN-KIN3  =  009999999) AND
                  (RECE02-ZAITAKU-SAIKEI3     =  999999999))
                 MOVE   123456789   TO   RECE02-SAIKEI-CHIKAN-KIN3
             END-IF
             IF    RECE02-SAIKEI-CHIKAN-KIN3  =  123456789
                 CONTINUE
             ELSE
               IF  RECE02-SAIKEI-CHIKAN-KIN3  =  009999999
                 MOVE   999999999   TO   RECE02-ZAITAKU-SAIKEI3
               ELSE
                 MOVE      1        TO   RECE02-SAIKEIZEROKSI3
                 MOVE   RECE02-SAIKEI-CHIKAN-KIN3
                                    TO   RECE02-ZAITAKU-SAIKEI3
               END-IF
             END-IF
      *      再掲４置き換え
             IF  ( RECE02-KOHNUM(4)           =  SPACE     )
             OR  ((RECE02-SAIKEI-CHIKAN-KIN4  =  009999999) AND
                  (RECE02-ZAITAKU-SAIKEI4     =  999999999))
                 MOVE   123456789   TO   RECE02-SAIKEI-CHIKAN-KIN4
             END-IF
             IF    RECE02-SAIKEI-CHIKAN-KIN4  =  123456789
                 CONTINUE
             ELSE
               IF  RECE02-SAIKEI-CHIKAN-KIN4  =  009999999
                 MOVE   999999999   TO   RECE02-ZAITAKU-SAIKEI4
               ELSE
                 MOVE      1        TO   RECE02-SAIKEIZEROKSI4
                 MOVE   RECE02-SAIKEI-CHIKAN-KIN4
                                    TO   RECE02-ZAITAKU-SAIKEI4
               END-IF
             END-IF
      *      保険一部負担金置き換え
             IF    RECE02-HKN-CHIKAN-KIN      =  009999999
                 MOVE   123456789   TO   RECE02-HKN-CHIKAN-KIN
             END-IF
             IF    RECE02-HKN-CHIKAN-KIN      =  123456789
                 CONTINUE
             ELSE
                 MOVE   RECE02-HKN-CHIKAN-KIN
                                    TO   RECE02-FTNMONEY(1)
             END-IF
      *
             IF    RECE02-SAIKEI-CHIKAN-KIN1  =  123456789
             AND   RECE02-SAIKEI-CHIKAN-KIN2  =  123456789
             AND   RECE02-SAIKEI-CHIKAN-KIN3  =  123456789
             AND   RECE02-SAIKEI-CHIKAN-KIN4  =  123456789
             AND   RECE02-HKN-CHIKAN-KIN      =  123456789
               IF  RECE02-ICBKINKSI-ARI  =  1
                MOVE    ZERO        TO   RECE02-ICBKINKSI-ARI
               END-IF
               IF  RECE02-ICBKINKSI-ARI  =  2
                MOVE    3           TO   RECE02-ICBKINKSI-ARI
               END-IF
             END-IF
             MOVE       ZERO        TO   RECE02-ICBKINKSI-NASI
           END-IF
      *
           IF  (IDZ                     =   1         )
           AND (RECE02-ZAITAKU      NOT =  "1" AND "2")
           AND (WRK-TAIHI-OKIKAE        =   2         )
      *      再掲上置き換え
             MOVE   123456789       TO   RECE02-SAIKEI-CHIKAN-KIN1
      *      再掲下置き換え
             MOVE   123456789       TO   RECE02-SAIKEI-CHIKAN-KIN2
      *      再掲３置き換え
             MOVE   123456789       TO   RECE02-SAIKEI-CHIKAN-KIN3
      *      再掲４置き換え
             MOVE   123456789       TO   RECE02-SAIKEI-CHIKAN-KIN4
      *      保険一部負担金置き換え
             MOVE   123456789       TO   RECE02-HKN-CHIKAN-KIN
      *
             IF    RECE02-SAIKEI-CHIKAN-KIN1  =  123456789
             AND   RECE02-SAIKEI-CHIKAN-KIN2  =  123456789
             AND   RECE02-SAIKEI-CHIKAN-KIN3  =  123456789
             AND   RECE02-SAIKEI-CHIKAN-KIN4  =  123456789
             AND   RECE02-HKN-CHIKAN-KIN      =  123456789
               IF  RECE02-ICBKINKSI-NASI   =  1
                MOVE    ZERO        TO   RECE02-ICBKINKSI-NASI
               END-IF
               IF  RECE02-ICBKINKSI-NASI   =  2
                MOVE    3           TO   RECE02-ICBKINKSI-NASI
               END-IF
             END-IF
             MOVE       ZERO        TO   RECE02-ICBKINKSI-ARI
           END-IF
      *
           IF ((IDZ                     =   1         ) AND
               (RECE02-ZAITAKU          =  "1" OR  "2") AND
               (WRK-TAIHI-OKIKAE        =   1         ))
           OR ((IDZ                     =   1         ) AND
               (RECE02-ZAITAKU      NOT =  "1" AND "2") AND
               (WRK-TAIHI-OKIKAE        =   2         ))
             CONTINUE
           ELSE
             MOVE       ZERO        TO   RECE02-ICBKINKSI-NASI
             MOVE       ZERO        TO   RECE02-ICBKINKSI-ARI
             MOVE       123456789   TO   RECE02-SAIKEI-CHIKAN-KIN1
             MOVE       123456789   TO   RECE02-SAIKEI-CHIKAN-KIN2
             MOVE       123456789   TO   RECE02-SAIKEI-CHIKAN-KIN3
             MOVE       123456789   TO   RECE02-SAIKEI-CHIKAN-KIN4
             MOVE       123456789   TO   RECE02-HKN-CHIKAN-KIN
           END-IF
      *
           IF  (IDZ                 =   1)
           AND (WRK-TAIHI-OKIKAE2   =   1)
      *      公１一部負担金置き換え
             IF    RECE02-KOHNUM(1)        =  SPACE
                   MOVE    123456789    TO   RECE02-KOH-CHIKAN-KIN1
             END-IF
             IF    RECE02-KOH-CHIKAN-KIN1  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE02-KOH-CHIKAN-KIN1
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE02-FTNMONEY(2)
                   MOVE   SPACE         TO   RECE02-ZEROKISAIFLG(2)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE02-FTNMONEY(2)
                   MOVE   "1"           TO   RECE02-ZEROKISAIFLG(2)
                 WHEN      OTHER
                   MOVE   RECE02-KOH-CHIKAN-KIN1
                                        TO   RECE02-FTNMONEY(2)
                   MOVE   "1"           TO   RECE02-KISAIFLG(2)
               END-EVALUATE
             END-IF
      *      公２一部負担金置き換え
             IF    RECE02-KOHNUM(2)        =  SPACE
                   MOVE    123456789    TO   RECE02-KOH-CHIKAN-KIN2
             END-IF
             IF    RECE02-KOH-CHIKAN-KIN2  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE02-KOH-CHIKAN-KIN2
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE02-FTNMONEY(3)
                   MOVE   SPACE         TO   RECE02-ZEROKISAIFLG(3)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE02-FTNMONEY(3)
                   MOVE   "1"           TO   RECE02-ZEROKISAIFLG(3)
                 WHEN      OTHER
                   MOVE   RECE02-KOH-CHIKAN-KIN2
                                        TO   RECE02-FTNMONEY(3)
                   MOVE   "1"           TO   RECE02-KISAIFLG(3)
               END-EVALUATE
             END-IF
      *      公３一部負担金置き換え
             IF    RECE02-KOHNUM(3)        =  SPACE
                   MOVE    123456789    TO   RECE02-KOH-CHIKAN-KIN3
             END-IF
             IF    RECE02-KOH-CHIKAN-KIN3  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE02-KOH-CHIKAN-KIN3
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE02-FTNMONEY(4)
                   MOVE   SPACE         TO   RECE02-ZEROKISAIFLG(4)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE02-FTNMONEY(4)
                   MOVE   "1"           TO   RECE02-ZEROKISAIFLG(4)
                 WHEN      OTHER
                   MOVE   RECE02-KOH-CHIKAN-KIN3
                                        TO   RECE02-FTNMONEY(4)
                   MOVE   "1"           TO   RECE02-KISAIFLG(4)
               END-EVALUATE
             END-IF
      *      公４一部負担金置き換え
             IF    RECE02-KOHNUM(4)        =  SPACE
                   MOVE    123456789    TO   RECE02-KOH-CHIKAN-KIN4
             END-IF
             IF    RECE02-KOH-CHIKAN-KIN4  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE02-KOH-CHIKAN-KIN4
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE02-FTNMONEY(5)
                   MOVE   SPACE         TO   RECE02-ZEROKISAIFLG(5)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE02-FTNMONEY(5)
                   MOVE   "1"           TO   RECE02-ZEROKISAIFLG(5)
                 WHEN      OTHER
                   MOVE   RECE02-KOH-CHIKAN-KIN4
                                        TO   RECE02-FTNMONEY(5)
                   MOVE   "1"           TO   RECE02-KISAIFLG(5)
               END-EVALUATE
             END-IF
      *
             IF    RECE02-KOH-CHIKAN-KIN1  =  123456789
             AND   RECE02-KOH-CHIKAN-KIN2  =  123456789
             AND   RECE02-KOH-CHIKAN-KIN3  =  123456789
             AND   RECE02-KOH-CHIKAN-KIN4  =  123456789
               IF  RECE02-KOHCHIKAN  =  1
                MOVE    ZERO            TO   RECE02-KOHCHIKAN
               END-IF
             END-IF
      *
             MOVE    123456789          TO   RECE02-SEI-CHIKAN-KIN1
             MOVE    123456789          TO   RECE02-SEI-CHIKAN-KIN2
             MOVE    123456789          TO   RECE02-SEI-CHIKAN-KIN3
             MOVE    123456789          TO   RECE02-SEI-CHIKAN-KIN4
           END-IF
      *
           IF  (IDZ                 =   2)
           AND (WRK-TAIHI-OKIKAE2   =   1)
      *      公費請求書公１一部負担金置き換え
             IF    RECE02-KOHNUM(1)        =  SPACE
                   MOVE    123456789    TO   RECE02-SEI-CHIKAN-KIN1
             END-IF
             IF    RECE02-SEI-CHIKAN-KIN1  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE02-SEI-CHIKAN-KIN1
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE02-FTNMONEY(2)
                   MOVE   SPACE         TO   RECE02-ZEROKISAIFLG(2)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE02-FTNMONEY(2)
                   MOVE   "1"           TO   RECE02-ZEROKISAIFLG(2)
                 WHEN      OTHER
                   MOVE   RECE02-SEI-CHIKAN-KIN1
                                        TO   RECE02-FTNMONEY(2)
                   MOVE   "1"           TO   RECE02-KISAIFLG(2)
               END-EVALUATE
             END-IF
      *      公費請求書公２一部負担金置き換え
             IF    RECE02-KOHNUM(2)        =  SPACE
                   MOVE    123456789    TO   RECE02-SEI-CHIKAN-KIN2
             END-IF
             IF    RECE02-SEI-CHIKAN-KIN2  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE02-SEI-CHIKAN-KIN2
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE02-FTNMONEY(3)
                   MOVE   SPACE         TO   RECE02-ZEROKISAIFLG(3)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE02-FTNMONEY(3)
                   MOVE   "1"           TO   RECE02-ZEROKISAIFLG(3)
                 WHEN      OTHER
                   MOVE   RECE02-SEI-CHIKAN-KIN2
                                        TO   RECE02-FTNMONEY(3)
                   MOVE   "1"           TO   RECE02-KISAIFLG(3)
               END-EVALUATE
             END-IF
      *      公費請求書公３一部負担金置き換え
             IF    RECE02-KOHNUM(3)        =  SPACE
                   MOVE    123456789    TO   RECE02-SEI-CHIKAN-KIN3
             END-IF
             IF    RECE02-SEI-CHIKAN-KIN3  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE02-SEI-CHIKAN-KIN3
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE02-FTNMONEY(4)
                   MOVE   SPACE         TO   RECE02-ZEROKISAIFLG(4)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE02-FTNMONEY(4)
                   MOVE   "1"           TO   RECE02-ZEROKISAIFLG(4)
                 WHEN      OTHER
                   MOVE   RECE02-SEI-CHIKAN-KIN3
                                        TO   RECE02-FTNMONEY(4)
                   MOVE   "1"           TO   RECE02-KISAIFLG(4)
               END-EVALUATE
             END-IF
      *      公費請求書公４一部負担金置き換え
             IF    RECE02-KOHNUM(4)        =  SPACE
                   MOVE    123456789    TO   RECE02-SEI-CHIKAN-KIN4
             END-IF
             IF    RECE02-SEI-CHIKAN-KIN4  =  123456789
                 CONTINUE
             ELSE
               EVALUATE  RECE02-SEI-CHIKAN-KIN4
                 WHEN      009999999
                   MOVE   ZERO          TO   RECE02-FTNMONEY(5)
                   MOVE   SPACE         TO   RECE02-ZEROKISAIFLG(5)
                 WHEN      000000000
                   MOVE   ZERO          TO   RECE02-FTNMONEY(5)
                   MOVE   "1"           TO   RECE02-ZEROKISAIFLG(5)
                 WHEN      OTHER
                   MOVE   RECE02-SEI-CHIKAN-KIN4
                                        TO   RECE02-FTNMONEY(5)
                   MOVE   "1"           TO   RECE02-KISAIFLG(5)
               END-EVALUATE
             END-IF
      *
             IF    RECE02-SEI-CHIKAN-KIN1  =  123456789
             AND   RECE02-SEI-CHIKAN-KIN2  =  123456789
             AND   RECE02-SEI-CHIKAN-KIN3  =  123456789
             AND   RECE02-SEI-CHIKAN-KIN4  =  123456789
               IF  RECE02-KOHCHIKAN  =  1
                MOVE    ZERO            TO   RECE02-KOHCHIKAN
               END-IF
             END-IF
      *
             MOVE    123456789          TO   RECE02-KOH-CHIKAN-KIN1
             MOVE    123456789          TO   RECE02-KOH-CHIKAN-KIN2
             MOVE    123456789          TO   RECE02-KOH-CHIKAN-KIN3
             MOVE    123456789          TO   RECE02-KOH-CHIKAN-KIN4
           END-IF
      *
           IF  (IDZ                 =   1 OR 2)
           AND (WRK-TAIHI-OKIKAE2   =   1     )
             CONTINUE
           ELSE
             MOVE       ZERO            TO   RECE02-KOHCHIKAN
             MOVE       123456789       TO   RECE02-KOH-CHIKAN-KIN1
             MOVE       123456789       TO   RECE02-KOH-CHIKAN-KIN2
             MOVE       123456789       TO   RECE02-KOH-CHIKAN-KIN3
             MOVE       123456789       TO   RECE02-KOH-CHIKAN-KIN4
             MOVE       123456789       TO   RECE02-SEI-CHIKAN-KIN1
             MOVE       123456789       TO   RECE02-SEI-CHIKAN-KIN2
             MOVE       123456789       TO   RECE02-SEI-CHIKAN-KIN3
             MOVE       123456789       TO   RECE02-SEI-CHIKAN-KIN4
           END-IF
      *
           .
       211U-ICHIBUFUTAN-OKIKAE2-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプト請求区分による公費情報の振り分け処理
      *****************************************************************
       2112-RECESKYKBN-HENSYU-SEC      SECTION.
      *
      *    初期化
           MOVE    RECE02-REC           TO  RECE2W-REC
           INITIALIZE                       RECE02-KOHINF-AREA
                                            RECE02-HKNCOMBIINF-AREA
                                            RECE02-JNISSUINF-AREA
                                            RECE02-TOTALTENINF-AREA
                                            RECE02-FTNMONEYINF-AREA
                                            RECE02-YKZFTNINF-AREA
                                            RECE02-ETC-KOH-G
                                            RECE02-HENTOTALTENINF-AREA
                                            RECE02-ETCKISAIFLGINF-AREA
                                            RECE02-HOTEIGAIFLGINF-AREA
                                            RECE02-FUKUSHIFLGINF-AREA
                                            RECE02-TEISYOTOKU2-INF
           PERFORM VARYING IDX FROM    1   BY  1
                   UNTIL   IDX >       50
               INITIALIZE              RECE02-TENSUINF-AREA (IDX)
           END-PERFORM
      *
      *    主保険情報のみ編集
           MOVE    RECE2W-JNISSU   (1)
                                       TO  RECE02-JNISSU  (1)
           MOVE    RECE2W-TOTALTEN (1)
                                       TO  RECE02-TOTALTEN(1)
           MOVE    RECE2W-FTNMONEY (1)
                                       TO  RECE02-FTNMONEY(1)
           MOVE    RECE2W-FTNMONEY-FTN (1)
                                       TO  RECE02-FTNMONEY-FTN(1)
           MOVE    RECE2W-FTNMONEY-KOJ (1)
                                       TO  RECE02-FTNMONEY-KOJ(1)
           MOVE    RECE2W-YKZFTN   (1)
                                       TO  RECE02-YKZFTN  (1)
           MOVE    RECE2W-HENTOTALTEN (1)
                                       TO  RECE02-HENTOTALTEN (1)
           MOVE    RECE2W-ETCKISAIFLGINF(1)
                                       TO  RECE02-ETCKISAIFLGINF(1)
           MOVE    RECE2W-HOTEIGAIFLGINF(1)
                                       TO  RECE02-HOTEIGAIFLGINF(1)
           MOVE    RECE2W-FUKUSHIFLG(1)
                                       TO  RECE02-FUKUSHIFLG(1)
           PERFORM VARYING IDX FROM    1   BY  1
                   UNTIL   IDX >       50
               MOVE    RECE2W-TENSU (IDX 1)
                                           TO  RECE02-TENSU (IDX 1)
           END-PERFORM
      *
      *    レセプト請求区分による公費情報の振り分け
      *    公費情報・実日数・請求点数・負担金額
      *    明細点数・合計点数（ぶん点・公費分離区分編集用）
           MOVE    ZERO                TO  IDY
                                           IDXX
                                           IDZX
           MOVE    1                   TO  IDX2  
           PERFORM VARYING IDX     FROM    1   BY  1
                   UNTIL   IDX     >       4
               IF      RECE2W-KOHNUM (IDX) NOT =   SPACE
                   COMPUTE IDXX    =   IDX +   1
                   EVALUATE    RECE2W-RECESKYKBN (IDX)
                       WHEN    SPACE
                           ADD     1       TO  IDY
                                               IDX2
                           MOVE    RECE2W-KOHINF (IDX)
                                           TO  RECE02-KOHINF (IDY)
                           MOVE    RECE2W-TEISYOTOKU2(IDX)
                                           TO  RECE02-TEISYOTOKU2(IDY)
                           COMPUTE IDYX    =   IDY +   1
                           MOVE    RECE2W-JNISSU   (IDXX)
                                           TO  RECE02-JNISSU  (IDYX)
                           MOVE    RECE2W-TOTALTEN (IDXX)
                                           TO  RECE02-TOTALTEN(IDYX)
                           MOVE    RECE2W-FTNMONEY (IDXX)
                                           TO  RECE02-FTNMONEY(IDYX)
                           MOVE    RECE2W-FTNMONEY-FTN (IDXX)
                                           TO  RECE02-FTNMONEY-FTN(IDYX)
                           MOVE    RECE2W-FTNMONEY-KOJ (IDXX)
                                           TO  RECE02-FTNMONEY-KOJ(IDYX)
                           MOVE    RECE2W-YKZFTN   (IDXX)
                                           TO  RECE02-YKZFTN  (IDYX)
                           PERFORM VARYING IDX1    FROM    1   BY  1
                                   UNTIL   IDX1    >       50
                               MOVE    RECE2W-TENSU (IDX1 IDXX)
                                           TO  RECE02-TENSU (IDX1 IDX2)
                           END-PERFORM
                           MOVE    RECE2W-HENTOTALTEN (IDXX)
                                           TO  RECE02-HENTOTALTEN (IDX2)
                           MOVE    RECE2W-ETCKISAIFLGINF(IDXX)
                                           TO  RECE02-ETCKISAIFLGINF
                                                               (IDX2)
                           MOVE    RECE2W-HOTEIGAIFLGINF(IDXX)
                                           TO  RECE02-HOTEIGAIFLGINF
                                                               (IDX2)
                           MOVE    RECE2W-FUKUSHIFLG(IDXX)
                                           TO  RECE02-FUKUSHIFLG(IDX2)
                       WHEN    "4"
                           ADD     1       TO  IDZX
                           MOVE    RECE2W-KOHNUM (IDX)
                                           TO  RECE02-ETC-KOHNUM (IDZX)
                           MOVE    RECE2W-KOHFTNJANUM (IDX)
                                           TO  RECE02-ETC-KOHFTNJANUM
                                                                 (IDZX)
                           MOVE    RECE2W-JNISSU   (IDXX)
                                           TO  RECE02-ETC-JNISSU (IDZX)
                           MOVE    RECE2W-TOTALTEN (IDXX)
                                           TO RECE02-ETC-TOTALTEN(IDZX)
                           MOVE    RECE2W-FTNMONEY (IDXX)
                                           TO RECE02-ETC-FTNMONEY(IDZX)
                           MOVE    RECE2W-FTNMONEY-FTN (IDXX)
                                       TO RECE02-ETC-FTNMONEY-FTN(IDZX)
                           MOVE    RECE2W-FTNMONEY-KOJ (IDXX)
                                       TO RECE02-ETC-FTNMONEY-KOJ(IDZX)
                           MOVE    RECE2W-YKZFTN   (IDXX)
                                           TO  RECE02-ETC-YKZFTN (IDZX)
                   END-EVALUATE
               END-IF
           END-PERFORM
      *
      *    保険組合せ番号情報
           PERFORM VARYING IDX     FROM    1   BY  1
                   UNTIL   IDX     >       10
               IF     RECE2W-HKNCOMBI (IDX)    NOT =   ZERO
                   MOVE    RECE2W-HKNCOMBI (IDX)
                                           TO  RECE02-HKNCOMBI (IDX)
                   MOVE    RECE2W-HKNNUMHC (IDX)
                                           TO  RECE02-HKNNUMHC (IDX)
                   PERFORM VARYING IDY     FROM    1   BY  1
                           UNTIL   IDY     >       4
                       IF     RECE2W-KOHNUMHC (IDX IDY)
                                           NOT =   SPACE
                           PERFORM VARYING IDXX    FROM    1   BY  1
                                   UNTIL   IDXX    >       4
                               IF   (RECE2W-KOHNUMHC (IDX IDY)   =
                                                  RECE02-KOHNUM (IDXX))
                               AND  (RECE2W-KOHIDHC  (IDX IDY)   =
                                                  RECE02-KOHID  (IDXX))
                                   MOVE    RECE2W-KOHNUMHCINF
                                                         (IDX IDY)
                                                   TO
                                           RECE02-KOHNUMHCINF(IDX IDY)
                               END-IF
                           END-PERFORM
                       END-IF
                   END-PERFORM                 
               END-IF
           END-PERFORM
      *
           .
       2112-RECESKYKBN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトＯＣＲ領域のセット１
      *****************************************************************
       2113-OCR1-HENSYU-SEC                   SECTION.
      *
           INITIALIZE                           OCR1-AREA
      *
      *保険者番号
           IF      WRK-3SYU-KBN           =   ALL "1" AND 
                   RECE02-HKNNUM          =   SPACE            
      *        ３種の場合
               INITIALIZE                           ORCSNUMAREA
               MOVE    RECE02-KOHFTNJANUM(SEIHIDX)
                                            TO      SNUM-INX
               CALL    "ORCSNUM"            USING   ORCSNUMAREA
               IF      SNUM-RC              =       ZERO
                       MOVE   SNUM-OUTNUM   TO      OCR1-HKNJANUM
               ELSE
                       MOVE   ZERO          TO      OCR1-HKNJANUM
               END-IF
           ELSE
               INITIALIZE                           ORCSNUMAREA
               MOVE    RECE02-HKNJANUM      TO      SNUM-INX
               CALL    "ORCSNUM"            USING   ORCSNUMAREA
               IF      SNUM-RC              =       ZERO
                       MOVE   SNUM-OUTNUM   TO      OCR1-HKNJANUM
               ELSE
                       MOVE   ZERO          TO      OCR1-HKNJANUM
               END-IF
           END-IF
      *医療機関コード
           MOVE   SYS-1001-HOSPCD       TO      OCR1-HOSPCD
      *請求点数
           MOVE    RECE02-TOTALTEN(IDX5)
                                        TO      OCR1-SKYTENSU
      *チェックディジット１
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-SKYTENSU        TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT1
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT1
           END-IF
      *薬剤一部負担金
      *****MOVE    RECE02-YKZFTN(IDX5)  TO      OCR1-YKZFTN
      *生月日
           MOVE    "0"                  TO      OCR1-YKZFTN (1:1)
           MOVE    RECE02-BIRTHDAY      TO      WRK-BIRTHDAY
           MOVE    WRK-BIRTHDAY (5:4)   TO      OCR1-YKZFTN (2:4)
      *チェックディジット２
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-YKZFTN          TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT2
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT2
           END-IF
      *一部負担金
           MOVE    RECE02-FTNMONEY(IDX5)
                                        TO      OCR1-FTNMONEY
      *チェックディジット３
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-FTNMONEY        TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT3
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT3
           END-IF
      *チェックディジット４
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-AREA(1:35)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT4
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT4
           END-IF
      *診療実日数
           MOVE    RECE02-JNISSU(IDX5)  TO      OCR1-JNISSU
      *診療年月（和暦）
           INITIALIZE                           LNK-DAY1-AREA
           INITIALIZE                           STS-AREA-DAY
           MOVE    "11"                 TO      LNK-DAY1-IRAI
           MOVE    RECE02-SRYYM         TO      LNK-DAY1-YMD(1:6)
           MOVE    "01"                 TO      LNK-DAY1-YMD(7:2)
           CALL    "ORCSDAY"            USING   STS-AREA-DAY
                                                LNK-DAY1-AREA
           IF      STS-DAY-RC1          =       ZERO
                   MOVE  LNK-DAY1-YMD-X(3:4)
                                        TO      OCR1-SRYYM
           ELSE
                   MOVE  ZERO           TO      OCR1-SRYYM
           END-IF
      *チェックディジット５
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-AREA(37:6)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT5
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT5
           END-IF
      *市町村番号
           IF      RECE02-RJNFTNJANUM   =       SPACE
               MOVE  ZERO               TO      OCR1-FTNJANUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE02-RJNFTNJANUM
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR1-FTNJANUM
               ELSE
                       MOVE   ZERO      TO      OCR1-FTNJANUM
               END-IF
           END-IF
      *受給者番号
           IF      RECE02-RJNJKYSNUM    =       SPACE
               MOVE  ZERO               TO      OCR1-JKYSNUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE02-RJNJKYSNUM
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR1-JKYSNUM
               ELSE
                       MOVE   ZERO      TO      OCR1-JKYSNUM
               END-IF
           END-IF
      *チェックディジット６
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-AREA(44:15)     TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT6
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT6
           END-IF
      *都道府県番号
           MOVE    SYS-1001-PREFNUM     TO      OCR1-PREFNUM
      *点数表
           IF      RECE02-RECESYUBETU   =    6666
               MOVE    RECE02-RECESYUBETU-X(1:1)
                                        TO      OCR1-TENSUHYO
           ELSE
               MOVE    RECE02-RECESYUBETU(1:1)
                                        TO      OCR1-TENSUHYO
           END-IF
      *保険種別１
           IF      RECE02-RECESYUBETU   =    6666
               MOVE    RECE02-RECESYUBETU-X(2:1)
                                        TO      OCR1-HKNSYUBETU1
           ELSE
               MOVE    RECE02-RECESYUBETU(2:1)
                                        TO      OCR1-HKNSYUBETU1
           END-IF
      *保険種別２
           IF      RECE02-RECESYUBETU   =    6666
               MOVE    RECE02-RECESYUBETU-X(3:1)
                                        TO      OCR1-HKNSYUBETU2
           ELSE
               MOVE    RECE02-RECESYUBETU(3:1)
                                        TO      OCR1-HKNSYUBETU2
           END-IF
      *本人・家族・入外
           IF      RECE02-RECESYUBETU   =    6666
               MOVE    RECE02-RECESYUBETU-X(4:1)
                                        TO      OCR1-HONKZKKBN
           ELSE
               MOVE    RECE02-RECESYUBETU(4:1)
                                        TO      OCR1-HONKZKKBN
           END-IF
      *整理番号
           MOVE    1                    TO      OCR1-SEIRINO
      *チェックディジット７
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR1-AREA(60:7)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR1-CHKDGT7
           ELSE
                   MOVE  ZERO           TO      OCR1-CHKDGT7
           END-IF
      *
           MOVE    OCR1-AREA            TO      RECE02-OCR1           
      *
           .
       2113-OCR1-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトＯＣＲ領域のセット２（Ｆ００２）
      *****************************************************************
       2114-OCR2-HENSYU-SEC                   SECTION.
      *
           INITIALIZE                           OCR2-AREA
      *
      *性別
           MOVE    RECE02-SEX           TO      OCR2-SEX
      *元号・生年
           INITIALIZE                           LNK-DAY1-AREA
           INITIALIZE                           STS-AREA-DAY
           MOVE    "11"                 TO      LNK-DAY1-IRAI
           MOVE    RECE02-BIRTHDAY      TO      LNK-DAY1-YMD
           CALL    "ORCSDAY"            USING   STS-AREA-DAY
                                                LNK-DAY1-AREA
           IF      STS-DAY-RC1          =       ZERO
                   MOVE  LNK-DAY1-YMD-X(2:1)
                                        TO      OCR2-GENGO
                   MOVE  LNK-DAY1-YMD-X(3:2)
                                        TO      OCR2-BIRTHYY
           ELSE
                   MOVE  ZERO           TO      OCR2-GENGO
                   MOVE  ZERO           TO      OCR2-BIRTHYY
           END-IF
      *チェックディジット１
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(1:4)       TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT1
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT1
           END-IF
      *記号・番号
           IF      WRK-3SYU-KBN           =   ALL "1" AND 
                   RECE02-HKNNUM          =   SPACE
      *        ３種の場合（８桁）
               MOVE    RECE02-KOHJKYSNUM (SEIHIDX)
                                           TO  WRK-ZENKAKU
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-NUM-9           TO  OCR2-KIGO
               MOVE    ZERO                TO  OCR2-NUM
           ELSE
               MOVE    RECE02-KIGO         TO  WRK-ZENKAKU
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-NUM-9           TO  OCR2-KIGO
      *
               MOVE    RECE02-NUM          TO  WRK-ZENKAKU
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-NUM-9           TO  OCR2-NUM
           END-IF
      *チェックディジット２
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(6:20)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT2
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT2
           END-IF
      *公費１負担者番号
           IF      RECE02-KOHFTNJANUM(IDA) =      SPACE
               MOVE  ZERO               TO      OCR2-FTNJANUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE02-KOHFTNJANUM(IDA)
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR2-FTNJANUM
               ELSE
                       MOVE   ZERO      TO      OCR2-FTNJANUM
               END-IF
           END-IF
      *公費１受給者番号
           IF      RECE02-KOHJKYSNUM(IDA) =       SPACE
               MOVE  ZERO               TO      OCR2-JKYSNUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE02-KOHJKYSNUM(IDA)
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR2-JKYSNUM
               ELSE
                       MOVE   ZERO      TO      OCR2-JKYSNUM
               END-IF
           END-IF
      *チェックディジット３
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(27:15)     TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT3
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT3
           END-IF
      *公費１診療実日数・請求点数
           IF      RECE02-JNISSU   (IDX5)  =   RECE02-JNISSU   (IDX6)
           AND     RECE02-TOTALTEN (IDX5)  =   RECE02-TOTALTEN (IDX6)
           AND     RECE02-JSKISAIFLG       =   SPACE
           AND     RECE02-EKF-OCRFLG(IDX6) =   SPACE
               MOVE    ZERO                 TO  OCR2-JNISSU
                                                OCR2-TENSU   
           ELSE    
               MOVE    RECE02-JNISSU  (IDX6)   TO  OCR2-JNISSU
               MOVE    RECE02-TOTALTEN(IDX6)   TO  OCR2-TENSU
           END-IF
      *チェックディジット４
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(45:7)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT4
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT4
           END-IF
      *公費１薬剤一部負担金
           MOVE    RECE02-YKZFTN(IDX6)  TO      OCR2-YKZFTN
      *チェックディジット５
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(53:5)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT5
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT5
           END-IF
      *公費１患者負担額
           MOVE    RECE02-FTNMONEY(IDX6)
                                        TO      OCR2-FTNMONEY
      *チェックディジット６
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(59:5)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT6
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT6
           END-IF
      *チェックディジット７
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR2-AREA(43:22)     TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR2-CHKDGT7
           ELSE
                   MOVE  ZERO           TO      OCR2-CHKDGT7
           END-IF
      *予備１
           MOVE    SPACE                TO      OCR2-YOBI
      *
           IF      OCR2-AREA-X          =   ALL "0"
               MOVE    SPACE                    TO  OCR2-AREA-X
           END-IF  
           MOVE    OCR2-AREA            TO      RECE02-OCR2
      *
           .
       2114-OCR2-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトＯＣＲ領域のセット３（Ｆ００２）
      *****************************************************************
       2115-OCR3-HENSYU-SEC                   SECTION.
      *
           INITIALIZE                           OCR3-AREA
      *
      *公費２負担者番号
           IF      RECE02-KOHFTNJANUM(IDB) =      SPACE
               MOVE  ZERO               TO      OCR3-FTNJANUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE02-KOHFTNJANUM(IDB)
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR3-FTNJANUM
               ELSE
                       MOVE   ZERO      TO      OCR3-FTNJANUM
               END-IF
           END-IF
      *公費２受給者番号
           IF      RECE02-KOHJKYSNUM(IDB) =       SPACE
               MOVE  ZERO               TO      OCR3-JKYSNUM
           ELSE
               INITIALIZE                       ORCSNUMAREA
               MOVE    RECE02-KOHJKYSNUM(IDB)
                                        TO      SNUM-INX
               CALL    "ORCSNUM"        USING   ORCSNUMAREA
               IF      SNUM-RC          =       ZERO
                       MOVE   SNUM-OUTNUM
                                        TO      OCR3-JKYSNUM
               ELSE
                       MOVE   ZERO      TO      OCR3-JKYSNUM
               END-IF
           END-IF
      *チェックディジット１
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(1:15)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT1
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT1
           END-IF
      *公費２診療実日数・請求点数
           IF      RECE02-JNISSU   (IDX6)  =   RECE02-JNISSU   (IDX7)
           AND     RECE02-TOTALTEN (IDX6)  =   RECE02-TOTALTEN (IDX7)
           AND     RECE02-JSKISAIFLG       =   SPACE
           AND     RECE02-EKF-OCRFLG(IDX7) =   SPACE
               MOVE    ZERO                 TO  OCR3-JNISSU
                                                OCR3-TENSU   
           ELSE    
               MOVE    RECE02-JNISSU  (IDX7)   TO  OCR3-JNISSU
               MOVE    RECE02-TOTALTEN(IDX7)   TO  OCR3-TENSU
           END-IF
      *チェックディジット２
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(19:7)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT2
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT2
           END-IF
      *公費２薬剤一部負担金
           MOVE    RECE02-YKZFTN(IDX7)  TO      OCR3-YKZFTN
      *チェックディジット３
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(27:5)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT3
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT3
           END-IF
      *公費２患者負担額
           MOVE    RECE02-FTNMONEY(IDX7)
                                        TO      OCR3-FTNMONEY
      *チェックディジット４
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(33:5)      TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT4
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT4
           END-IF
      *チェックディジット５
           INITIALIZE                           LNK-CHKDGT-AREA
           MOVE    1                    TO      LNK-I-SYORIKBN
           MOVE    OCR3-AREA(17:22)     TO      LNK-I-CODE
           CALL    "ORCSCHKDGT11"       USING   LNK-CHKDGT-AREA
           IF      LNK-O-ERRCD          =       ZERO
                   MOVE  LNK-O-CHKDGT   TO      OCR3-CHKDGT5
           ELSE
                   MOVE  ZERO           TO      OCR3-CHKDGT5
           END-IF
      *予備２
           MOVE    SPACE                TO      OCR3-YOBI
      *
           IF      OCR3-AREA-X          =   ALL "0"
               MOVE    SPACE                TO  RECE02-OCR3
           ELSE 
               MOVE    OCR3-AREA            TO  RECE02-OCR3
           END-IF
      *
           .
       2115-OCR3-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    全角→数値半角変換処理
      *****************************************************************
       800-NUM-ZENKAKU-HENKAN-SEC    SECTION.
      *
           MOVE    ZERO                TO  WRK-STIDX
                                           WRK-EDIDX 
           MOVE    SPACE               TO  WRK-NUM
           MOVE    ZERO                TO  WRK-NUM-9
      *
      *    空白のときはゼロ 
           IF      WRK-ZENKAKU          =       SPACE
               MOVE    ZERO                TO  WRK-NUM
               MOVE    10                  TO  IDY   
           ELSE
      *
      *        文字の開始桁
               PERFORM VARYING IDX FROM    1   BY  1
                       UNTIL   IDX         >   80
                       OR      WRK-STIDX   >   ZERO
                   IF      WRK-ZENKAKU (IDX:1)  NOT =   SPACE
                       MOVE    IDX                 TO  WRK-STIDX
                   END-IF     
               END-PERFORM
      *        文字の終了桁
               PERFORM VARYING IDX FROM    80  BY  -1
                       UNTIL   IDX         <   1
                       OR      WRK-EDIDX   >   ZERO
                   IF      WRK-ZENKAKU (IDX:1)  NOT =   SPACE
                       MOVE    IDX                 TO  WRK-EDIDX
                   END-IF     
               END-PERFORM
      *
      *        全角数字のとき半角数字に変換（数字以外のときはゼロ）
               IF      WRK-ZENKAKU (WRK-STIDX:1)   >=  X"A1"
                   MOVE    ZERO                TO  IDX3
                   PERFORM VARYING     IDX     FROM    WRK-STIDX  BY  2
                           UNTIL       IDX     >       WRK-EDIDX
                       IF      WRK-ZENKAKU (IDX:2)  >= "０"  AND
                                                   <=  "９"
                           ADD     1               TO  IDX3
                           EVALUATE    WRK-ZENKAKU (IDX:2)
                               WHEN    "０"
                                   MOVE    "0"     TO  WRK-NUM (IDX3:1)
                               WHEN    "１"
                                   MOVE    "1"     TO  WRK-NUM (IDX3:1)
                               WHEN    "２"
                                   MOVE    "2"     TO  WRK-NUM (IDX3:1)
                               WHEN    "３"
                                   MOVE    "3"     TO  WRK-NUM (IDX3:1)
                               WHEN    "４"
                                   MOVE    "4"     TO  WRK-NUM (IDX3:1)
                               WHEN    "５"
                                   MOVE    "5"     TO  WRK-NUM (IDX3:1)
                               WHEN    "６"
                                   MOVE    "6"     TO  WRK-NUM (IDX3:1)
                               WHEN    "７"
                                   MOVE    "7"     TO  WRK-NUM (IDX3:1)
                               WHEN    "８"
                                   MOVE    "8"     TO  WRK-NUM (IDX3:1)
                               WHEN    "９"
                                   MOVE    "9"     TO  WRK-NUM (IDX3:1)
                           END-EVALUATE
      *****************ELSE
      *****************    MOVE    ZERO            TO  WRK-NUM
      *****************    MOVE    WRK-EDIDX       TO  IDX
      *****************    MOVE    10              TO  IDX3
                       END-IF
                   END-PERFORM
                   MOVE    IDX3                TO  IDY     
               ELSE
      *        半角数字に変換（数字以外のときはゼロ）
                   INSPECT WRK-ZENKAKU(WRK-STIDX:)  REPLACING   ALL " "
                                                                BY  "0"
                   IF      WRK-ZENKAKU(WRK-STIDX:)     NOT NUMERIC
                       PERFORM VARYING IDX     FROM    WRK-STIDX  BY  1
                               UNTIL   IDX     >       WRK-EDIDX
                           IF      WRK-ZENKAKU (IDX:1) >=  "0" AND
                                                       <=  "9"
                               ADD     1           TO  IDX3
                               MOVE    WRK-ZENKAKU (IDX:1)
                                                   TO  WRK-NUM (IDX3:1)
                           END-IF
                       END-PERFORM    
                       MOVE    IDX3                TO  IDY     
                   ELSE
                       COMPUTE IDY     =   WRK-EDIDX   -
                                           WRK-STIDX   +   1
                       MOVE    WRK-ZENKAKU (WRK-STIDX:IDY) TO  WRK-NUM
                   END-IF     
               END-IF
           END-IF
      *
           INITIALIZE                      ORCSNUMAREA
           MOVE    WRK-NUM-X           TO  SNUM-INX
           CALL    "ORCSNUM"           USING   ORCSNUMAREA
           IF      SNUM-RC             =   ZERO
               MOVE    SNUM-OUTNUM         TO  WRK-NUM-9
           ELSE
               MOVE    ZERO                TO  WRK-NUM-9 
           END-IF
      *
           .
       800-NUM-ZENKAKU-HENKAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数テーブルの検索
      *****************************************************************
       900-TENSU-TBL-SEC               SECTION.
      *
           MOVE    ZERO                 TO      FLG-TENSU
           MOVE    SRY-SRYCD(IDX2)      TO      TTNS-CHK-SRYCD
           MOVE    SRY-SRYYM            TO      WK-TAIHI-SRYYM
           MOVE    WK-TAIHI-DAY         TO      WK-TAIHI-SRYD
           MOVE    WK-TAIHI-SRYYMD      TO      TTNS-CHK-YMD
      *
      *    点数マスタ退避ワークチェック
           PERFORM 9001-TTNS-CHK-SEC
      *
      *    退避ワークに存在しない場合はＤＢを検索
           IF    ( TTNS-FLG            =   ZERO )
               INITIALIZE                           TNS-TENSU-REC
grpsys         MOVE    SPA-HOSPNUM          TO      TNS-HOSPNUM
               MOVE    SRY-SRYCD(IDX2)      TO      TNS-SRYCD
               MOVE    WK-TAIHI-SRYYMD      TO      TNS-YUKOSTYMD
                                                    TNS-YUKOEDYMD
               MOVE    TNS-TENSU-REC        TO      MCPDATA-REC
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
grpsys         PERFORM 900-DBSELECT-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    "tbl_tensu"     TO  MCP-TABLE
                   MOVE    "key"           TO  MCP-PATHNAME
                   PERFORM  910-TENSU-READ-SEC
                   IF       FLG-TENSU       =       1
                       DISPLAY   "TENSU FETCH ERR"  
                   ELSE
      *                点数マスタ退避ワークに編集する
                       PERFORM 9001-TTNS-HEN-SEC
                   END-IF
               ELSE
                   DISPLAY   "TENSU SELECT ERR" 
                   INITIALIZE                  TNS-TENSU-REC
                   MOVE    1               TO  FLG-TENSU
               END-IF
      *
               MOVE    "tbl_tensu"     TO  MCP-TABLE
               MOVE    "key"           TO  MCP-PATHNAME
               PERFORM 900-CLOSE-SEC
           END-IF
      *
           .
       900-TENSU-TBL-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数マスタ退避ワークチェック処理
      *****************************************************************
       9001-TTNS-CHK-SEC               SECTION.
      *
           MOVE    ZERO                TO  TTNS-FLG
           INITIALIZE                      TNS-TENSU-REC
      *
           PERFORM VARYING TTNS-IDX    FROM    1   BY  1
                   UNTIL ( TTNS-IDX    >   TTNS-MAX )
                    OR   ( TTNS-FLG    =   1 )
               IF    ( TTNS-KEY-SRYCD (TTNS-IDX)
                                       =   TTNS-CHK-SRYCD )
                 AND ( TTNS-KEY-YUKOSTYMD (TTNS-IDX)
                                      <=   TTNS-CHK-YMD )
                 AND ( TTNS-KEY-YUKOEDYMD (TTNS-IDX)
                                      >=   TTNS-CHK-YMD )
                   MOVE    1           TO  TTNS-FLG
                   MOVE    TTNS-DAT(TTNS-IDX)
                                       TO  TNS-TENSU-REC
               END-IF
           END-PERFORM
      *
           .
       9001-TTNS-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数マスタ退避ワーク編集処理
      *****************************************************************
       9001-TTNS-HEN-SEC               SECTION.
      *
           IF      SRY-SRYCD(IDX2)(1:1) = "6" OR "7"
               INITIALIZE                   TNSUP-KEY
               MOVE    WK-TAIHI-SRYYMD  TO  TNSUP-YUKOSTYMD
                                            TNSUP-YUKOEDYMD
               CALL    "ORCSSETTANI"    USING
                                        TNS-TENSU-REC
                                        SPA-AREA
           END-IF
      *
           IF      TNS-TANIMOJISU    =   ZERO
           AND     TNS-TANINAME  NOT =   SPACE
               PERFORM   VARYING   IDW2   FROM   24   BY  -1
                          UNTIL    IDW2    <      1
                  IF   TNS-TANINAME(IDW2:1)  NOT =   SPACE
                      COMPUTE  TNS-TANIMOJISU   =   IDW2   /   2
                      MOVE    1     TO    IDW2
                  END-IF
               END-PERFORM
           END-IF
      *
           IF    ( TTNS-CONST-MAX  >   TTNS-MAX )
               COMPUTE TTNS-MAX    =   TTNS-MAX    +   1
               MOVE    TNS-SRYCD       TO  TTNS-KEY-SRYCD(TTNS-MAX)
               MOVE    TNS-YUKOSTYMD   TO  TTNS-KEY-YUKOSTYMD(TTNS-MAX)
               MOVE    TNS-YUKOEDYMD   TO  TTNS-KEY-YUKOEDYMD(TTNS-MAX)
               MOVE    TNS-TENSU-REC   TO  TTNS-DAT(TTNS-MAX)
           END-IF
      *
           .
       9001-TTNS-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    点数読込
      *****************************************************************
       910-TENSU-READ-SEC           SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  TNS-TENSU-REC
               MOVE    ZERO            TO  FLG-TENSU
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1               TO  FLG-TENSU
           END-IF
      *
           .
       910-TENSU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計読込
      *****************************************************************
       900-SRYACCT-READ-SEC           SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACCT-REC
               MOVE    ZERO            TO  FLG-SRYACCT
           ELSE
               INITIALIZE                  SRYACCT-REC
               MOVE    1               TO  FLG-SRYACCT
           END-IF
      *
           .
       900-SRYACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療行為読込
      *****************************************************************
       900-SRYACT-READ-SEC           SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACT-REC
               MOVE    ZERO            TO  FLG-SRYACT
           ELSE
               INITIALIZE                  SRYACT-REC
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           .
       900-SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    収納読込
      *****************************************************************
       900-SYUNOU-READ-SEC           SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYUNOU-REC
               MOVE    ZERO            TO  FLG-SYUNOU
      *
               INITIALIZE              TBL-TOKATUKAI2
               IF  ((SYS-1001-PREFNUM         =  13      ) AND
                    (SYU-KOH-HKNNUM(1)        = "151"    ) AND
                    (RECE02-SRYYM            >= "200905" ))
               OR  ((SYS-1001-PREFNUM         =  23      ) AND
                    (SYU-KOH-HKNNUM(1)        = "191"    ) AND
                    (RECE02-SRYYM            >= "200910" ))
               OR  ((SYS-1001-PREFNUM         =  23 OR 24) AND
                    (SYU-KOH-HKNNUM(1)        = "152"    ) AND
                    (RECE02-SRYYM            >= "201104" ) AND
                    (RECE02-SRYYM            <= "201412" ))
                 MOVE     1     TO     TBL-TOKATUKAIFLG2
               END-IF
      *
           ELSE
               INITIALIZE                  SYUNOU-REC
               MOVE    1               TO  FLG-SYUNOU
           END-IF
      *
           .
       900-SYUNOU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者公費情報読込
      *****************************************************************
       900-PTKOHINF-READ-SEC           SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTKOHINF-REC
               MOVE    ZERO            TO  FLG-PTKOHINF
           ELSE
               INITIALIZE                  PTKOHINF-REC
               MOVE    1               TO  FLG-PTKOHINF
           END-IF
      *
           .
       900-PTKOHINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    入院履歴情報読込
      *****************************************************************
       900-PTNYUINRRK-READ-SEC         SECTION.
      *
           PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
               MOVE    ZERO            TO  FLG-PTNYUINRRK
           ELSE
               INITIALIZE                  PTNYUINRRK-REC
               MOVE    1               TO  FLG-PTNYUINRRK
           END-IF
      *
           .
       900-PTNYUINRRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    保険組合せマスタ読込
      *****************************************************************
       900-HKNCOMBI-INV-SEC         SECTION.
      *
           MOVE    "tbl_hkncombi"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_hkncombi"      TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM   900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO                TO  FLG-HKNCOMBI
                   MOVE    MCPDATA-REC         TO  HKNCOMBI-REC
                   IF      COMB-DELKBN         =   "1"
                       MOVE    1               TO  FLG-HKNCOMBI
                   END-IF
               ELSE
                   MOVE    1                   TO  FLG-HKNCOMBI
                   INITIALIZE                      HKNCOMBI-REC
               END-IF
           ELSE
               MOVE    1                       TO  FLG-HKNCOMBI
               INITIALIZE                          HKNCOMBI-REC
           END-IF
           MOVE    "tbl_hkncombi"      TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       900-HKNCOMBI-INV-EXT.
           EXIT.
      *
      *****************************************************************
      *    レセプトコメントマスタ読込
      *****************************************************************
       900-RECECOM-READ-SEC         SECTION.
      *
           PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  RECECOM-REC
               MOVE    ZERO            TO  FLG-RECECOM
           ELSE
               INITIALIZE                  RECECOM-REC
               MOVE    1               TO  FLG-RECECOM
           END-IF
      *
           .
       900-RECECOM-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    受診履歴読込
      *****************************************************************
       900-JYURRK-READ-SEC           SECTION.
      *
           PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  JYURRK-REC
               MOVE    ZERO            TO  FLG-JYURRK
           ELSE
               INITIALIZE                  JYURRK-REC
               MOVE    1               TO  FLG-JYURRK
           END-IF
      *
           .
       900-JYURRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者保険情報読込
      *****************************************************************
       900-PTHKNINF-INV-SEC           SECTION.
      *
           MOVE     "tbl_pthkninf"     TO  MCP-TABLE
           MOVE     "key"              TO  MCP-PATHNAME
           PERFORM   900-DBSELECT-SEC
           IF        MCP-RC            =   ZERO
             MOVE   "tbl_pthkninf"     TO  MCP-TABLE
             MOVE   "key"              TO  MCP-PATHNAME
             PERFORM 900-DBFETCH-SEC
             IF      MCP-RC            =   ZERO
               MOVE  MCPDATA-REC       TO  PTHKNINF-REC
               MOVE  ZERO              TO  FLG-PTHKNINF
             ELSE
               INITIALIZE                  PTHKNINF-REC
               MOVE    1               TO  FLG-PTHKNINF
             END-IF
           ELSE
               INITIALIZE                  PTHKNINF-REC
               MOVE    1               TO  FLG-PTHKNINF
           END-IF
           MOVE     "tbl_pthkninf"     TO  MCP-TABLE
           MOVE     "key"              TO  MCP-PATHNAME
           PERFORM   900-CLOSE-SEC
      *
           .
       900-PTHKNINF-INV-EXT.
           EXIT.
      *
      *****************************************************************
      *    システム管理マスタ読込
      *****************************************************************
       960-KANRIMST-READ-SEC         SECTION.
      * 
grpsys     MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
           MOVE    WRK-MCP-PATHNAME    TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC          =   ZERO
               MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
               MOVE    WRK-MCP-PATHNAME    TO  MCP-PATHNAME
grpsys         PERFORM 900-DBFETCH-SEC
               IF      MCP-RC          =   ZERO
                   MOVE    ZERO            TO  FLG-SYSKANRI
               ELSE
                   MOVE    1               TO  FLG-SYSKANRI
               END-IF
           ELSE
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
           MOVE    WRK-MCP-PATHNAME    TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
           .
       960-KANRIMST-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    システム管理マスタ読込
      *****************************************************************
       970-KANRIMST-READ-SEC         SECTION.
      *
grpsys     PERFORM 900-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
           .
       970-KANRIMST-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    患者コメントマスタ読み込み
      *****************************************************************
       950-PTCOM-READ-SEC           SECTION.
      *
           MOVE    PTCOM-REC           TO  MCPDATA-REC
      *
           MOVE    "tbl_ptcom"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
grpsys     PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_ptcom"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
grpsys         PERFORM 900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  PTCOM-REC
                   MOVE    ZERO                TO  FLG-PTCOM
               ELSE
                   MOVE    1                   TO  FLG-PTCOM
                   INITIALIZE                  PTCOM-REC
               END-IF
           ELSE
               MOVE    1                   TO  FLG-PTCOM
               INITIALIZE                  PTCOM-REC
           END-IF
      *
           MOVE    "tbl_ptcom"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           IF      FLG-PTCOM           =   ZERO
               IF      PTCOM-INPUTCOMENT   NOT =   SPACE
                   MOVE    ZERO            TO  WRK-COL
                                               IDZ1
                                               IDZ2 
                   INSPECT PTCOM-INPUTCOMENT   TALLYING    WRK-COL
                                               FOR ALL WRK-CONS-RETURN
                   IF      WRK-COL         >   ZERO
                       DISPLAY "PTCOM=" PTCOM-KEY
                       PERFORM VARYING IDZ1    FROM    1   BY  1
                               UNTIL   IDZ1    >       140
                           IF      PTCOM-INPUTCOMENT(IDZ1:1)
                                               =   WRK-CONS-RETURN
                               COMPUTE IDZ2    =   IDZ1    -   1
                               MOVE    140     TO  IDZ1
                           END-IF
                       END-PERFORM
      *
                       CALL    "coblog" USING   "ptcom returncd err"
                       MOVE    SPACE               TO  WRK-RECEERR
                       MOVE    SPACE               TO  WRK-ERRMSG
                       STRING
                        "コメント文字コード不正　患者番号="
                                                   DELIMITED  BY  SIZE
                               RECE02-PTNUM        DELIMITED  BY  SPACE
                               "　診療区分="       DELIMITED  BY  SIZE
                               SRY-SRYKBN          DELIMITED  BY  SPACE
                                                   INTO    WRK-ERRMSG
                       END-STRING
                       IF      IDZ2        >   1    
                           STRING   WRK-ERRMSG     DELIMITED  BY  SPACE
                                   "　コメント="   DELIMITED  BY  SIZE
                                   PTCOM-INPUTCOMENT(1:IDZ2)
                                                   DELIMITED  BY  SPACE
                                                   INTO    WRK-RECEERR
                           END-STRING
                       ELSE
                           STRING   WRK-ERRMSG     DELIMITED  BY  SPACE
                                    "　コメント="  DELIMITED  BY  SIZE
                                    PTCOM-SRYCD    DELIMITED  BY  SPACE
                                                   INTO    WRK-RECEERR
                           END-STRING
                       END-IF
                       PERFORM 500-ERR-HENSYU-SEC
      *
                       MOVE    SPACE               TO  WRK-ERRMSG
                       STRING  "ORCR0030 "         DELIMITED  BY  SIZE
                               WRK-RECEERR         DELIMITED  BY  SIZE
                               LOW-VALUE           DELIMITED  BY  SIZE
                                                   INTO    WRK-ERRMSG
                       END-STRING
                       PERFORM 500-COBABORT-SEC
                   END-IF
               END-IF
           END-IF
      *
           .
       950-PTCOM-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計マスタ付加読み込み
      *****************************************************************
       900-SRYACCTPLUS-READ-SEC           SECTION.
      *
           MOVE    SRYACCTPLUS-REC     TO  MCPDATA-REC
      *
           MOVE    "tbl_sryacctplus"   TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_sryacctplus"   TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 900-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  SRYACCTPLUS-REC
                   MOVE    ZERO                TO  FLG-SRYACCTPLUS
               ELSE
                   MOVE    1                   TO  FLG-SRYACCTPLUS
               END-IF
           ELSE
               MOVE    1                   TO  FLG-SRYACCTPLUS
           END-IF
      *
           MOVE    "tbl_sryacctplus"   TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       950-SRYACCTPLUS-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    中間ファイルＲＥＡＤ処理
      *****************************************************************
       RECE02-READ-SEC            SECTION.
      *
           READ    RECE02-FILE   NEXT
               AT  END
                   MOVE    1     TO    FLG-RECE02
               NOT  AT  END
                   IF      STS-RECE02          =   "00"
                       CONTINUE
                   ELSE
                       MOVE    SPACE               TO  WRK-ERR-AREA
                       INITIALIZE                      WRK-ERR-AREA
                       MOVE    2                   TO  WRK-ERR-FLG
                       MOVE    RECE01PARA          TO  WRK-ERR-FILE-NM
                       MOVE    STS-RECE02          TO  WRK-ERR-FILE-STS
                       PERFORM 500-FILE-ERR-ABORT-SEC
                   END-IF
      *
                   ADD     1     TO    CNT-IN (IDZ)
                   ADD     1     TO    CNT-IN-COMMIT
                                       CNT-IN-CANCEL
      *
                   DISPLAY "RECE02 " IDZ " PTNUM=" RECE02-PTNUM     
      *
                   IF      WRK-PARA-SRYYM     =  ZERO
      *                 医療機関編集
                       MOVE  RECE02-SRYYM   TO  WRK-SYS-SRYYMD(1:6)
                       MOVE  "01"           TO  WRK-SYS-SRYYMD(7:2)
                       PERFORM 900-SYSKANRI-HENSYU-SEC
                   END-IF
           END-READ
           .
       RECE02-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    中間ファイルＲＥＡＤ処理
      *****************************************************************
       RECE05-READ-SEC            SECTION.
      *
           READ    RECE05-FILE   NEXT
               AT  END
                   MOVE    1     TO    FLG-RECE05
               NOT  AT  END
                   IF      STS-RECE05          =   "00"
                       CONTINUE
                   ELSE
                       MOVE    SPACE               TO  WRK-ERR-AREA
                       INITIALIZE                      WRK-ERR-AREA
                       MOVE    2                   TO  WRK-ERR-FLG
                       MOVE    RECE05PARA          TO  WRK-ERR-FILE-NM
                       MOVE    STS-RECE05          TO  WRK-ERR-FILE-STS
                       PERFORM 500-FILE-ERR-ABORT-SEC
                   END-IF
           END-READ
           .
       RECE05-READ-EXT.
           EXIT.
      *
      ****************************************************************
      *    診療年月の対象となるシス管理を取得（個別処理のみ
      ****************************************************************
       900-SYSKANRI-HENSYU-SEC         SECTION.
      *
      *    医療機関情報（基本情報）
           MOVE    ZERO                TO  FLG-SET
           MOVE    ZERO                TO  FLG-SYSCHK
      *
           PERFORM VARYING SYSKAN-IDX  FROM    1   BY  1
                   UNTIL ( SYSKAN-IDX              >  100  )
                   OR    ( TBL-SYS1001(SYSKAN-IDX) = SPACE )
                   OR    ( FLG-SET                 =   1   )
               MOVE    TBL-SYS1001(SYSKAN-IDX) TO  SYS-1001-REC
               IF    ( SYS-1001-STYUKYMD       <= WRK-SYS-SRYYMD    )
               AND   ( WRK-SYS-SRYYMD          <= SYS-1001-EDYUKYMD )
                   MOVE     1                  TO  FLG-SET
      *            システム管理１００１のチェック
                   MOVE    SYS-1001-HOSPCD     TO  WRK-SYSCHK-HOSPCD
                   MOVE    RECE02-SRYYM        TO  WRK-SYSCHK-SRYYM
                   PERFORM 901-SYSKANRI-CHECK-SEC
                   MOVE    SYS-1001-DAISANKBN  TO  WRK-DAISAN-DAISANKBN
                   IF  WRK-DAISAN-DAISANKBN = SPACE
                     MOVE  "2"                 TO  WRK-DAISAN-DAISANKBN
                   END-IF
               END-IF
           END-PERFORM
           IF      FLG-SET             =   ZERO
               STRING  "医療機関情報が取得できませんでした。診療年月＝"
                                               DELIMITED  BY  SIZE 
                       WRK-SYS-SRYYMD (1:6)    DELIMITED  BY  SIZE
                                       INTO    WRK-RECEERR
               END-STRING
               PERFORM 500-ERR-HENSYU-SEC
               MOVE    1              TO  FLG-RECE02
               GO  TO  900-SYSKANRI-HENSYU-EXT
           END-IF
      *
      *    施設基準情報
           MOVE    ZERO                TO  FLG-SET
      *
           PERFORM  VARYING  SYSKAN-IDX2  FROM  1   BY  1
                     UNTIL ( SYSKAN-IDX2               >  100  )
                      OR   ( TBL-SYS10062(SYSKAN-IDX2) = SPACE )
                      OR   ( FLG-SET                   =   1   )
               MOVE    TBL-SYS10062(SYSKAN-IDX2)  TO  SYS-1006-REC
               IF   ( SYS-1006-STYUKYMD  <=  WRK-SYS-SRYYMD    )
               AND  ( WRK-SYS-SRYYMD     <=  SYS-1006-EDYUKYMD )
                   MOVE     1                  TO  FLG-SET
               END-IF
           END-PERFORM
           IF      FLG-SET    =   ZERO
               MOVE  ZERO                    TO  WRK-SISETU613
               MOVE  ZERO                    TO  WRK-SISETU695
           ELSE
               MOVE  SYS-1006-SSTKIJUN(113)  TO  WRK-SISETU613
               MOVE  SYS-1006-SSTKIJUN(195)  TO  WRK-SISETU695
           END-IF
      *
           MOVE    ZERO                TO  FLG-SET
      *
           PERFORM  VARYING  SYSKAN-IDX2  FROM  1   BY  1
                     UNTIL ( SYSKAN-IDX2               >  100  )
                      OR   ( TBL-SYS10067(SYSKAN-IDX2) = SPACE )
                      OR   ( FLG-SET                   =   1   )
               MOVE    TBL-SYS10067(SYSKAN-IDX2)  TO  SYS-1006-REC
               IF   ( SYS-1006-STYUKYMD  <=  WRK-SYS-SRYYMD    )
               AND  ( WRK-SYS-SRYYMD     <=  SYS-1006-EDYUKYMD )
                   MOVE     1                  TO  FLG-SET
               END-IF
           END-PERFORM
           IF      FLG-SET    =   ZERO
               MOVE  ZERO                    TO  WRK-SISETU3055
               MOVE  ZERO                    TO  WRK-SISETU3056
               MOVE  ZERO                    TO  WRK-SISETU3057
               MOVE  ZERO                    TO  WRK-SISETU3058
               MOVE  ZERO                    TO  WRK-SISETU3168
               MOVE  ZERO                    TO  WRK-SISETU3169
           ELSE
               MOVE  SYS-1006-SSTKIJUN(55)   TO  WRK-SISETU3055
               MOVE  SYS-1006-SSTKIJUN(56)   TO  WRK-SISETU3056
               MOVE  SYS-1006-SSTKIJUN(57)   TO  WRK-SISETU3057
               MOVE  SYS-1006-SSTKIJUN(58)   TO  WRK-SISETU3058
               MOVE  SYS-1006-SSTKIJUN(168)  TO  WRK-SISETU3168
               MOVE  SYS-1006-SSTKIJUN(169)  TO  WRK-SISETU3169
           END-IF
      *
      *    帳票編集区分情報
           MOVE    ZERO                TO  FLG-SET
           MOVE    SPACE               TO  WRK-1030-KOUHATUKA
      *
      **>  IF      WRK-PARA-PRTKBN = "9" OR "2" OR "3" OR "4" OR "5"
             PERFORM VARYING SYSKAN-IDX  FROM    1   BY  1
                     UNTIL ( SYSKAN-IDX              >  100  )
                     OR    ( TBL-SYS1030(SYSKAN-IDX) = SPACE )
                     OR    ( FLG-SET                 =   1   )
               MOVE    TBL-SYS1030(SYSKAN-IDX) TO  SYS-1030-REC
               IF    ( SYS-1030-STYUKYMD       <= WRK-SYS-SRYYMD    )
               AND   ( WRK-SYS-SRYYMD          <= SYS-1030-EDYUKYMD )
                   MOVE     1          TO  FLG-SET
                   MOVE    SYS-1030-KOUHATUKA
                                       TO  WRK-1030-KOUHATUKA
               END-IF
             END-PERFORM
      **>  END-IF
      *
           .
       900-SYSKANRI-HENSYU-EXT.
           EXIT.
      *
      ****************************************************************
      *    システム管理１００１チェック
      ****************************************************************
       901-SYSKANRI-CHECK-SEC         SECTION.
      *
           INITIALIZE                      SYSKANRI-REC
           MOVE    "1001"              TO  SYS-KANRICD
           MOVE    "*"                 TO  SYS-KBNCD
           MOVE    WRK-SYSCHK-SRYYM    TO  SYS-STYUKYMD(1:6)
           MOVE    "__"                TO  SYS-STYUKYMD(7:2)
           MOVE    SPA-HOSPNUM         TO  SYS-HOSPNUM
           MOVE    SYSKANRI-REC        TO  MCPDATA-REC
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM 900-DBSELECT-SEC
           IF      MCP-RC          =   ZERO
             MOVE  "tbl_syskanri"      TO  MCP-TABLE
             MOVE  "key11"             TO  MCP-PATHNAME
             PERFORM 900-DBFETCH-SEC
             IF    MCP-RC          =   ZERO
               MOVE    MCPDATA-REC     TO  WRK-1001-REC
               IF  WRK-1001-STYUKYMD(7:2)   =   "01"
                 MOVE  "tbl_syskanri"  TO  MCP-TABLE
                 MOVE  "key11"         TO  MCP-PATHNAME
                 PERFORM 900-DBFETCH-SEC
                 IF  MCP-RC        =   ZERO
                   MOVE   MCPDATA-REC  TO  WRK-1001-REC
                   IF  WRK-SYSCHK-HOSPCD = WRK-1001-HOSPCD
                     MOVE    1         TO  FLG-SYSCHK
                   END-IF
                 END-IF
               ELSE
                 IF    WRK-SYSCHK-HOSPCD = WRK-1001-HOSPCD
                     MOVE    1         TO  FLG-SYSCHK
                 END-IF
               END-IF
             END-IF
           END-IF
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key11"             TO  MCP-PATHNAME
           PERFORM 900-CLOSE-SEC
      *
           .
       901-SYSKANRI-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ更新処理（Ｆ００２）
      *****************************************************************
       RECE02-REWRITE-SEC                SECTION.
      *
           REWRITE   RECE02-REC
      *
           IF      STS-RECE02          =   "00"
               CONTINUE
           ELSE
               MOVE    SPACE               TO  WRK-ERR-AREA
               INITIALIZE                      WRK-ERR-AREA
      *
               MOVE    4                   TO  WRK-ERR-FLG
               MOVE    RECE01PARA          TO  WRK-ERR-FILE-NM
               MOVE    STS-RECE02          TO  WRK-ERR-FILE-STS
               PERFORM 500-FILE-ERR-ABORT-SEC
           END-IF
      *
           ADD     1                   TO  CNT-OUT3 (IDZ)
      *
           .
       RECE02-REWRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ出力処理（Ｆ００４）
      *****************************************************************
       RECE04-WRITE-SEC                SECTION.
      *
      *    レセプト処理
           IF    (  IDZ            =   1         )
               IF      WRK-PARA-SHELLID
                                   NOT =   "RECEPTX"
      *            診療会計マスタ付加情報設定
                   PERFORM 9001-SRYACCTPLUS-HENSYU-SEC
               END-IF
      * 
               MOVE    RECE04-ZAITEN      TO    RECE04-HOKATU-ZAITEN
               MOVE    RECE04-SYUTEN1     TO    RECE04-HOKATU-SYUTEN1
               MOVE    RECE04-SYUTEN2     TO    RECE04-HOKATU-SYUTEN2
               MOVE    RECE04-YKZTEN      TO    RECE04-HOKATU-YKZTEN
               MOVE    RECE04-KIZAITEN    TO    RECE04-HOKATU-KIZAITEN
      *
               WRITE   RECE04-REC
      *
               IF     (RECE04-ZAIKAISU    NOT =    ZERO         )
               AND    (RECE04-JIHOKBN         =    SPACE        )
               AND    (RECE04-SRYKBN      NOT =    "95" AND "96")
                 PERFORM  VARYING  IDX18  FROM  1  BY  1
                           UNTIL  (IDX18                   >  10  )
                             OR   (RECE02-HKNCOMBI(IDX18)  =  ZERO)
                   IF  RECE04-HKNCOMBI  =  RECE02-HKNCOMBI(IDX18)
                     IF   RECE04-ZAITEN   NOT =    ZERO
                       MOVE   1   TO   TBL-HKNCOMBI-SKYTENFLG(IDX18)
                     ELSE
                       MOVE   1   TO   TBL-HKNCOMBI-SKYTENFLG2(IDX18)
                     END-IF
                     MOVE    10   TO   IDX18
                   END-IF
                 END-PERFORM
               END-IF
      *
               IF      STS-RECE04          =   "00"
                   CONTINUE
               ELSE
                   MOVE    SPACE               TO  WRK-ERR-AREA
                   INITIALIZE                      WRK-ERR-AREA
      *
                   MOVE    3                   TO  WRK-ERR-FLG
                   MOVE    RECE04PARA          TO  WRK-ERR-FILE-NM
                   MOVE    STS-RECE04          TO  WRK-ERR-FILE-STS
                   PERFORM 500-FILE-ERR-ABORT-SEC
               END-IF
      *
               ADD     1                   TO  CNT-OUT1
           END-IF
      *
           .
       RECE04-WRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    診療会計マスタ付加情報設定処理
      *****************************************************************
       9001-SRYACCTPLUS-HENSYU-SEC     SECTION.
      *
           IF      RECE04-SRYKBN       =   "11"    OR  "12"    OR
                                           "13"    OR  "14"
               CONTINUE
           ELSE
               GO  TO  9001-SRYACCTPLUS-HENSYU-EXT
           END-IF
           IF      RECE04-ZAIREQFLG    =   "1"
               CONTINUE
           ELSE
               GO  TO  9001-SRYACCTPLUS-HENSYU-EXT
           END-IF
      *
           MOVE    SPACE               TO  SRYACCTPLUS-REC
           INITIALIZE                      SRYACCTPLUS-REC
           MOVE    RECE04-HOSPNUM      TO  ACCTP-HOSPNUM
           MOVE    RECE04-NYUGAIKBN    TO  ACCTP-NYUGAIKBN
           MOVE    RECE04-PTID         TO  ACCTP-PTID
           MOVE    RECE04-SRYKA        TO  ACCTP-SRYKA
           MOVE    RECE04-SRYYM        TO  ACCTP-SRYYM
           MOVE    RECE04-ZAINUM       TO  ACCTP-ZAINUM
           MOVE    1                   TO  ACCTP-RENNUM
           PERFORM 900-SRYACCTPLUS-READ-SEC
           IF      FLG-SRYACCTPLUS     =   0
               MOVE    ACCTP-SYUGI-TBL-G   TO  RECE04-ACCTP-SYUGI-TBL-G
               MOVE    ACCTP-SANSOTEN      TO  RECE04-ACCTP-SANSOTEN
               MOVE    ACCTP-CHISOTEN      TO  RECE04-ACCTP-CHISOTEN
           ELSE
               STRING  "診療会計マスタ付加情報読み込みエラー KEY="
                                               DELIMITED  BY  SIZE
                       ACCTP-KEY               DELIMITED  BY  SIZE
                                               INTO    WRK-RECEERR
               END-STRING
               PERFORM 500-ERR-HENSYU-SEC
      *
               MOVE    SPACE               TO  WRK-ERRMSG
               STRING  "ORCR0030 "             DELIMITED  BY  SIZE
                       WRK-RECEERR             DELIMITED  BY  SIZE
                       LOW-VALUE               DELIMITED  BY  SIZE
                                               INTO    WRK-ERRMSG
               END-STRING
               PERFORM 500-COBABORT-SEC
           END-IF
      *
           .
       9001-SRYACCTPLUS-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ出力処理（Ｆ００５）
      *****************************************************************
       RECE05-WRITE-SEC                SECTION.
      *
           IF      IDZ             =   1               
      *    レセプト処理
               WRITE   RECE05-REC
      *
               IF      STS-RECE05          =   "00"
                   CONTINUE
               ELSE
                   MOVE    SPACE               TO  WRK-ERR-AREA
                   INITIALIZE                      WRK-ERR-AREA
      *
                   MOVE    3                   TO  WRK-ERR-FLG
                   MOVE    RECE05PARA          TO  WRK-ERR-FILE-NM
                   MOVE    STS-RECE05          TO  WRK-ERR-FILE-STS
                   PERFORM 500-FILE-ERR-ABORT-SEC
               END-IF
      *
               ADD     1                   TO  CNT-OUT2
           END-IF 
      *
           .
       RECE05-WRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    データ出力処理（Ｆ００５）
      *****************************************************************
       RECE05-REWRITE-SEC              SECTION.                        
      *
           IF      IDZ             =   1               
      *    レセプト処理
      *
              MOVE    ZERO                TO  FLG-REWRITE
      *
              INITIALIZE                      RECE05-REC
              MOVE    RECE04-KEY1         TO  RECE05-KEY1
              MOVE    RECE04-ZAINUM       TO  RECE05-ZAINUM
              START   RECE05-FILE
                    KEY IS    >=   RECE05-KEY
                    INVALID
                        MOVE    1         TO  FLG-RECE05
                    NOT INVALID
                        MOVE    ZERO      TO  FLG-RECE05
                        PERFORM    RECE05-READ-SEC
              END-START
              PERFORM   UNTIL
grpsys            (RECE04-KEY1         NOT =  RECE05-KEY1   )  OR
                  (RECE04-ZAINUM       NOT =  RECE05-ZAINUM )  OR
                  (FLG-RECE05                =      1       )  OR
                  (FLG-REWRITE               =      1       )
                   IF ((FLG-ZANHAIKI     =  1          ) AND
                       (RECE05-RENNUM    =  WRK-RENNUM ))
                   OR ((FLG-FORMAL-KISAI =  1          ) AND
                       (RECE05-RENNUM    =  WRK-RENNUM2))
                      MOVE    1              TO  FLG-REWRITE
                      PERFORM  VARYING  IDXB  FROM  5   BY  -1
                                UNTIL   IDXB   <    1
                        IF  RECE05-SRYCD(IDXB)  NOT = SPACE
                          IF   FLG-ZANHAIKI     =  1
                            MOVE   WRK-SRYSURYO3
                                          TO  RECE05-SRYSURYO (IDXB)
                          END-IF
                          IF   FLG-FORMAL-KISAI =  1
                            MOVE   "1"    TO  RECE05-RECEPTFLG(IDXB)
                          END-IF
                          MOVE      1     TO  IDXB
                        END-IF
                      END-PERFORM
                      REWRITE   RECE05-REC
      *
                      IF      STS-RECE05          =   "00"
                          CONTINUE
                      ELSE
                          MOVE    SPACE               TO  WRK-ERR-AREA
                          INITIALIZE                      WRK-ERR-AREA
      *
                          MOVE    4                   TO  WRK-ERR-FLG
                          MOVE    RECE05PARA          TO
                                                      WRK-ERR-FILE-NM
                          MOVE    STS-RECE05          TO
                                                      WRK-ERR-FILE-STS
                          PERFORM 500-FILE-ERR-ABORT-SEC
                      END-IF
      *
                   END-IF
                   PERFORM    RECE05-READ-SEC
              END-PERFORM
      *
           END-IF 
      *
           .
       RECE05-REWRITE-EXT.
           EXIT.                                                        
      *
      ****************************************************************
      *    レセプト０９データ読み
      ****************************************************************
       RECE09-NEXT-SEC           SECTION.
      *
           READ    RECE09-FILE      NEXT
               AT  END
                   MOVE    1         TO  FLG-RECE09
               NOT AT  END
                   IF      STS-RECE09          =   "00"
                       CONTINUE
                   ELSE
                       MOVE    SPACE               TO  WRK-ERR-AREA
                       INITIALIZE                      WRK-ERR-AREA
                       MOVE    2                   TO  WRK-ERR-FLG
                       MOVE    RECE09PARA          TO  WRK-ERR-FILE-NM
                       MOVE    STS-RECE09          TO  WRK-ERR-FILE-STS
                       PERFORM 500-FILE-ERR-ABORT-SEC
                   END-IF
      *
                   MOVE    ZERO      TO  FLG-RECE09
           END-READ
      *
           .
       RECE09-NEXT-EXT.
           EXIT.
      *
      *****************************************************************
      *    エラー出力処理
      *****************************************************************
       500-ERR-HENSYU-SEC                SECTION.
      *
           OPEN    INPUT   RECEERR-FILE
           IF      STS-RECEERR         =   ZERO
               CLOSE   RECEERR-FILE
           ELSE
               OPEN    OUTPUT              RECEERR-FILE
      *
               MOVE    WRK-RECEERR         TO  RECEERR-REC
               WRITE   RECEERR-REC
               CLOSE   RECEERR-FILE
      *         
             IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *        ジョブ管理開始処理
               MOVE    "JBE"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               MOVE    WRK-RECEERR     TO  JOB-YOBI
               MOVE    "9999"          TO  JOB-ERRCD
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
             END-IF
           END-IF
      *                             
           MOVE    1                   TO  FLG-END
      *
           .
       500-ERR-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    エラー時終了処理
      *****************************************************************
       500-COBABORT-SEC                SECTION.
      *
           CALL    "cobabort"          USING   WRK-ERRMSG
      *
           .
       500-COBABORT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ファイルエラー処理
      *****************************************************************
       500-FILE-ERR-ABORT-SEC           SECTION.
      *
           EVALUATE    WRK-ERR-FLG
               WHEN    1
                   MOVE    "ファイルＯＰＥＮエラー　FILE="
                                           TO  WRK-ERR-FILE-MSG
                   MOVE    "file open err" TO  WRK-ERR-FILE-MSG1
               WHEN    2
                   MOVE    "ファイル読み込みエラー　FILE="
                                           TO  WRK-ERR-FILE-MSG
                   MOVE    "file read err" TO  WRK-ERR-FILE-MSG1
               WHEN    3
                   MOVE    "ファイル書き込みエラー　FILE="
                                           TO  WRK-ERR-FILE-MSG
                   MOVE    "file write err"
                                           TO  WRK-ERR-FILE-MSG1
               WHEN    4
                   MOVE    "ファイル更新エラー　FILE="
                                           TO  WRK-ERR-FILE-MSG
                   MOVE    "file rewrite err"
                                           TO  WRK-ERR-FILE-MSG1
           END-EVALUATE
      *
           STRING  WRK-ERR-FILE-MSG        DELIMITED   BY  SPACE
                   WRK-ERR-FILE-NM (WRK-SGETTEMP-ST:)
                                           DELIMITED   BY  SPACE
                   " STS="                 DELIMITED   BY  SIZE
                   WRK-ERR-FILE-STS        DELIMITED   BY  SIZE
                                           INTO    WRK-RECEERR
           END-STRING
           PERFORM 500-ERR-HENSYU-SEC
      *
           STRING  "ORCR0030 "             DELIMITED   BY  SIZE
                   WRK-ERR-FILE-MSG1       DELIMITED   BY  SIZE
                   " FILE="                DELIMITED   BY  SIZE
                   WRK-ERR-FILE-NM (WRK-SGETTEMP-ST:)
                                           DELIMITED   BY  SPACE
                   "  STS="                DELIMITED   BY  SIZE
                   WRK-ERR-FILE-STS        DELIMITED   BY  SIZE
                   LOW-VALUE               DELIMITED   BY  SIZE
                                           INTO    WRK-ERRMSG
           END-STRING
           PERFORM 500-COBABORT-SEC
      *
           .
       500-FILE-ERR-ABORT-EXT.
           EXIT.
      *
      *****************************************************************
      *    処理中止処理
      *****************************************************************
       500-CANCEL-HENSYU-SEC                SECTION.
      *
      *
           IF      WRK-PARA-SHELLID    =   "RECEPTX"
               CONTINUE
           ELSE
               MOVE    "CHK"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
               IF    ( SJOBKANRI-RETURN
                                       =   ZERO )
               AND   ( JOB-STOPFLG     =   1    )
                   MOVE    "処理が中止されました"
                                           TO  WRK-RECEERR
      *
                   OPEN    INPUT   RECEERR-FILE
                   IF      STS-RECEERR         =   ZERO
                       CLOSE   RECEERR-FILE
                   ELSE
                       OPEN    OUTPUT              RECEERR-FILE
      *    
                       MOVE    WRK-RECEERR         TO  RECEERR-REC
                       WRITE   RECEERR-REC
                       CLOSE   RECEERR-FILE
      *         
      *                ジョブ管理終了処理
                       MOVE    "CAN"           TO  SJOBKANRI-MODE
                       INITIALIZE                  JOBKANRI-REC
                       MOVE    WRK-RECEERR     TO  JOB-YOBI
                       MOVE    "8888"          TO  JOB-ERRCD
                       MOVE    2               TO  JOB-STOPFLG
grpsys                 PERFORM 900-CALL-ORCSJOB-SEC
                   END-IF
      *                             
                   MOVE    1                   TO  FLG-END
               END-IF
           END-IF
           .
       500-CANCEL-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    終了処理
      *****************************************************************
       300-TERM-SEC                SECTION.
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *    ステップ管理終了処理
               MOVE    "STE"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
grpsys         PERFORM 900-CALL-ORCSJOB-SEC
      *
               PERFORM 900-DBDISCONNECT-SEC
           END-IF
      *
           DISPLAY "RECE02  CNT-IN  :" CNT-IN  (1) 
           DISPLAY "RECE04  CNT-OUT :" CNT-OUT1  
           DISPLAY "RECE05  CNT-OUT :" CNT-OUT2  
           DISPLAY "RECE02X CNT-IN  :" CNT-IN  (2) 
           DISPLAY "*** ORCR0030 END ***"
           .
       300-TERM-EXT.
           EXIT.
      *
      *****************************************************************
      *    一時ファイル名取得処理
      *****************************************************************
       800-FILENM-SET-SEC        SECTION.
      *
           MOVE    WRK-PARA-TERMID     TO  RECEDAT1PARA-TERMID
           MOVE    WRK-PARA-HOSPNUM    TO  RECEDAT1PARA-HOSPNUM
           .
       800-FILENM-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ジョブ管理ＤＢ制御処理
      *****************************************************************
       900-CALL-ORCSJOB-SEC            SECTION.
      *
           MOVE    WRK-PARA-JOBID  TO  JOB-JOBID
           MOVE    WRK-PARA-SHELLID
                                   TO  JOB-SHELLID
grpsys     MOVE    SPA-HOSPNUM     TO  JOB-HOSPNUM
           CALL    "ORCSJOB"       USING
                                   ORCSJOBKANRIAREA 
                                   JOBKANRI-REC
                                   SPA-AREA
           .
       900-CALL-ORCSJOB-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢＳＥＬＥＣＴ処理
      *****************************************************************
       900-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
           IF      MCP-RC              =   ZERO
               CONTINUE
           ELSE
               MOVE    SPACE               TO  WRK-ERR-AREA
               INITIALIZE                      WRK-ERR-AREA
               MOVE    MCP-RC              TO  WRK-MCP-RC
      *
               STRING  "ＤＢ読み込みエラー　TABLE="
                                           DELIMITED   BY  SIZE
                       MCP-TABLE           DELIMITED   BY  SPACE
                       " RC="              DELIMITED   BY  SIZE
                       WRK-MCP-RC          DELIMITED   BY  SIZE
                                           INTO    WRK-RECEERR
               END-STRING
               PERFORM 500-ERR-HENSYU-SEC
      *
               STRING  "ORCR0030 select err TABLE="
                                           DELIMITED   BY  SIZE
                       MCP-TABLE           DELIMITED   BY  SPACE
                       " PATHNAME="        DELIMITED   BY  SIZE
                       MCP-PATHNAME        DELIMITED   BY  SPACE
                       " RC="              DELIMITED   BY  SIZE
                       WRK-MCP-RC          DELIMITED   BY  SIZE
                       LOW-VALUE           DELIMITED   BY  SIZE
                                           INTO    WRK-ERRMSG
               END-STRING
               PERFORM 500-COBABORT-SEC
           END-IF
           .
       900-DBSELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢＦＥＴＣＨ処理
      *****************************************************************
       900-DBFETCH-SEC                SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    テーブルクローズ処理
      *****************************************************************
       900-CLOSE-SEC               SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-CLOSE-EXT.
           EXIT.
      *
      *****************************************************************
      *    テーブルアクセス処理
      *****************************************************************
       900-ORCDBMAIN-SEC               SECTION.
      *
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
      *
       900-ORCDBMAIN-EXT.
           EXIT.
      *      
      *****************************************************************
      *    ＤＢオープン処理
      *****************************************************************
       100-DBOPEN-SEC                SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBOPEN"            TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBSTART"           TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           .
       100-DBOPEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢクローズ処理
      *****************************************************************
       900-DBDISCONNECT-SEC            SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBCOMMIT"          TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBDISCONNECT"      TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           .
       900-DBDISCONNECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ＤＢ　ＣＯＭＭＩＴ処理
      *****************************************************************
       900-DBCOMMIT-SEC            SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBCOMMIT"          TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBCOMMIT-EXT.
           EXIT.
      *      
      *****************************************************************
      *    ＤＢ　ＳＴＡＲＴ処理
      *****************************************************************
       900-DBSTART-SEC                SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBSTART"           TO  MCP-FUNC
grpsys     PERFORM 900-ORCDBMAIN-SEC
           .
       900-DBSTART-EXT.
           EXIT.
      *
