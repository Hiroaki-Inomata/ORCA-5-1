      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this licence along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION      DIVISION.
       PROGRAM-ID.         ORCS02.
      ****************************************************************
      *    OS           LINUX                                         
      *                                                               
      *    PROGRAM      ORCS02  /  ÉéÃ´¶â³Û»»Äê¥µ¥Ö                   
      *                            ¡ÊÆþ±¡ÍÑ¡Ë                         
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  02/10/22    NACL¡ÝÌçÏÆ    ¿·µ¬ºîÀ®
      ****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *  05.00.01    NACL-ÌçÏÆ    18/11/07  ´Î¤¬¤ó¡¦½ÅÅÙ´Î¹ÅÊÑ¼£ÎÅ¸¦µæÂ¥¿Ê
      *                                     »ö¶È°åÎÅÂÐ±þ
      *  05.00.02    NACL-ÌçÏÆ    18/11/16  µÜ¾ë¸©ÃÏÊý¸øÈñÂÐ±þ
      *  05.00.03    NACL-ÌçÏÆ    18/11/20  £·£°ºÐÌ¤Ëþ¸½ÊªµëÉÕ¡Ü¸øÈñ¤Î
      *                                     ÉéÃ´¶â·×»»½¤Àµ
      *  05.00.04    NACL-ÌçÏÆ    18/11/29  ¸½ÊªµëÉÕÅ¬ÍÑ¶èÊ¬¥Á¥§¥Ã¥¯
      *  05.00.05    NACL-ÌçÏÆ    18/12/03  ·²ÇÏ¸©ÃÏÊý¸øÈñÂÐ±þ
      *  05.00.06    NACL-ÌçÏÆ    19/03/01  ËÌ³¤Æ»ÃÏÊý¸øÈñÂÐ±þ
      *  05.00.07    NACL-ÌçÏÆ    19/03/13  ÉÙ»³¸©ÃÏÊý¸øÈñÂÐ±þ
      *  05.00.08    NACL-ÌçÏÆ    19/03/20  ·×»»¶â³Û·å¿ô¥Á¥§¥Ã¥¯½¤Àµ
      *  05.00.09    NACL-ÌçÏÆ    19/03/20  ·²ÇÏ¸©ÃÏÊý¸øÈñÂÐ±þ
      *  05.00.10    NACL-ÌçÏÆ    19/04/12  ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°¥Ç¥Õ¥©¥ë¥È
      *                                     ÀßÄêÊÑ¹¹ÂÐ±þ
      *  05.00.11    NACL-ÌçÏÆ    19/05/09  ÆÃµ­»ö¹à£°£±¡Ê¸ø¡Ë¤Ë´Ø¤ï¤ë
      *                                     Áë¸ý·×»»½¤Àµ
      *  05.00.12    NACL-ÌçÏÆ    19/05/21  ½êÆÀ¶èÊ¬¥Á¥§¥Ã¥¯½¤Àµ
      *  05.00.13    NACL-ÌçÏÆ    19/06/11  ¼«Î©»Ù±ç¤Î¿©»ö·×»»ÂÐ±þ
      *  05.00.14    NACL-ÌçÏÆ    19/07/22  ÆàÎÉ¸©ÃÏÊý¸øÈñÂÐ±þ
      *  05.00.15    NACL-ÌçÏÆ    19/08/28  ÎáÏÂ¸µÇ¯£±£°·î²þÀµ¡Ê¾ÃÈñÀÇ¡Ë
      *  05.00.16    NACL-ÌçÏÆ    19/10/01  ¥Þ¥ëÄ¹ÂÐ±þ
      *  05.00.17    NACL-ÌçÏÆ    19/10/04  ·×»»¶â³Û·å¿ô¥Á¥§¥Ã¥¯½¤Àµ
      *  05.00.18    NACL-ÌçÏÆ    20/01/15  ½©ÅÄ¸©ÃÏÊý¸øÈñÂÐ±þ½¤Àµ
      *  05.00.19    NACL-ÌçÏÆ    20/03/11  ¾®»ùËýÀ­Ê£¿ô¼õµë¼Ô¾ÚÂÐ±þ
      *  05.00.20    NACL-ÌçÏÆ    20/03/26  ¾®»ùËýÀ­¤Î¼Â»Üµ¡´ØÈÖ¹æÄÉ²ÃÂÐ±þ
      *                                     ¡Ê£·£±£°¡¦£¸£±£°¡Ë
      ****************************************************************
       ENVIRONMENT         DIVISION.
       CONFIGURATION       SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
      *
       DATA                DIVISION.
       FILE                        SECTION.
      *
       WORKING-STORAGE SECTION.
      *
       01  FLG-AREA.
           03  FLG-SYUNOU              PIC 9(01).
           03  FLG-HKNNUM              PIC 9(01).
           03  FLG-HKNCOMBI            PIC 9(01).
           03  FLG-SYSKANRI            PIC 9(01).
           03  FLG-PTINF               PIC 9(01).
           03  FLG-PTKOHINF            PIC 9(01).
           03  FLG-PTHKNINF            PIC 9(01).
           03  FLG-NYUINACCT           PIC 9(01).
           03  FLG-SRYACCT             PIC 9(01).
           03  FLG-SRYACT              PIC 9(01).
           03  FLG-TENSU               PIC 9(01).
           03  FLG-PTNYUINRRK          PIC 9(01).
           03  FLG-NYUGAI              PIC 9(01).
           03  FLG-NYUGAI2             PIC 9(01).
           03  FLG-GENMEN              PIC 9(01).
           03  FLG-SANSHOU2            PIC X(01).
           03  FLG-SANSHOU3            PIC X(01).
           03  FLG-SANSHOU4            PIC X(01).
           03  FLG-SANTEI1             PIC X(01).
           03  FLG-SANTEI2             PIC X(01).
           03  FLG-SANTEI3             PIC X(01).
           03  FLG-SANTEI4             PIC X(01).
           03  FLG-NG                  PIC X(01).
           03  FLG-HIKAKU              PIC 9(01).
           03  FLG-HIKAKU2             PIC 9(01).
           03  FLG-HIKAKU3             PIC 9(01).
           03  FLG-HIKAKU4             PIC 9(01).
           03  FLG-HIKAKU-SKJ          PIC 9(01).
           03  FLG-KUMAMOTO            PIC X(01).
           03  FLG-TAIGAI              PIC X(01).
           03  FLG-HIKOTEI             PIC 9(01).
           03  FLG-TUKIHIKAKU          PIC 9(01).
           03  FLG-SEISINJYO           PIC 9(01).
           03  FLG-TOKUREI-HKNJYA      PIC 9(01).
           03  FLG-MIYAGI              PIC 9(01).
           03  FLG-NYUSKJJYOGAK        PIC 9(01).
           03  FLG-KEIKASOCHI-IPAN     PIC 9(01).
           03  FLG-SEIKATU             PIC 9(01).
           03  FLG-SEIKATUS            PIC 9(01).
           03  FLG-SEIKATUL            PIC 9(01).
           03  FLG-SEIKATUL2           PIC 9(01).
           03  FLG-ROJIN41             PIC 9(01).
           03  FLG-TOKYO               PIC 9(01).
           03  FLG-GEN70-TOKUSYU       PIC 9(01).
           03  FLG-KOHININBARAI        PIC 9(01).
           03  FLG-KOHYONKAIME         PIC 9(01).
           03  FLG-GENBUTU70           PIC 9(01).
           03  FLG-GENBUTU70-KBN       PIC 9(02).
           03  FLG-SYUKEI              PIC 9(01).
           03  FLG-SYUKEI2             PIC 9(01).
           03  FLG-SYUKEI3             PIC 9(01).
           03  FLG-GENBUTU-TAISYODATA  PIC 9(01).
           03  FLG-GENBUTU-TAISYOOK    PIC 9(01).
           03  FLG-KENPOJYUNKYO        PIC 9(01).
           03  FLG-SYUGAKUMAE          PIC 9(01).
           03  FLG-TAISYO              PIC 9(01).
           03  FLG-ZENKI-TOKUREI       PIC 9(01).
           03  FLG-CHECK-OK            PIC 9(01).
           03  FLG-TOKU75              PIC 9(01).
           03  FLG-TOKU75-KIZON        PIC 9(01).
           03  FLG-TOKU75-CYO          PIC 9(01).
           03  FLG-RUITAISYO           PIC 9(01).
           03  FLG-KOKI-HIGAITO        PIC 9(01).
           03  FLG-CYOKI-ARI           PIC 9(01).
           03  FLG-TOKUSITU            PIC 9(01).
           03  FLG-TOKUSITU-TASU       PIC 9(01).
           03  FLG-TOKUSITU-XXX        PIC 9(01).
           03  FLG-TOKUSITU-KBN        PIC 9(02).
           03  FLG-KANGAN              PIC 9(01).
           03  FLG-KANGAN-XXX          PIC 9(01).
           03  FLG-KANGAN-TASU         PIC 9(01).
           03  FLG-KANGAN-KBN          PIC 9(02).
           03  FLG-MARUKO              PIC 9(01).
           03  FLG-RUIKEIYO            PIC 9(01).
           03  FLG-RUIKEIYO2           PIC 9(01).
           03  FLG-RUIKEIYO-DAY        PIC 9(01).
           03  FLG-KOHFUKA-HENSYU      PIC 9(01).
           03  FLG-MARUTOARI           PIC 9(01).
           03  FLG-MARUTOARI2          PIC 9(01).
           03  FLG-FTNRATE100          PIC 9(01).
           03  FLG-KOREI-TANYUIN       PIC 9(01).
           03  FLG-KUMAMOTO-CYO        PIC 9(01).
           03  FLG-KOREI-HIGAITO       PIC 9(01).
           03  FLG-OITA-GENBUTU70      PIC 9(01).
           03  FLG-OITA-SYUKEI         PIC 9(01).
           03  FLG-JYOGEN-OKIKAE       PIC 9(01).
           03  FLG-SAIGAI-TAISYO       PIC 9(01).
           03  FLG-OK                  PIC 9(01).
           03  FLG-ICHIBU-JYOSEI       PIC 9(01).
           03  FLG-ZEROKOGAITO         PIC 9(01).
           03  FLG-PTRSIINF            PIC 9(01).
           03  FLG-KOMURSI             PIC 9(01).
           03  FLG-DAISAN-GENBUTU      PIC 9(01).
           03  FLG-DAISAN-KOREI        PIC 9(01).
           03  FLG-ARI                 PIC 9(01).
           03  FLG-CYOKEIKBN-N         PIC 9(01).
           03  FLG-GENGAKU-HENSYU      PIC 9(01).
           03  FLG-SET                 PIC 9(01).
           03  FLG-IRYOKEIKBN          PIC 9(01).
           03  FLG-SYUNOU-HKN-HANTEI   PIC 9(01).
           03  FLG-HANBETU             PIC 9(01).
           03  FLG-HANBETU2            PIC 9(01).
           03  FLG-HANTEI              PIC 9(01).
           03  FLG-HANTEI-ENTANI       PIC 9(01).
           03  FLG-SKJ-HANGAKCHK       PIC 9(01).
           03  FLG-KOUREI-GENEKIKBN    PIC 9(01).
           03  FLG-GENBUTU-CHECK       PIC 9(01).
           03  FLG-GENBUTU-CHECK-ERR   PIC 9(01).
           03  FLG-NARA                PIC 9(01).
      *
      *    Åº¤¨»úÎÎ°è
       01  IDX-AREA.
           03  IDX                     PIC  9(02)  VALUE  ZERO.
           03  IDX2                    PIC  9(02)  VALUE  ZERO.
           03  IDX3                    PIC  9(02).
           03  IDX4                    PIC  9(03).
           03  IDX5                    PIC  9(03).
           03  IDX6                    PIC  9(03).
           03  IDX7                    PIC  9(03).
           03  IDX8                    PIC  9(03).
           03  IDX9                    PIC  9(03).
           03  IDX10X                  PIC  X(02).
           03  IDX10R                  REDEFINES    IDX10X.
               05  IDX10               PIC  9(02).
           03  IDX13                   PIC  9(03).
           03  IDX14                   PIC  9(03).
           03  IDX15                   PIC  9(03).
           03  IDX16                   PIC  9(03).
           03  IDX17                   PIC  9(03).
           03  IDX19                   PIC  9(03).
           03  IDX20                   PIC  9(03).
           03  IDX21                   PIC  9(03).
           03  IDX22                   PIC  9(02).
           03  IDX23                   PIC  9(02).
           03  IDX24                   PIC  9(02).
           03  IDX25                   PIC  9(02).
           03  IDX26                   PIC  9(03).
           03  IDX27                   PIC  9(02).
           03  IDX28                   PIC  9(02).
           03  IDX-ST                  PIC  9(02)  VALUE  ZERO.
           03  IDX-ED                  PIC  9(02)  VALUE  ZERO.
           03  IDY                     PIC  9(02)  VALUE  ZERO.
           03  IDY2                    PIC  9(02).
           03  IDZ                     PIC  9(02)  VALUE  ZERO.
           03  HKNNYU-IDX              PIC  9(02)  VALUE  ZERO.
           03  KOH-IDX                 PIC  9(02)  VALUE  ZERO.
           03  KOH-IDX2                PIC  9(02)  VALUE  ZERO.
           03  KOH-IDX3                PIC  9(02)  VALUE  ZERO.
           03  KIRIKAE-IDX             PIC  9(02).
           03  NYULIFE-IDX             PIC  9(02).
           03  GEN-IDX                 PIC  9(02).
           03  SYOTOKU-IDX             PIC  9(02).
           03  CHECK-IDX               PIC  9(02).
           03  CHECK-IDX2              PIC  9(02).
           03  KOHFUKA-IDX             PIC  9(02).
           03  KOHFUKA-IDX2            PIC  9(01).
           03  IDX-CYO                 PIC  9(03).
           03  RRK-IDX                 PIC  9(02).
           03  RRK-IDX2                PIC  9(02).
           03  RRK-IDX3                PIC  9(02).
           03  RRK-IDX4                PIC  9(02).
           03  RRK-IDX5                PIC  9(02).
      *
       01  WRK-AREA.
           03  WK-KNJFTNKIN            PIC 9(10).
           03  WK-KNJFTNKIN-ENTANI     PIC 9(08)V9(01).
           03  WK-ENTANI               PIC 9(08)V9(01).
           03  WK-ENTANI2              PIC 9(08).
           03  WK-CYOKI                PIC 9(08).
           03  WK-CYOKI-ENTANI         PIC 9(08)V9(01).
           03  WK-CYOKI-ZAN            PIC 9(08).
           03  WK-CYOKI-ZAN-ENTANI     PIC 9(08)V9(01).
           03  WK-ZENGAKU              PIC 9(10).
           03  WK-ZENGAKU-SYU          PIC 9(10).
           03  WK-ZENGAKU-YAK          PIC 9(10).
           03  WK-FUTANWARI            PIC 9V99.
           03  WK-FUTANWARI2           PIC 9V99.
           03  WK-SEIKYUGK             PIC 9(10).
           03  WK-NYUKFTNRATE          PIC 9(03).
           03  WK-NYUKFTNRATE2         PIC 9(03).
           03  WK-NYUKFTNRATE019       PIC 9(03).
           03  WK-NYUSKJJYOGAK         PIC 9(06).
           03  WK-NYUSKJJYOGAK2        PIC 9(09).
           03  WK-TOKUTEI-COMPFTN      PIC 9(08).
           03  WK-TOKUTEI-COMPFTN2     PIC 9(08).
           03  WK-TOKUTEI-COMPFTN2-ENTANI
                                       PIC 9(08)V9(01).
           03  WK-TOKUTEI-COMPFTN3     PIC 9(08).
           03  WK-TOKUTEI-COMPFTN4     PIC 9(08).
           03  WK-HANGAKU-COMPFTN      PIC 9(07).
           03  WK-HANGAKU-ENTANI       PIC 9(07)V9(01).
           03  WK-GENMEN-KEISAN        PIC 9(10).
           03  WK-GENMEN-KEISAN2       PIC 9(10).
           03  WK-JIHIGAKU             PIC 9(10).
           03  WK-JIHIGAKU2            PIC 9(10).
           03  WK-JIHIGAKU3            PIC 9(10).
           03  WK-JIHIGAKU4            PIC 9(10).
           03  WK-JIHIFTN              PIC 9V99.
           03  WK-ZAN-JIRITU           PIC 9(08).
           03  WK-ZAN-JIRITU-ENTANI    PIC 9(08)V9(01).
           03  WK-KOH-GENDOGAKU        PIC 9(07).
           03  WK-GEN70-GENDOGAKU      PIC 9(07).
           03  WK-GEN70-GENDOGAKU2     PIC 9(07).
           03  WK-SKYMONEY-ZEI         PIC 9(07).
           03  WK-RSIETC-ZEITAISYO     PIC 9(07).
           03  WK-SKJ-ZEITAISYO        PIC 9(07).
           03  WK-KEISAN-JIBAI         PIC 9(07).
           03  WK-SKJ-ZEI              PIC 9(07).
           03  WK-SKJ-ZEIKEI           PIC 9(07).
           03  WK-SKJ-ZEIKEI2          PIC 9(07).
           03  WK-SKJ-ZEIKEIL          PIC 9(07).
           03  WK-SKJ-ZEIKEI2L         PIC 9(07).
           03  WK-GENBUTU-KOH1COMPFTN  PIC 9(07).
           03  WK-GENBUTU-KOH2COMPFTN  PIC 9(07).
           03  WK-GENBUTU-KOH3COMPFTN  PIC 9(07).
           03  WK-GENBUTU-KOH4COMPFTN  PIC 9(07).
           03  WK-GENBUTU-HKNKIN       PIC 9(10).
           03  WK-GENBUTU-HKNKIN2      PIC 9(10).
           03  WK-GENBUTU-HKNKIN3      PIC 9(10).
           03  WK-SEIHO-GENDO          PIC 9(07).
           03  WK-SEIHO-GENDO70        PIC 9(07).
           03  WK-CYOKI-GENDO          PIC 9(07).
           03  WK-CYOKI-GENDO2         PIC 9(07).
           03  WK-KOH-GENDOGAKU-TOKU75 PIC 9(07).
           03  WK-GEN70-GENDOGAKU-TOKU75
                                       PIC 9(07).
           03  WK-SEIHO-GENDO-TOKU75   PIC 9(07).
           03  WK-SEIHO-GENDO70-TOKU75 PIC 9(07).
           03  WK-CYOKI-GENDO-TOKU75   PIC 9(07).
           03  WK-CYOKI-GENDO2-TOKU75  PIC 9(07).
           03  WK-CYOKI-TOKU75         PIC 9(08).
           03  WK-CYOKI-ENTANI-TOKU75  PIC 9(08)V9(01).
           03  WK-CYOKI-ZAN-XXX        PIC 9(08).
           03  WK-CYOKI-ZAN-XXX-ENTANI PIC 9(08)V9(01).
           03  WK-DAY-KEISAN           PIC 9(08).
           03  WK-SKYCHK-KEISAN        PIC 9(10).
           03  WK-SKYCHK-KEISAN2       PIC 9(10).
           03  WK-SKYCHK-KEISAN3       PIC 9(10).
           03  WK-SKYCHK-KEISAN4       PIC 9(10).
           03  WK-SKYCHK-KEISAN5       PIC 9(10).
           03  WK-SKYCHK-KEISAN7       PIC 9(10).
           03  WK-SKYCHK-KEISAN8       PIC 9(10).
           03  WK-SKYCHK-KEISAN9       PIC 9(10).
           03  WK-SKYCHK-KEISAN10      PIC 9(10).
           03  WK-S1                   PIC 9(03).
           03  WK-S2                   PIC 9(03).
           03  WK-S3                   PIC 9V99999.
           03  WK-S4                   PIC 9V99.
           03  WK-S5                   PIC 9V99.
           03  WK-DAYCNT               PIC 9(03).
      *
           03  WK-PAYKBN               PIC X(02).
           03  WK-1001-JIHIPOSITION    PIC X(01).
           03  WK-1001-CHIHOUNUMKBN    PIC X(01).
           03  WK-1001-GENTAIKBN       PIC X(01).
           03  WK-1001-DAISANKBN       PIC X(01).
      *
           03  WK-NYUJGNKBN            PIC X(01).
           03  WK-NYUJGNGAK            PIC 9(07).
      *
           03  WK-KOHJGNGET-TBL.
               05  WK-KOHJGNGET-OCC              OCCURS   4.
                 06  WK-KOHJGNGET-TAISYOKBN      PIC 9(01).
                 06  WK-KOHJGNGET-TEKSTYMD       PIC X(08).
                 06  WK-KOHJGNGET-TEKIYOFLG      PIC 9(01).
                 06  WK-KOHJGNGET-CHECK092       PIC 9(01).
      *
           03  WK-SYS2010-TBL.
               05  WK-SYS2010-OCC                OCCURS   4.
                 06  WK-2010-JGNFTNKBN           PIC X(01).
                 06  WK-2010-JYUHENKBN           PIC X(01).
                 06  WK-2010-JYUHEN-TAIKBN       PIC X(01).
                 06  WK-2010-IRYOKEIKBN-N        PIC X(01).
                 06  WK-2010-IRYOKEIKBN-N-XXX    PIC X(01).
                 06  WK-2010-SKJKEIKBN           PIC X(01).
                 06  WK-2010-KINJYOKBN-N         PIC X(01).
                 06  WK-2010-SKJRYOKBN-HON       PIC X(01).
                 06  WK-2010-SEIRYOKBN-HON       PIC X(01).
                 06  WK-2010-SEIKANKBN-HON       PIC X(01).
                 06  WK-2010-SKJRYOKBN-TSY       PIC X(01).
                 06  WK-2010-SEIRYOKBN-TSY       PIC X(01).
                 06  WK-2010-SEIKANKBN-TSY       PIC X(01).
                 06  WK-2010-SKJRYOKBN-TNK       PIC X(01).
                 06  WK-2010-SEIRYOKBN-TNK       PIC X(01).
                 06  WK-2010-SEIKANKBN-TNK       PIC X(01).
                 06  WK-2010-SYOKEIKBN-N         PIC X(01).
                 06  WK-2010-DAYKEIKBN-N         PIC X(01).
                 06  WK-2010-NINNASIKBN          PIC X(01).
                 06  WK-2010-NINJYOKBN           PIC X(01).
                 06  WK-2010-NYUKEIKBN-N         PIC X(01).
                 06  WK-2010-NYUKEI-KJNYMD       PIC X(08).
                 06  WK-2010-KOGAKKEIKBN         PIC X(01).
                 06  WK-2010-TANKIKBN            PIC X(01).
                 06  WK-2010-ZENDAYKBN-N         PIC X(01).
                 06  WK-2010-KAICNTKBN-N         PIC X(01).
                 06  WK-2010-CYOKEIKBN-N         PIC X(01).
                 06  WK-2010-JIRITUKBN           PIC X(01).
                 06  WK-2010-ZENDAY2KBN-N        PIC X(01).
                 06  WK-2010-SYOKEI2KBN-N        PIC X(01).
                 06  WK-2010-NINNASIKBN-K        PIC X(01).
      *
           03  WK-SYS2010-CYOKI-TBL.
                 06  WK-2010-CYOKI-FTNKBN        PIC X(01).
      *
           03  WK-DAYTAIHI-FTNMONEY    PIC 9(07).
           03  WK-DAYTAIHI-COMPFTN     PIC 9(07).
           03  WK-DAYTAIHI-COMPFTNWK   PIC 9(07).
      *
      *    ÊÝ¸±¶èÊ¬¡Ê¶õÇò¡§°åÊÝ¡¢£±¡§Ï«ºÒ¼«Çå¡¢£²¡§¸ø³²¡Ë
           03  WK-HKNKBN               PIC X(01).
      *
      *    ´µ¼ÔÉéÃ´·×»»»þ¤Î»Í¼Î¸ÞÆþÍÑ¥ï¡¼¥¯
           03  WK-FTN                  PIC 9(10).
      *
      *    ÉÂ±¡³ä°ú³Û·×»»»þ¤Î³ä°úÎ¨ÍÑ¥ï¡¼¥¯
           03  WK-RATE                 PIC 9(1)V9(2).
      *
      *    ÀÁµá³Û¶â³ÛÃ¼¿ô¶èÊ¬¡Ê¸ºÌÈÍ­¤ê¡Ë
           03  WK-HASU1001-KBN         PIC X(1).
      *    ÀÁµá³Û¶â³ÛÃ¼¿ô¶èÊ¬¡Ê¸ºÌÈÌµ¤·¡¦ÊÝ¸±Ê¬¡Ë
           03  WK-HASU1001-KBN2        PIC X(1).
      *    ÀÁµá³Û¶â³ÛÃ¼¿ô¶èÊ¬¡Ê¸ºÌÈÌµ¤·¡¦¼«ÈñÊ¬¡Ë
           03  WK-HASU1001-KBN2J       PIC X(1).
      *
      *    ÀÁµá³Û¶â³ÛÃ¼¿ô¶èÊ¬¡§Ï«ºÒ¡¡¡Ê¸ºÌÈÌµ¤·¡¦ÊÝ¸±Ê¬¡Ë
           03  WK-HASU1001-KBN3        PIC X(1).
      *    ÀÁµá³Û¶â³ÛÃ¼¿ô¶èÊ¬¡¡¡¡¡¡¡¡¡Ê¸ºÌÈÌµ¤·¡¦¼«ÈñÊ¬¡Ë
           03  WK-HASU1001-KBN3J       PIC X(1).
      *    ÀÁµá³Û¶â³ÛÃ¼¿ô¶èÊ¬¡§¼«ÇåÀÕ¡Ê¸ºÌÈÌµ¤·¡¦ÊÝ¸±Ê¬¡Ë
           03  WK-HASU1001-KBN4        PIC X(1).
      *    ÀÁµá³Û¶â³ÛÃ¼¿ô¶èÊ¬¡¡¡¡¡¡¡¡¡Ê¸ºÌÈÌµ¤·¡¦¼«ÈñÊ¬¡Ë
           03  WK-HASU1001-KBN4J       PIC X(1).
      *    ÀÁµá³Û¶â³ÛÃ¼¿ô¶èÊ¬¡§¸ø³²¡¡¡Ê¸ºÌÈÌµ¤·¡¦¼«ÈñÊ¬¡Ë
           03  WK-HASU1001-KBN5J       PIC X(1).
      *    ÀÁµá³Û¶â³ÛÃ¼¿ô¶èÊ¬¡§Âè»°¼Ô¹Ô°Ù¡Ê¸ºÌÈÌµ¤·¡¦ÊÝ¸±Ê¬¡Ë
           03  WK-HASU1001-KBN6        PIC X(1).
      *    ÀÁµá³Û¶â³ÛÃ¼¿ô¶èÊ¬¡¡¡¡¡¡¡¡¡¡¡¡¡Ê¸ºÌÈÌµ¤·¡¦¼«ÈñÊ¬¡Ë
           03  WK-HASU1001-KBN6J       PIC X(1).
      *    ÀÁµá³Û¶â³ÛÃ¼¿ô¶èÊ¬¡§£×£Ë¡¡¡Ê¸ºÌÈÌµ¤·¡¦ÊÝ¸±Ê¬¡Ë
           03  WK-HASU1001-KBN-WK      PIC X(1).
      *    ÀÁµá³Û¶â³ÛÃ¼¿ô¶èÊ¬¡¡¡¡¡¡¡¡¡Ê¸ºÌÈÌµ¤·¡¦¼«ÈñÊ¬¡Ë
           03  WK-HASU1001-KBN-WKJ     PIC X(1).
      *
           03  WK-HASU-KBN             PIC X(1).
      *
      *    ¾ÃÈñÀÇÃ¼¿ô¶èÊ¬
           03  WK-TAX1001-KBN          PIC X(1).
      *
      *    ¸©ÈÖ¹æ
           03  WK-1001-PREFNUM         PIC 9(2).
      *
           03  WK-TAIHI-RECEFTNDSPKBN-OCC.
               05  WK-TAIHI-RECEFTNDSPKBN
                                       PIC X(1)    OCCURS   4.
      *    Ê¡²¬¸©ÃÏÊý¸øÈñÉéÃ´¶èÊ¬¡¦¼çÊÝ¸±¤ÎÉéÃ´³ä¹ç
           03  WK-KOH-FTNKBN           PIC X(1).
           03  WK-KOH-FTNRATE          PIC 9(3).
      *
           03  WK-TAIHI-NYUJGNGAK-OCC.
               05  WK-TAIHI-NYUJGNGAK  PIC 9(7)    OCCURS   4.
      *
           03  WK-TAIHI-FTNGAKEN-OCC.
               05  WK-TAIHI-FTNGAKEN   PIC 9(1)    OCCURS   4.
      *
           03  WK-TAIHI-JGNGAKEN-OCC.
               05  WK-TAIHI-JGNGAKEN   PIC 9(7)    OCCURS   4.
      *
           03  WK-TAIHI-SDAY-COMPFTN   PIC 9(10).
           03  WK-TAIHI-SDAY-COMPFTNWK PIC 9(10)V9(01).
           03  WK-TAIHI-SDAY-FTNMONEY  PIC 9(10).
      *
           03  WK-DAYINF-ZENKOH-AREA.
               05  WK-DAYINF-ZENKOH-OCC            OCCURS   4.
                 06  WK-DAYINF-ZENKOH-FLG          PIC 9(1).
                 06  WK-DAYINF-ZENKOH-ZAN-T        PIC 9(8).
                 06  WK-DAYINF-ZENKOH-ZAN-T2       PIC 9(8).
                 06  WK-DAYINF-ZENKOH-ZAN-T3       PIC 9(8)V9(01).
      *
           03  WK-TAIHI-ZAN-KOHI-T     PIC 9(8).
           03  WK-TAIHI-ZAN-KOHI-T2    PIC 9(8).
           03  WK-TAIHI-ZAN-KOHI-T3    PIC 9(8)V9(01).
      *
           03  WK-TAIHI-GENGAKU-KIN                PIC 9(07).
           03  WK-TAIHI-GENGAKU-KIN-ENTANI         PIC 9(07)V9(01).
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°ÀßÄê³ÛÌ¤Ëþ¡¦°Ê¾å¤Ç°Û¤Ê¤ëÉéÃ´¶â·×»»
      *    ÀßÄê¡Ö£³¡×¡Ö£´¡×ÍÑ
           03  WK-TAIHI-IRYOKEIKBNINF-OCC.
               05  WK-TAIHI-FTN-KOHI-M        PIC 9(08)  OCCURS   4.
               05  WK-TAIHI-ZAN-KOHI-M        PIC 9(08).
               05  WK-TAIHI-MAX-KIN-KOHI-M    PIC 9(08).
               05  WK-TAIHI-MAX-KIN-KOHI1-M   PIC 9(08).
               05  WK-TAIHI-MAX-KIN-KOHI2-M   PIC 9(08).
               05  WK-TAIHI-MAX-KIN-KOHI3-M   PIC 9(08).
               05  WK-TAIHI-MAX-KIN-KOHI4-M   PIC 9(08).
               05  WK-TAIHI-KARI-COMPFTN      PIC 9(08).
               05  WK-TAIHI-HANTEIFLG         PIC 9(01)  OCCURS   4.
      *
      *****Ï«ºÒ¡¦¼«ÇåÀÕ
      *    ¼«ÇåÀÕ¡Ê²Ã»»Î¨¡Ë
           03  WK-4001-KSNRATE         PIC 9(2).
           03  WK-4001-KSNRATE1        PIC 9(3).
      *    ¼«ÇåÀÕÊ¸½ñÎÁ¾ÃÈñÀÇ
           03  WK-4001-TAXKBN          PIC X(1).
      *    ÅÀ¿ôÃ±²Á¶èÊ¬
           03  WK-4001-TENKBN          PIC X(1).
      *    ¼«ÇåÀÕ¿©»öÎÅÍÜÈñ¶èÊ¬
           03  WK-4001-SKJKBN          PIC X(1).
      *    ¼«ÇåÀÕÆÃÄê´ïºàÅù¾ÃÈñÀÇ
           03  WK-4001-TAXKBN-KZI      PIC X(1).
      *    µ»½ÑÅÀÃ±²Á
           03  WK-4001-SYUTENTANKA     PIC 9(2).
      *    ÌôºÞÅùÅÀÃ±²Á
           03  WK-4001-YKZTENTANKA     PIC 9(2).
      *    ¸øÌ³ºÒ³²ÅÀÃ±²Á
           03  WK-4001-KOMUTENTANKA    PIC 9(2).
      *    ¸øÌ³ºÒ³²Ï«ºÒ½àµòÅÀ¿ôÃ±²Á¶èÊ¬
           03  WK-4001-KOMURSITANKAKBN PIC X(01).
      *    ¸øÌ³ºÒ³²Ï«ºÒ½àµòÅÀ¿ôÃ±²Á
           03  WK-4001-KOMURSITANKA-G.
               05  WK-4001-KOMURSITANKA    PIC  99V99.
      *
      *    ¼«ÇåÀÕÆÃÄê´ïºàÅù¾ÃÈñÀÇÂÐ¾Ý³°¥³¡¼¥É
           03  WK-4003-TAIGAI.
               05  WK-4003-TAIGAI-OCC      OCCURS  50.
                 06  WK-4003-TAIGAI-SRYCD  PIC  X(09).
      *
      *    ¼«ÇåÀÕ¤½¤ÎÂ¾¥³¡¼¥É¡Ê£°£¹£µ£¹£±¡¥£¹£²¡¥£¹£³¡Ë¤Î¿ÇÎÅ¹Ô°Ù¥³¡¼¥ÉÅù
           03  WK-SONOTA91.
               05  WK-SONOTA91-OCC         OCCURS  50.
                 06  WK-SONOTA91-SRYCD     PIC  X(09).
                 06  WK-SONOTA91-ZAIKAISU  PIC  9(07).
                 06  WK-SONOTA91-TANKA     PIC  9(07).
           03  WK-SONOTA92.
               05  WK-SONOTA92-OCC         OCCURS  50.
                 06  WK-SONOTA92-SRYCD     PIC  X(09).
                 06  WK-SONOTA92-ZAIKAISU  PIC  9(07).
                 06  WK-SONOTA92-TANKA     PIC  9(07).
           03  WK-SONOTA93.
               05  WK-SONOTA93-OCC         OCCURS  50.
                 06  WK-SONOTA93-SRYCD     PIC  X(09).
                 06  WK-SONOTA93-ZAIKAISU  PIC  9(07).
                 06  WK-SONOTA93-TANKA     PIC  9(07).
      *
           03  WK-ZAN-KOHI-D           PIC 9(05).
           03  WK-DAY-NYUKFTNRATE      PIC 9(03).
           03  WK-DAY-NYUKFTNRATE2     PIC 9(03).
           03  WK-DAY-NYUKFTNRATE9     PIC 9(03).
           03  WK-DAY-NYUKFTNRATE-FLG  PIC 9(01).
           03  WK-DAY-NYUKFTNRATE-FLG2 PIC 9(01).
           03  WK-DAY-NYUKFTNRATE-FLG9 PIC 9(01).
           03  WK-DAY-COMPFTN          PIC 9(05).
           03  WK-RYOYO                PIC 9(07).
           03  WK-KSNRATE9             PIC 9(03).
           03  WK-KSNRATE              PIC 9V99. 
           03  WK-BRMSGK-TAXKBN        PIC X(01).
           03  WK-KEISAN-XX            PIC 9(09).
           03  WK-KEISAN               PIC 9(09).
           03  WK-KEISAN1              PIC 9(09).
           03  WK-KEISAN2              PIC 9(09).
           03  WK-KEISAN3              PIC 9(09).
           03  WK-KEISAN4              PIC 9(09).
           03  WK-KEISAN9              PIC 9(09).
           03  WK-KEISAN-SKJ           PIC 9(09).
           03  WK-KEISAN1-SKJ          PIC 9(09).
           03  WK-KEISAN2-SKJ          PIC 9(09).
           03  WK-KEISAN3-SKJ          PIC 9(09).
           03  WK-KEISAN4-SKJ          PIC 9(09).
           03  WK-KEISAN9-SKJ          PIC 9(09).
           03  WK-KEISAN-ENTANI        PIC 9(08)V9(01).
           03  WK-KEISAN1-ENTANI       PIC 9(08)V9(01).
           03  WK-KEISAN2-ENTANI       PIC 9(08)V9(01).
           03  WK-KEISAN3-ENTANI       PIC 9(08)V9(01).
           03  WK-KEISAN4-ENTANI       PIC 9(08)V9(01).
           03  WK-KEISAN9-ENTANI       PIC 9(08)V9(01).
           03  WK-KEISAN-JYOSEI        PIC 9(07).
           03  WK-KEISAN-JYOSEI2       PIC 9(07).
           03  WK-KEISAN-JYOSEI3       PIC 9(07).
           03  WK-KEISAN-JYOSEI-EN     PIC 9(07)V9(01).
      *
      *    ÆÃ¼ì·×»»ÍÑ
           03  WK-TOKUSYU-COMPFTN      PIC 9(07).
           03  WK-TOKUSYU-COMPFTN2     PIC 9(07).
           03  WK-TOKUSYU-ENTANI       PIC 9(07)V9(01).
           03  WK-TOKUSYU              PIC 9(07).
           03  WK-TOKUSYU2             PIC 9(07).
           03  WK-TOKUSYU-KEISAN-EN1   PIC 9(07)V9(01).
           03  WK-TOKUSYU-KEISAN-EN2   PIC 9(07)V9(01).
           03  WK-TOKUSYU-KEISAN-EN11  PIC 9(07).
           03  WK-TOKUSYU-KEISAN-EN21  PIC 9(07).
           03  WK-TOKUSYU-KEISAN-EN3   PIC 9(07)V9(01).
           03  WK-TAIHI-TOKU1          PIC 9(07)V9(01).
      *
           03  WK-JIRITU-TBL.
               05  WK-JIRITU-OCC           OCCURS   4.
                 06  WK-JIRITU-CYUKANSOU   PIC  9(01).
                 06  WK-JIRITU-TAFTNRUIKEI PIC  9(07).
                 06  WK-JIRITU-SKJGENMEN   PIC  9(01).
      *
                 06  WK-CHIHOU-TAFTNRUIKEI PIC  9(07).
                 06  WK-KANEN-TAFTNRUIKEI  PIC  9(07).
                 06  WK-TOKUSITU-TAFTNRUIKEI
                                           PIC  9(07).
                 06  WK-TOKUSITU-SKJGENMEN PIC  9(01).
      *
           03  WK-SYOGAI-TBL.
               05  WK-SYOGAI-OCC           OCCURS   4.
                 06  WK-SYOGAI-SKJGAK      PIC  9(07).
                 06  WK-SYOGAI-SKJGENMEN   PIC  9(01).
      *
           03  WK-SYOFUKUMU-TBL.
               05  WK-SYOFUKUMU-OCC        OCCURS   4.
                 06  WK-SYOFUKUMU-GENDOGAK PIC  9(07).
                 06  WK-SYOFUKUMU-FLG      PIC  9(01).
      *
           03  WK-JIRITU-SRYYMD            PIC  X(08).
      *
           03  WK-OITA-HKNFTNMONEY         PIC  9(07).
           03  WK-OITA-CYOFTN              PIC  9(07).
           03  WK-OITA-CYOFTN-KON          PIC  9(07).
           03  WK-OITA-KEISAN              PIC  9(07).
           03  WK-OITA-KEISAN2             PIC  9(07).
           03  WK-OITA-KEISAN3             PIC  9(07).
      *
           03  WK-GENGAKUKBN               PIC  9(01).
           03  WK-GENGAKUKBN-KEISAN        PIC  9(01).
           03  WK-GENGAKU-KOHID            PIC  9(10).
           03  WK-GENGAKU-RITU             PIC  9(03).
           03  WK-GENGAKU-RITUX            PIC  9(03).
           03  WK-GENGAKU-KIN              PIC  9(07).
           03  WK-GENGAKU-KIN2             PIC  9(07).
           03  WK-GENGAKU-KIN2-ENTANI      PIC  9(07)V9(01).
           03  WK-GENGAKU-GAK              PIC  9(07).
           03  WK-GENGAKU-GAK-ENTANI       PIC  9(07)V9(01).
           03  WK-GENGAKU-GAK2             PIC  9(07).
           03  WK-GENGAKU-GAK2-ENTANI      PIC  9(07)V9(01).
           03  WK-GENGAKU-GAK8             PIC  9(07).
           03  WK-GENGAKU-GAK8-ENTANI      PIC  9(07)V9(01).
           03  WK-GENGAKU-GAK9             PIC  9(07).
           03  WK-GENGAKU-GAK9-ENTANI      PIC  9(07)V9(01).
           03  WK-GENGAKU-TEN-TBL.
               05  WK-GENGAKU-TEN-OCC      OCCURS   100.
                 06  WK-GENGAKU-TEN        PIC  9(07).
                 06  WK-GENGAKU-FTN        PIC  9(07).
                 06  WK-GENGAKU-FTN-ENTANI PIC  9(07)V9(01).
      *
           03  WK-KOHININBARAI-KOHID       PIC  9(10).
           03  WK-KOHININBARAI-JKYSNUM     PIC  X(20).
      *
           03  WK-HKNJANUM-TBL.
               05  WK-HKNJANUM             PIC  X(08).
               05  WK-HONKZKKBN            PIC  X(01).
               05  WK-KIGO                 PIC  X(80).
               05  WK-NUM                  PIC  X(80).
           03  WK-HKNJANUM2-TBL.
               05  WK-HKNJANUM2            PIC  X(08).
               05  WK-HONKZKKBN2           PIC  X(01).
               05  WK-KIGO2                PIC  X(80).
               05  WK-NUM2                 PIC  X(80).
           03  WK-HKNJANUM3-TBL.
               05  WK-HKNJANUM3            PIC  X(08).
               05  WK-HONKZKKBN3           PIC  X(01).
               05  WK-KIGO3                PIC  X(80).
               05  WK-NUM3                 PIC  X(80).
           03  WK-HKNJANUM4-TBL.
               05  WK-HKNJANUM4            PIC  X(08).
               05  WK-HONKZKKBN4           PIC  X(01).
               05  WK-KIGO4                PIC  X(80).
               05  WK-NUM4                 PIC  X(80).
           03  WK-HKNJANUM5-TBL.
               05  WK-HKNJANUM5            PIC  X(08).
               05  WK-HONKZKKBN5           PIC  X(01).
               05  WK-KIGO5                PIC  X(80).
               05  WK-NUM5                 PIC  X(80).
      *
           03  WK-CONTKBN                  PIC  X(01).
           03  WK-CONTKBN2                 PIC  X(01).
      *
           03  WK-SYOTOKU-SKJKBN-TBL.
               05  WK-SYOTOKU-SKJKBN       PIC  X(01)  OCCURS  31.
      *
           03  WK-DOTANDOKU-TBL.
               05  WK-DOTANDOKU-OCC        OCCURS   4.
                 06  WK-DOTANDOKU          PIC  9(01).
                 06  WK-DOTANDOKUFLG       PIC  9(01).
      *
           03  WK-TOKATUKAI-TBL.
               05  WK-TOKATUKAI-OCC        OCCURS   4.
                 06  WK-TOKATUKAI          PIC  9(01).
      *
           03  WK-TOKUSITU-SKJ-TBL.
               05  WK-TOKUSITU-SKJ-OCC     OCCURS   4.
                 06  WK-TOKUSITU-SKJ       PIC  9(01).
      *
           03  WK-KOHNUM                   PIC  X(03).
      *
           03  WK-TOTORI-JIRITU            PIC  9(01).
      *
           03  WK-ZENKI-TOKUREI-MONEY      PIC  9(07).
      *
           03  WK-CHECK-FTNJANUM           PIC  X(08).
           03  WK-CHECK-FTNJANUM2          PIC  X(08).
           03  WK-CHECK-JKYSNUM            PIC  X(20).
           03  WK-CHECK-JKYSNUM2           PIC  X(20).
      *
           03  WK-KOH-FTNJANUM             PIC  X(08).
      *
           03  WK-BIRTHDAY                 PIC  X(08).
      *
           03  WK-TOKU75-BIRTHDAY          PIC  X(08).
           03  WK-TOKU75-TEKSTYMD          PIC  X(08).
           03  WK-TOKU75-TEKEDYMD          PIC  X(08).
      *
           03  WK-CYO-OKIKAE-TBL.
               05  WK-CYO-OKIKAE-OCC       OCCURS   4.
                 06  WK-CYO-OKIKAE         PIC  9(01).
      *
           03  WK-RUI-TBL.
               05  WK-RUI-FTN1-M           PIC  9(07).
               05  WK-RUI-FTN1-M-TOKU75    PIC  9(07).
               05  WK-RUI-FTN1-M-JI        PIC  9(07).
               05  WK-RUI-FTN1-M-JI-TOKU75 PIC  9(07).
      *
               05  WK-RUI-FTN1-M2            PIC  9(07).
               05  WK-RUI-FTN1-M2-TOKU75     PIC  9(07).
               05  WK-RUI-FTN1-M2-JI         PIC  9(07).
               05  WK-RUI-FTN1-M2-JI-TOKU75  PIC  9(07).
      *
               05  WK-RUI-FTN1-M3            PIC  9(07)V9(01).
               05  WK-RUI-FTN1-M3-TOKU75     PIC  9(07)V9(01).
               05  WK-RUI-FTN1-M3-JI         PIC  9(07)V9(01).
               05  WK-RUI-FTN1-M3-JI-TOKU75  PIC  9(07)V9(01).
      *
               05  WK-RUI-FTN1-M4            PIC  9(07).
               05  WK-RUI-FTN1-M4-TOKU75     PIC  9(07).
               05  WK-RUI-FTN1-M4-JI         PIC  9(07).
               05  WK-RUI-FTN1-M4-JI-TOKU75  PIC  9(07).
      *
               05  WK-RUI-FTN2-M           PIC  9(07).
               05  WK-RUI-FTN2-M2          PIC  9(07).
               05  WK-RUI-FTN2-M3          PIC  9(07).
      *
               05  WK-RUI-FTN2-M3-XXX      PIC  9(07)V9(01).
               05  WK-ZAN-FTN2-M3-XXX      PIC  9(07)V9(01).
      *
               05  WK-RUI-FTNRATE          PIC  9(03).
               05  WK-RUI-COMPFTN          PIC  9(07).
               05  WK-RUI-COMPFTN-XXX      PIC  9(07).
               05  WK-RUI-HKNFTNMONEY      PIC  9(07).
               05  WK-RUI-COMPFTN-ENTANI   PIC  9(07)V9(01).
               05  WK-RUI-COMPFTN-ENTANI2  PIC  9(07).
               05  WK-RUI-TAISYO           PIC  9(01).
      *
               05  WK-RUI-TAIHI-HKNFTNMONEY
                                           PIC  9(07).
               05  WK-RUI-TAIHI-COMPFTN    PIC  9(07).
               05  WK-RUI-TAIHI-COMPFTN-ENTANI
                                           PIC  9(07)V9(01).
               05  WK-RUI-ZENGAKU          PIC  9(10).
      *
           03  WK-MARUKO-TBL.
               05  WK-MARUKO-M             PIC  9(09).
               05  WK-MARUKO-ME            PIC  9(09)V9(01).
               05  WK-MARUKO-KIN           PIC  9(09).
               05  WK-MARUKO-FTN           PIC  9(09).
               05  WK-MARUKO-FTN2          PIC  9(09).
               05  WK-MARUKO-XX            PIC  9(09).
               05  WK-MARUKO-COMPFTN       PIC  9(09).
               05  WK-MARUKO-COMPFTN-E     PIC  9(09)V9(01).
      *
           03  WK-GEN70-YMD.
               05  WK-GEN70-YM             PIC  9(06).
               05  WK-GEN70-DD             PIC  9(02).
           03  WK-GEN70-YMD-ED.
               05  WK-GEN70-YM-ED          PIC  9(06).
               05  WK-GEN70-DD-ED          PIC  9(02).
      *
           03  WK-SYOUKAN-FTNRATE          PIC  9(03).
           03  WK-MARUTOARI-COMPFTN        PIC  9(07).
      *
           03  WK-KUMAMOTO-SYUCOMPFTN      PIC  9(07).
           03  WK-KUMAMOTO-HANTEIKIN       PIC  9(10).
           03  WK-KUMAMOTO-HANTEIJGN       PIC  9(10).
      *
           03  WK-TOKUSYOKU-SURYOU         PIC  9(01).
      *
           03  WK-RRK-TBL.
               05  WK-RRK-OCC              OCCURS  31.
                 06  WK-RRK-NYUINYMD       PIC  X(08).
                 06  WK-RRK-SHONUM         PIC  9(03).
                 06  WK-RRK-KAISU          PIC  9(03).
                 06  WK-RRK-KAISU-ZAN      PIC  9(03).
           03  WK-RRK-SRYYM                PIC  X(06).
           03  WK-RRK-HKNNUM               PIC  X(03).
      *
           03  WK-RRK2-TBL.
               05  WK-RRK2-OCC             OCCURS   4.
                 06  WK-RRK2-FLG           PIC  9(01).
      *
           03  WK-JYOSEI-KOHIKIN           PIC  9(07).
           03  WK-JYOSEI-KOHIKIN2          PIC  9(07).
           03  WK-JYOSEI-KOHIKIN3          PIC  9(07).
           03  WK-JYOSEI-KOHIKIN-ZENGAKU   PIC  9(07).
           03  WK-JYOSEI-KOHIKIN-EN        PIC  9(07)V9(01).
           03  WK-JYOSEI-KOHIKIN-KEI       PIC  9(07).
           03  WK-JYOSEI-KOHIKIN-RUI       PIC  9(07).
           03  WK-JYOSEI-KOHIKIN-RUI2      PIC  9(07).
           03  WK-JYOSEI-KOHIKIN-RUI3      PIC  9(07).
      *
           03  WK-CHECK-TEKYMD.
               05  WK-CHECK-TEKYM          PIC  9(06).
               05  WK-CHECK-TEKDD          PIC  9(02).
           03  WK-CHECK2-TEKYMD.
               05  WK-CHECK2-TEKYM         PIC  9(06).
               05  WK-CHECK2-TEKDD         PIC  9(02).
      *
           03  WK-HBTNUM-TBL.
               05  WK-HBTNUM-OCC                    OCCURS   4.
                 06  WK-HBTNUM                      PIC  X(02).
      *
           03  WK-CHECK2010-TBL.
               05  WK-CHECK2010-OCC                 OCCURS 100.
                 06  WK-CHECK2010-HKNCOMBINUM       PIC  X(04).
                 06  WK-CHECK2010-OCC2              OCCURS   4.
                   07  WK-CHECK2010-JYUHENKBN       PIC  X(01).
                   07  WK-CHECK2010-JYUHEN-TAIKBN   PIC  X(01).
                   07  WK-CHECK2010-HBTNUM          PIC  X(02).
                   07  WK-CHECK2010-NG              PIC  X(01).
      *
           03  WK-CHECK2010X-TBL.
               05  WK-CHECK2010X-OCC                OCCURS   4.
                 06  WK-CHECK2010X-JYUHENKBN        PIC  X(01).
                 06  WK-CHECK2010X-JYUHEN-TAIKBN    PIC  X(01).
                 06  WK-CHECK2010X-HBTNUM           PIC  X(02).
                 06  WK-CHECK2010X-NG               PIC  X(01).
                 06  WK-CHECK2010X-TAISYOIDX        PIC  9(01).
      *
           03  WK-CYOKI-HIKAKU1        PIC 9(07).
           03  WK-CYOKI-HIKAKU2        PIC 9(07).
           03  WK-CYOKI-HIKAKU3        PIC 9(07).
           03  WK-CYOKI-HIKAKU1-TAIHI  PIC 9(07).
           03  WK-CYOKI-HIKAKU2-TAIHI  PIC 9(07).
           03  WK-CYOKI-HIKAKU3-TAIHI  PIC 9(07).
           03  WK-CYOKI-KEISAN         PIC 9(07).
           03  WK-CYOKI-KEISAN2        PIC 9(07).
           03  WK-CYOKI-KEISAN3        PIC 9(07).
           03  WK-CYOKI-HKNTEN-TBL.
               05  WK-CYOKI-HKNTEN     PIC 9(07)  OCCURS  31.
           03  WK-CYOKI-NYUKFTNRATE    PIC 9(03).
      *
           03  WK-TANKI-TBL.
               05  WK-TANKI-CYOSYU     PIC 9(07)  OCCURS  31.
               05  WK-TANKI-MICYOSYU   PIC 9(07)  OCCURS  31.
           03  WK-TANKI-DAYJGN         PIC 9(07).
      *
           03  WK-TAIHI-COMPFTN-149    PIC 9(07).
      *
           03  WK-IRYOKEIKBN-HANTEITEN PIC 9(08).
           03  WK-IRYOKEIKBN-MAXTEN    PIC 9(08).
      *
           03  WK-SHOKUJIRYOYOCD-ERR   PIC 9(01).
      *
           03  WK-SKJHKN-TBL.
               05  WK-SKJHKN-SANTEIFLG PIC X(01)  OCCURS  31.
      *
           03  WK-ZAN-SEIHO            PIC 9(08).
      *
      *    £·£°ºÐÌ¤Ëþ¸½ÊªµëÉÕ¤Î¼ýÇ¼¥Ç¡¼¥¿ÂàÈò¡Ê¸øÈñÊ»ÍÑÊ¬¡Ë
           03  WK-SYUNOU-GENBUTU70-TABLE.
               05  WK-SYUNOU-GENBUTU70-OCC              OCCURS  50.
                 06  WK-SYUNOU-GENBUTU70-HKNCOMBINUM    PIC  X(04).
                 06  WK-SYUNOU-GENBUTU70-TOTALTEN       PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70-SYUHKNNUM      PIC  X(03).
                 06  WK-SYUNOU-GENBUTU70-KOH1HKNNUM     PIC  X(03).
                 06  WK-SYUNOU-GENBUTU70-KOH1COMPFTN    PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70-KOH2HKNNUM     PIC  X(03).
                 06  WK-SYUNOU-GENBUTU70-KOH2COMPFTN    PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70-KOH3HKNNUM     PIC  X(03).
                 06  WK-SYUNOU-GENBUTU70-KOH3COMPFTN    PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70-KOH4HKNNUM     PIC  X(03).
                 06  WK-SYUNOU-GENBUTU70-KOH4COMPFTN    PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70-GASSANFLG      PIC  9(01).
                 06  WK-SYUNOU-GENBUTU70-KANGANFLG      PIC  9(01).
                 06  WK-SYUNOU-GENBUTU70-HANTEIFLG      PIC  9(01).
      *    £·£°ºÐÌ¤Ëþ¸½ÊªµëÉÕ¤Î¼ýÇ¼¥Ç¡¼¥¿ÂàÈò¡Ê¼çÊÝ¸±Ã±ÆÈÊ¬¡Ë
           03  WK-SYUNOU-GENBUTU70T-TABLE.
                 06  WK-SYUNOU-GENBUTU70T-TOTALTEN      PIC  9(07).
                 06  WK-SYUNOU-GENBUTU70T-HANTEIFLG     PIC  9(01).
      *
           03  WK-SYUNOU-GENBUTU70-KEISAN               PIC  9(10).
           03  WK-SYUNOU-GENBUTU70-FTNRATE              PIC  9(03).
      *
           03  WK-HANTEI-KOHNUM                         PIC  X(03).
      *
           03  WK-CHIHOU-SANTEIDAY-TBL.
               05  WK-CHIHOU-SANTEIDAY-OCC              OCCURS  31.
                 06  WK-CHIHOU-SANTEIDAY-RUI            PIC  9(01).
                 06  WK-CHIHOU-SANTEIDAY                PIC  9(01).
           03  WK-CHIHOU-SANTEIDAY-CNT                  PIC  9(02).
      *
           03  WK-CYOKI-KEISAN4               PIC  9(07).
           03  WK-CYOKI-FTN-SYU-M             PIC  9(08).
           03  WK-CYOKI-FTN-SYU-M-ENTANI      PIC  9(08)V9(01).
           03  WK-CYOKI-SYUMAXKIN             PIC  9(10).
           03  WK-CYOKI-RESULT                PIC  9(01).
      *
      *    ¸øÈñ¤Î´µ¼ÔÉéÃ´¾å¸Â¶â³Û¤ÎÂàÈòÍÑ¥¨¥ê¥¢
       01  HOKEN-MAX-AREA.
           03  MAX-KAI-KOHI1-M         PIC 9(05).
           03  MAX-KAI-KOHI2-M         PIC 9(05).
           03  MAX-KAI-KOHI3-M         PIC 9(05).
           03  MAX-KAI-KOHI4-M         PIC 9(05).
           03  MAX-KIN-KOHI1-D         PIC 9(08).
           03  MAX-KIN-KOHI2-D         PIC 9(08).
           03  MAX-KIN-KOHI3-D         PIC 9(08).
           03  MAX-KIN-KOHI4-D         PIC 9(08).
           03  MAX-KIN-KOHI1-M         PIC 9(08).
           03  MAX-KIN-KOHI2-M         PIC 9(08).
           03  MAX-KIN-KOHI3-M         PIC 9(08).
           03  MAX-KIN-KOHI4-M         PIC 9(08).
           03  MAX-KIN-KOHI1-M-TOKU75  PIC 9(08).
           03  MAX-KIN-KOHI2-M-TOKU75  PIC 9(08).
           03  MAX-KIN-KOHI3-M-TOKU75  PIC 9(08).
           03  MAX-KIN-KOHI4-M-TOKU75  PIC 9(08).
      *
      *    ¸øÈñ¤Î»ÈÍÑ²ó¿ô¥«¥¦¥ó¥ÈÍÑ¥¨¥ê¥¢¡ÊÆüÃ±°Ì¡Ë
       01  HOKEN-KAISU-TABLE.
           03  HOKEN-KAISU-TABLE-XXX.
             04 HOKEN-KAISU-TBL        OCCURS  32.
               05  KOHI1-TBL           PIC 9(02).
               05  KOHI2-TBL           PIC 9(02).
               05  KOHI3-TBL           PIC 9(02).
               05  KOHI4-TBL           PIC 9(02).
           03  HOKEN-KAISU-TBL-R   REDEFINES   HOKEN-KAISU-TABLE-XXX
                                       OCCURS  32.
               05  KOHI-TBL            PIC 9(02)   OCCURS   4.
      *
      *    ¸øÈñ¤Î»ÈÍÑ²ó¿ô¥«¥¦¥ó¥ÈÍÑ¥¨¥ê¥¢£²¡ÊÆüÃ±°Ì¡Ë
       01  HOKEN-KAISU-TABLE2.
           03  HOKEN-KAISU-TABLE2-XXX.
             04 HOKEN-KAISU-TBL2       OCCURS  32.
               05  KOHI1-TBL2          PIC 9(02).
               05  KOHI2-TBL2          PIC 9(02).
               05  KOHI3-TBL2          PIC 9(02).
               05  KOHI4-TBL2          PIC 9(02).
           03  HOKEN-KAISU-TBL2-R  REDEFINES   HOKEN-KAISU-TABLE2-XXX
                                       OCCURS  32.
               05  KOHI-TBL2           PIC 9(02)   OCCURS   4.
      *
      *    ¸øÈñ¤Î´µ¼ÔÉéÃ´ºÑ¤ß¶â³Û¤Î²Ã»»ÍÑ¥¨¥ê¥¢
       01  HOKEN-FUTAN-AREA.
           03  FTN-KOHI1-D             PIC 9(05)   OCCURS  31.
           03  FTN-KOHI2-D             PIC 9(05)   OCCURS  31.
           03  FTN-KOHI3-D             PIC 9(05)   OCCURS  31.
           03  FTN-KOHI4-D             PIC 9(05)   OCCURS  31.
           03  FTN-KOHI1-M             PIC 9(08).
           03  FTN-KOHI2-M             PIC 9(08).
           03  FTN-KOHI3-M             PIC 9(08).
           03  FTN-KOHI4-M             PIC 9(08).
           03  FTN-KOHI1-M-JI          PIC 9(08).
           03  FTN-KOHI2-M-JI          PIC 9(08).
           03  FTN-KOHI3-M-JI          PIC 9(08).
           03  FTN-KOHI4-M-JI          PIC 9(08).
           03  FTN-CYOKI-M-JI          PIC 9(08).
           03  FTN-CYOKI-M-JI-TOKU75   PIC 9(08).
           03  FTN-KOHI1-M-JI-TOKU75   PIC 9(08).
           03  FTN-KOHI1-M-TOKU75      PIC 9(08).
           03  FTN-KOHI2-M-TOKU75      PIC 9(08).
           03  FTN-KOHI3-M-TOKU75      PIC 9(08).
           03  FTN-KOHI4-M-TOKU75      PIC 9(08).
      *
      *    ¸øÈñ¤Î¥ì¥»¥×¥ÈÉéÃ´¶èÊ¬»Í¼Î¸ÞÆþ¤·¤Ê¤¤¾ì¹ç,
      *    ¥ì¥»µ­ºÜ¶â³Û¤Î²Ã»»ÍÑ¥¨¥ê¥¢
       01  HOKEN-FUTAN-AREA2.                                           
           03  FTN-KOHI1-D2            PIC 9(05)   OCCURS  31.
           03  FTN-KOHI2-D2            PIC 9(05)   OCCURS  31.
           03  FTN-KOHI3-D2            PIC 9(05)   OCCURS  31.
           03  FTN-KOHI4-D2            PIC 9(05)   OCCURS  31.
           03  FTN-KOHI1-M2            PIC 9(08).                       
           03  FTN-KOHI2-M2            PIC 9(08).                       
           03  FTN-KOHI3-M2            PIC 9(08).                       
           03  FTN-KOHI4-M2            PIC 9(08).                       
           03  FTN-KOHI1-M2-JI         PIC 9(08).                       
           03  FTN-KOHI2-M2-JI         PIC 9(08).                       
           03  FTN-KOHI3-M2-JI         PIC 9(08).                       
           03  FTN-KOHI4-M2-JI         PIC 9(08).   
           03  FTN-CYOKI-M2-JI         PIC 9(08).
           03  FTN-CYOKI-M2-JI-TOKU75  PIC 9(08).
           03  FTN-KOHI1-M2-JI-TOKU75  PIC 9(08).
           03  FTN-KOHI1-M2-TOKU75     PIC 9(08).
           03  FTN-KOHI2-M2-TOKU75     PIC 9(08).
           03  FTN-KOHI3-M2-TOKU75     PIC 9(08).
           03  FTN-KOHI4-M2-TOKU75     PIC 9(08).
      *
      *    ¸øÈñ¤ÎÉéÃ´¶â³Û±ßÃ±°ÌÍÑ                                       
       01  HOKEN-FUTAN-AREA3.
           03  FTN-KOHI1-D3            PIC 9(05)V9(01)   OCCURS  31.
           03  FTN-KOHI2-D3            PIC 9(05)V9(01)   OCCURS  31.
           03  FTN-KOHI3-D3            PIC 9(05)V9(01)   OCCURS  31.
           03  FTN-KOHI4-D3            PIC 9(05)V9(01)   OCCURS  31.
           03  FTN-KOHI1-M3            PIC 9(08)V9(01).
           03  FTN-KOHI2-M3            PIC 9(08)V9(01).
           03  FTN-KOHI3-M3            PIC 9(08)V9(01).
           03  FTN-KOHI4-M3            PIC 9(08)V9(01).
           03  FTN-KOHI1-M3-JI         PIC 9(08)V9(01).
           03  FTN-KOHI2-M3-JI         PIC 9(08)V9(01).
      *****03  FTN-KOHI3-M3-JI         PIC 9(08)V9(01).
      *****03  FTN-KOHI4-M3-JI         PIC 9(08)V9(01).
           03  FTN-CYOKI-M3-JI         PIC 9(08)V9(01).
           03  FTN-CYOKI-M3-JI-TOKU75  PIC 9(08)V9(01).
           03  FTN-KOHI1-M3-JI-TOKU75  PIC 9(08)V9(01).
           03  FTN-KOHI1-M3-TOKU75     PIC 9(08)V9(01).
           03  FTN-KOHI2-M3-TOKU75     PIC 9(08)V9(01).
           03  FTN-KOHI3-M3-TOKU75     PIC 9(08)V9(01).
           03  FTN-KOHI4-M3-TOKU75     PIC 9(08)V9(01).
      *
      *    ¸øÈñ¤Î¿©»öÉéÃ´¶â³Û¡Ê£°£²£´¡¦£°£·£¹¡Ë
       01  HOKEN-SKJFUTAN-AREA.
           03  FTN-KOHI1-SKJ           PIC 9(08).
           03  FTN-KOHI2-SKJ           PIC 9(08).
           03  FTN-KOHI3-SKJ           PIC 9(08).
           03  FTN-KOHI4-SKJ           PIC 9(08).
      *
      *    ¸øÈñ¤Î´µ¼ÔÉéÃ´²ÄÇ½¤Ê»Ä³Û»»ÄêÍÑ¥¨¥ê¥¢
       01  HOKEN-ZAN-AREA.
           03  ZAN-KOHI1-M             PIC 9(08).
           03  ZAN-KOHI2-M             PIC 9(08).
           03  ZAN-KOHI3-M             PIC 9(08).
           03  ZAN-KOHI4-M             PIC 9(08).
           03  ZAN-KOHI1-M-TOKU75      PIC 9(08).
           03  ZAN-KOHI2-M-TOKU75      PIC 9(08).
           03  ZAN-KOHI3-M-TOKU75      PIC 9(08).
           03  ZAN-KOHI4-M-TOKU75      PIC 9(08).
           03  ZAN-KOHI-AREA.
             05  ZAN-KOHI1             PIC 9(08).
             05  ZAN-KOHI2             PIC 9(08).
             05  ZAN-KOHI3             PIC 9(08).
             05  ZAN-KOHI4             PIC 9(08).
           03  ZAN-KOHI-TBL  REDEFINES  ZAN-KOHI-AREA
                                        OCCURS  4.
             05  ZAN-KOHI-T            PIC 9(08).
      *
      *    ¸øÈñ¤Î´µ¼ÔÉéÃ´²ÄÇ½¤Ê»Ä³Û»»ÄêÍÑ¥¨¥ê¥¢¡ÊÆüÃ±°Ì¡Ë
       01  HOKEN-ZAN-D-AREA.
           03  HOKEN-ZAN-D-TABLE1.
             04  HOKEN-ZAN-D-TBL       OCCURS  31.
               05  ZAN-KOHI1-D         PIC 9(05).
               05  ZAN-KOHI2-D         PIC 9(05).
               05  ZAN-KOHI3-D         PIC 9(05).
               05  ZAN-KOHI4-D         PIC 9(05).
           03  HOKEN-ZAN-D-TBL-R   REDEFINES   HOKEN-ZAN-D-TABLE1
                                       OCCURS  31.
               05  ZAN-KOHI-D          PIC 9(05)   OCCURS   4.
      *
      *    ¸øÈñ¤Î¥ì¥»¥×¥ÈÉéÃ´¶èÊ¬»Í¼Î¸ÞÆþ¤·¤Ê¤¤¾ì¹ç,
      *    ¥ì¥»µ­ºÜ²ÄÇ½¤Ê»Ä³Û»»ÄêÍÑ¥¨¥ê¥¢
       01  HOKEN-ZAN-AREA2.                                             
           03  ZAN-KOHI1-M2            PIC 9(08).                       
           03  ZAN-KOHI2-M2            PIC 9(08).                       
           03  ZAN-KOHI3-M2            PIC 9(08).                       
           03  ZAN-KOHI4-M2            PIC 9(08).                       
           03  ZAN-KOHI1-M2-TOKU75     PIC 9(08).
           03  ZAN-KOHI2-M2-TOKU75     PIC 9(08).
           03  ZAN-KOHI3-M2-TOKU75     PIC 9(08).
           03  ZAN-KOHI4-M2-TOKU75     PIC 9(08).
           03  ZAN-KOHI-AREA2.                                          
             05  ZAN-KOHI12            PIC 9(08).                       
             05  ZAN-KOHI22            PIC 9(08).                       
             05  ZAN-KOHI32            PIC 9(08).                       
             05  ZAN-KOHI42            PIC 9(08).                       
           03  ZAN-KOHI-TBL2 REDEFINES  ZAN-KOHI-AREA2                  
                                        OCCURS  4.                      
             05  ZAN-KOHI-T2           PIC 9(08).                       
      *
      *    ¸øÈñ¤Î¥ì¥»¥×¥ÈÉéÃ´¶èÊ¬»Í¼Î¸ÞÆþ¤·¤Ê¤¤¾ì¹ç,
      *    ¥ì¥»µ­ºÜ²ÄÇ½¤Ê»Ä³Û»»ÄêÍÑ¥¨¥ê¥¢¡ÊÆüÃ±°Ì¡Ë
       01  HOKEN-ZAN-D2-AREA.
           03  HOKEN-ZAN-D2-TABLE1.
             04  HOKEN-ZAN-D2-TBL       OCCURS  31.
               05  ZAN-KOHI1-D2         PIC 9(05).
               05  ZAN-KOHI2-D2         PIC 9(05).
               05  ZAN-KOHI3-D2         PIC 9(05).
               05  ZAN-KOHI4-D2         PIC 9(05).
           03  HOKEN-ZAN-D2-TBL-R   REDEFINES   HOKEN-ZAN-D2-TABLE1
                                        OCCURS  31.
               05  ZAN-KOHI-D2          PIC 9(05)   OCCURS   4.
      *
      *    ¸øÈñ¤ÎÉéÃ´¶â³Û±ßÃ±°ÌÍÑ                                       
       01  HOKEN-ZAN-AREA3.
           03  ZAN-KOHI1-M3            PIC 9(08)V9(01).
           03  ZAN-KOHI2-M3            PIC 9(08)V9(01).
           03  ZAN-KOHI3-M3            PIC 9(08)V9(01).
           03  ZAN-KOHI4-M3            PIC 9(08)V9(01).
           03  ZAN-KOHI1-M3-TOKU75     PIC 9(08)V9(01).
           03  ZAN-KOHI2-M3-TOKU75     PIC 9(08)V9(01).
           03  ZAN-KOHI3-M3-TOKU75     PIC 9(08)V9(01).
           03  ZAN-KOHI4-M3-TOKU75     PIC 9(08)V9(01).
           03  ZAN-KOHI-AREA3.
             05  ZAN-KOHI13            PIC 9(08)V9(01).
             05  ZAN-KOHI23            PIC 9(08)V9(01).
             05  ZAN-KOHI33            PIC 9(08)V9(01).
             05  ZAN-KOHI43            PIC 9(08)V9(01).
           03  ZAN-KOHI-TBL3 REDEFINES  ZAN-KOHI-AREA3
                                        OCCURS  4.
             05  ZAN-KOHI-T3           PIC 9(08)V9(01).
      *
      *    ¸øÈñ¤ÎÉéÃ´¶â³Û±ßÃ±°ÌÍÑ                                       
      *    ¡ÊÆüÃ±°Ì¡Ë
       01  HOKEN-ZAN-D3-AREA.
           03  HOKEN-ZAN-D3-TABLE1.
             04  HOKEN-ZAN-D3-TBL       OCCURS  31.
               05  ZAN-KOHI1-D3         PIC 9(05)V9(01).
               05  ZAN-KOHI2-D3         PIC 9(05)V9(01).
               05  ZAN-KOHI3-D3         PIC 9(05)V9(01).
               05  ZAN-KOHI4-D3         PIC 9(05)V9(01).
           03  HOKEN-ZAN-D3-TBL-R   REDEFINES   HOKEN-ZAN-D3-TABLE1
                                        OCCURS  31.
               05  ZAN-KOHI-D3          PIC 9(05)V9(01)   OCCURS   4.
      *
      *    ¸øÈñ¤Î¿©»öÉéÃ´»Ä¶â³Û¡Ê£°£²£´¡¦£°£·£¹¡Ë
       01  HOKEN-SKJZAN-AREA.
           03  ZAN-SKJ-AREA.
             05  ZAN-KOHI1-SKJ           PIC 9(08).
             05  ZAN-KOHI2-SKJ           PIC 9(08).
             05  ZAN-KOHI3-SKJ           PIC 9(08).
             05  ZAN-KOHI4-SKJ           PIC 9(08).
           03  ZAN-SKJ-TBL  REDEFINES  ZAN-SKJ-AREA
                                         OCCURS  4.
             05  ZAN-KOHI-SKJ            PIC 9(08).
      *
      *    ¸øÈñ¤Î¥ì¥»¥×¥ÈÉéÃ´¶èÊ¬»Í¼Î¸ÞÆþ¤·¤Ê¤¤¾ì¹ç,
      *    ¥ì¥»µ­ºÜ¶â³ÛÂàÈòÍÑ¥¨¥ê¥¢
       01  WK-KOH-COMPFTN-AREA.                                         
           03  WK-KOH-COMPFTN          PIC 9(07)                        
                                        OCCURS  4.                      
      *
      *    ÆüÃ±°Ì¤Î¿©»öÉéÃ´¶â³ÛÂàÈòÍÑ¥¨¥ê¥¢
       01  WK-DAY-SKJFTN-AREA.
           03  WK-DAY-SKJFTN-OCC        OCCURS  31.
               05  WK-DAY-SKJFTN        PIC 9(05).
               05  WK-DAY-SKJFTNS       PIC 9(05).
               05  WK-DAY-SKJFTNL       PIC 9(05).
               05  WK-DAY-SKJFTNL2      PIC 9(05).
               05  WK-DAY-KAISU         PIC 9(04).
               05  WK-DAY-KAISUS        PIC 9(04).
               05  WK-DAY-KAISUL        PIC 9(04).
      *
      *    ¸øÈñ¤ÎÆüÃ±°Ì»»Äê¥Õ¥é¥°
       01  WK-DAYINFFLG-AREA.
           03  WK-DAYINFFLG            PIC 9(01)
                                        OCCURS  4.
      *
      *    ¸øÈñ¤Î¥ì¥»¥×¥ÈÉéÃ´¶èÊ¬»Í¼Î¸ÞÆþ¤·¤Ê¤¤¾ì¹ç,
      *    ¥ì¥»µ­ºÜ¶â³ÛÂàÈòÍÑ¥¨¥ê¥¢¡ÊÆüÃ±°Ì¡Ë
       01  WK-DAY-KOH-COMPFTN-AREA.
           03  WK-DAY-KOH-COMPFTN      PIC 9(07)
                                        OCCURS  4.
      *
      *    ´µ¼ÔÇ¯Îð»»½ÐÍÑ¥¨¥ê¥¢
       01  WRK-NENREI-AREA.
           03  WRK-NENREI              PIC 9(03).
           03  WRK-YMDS1.
               05  WRK-YYS1            PIC 9(04).
               05  WRK-MMS1            PIC 9(02).
               05  WRK-DDS1            PIC 9(02).
           03  WRK-YMDS2.
               05  WRK-YYS2            PIC 9(04).
               05  WRK-MMS2            PIC 9(02).
               05  WRK-DDS2            PIC 9(02).
      *
      *    ¹âÎð¼Ô¤ÎÉéÃ´¾å¸Â»»Äê¥¨¥ê¥¢
       01  WK-SYUHKN-TAIHI-AREA.
           03  MAX-KIN-SYU-M           PIC 9(08).
           03  FTN-SYU-M               PIC 9(08).
           03  ZAN-SYU-M               PIC 9(08).
           03  FLG-SANTEI-SYU          PIC X(01).
           03  FLG-KOUREI              PIC 9(01).
           03  FLG-IRYOHI              PIC 9(01).
           03  FLG-IRYOHI2             PIC 9(01).
           03  FLG-IRYOHI3             PIC 9(01).
           03  FLG-IRYOHI3X            PIC 9(02).
           03  FLG-IRYOHI4             PIC 9(01).
           03  FLG-IRYOHI5             PIC 9(02).
           03  FLG-IRYOHI70            PIC 9(02).
           03  FLG-IRYOHI70K           PIC 9(02).
           03  FLG-IRYOHIKG            PIC 9(01).
           03  FLG-IRYOHIKG2           PIC 9(01).
           03  FLG-IRYOHI-TOYAMA       PIC 9(02).
           03  FLG-KOUGAKUCYO          PIC 9(01).
           03  FLG-KOUGAKUCYO2         PIC 9(01).
           03  FLG-KOUGAKUCYO3         PIC 9(01).
           03  FLG-KOUGAKUCYO5         PIC 9(01).
           03  FLG-KOUGAKUCYO-JIRITU   PIC 9(01).
           03  FLG-KOUGAKUCYO-TOYAMA   PIC 9(01).
           03  FLG-KOUGAKUCYO-ININ     PIC 9(01).
           03  FLG-KOUGAKUCYO-GEN70    PIC 9(01).
           03  FLG-KOUGAKUCYO-GEN70K   PIC 9(01).
           03  FLG-KOUGAKUCYO-OITA     PIC 9(01).
           03  FLG-FTNGAKEN            PIC 9(01).
           03  WK-SYU-SYUCOMPFTN       PIC 9(08).
           03  WK-IRYOHI-TOYAMA        PIC 9(08).
           03  WK-KOUREI-IRYOHI        PIC 9(08).
           03  WK-KOUREI-IRYOHI2       PIC 9(08).
           03  WK-KOUREI-IRYOHI3       PIC 9(08).
           03  WK-KOUREI-IRYOHI4       PIC 9(08).
           03  WK-KOUREI-IRYOHI70      PIC 9(08).
           03  WK-KOUREI-IRYOHI70K     PIC 9(08).
           03  WK-KOUREI-IRYOHI70X     PIC 9(08).
           03  WK-KOUREI-IRYOHI70-JYOGAI
                                       PIC 9(08).
           03  WK-KOUREI-IRYOHI70-JYOGAI2
                                       PIC 9(08).
           03  WK-KOUREI-IRYOHI-JYOGAI PIC 9(08).
           03  WK-KOUREI-IRYOHI-JYOGAI2
                                       PIC 9(08).
      *
           03  FTN-KOHI1-M-ENTANI      PIC 9(08)V9(01).
           03  ZAN-KOHI1-ENTANI        PIC 9(08)V9(01).
           03  FTN-SYU-M-ENTANI        PIC 9(08)V9(01).
           03  ZAN-SYU-M-ENTANI        PIC 9(08)V9(01).
           03  FLG-SANTEI1-ENTANI      PIC X(01).                       
           03  FLG-SANTEI-SYU-ENTANI   PIC X(01).                       
      *
           03  FLG-ROUJINHOKEN         PIC X(01).
      *
           03  WK-KOUREI-IRYOHI70K-TOKU75
                                       PIC 9(08).
           03  FLG-KOUGAKUCYO-GEN70K-TOKU75
                                       PIC 9(01).
      *
      *    ¿©»öÉéÃ´»»Äê¥¨¥ê¥¢
       01  WK-SHOKUJI-TAIHI-AREA.
           03  WK-SHOKUJIRYOYO-OCC.
               05  WK-SHOKUJIRYOYO     PIC 9(01)  OCCURS 31.
           03  WK-TOKUKANRIKASAN-OCC.
               05  WK-TOKUKANRIKASAN   PIC 9(01)  OCCURS 31.
           03  WK-SHOKUJI-KINGAKU-OCC.
               05  WK-SHOKUJI-KINGAKU      PIC 9(07)  OCCURS  9.
           03  WK-SHOKUJI-HYOJYUNFTN-OCC.
               05  WK-SHOKUJI-HYOJYUNFTN   PIC 9(07)  OCCURS  6.
           03  WK-SHOKUJI-NISSU        PIC 9(02).
           03  WK-SHOKUJI-NISSUS       PIC 9(02).
           03  WK-SHOKUJI-NISSUL       PIC 9(02).
           03  WK-SHOKUJI-RYOYOHI      PIC 9(07).
           03  WK-SHOKUJI-RYOYOHIS     PIC 9(07).
           03  WK-SHOKUJI-RYOYOHIL     PIC 9(07).
           03  WK-SHOKUJI-RYOYOHIL2    PIC 9(07).
           03  WK-SHOKUJI-RYOYOHI95    PIC 9(07).
           03  WK-SHOKUJI-RYOYOHI96    PIC 9(07).
           03  WK-SHOKUJI-RYOYOHI95L   PIC 9(07).
           03  WK-SHOKUJI-RYOYOHI96L   PIC 9(07).
           03  WK-SHOKUJI-RYOYOHI-KOGAI
                                       PIC 9(07).
           03  WK-SHOKUJI-JIHI         PIC 9(07).
           03  WK-SHOKUJI-FTN          PIC 9(07).
           03  WK-SHOKUJI-FTNS         PIC 9(07).
           03  WK-SHOKUJI-FTNL         PIC 9(07).
           03  WK-SHOKUJI-FTNL2        PIC 9(07).
           03  WK-SHOKUJI-FTN95        PIC 9(07).
           03  WK-SHOKUJI-FTN96        PIC 9(07).
           03  WK-SHOKUJI-FTN95L       PIC 9(07).
           03  WK-SHOKUJI-FTN96L       PIC 9(07).
           03  WK-NYUSKJRYYKBN         PIC X(01).
           03  WK-NYUSKJRYYKBN-TOKU-OCC.
               05  WK-NYUSKJRYYKBN-TOKU    PIC X(01)  OCCURS  4.
           03  WK-KNJFTNKIN-SKJ        PIC 9(07).
           03  WK-KNJFTNKIN-SKJ-KEISAN PIC 9(07).
           03  WK-KNJFTNKIN-SKJS       PIC 9(07).
           03  WK-KNJFTNKIN-SKJL       PIC 9(07).
           03  WK-SRYCD                PIC X(09).
      *
           03  WK-SHOKUJI-KAIKEI.
             04  WK-SHOKUJI-KAIKEI-OCC     OCCURS   31.
               05  WK-SHOKUDOKASAN     PIC 9(04).
               05  WK-GAIHAKU          PIC 9(04).
      *
               05  WK-SHOKUJI-NYUINJI  PIC 9(04).
               05  WK-SHOKUJI-TOKUSYO  PIC 9(04).
      *
               05  WK-SHOKUJI-NYUINJI2 PIC 9(04).
      *
               05  WK-ROSAITOKU95      PIC 9(04).
               05  WK-ROSAITOKU96      PIC 9(04).
               05  WK-ROSAITOKU97      PIC 9(04).
      *
               05  WK-SHOKUJI-KANFLG   PIC 9(01).
      *
           03  WK-SHOKUJI-KAIKEI2.
             04  WK-SHOKUJI-KAIKEI2-OCC    OCCURS   31.
               05  WK-SHOKUJI-ASA      PIC 9(04).
               05  WK-SHOKUJI-HIRU     PIC 9(04).
               05  WK-SHOKUJI-YORU     PIC 9(04).
           03  WK-SHOKUJI-KAIKEI2-R  REDEFINES  WK-SHOKUJI-KAIKEI2
                                           OCCURS   31.
               05  WK-SHOKUJI-AHY      PIC 9(04)   OCCURS   3.
      *
           03  WK-NYULIFE-AREA.
             04  WK-NYULIFE-OCC            OCCURS   31.
               05  WK-NYULIFE-KBN           PIC  X(01).
               05  WK-NYULIFE-SKJ-MONEY     PIC  9(07).
               05  WK-NYULIFE-KAN-MONEY     PIC  9(07).
               05  WK-NYULIFE-SKJFTN-MONEY  PIC  9(07).
               05  WK-NYULIFE-KANFTN-MONEY  PIC  9(07).
               05  WK-NYULIFE2-OCC            OCCURS    3.
                 07  WK-NYULIFE2-SKJ-MONEY     PIC  9(07).
                 07  WK-NYULIFE2-SKJFTN-MONEY  PIC  9(07).
      *
           03  WK-SKJKEEP-AREA.
             04  WK-SKJKEEP-OCC            OCCURS   31.
               05  WK-SKJKEEP-KBN           PIC  X(01).
      *
      *ÃÏÊý¸øÈñÍÑ¥Õ¥é¥°
       01  WK-CHIHOU-FLG-TAIHI-AREA.
           03  WK-CHIHOU-FLG-TAIHI-OCC OCCURS  4.
               05  FLG-CHIHOU          PIC X(01).
               05  FLG-CHIHOU2         PIC X(01).
               05  FLG-CHIHOU3         PIC X(01).
      *
      *½þ´ÔÊ§¤¤ÃÏÊý¸øÈñ¥Õ¥é¥°
       01  WK-SYOUKAN-FLG-TAIHI-AREA.
           03  FLG-SYOUKAN             PIC X(01)  OCCURS  4.
      *
      *    ¸º³Û¡¦ÌÈ½ü¡¦»ÙÊ§Í±Í½È½ÄêÍÑ¥Æ¡¼¥Ö¥ë
       01  TBL-GENGAKU-AREA.
           03  FILLER          PIC X(03)   VALUE    "960".
           03  FILLER          PIC X(03)   VALUE    "961".
           03  FILLER          PIC X(03)   VALUE    "962".
           03  FILLER          PIC X(03)   VALUE    "963".
           03  FILLER          PIC X(03)   VALUE    "953".
      *
       01  TBL-GENGAKU-R       REDEFINES   TBL-GENGAKU-AREA.
           03  TBL-GENGAKU     PIC X(03)   OCCURS    5.
      *
       01  TBL-GENGAKU-MAX     PIC 9(02)   VALUE     5.
      *
      *    £·£°ºÐÌ¤Ëþ¸½ÊªµëÉÕÈ½ÄêÍÑ¥Æ¡¼¥Ö¥ë
       01  TBL-GENBUTU70-AREA.
           03  FILLER          PIC X(03)   VALUE    "966".
           03  FILLER          PIC X(03)   VALUE    "967".
      *
       01  TBL-GENBUTU70-R     REDEFINES   TBL-GENBUTU70-AREA.
           03  TBL-GENBUTU70   PIC X(03)   OCCURS    2.
      *
       01  TBL-GENBUTU70-MAX   PIC 9(02)   VALUE     2.
      *
      *    ÆÃÊÌ¿©²Ã»»ÍÑ¥Æ¡¼¥Ö¥ë
       01  TBL-TOKUSYOKU-AREA.
      *    ¿©»öÎÅÍÜÉ¸½àÉéÃ´³Û¡ÊÂ¾Ë¡ÅùÆþ±¡Ãæ¡Ë
           03  FILLER          PIC X(09)   VALUE    "197001210".
      *    ÆÃÊÌ¿©²Ã»»¡Ê¿©»öÎÅÍÜ¡Ë
           03  FILLER          PIC X(09)   VALUE    "197000470".
      *    ÆÃÊÌ¿©²Ã»»¡ÊÀ¸³èÎÅÍÜ¡Ë
           03  FILLER          PIC X(09)   VALUE    "197001570".
      *
       01  TBL-TOKUSYOKU-R     REDEFINES   TBL-TOKUSYOKU-AREA.
           03  TBL-TOKUSYOKU   PIC X(09)   OCCURS    3.
      *
       01  TBL-TOKUSYOKU-MAX   PIC 9(02)   VALUE     3.
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ¼ýÇ¼¥Þ¥¹¥¿¡¼
       01  SYU-SYUNOU-REC.
           COPY    "CPSYUNOU.INC".
      *
      *    ÆüÊÌ¼ýÇ¼¥Þ¥¹¥¿
       01  SYU-SYUDAY-REC.
           COPY    "CPSYUDAY.INC".
      *
      *    ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *    ¥ï¡¼¥¯ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»
       01  WRK-HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC"
                               REPLACING  //COMB-// BY //WRK-COMB-//.
      *
      *    ÊÝ¸±ÈÖ¹æ
       01  HKNNUM-REC.
           COPY    "CPHKNNUM.INC".
      *    ¥ï¡¼¥¯ÊÝ¸±ÈÖ¹æ
       01  WRK-HKNNUM-REC.
           COPY    "CPHKNNUM.INC"
                               REPLACING  //HKN-// BY //WRK-HKN-//.
      *
      *    Æþ±¡²ñ·×
       01  NYUINACCT-REC.
           COPY    "CPNYUINACCT.INC".
      *
      *    ¿ÇÎÅ²ñ·×
       01  SRYACCT-REC.
           COPY    "CPSRYACCT.INC".
      *
      *    ¿ÇÎÅ¹Ô°Ù
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý
           COPY    "CPSK1001.INC".
           COPY    "CPSK1026.INC".
           COPY    "CPSK1027.INC".
           COPY    "CPSK1037.INC".
           COPY    "CPSK2010.INC".
           COPY    "CPSK2012.INC".
           COPY    "CPSK4001.INC".
           COPY    "CPSK4003.INC".
           COPY    "CPSK5000.INC".
      *
      *    ´µ¼Ô¾ðÊó
       01  PTINF-REC.
           COPY    "CPPTINF.INC".
      *
      *    ÅÀ¿ô
           COPY    "CPTENSU.INC".
      *
      *    ´µ¼Ô¸øÈñ¾ðÊó
       01  PTKOHINF-REC.
           COPY    "CPPTKOHINF.INC".
      *
      *    ´µ¼ÔÊÝ¸±¾ðÊó
       01  PTHKNINF-REC.
           COPY    "CPPTHKNINF.INC".
      *
      *    ´µ¼ÔÆþ±¡ÍúÎò
       01  PTNYUINRRK-REC.
           COPY    "CPPTNYUINRRK.INC".
      *
      *    Ï«ºÒ´µ¼ÔÊÝ¸±¾ðÊó
       01  PTRSIINF-REC.
           COPY    "CPPTRSIINF.INC".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *    ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
           COPY    "CPORCSGDAY.INC".
      *    ÊÝ¸±»»ÄêÍÑÇ¯Îð¡¦³ä¹ç·×»»¥µ¥Ö
           COPY    "CPORCSAGECHK.INC".
      *    ¸øÈñ·î¾å¸Â³Û¼èÆÀ¥µ¥Ö
           COPY    "CPORCSJGNGET.INC".
      *    ¸øÈñÉÕ²Ã¾ðÊó¼èÆÀ¥µ¥Ö
           COPY    "CPORCSKOHPLUS.INC".
      *    Æþ±¡»þÀ¸³èÎÅÍÜÈñÉéÃ´³Û¼èÆÀ¥µ¥Ö
           COPY    "CPORCSNYULIFE.INC".
      *    ´µ¼Ô½êÆÀ¾ðÊóÊÔ½¸¥µ¥Ö
           COPY    "CPORCSSYOTOKU.INC".
      *    ÆÃÄê¼À´µÅù»»ÄêÈ½Äê¥µ¥Ö
           COPY    "CPORCSSRHKOH.INC".
      *    Æþ±¡»þÀ¸³èÎÅÍÜÈñÉéÃ´³Û¼èÆÀ¥µ¥Ö£²
           COPY    "CPORCSNYULIFE2.INC".
      *    ¿©»öÉéÃ´¿ø¤¨ÃÖ¤­ÂÐ¾Ý¼èÆÀ¥µ¥Ö
           COPY    "CPORCSSKJKEEP.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPDATA.INC".
      ***  COPY    "CPORCMCP.INC".
      *
      /
      ***
       LINKAGE             SECTION.
           COPY  "MCPAREA". 
       01  LNK-ORCS02-REC.
           COPY  "CPORCS02.INC".
       01  LNK-SYUNOU-REC.
           COPY  "CPSYUNOU.INC"    REPLACING  //SYU-// BY //LNK-SYU-//.
       01  LNK2-SYUNOU-REC-T.
         02 LNK2-SYUNOU-REC     OCCURS 10.
           COPY  "CPSYUNOU.INC"    REPLACING  //SYU-// BY //LNK2-SYU-//.
       01  LNK-SYUDAY-REC.
           COPY  "CPSYUDAY.INC"
                             REPLACING  //SDAY-// BY //LNK-SDAY-//.
       01  LNK-WRK-SYUDAY-REC-T.
         02 LNK-WRK-SYUDAY-REC     OCCURS 10.
           COPY  "CPSYUDAY.INC"
                             REPLACING  //SDAY-// BY //LNK-WRK-SDAY-//.
      *
           COPY  "COMMON-SPA".
      /
       PROCEDURE           DIVISION  USING
                                     MCPAREA
                                     LNK-ORCS02-REC
                                     LNK-SYUNOU-REC
                                     LNK2-SYUNOU-REC-T
                                     LNK-SYUDAY-REC
                                     LNK-WRK-SYUDAY-REC-T
                                     SPA-AREA.
      *
      ******************************************************************
      *        °ÍÍêÀ©¸æ½èÍý
      ******************************************************************
       MAIN-RTN            SECTION.
       MAIN-000.
      **   MOVE    ZERO            TO  LNK-S02-RC.
           MOVE    SPACE           TO  WRK-AREA.
           INITIALIZE                  WRK-AREA.
           MOVE    ZERO            TO  LNK-SYU-RJN-FTN
                                       LNK-SYU-KOH-FTN
                                       LNK-SYU-KOH-FTN-ENTANI
                                       LNK-SYU-YKZ-FTN
                                       LNK-SYU-HKNTEKMONEY.
           MOVE    ZERO            TO  LNK-SYU-SYUHKNFTNMONEY
                                       LNK-SYU-SYUCOMPFTN
                                       LNK-SYU-SYUCOMPFTN-ENTANI
                                       LNK-SYU-SYUCOMPYKZFTN
                                       LNK-SYU-SYUCOMPTOTAL.
           MOVE    SPACE           TO  LNK-SYU-SYUYKZFTNKBN.
           PERFORM   VARYING   IDX   FROM   1    BY   1
             UNTIL   IDX   >   4
                  MOVE    ZERO     TO  LNK-SYU-KOH-HKNFTNMONEY(IDX)
                                       LNK-SYU-KOH-COMPFTN(IDX)
                                       LNK-SYU-KOH-COMPFTN-ENTANI(IDX)
                                       LNK-SYU-KOH-COMPYKZFTN(IDX)
                                       LNK-SYU-KOH-COMPTOTAL(IDX)
                  MOVE    SPACE    TO  LNK-SYU-KOH-YKZFTNKBN(IDX)
           END-PERFORM.
           MOVE    ZERO            TO  LNK-SYU-RESE-YKZ-FTN.
      *
           PERFORM   VARYING   IDX   FROM   1    BY   1
             UNTIL   IDX   >   14
                  MOVE    ZERO     TO  LNK-SYU-SHOKUJI(IDX)
                                       LNK-SYU-SHOKUJI-NISSU(IDX)
           END-PERFORM.              
           MOVE           ZERO     TO  LNK-SYU-SYUSKJ-NISSU
                                       LNK-SYU-SYUSKJ-RYOYOHI
                                       LNK-SYU-SYUSKJ-FTN
                                       LNK-SYU-SYUSKJ-FTN-RECE.
           MOVE           SPACE    TO  LNK-SYU-SYUSKJ-FTNKBN.
           PERFORM   VARYING   IDX   FROM   1    BY   1
             UNTIL   IDX   >   4
                  MOVE    ZERO     TO  LNK-SYU-SKJ-NISSU(IDX)
                                       LNK-SYU-SKJ-RYOYOHI(IDX)
                                       LNK-SYU-SKJ-FTN(IDX)
                                       LNK-SYU-SKJ-FTN-RECE(IDX)
                  MOVE    SPACE    TO  LNK-SYU-SKJ-FTNKBN(IDX)
           END-PERFORM.
           MOVE           ZERO     TO  LNK-SYU-RYOYOHI-SKJ.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-SKJ.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-SKJ-TAX.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-SKJ-KEI.
           MOVE           ZERO     TO  LNK-SYU-RYOYOHI-SKJ-JIHI.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-SKJ-JIHI.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-SKJ-JIHI-TAX.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-SKJ-JIHI-KEI.
      *
           MOVE           ZERO     TO  LNK-SYU-RYOYOHI-LIFE.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-LIFE.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-LIFE-TAX.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-LIFE-KEI.
           MOVE           ZERO     TO  LNK-SYU-RYOYOHI-LIFE-JIHI.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-LIFE-JIHI.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-LIFE-JIHI-TAX.
           MOVE           ZERO     TO  LNK-SYU-SKYMONEY-LIFE-JIHI-KEI.
      *
           MOVE    ZERO            TO  LNK-SYU-TGMONEY-TAX-SAI
                                       LNK-SYU-RSI-TAX-SAI
                                       LNK-SYU-RSI-TOTAL
                                       LNK-SYU-RSIJIBAI-SKYMONEY
                                       LNK-SYU-SKYMONEY-TAX-SAI
                                       LNK-SYU-RMSAGAKU-TAX-SAI.
           PERFORM   VARYING   IDX   FROM   1    BY   1
             UNTIL   IDX   >   3
                  MOVE    ZERO     TO  LNK-SYU-SKJ-FTNGAKU(IDX)
                                       LNK-SYU-SKJ-FTNDAY(IDX)
           END-PERFORM.
           MOVE    SPACE           TO  LNK-SYU-DAYINFFLG.
           MOVE    SPACE           TO  LNK-SYU-DISCOUNT-KBN
                                       LNK-SYU-DISCOUNT-BODY
                                       LNK-SYU-DISCOUNT-RATEKBN
                                       LNK-SYU-DISCOUNT-TEIRITU.
           MOVE    ZERO            TO  LNK-SYU-DISCOUNT-RATE.
           MOVE    ZERO            TO  LNK-SYU-DISCOUNT-MONEY.
           MOVE    ZERO            TO  LNK-SYU-JYO-HKNFTNMONEY.
           MOVE    ZERO            TO  LNK-SYU-JYO-COMPFTN.
           MOVE    ZERO            TO  LNK-SYU-JYO-COMPFTN-ENTANI.
           MOVE    ZERO            TO  LNK-SYU-TAX-TAISHOU.
           MOVE    ZERO            TO  LNK-SYU-NYNSHOKAISU.
           MOVE    SPACE           TO  LNK-SYU-KOHTAIYKZKBN.
           MOVE    ZERO            TO  LNK-SYU-YKZKENNUM.
           MOVE    ZERO            TO  LNK-SYU-SECMONEY.
           MOVE    SPACE           TO  LNK-SYU-SAIKEISANKBN.
           MOVE    SPACE           TO  LNK-SYU-HKNTEKKBN.
      *
           MOVE    ZERO            TO  FLG-SEISINJYO
                                       FLG-TOKUREI-HKNJYA.
      *
           MOVE    ZERO            TO  WK-CYOKI-RESULT.
      *
           INITIALIZE                  WK-HBTNUM-TBL.
           INITIALIZE                  WK-CHECK2010-TBL.
      *
      *    ÀÁµá¶â³ÛÃ¼¿ô¶èÊ¬¡¢¾ÃÈñÀÇÃ¼¿ô¶èÊ¬¤Î¼è¤ê¹þ¤ß
           INITIALIZE                         SYS-1001-REC.
           MOVE    "1001"               TO    SYS-1001-KANRICD.
           MOVE    "*"                  TO    SYS-1001-KBNCD.
           MOVE    LNK-SYU-HOSPNUM      TO    SYS-1001-HOSPNUM.
           MOVE    LNK-SYU-SRYYMD       TO    SYS-1001-STYUKYMD.
           MOVE    LNK-SYU-SRYYMD       TO    SYS-1001-EDYUKYMD.
           MOVE    SYS-1001-REC         TO    MCPDATA-REC.
           MOVE    "DBSELECT"           TO    MCP-FUNC.
           MOVE    "tbl_syskanri"       TO    MCP-TABLE.
           MOVE    "key10"              TO    MCP-PATHNAME.
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA.
           IF      MCP-RC               =     ZERO
               MOVE     "tbl_syskanri"  TO    MCP-TABLE
               MOVE     "key10"         TO    MCP-PATHNAME
               PERFORM   SYSKANRI-READ-SEC
               MOVE      SYS-1001-DISCOUNT-HASU-KBN  
                                        TO    WK-HASU1001-KBN
               IF   WK-HASU1001-KBN  =  SPACE
                  MOVE   "1"            TO    WK-HASU1001-KBN
               END-IF
               MOVE      SYS-1001-DISCOUNT-HASU-KBN2 
                                        TO    WK-HASU1001-KBN2
               IF   WK-HASU1001-KBN2 =  SPACE
                  MOVE   "4"            TO    WK-HASU1001-KBN2
               END-IF
               MOVE      SYS-1001-DISCOUNT-HASU-KBN2J
                                        TO    WK-HASU1001-KBN2J
               IF   WK-HASU1001-KBN2J = SPACE
                  MOVE   "0"            TO    WK-HASU1001-KBN2J
               END-IF
      *
               MOVE      SYS-1001-DISCOUNT-HASU-KBN3
                                        TO    WK-HASU1001-KBN3
               IF   WK-HASU1001-KBN3 =  SPACE
                  MOVE   "4"            TO    WK-HASU1001-KBN3
               END-IF
               MOVE      SYS-1001-DISCOUNT-HASU-KBN3J
                                        TO    WK-HASU1001-KBN3J
               IF   WK-HASU1001-KBN3J = SPACE
                  MOVE   "0"            TO    WK-HASU1001-KBN3J
               END-IF
      *
               MOVE      SYS-1001-DISCOUNT-HASU-KBN4
                                        TO    WK-HASU1001-KBN4
               IF   WK-HASU1001-KBN4 =  SPACE
                  MOVE   "4"            TO    WK-HASU1001-KBN4
               END-IF
               MOVE      SYS-1001-DISCOUNT-HASU-KBN4J
                                        TO    WK-HASU1001-KBN4J
               IF   WK-HASU1001-KBN4J = SPACE
                  MOVE   "0"            TO    WK-HASU1001-KBN4J
               END-IF
      *
               MOVE      SYS-1001-DISCOUNT-HASU-KBN5J
                                        TO    WK-HASU1001-KBN5J
               IF   WK-HASU1001-KBN5J = SPACE
                  MOVE   "4"            TO    WK-HASU1001-KBN5J
               END-IF
      *
               MOVE      SYS-1001-DISCOUNT-HASU-KBN6
                                        TO    WK-HASU1001-KBN6
               IF   WK-HASU1001-KBN6 =  SPACE
                  MOVE   WK-HASU1001-KBN4
                                        TO    WK-HASU1001-KBN6
               END-IF
               MOVE      SYS-1001-DISCOUNT-HASU-KBN6J
                                        TO    WK-HASU1001-KBN6J
               IF   WK-HASU1001-KBN6J = SPACE
                  MOVE   WK-HASU1001-KBN4J
                                        TO    WK-HASU1001-KBN6J
               END-IF
      *
               MOVE      SYS-1001-TAX-HASU-KBN       
                                        TO    WK-TAX1001-KBN
               IF   WK-TAX1001-KBN = SPACE
                  MOVE   "2"            TO    WK-TAX1001-KBN
               END-IF
               MOVE      SYS-1001-PREFNUM
                                        TO    WK-1001-PREFNUM
               MOVE      SYS-1001-JIHIPOSITION
                                        TO    WK-1001-JIHIPOSITION
               MOVE      SYS-1001-CHIHOUNUMKBN
                                        TO    WK-1001-CHIHOUNUMKBN
               MOVE      SYS-1001-GENTAIKBN
                                        TO    WK-1001-GENTAIKBN
               MOVE      SYS-1001-DAISANKBN
                                        TO    WK-1001-DAISANKBN
               IF   WK-1001-DAISANKBN = SPACE
                  MOVE   "2"            TO    WK-1001-DAISANKBN
               END-IF
           END-IF.
      *
           MOVE     "tbl_syskanri"      TO    MCP-TABLE.
           MOVE     "key10"             TO    MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¡Ê£´£°£°£±¡Ë¤«¤éÅÀ¿ôÃ±²ÁÅù¤Î¼èÆÀ
           MOVE     ZERO      TO    WK-4001-KSNRATE.
           MOVE     ZERO      TO    WK-4001-KSNRATE1.
           MOVE     SPACE     TO    WK-4001-TAXKBN.
           MOVE     SPACE     TO    WK-4001-TENKBN.
           MOVE     SPACE     TO    WK-4001-SKJKBN.
           MOVE     SPACE     TO    WK-4001-TAXKBN-KZI.
           MOVE     ZERO      TO    WK-4001-SYUTENTANKA.
           MOVE     ZERO      TO    WK-4001-YKZTENTANKA.
           MOVE     ZERO      TO    WK-4001-KOMUTENTANKA.
           MOVE     SPACE     TO    WK-4001-KOMURSITANKAKBN.
           MOVE     SPACE     TO    WK-4001-KOMURSITANKA-G.
           IF   LNK-SYU-SYUHKNNUM         =    "971" OR "973"
               INITIALIZE                         SYS-4001-REC
               MOVE    "4001"               TO    SYS-4001-KANRICD
               MOVE    "*"                  TO    SYS-4001-KBNCD
               MOVE    LNK-SYU-HOSPNUM      TO    SYS-4001-HOSPNUM
               MOVE    LNK-SYU-SRYYMD       TO    SYS-4001-STYUKYMD
               MOVE    LNK-SYU-SRYYMD       TO    SYS-4001-EDYUKYMD
               MOVE    SYS-4001-REC         TO    MCPDATA-REC
               MOVE    "DBSELECT"           TO    MCP-FUNC
               MOVE    "tbl_syskanri"       TO    MCP-TABLE
               MOVE    "key10"              TO    MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =     ZERO
                   MOVE     "tbl_syskanri"  TO    MCP-TABLE
                   MOVE     "key10"         TO    MCP-PATHNAME
                   PERFORM   SYSKANRI-READ-SEC
                   MOVE   SYS-4001-KSNRATE  TO    WK-4001-KSNRATE
                   MOVE   SYS-4001-KSNRATE1 TO    WK-4001-KSNRATE1
                   MOVE   SYS-4001-TAXKBN   TO    WK-4001-TAXKBN
                   MOVE   SYS-4001-TENKBN   TO    WK-4001-TENKBN
                   MOVE   SYS-4001-SKJKBN   TO    WK-4001-SKJKBN
                   MOVE   SYS-4001-TAXKBN-KZI
                                            TO    WK-4001-TAXKBN-KZI
                   IF     SYS-4001-SYUTENTANKA2-X =  SPACE
                     IF   SYS-4001-SYUTENTANKA-X  =  SPACE
                        MOVE  ZERO          TO    WK-4001-SYUTENTANKA
                     ELSE
                        MOVE  SYS-4001-SYUTENTANKA
                                            TO    WK-4001-SYUTENTANKA
                     END-IF
                   ELSE
                        MOVE  SYS-4001-SYUTENTANKA2
                                            TO    WK-4001-SYUTENTANKA
                   END-IF
                   IF     SYS-4001-YKZTENTANKA2-X =  SPACE
                     IF   SYS-4001-YKZTENTANKA-X  =  SPACE
                        MOVE  ZERO          TO    WK-4001-YKZTENTANKA
                     ELSE
                        MOVE  SYS-4001-YKZTENTANKA
                                            TO    WK-4001-YKZTENTANKA
                     END-IF
                   ELSE
                        MOVE  SYS-4001-YKZTENTANKA2
                                            TO    WK-4001-YKZTENTANKA
                   END-IF
                   IF     SYS-4001-KOMUTENTANKA-X =  SPACE
                        MOVE  ZERO          TO    WK-4001-KOMUTENTANKA
                   ELSE
                        MOVE  SYS-4001-KOMUTENTANKA
                                            TO    WK-4001-KOMUTENTANKA
                   END-IF
                   MOVE   SYS-4001-KOMURSITANKAKBN
                                         TO    WK-4001-KOMURSITANKAKBN
                   MOVE   SYS-4001-KOMURSITANKA-G
                                         TO    WK-4001-KOMURSITANKA-G
               END-IF
               MOVE     "tbl_syskanri"      TO    MCP-TABLE
               MOVE     "key10"             TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           END-IF.
      *
      *    ¾ÃÈñÀÇ·×»»¤Î·¸¿ôÀßÄê
           IF    LNK-SYU-SRYYMD(1:6) >= "201910"
               MOVE      10      TO  WK-S1
               MOVE     110      TO  WK-S2
               MOVE     0.10     TO  WK-S4
               MOVE     1.10     TO  WK-S5
           ELSE
             IF  LNK-SYU-SRYYMD(1:6) >= "201404"
               MOVE       8      TO  WK-S1
               MOVE     108      TO  WK-S2
               MOVE     0.08     TO  WK-S4
               MOVE     1.08     TO  WK-S5
             ELSE
               MOVE       5      TO  WK-S1
               MOVE     105      TO  WK-S2
               MOVE     0.05     TO  WK-S4
               MOVE     1.05     TO  WK-S5
             END-IF
           END-IF.
           EVALUATE  WK-TAX1001-KBN
               WHEN      "1"
                 MOVE   0.50000  TO  WK-S3
               WHEN      "2"
                 MOVE   0.00000  TO  WK-S3
               WHEN      "3"
                 MOVE   0.99999  TO  WK-S3
           END-EVALUATE.
      *
      *    ÊÝ¸±ÁÈ¹ç¤»¥Þ¥¹¥¿¤Î¸¡º÷
           INITIALIZE                           HKNCOMBI-REC.
           MOVE    LNK-SYU-HOSPNUM      TO      COMB-HOSPNUM.
           MOVE    LNK-SYU-PTID         TO      COMB-PTID.
           MOVE    LNK-SYU-HKNCOMBINUM  TO      COMB-HKNCOMBINUM.
           MOVE    HKNCOMBI-REC         TO      MCPDATA-REC.
           MOVE    "DBSELECT"           TO      MCP-FUNC.
           MOVE    "tbl_hkncombi"       TO      MCP-TABLE.
           MOVE    "key"                TO      MCP-PATHNAME.
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA.
           IF      MCP-RC               =       ZERO
               MOVE     "tbl_hkncombi"  TO      MCP-TABLE
               MOVE     "key"           TO      MCP-PATHNAME
               PERFORM   HKNCOMBI-READ-SEC
               IF      FLG-HKNCOMBI     =       1
                   DISPLAY "HKNCOMBI DBFETCH ERR"
                   MOVE     10             TO   LNK-S02-RC
                   MOVE    "tbl_hkncombi"  TO   MCP-TABLE
                   MOVE    "key"           TO   MCP-PATHNAME
                   PERFORM  DB-CLOSE-SEC
                   GO   TO              MAIN-EXT
               END-IF
           ELSE
               MOVE    1                TO      FLG-HKNCOMBI
               DISPLAY "HKNCOMBI DBSELECT ERR"
               MOVE     10              TO      LNK-S02-RC
               MOVE    "tbl_hkncombi"   TO      MCP-TABLE
               MOVE    "key"            TO      MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
               GO   TO                  MAIN-EXT
           END-IF.
           MOVE    "tbl_hkncombi"       TO      MCP-TABLE.
           MOVE    "key"                TO      MCP-PATHNAME.
           PERFORM  DB-CLOSE-SEC.
      *
           MOVE     ZERO                TO   FLG-DAISAN-GENBUTU.
           IF  (LNK-SYU-SRYYMD(1:6)    >=    "201204")
           AND (COMB-KOH1HKNNUM         =    "970"   )
              INITIALIZE                     PTRSIINF-REC
              MOVE    COMB-HOSPNUM      TO   PTRSI-HOSPNUM
              MOVE    COMB-PTID         TO   PTRSI-PTID
              MOVE    COMB-KOH1ID       TO   PTRSI-KOHID
              MOVE    PTRSIINF-REC      TO   MCPDATA-REC
              MOVE    "DBSELECT"        TO   MCP-FUNC
              MOVE    "tbl_ptrsiinf"    TO   MCP-TABLE
              MOVE    "key"             TO   MCP-PATHNAME
              CALL    "ORCDBMAIN"       USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA
              IF      MCP-RC  =  ZERO
                MOVE    "tbl_ptrsiinf"  TO   MCP-TABLE
                MOVE    "key"           TO   MCP-PATHNAME
                PERFORM  PTRSIINF-READ-SEC
                IF    FLG-PTRSIINF     =  ZERO
      *           ¸½ÊªµëÉÕÂÐ¾Ý¤È¤¹¤ë
                  IF     PTRSI-DAISAN-GENBTKBN  =  "2"
                     MOVE     1         TO   FLG-DAISAN-GENBUTU
                  END-IF
                END-IF
              END-IF
              MOVE    "tbl_ptrsiinf"    TO   MCP-TABLE
              MOVE    "key"             TO   MCP-PATHNAME
              PERFORM  DB-CLOSE-SEC
           END-IF.
      *
      *    ÊÝ¸±ÁÈ¹ç¤»¥Þ¥¹¥¿¤Î»²¾ÈÉôÊ¬³ÎÄê
           PERFORM   100-KAKUTEI-SEC.
      *
      *    ¼«ÈñÊÝ¸±¤Î¥Ç¡¼¥¿ÊÔ½¸
           MOVE      ZERO    TO    WK-SKYMONEY-ZEI.
           PERFORM   104-JIHIHOKEN-DATA-HENSYU-SEC.
      *    ÊÝ¸±ÁÈ¹ç¤»¤Î¾å¸Â¶èÊ¬ÊÔ½¸
           PERFORM   105-JYOGENKBN-HENSYU-SEC.
      *
      *    ÊÝ¸±ÁÈ¹ç¤»¥Þ¥¹¥¿¤«¤é¼çÊÝ¸±¤ÎÊÝ¸±¼ïÎà¤òÈ½Äê
      *    ¡Ê¶õÇò¡§°åÊÝ¡¢£±¡§Ï«ºÒ¼«Çå¡¢£²¡§¸ø³²¡Ë
           MOVE     SPACE               TO       WK-HKNKBN.
           EVALUATE    COMB-SYU-HKNKOHSBTKBN
               WHEN    "4"
                       MOVE    "1"      TO       WK-HKNKBN
           END-EVALUATE.
           IF   COMB-HKNNUM  = "975"
                       MOVE    "2"      TO       WK-HKNKBN
           END-IF.
      *
      *    Æ±ÆüºÆÆþ±¡·×»»¼±ÊÌÍÑ
           MOVE  LNK-S02-SKYSTYMD(7:2)  TO   IDX-ST
           IF   (LNK-S02-SKYSTYMD(1:6)      =  LNK-SYU-SRYYMD(1:6))
           AND  (LNK-S02-DOJITU-DAY(IDX-ST) =  8  OR  9           )
                MOVE    "1"     TO      LNK-SYU-SAIKEISANKBN
           END-IF.
      *
      *    ´µ¼ÔÉéÃ´³Û¤Î»»Äê
           PERFORM       200-HKNFTN-SANTEI-SEC.
      *
      *    £·£°ºÐÌ¤Ëþ¤ÎÄã£±¥Á¥§¥Ã¥¯
           IF      LNK-SYU-SRYYMD(1:6)   >=  "201710"
             IF (LNK-SYU-SYUHKNNUM = "971" OR "973" OR "975"
                                  OR "068" OR "069" OR "040"  )
             OR (LNK-SYU-SYUHKNNUM(1:2) = "98" OR "90" OR "91")
             OR (LNK-S02-KOUREI-NYUIN-KBN = "1"               )
             OR (FLG-KOREI-TANYUIN        =  1                )
             OR (FLG-DAISAN-KOREI         =  1                )
               CONTINUE
             ELSE
               PERFORM   VARYING   IDX24    FROM    1   BY  1
                          UNTIL    IDX24     >     31
                 IF   LNK-S02-SKJHKN-HKNCOMBI(IDX24)     = SPACE
                 AND  LNK-S02-SKJHKN-HKNCOMBI-DOU(IDX24) = SPACE
                   IF  ((LNK-SYU-DAY(IDX24)           =  "1" OR "9") OR
                        (LNK-S02-NYUINDAY-KBN(IDX24)  =  "1"       ))
                   AND ( LNK-S02-NYUSANTEI-KBN(IDX24) =  "1"        )
                     IF   WK-SYOTOKU-SKJKBN(IDX24)  =  "1" OR "4"
                        MOVE   34    TO  LNK-S02-RC
                     END-IF
                   END-IF
                 ELSE
                   IF  ((LNK-SYU-DAY(IDX24)           =  "1" OR "9") OR
                        (LNK-S02-NYUINDAY-KBN(IDX24)  =  "1"       ) OR
                        (WK-SKJHKN-SANTEIFLG(IDX24)   =  "1"       ))
                   AND ( LNK-S02-NYUSANTEI-KBN(IDX24) =  "1"        )
                     IF   WK-SYOTOKU-SKJKBN(IDX24)  =  "1" OR "4"
                        MOVE   34    TO  LNK-S02-RC
                     END-IF
                   END-IF
                 END-IF
               END-PERFORM
             END-IF
           END-IF.
      *
      *    »»½ÐÀÁµá³Û¤Î£±£°±ßÌ¤Ëþ»Í¼Î¸ÞÆþ¡ÊÌôºÞ°ìÉôÉéÃ´¶â¤â´Þ¤à¡Ë
      *    ¢¨Ï«ºÒÊÝ¸±¤Î¾ì¹ç¤Ï»Í¼Î¸ÞÆþ¤ò¹Ô¤ï¤Ê¤¤
      *    ¢¨Ï·¿Í£²³ä¤Ç¸ÂÅÙ¤¬£·£²£³£°£°±ß¡Ü¡÷±ß¤Î¾ì¹ç¤Ï»Í¼Î¸ÞÆþ¤ò¹Ô¤ï¤Ê¤¤
           IF     (LNK-SYU-SKYMONEY      NOT =   ZERO)   
               IF  (WK-HKNKBN                =   "1" OR "2")
               OR  (FLG-KOUGAKUCYO           =    1        )
               OR  (FLG-KOUGAKUCYO2          =    1        )
               OR  (FLG-KOUGAKUCYO3          =    1        )
               OR  (FLG-KOUGAKUCYO5          =    1        )
               OR  (FLG-KOUGAKUCYO-JIRITU    =    1        )
               OR  (FLG-KOUGAKUCYO-ININ      =    1        )
               OR  (FLG-KOUGAKUCYO-GEN70     =    1        )
               OR  (FLG-KOUGAKUCYO-GEN70K    =    1        )
               OR  (FLG-KOUGAKUCYO-OITA      =    1        )
               OR  (FLG-KUMAMOTO             =   "1"       )
               OR  (FLG-FTNGAKEN             =    1        )
               OR  (FLG-KOUGAKUCYO-TOYAMA    =    1        )
               OR  (COMB-SYU-HKNKOHSBTKBN    =   "8" OR "9")
                   CONTINUE
               ELSE
                   COMPUTE  LNK-SYU-SKYMONEY = LNK-SYU-SKYMONEY  +  5
                   COMPUTE  WK-SEIKYUGK      = LNK-SYU-SKYMONEY  /  10
                   COMPUTE  LNK-SYU-SKYMONEY = WK-SEIKYUGK       *  10
               END-IF 
           END-IF.
      *
      *    ¼çÊÝ¸±¡¦Ï·¿Í¡¦¸øÈñ¤ÎÈ½ÊÌ
      *      ¡Ê¼çÊÝ¸±¡Ë
           IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)    AND
                  (LNK-SYU-KOH1HKNNUM    =       SPACE)    AND
                  (LNK-SYU-KOH2HKNNUM    =       SPACE)    AND
                  (LNK-SYU-KOH3HKNNUM    =       SPACE)    AND
                  (LNK-SYU-KOH4HKNNUM    =       SPACE)
                   MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-HKNTEKMONEY
           END-IF.
      *       ¡ÊÏ·¿Í¡Ë 
      *
           IF     (LNK-SYU-KOH1HKNNUM    =   SPACE)    AND
                  (LNK-SYU-KOH2HKNNUM    =   SPACE)    AND
                  (LNK-SYU-KOH3HKNNUM    =   SPACE)    AND
                  (LNK-SYU-KOH4HKNNUM    =   SPACE)
                   CONTINUE
           ELSE
               IF      COMB-KOH1-HKNKOHSBTKBN    =       "3"
                  IF  (COMB-KOH2-HKNKOHSBTKBN    =     SPACE)  AND
                      (COMB-KOH3-HKNKOHSBTKBN    =     SPACE)  AND
                      (COMB-KOH4-HKNKOHSBTKBN    =     SPACE)
                       MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-RJN-FTN
                  ELSE
      *            ¡Ê¸øÈñ¡Ë
                       MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-KOH-FTN
                       MOVE   WK-KNJFTNKIN-ENTANI
                                          TO   LNK-SYU-KOH-FTN-ENTANI
                  END-IF
               ELSE
      *            ¡Ê¸øÈñ¡Ë
                       MOVE   LNK-SYU-SKYMONEY   TO   LNK-SYU-KOH-FTN
                       MOVE   WK-KNJFTNKIN-ENTANI
                                          TO   LNK-SYU-KOH-FTN-ENTANI
               END-IF
           END-IF.
      *
      *    ¼«Èñ¶â³Û¤Î¾ÃÈñÀÇ·×»»
           COMPUTE   LNK-SYU-JIHI-TOTAL =  (LNK-SYU-JIHI-TAXNASI(1)  +
                                            LNK-SYU-JIHI-TAXNASI(2)  +
                                            LNK-SYU-JIHI-TAXNASI(3)  +
                                            LNK-SYU-JIHI-TAXNASI(4)  +
                                            LNK-SYU-JIHI-TAXNASI(5)  +
                                            LNK-SYU-JIHI-TAXNASI(6)  +
                                            LNK-SYU-JIHI-TAXNASI(7)  +
                                            LNK-SYU-JIHI-TAXNASI(8)  +
                                            LNK-SYU-JIHI-TAXNASI(9)  +
                                            LNK-SYU-JIHI-TAXNASI(10)).
           COMPUTE  LNK-SYU-JIHI-TOTAL-TAX = (LNK-SYU-JIHI-TAXARI(1) +
                                              LNK-SYU-JIHI-TAXARI(2) +
                                              LNK-SYU-JIHI-TAXARI(3) +
                                              LNK-SYU-JIHI-TAXARI(4) +
                                              LNK-SYU-JIHI-TAXARI(5) +
                                              LNK-SYU-JIHI-TAXARI(6) +
                                              LNK-SYU-JIHI-TAXARI(7) +
                                              LNK-SYU-JIHI-TAXARI(8) +
                                              LNK-SYU-JIHI-TAXARI(9) +
                                              LNK-SYU-JIHI-TAXARI(10)).
      *
      *    ÊÝ¸±Å¬ÍÑ³°¶â³Û¤Î²Ã»»
           MOVE       ZERO              TO  LNK-SYU-TGMONEY(17).
           MOVE       ZERO              TO  LNK-SYU-TGMONEY-TAX(17).
           PERFORM    VARYING   HKNNYU-IDX   FROM   1   BY   1
                      UNTIL     HKNNYU-IDX   >     16
                      ADD       LNK-SYU-TGMONEY(HKNNYU-IDX)
                                            TO  LNK-SYU-TGMONEY(17)
                      ADD       LNK-SYU-TGMONEY-TAX(HKNNYU-IDX)
                                        TO  LNK-SYU-TGMONEY-TAX(17)
           END-PERFORM.
      *
           COMPUTE  WK-SKYCHK-KEISAN7  = LNK-SYU-SKYMONEY
                                       + LNK-SYU-SKYMONEY-SKJ-KEI
                                       + LNK-SYU-SKYMONEY-LIFE-KEI.
      *
           IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
             COMPUTE  WK-SKYCHK-KEISAN8              =
                      LNK-SYU-RMSAGAKU               +
                      LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
                      LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                      LNK-SYU-TGMONEY(17)            +
                      LNK-SYU-TGMONEY-TAX(17)        +
                      LNK-SYU-JIHI-TOTAL             +
                      LNK-SYU-JIHI-TOTAL-TAX
      *
             COMPUTE    LNK-SYU-JIHI-TAX =
                       (LNK-SYU-JIHI-TOTAL-TAX  * WK-S1 / WK-S2)
                                                        + WK-S3
             COMPUTE    LNK-SYU-TGMONEY-TAX-SAI   =
                       (LNK-SYU-TGMONEY-TAX(17) * WK-S1 / WK-S2)
                                                        + WK-S3
             IF   WK-BRMSGK-TAXKBN    =  "1"
               COMPUTE  LNK-SYU-RMSAGAKU-TAX-SAI    =
                       (LNK-SYU-RMSAGAKU        * WK-S1 / WK-S2)
                                                        + WK-S3
             END-IF
             IF   WK-HKNKBN  =   "1" OR "2"
                  COMPUTE      LNK-SYU-RSIJIBAI-SKYMONEY      =
                               LNK-SYU-RSIJIBAI-SKYMONEY      +
                               LNK-SYU-RMSAGAKU               +
                               LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
                               LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                               LNK-SYU-TGMONEY(17)            +
                               LNK-SYU-TGMONEY-TAX(17)        +
                               LNK-SYU-JIHI-TOTAL             +
                               LNK-SYU-JIHI-TOTAL-TAX
             END-IF
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" OR "9" ) AND
                 ( COMB-HOJOKBN           =  "1"        )
                 COMPUTE  LNK-SYU-TAX-TAISHOU     =
                          LNK-SYU-HKNTEKMONEY     +
                          LNK-SYU-TGMONEY-TAX(17) +
                          LNK-SYU-JIHI-TOTAL-TAX  +
                          WK-SKJ-ZEITAISYO
             ELSE
                 COMPUTE  LNK-SYU-TAX-TAISHOU     =
                          LNK-SYU-TGMONEY-TAX(17) +
                          LNK-SYU-JIHI-TOTAL-TAX  +
                          WK-SKJ-ZEITAISYO
             END-IF
             IF   WK-BRMSGK-TAXKBN    =  "1"
                 COMPUTE  LNK-SYU-TAX-TAISHOU     =
                          LNK-SYU-TAX-TAISHOU     +
                          LNK-SYU-RMSAGAKU
             END-IF
             COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                     (LNK-SYU-TAX-TAISHOU * WK-S1 / WK-S2)
                                                  + WK-S3
           ELSE
             COMPUTE  WK-SKYCHK-KEISAN8              =
                      LNK-SYU-RMSAGAKU               +
                      LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
                      LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                      LNK-SYU-TGMONEY(17)            +
                      LNK-SYU-TGMONEY-TAX(17)        +
                      LNK-SYU-JIHI-TOTAL             +
                      LNK-SYU-JIHI-TOTAL-TAX         +
                      LNK-SYU-JIHI-TAX
      *
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" OR "9" ) AND
                 ( COMB-HOJOKBN           =  "1"        )
              CONTINUE
             ELSE
              COMPUTE   LNK-SYU-JIHI-TAX =
                       (LNK-SYU-JIHI-TOTAL-TAX  * WK-S4) + WK-S3
              COMPUTE   LNK-SYU-TGMONEY-TAX-SAI   =
                       (LNK-SYU-TGMONEY-TAX(17) * WK-S4) + WK-S3
              COMPUTE   LNK-SYU-TGMONEY-TAX(17)   = 
                       (LNK-SYU-TGMONEY-TAX(17) * WK-S5) + WK-S3
              IF   WK-BRMSGK-TAXKBN    =  "1"
                COMPUTE LNK-SYU-RMSAGAKU-TAX-SAI  =
                       (LNK-SYU-RMSAGAKU        * WK-S4) + WK-S3
                COMPUTE LNK-SYU-RMSAGAKU  =
                       (LNK-SYU-RMSAGAKU        * WK-S5) + WK-S3
              END-IF
             END-IF
             IF   WK-HKNKBN  =   "1" OR "2"
                  COMPUTE      LNK-SYU-RSIJIBAI-SKYMONEY      =
                               LNK-SYU-RSIJIBAI-SKYMONEY      +
                               LNK-SYU-RMSAGAKU               +
                               LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
                               LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                               LNK-SYU-TGMONEY(17)            +
                               LNK-SYU-TGMONEY-TAX(17)        +
                               LNK-SYU-JIHI-TOTAL             +
                               LNK-SYU-JIHI-TOTAL-TAX         +
                               LNK-SYU-JIHI-TAX
             END-IF
      *      ¼«ÈñÊÝ¸±¤ÎÊä½õ¶èÊ¬¤¬²ÝÀÇ¤Î¾ì¹ç¡¢¾ÃÈñÀÇ·×»»¤ò¹Ô¤¦
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" OR "9" ) AND
                 ( COMB-HOJOKBN           =  "1"        )
               COMPUTE  WK-SKYCHK-KEISAN3 =  WK-SKYCHK-KEISAN7
                                          +  WK-SKYCHK-KEISAN8
               COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                      ( WK-SKYCHK-KEISAN3 *  WK-S4 ) + WK-S3
               COMPUTE  WK-SKYCHK-KEISAN4 =
                      ( WK-SKYCHK-KEISAN3 *  WK-S5 ) + WK-S3
               COMPUTE  WK-SKYCHK-KEISAN5 =
                        WK-SKYCHK-KEISAN4 -  WK-SKYCHK-KEISAN3
               COMPUTE  WK-SKYCHK-KEISAN8 =  WK-SKYCHK-KEISAN8
                                          +  WK-SKYCHK-KEISAN5
             ELSE
               COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI       =
                        LNK-SYU-JIHI-TAX               +
                        LNK-SYU-TGMONEY-TAX-SAI        +
                        LNK-SYU-RMSAGAKU-TAX-SAI       +
                        LNK-SYU-SKYMONEY-SKJ-TAX       +
                        LNK-SYU-SKYMONEY-SKJ-JIHI-TAX  +
                        LNK-SYU-SKYMONEY-LIFE-TAX      +
                        LNK-SYU-SKYMONEY-LIFE-JIHI-TAX
             END-IF
           END-IF.
      *
      *    ¸ºÌÈ·×»»¡¦ÀÁµá³ÛÃ¼¿ô·×»»¡ÊÏ«ºÒ¡¦¼«ÇåÀÕ¡¦¸ø³²¤ò½ü¤¯¡Ë
           MOVE     ZERO      TO    FLG-GENMEN.
           IF  (LNK-SYU-SYUHKNNUM   =  "971" OR "973" OR "975")
           OR  (LNK-SYU-KOH1HKNNUM  =  "970"                  )
                   CONTINUE
           ELSE
      *            ¸ºÌÈ·×»»
                   INITIALIZE                           PTINF-REC
                   MOVE    LNK-SYU-HOSPNUM      TO      PTINF-HOSPNUM
                   MOVE    LNK-SYU-PTID         TO      PTINF-PTID
                   MOVE    PTINF-REC            TO      MCPDATA-REC
                   MOVE    "DBSELECT"           TO      MCP-FUNC
                   MOVE    "tbl_ptinf"          TO      MCP-TABLE
                   MOVE    "key"                TO      MCP-PATHNAME
                   CALL    "ORCDBMAIN"          USING   MCPAREA
                                                        MCPDATA-REC
                                                        SPA-AREA
                   IF      MCP-RC               =       ZERO
                       MOVE    "tbl_ptinf"      TO      MCP-TABLE
                       MOVE    "key"            TO      MCP-PATHNAME
                       PERFORM  PTINF-READ-SEC
                       IF       MCP-RC          =       ZERO
                           PERFORM   300-GENMEN-KEISAN-SEC
                       ELSE
                           DISPLAY  "PTINF FETCH ERR"
                       END-IF
                   ELSE
                       DISPLAY   "PTINF SELECT ERR"
                   END-IF
      *
                   MOVE    "tbl_ptinf"          TO       MCP-TABLE
                   MOVE    "key"                TO       MCP-PATHNAME
                   PERFORM  DB-CLOSE-SEC
      *
      *            ÀÁµá³ÛÃ¼¿ô·×»»¡Ê¸ºÌÈÌµ¤·¡Ë
                   IF    FLG-GENMEN  =  ZERO
                     MOVE  WK-HASU1001-KBN2   TO  WK-HASU1001-KBN-WK
                     MOVE  WK-HASU1001-KBN2J  TO  WK-HASU1001-KBN-WKJ
                     PERFORM  400-SEIKYU-HASUU-KEISAN-SEC
                   END-IF
           END-IF.
      *
      *    ÀÁµá¶â³Û¤Î·×»»¡ÊÏ«ºÒ¡Ë
           IF    LNK-SYU-SYUHKNNUM       =    "971"
             IF    LNK-SYU-PTFTNRATE  =  100
               COMPUTE    WK-SKYCHK-KEISAN7        =
                          WK-SKYCHK-KEISAN7        +
                          LNK-SYU-RSISHOSHIN-MONEY +
                          LNK-SYU-RSISAISHIN-MONEY +
                          LNK-SYU-RSISDO-MONEY     +
                          LNK-SYU-RSIETC-MONEY
               COMPUTE    LNK-SYU-RSI-TOTAL        =
                          LNK-SYU-RSISHOSHIN-MONEY +
                          LNK-SYU-RSISAISHIN-MONEY +
                          LNK-SYU-RSISDO-MONEY     +
                          LNK-SYU-RSIETC-MONEY
             END-IF
      *
             MOVE  WK-HASU1001-KBN3   TO  WK-HASU1001-KBN-WK
             MOVE  WK-HASU1001-KBN3J  TO  WK-HASU1001-KBN-WKJ
             PERFORM  400-SEIKYU-HASUU-KEISAN-SEC
      *
             COMPUTE      LNK-SYU-RSIJIBAI-SKYMONEY  =
                          LNK-SYU-RSIJIBAI-SKYMONEY  +
                          LNK-SYU-RSISHOSHIN-MONEY   +
                          LNK-SYU-RSISAISHIN-MONEY   +
                          LNK-SYU-RSISDO-MONEY       +
                          LNK-SYU-RSIETC-MONEY
           END-IF.
      *
      *    ÀÁµá¶â³Û¤Î·×»»¡Ê¼«ÇåÀÕ¡Ë
           MOVE     ZERO      TO   WK-RSIETC-ZEITAISYO.
           IF    LNK-SYU-SYUHKNNUM       =    "973"
             PERFORM   500-JIBAI-SONOTA-HENSYU-SEC
      *
             IF   FLG-KENPOJYUNKYO      =     ZERO
               COMPUTE  LNK-SYU-RSISHOSHIN-MONEY =
                       (LNK-SYU-RSISHOSHIN-MONEY *  WK-KSNRATE)
                                                 +  0.5
               COMPUTE  LNK-SYU-RSISAISHIN-MONEY =
                       (LNK-SYU-RSISAISHIN-MONEY *  WK-KSNRATE)
                                                 +  0.5
               IF   LNK-SYU-SRYYMD(1:6)  >=   "201307"
                 COMPUTE  LNK-SYU-RSIETC-MONEY =
                          LNK-SYU-RSIETC-MONEY -
                          LNK-S02-KYUKYU
                 COMPUTE  WK-KEISAN            =
                         (LNK-S02-KYUKYU       *  WK-KSNRATE)
                                               +  0.5
                 COMPUTE  LNK-SYU-RSIETC-MONEY =
                          LNK-SYU-RSIETC-MONEY +  WK-KEISAN
               END-IF
             END-IF
      *
             IF    LNK-SYU-PTFTNRATE  =  100
               COMPUTE    WK-SKYCHK-KEISAN7        =
                          WK-SKYCHK-KEISAN7        +
                          LNK-SYU-RSISHOSHIN-MONEY +
                          LNK-SYU-RSISAISHIN-MONEY +
                          LNK-SYU-RSISDO-MONEY     +
                          LNK-SYU-RSIETC-MONEY
               COMPUTE    LNK-SYU-RSI-TOTAL        =
                          LNK-SYU-RSISHOSHIN-MONEY +
                          LNK-SYU-RSISAISHIN-MONEY +
                          LNK-SYU-RSISDO-MONEY     +
                          LNK-SYU-RSIETC-MONEY
               IF    LNK-SYU-SRYYMD(1:6)  >=  "200704"
                 COMPUTE  LNK-SYU-TAX-TAISHOU      =
                          LNK-SYU-TGMONEY-TAX(17)  +
                          LNK-SYU-JIHI-TOTAL-TAX   +
                          WK-SKJ-ZEITAISYO         +
                          WK-RSIETC-ZEITAISYO
                 IF  WK-BRMSGK-TAXKBN  =  "1"
                   COMPUTE   LNK-SYU-TAX-TAISHOU   =
                             LNK-SYU-TAX-TAISHOU   +
                             LNK-SYU-RMSAGAKU
                 END-IF
                 COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI =
                         (LNK-SYU-TAX-TAISHOU * WK-S1 / WK-S2)
                                                      + WK-S3
               ELSE
                 COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI =
                          LNK-SYU-SKYMONEY-TAX-SAI +
                          LNK-SYU-RSI-TAX-SAI
               END-IF
             END-IF
      *
             MOVE  WK-HASU1001-KBN4   TO  WK-HASU1001-KBN-WK
             MOVE  WK-HASU1001-KBN4J  TO  WK-HASU1001-KBN-WKJ
             PERFORM  400-SEIKYU-HASUU-KEISAN-SEC
      *
             COMPUTE      LNK-SYU-RSIJIBAI-SKYMONEY  =
                          LNK-SYU-RSIJIBAI-SKYMONEY  +
                          LNK-SYU-RSISHOSHIN-MONEY   +
                          LNK-SYU-RSISAISHIN-MONEY   +
                          LNK-SYU-RSISDO-MONEY       +
                          LNK-SYU-RSIETC-MONEY
           END-IF.
      *
      *    ÀÁµá¶â³Û¤Î·×»»¡Ê¸ø³²¡Ë
           IF    LNK-SYU-SYUHKNNUM       =    "975"
              MOVE  "4"                TO  WK-HASU1001-KBN-WK
              MOVE  WK-HASU1001-KBN5J  TO  WK-HASU1001-KBN-WKJ
              PERFORM  400-SEIKYU-HASUU-KEISAN-SEC
           END-IF.
      *
      *    ÀÁµá¶â³Û¤Î·×»»¡ÊÂè»°¼Ô¹Ô°Ù¡Ë
           IF    LNK-SYU-KOH1HKNNUM      =    "970"
              INITIALIZE                         SYS-4001-REC
              MOVE    "4001"               TO    SYS-4001-KANRICD
              MOVE    "*"                  TO    SYS-4001-KBNCD
              MOVE    LNK-SYU-HOSPNUM      TO    SYS-4001-HOSPNUM
              MOVE    LNK-SYU-SRYYMD       TO    SYS-4001-STYUKYMD
              MOVE    LNK-SYU-SRYYMD       TO    SYS-4001-EDYUKYMD
              MOVE    SYS-4001-REC         TO    MCPDATA-REC
              MOVE    "DBSELECT"           TO    MCP-FUNC
              MOVE    "tbl_syskanri"       TO    MCP-TABLE
              MOVE    "key10"              TO    MCP-PATHNAME
              CALL    "ORCDBMAIN"          USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
              IF      MCP-RC               =     ZERO
                  MOVE     "tbl_syskanri"  TO    MCP-TABLE
                  MOVE     "key10"         TO    MCP-PATHNAME
                  PERFORM   SYSKANRI-READ-SEC
                  MOVE   SYS-4001-TAXKBN   TO    WK-4001-TAXKBN
                  MOVE   SYS-4001-TAXKBN-KZI
                                           TO    WK-4001-TAXKBN-KZI
              END-IF
              MOVE     "tbl_syskanri"      TO    MCP-TABLE
              MOVE     "key10"             TO    MCP-PATHNAME
              PERFORM   DB-CLOSE-SEC
      *
              PERFORM   500-JIBAI-SONOTA-HENSYU-SEC
      *
              IF    LNK-SYU-PTFTNRATE      =   ZERO
                CONTINUE
              ELSE
                COMPUTE  WK-SKYCHK-KEISAN7        =
                         WK-SKYCHK-KEISAN7        +
                         LNK-SYU-RSISHOSHIN-MONEY +
                         LNK-SYU-RSISAISHIN-MONEY +
                         LNK-SYU-RSISDO-MONEY     +
                         LNK-SYU-RSIETC-MONEY
                COMPUTE  LNK-SYU-RSI-TOTAL        =
                         LNK-SYU-RSISHOSHIN-MONEY +
                         LNK-SYU-RSISAISHIN-MONEY +
                         LNK-SYU-RSISDO-MONEY     +
                         LNK-SYU-RSIETC-MONEY
                COMPUTE  LNK-SYU-TAX-TAISHOU      =
                         LNK-SYU-TGMONEY-TAX(17)  +
                         LNK-SYU-JIHI-TOTAL-TAX   +
                         WK-SKJ-ZEITAISYO         +
                         WK-RSIETC-ZEITAISYO
                IF   WK-BRMSGK-TAXKBN    =  "1"
                   COMPUTE  LNK-SYU-TAX-TAISHOU   =
                            LNK-SYU-TAX-TAISHOU   +
                            LNK-SYU-RMSAGAKU
                END-IF
                COMPUTE  LNK-SYU-SKYMONEY-TAX-SAI  =
                        (LNK-SYU-TAX-TAISHOU * WK-S1 / WK-S2)
                                                     + WK-S3
              END-IF
      *
              MOVE  WK-HASU1001-KBN6   TO  WK-HASU1001-KBN-WK
              MOVE  WK-HASU1001-KBN6J  TO  WK-HASU1001-KBN-WKJ
              PERFORM  400-SEIKYU-HASUU-KEISAN-SEC
      *
              COMPUTE    LNK-SYU-RSIJIBAI-SKYMONEY      =
                         LNK-SYU-RSIJIBAI-SKYMONEY      +
                         LNK-SYU-RMSAGAKU               +
                         LNK-SYU-SKYMONEY-SKJ-JIHI-KEI  +
                         LNK-SYU-SKYMONEY-LIFE-JIHI-KEI +
                         LNK-SYU-TGMONEY(17)            +
                         LNK-SYU-TGMONEY-TAX(17)        +
                         LNK-SYU-JIHI-TOTAL             +
                         LNK-SYU-JIHI-TOTAL-TAX         +
                         LNK-SYU-RSISHOSHIN-MONEY       +
                         LNK-SYU-RSISAISHIN-MONEY       +
                         LNK-SYU-RSISDO-MONEY           +
                         LNK-SYU-RSIETC-MONEY
           END-IF.
      *
      *    ´µ¼ÔÉéÃ´¶â¡¡ÆÈ¼«·×»»ÂÐ±þ
      *
           INITIALIZE                         SYS-1037-REC.
           MOVE    "1037"               TO    SYS-1037-KANRICD.
           MOVE    "*"                  TO    SYS-1037-KBNCD.
           MOVE    LNK-SYU-HOSPNUM      TO    SYS-1037-HOSPNUM.
           MOVE    LNK-SYU-SRYYMD       TO    SYS-1037-STYUKYMD.
           MOVE    LNK-SYU-SRYYMD       TO    SYS-1037-EDYUKYMD.
           MOVE    SYS-1037-REC         TO    MCPDATA-REC.
           MOVE    "DBSELECT"           TO    MCP-FUNC.
           MOVE    "tbl_syskanri"       TO    MCP-TABLE.
           MOVE    "key10"              TO    MCP-PATHNAME.
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA.
           IF      MCP-RC               =     ZERO
               MOVE     "tbl_syskanri"  TO    MCP-TABLE
               MOVE     "key10"         TO    MCP-PATHNAME
               PERFORM   SYSKANRI-READ-SEC
               IF    MCP-RC             =     ZERO
                   IF   LNK-SYU-HOSPNUM   =    SYS-1037-HOSPNUM
                       IF  SYS-1037-PGID-NYU NOT = SPACE
                          CALL   SYS-1037-PGID-NYU  USING
                                                    MCPAREA
                                                    LNK-SYUNOU-REC
                                                    SPA-AREA
                       END-IF
                   END-IF
               END-IF
           END-IF
      *
           MOVE     "tbl_syskanri"      TO    MCP-TABLE.
           MOVE     "key10"             TO    MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
      *    ÀÁµá¶â³Û¤Î·×»»¡ÊÄ´À°¶â¤Î²Ã¸º»»¡Ë
           COMPUTE    LNK-SYU-SKYMONEY  =   LNK-SYU-SKYMONEY    +
                                            LNK-SYU-CHOSEI.
      *
           IF    ((LNK-SYU-SYUHKNNUM   NOT =   SPACE     ) AND
                  (LNK-SYU-KOH1HKNNUM  =   "972" OR "974") AND
                  (LNK-SYU-KOH2HKNNUM  =       SPACE     ))
           OR    ( LNK-SYU-KOH1HKNNUM  =   "970"          )
              MOVE     "1"     TO     LNK-SYU-HKNTEKKBN
           END-IF.
      *
      *****+++++++++++++++++++
      *
      *    ·×»»¶â³Û·å¿ô¥Á¥§¥Ã¥¯
           IF    LNK-SYU-SRYYMD(1:6)  >=  "201204"
      *      ¼çÊÝ¸±Ëô¤Ï¸øÈñ¤ÎÉéÃ´³ä¹ç·×»»³Û
             IF  (LNK-SYU-SYUHKNNUM   =  "971" OR "973" OR "975")
             OR  (LNK-SYU-KOH1HKNNUM  =  "970"                  )
               IF   LNK-SYU-KOH1HKNNUM  =  "970"
      *          <COMPFTN>
      *          # »Í¼Î¸ÞÆþ
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN9 +  5
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
                 IF   WK-SKYCHK-KEISAN  >  9999999
                   MOVE      "1"          TO   LNK-S02-SKYCHKFLG
                 END-IF
      *          <RSIJIBAI-SKYMONEY>
                 MOVE  WK-SKYCHK-KEISAN10 TO  WK-SKYCHK-KEISAN
               ELSE
      *          <RSIJIBAI-SKYMONEY>
                 MOVE  WK-SKYCHK-KEISAN9  TO  WK-SKYCHK-KEISAN
               END-IF
               COMPUTE    WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN
                                            + WK-SKYCHK-KEISAN8
                                            + LNK-SYU-RSISHOSHIN-MONEY
                                            + LNK-SYU-RSISAISHIN-MONEY
                                            + LNK-SYU-RSISDO-MONEY
                                            + LNK-SYU-RSIETC-MONEY
               IF   WK-SKYCHK-KEISAN  >  9999999
                 IF  (LNK-SYU-SYUHKNNUM  =  "971" OR "973" OR "975")
                 AND (LNK-SYU-PTFTNRATE  =  ZERO                   )
                   MOVE   9999999       TO   LNK-SYU-RSIJIBAI-SKYMONEY
                 ELSE
                   MOVE    "1"          TO   LNK-S02-SKYCHKFLG
                 END-IF
               END-IF
             ELSE
      *        <COMPFTN>
      *        # »Í¼Î¸ÞÆþ
               COMPUTE    WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN9 +  5
               COMPUTE    WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
               COMPUTE    WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               IF   WK-SKYCHK-KEISAN  >  9999999
                 MOVE      "1"          TO   LNK-S02-SKYCHKFLG
               END-IF
             END-IF
           END-IF.
      *
           EVALUATE  LNK-S02-SKYCHKFLG
             WHEN      "1"
                 MOVE     40     TO     LNK-S02-RC
             WHEN      "2"
                 MOVE     41     TO     LNK-S02-RC
           END-EVALUATE.
      *****+++++++++++++++++++
      *
       MAIN-EXT.
           EXIT PROGRAM
           STOP RUN.
      *
      ******************************************************************
      *        ¸ºÌÈ·×»»½èÍý                                            *
      ******************************************************************
       300-GENMEN-KEISAN-SEC          SECTION.
      *
           IF   PTINF-DISCOUNT  NOT =   SPACE  AND  "00"
      *
               INITIALIZE                         SYS-1026-REC
               MOVE    "1026"               TO    SYS-1026-KANRICD
               MOVE    PTINF-DISCOUNT-KBN   TO    SYS-1026-KBNCD
               MOVE    LNK-SYU-HOSPNUM      TO    SYS-1026-HOSPNUM
               MOVE    LNK-SYU-SRYYMD       TO    SYS-1026-STYUKYMD
               MOVE    LNK-SYU-SRYYMD       TO    SYS-1026-EDYUKYMD
               MOVE    SYS-1026-REC         TO    MCPDATA-REC
               MOVE    "DBSELECT"           TO    MCP-FUNC
               MOVE    "tbl_syskanri"       TO    MCP-TABLE
               MOVE    "key10"              TO    MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =     ZERO
                   MOVE     "tbl_syskanri"  TO    MCP-TABLE
                   MOVE     "key10"         TO    MCP-PATHNAME
                   PERFORM   SYSKANRI-READ-SEC
                   IF    MCP-RC             =     ZERO
                       MOVE   SYS-1026-KBNCD  TO  LNK-SYU-DISCOUNT-KBN
                       MOVE   SYS-1026-DISCOUNT-BODY
                                              TO  LNK-SYU-DISCOUNT-BODY
                   END-IF
               END-IF
      *
               MOVE     "tbl_syskanri"      TO    MCP-TABLE
               MOVE     "key10"             TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
      *
               INITIALIZE                         SYS-1027-REC
               MOVE    "1027"               TO    SYS-1027-KANRICD
               MOVE    PTINF-DISCOUNT       TO    SYS-1027-KBNCD
               MOVE    LNK-SYU-HOSPNUM      TO    SYS-1027-HOSPNUM
               MOVE    LNK-SYU-SRYYMD       TO    SYS-1027-STYUKYMD
               MOVE    LNK-SYU-SRYYMD       TO    SYS-1027-EDYUKYMD
               MOVE    SYS-1027-REC         TO    MCPDATA-REC
               MOVE    "DBSELECT"           TO    MCP-FUNC
               MOVE    "tbl_syskanri"       TO    MCP-TABLE
               MOVE    "key10"              TO    MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =     ZERO
                   MOVE     "tbl_syskanri"  TO    MCP-TABLE
                   MOVE     "key10"         TO    MCP-PATHNAME
                   PERFORM   SYSKANRI-READ-SEC
                   IF    MCP-RC             =     ZERO
      *
                     IF   (SYS-1027-TEIRITU        NOT =  SPACE)
                     AND  (SYS-1027-DISCOUNT-RATE  NOT =  ZERO )
                      IF   (LNK-SYU-SRYYMD(1:6)   < "200704"  )
                      AND  (COMB-SYU-HKNKOHSBTKBN = "8" OR "9")
                      AND  (COMB-HOJOKBN          = "1"       )
                       IF  WK-1001-GENTAIKBN  =  "2" OR "3"
                           CONTINUE
                       ELSE
                           PERFORM  3001-GENMEN-KEISAN2-SEC
                       END-IF
                      ELSE
                       IF  WK-1001-GENTAIKBN  =  "2"
                         IF  COMB-SYU-HKNKOHSBTKBN  =  "8"
                           CONTINUE
                         ELSE
                           PERFORM  3001-GENMEN-KEISAN2-SEC
                         END-IF
                       ELSE
                           PERFORM  3001-GENMEN-KEISAN2-SEC
                       END-IF
                      END-IF
                     END-IF
      *
                   END-IF
               END-IF
      *
               MOVE     "tbl_syskanri"    TO    MCP-TABLE
               MOVE     "key10"           TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           END-IF.
      *
       300-GENMEN-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸ºÌÈ·×»»½èÍý                                            *
      ******************************************************************
       3001-GENMEN-KEISAN2-SEC          SECTION.
      *
           COMPUTE   WK-SKYCHK-KEISAN   =   WK-SKYCHK-KEISAN7
                                        +   WK-SKYCHK-KEISAN8
           MOVE      ZERO               TO  WK-SKYCHK-KEISAN2
      *
           EVALUATE  WK-1001-GENTAIKBN
             WHEN      "2"
               MOVE  WK-SKYCHK-KEISAN7  TO  WK-SKYCHK-KEISAN
               MOVE  WK-SKYCHK-KEISAN8  TO  WK-SKYCHK-KEISAN2
             WHEN      "3"
               MOVE  WK-SKYCHK-KEISAN8  TO  WK-SKYCHK-KEISAN
               MOVE  WK-SKYCHK-KEISAN7  TO  WK-SKYCHK-KEISAN2
           END-EVALUATE
      *
           EVALUATE  SYS-1027-TEIRITU
             WHEN  "1"
               MOVE      WK-SKYCHK-KEISAN
                                 TO   WK-GENMEN-KEISAN
               MOVE      ZERO    TO   WK-RATE
               COMPUTE   WK-RATE = (100 - SYS-1027-DISCOUNT-RATE)
                                 /  100
               COMPUTE   WK-SKYCHK-KEISAN = WK-SKYCHK-KEISAN
                                          * WK-RATE
               COMPUTE   WK-GENMEN-KEISAN2  =  WK-GENMEN-KEISAN
                                            -  WK-SKYCHK-KEISAN
             WHEN  "2"
               IF   SYS-1027-DISCOUNT-RATE  >=  WK-SKYCHK-KEISAN
                 MOVE    WK-SKYCHK-KEISAN
                                 TO   WK-GENMEN-KEISAN2
                 MOVE    ZERO    TO   WK-SKYCHK-KEISAN
               ELSE
                 MOVE    SYS-1027-DISCOUNT-RATE
                                 TO   WK-GENMEN-KEISAN2
                 COMPUTE WK-SKYCHK-KEISAN = WK-SKYCHK-KEISAN
                                          - SYS-1027-DISCOUNT-RATE
               END-IF
           END-EVALUATE
      *
           IF    WK-1001-GENTAIKBN  =  "2" OR "3"
             IF  (WK-HASU1001-KBN    =  WK-HASU1001-KBN2)
             AND (WK-HASU1001-KBN2J  =  "0"             )
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN
                                          + WK-SKYCHK-KEISAN2
             END-IF
           END-IF
      *
           EVALUATE  WK-HASU1001-KBN
             WHEN  "1"
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  +  5
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
             WHEN  "2"
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
             WHEN  "3"
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  +  9
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
               COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
             WHEN  "4"
               CONTINUE
           END-EVALUATE
      *
           IF    WK-1001-GENTAIKBN  =  "2" OR "3"
             IF  (WK-HASU1001-KBN    =  WK-HASU1001-KBN2)
             AND (WK-HASU1001-KBN2J  =  "0"             )
               CONTINUE
             ELSE
               EVALUATE  WK-1001-GENTAIKBN
                 WHEN      "2"
                   IF   WK-HASU1001-KBN2J = "0"
                     MOVE  WK-HASU1001-KBN2   TO  WK-HASU-KBN
                   ELSE
                     MOVE  WK-HASU1001-KBN2J  TO  WK-HASU-KBN
                   END-IF
                 WHEN      "3"
                   MOVE    WK-HASU1001-KBN2   TO  WK-HASU-KBN
               END-EVALUATE
               EVALUATE   WK-HASU-KBN
                 WHEN  "1"
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 +  5
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 / 10
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 * 10
                 WHEN  "2"
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 / 10
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 * 10
                 WHEN  "3"
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 +  9
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 / 10
                   COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 * 10
                 WHEN  "4"
                   CONTINUE
               END-EVALUATE
               COMPUTE      WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN
                                              + WK-SKYCHK-KEISAN2
             END-IF
           END-IF
      *
           MOVE   WK-SKYCHK-KEISAN        TO   LNK-SYU-SKYMONEY
      *
           MOVE   SYS-1027-KBNCD          TO   LNK-SYU-DISCOUNT-RATEKBN
           MOVE   SYS-1027-TEIRITU        TO   LNK-SYU-DISCOUNT-TEIRITU
           MOVE   SYS-1027-DISCOUNT-RATE  TO   LNK-SYU-DISCOUNT-RATE
           MOVE   WK-GENMEN-KEISAN2       TO   LNK-SYU-DISCOUNT-MONEY
      *
           MOVE     1                     TO   FLG-GENMEN
      *
           IF    LNK-SYU-SRYYMD(1:6)  >=  "201204"
             IF  LNK-S02-SKYCHKFLG  =  SPACE
             AND WK-SKYCHK-KEISAN   >  9999999
               MOVE    "2"     TO   LNK-S02-SKYCHKFLG
             END-IF
             IF  WK-GENMEN-KEISAN2  >  9999999
               MOVE    "1"     TO   LNK-S02-SKYCHKFLG
             END-IF
           END-IF
      *
           .
      *
       3001-GENMEN-KEISAN2-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÀÁµá³ÛÃ¼¿ô·×»»½èÍý¡Ê¸ºÌÈÌµ¤·¡Ë
      ******************************************************************
       400-SEIKYU-HASUU-KEISAN-SEC          SECTION.
      *
           IF  WK-HASU1001-KBN-WKJ  =  "0"
             COMPUTE      WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN7
                                            + WK-SKYCHK-KEISAN8
             EVALUATE   WK-HASU1001-KBN-WK
               WHEN  "1"
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  +  5
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               WHEN  "2"
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               WHEN  "3"
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  +  9
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               WHEN  "4"
                 CONTINUE
             END-EVALUATE
           ELSE
             EVALUATE   WK-HASU1001-KBN-WK
               WHEN  "1"
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN7 +  5
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               WHEN  "2"
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN7 / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               WHEN  "3"
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN7 +  9
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  / 10
                 COMPUTE  WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN  * 10
               WHEN  "4"
                 MOVE  WK-SKYCHK-KEISAN7  TO  WK-SKYCHK-KEISAN
             END-EVALUATE
             EVALUATE   WK-HASU1001-KBN-WKJ
               WHEN  "1"
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN8 +  5
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 / 10
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 * 10
               WHEN  "2"
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN8 / 10
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 * 10
               WHEN  "3"
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN8 +  9
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 / 10
                 COMPUTE  WK-SKYCHK-KEISAN2 = WK-SKYCHK-KEISAN2 * 10
               WHEN  "4"
                 MOVE  WK-SKYCHK-KEISAN8  TO  WK-SKYCHK-KEISAN2
             END-EVALUATE
             COMPUTE      WK-SKYCHK-KEISAN  = WK-SKYCHK-KEISAN
                                            + WK-SKYCHK-KEISAN2
           END-IF
      *
           MOVE  WK-SKYCHK-KEISAN  TO  LNK-SYU-SKYMONEY
      *
           IF    LNK-SYU-SRYYMD(1:6)  >=  "201204"
             IF  LNK-S02-SKYCHKFLG  =  SPACE
             AND WK-SKYCHK-KEISAN   >  9999999
               MOVE    "2"     TO   LNK-S02-SKYCHKFLG
             END-IF
           END-IF
      *
           .
      *
       400-SEIKYU-HASUU-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¼«ÇåÀÕ¤½¤ÎÂ¾¥³¡¼¥É¾ðÊó¤ÎÊÔ½¸¡Ê£°£¹£µ£¹£±¡¥£¹£²¡¥£¹£³¡Ë
      ******************************************************************
       500-JIBAI-SONOTA-HENSYU-SEC          SECTION.
      *
           INITIALIZE                            WK-4003-TAIGAI.
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¡Ê£´£°£°£³¡Ë¤«¤é¾ÃÈñÀÇÂÐ¾Ý³°¥³¡¼¥É¼èÆÀ
      *
           IF   WK-4001-TAXKBN-KZI   =   "2"
              INITIALIZE                         SYS-4003-REC
              MOVE    "4003"               TO    SYS-4003-KANRICD
              MOVE    "*"                  TO    SYS-4003-KBNCD
              MOVE    LNK-SYU-HOSPNUM      TO    SYS-4003-HOSPNUM
              MOVE    LNK-SYU-SRYYMD       TO    SYS-4003-STYUKYMD
              MOVE    LNK-SYU-SRYYMD       TO    SYS-4003-EDYUKYMD
              MOVE    SYS-4003-REC         TO    MCPDATA-REC
              MOVE    "DBSELECT"           TO    MCP-FUNC
              MOVE    "tbl_syskanri"       TO    MCP-TABLE
              MOVE    "key10"              TO    MCP-PATHNAME
              CALL    "ORCDBMAIN"          USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
              IF      MCP-RC               =     ZERO
                  MOVE     "tbl_syskanri"  TO    MCP-TABLE
                  MOVE     "key10"         TO    MCP-PATHNAME
                  PERFORM   SYSKANRI-READ-SEC
                  IF    MCP-RC             =     ZERO
                     PERFORM   VARYING   IDX8    FROM   1   BY   1
                                UNTIL   (IDX8                 >    50 )
                                  OR    (SYS-4003-SRYCD(IDX8) =  SPACE)
                          MOVE    SYS-4003-SRYCD(IDX8)
                                        TO   WK-4003-TAIGAI-SRYCD(IDX8)
                     END-PERFORM
                  END-IF
              END-IF
      *
              MOVE     "tbl_syskanri"      TO    MCP-TABLE
              MOVE     "key10"             TO    MCP-PATHNAME
              PERFORM   DB-CLOSE-SEC
           END-IF.
      *
      *    ¥³¡¼¥ÉÊÌ¤ËÂàÈò
      *
           INITIALIZE              WK-SONOTA91.
           INITIALIZE              WK-SONOTA92.
           INITIALIZE              WK-SONOTA93.
           MOVE     ZERO      TO   IDX5.
           MOVE     ZERO      TO   IDX6.
           MOVE     ZERO      TO   IDX7.
      *
           PERFORM   VARYING   IDX4    FROM   1   BY   1
                      UNTIL   (IDX4                       >    50 )
                       OR     (LNK-S02-SONOTA-SRYCD(IDX4) =  SPACE)
                 EVALUATE      LNK-S02-SONOTA-SRYCD(IDX4)(1:5)
                    WHEN   "09591"
                       ADD     1     TO   IDX5
                       MOVE    LNK-S02-SONOTA-SRYCD(IDX4)
                                     TO   WK-SONOTA91-SRYCD(IDX5)
                       MOVE    LNK-S02-SONOTA-ZAIKAISU(IDX4)
                                     TO   WK-SONOTA91-ZAIKAISU(IDX5)
                       MOVE    LNK-S02-SONOTA-TANKA(IDX4)
                                     TO   WK-SONOTA91-TANKA(IDX5)
                    WHEN   "09592"
                       ADD     1     TO   IDX6
                       MOVE    LNK-S02-SONOTA-SRYCD(IDX4)
                                     TO   WK-SONOTA92-SRYCD(IDX6)
                       MOVE    LNK-S02-SONOTA-ZAIKAISU(IDX4)
                                     TO   WK-SONOTA92-ZAIKAISU(IDX6)
                       MOVE    LNK-S02-SONOTA-TANKA(IDX4)
                                     TO   WK-SONOTA92-TANKA(IDX6)
                    WHEN   "09593"
                       MOVE     SPACE    TO    FLG-TAIGAI
                       PERFORM  VARYING  IDX8    FROM   1   BY   1
                            UNTIL  (IDX8                       >   50  )
                              OR   (WK-4003-TAIGAI-SRYCD(IDX8) =  SPACE)
                              OR   (FLG-TAIGAI                 =  "1"  )
                         IF   WK-4003-TAIGAI-SRYCD(IDX8)  =
                                         LNK-S02-SONOTA-SRYCD(IDX4)
                              MOVE    "1"     TO    FLG-TAIGAI
                         END-IF
                       END-PERFORM
      *
                       MOVE  LNK-S02-SONOTA-SRYCD(IDX4) TO WK-SRYCD
                       PERFORM TENSU-TBL-SEC
                       IF   TNS-KANANAMECHGKBN  =  ZERO OR 5
                          CONTINUE
                       ELSE
                          COMPUTE  WK-KEISAN  =
                                   LNK-S02-SONOTA-ZAIKAISU(IDX4) *
                                   LNK-S02-SONOTA-TANKA(IDX4)
                          IF  LNK-SYU-RSIETC-MONEY >= WK-KEISAN
                              COMPUTE  LNK-SYU-RSIETC-MONEY =
                                       LNK-SYU-RSIETC-MONEY -
                                       WK-KEISAN
                          ELSE
                              MOVE   ZERO   TO   LNK-SYU-RSIETC-MONEY
                          END-IF
                          IF  LNK-SYU-SRYYMD(1:6)  >=   "201307"
                           EVALUATE  TNS-KANANAMECHGKBN
                            WHEN        1
                              COMPUTE  LNK-SYU-RSISHOSHIN-MONEY =
                                       LNK-SYU-RSISHOSHIN-MONEY +
                                       WK-KEISAN
                            WHEN        4
                              COMPUTE  LNK-SYU-RSIETC-MONEY     =
                                       LNK-SYU-RSIETC-MONEY     +
                                       WK-KEISAN
                              COMPUTE  LNK-S02-KYUKYU           =
                                       LNK-S02-KYUKYU           +
                                       WK-KEISAN
                           END-EVALUATE
                          ELSE
                           EVALUATE  TNS-KANANAMECHGKBN
                            WHEN        1
                            WHEN        4
                              COMPUTE  LNK-SYU-RSISHOSHIN-MONEY =
                                       LNK-SYU-RSISHOSHIN-MONEY +
                                       WK-KEISAN
                           END-EVALUATE
                          END-IF
                          MOVE       "1"     TO    FLG-TAIGAI
                       END-IF
      *
                       IF   FLG-TAIGAI  =  SPACE
                          ADD     1     TO   IDX7
                          MOVE    LNK-S02-SONOTA-SRYCD(IDX4)
                                        TO   WK-SONOTA93-SRYCD(IDX7)
                          MOVE    LNK-S02-SONOTA-ZAIKAISU(IDX4)
                                        TO   WK-SONOTA93-ZAIKAISU(IDX7)
                          MOVE    LNK-S02-SONOTA-TANKA(IDX4)
                                        TO   WK-SONOTA93-TANKA(IDX7)
                       END-IF
                 END-EVALUATE
           END-PERFORM.
      *
      *    Ê¸½ñÎÁ¾ÃÈñÀÇ·×»»
      *
           IF   WK-4001-TAXKBN   =   "2"
      *
                 PERFORM   VARYING   IDX4    FROM   1   BY   1
                            UNTIL   (IDX4                    >    50 )
                              OR    (WK-SONOTA91-SRYCD(IDX4) =  SPACE)
      *
                   COMPUTE  WK-KEISAN  =
                           (WK-SONOTA91-TANKA(IDX4) * WK-S4) + WK-S3
                   COMPUTE  WK-KEISAN  =  WK-KEISAN
                                       *  WK-SONOTA91-ZAIKAISU(IDX4)
                   COMPUTE  LNK-SYU-RSI-TAX-SAI  = LNK-SYU-RSI-TAX-SAI
                                                 + WK-KEISAN
                   COMPUTE  LNK-SYU-RSIETC-MONEY = LNK-SYU-RSIETC-MONEY
                                                 + WK-KEISAN
                   IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE  WK-KEISAN-JIBAI =
                              WK-SONOTA91-TANKA(IDX4)    *
                              WK-SONOTA91-ZAIKAISU(IDX4)
                     COMPUTE  WK-RSIETC-ZEITAISYO = WK-RSIETC-ZEITAISYO
                                                  + WK-KEISAN-JIBAI
                                                  + WK-KEISAN
                   END-IF
      *
                 END-PERFORM
      *
                 PERFORM   VARYING   IDX4    FROM   1   BY   1
                            UNTIL   (IDX4                    >    50 )
                              OR    (WK-SONOTA92-SRYCD(IDX4) =  SPACE)
      *
                   COMPUTE  WK-KEISAN  =
                           (WK-SONOTA92-TANKA(IDX4) * WK-S4) + WK-S3
                   COMPUTE  WK-KEISAN  =  WK-KEISAN
                                       *  WK-SONOTA92-ZAIKAISU(IDX4)
                   COMPUTE  LNK-SYU-RSI-TAX-SAI  = LNK-SYU-RSI-TAX-SAI
                                                 + WK-KEISAN
                   COMPUTE  LNK-SYU-RSIETC-MONEY = LNK-SYU-RSIETC-MONEY
                                                 + WK-KEISAN
                   IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE  WK-KEISAN-JIBAI =
                              WK-SONOTA92-TANKA(IDX4)    *
                              WK-SONOTA92-ZAIKAISU(IDX4)
                     COMPUTE  WK-RSIETC-ZEITAISYO = WK-RSIETC-ZEITAISYO
                                                  + WK-KEISAN-JIBAI
                                                  + WK-KEISAN
                   END-IF
      *
                 END-PERFORM
      *
           END-IF.
      *
      *    ÆÃÄê´ïºàÅù¾ÃÈñÀÇ·×»»
      *
           IF   WK-4001-TAXKBN-KZI   =   "2"
      *
                 PERFORM   VARYING   IDX4    FROM   1   BY   1
                            UNTIL   (IDX4                    >    50 )
                              OR    (WK-SONOTA93-SRYCD(IDX4) =  SPACE)
      *
                   COMPUTE  WK-KEISAN  =
                           (WK-SONOTA93-TANKA(IDX4) * WK-S4) + WK-S3
                   COMPUTE  WK-KEISAN  =  WK-KEISAN
                                       *  WK-SONOTA93-ZAIKAISU(IDX4)
                   COMPUTE  LNK-SYU-RSI-TAX-SAI  = LNK-SYU-RSI-TAX-SAI
                                                 + WK-KEISAN
                   COMPUTE  LNK-SYU-RSIETC-MONEY = LNK-SYU-RSIETC-MONEY
                                                 + WK-KEISAN
                   IF    LNK-SYU-SRYYMD(1:6)       >=   "200704"
                     COMPUTE  WK-KEISAN-JIBAI =
                              WK-SONOTA93-TANKA(IDX4)    *
                              WK-SONOTA93-ZAIKAISU(IDX4)
                     COMPUTE  WK-RSIETC-ZEITAISYO = WK-RSIETC-ZEITAISYO
                                                  + WK-KEISAN-JIBAI
                                                  + WK-KEISAN
                   END-IF
      *
                 END-PERFORM
      *
           END-IF.
      *
       500-JIBAI-SONOTA-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÊÝ¸±»²¾ÈÉôÊ¬³ÎÄê½èÍý                                    *
      ******************************************************************
       100-KAKUTEI-SEC          SECTION.
      *
           MOVE    SPACE              TO  FLG-SANSHOU2
           MOVE    SPACE              TO  FLG-SANSHOU3
           INITIALIZE                     WK-SYOTOKU-SKJKBN-TBL
      *
           IF  (LNK-SYU-SYUHKNNUM = "971" OR "973" OR "975"
                                 OR "068" OR "069" OR "040"  )
           OR  (LNK-SYU-SYUHKNNUM(1:2) = "98" OR "90" OR "91")
             CONTINUE
           ELSE
             INITIALIZE                     ORCSSYOTOKUAREA
             MOVE  LNK-SYU-HOSPNUM      TO  LNK-SYOTOKU-HOSPNUM
             MOVE  LNK-SYU-PTID         TO  LNK-SYOTOKU-PTID
             MOVE  LNK-SYU-SRYYMD(1:6)  TO  LNK-SYOTOKU-SRYYM
             MOVE  "1"                  TO  LNK-SYOTOKU-SKJCHKFLG
      *
             CALL    "ORCSSYOTOKU"      USING  ORCSSYOTOKUAREA
                                               SPA-AREA
      *
             IF    LNK-SYOTOKU-RC    =   ZERO
                IF    LNK-SYU-SRYYMD(1:6)   >=  "200604"
                  MOVE   LNK-SYU-SRYYMD(7:2)  TO  SYOTOKU-IDX
                ELSE
                  MOVE   1                    TO  SYOTOKU-IDX
                END-IF
      *       ¡Ê¼çÊÝ¸±¡¦Á´¹ñ¸øÈñ¡Ë
                MOVE   LNK-SYOTOKU-SYUKBN(SYOTOKU-IDX)
                                              TO  FLG-SANSHOU3
      *       ¡ÊÃÏÊý¸øÈñ¡Ë
                MOVE   LNK-SYOTOKU-CHIKBN(SYOTOKU-IDX)
                                              TO  FLG-SANSHOU2
      *       ¡Ê¿©»ö¡Ë
                PERFORM   VARYING   SYOTOKU-IDX    FROM   1   BY   1
                           UNTIL    SYOTOKU-IDX     >    31
                   MOVE   LNK-SYOTOKU-SKJKBN(SYOTOKU-IDX)
                                    TO  WK-SYOTOKU-SKJKBN(SYOTOKU-IDX)
                END-PERFORM
             END-IF
      *
             EVALUATE   FLG-SANSHOU2
               WHEN     SPACE
                    MOVE     "1"      TO  FLG-SANSHOU2
               WHEN     "2"
               WHEN     "3"
                    MOVE     "2"      TO  FLG-SANSHOU2
               WHEN     "1"
               WHEN     "4"
                    MOVE     "3"      TO  FLG-SANSHOU2
             END-EVALUATE
           END-IF
      *
           .
      *
       100-KAKUTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¼«ÈñÊÝ¸±¤Î¥Ç¡¼¥¿ÊÔ½¸                                *
      ******************************************************************
       104-JIHIHOKEN-DATA-HENSYU-SEC          SECTION.
      *
           IF   (COMB-HKNNUM            NOT =   SPACE     )
           AND  (COMB-SYU-HKNKOHSBTKBN      =   "8"       )
           AND  (WK-1001-JIHIPOSITION   NOT =   "2"       )
           AND  (LNK-S02-SYORI-KBN          =   "8" OR "9")
           AND  (LNK-SYU-SRYYMD(1:6)       >=   "200604"  )
               MOVE   "2"    TO   WK-1001-JIHIPOSITION
           END-IF
      *
           IF   (COMB-HKNNUM            NOT =   SPACE   )
           AND  (COMB-SYU-HKNKOHSBTKBN      =   "8"     )
           AND  (LNK-SYU-SRYYMD(1:6)       >=   "200904")
               PERFORM   VARYING   IDX9    FROM    1   BY  1
                          UNTIL    IDX9       >   17
                  MOVE  LNK-SYU-HKNTEN(IDX9)  TO  LNK-SYU-MONEY (IDX9)
               END-PERFORM
           ELSE
               PERFORM   VARYING   IDX9    FROM    1   BY  1
                          UNTIL    IDX9       >   17
                  MOVE  ZERO                  TO  LNK-SYU-MONEY (IDX9)
               END-PERFORM
           END-IF
      *
           IF  ((COMB-HKNNUM            NOT =   SPACE   ) AND
                (COMB-SYU-HKNKOHSBTKBN      =   "8"     ) AND
                (WK-1001-JIHIPOSITION       =   "2"     ) AND
                (LNK-SYU-SRYYMD(1:6)       >=   "200604"))
           OR  ((COMB-HKNNUM            NOT =   SPACE   ) AND
                (COMB-SYU-HKNKOHSBTKBN      =   "8"     ) AND
                (WK-1001-JIHIPOSITION   NOT =   "2"     ) AND
                (COMB-HOJOKBN               =   "1"     ) AND
                (LNK-SYU-SRYYMD(1:6)       >=   "200704"))
           OR  ((COMB-HKNNUM            NOT =   SPACE   ) AND
                (COMB-SYU-HKNKOHSBTKBN      =   "9"     ) AND
                (COMB-HOJOKBN               =   "1"     ) AND
                (LNK-SYU-SRYYMD(1:6)       >=   "200704"))
      *
      *      ³ºÅöÊÝ¸±ÈÖ¹æ¥Æ¡¼¥Ö¥ë¤Î¸¡º÷
             INITIALIZE                      HKNNUM-REC
             MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
             MOVE   COMB-HKNNUM        TO    HKN-HKNNUM
             MOVE   "00"               TO    WK-PAYKBN
             MOVE   HKNNUM-REC         TO    MCPDATA-REC
             MOVE   "DBSELECT"         TO    MCP-FUNC
             MOVE   "tbl_hknnum"       TO    MCP-TABLE
             MOVE   "key2"             TO    MCP-PATHNAME
             CALL   "ORCDBMAIN"        USING MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
             IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"  TO    MCP-TABLE
                 MOVE    "key2"        TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                  ( FLG-HKNNUM           =  1                   ) OR
                  ((HKN-TEKSTYMD(1:6)   <=  LNK-SYU-SRYYMD(1:6)) AND
                   (LNK-SYU-SRYYMD(1:6) <=  HKN-TEKEDYMD(1:6)  ) AND
                   (WK-PAYKBN            =  HKN-PAYKBN         ))
                     MOVE     "tbl_hknnum"  TO    MCP-TABLE
                     MOVE     "key2"        TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
             END-IF
      *
             MOVE     "tbl_hknnum"  TO    MCP-TABLE
             MOVE     "key2"        TO    MCP-PATHNAME
             PERFORM   DB-CLOSE-SEC
      *
             IF  HKN-TENTNK   =   ZERO
                 MOVE     10      TO      HKN-TENTNK
             END-IF
      *
             IF   COMB-HONKZKKBN        =   "1"
               IF  HKN-HON-NYUKFTNRATE   NOT =   ZERO
                  IF  HKN-TENTNK   =   10
                      COMPUTE  WK-JIHIFTN   =
                               HKN-HON-NYUKFTNRATE  /  100
                  ELSE
                      MOVE       1     TO      WK-JIHIFTN
                  END-IF
               ELSE
                  MOVE     ZERO        TO      WK-JIHIFTN
               END-IF
             ELSE
               IF  HKN-KZK-NYUKFTNRATE   NOT =   ZERO
                  IF  HKN-TENTNK   =   10
                      COMPUTE  WK-JIHIFTN   =
                               HKN-KZK-NYUKFTNRATE  /  100
                  ELSE
                      MOVE       1     TO      WK-JIHIFTN
                  END-IF
               ELSE
                  MOVE     ZERO        TO      WK-JIHIFTN
               END-IF
             END-IF
      *
             IF     WK-JIHIFTN    NOT =    ZERO
               PERFORM   VARYING   IDX9    FROM    1   BY  1
                          UNTIL    IDX9       >   17
                 IF   (LNK-SYU-SRYYMD(1:6)       >=   "200704")
                 AND  (COMB-HOJOKBN               =   "1"     )
                    COMPUTE WK-JIHIGAKU   =
                            LNK-SYU-HKNTEN (IDX9) *  HKN-TENTNK
                    COMPUTE WK-JIHIGAKU2  =
                            WK-JIHIGAKU           *  WK-JIHIFTN
                    COMPUTE WK-JIHIGAKU3  =
                           (WK-JIHIGAKU2  *  WK-S4) + WK-S3
                    COMPUTE  WK-JIHIGAKU4  =  WK-JIHIGAKU2
                                           +  WK-JIHIGAKU3
                    IF   WK-JIHIGAKU   >  9999999
                    OR   WK-JIHIGAKU2  >  9999999
                    OR   WK-JIHIGAKU3  >  9999999
                    OR   WK-JIHIGAKU4  >  9999999
                      MOVE  "2"  TO  LNK-S02-SKYCHKFLG
                    END-IF
                    IF    IDX9  =  17
                       MOVE   ZERO  TO  WK-JIHIGAKU2
                       MOVE   ZERO  TO  WK-JIHIGAKU3
                    END-IF
                    IF   (COMB-SYU-HKNKOHSBTKBN =   "8")
                    AND  (WK-1001-JIHIPOSITION  =   "2")
                       COMPUTE LNK-SYU-TGMONEY-TAX(IDX9) =
                               LNK-SYU-TGMONEY-TAX(IDX9) + WK-JIHIGAKU2
                                                         + WK-JIHIGAKU3
                       MOVE    ZERO    TO      LNK-SYU-HKNTEN(IDX9)
                       ADD     WK-JIHIGAKU2
                                       TO      LNK-SYU-JYO-COMPFTN
                       ADD     WK-JIHIGAKU3
                                       TO      LNK-SYU-JYO-COMPFTN
                    ELSE
                       COMPUTE WK-SKYMONEY-ZEI = WK-SKYMONEY-ZEI
                                               + WK-JIHIGAKU3
                    END-IF
                 ELSE
                    COMPUTE WK-JIHIGAKU   =
                            LNK-SYU-HKNTEN (IDX9) *  HKN-TENTNK
                    COMPUTE WK-JIHIGAKU2  =
                            WK-JIHIGAKU           *  WK-JIHIFTN
                    IF   WK-JIHIGAKU   >  9999999
                    OR   WK-JIHIGAKU2  >  9999999
                      MOVE  "2"  TO  LNK-S02-SKYCHKFLG
                    END-IF
                    IF    IDX9  =  17
                       MOVE   ZERO  TO  WK-JIHIGAKU2
                    END-IF
                    COMPUTE LNK-SYU-TGMONEY(IDX9) =
                            LNK-SYU-TGMONEY(IDX9) +  WK-JIHIGAKU2
                    MOVE    ZERO    TO      LNK-SYU-HKNTEN(IDX9)
                    ADD     WK-JIHIGAKU2
                                    TO      LNK-SYU-JYO-COMPFTN
                 END-IF
               END-PERFORM
             END-IF
      *
           END-IF
      *
           .
      *
       104-JIHIHOKEN-DATA-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»¤Î¾å¸Â¶èÊ¬ÊÔ½¸                                *
      ******************************************************************
       105-JYOGENKBN-HENSYU-SEC          SECTION.
      *
           MOVE    SPACE    TO   COMB-KOH1-NYUJGNKBN.
           MOVE    SPACE    TO   COMB-KOH2-NYUJGNKBN.
           MOVE    SPACE    TO   COMB-KOH3-NYUJGNKBN.
           MOVE    SPACE    TO   COMB-KOH4-NYUJGNKBN.
      *
           MOVE    ZERO     TO   FLG-FTNRATE100.
      *
      *    ¸øÈñ£±¤Î¾å¸Â¶èÊ¬ÊÔ½¸
           IF  COMB-KOH1HKNNUM           NOT =  SPACE
      *
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH1HKNNUM    TO    HKN-HKNNUM
               IF     COMB-KOH1HKNNUM    =     "027"
                       MOVE     COMB-KOH1PAYKBN
                                         TO    WK-PAYKBN
               ELSE
                       MOVE     "00"     TO    WK-PAYKBN
               END-IF
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                       OR
                  ((HKN-TEKSTYMD(1:6)     <=  LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <=  HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            =  HKN-PAYKBN))
                     MOVE     "tbl_hknnum"  TO    MCP-TABLE
                     MOVE     "key2"        TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   1051-JYOGENKBN-CHECK-SEC
                        MOVE   WK-NYUJGNKBN  TO  COMB-KOH1-NYUJGNKBN
      *
                        IF  (COMB-KOH1HKNNUM(1:1) >=  "1")
                        AND (COMB-KOH1HKNNUM(1:1) <=  "8")
                        AND (WK-SYOUKAN-FTNRATE    =  100)
                           MOVE    1     TO    FLG-FTNRATE100
                        END-IF
      *
                        IF  (COMB-KOH1HKNNUM(1:1) >=  "1")
                        AND (COMB-KOH1HKNNUM(1:1) <=  "8")
                           MOVE  HKN-HBTNUM  TO  WK-HBTNUM(1)
                        END-IF
                 END-IF
               END-IF
      *
               MOVE    "tbl_hknnum"      TO    MCP-TABLE
               MOVE    "key2"            TO    MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
      *    ¸øÈñ£²¤Î¾å¸Â¶èÊ¬ÊÔ½¸
           IF  COMB-KOH2HKNNUM           NOT = SPACE
      *
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH2HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                      OR
                  ((HKN-TEKSTYMD(1:6)     <= LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <= HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            = HKN-PAYKBN))
                     MOVE     "tbl_hknnum" TO    MCP-TABLE
                     MOVE     "key2"       TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   1051-JYOGENKBN-CHECK-SEC
                        MOVE   WK-NYUJGNKBN  TO  COMB-KOH2-NYUJGNKBN
      *
                        IF  (COMB-KOH2HKNNUM(1:1) >=  "1")
                        AND (COMB-KOH2HKNNUM(1:1) <=  "8")
                        AND (WK-SYOUKAN-FTNRATE    =  100)
                           MOVE    2     TO    FLG-FTNRATE100
                        END-IF
      *
                        IF  (COMB-KOH2HKNNUM(1:1) >=  "1")
                        AND (COMB-KOH2HKNNUM(1:1) <=  "8")
                           MOVE  HKN-HBTNUM  TO  WK-HBTNUM(2)
                        END-IF
                 END-IF
               END-IF
      *
               MOVE    "tbl_hknnum"      TO    MCP-TABLE
               MOVE    "key2"            TO    MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
      *    ¸øÈñ£³¤Î¾å¸Â¶èÊ¬ÊÔ½¸
           IF  COMB-KOH3HKNNUM           NOT = SPACE
      *
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH3HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                      OR
                  ((HKN-TEKSTYMD(1:6)     <= LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <= HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            = HKN-PAYKBN))
                     MOVE     "tbl_hknnum" TO    MCP-TABLE
                     MOVE     "key2"       TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   1051-JYOGENKBN-CHECK-SEC
                        MOVE   WK-NYUJGNKBN  TO  COMB-KOH3-NYUJGNKBN
      *
                        IF  (COMB-KOH3HKNNUM(1:1) >=  "1")
                        AND (COMB-KOH3HKNNUM(1:1) <=  "8")
                        AND (WK-SYOUKAN-FTNRATE    =  100)
                           MOVE    3     TO    FLG-FTNRATE100
                        END-IF
      *
                        IF  (COMB-KOH3HKNNUM(1:1) >=  "1")
                        AND (COMB-KOH3HKNNUM(1:1) <=  "8")
                           MOVE  HKN-HBTNUM  TO  WK-HBTNUM(3)
                        END-IF
                 END-IF
               END-IF
      *
               MOVE    "tbl_hknnum"      TO    MCP-TABLE
               MOVE    "key2"            TO    MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
      *    ¸øÈñ£´¤Î¾å¸Â¶èÊ¬ÊÔ½¸
           IF  COMB-KOH4HKNNUM           NOT = SPACE
      *
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH4HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                       OR
                  ((HKN-TEKSTYMD(1:6)     <= LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <= HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            = HKN-PAYKBN))
                     MOVE     "tbl_hknnum" TO    MCP-TABLE
                     MOVE     "key2"       TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   1051-JYOGENKBN-CHECK-SEC
                        MOVE   WK-NYUJGNKBN  TO  COMB-KOH4-NYUJGNKBN
      *
                        IF  (COMB-KOH4HKNNUM(1:1) >=  "1")
                        AND (COMB-KOH4HKNNUM(1:1) <=  "8")
                        AND (WK-SYOUKAN-FTNRATE    =  100)
                           MOVE    4     TO    FLG-FTNRATE100
                        END-IF
      *
                        IF  (COMB-KOH4HKNNUM(1:1) >=  "1")
                        AND (COMB-KOH4HKNNUM(1:1) <=  "8")
                           MOVE  HKN-HBTNUM  TO  WK-HBTNUM(4)
                        END-IF
                 END-IF
               END-IF
      *
               MOVE    "tbl_hknnum"  TO    MCP-TABLE
               MOVE    "key2"        TO    MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
       105-JYOGENKBN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»¤Î¾å¸Â¶èÊ¬¥Á¥§¥Ã¥¯                                *
      ******************************************************************
       1051-JYOGENKBN-CHECK-SEC           SECTION.
      *
           MOVE     SPACE     TO    WK-NYUJGNKBN.
           MOVE     ZERO      TO    WK-SYOUKAN-FTNRATE.
      *
           IF    HKN-HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                      IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                      OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                      OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                      END-IF
                      MOVE HKN-HON-NYUKFTNRATE TO WK-SYOUKAN-FTNRATE
                 WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                        MOVE HKN-HON-NYUKFTNRATE TO WK-SYOUKAN-FTNRATE
                      ELSE
                        IF   HKN-TSY-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-TSY-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-TSY-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                        MOVE HKN-TSY-NYUKFTNRATE TO WK-SYOUKAN-FTNRATE
                      END-IF
                 WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                        MOVE HKN-HON-NYUKFTNRATE TO WK-SYOUKAN-FTNRATE
                      ELSE
                        IF   HKN-TNK-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-TNK-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-TNK-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                        MOVE HKN-TNK-NYUKFTNRATE TO WK-SYOUKAN-FTNRATE
                      END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  26  OR  27  OR
                                          34  OR  12  OR  19      ) AND
                   ( HKN-HKNNUM        = "141"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( HKN-HKNNUM        = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( HKN-HKNNUM        = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( HKN-HKNNUM        = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  31                      ) AND
                   ( HKN-HKNNUM(1:1)  >=  "1"  AND  <=  "8"       ))
               OR (( WK-1001-PREFNUM   =  10                      ) AND
                   ( HKN-HKNNUM        = "155"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( HKN-HKNNUM        = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( HKN-HKNNUM        = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  23  OR  14  OR  30      ) AND
                   ( HKN-HKNNUM        = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  01                      ) AND
                   ( HKN-HKNNUM        = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   <=   "200803"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                      OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                      OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                      END-IF
                      MOVE HKN-HON-NYUKFTNRATE TO WK-SYOUKAN-FTNRATE
                   WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                        MOVE HKN-HON-NYUKFTNRATE TO WK-SYOUKAN-FTNRATE
                      ELSE
                        IF   HKN-TSY-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-TSY-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-TSY-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                        MOVE HKN-TSY-NYUKFTNRATE TO WK-SYOUKAN-FTNRATE
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                        MOVE HKN-HON-NYUKFTNRATE TO WK-SYOUKAN-FTNRATE
                      ELSE
                        IF   HKN-TNK-NYUMJGNGAK  NOT = ZERO
                        OR   HKN-TNK-NYUMJGNCNT  NOT = ZERO
                        OR   HKN-TNK-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                        END-IF
                        MOVE HKN-TNK-NYUKFTNRATE TO WK-SYOUKAN-FTNRATE
                      END-IF
                 END-EVALUATE
               ELSE
                 IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
                 OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
                 OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
                 END-IF
                 MOVE HKN-HON-NYUKFTNRATE TO WK-SYOUKAN-FTNRATE
               END-IF
             END-IF
           ELSE
             IF   HKN-HON-NYUMJGNGAK  NOT = ZERO
             OR   HKN-HON-NYUMJGNCNT  NOT = ZERO
             OR   HKN-HON-NYUDJGNGAK  NOT = ZERO
                             MOVE     "1"      TO     WK-NYUJGNKBN
             END-IF
             MOVE HKN-HON-NYUKFTNRATE TO WK-SYOUKAN-FTNRATE
           END-IF.
      *
           IF     (WK-1001-PREFNUM         =  43           ) AND
                  (HKN-HKNNUM              = "343"         ) AND
                  (LNK-SYU-SRYYMD(1:6)    >= "201204"      )
                             MOVE     "1"      TO     WK-NYUJGNKBN
           END-IF.
      *
       1051-JYOGENKBN-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÊÝ¸±ÉéÃ´³Û»»Äê½èÍý                                      *
      ******************************************************************
       200-HKNFTN-SANTEI-SEC          SECTION.
      *
           MOVE    SPACE                 TO    HOKEN-MAX-AREA
                                               HOKEN-KAISU-TABLE
                                               HOKEN-KAISU-TABLE2
                                               HOKEN-FUTAN-AREA
                                               HOKEN-FUTAN-AREA2
                                               HOKEN-FUTAN-AREA3
                                               HOKEN-ZAN-AREA
                                               HOKEN-ZAN-AREA2
                                               HOKEN-ZAN-AREA3
                                               HOKEN-ZAN-D-AREA
                                               HOKEN-ZAN-D2-AREA
                                               HOKEN-ZAN-D3-AREA
                                               HOKEN-SKJFUTAN-AREA
                                               HOKEN-SKJZAN-AREA
           INITIALIZE                          HOKEN-MAX-AREA
                                               HOKEN-KAISU-TABLE
                                               HOKEN-KAISU-TABLE2
                                               HOKEN-FUTAN-AREA
                                               HOKEN-FUTAN-AREA2
                                               HOKEN-FUTAN-AREA3
                                               HOKEN-ZAN-AREA
                                               HOKEN-ZAN-AREA2
                                               HOKEN-ZAN-AREA3
                                               HOKEN-ZAN-D-AREA
                                               HOKEN-ZAN-D2-AREA
                                               HOKEN-ZAN-D3-AREA
                                               HOKEN-SKJFUTAN-AREA
                                               HOKEN-SKJZAN-AREA
           MOVE    ALL"9"                TO    WK-KOH-COMPFTN-AREA
                                               WK-DAY-KOH-COMPFTN-AREA
      *
           INITIALIZE    WK-SYUHKN-TAIHI-AREA
           INITIALIZE    WK-TAIHI-IRYOKEIKBNINF-OCC
      *
           PERFORM       2003-PTHKNINF-KENSAKU-SEC
      *
           PERFORM       2005-SYSKAN2010-HENSYU-SEC
      *
           PERFORM       2004-TAISYOKBN-HENSYU-SEC
      *
      *    ¸øÈñÃ±ÆÈ¤ÇÏ·¿ÍÊÝ¸±ÆþÎÏ¤¬¤¢¤ë¤«¥Á¥§¥Ã¥¯
           IF      COMB-HKNNUM          =   SPACE
                IF   LNK-SYU-SRYYMD(1:6)  >=   "200804"
                     MOVE   "968"   TO  WK-KOHNUM
                ELSE
                     MOVE   "027"   TO  WK-KOHNUM
                END-IF
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    WK-KOHNUM            TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF      PTKOH-TEKSTYMD(1:6)  <=
                                                 LNK-SYU-SRYYMD(1:6)
                        AND     LNK-SYU-SRYYMD(1:6)  <=
                                                 PTKOH-TEKEDYMD(1:6)
                        AND     PTKOH-SAKJOKBN   =  SPACE
                           MOVE   "1"           TO  FLG-ROUJINHOKEN
                           MOVE    1            TO  FLG-PTKOHINF     
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF   
                    END-PERFORM
                END-IF
      *
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key4"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF
      *
           MOVE      ZERO       TO    FLG-KENPOJYUNKYO
                                      FLG-SYUGAKUMAE
           MOVE      SPACE      TO    WK-BIRTHDAY
           IF    LNK-SYU-SRYYMD(1:6)    >=   "200210"
      *        ´µ¼ÔÇ¯Îð·×»»
               INITIALIZE                           PTINF-REC
               MOVE    LNK-SYU-HOSPNUM      TO      PTINF-HOSPNUM
               MOVE    LNK-SYU-PTID         TO      PTINF-PTID
               MOVE    PTINF-REC            TO      MCPDATA-REC
               MOVE    "DBSELECT"           TO      MCP-FUNC
               MOVE    "tbl_ptinf"          TO      MCP-TABLE
               MOVE    "key"                TO      MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING   MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptinf"      TO      MCP-TABLE
                   MOVE    "key"            TO      MCP-PATHNAME
                   PERFORM  PTINF-READ-SEC
               ELSE
                   DISPLAY   "PTINF SELECT ERR"
                   INITIALIZE                   PTINF-REC
               END-IF
      *
               MOVE    "tbl_ptinf"          TO      MCP-TABLE
               MOVE    "key"                TO      MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
               MOVE    PTINF-BIRTHDAY    TO  WK-BIRTHDAY
      *
               INITIALIZE                    ORCSAGECHKAREA
               MOVE    LNK-SYU-HOSPNUM   TO  AGECHK-HOSPNUM
               MOVE    LNK-SYU-PTID      TO  AGECHK-PTID
               MOVE    LNK-SYU-SRYYMD    TO  AGECHK-SRYYMD
               MOVE    PTINF-BIRTHDAY    TO  AGECHK-BIRTHDAY
               MOVE    LNK-SYU-HKNCOMBINUM
                                         TO  AGECHK-HKNCOMBINUM
               MOVE    LNK-SYU-NYUGAIKBN TO  AGECHK-NYUGAIKBN
               CALL    "ORCSAGECHK"          USING
                                             ORCSAGECHKAREA
                                             SPA-AREA
               IF      AGECHK-RC       =   ZERO
                   IF  ( AGECHK-NENREI   >=  70      ) OR
                       ( AGECHK-NENREI   >=  65  AND
                         COMB-KOH1HKNNUM  = "027"    ) OR
      ***              ( AGECHK-NENREI   >=  65  AND
      ***                FLG-ROUJINHOKEN  = "1"      ) OR
      ***              ( AGECHK-NENREI   >=  65  AND
      ***                COMB-HKNNUM      = "039"    )
                       ( FLG-ROUJINHOKEN  = "1"      ) OR
                       ( COMB-HKNNUM      = "039"    )
                     IF  LNK-S02-KOUREI-NYUIN-KBN     =   SPACE
                       MOVE  "1"     TO  LNK-S02-KOUREI-NYUIN-KBN
                     END-IF
                   ELSE
                     IF  LNK-S02-KOUREI-NYUIN-KBN     =   "1"
                       MOVE  SPACE   TO  LNK-S02-KOUREI-NYUIN-KBN
                     END-IF
                   END-IF
                   MOVE   AGECHK-FTNRATE  TO  LNK-SYU-PTFTNRATE
                   IF    WK-HKNKBN        =  "1"
                     IF   AGECHK-HKNKBN   =   4  OR  5
                       MOVE     1         TO  FLG-KENPOJYUNKYO
                     END-IF
                   END-IF
                   MOVE   AGECHK-SYUGAKUKBN
                                          TO  FLG-SYUGAKUMAE
               ELSE
                   DISPLAY  "PTINF AGE-CHK ERR " LNK-SYU-PTID
                   MOVE  SPACE       TO  LNK-S02-KOUREI-NYUIN-KBN
               END-IF
           END-IF
      *
      *    ¹âÎðÈó³ºÅö¼Ô
           MOVE      ZERO     TO    FLG-KOREI-HIGAITO
           IF   (LNK-S02-KOUREI-NYUIN-KBN   = "1"  )
           AND  (AGECHK-NENREI             >=  70  )
             IF  (COMB-HKNNUM                =   SPACE   )
             OR  (COMB-SYU-HKNKOHSBTKBN    = "8" OR "9"  )
             OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                                        OR "040" OR "039"
                                        OR "068" OR "069")
                CONTINUE
             ELSE
              IF ( COMB-HKNNUM      = "060"           )
              OR ((COMB-HKNNUM  NOT = "060"          ) AND
                  (COMB-HOJOKBN     = SPACE          ))
                INITIALIZE                     PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM    TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID       TO  PTKOH-PTID
                MOVE    "976"              TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC       TO  MCPDATA-REC
                MOVE    "DBSELECT"         TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                MOVE    "key4"             TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"        USING  MCPAREA
                                                  MCPDATA-REC
                                                  SPA-AREA
                IF      MCP-RC             =   ZERO
                  MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                  MOVE    "key4"           TO  MCP-PATHNAME
                  PERFORM  PTKOHINF-READ-SEC
                  PERFORM  UNTIL   FLG-PTKOHINF    =   1
                    IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                    AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                    AND (PTKOH-SAKJOKBN   =  SPACE         )
                       MOVE    1           TO  FLG-KOREI-HIGAITO
                       MOVE    SPACE       TO  LNK-S02-KOUREI-NYUIN-KBN
                       MOVE    1           TO  FLG-PTKOHINF
                    ELSE
                       MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                       MOVE    "key4"          TO  MCP-PATHNAME
                       PERFORM  PTKOHINF-READ-SEC
                    END-IF
                  END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                MOVE    "key4"             TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-IF
             END-IF
           END-IF
      *
           IF     (LNK-S02-KOUREI-NYUIN-KBN  =  "1"       )
           AND    (LNK-SYU-SRYYMD(1:6)      >=  "201204"  )
           AND    (COMB-HOJOKBN              =  "3" OR "7")
           AND    (FLG-SANSHOU3          NOT =   SPACE    )
                   MOVE  SPACE       TO  FLG-SANSHOU3
           END-IF
      *
           MOVE     ZERO             TO  FLG-DAISAN-KOREI
           IF   LNK-S02-KOUREI-NYUIN-KBN   =  "1"
               IF  COMB-SYU-HKNKOHSBTKBN   =  "8" OR "9"
                   MOVE  SPACE       TO  LNK-S02-KOUREI-NYUIN-KBN
               END-IF
               IF  COMB-HKNNUM  =  "971" OR "973" OR "975"
                                OR "068" OR "069" OR "040"
                   MOVE  SPACE       TO  LNK-S02-KOUREI-NYUIN-KBN
               END-IF
               IF  COMB-KOH1HKNNUM     =  "970"
               AND FLG-DAISAN-GENBUTU  =   ZERO
                   MOVE  SPACE       TO  LNK-S02-KOUREI-NYUIN-KBN
                   MOVE   1          TO  FLG-DAISAN-KOREI
               END-IF
           END-IF                                               
      *
           MOVE    ZERO              TO  FLG-KOREI-TANYUIN
           IF  (LNK-S02-KOUREI-NYUIN-KBN   =  "1"     )
           AND (LNK-S02-KOREI-TANYUIN      =  "1"     )
           AND (LNK-SYU-SRYYMD(1:6)       >=  "200904")
           AND (LNK-SYU-SRYYMD(1:6)       <=  "201203")
               MOVE    1    TO    LNK-SYU-SKJ-FTNGAKU(3)
               IF  (COMB-KOH1HKNNUM  = "972" OR "974")
               OR  (COMB-KOH2HKNNUM  = "972" OR "974")
               OR  (COMB-KOH3HKNNUM  = "972" OR "974")
               OR  (COMB-KOH4HKNNUM  = "972" OR "974")
                   CONTINUE
               ELSE
                   MOVE  SPACE       TO  LNK-S02-KOUREI-NYUIN-KBN
                   MOVE    1         TO  FLG-KOREI-TANYUIN
               END-IF
           END-IF
      *
      *    ¼«ÇåÀÕ¡¦ÎÅÍÜÃ´Åö¼êÅöÍÑÆÃÎã½èÍý
      *    ¡Ê¼«ÇåÀÕ¤Î¾ì¹ç¡¢£±£°ÅÀ¤ò£±£²£°±ß¤ËÆÉ¤ßÂØ¤¨¤ë¡Ë
      *    ¡ÊÎÅÍÜÃ´Åö¼êÅö¡§£±·î£±²ó¤Î»»Äê¡Ë
           IF    LNK-SYU-SYUHKNNUM       =    "973"
           AND   LNK-S02-RYOYO       NOT =    ZERO
           AND   FLG-KENPOJYUNKYO        =    ZERO
               COMPUTE  LNK-SYU-HKNTEN (16)  =  LNK-SYU-HKNTEN (16)
                                             -  LNK-S02-RYOYO
               COMPUTE  LNK-SYU-HKNTEN (17)  =  LNK-SYU-HKNTEN (17)
                                             -  LNK-S02-RYOYO
      *
               COMPUTE  WK-RYOYO  =  LNK-S02-RYOYO  /   10
      *
               COMPUTE  LNK-SYU-RSIETC-MONEY =  LNK-SYU-RSIETC-MONEY
                                             +  ( 120 *  WK-RYOYO )
           END-IF
      *
      *    Á°´ü¹âÎð¼Ô¡Ê£·£°ºÐ¡Á£·£´ºÐ¡Ë
           MOVE      ZERO       TO    FLG-ZENKI-TOKUREI
           IF    LNK-SYU-SRYYMD(1:6)    >=   "200804"
           AND   LNK-SYU-SRYYMD(1:6)    <=   "201903"
             IF  (COMB-HKNNUM                =   SPACE   )
             OR  (COMB-SYU-HKNKOHSBTKBN    = "8" OR "9"  )
             OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                               OR "068" OR "069" OR "040"
                                                 OR "039")
             OR  (AGECHK-NENREI         <     70         )
      ***    OR  (AGECHK-NENREI         >     74         )
             OR  (FLG-KOREI-HIGAITO     =      1         )
               CONTINUE
             ELSE
               IF  (COMB-HOJOKBN  =  "1"  OR  "9")
               AND (WK-BIRTHDAY   <  "19440402"  )
                  MOVE    1     TO    FLG-ZENKI-TOKUREI
               END-IF
             END-IF
           END-IF
      *
      *    °ìÈÌ·Ð²áÁ¼ÃÖÂÐ¾Ý¼Ô
           MOVE      ZERO     TO    FLG-KEIKASOCHI-IPAN
           IF  (LNK-S02-KOUREI-NYUIN-KBN      =   "1"    )
           AND (LNK-SYU-SRYYMD(1:6)          >=  "200608")
           AND (LNK-SYU-SRYYMD(1:6)          <=  "200812")
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "978"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                     MCPDATA-REC
                                                     SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD(1:6)  <=
                                                 LNK-SYU-SRYYMD(1:6))
                        AND (LNK-SYU-SRYYMD(1:6)  <=
                                                 PTKOH-TEKEDYMD(1:6))
                        AND (PTKOH-SAKJOKBN   =  SPACE              )
                           MOVE    1         TO  FLG-KEIKASOCHI-IPAN
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF
      *
      *    ¸º³Û¡¦ÌÈ½ü¡¦»ÙÊ§Í±Í½ÂÐ¾Ý¼Ô
           MOVE     ZERO     TO     WK-GENGAKUKBN
           MOVE     ZERO     TO     WK-GENGAKUKBN-KEISAN
           MOVE     ZERO     TO     WK-GENGAKU-KOHID
           MOVE     ZERO     TO     FLG-SAIGAI-TAISYO
      *
           IF  ((LNK-SYU-SRYYMD(1:6)       >=  "200610") AND
                (COMB-HKNNUM            NOT =   SPACE  ))
           OR  ( LNK-SYU-SRYYMD(1:6)       >=  "201101" )
      *
            IF  (COMB-SYU-HKNKOHSBTKBN   =  "8" OR "9"  )
            OR  (COMB-HKNNUM  =  "971" OR "973" OR "975")
            OR  (COMB-KOH1HKNNUM  =  "970"              )
              CONTINUE
            ELSE
              PERFORM   VARYING   GEN-IDX   FROM   1    BY   1
                         UNTIL   (GEN-IDX    >    TBL-GENGAKU-MAX)
                           OR    (WK-GENGAKUKBN   NOT = ZERO     )
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    TBL-GENGAKU(GEN-IDX) TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           EVALUATE   GEN-IDX
                             WHEN        1
                               MOVE    1     TO  WK-GENGAKUKBN
                               MOVE   PTKOH-KOHID
                                             TO  WK-GENGAKU-KOHID
                             WHEN        2
                               MOVE    2     TO  WK-GENGAKUKBN
                               MOVE   PTKOH-KOHID
                                             TO  WK-GENGAKU-KOHID
                             WHEN        3
                               MOVE    3     TO  WK-GENGAKUKBN
                             WHEN        4
                               MOVE    4     TO  WK-GENGAKUKBN
                             WHEN        5
                               MOVE    5     TO  WK-GENGAKUKBN
                               MOVE   PTKOH-KOHID
                                             TO  WK-GENGAKU-KOHID
                           END-EVALUATE
      *
                           IF     WK-GENGAKUKBN       =  1
                             IF   PTKOH-FTNJANUM(1:1) = "1"
                               MOVE    1     TO  WK-GENGAKUKBN-KEISAN
                             END-IF
                             IF   PTKOH-FTNJANUM(1:1) = "2"
                               MOVE    2     TO  WK-GENGAKUKBN-KEISAN
                             END-IF
                           END-IF
      *
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-PERFORM
      *
              IF    LNK-SYU-SRYYMD(1:6)  >=  "201101"
                INITIALIZE                     PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM    TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID       TO  PTKOH-PTID
                MOVE    "959"              TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC       TO  MCPDATA-REC
                MOVE    "DBSELECT"         TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                MOVE    "key4"             TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"        USING  MCPAREA
                                                  MCPDATA-REC
                                                  SPA-AREA
                IF      MCP-RC   =    ZERO
                  MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                  MOVE    "key4"           TO  MCP-PATHNAME
                  PERFORM  PTKOHINF-READ-SEC
                  PERFORM  UNTIL   FLG-PTKOHINF    =   1
                    IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                    AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                    AND (PTKOH-SAKJOKBN   =  SPACE         )
                      MOVE     1           TO  FLG-SAIGAI-TAISYO
                      MOVE     1           TO  FLG-PTKOHINF
                    ELSE
                      MOVE  "tbl_ptkohinf" TO  MCP-TABLE
                      MOVE  "key4"         TO  MCP-PATHNAME
                      PERFORM  PTKOHINF-READ-SEC
                    END-IF
                  END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                MOVE    "key4"             TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-IF
            END-IF
      *
            IF   (WK-GENGAKUKBN        =   2      )
            AND  (LNK-SYU-SRYYMD(1:6)  <  "201204")
                   MOVE     ZERO    TO    WK-GENGAKUKBN
            END-IF
            IF  (COMB-HKNNUM  =   SPACE                 )
            OR  (COMB-HKNNUM  =  "068" OR "069" OR "040")
              IF  (WK-GENGAKUKBN      =   3 OR 4)
              AND (FLG-SAIGAI-TAISYO  =   1     )
                   CONTINUE
              ELSE
                   MOVE     ZERO    TO    WK-GENGAKUKBN
              END-IF
            END-IF
            IF   COMB-HKNNUM  =  "004"
              IF  WK-HKNJANUM(1:4) = "0404"
                   CONTINUE
              ELSE
                   MOVE     ZERO    TO    WK-GENGAKUKBN
              END-IF
            END-IF
      *
            IF   (FLG-SAIGAI-TAISYO     =    1     )
            AND  (WK-GENGAKUKBN         =    3 OR 4)
            AND  (LNK-SYU-SRYYMD(1:6)  <=  "201202")
              EVALUATE   WK-GENGAKUKBN
                WHEN        3
                      MOVE    7       TO    LNK-SYU-YKZKENNUM
                WHEN        4
                      MOVE    8       TO    LNK-SYU-YKZKENNUM
              END-EVALUATE
            ELSE
              MOVE   WK-GENGAKUKBN    TO    LNK-SYU-YKZKENNUM
            END-IF
      *
           END-IF
      *
      *    ¹â³Û°ÑÇ¤Ê§¤¤À©ÅÙÂÐ¾Ý¼Ô
           MOVE      ZERO     TO    FLG-KOHININBARAI
           MOVE      ZERO     TO    WK-KOHININBARAI-KOHID
           MOVE      SPACE    TO    WK-KOHININBARAI-JKYSNUM
           IF   LNK-S02-KOUREI-NYUIN-KBN      =   "1"
                CONTINUE
           ELSE
            IF   (COMB-HKNNUM      NOT =  SPACE         )
            AND  (COMB-KOH1HKNNUM      =  SPACE OR "970")
            AND  (COMB-KOH2HKNNUM      =  SPACE         )
            AND  (COMB-KOH3HKNNUM      =  SPACE         )
            AND  (COMB-KOH4HKNNUM      =  SPACE         )
              IF  (COMB-SYU-HKNKOHSBTKBN   =  "8" OR "9"  )
              OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                                OR "068" OR "069" OR "040")
              OR  (COMB-KOH1HKNNUM         =  "970"       )
                CONTINUE
              ELSE
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "964"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           MOVE    1         TO  FLG-KOHININBARAI
                           MOVE   PTKOH-KOHID
                                             TO  WK-KOHININBARAI-KOHID
                           MOVE   PTKOH-JKYSNUM
                                         TO  WK-KOHININBARAI-JKYSNUM
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-IF
            END-IF
           END-IF
      *
      *    ÆÃÄê¼À´µÅù¤ÎÈ½Äê
           PERFORM  2002-TOKUSITU-HANTEI-SEC
      *
      *    £·£°ºÐÌ¤Ëþ¹â³Û¸½ÊªµëÉÕÂÐ¾Ý¼Ô
           MOVE      ZERO     TO    FLG-GENBUTU70
           MOVE      ZERO     TO    FLG-GENBUTU70-KBN
           MOVE   "00000000"  TO    WK-GEN70-YMD
           MOVE   "99999999"  TO    WK-GEN70-YMD-ED
           IF     LNK-SYU-SRYYMD(1:6)       >=  "200704"
             IF  (LNK-S02-KOUREI-NYUIN-KBN   =   "1"     )
             OR  (FLG-KOREI-TANYUIN          =    1      )
             OR  (COMB-HKNNUM                =   SPACE   )
             OR  (COMB-SYU-HKNKOHSBTKBN   =  "8" OR "9"  )
             OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
                               OR "068" OR "069" OR "040")
             OR  ((COMB-KOH1HKNNUM     =  "970"         ) AND
                  (FLG-DAISAN-GENBUTU  =   ZERO         ))
               CONTINUE
             ELSE
               PERFORM   VARYING   GEN-IDX   FROM   1    BY   1
                          UNTIL   (GEN-IDX    >    TBL-GENBUTU70-MAX)
                            OR    (FLG-GENBUTU70   NOT = ZERO       )
                 INITIALIZE                         PTKOHINF-REC
                 MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
                 MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
                 MOVE    TBL-GENBUTU70(GEN-IDX) TO  PTKOH-KOHNUM
                 MOVE    PTKOHINF-REC           TO  MCPDATA-REC
                 MOVE    "DBSELECT"             TO  MCP-FUNC
                 MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
                 MOVE    "key4"                 TO  MCP-PATHNAME
                 CALL    "ORCDBMAIN"            USING  MCPAREA
                                                       MCPDATA-REC
                                                       SPA-AREA
                 IF      MCP-RC               =       ZERO
                     MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                     MOVE    "key4"             TO  MCP-PATHNAME
                     PERFORM  PTKOHINF-READ-SEC
                     PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           EVALUATE   GEN-IDX
                             WHEN        1
                               MOVE    1   TO  FLG-GENBUTU70
                               IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                                IF  PTKOH-JKYSNUM(1:2) = "¥¤"
                                 MOVE  12  TO  FLG-GENBUTU70-KBN
                                ELSE
                                 MOVE  11  TO  FLG-GENBUTU70-KBN
                                END-IF
                               END-IF
                               IF   (LNK-SYU-SRYYMD(1:6) >= "201204")
                               AND  (FLG-SANSHOU3     NOT =  SPACE  )
                                 MOVE  SPACE  TO  FLG-SANSHOU3
                               END-IF
                             WHEN        2
                               IF    FLG-SANSHOU3  =  SPACE
                                 MOVE  2   TO  FLG-GENBUTU70
                                 IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                                  IF  PTKOH-JKYSNUM(1:2) = "¥¨"
                                   MOVE 22 TO  FLG-GENBUTU70-KBN
                                  ELSE
                                   MOVE 21 TO  FLG-GENBUTU70-KBN
                                  END-IF
                                 END-IF
                               ELSE
                                 MOVE  3   TO  FLG-GENBUTU70
                                 IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                                   MOVE 31 TO  FLG-GENBUTU70-KBN
                                 END-IF
                               END-IF
                           END-EVALUATE
                           MOVE    1       TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                           MOVE    "key4"             TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                     END-PERFORM
                 END-IF
                 MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
                 MOVE    "key4"                 TO  MCP-PATHNAME
                 PERFORM  DB-CLOSE-SEC
               END-PERFORM
      *
               IF   (COMB-HKNNUM   =  "002"                )
               AND  (COMB-HOJOKBN  =  "1" OR "2" OR "3" OR
                                      "A" OR "B" OR "C" OR
                                      "D" OR "E" OR "F" OR
                                      "G" OR "H" OR "I"    )
                    MOVE    ZERO            TO  FLG-GENBUTU70
                    MOVE    ZERO            TO  FLG-GENBUTU70-KBN
               END-IF
               IF   (COMB-HKNNUM   =  "031" OR "032" OR "033" OR "034")
               AND  (COMB-HOJOKBN  =  "2" OR "B" OR "E" OR "H"        )
                    MOVE    ZERO            TO  FLG-GENBUTU70
                    MOVE    ZERO            TO  FLG-GENBUTU70-KBN
               END-IF
      *
               IF    FLG-GENBUTU70      =  ZERO
                 IF  FLG-TOKUSITU   NOT =  ZERO
                    MOVE    FLG-TOKUSITU    TO  FLG-GENBUTU70
                    IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                      MOVE  FLG-TOKUSITU-KBN
                                            TO  FLG-GENBUTU70-KBN
                    END-IF
                    IF   (LNK-SYU-SRYYMD(1:6) >= "201204")
                    AND  (FLG-TOKUSITU         =  1      )
                    AND  (FLG-SANSHOU3     NOT =  SPACE  )
                      MOVE  SPACE  TO  FLG-SANSHOU3
                    END-IF
                 END-IF
               END-IF
               IF    FLG-GENBUTU70      =  ZERO
                 IF  FLG-MARUKO     NOT =  ZERO
                    MOVE    FLG-MARUKO      TO  FLG-GENBUTU70
                 END-IF
               END-IF
      *
               IF    FLG-GENBUTU70  NOT =  ZERO
                 IF   (FLG-TOKUSITU   NOT =  ZERO)
                 OR   (FLG-MARUKO     NOT =  ZERO)
                   MOVE  LNK-SYU-SRYYMD(1:6)    TO  WK-GEN70-YM
                   MOVE  01                     TO  WK-GEN70-DD
                   MOVE  LNK-SYU-SRYYMD(1:6)    TO  WK-GEN70-YM-ED
                   MOVE  31                     TO  WK-GEN70-DD-ED
                 ELSE
                   MOVE  LNK-SYU-SRYYMD(1:6)    TO  WK-GEN70-YM
                   IF   PTKOH-TEKSTYMD(1:6)   =  LNK-SYU-SRYYMD(1:6)
                      MOVE  PTKOH-TEKSTYMD(7:2) TO  WK-GEN70-DD
                   ELSE
                      MOVE  01                  TO  WK-GEN70-DD
                   END-IF
                   MOVE  LNK-SYU-SRYYMD(1:6)    TO  WK-GEN70-YM-ED
                   IF   LNK-SYU-SRYYMD(1:6)   =  PTKOH-TEKEDYMD(1:6)
                      MOVE  PTKOH-TEKEDYMD(7:2) TO  WK-GEN70-DD-ED
                   ELSE
                      MOVE  31                  TO  WK-GEN70-DD-ED
                   END-IF
                 END-IF
               END-IF
      *
             END-IF
           END-IF
      *
      *    ¹âÎð¼Ô¸½ÌòÊÂ¤ß½êÆÀ¼ÔÅ¬ÍÑ¶èÊ¬
           MOVE      ZERO     TO    FLG-KOUREI-GENEKIKBN
           IF    (LNK-SYU-SRYYMD(1:6)         >=  "201808")
           AND   (LNK-S02-KOUREI-NYUIN-KBN     =  "1"     )
             MOVE    1        TO    FLG-KOUREI-GENEKIKBN
      *
             INITIALIZE                       PTKOHINF-REC
             MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
             MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
             MOVE    "946"                TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC         TO  MCPDATA-REC
             MOVE    "DBSELECT"           TO  MCP-FUNC
             MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
             MOVE    "key4"               TO  MCP-PATHNAME
             CALL    "ORCDBMAIN"          USING  MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                 IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                 AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                 AND (PTKOH-SAKJOKBN   =  SPACE         )
                   IF  (PTKOH-JKYSNUM(1:2) = "£²")
                   OR  (PTKOH-JKYSNUM(1:1) = "2" )
                       MOVE  2  TO  FLG-KOUREI-GENEKIKBN
                   ELSE
                     IF  (PTKOH-JKYSNUM(1:2) = "£±")
                     OR  (PTKOH-JKYSNUM(1:1) = "1" )
                       MOVE  3  TO  FLG-KOUREI-GENEKIKBN
                     ELSE
                       MOVE  1  TO  FLG-KOUREI-GENEKIKBN
                     END-IF
                   END-IF
                   MOVE    1    TO  FLG-PTKOHINF
                 ELSE
                   MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                   MOVE    "key4"             TO  MCP-PATHNAME
                   PERFORM  PTKOHINF-READ-SEC
                 END-IF
               END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
             MOVE    "key4"             TO  MCP-PATHNAME
             PERFORM  DB-CLOSE-SEC
           END-IF
      *
           IF      FLG-GENBUTU70           NOT =  ZERO
             IF  LNK-SYU-SRYYMD(1:6) >= "201501"
               MOVE   FLG-GENBUTU70-KBN   TO   LNK-SYU-SKJ-FTNGAKU(2)
             ELSE
               MOVE   FLG-GENBUTU70       TO   LNK-SYU-SKJ-FTNGAKU(2)
             END-IF
           END-IF
           IF     ((LNK-S02-KOUREI-NYUIN-KBN  = "1" ) OR
                   (FLG-KOREI-TANYUIN         =  1  ))
           AND    (LNK-SYU-SRYYMD(1:6)    >= "200904")
              IF    COMB-HOJOKBN    =   "3" OR "7"
                    MOVE    1        TO  LNK-SYU-SKJ-FTNGAKU(2)
                    IF  LNK-SYU-SRYYMD(1:6)  >= "201808"
                      EVALUATE  FLG-KOUREI-GENEKIKBN
                        WHEN       1
                          MOVE   1   TO  LNK-SYU-SKJ-FTNGAKU(2)
                        WHEN       2
                          MOVE  12   TO  LNK-SYU-SKJ-FTNGAKU(2)
                        WHEN       3
                          MOVE  13   TO  LNK-SYU-SKJ-FTNGAKU(2)
                      END-EVALUATE
                    END-IF
              ELSE
                IF  FLG-SANSHOU3    =   SPACE
                    MOVE    2        TO  LNK-SYU-SKJ-FTNGAKU(2)
                ELSE
                  EVALUATE  FLG-SANSHOU3
                    WHEN       "2"
                    WHEN       "3"
                      MOVE  3        TO  LNK-SYU-SKJ-FTNGAKU(2)
                    WHEN       "1"
                    WHEN       "4"
                      MOVE  4        TO  LNK-SYU-SKJ-FTNGAKU(2)
                  END-EVALUATE
                END-IF
              END-IF
           END-IF
      *
      *    ¹â³Û£´²óÌÜ°Ê¹ßÂÐ¾Ý¼Ô
           MOVE      ZERO     TO    FLG-KOHYONKAIME
           IF  ( LNK-S02-KOUREI-NYUIN-KBN      =   "1"      )
           OR  ( FLG-GENBUTU70             NOT =  ZERO      )
           OR  ((FLG-KOHININBARAI              =    1      ) AND
                (LNK-SYU-SRYYMD(1:6)          >=   "201501"))
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "965"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           MOVE    1         TO  FLG-KOHYONKAIME
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF
      *
           MOVE    ZERO     TO    FLG-OITA-GENBUTU70
           IF    WK-2010-NINNASIKBN(1)  NOT = SPACE
             IF  (LNK-SYU-KOH2HKNNUM  = "972" OR "974")
             OR  (LNK-SYU-KOH3HKNNUM  = "972" OR "974")
             OR  (LNK-SYU-KOH4HKNNUM  = "972" OR "974")
             OR  (LNK-S02-KOUREI-NYUIN-KBN   =   "1"  )
             OR  (FLG-KOREI-TANYUIN          =    1   )
                CONTINUE
             ELSE
                IF    FLG-GENBUTU70   =  ZERO
                  IF    WK-2010-NINNASIKBN(1)  =
                                            "1" OR "2" OR "5" OR "6"
                    MOVE       2     TO    FLG-GENBUTU70
                    MOVE       1     TO    FLG-OITA-GENBUTU70
                    IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                      IF   WK-2010-NINNASIKBN(1)  =  "1" OR "2"
                        MOVE   21    TO    FLG-GENBUTU70-KBN
                      ELSE
                        MOVE   22    TO    FLG-GENBUTU70-KBN
                      END-IF
                    END-IF
                  ELSE
                    IF  FLG-SANSHOU2   =  "2" OR "3"
                       MOVE    3     TO    FLG-GENBUTU70
                       IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                         MOVE  31    TO    FLG-GENBUTU70-KBN
                       END-IF
                       MOVE    1     TO    FLG-OITA-GENBUTU70
                    ELSE
                       MOVE    2     TO    FLG-GENBUTU70
                       MOVE    1     TO    FLG-OITA-GENBUTU70
                       IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                         IF   WK-2010-NINNASIKBN(1)  =  "3" OR "4"
                           MOVE  21  TO    FLG-GENBUTU70-KBN
                         ELSE
                           MOVE  22  TO    FLG-GENBUTU70-KBN
                         END-IF
                       END-IF
                    END-IF
                  END-IF
                  IF    WK-2010-NINNASIKBN(1)  =
                                            "2" OR "4" OR "6" OR "8"
                    INITIALIZE                       PTKOHINF-REC
                    MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                    MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                    MOVE    "965"                TO  PTKOH-KOHNUM
                    MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                    MOVE    "DBSELECT"           TO  MCP-FUNC
                    MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                    MOVE    "key4"               TO  MCP-PATHNAME
                    CALL    "ORCDBMAIN"          USING  MCPAREA
                                                        MCPDATA-REC
                                                        SPA-AREA
                    IF      MCP-RC               =       ZERO
                      MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                      MOVE    "key4"           TO  MCP-PATHNAME
                      PERFORM  PTKOHINF-READ-SEC
                      PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                          MOVE    1         TO  FLG-KOHYONKAIME
                          MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                          MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                          MOVE    "key4"           TO  MCP-PATHNAME
                          PERFORM  PTKOHINF-READ-SEC
                        END-IF
                      END-PERFORM
                    END-IF
                    MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                    MOVE    "key4"               TO  MCP-PATHNAME
                    PERFORM  DB-CLOSE-SEC
                  END-IF
                END-IF
             END-IF
           END-IF
      *
      *    Åö·î£·£µºÐÅþÃ£¼Ô
      *    ¡Ê´û¤Ë£°£³£¹¤È¤Ê¤Ã¤Æ¤¤¤ë¾ì¹ç¡¢£±Æü¤¬ÃÂÀ¸Æü¡¢
      *      £²·î£²£¹Æü¤¬ÃÂÀ¸Æü¡¢¸øÈñÃ±ÆÈ¤ò½ü¤¯¡Ë
           MOVE      ZERO       TO    FLG-TOKU75
                                      FLG-TOKU75-KIZON
           MOVE      SPACE      TO    WK-TOKU75-BIRTHDAY
           MOVE      ZERO       TO    FLG-KOKI-HIGAITO
           IF   ((LNK-S02-KOUREI-NYUIN-KBN    =  "1") OR
                 (FLG-KOREI-TANYUIN           =   1 ))
           AND  (COMB-HKNNUM         NOT =   SPACE   )
           AND  (LNK-SYU-SRYYMD(1:6)    >=   "200901")
               INITIALIZE                       PTKOHINF-REC
               MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
               MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
               MOVE    "977"                TO  PTKOH-KOHNUM
               MOVE    PTKOHINF-REC         TO  MCPDATA-REC
               MOVE    "DBSELECT"           TO  MCP-FUNC
               MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
               MOVE    "key4"               TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"          USING  MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                   MOVE    "key4"           TO  MCP-PATHNAME
                   PERFORM  PTKOHINF-READ-SEC
                   PERFORM  UNTIL   FLG-PTKOHINF    =   1
                     IF  (PTKOH-TEKSTYMD(1:6)  <=
                                              LNK-SYU-SRYYMD(1:6))
                     AND (LNK-SYU-SRYYMD(1:6)  <=
                                              PTKOH-TEKEDYMD(1:6))
                     AND (PTKOH-SAKJOKBN   =  SPACE              )
                        MOVE    1       TO  FLG-KOKI-HIGAITO
                        MOVE    1       TO  FLG-PTKOHINF
                     ELSE
                        MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                        MOVE    "key4"           TO  MCP-PATHNAME
                        PERFORM  PTKOHINF-READ-SEC
                     END-IF
                   END-PERFORM
               END-IF
               MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
               MOVE    "key4"           TO  MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
               INITIALIZE                      ORCSAGECHKAREA
               MOVE    LNK-SYU-HOSPNUM     TO  AGECHK-HOSPNUM
               MOVE    LNK-SYU-PTID        TO  AGECHK-PTID
               MOVE    LNK-SYU-SRYYMD(1:6) TO  AGECHK-SRYYMD(1:6)
               MOVE    "01"                TO  AGECHK-SRYYMD(7:2)
               MOVE    PTINF-BIRTHDAY      TO  AGECHK-BIRTHDAY
      *        MOVE    LNK-SYU-HKNCOMBINUM TO  AGECHK-HKNCOMBINUM
      *        MOVE    LNK-SYU-NYUGAIKBN   TO  AGECHK-NYUGAIKBN
               CALL    "ORCSAGECHK"        USING
                                           ORCSAGECHKAREA
                                           SPA-AREA
               IF      AGECHK-RC       =   ZERO
                   IF  ( AGECHK-NENREI        =  74                 )
                   AND ( AGECHK-ROUJIN2       =  0                  )
                   AND ( PTINF-BIRTHDAY(5:2)  = LNK-SYU-SRYYMD(5:2) )
                   AND ( PTINF-BIRTHDAY(7:2)  NOT =   "01"          )
                   AND ( PTINF-BIRTHDAY(5:4)  NOT =   "0229"        )
                   AND ( FLG-KOKI-HIGAITO         =    ZERO         )
                       MOVE   1    TO    FLG-TOKU75
                       MOVE   PTINF-BIRTHDAY
                                   TO    WK-TOKU75-BIRTHDAY
                   END-IF
                   IF  ( AGECHK-NENREI       >=  75 )
                   OR  ( AGECHK-ROUJIN2       =  1  )
                       MOVE   1    TO    FLG-TOKU75-KIZON
                   END-IF
               ELSE
                   DISPLAY  "PTINF AGE-CHK ERR " LNK-SYU-PTID
               END-IF
           END-IF
      *
      *    Åö·î£·£µºÐÅþÃ£¼Ô¤ÎÈïÉÞÍÜ¼Ô
           IF   (LNK-SYU-SRYYMD(1:6)       >=  "200901" )
           AND  (COMB-HKNNUM            NOT =   SPACE   )
             IF (COMB-SYU-HKNKOHSBTKBN   =  "8" OR "9"  )
             OR (COMB-HKNNUM  =  "971" OR "973" OR "975"
                              OR "068" OR "069" OR "040")
             OR ((COMB-KOH1HKNNUM     =  "970"         ) AND
                 (FLG-DAISAN-GENBUTU  =   ZERO         ))
             OR (FLG-TOKU75                 =    1      )
             OR (FLG-TOKU75-KIZON           =    1      )
                CONTINUE
             ELSE
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "969"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD(1:6) = LNK-SYU-SRYYMD(1:6))
                      AND (LNK-SYU-SRYYMD(1:6) = PTKOH-TEKEDYMD(1:6))
                      AND (PTKOH-SAKJOKBN      = SPACE              )
                         IF  PTKOH-TEKSTYMD(5:4)   NOT =  "0229"
                           IF  LNK-S02-KOUREI-NYUIN-KBN = "1"
                           OR  FLG-KOREI-TANYUIN        =  1
                              MOVE  2   TO   FLG-TOKU75
                           ELSE
                              MOVE  3   TO   FLG-TOKU75
                           END-IF
                           MOVE  PTKOH-TEKSTYMD
                                        TO   WK-TOKU75-BIRTHDAY
                         END-IF
                         MOVE    1      TO   FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                         MOVE    "key4"           TO  MCP-PATHNAME
                         PERFORM  PTKOHINF-READ-SEC
                      END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key4"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
             END-IF
           END-IF
      *
      *    £·£µºÐÅþÃ£·î¤ÎÆÃÎãÈó³ºÅö
           IF   FLG-TOKU75   =  1  OR  2  OR  3
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    "954"                TO  PTKOH-KOHNUM
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key4"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key4"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                        AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                        AND (PTKOH-SAKJOKBN   =  SPACE         )
                           MOVE    ZERO      TO  FLG-TOKU75
                           MOVE    1         TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key4"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key4"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
           END-IF
      *
      *    £°£±¸ø³ºÅö
      ***  MOVE      ZERO     TO    FLG-ZEROKOGAITO
      ***  IF   LNK-SYU-SRYYMD(1:6)  >=  "201204"
      ***    IF  ((FLG-GENBUTU70           NOT =   ZERO) AND
      ***         (FLG-OITA-GENBUTU70          =   ZERO))
      ***    OR  ((LNK-S02-KOUREI-NYUIN-KBN    =   "1" ) AND
      ***         (COMB-HKNNUM             NOT =  SPACE))
      ***      IF   (COMB-HKNNUM     NOT =  SPACE)
      ***      AND  (COMB-KOH1HKNNUM     =  SPACE
      ***                                OR "970")
      ***      AND  (COMB-KOH2HKNNUM     =  SPACE)
      ***      AND  (COMB-KOH3HKNNUM     =  SPACE)
      ***      AND  (COMB-KOH4HKNNUM     =  SPACE)
      ***        IF  (COMB-SYU-HKNKOHSBTKBN =  "8" OR "9"    )
      ***        OR  (COMB-HKNNUM  =  "971" OR "973" OR "975"
      ***                          OR "068" OR "069" OR "040")
      ***        OR  ((COMB-KOH1HKNNUM      =  "970"        ) AND
      ***             (FLG-DAISAN-GENBUTU   =   ZERO        ))
      ***          CONTINUE
      ***        ELSE
      ***          INITIALIZE                        PTKOHINF-REC
      ***          MOVE    LNK-SYU-HOSPNUM       TO  PTKOH-HOSPNUM
      ***          MOVE    LNK-SYU-PTID          TO  PTKOH-PTID
      ***          MOVE    "955"                 TO  PTKOH-KOHNUM
      ***          MOVE    PTKOHINF-REC          TO  MCPDATA-REC
      ***          MOVE    "DBSELECT"            TO  MCP-FUNC
      ***          MOVE    "tbl_ptkohinf"        TO  MCP-TABLE
      ***          MOVE    "key4"                TO  MCP-PATHNAME
      ***          CALL    "ORCDBMAIN"           USING  MCPAREA
      ***                                               MCPDATA-REC
      ***                                               SPA-AREA
      ***          IF      MCP-RC   =   ZERO
      ***            MOVE    "tbl_ptkohinf"      TO  MCP-TABLE
      ***            MOVE    "key4"              TO  MCP-PATHNAME
      ***            PERFORM  PTKOHINF-READ-SEC
      ***            PERFORM  UNTIL   FLG-PTKOHINF   =   1
      ***              IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
      ***              AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
      ***              AND (PTKOH-SAKJOKBN   =  SPACE         )
      ***                MOVE     1    TO   FLG-ZEROKOGAITO
      ***                MOVE     1    TO   FLG-PTKOHINF
      ***              ELSE
      ***                MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
      ***                MOVE    "key4"          TO  MCP-PATHNAME
      ***                PERFORM  PTKOHINF-READ-SEC
      ***              END-IF
      ***            END-PERFORM
      ***          END-IF
      ***          MOVE      "tbl_ptkohinf"      TO  MCP-TABLE
      ***          MOVE      "key4"              TO  MCP-PATHNAME
      ***          PERFORM    DB-CLOSE-SEC
      ***        END-IF
      ***      END-IF
      ***    END-IF
      ***  END-IF
      *
           MOVE      ZERO          TO    FLG-CYOKI-ARI
           IF   LNK-SYU-SRYYMD(1:6)  >=  "200901"
             IF  (LNK-S02-KOUREI-NYUIN-KBN      =   "1")
             OR  (FLG-GENBUTU70             NOT =  ZERO)
             OR  (FLG-TOKU75                NOT =  ZERO)
               CONTINUE
             ELSE
               IF  ( COMB-HKNNUM      NOT =  SPACE     )
               AND ((COMB-KOH1HKNNUM  = "972" OR "974") OR
                    (COMB-KOH2HKNNUM  = "972" OR "974") OR
                    (COMB-KOH3HKNNUM  = "972" OR "974") OR
                    (COMB-KOH4HKNNUM  = "972" OR "974"))
                    MOVE    2      TO    FLG-CYOKI-ARI
               END-IF
             END-IF
           END-IF
      *
           IF    (FLG-GENBUTU70   NOT =  ZERO)
           AND   (FLG-KOHININBARAI    =    1 )
              MOVE   ZERO     TO    FLG-KOHININBARAI
           END-IF
      *
      *    ¸øÈñÉéÃ´¸ÂÅÙ³Û¤Î¥»¥Ã¥È
           IF      LNK-SYU-SRYYMD(1:6)  >=  "201708"
             MOVE      57600  TO    WK-KOH-GENDOGAKU
             IF    FLG-TOKUSITU-XXX  = 1
             OR    FLG-KANGAN-XXX    = 1
               IF  FLG-TOKUSITU-TASU = 1
               OR  FLG-KANGAN-TASU   = 1
               OR  FLG-KOHYONKAIME   = 1
                 MOVE  44400  TO    WK-KOH-GENDOGAKU
               END-IF
             ELSE
               IF  FLG-KOHYONKAIME   = 1
                 MOVE  44400  TO    WK-KOH-GENDOGAKU
               END-IF
             END-IF
           ELSE
             IF    LNK-SYU-SRYYMD(1:6)  >=  "200610"
               MOVE    44400  TO    WK-KOH-GENDOGAKU
             ELSE
               MOVE    40200  TO    WK-KOH-GENDOGAKU
             END-IF
           END-IF
           EVALUATE  FLG-SANSHOU3
             WHEN     "2"
             WHEN     "3"
               MOVE    24600  TO    WK-KOH-GENDOGAKU
             WHEN     "1"
             WHEN     "4"
               MOVE    15000  TO    WK-KOH-GENDOGAKU
           END-EVALUATE
      *
           IF   ( COMB-KOH1HKNNUM  =   "972" )
           OR   ( COMB-KOH2HKNNUM  =   "972" )
           OR   ( COMB-KOH3HKNNUM  =   "972" )
           OR   ( COMB-KOH4HKNNUM  =   "972" )
              IF   WK-KOH-GENDOGAKU > 10000
                 MOVE   10000   TO  WK-KOH-GENDOGAKU
              END-IF
           END-IF
           IF   ( COMB-KOH1HKNNUM  =   "974" )
           OR   ( COMB-KOH2HKNNUM  =   "974" )
           OR   ( COMB-KOH3HKNNUM  =   "974" )
           OR   ( COMB-KOH4HKNNUM  =   "974" )
              IF   WK-KOH-GENDOGAKU > 20000
                 MOVE   20000   TO  WK-KOH-GENDOGAKU
              END-IF
           END-IF
      *
           IF     FLG-GENBUTU70   NOT =  ZERO
              EVALUATE   FLG-GENBUTU70
                WHEN        1
                WHEN        2
                  MOVE     80100   TO   WK-GEN70-GENDOGAKU
                  IF    FLG-TOKUSITU-XXX  = 1
                  OR    FLG-KANGAN-XXX    = 1
                    IF  FLG-TOKUSITU-TASU = 1
                    OR  FLG-KANGAN-TASU   = 1
                    OR  FLG-KOHYONKAIME   = 1
                      MOVE 44400   TO   WK-GEN70-GENDOGAKU
                    END-IF
                  ELSE
                    IF  FLG-KOHYONKAIME   = 1
                      MOVE 44400   TO   WK-GEN70-GENDOGAKU
                    END-IF
                  END-IF
                WHEN        3
                  MOVE     35400   TO   WK-GEN70-GENDOGAKU
                  IF    FLG-TOKUSITU-XXX  = 1
                  OR    FLG-KANGAN-XXX    = 1
                    IF  FLG-TOKUSITU-TASU = 1
                    OR  FLG-KANGAN-TASU   = 1
                    OR  FLG-KOHYONKAIME   = 1
                      MOVE 24600   TO   WK-GEN70-GENDOGAKU
                    END-IF
                  ELSE
                    IF  FLG-KOHYONKAIME   = 1
                      MOVE 24600   TO   WK-GEN70-GENDOGAKU
                    END-IF
                  END-IF
              END-EVALUATE
              IF   ( COMB-KOH1HKNNUM  =   "972" )
              OR   ( COMB-KOH2HKNNUM  =   "972" )
              OR   ( COMB-KOH3HKNNUM  =   "972" )
              OR   ( COMB-KOH4HKNNUM  =   "972" )
                 IF   WK-GEN70-GENDOGAKU > 10000
                    MOVE   10000   TO  WK-GEN70-GENDOGAKU
                 END-IF
              END-IF
              IF   ( COMB-KOH1HKNNUM  =   "974" )
              OR   ( COMB-KOH2HKNNUM  =   "974" )
              OR   ( COMB-KOH3HKNNUM  =   "974" )
              OR   ( COMB-KOH4HKNNUM  =   "974" )
                 IF   WK-GEN70-GENDOGAKU > 20000
                    MOVE   20000   TO  WK-GEN70-GENDOGAKU
                 END-IF
              END-IF
           ELSE
              IF  (FLG-TOKU75     =   3)
              OR  (FLG-CYOKI-ARI  =   2)
                 MOVE   ZERO       TO  WK-GEN70-GENDOGAKU
                 IF   ( COMB-KOH1HKNNUM  =   "972" )
                 OR   ( COMB-KOH2HKNNUM  =   "972" )
                 OR   ( COMB-KOH3HKNNUM  =   "972" )
                 OR   ( COMB-KOH4HKNNUM  =   "972" )
                    MOVE   10000   TO  WK-GEN70-GENDOGAKU
                 END-IF
                 IF   ( COMB-KOH1HKNNUM  =   "974" )
                 OR   ( COMB-KOH2HKNNUM  =   "974" )
                 OR   ( COMB-KOH3HKNNUM  =   "974" )
                 OR   ( COMB-KOH4HKNNUM  =   "974" )
                    MOVE   20000   TO  WK-GEN70-GENDOGAKU
                 END-IF
              END-IF
           END-IF
      *
           MOVE      15000       TO     WK-SEIHO-GENDO
           IF  FLG-KOHYONKAIME = 1
              MOVE   24600       TO     WK-SEIHO-GENDO70
           ELSE
              MOVE   35400       TO     WK-SEIHO-GENDO70
           END-IF
           MOVE      10000       TO     WK-CYOKI-GENDO
           MOVE      20000       TO     WK-CYOKI-GENDO2
      *
           COMPUTE  WK-KOH-GENDOGAKU-TOKU75   = 
                    WK-KOH-GENDOGAKU          /  2
           COMPUTE  WK-GEN70-GENDOGAKU-TOKU75 =
                    WK-GEN70-GENDOGAKU        /  2
           COMPUTE  WK-SEIHO-GENDO-TOKU75     =
                    WK-SEIHO-GENDO            /  2
           COMPUTE  WK-SEIHO-GENDO70-TOKU75   =
                    WK-SEIHO-GENDO70          /  2
           COMPUTE  WK-CYOKI-GENDO-TOKU75     =
                    WK-CYOKI-GENDO            /  2
           COMPUTE  WK-CYOKI-GENDO2-TOKU75    =
                    WK-CYOKI-GENDO2           /  2
      *
      *    ¸º³Û¡Ê³ä¹ç¡¦¶â³Û¡Ë¤Î¼è¹þ¤ß½èÍý
      *    ¸øÈñÉéÃ´¸ÂÅÙ³Û¤Î¸º³Û
           IF    WK-GENGAKUKBN    NOT  =   ZERO
             PERFORM       2001-GENGAKU-GET-SEC
             IF  WK-GENGAKUKBN-KEISAN  =   ZERO
               PERFORM     2001X-KOHGENDO-GEN-SEC
             END-IF
           END-IF
      *
      *    ÊÝ¸±ÈÖ¹æ¥Æ¡¼¥Ö¥ë¤«¤é¸øÈñ¤ÎÉéÃ´¾å¸Â¶â³Û¤Î¼èÆÀ
           PERFORM         210-HOKEN-KAISU-SEC
      *
      *    ¿ÇÎÅ·îÆâ¤Î¼ýÇ¼¥Þ¥¹¥¿¤«¤é¸øÈñËè¤Î´µ¼ÔÉéÃ´¶â³Û¤Î
      *    Îß·×¤òÄ´ºº
           PERFORM         220-SYUNOU-SEC
      *
      *    ÊÝ¸±¡¦¸øÈñ¤ÎÉéÃ´¶â·×»»
           PERFORM         230-FTNKIN-SEC
      *
           .
      *
       200-HKNFTN-SANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸º³Û¡Ê³ä¹ç¡¦¶â³Û¡Ë¤Î¼è¹þ¤ß½èÍý                          *
      ******************************************************************
       2001-GENGAKU-GET-SEC           SECTION.
      *
           IF   WK-GENGAKUKBN   =   1   OR   2   OR   5
      *
                MOVE       ZERO           TO  WK-GENGAKU-RITU
                                              WK-GENGAKU-KIN
      *
      *         ¸øÈñ·î¾å¸Â³Û¼èÆÀ
                INITIALIZE                    LNK-ORCSJGNGET-REC
                MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
                MOVE  LNK-SYU-NYUGAIKBN   TO  LNK-ORCSJGNGET-NYUGAIKBN
                MOVE  LNK-SYU-PTID        TO  LNK-ORCSJGNGET-PTID
                EVALUATE   WK-GENGAKUKBN
                  WHEN         1
                     MOVE    "960"        TO  LNK-ORCSJGNGET-KOHHKNNUM
                  WHEN         2
                     MOVE    "961"        TO  LNK-ORCSJGNGET-KOHHKNNUM
                  WHEN         5
                     MOVE    "953"        TO  LNK-ORCSJGNGET-KOHHKNNUM
                END-EVALUATE
                MOVE  WK-GENGAKU-KOHID    TO  LNK-ORCSJGNGET-KOHID
                MOVE  LNK-SYU-SRYYMD(1:6) TO  LNK-ORCSJGNGET-SRYYM
      *
                CALL    "ORCSJGNGET"      USING
                                          LNK-ORCSJGNGET-REC
                                          SPA-AREA
      *
                IF    LNK-ORCSJGNGET-RC   =   ZERO
                    EVALUATE   WK-GENGAKUKBN
                      WHEN          1
                         MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                          TO  WK-GENGAKU-RITU
                         IF   WK-GENGAKU-RITU  >  100
                             MOVE   100   TO  WK-GENGAKU-RITU
                         END-IF
                      WHEN          2
                      WHEN          5
                         MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                          TO  WK-GENGAKU-KIN
                         COMPUTE  WK-GENGAKU-KIN =
                                  WK-GENGAKU-KIN +  5
                         COMPUTE  WK-GENGAKU-KIN =
                                  WK-GENGAKU-KIN /  10
                         COMPUTE  WK-GENGAKU-KIN =
                                  WK-GENGAKU-KIN *  10
                    END-EVALUATE
                END-IF
      *
           END-IF
      *
           .
      *
       2001-GENGAKU-GET-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñÉéÃ´¸ÂÅÙ³Û¤Î¸º³Û                                    *
      ******************************************************************
       2001X-KOHGENDO-GEN-SEC           SECTION.
      *
           IF   WK-KOH-GENDOGAKU  NOT = ZERO
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   WK-KOH-GENDOGAKU
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  WK-KOH-GENDOGAKU  =
                             WK-KOH-GENDOGAKU  *
                             WK-GENGAKU-RITUX  /
                             100
                  END-IF
                WHEN          2
                  IF  WK-KOH-GENDOGAKU < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   WK-KOH-GENDOGAKU
                  ELSE
                    COMPUTE  WK-KOH-GENDOGAKU  =
                             WK-KOH-GENDOGAKU  -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   WK-KOH-GENDOGAKU
                WHEN          5
                  IF  WK-KOH-GENDOGAKU > WK-GENGAKU-KIN
                    COMPUTE  WK-KOH-GENDOGAKU  =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
              COMPUTE  WK-KOH-GENDOGAKU =
                       WK-KOH-GENDOGAKU +  5
              COMPUTE  WK-KOH-GENDOGAKU =
                       WK-KOH-GENDOGAKU /  10
              COMPUTE  WK-KOH-GENDOGAKU =
                       WK-KOH-GENDOGAKU *  10
           END-IF
      *
           IF   WK-GEN70-GENDOGAKU  NOT = ZERO
              IF   WK-GEN70-GENDOGAKU  = 80100
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU
                     END-IF
                   WHEN          2
                     IF  WK-GEN70-GENDOGAKU < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU
                     END-IF
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   WK-GEN70-GENDOGAKU
                   WHEN          5
                     IF  WK-GEN70-GENDOGAKU > WK-GENGAKU-KIN
                       MOVE   WK-GENGAKU-KIN
                                     TO   WK-GEN70-GENDOGAKU
                     END-IF
                 END-EVALUATE
              ELSE
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU
                     ELSE
                       COMPUTE  WK-GENGAKU-RITUX =
                                100 - WK-GENGAKU-RITU
                       COMPUTE  WK-GEN70-GENDOGAKU  =
                                WK-GEN70-GENDOGAKU  *
                                WK-GENGAKU-RITUX  /
                                100
                     END-IF
                   WHEN          2
                     IF  WK-GEN70-GENDOGAKU < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU
                     ELSE
                       COMPUTE  WK-GEN70-GENDOGAKU =
                                WK-GEN70-GENDOGAKU -
                                WK-GENGAKU-KIN
                     END-IF
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   WK-GEN70-GENDOGAKU
                   WHEN          5
                     IF  WK-GEN70-GENDOGAKU > WK-GENGAKU-KIN
                       COMPUTE  WK-GEN70-GENDOGAKU =
                                WK-GENGAKU-KIN
                     END-IF
                 END-EVALUATE
                 COMPUTE  WK-GEN70-GENDOGAKU =
                          WK-GEN70-GENDOGAKU +  5
                 COMPUTE  WK-GEN70-GENDOGAKU =
                          WK-GEN70-GENDOGAKU /  10
                 COMPUTE  WK-GEN70-GENDOGAKU =
                          WK-GEN70-GENDOGAKU *  10
              END-IF
           END-IF
      *
           EVALUATE   WK-GENGAKUKBN
             WHEN          1
               IF  WK-GENGAKU-RITU = 100
                 MOVE   ZERO   TO   WK-SEIHO-GENDO
                                    WK-SEIHO-GENDO70
                                    WK-CYOKI-GENDO
                                    WK-CYOKI-GENDO2
               ELSE
                 COMPUTE  WK-GENGAKU-RITUX =
                          100 - WK-GENGAKU-RITU
                 COMPUTE  WK-SEIHO-GENDO    =
                          WK-SEIHO-GENDO    *
                          WK-GENGAKU-RITUX  /
                          100
                 COMPUTE  WK-SEIHO-GENDO70  =
                          WK-SEIHO-GENDO70  *
                          WK-GENGAKU-RITUX  /
                          100
                 COMPUTE  WK-CYOKI-GENDO    =
                          WK-CYOKI-GENDO    *
                          WK-GENGAKU-RITUX  /
                          100
                 COMPUTE  WK-CYOKI-GENDO2   =
                          WK-CYOKI-GENDO2   *
                          WK-GENGAKU-RITUX  /
                          100
               END-IF
             WHEN          2
               IF  WK-SEIHO-GENDO < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-SEIHO-GENDO
               ELSE
                 COMPUTE  WK-SEIHO-GENDO     =
                          WK-SEIHO-GENDO     -
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-SEIHO-GENDO70 < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-SEIHO-GENDO70
               ELSE
                 COMPUTE  WK-SEIHO-GENDO70   =
                          WK-SEIHO-GENDO70   -
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-CYOKI-GENDO
               ELSE
                 COMPUTE  WK-CYOKI-GENDO     =
                          WK-CYOKI-GENDO     -
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO2 < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-CYOKI-GENDO2
               ELSE
                 COMPUTE  WK-CYOKI-GENDO2    =
                          WK-CYOKI-GENDO2    -
                          WK-GENGAKU-KIN
               END-IF
             WHEN          3
             WHEN          4
               MOVE     ZERO   TO   WK-SEIHO-GENDO
                                    WK-SEIHO-GENDO70
                                    WK-CYOKI-GENDO
                                    WK-CYOKI-GENDO2
             WHEN          5
               IF  WK-SEIHO-GENDO > WK-GENGAKU-KIN
                 COMPUTE  WK-SEIHO-GENDO     =
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-SEIHO-GENDO70 > WK-GENGAKU-KIN
                 COMPUTE  WK-SEIHO-GENDO70   =
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO > WK-GENGAKU-KIN
                 COMPUTE  WK-CYOKI-GENDO     =
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO2 > WK-GENGAKU-KIN
                 COMPUTE  WK-CYOKI-GENDO2    =
                          WK-GENGAKU-KIN
               END-IF
           END-EVALUATE
           COMPUTE  WK-SEIHO-GENDO   =
                    WK-SEIHO-GENDO   +  5
           COMPUTE  WK-SEIHO-GENDO   =
                    WK-SEIHO-GENDO   /  10
           COMPUTE  WK-SEIHO-GENDO   =
                    WK-SEIHO-GENDO   *  10
           COMPUTE  WK-SEIHO-GENDO70 =
                    WK-SEIHO-GENDO70 +  5
           COMPUTE  WK-SEIHO-GENDO70 =
                    WK-SEIHO-GENDO70 /  10
           COMPUTE  WK-SEIHO-GENDO70 =
                    WK-SEIHO-GENDO70 *  10
           COMPUTE  WK-CYOKI-GENDO   =
                    WK-CYOKI-GENDO   +  5
           COMPUTE  WK-CYOKI-GENDO   =
                    WK-CYOKI-GENDO   /  10
           COMPUTE  WK-CYOKI-GENDO   =
                    WK-CYOKI-GENDO   *  10
           COMPUTE  WK-CYOKI-GENDO2  =
                    WK-CYOKI-GENDO2  +  5
           COMPUTE  WK-CYOKI-GENDO2  =
                    WK-CYOKI-GENDO2  /  10
           COMPUTE  WK-CYOKI-GENDO2  =
                    WK-CYOKI-GENDO2  *  10
      **
           IF   WK-KOH-GENDOGAKU-TOKU75  NOT = ZERO
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   WK-KOH-GENDOGAKU-TOKU75
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  WK-KOH-GENDOGAKU-TOKU75  =
                             WK-KOH-GENDOGAKU-TOKU75  *
                             WK-GENGAKU-RITUX         /
                             100
                  END-IF
                WHEN          2
                  IF  WK-KOH-GENDOGAKU-TOKU75 < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   WK-KOH-GENDOGAKU-TOKU75
                  ELSE
                    COMPUTE  WK-KOH-GENDOGAKU-TOKU75   =
                             WK-KOH-GENDOGAKU-TOKU75   -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   WK-KOH-GENDOGAKU-TOKU75
                WHEN          5
                  IF  WK-KOH-GENDOGAKU-TOKU75 > WK-GENGAKU-KIN
                    COMPUTE  WK-KOH-GENDOGAKU-TOKU75   =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
              COMPUTE  WK-KOH-GENDOGAKU-TOKU75 =
                       WK-KOH-GENDOGAKU-TOKU75 +  5
              COMPUTE  WK-KOH-GENDOGAKU-TOKU75 =
                       WK-KOH-GENDOGAKU-TOKU75 /  10
              COMPUTE  WK-KOH-GENDOGAKU-TOKU75 =
                       WK-KOH-GENDOGAKU-TOKU75 *  10
           END-IF
      *
           IF   WK-GEN70-GENDOGAKU-TOKU75  NOT = ZERO
              IF   WK-GEN70-GENDOGAKU-TOKU75  = 40050
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU-TOKU75
                     END-IF
                   WHEN          2
                     IF  WK-GEN70-GENDOGAKU-TOKU75 < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU-TOKU75
                     END-IF
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   WK-GEN70-GENDOGAKU-TOKU75
                   WHEN          5
                     IF  WK-GEN70-GENDOGAKU-TOKU75 > WK-GENGAKU-KIN
                       MOVE   WK-GENGAKU-KIN
                                     TO   WK-GEN70-GENDOGAKU-TOKU75
                     END-IF
                 END-EVALUATE
              ELSE
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU-TOKU75
                     ELSE
                       COMPUTE  WK-GENGAKU-RITUX =
                                100 - WK-GENGAKU-RITU
                       COMPUTE  WK-GEN70-GENDOGAKU-TOKU75  =
                                WK-GEN70-GENDOGAKU-TOKU75  *
                                WK-GENGAKU-RITUX           /
                                100
                     END-IF
                   WHEN          2
                     IF  WK-GEN70-GENDOGAKU-TOKU75 < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WK-GEN70-GENDOGAKU-TOKU75
                     ELSE
                       COMPUTE  WK-GEN70-GENDOGAKU-TOKU75 =
                                WK-GEN70-GENDOGAKU-TOKU75 -
                                WK-GENGAKU-KIN
                     END-IF
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   WK-GEN70-GENDOGAKU-TOKU75
                   WHEN          5
                     IF  WK-GEN70-GENDOGAKU-TOKU75 > WK-GENGAKU-KIN
                       COMPUTE  WK-GEN70-GENDOGAKU-TOKU75 =
                                WK-GENGAKU-KIN
                     END-IF
                 END-EVALUATE
                 COMPUTE  WK-GEN70-GENDOGAKU-TOKU75 =
                          WK-GEN70-GENDOGAKU-TOKU75 +  5
                 COMPUTE  WK-GEN70-GENDOGAKU-TOKU75 =
                          WK-GEN70-GENDOGAKU-TOKU75 /  10
                 COMPUTE  WK-GEN70-GENDOGAKU-TOKU75 =
                          WK-GEN70-GENDOGAKU-TOKU75 *  10
              END-IF
           END-IF
      *
           EVALUATE   WK-GENGAKUKBN
             WHEN          1
               IF  WK-GENGAKU-RITU = 100
                 MOVE   ZERO   TO   WK-SEIHO-GENDO-TOKU75
                                    WK-SEIHO-GENDO70-TOKU75
                                    WK-CYOKI-GENDO-TOKU75
                                    WK-CYOKI-GENDO2-TOKU75
               ELSE
                 COMPUTE  WK-GENGAKU-RITUX =
                          100 - WK-GENGAKU-RITU
                 COMPUTE  WK-SEIHO-GENDO-TOKU75    =
                          WK-SEIHO-GENDO-TOKU75    *
                          WK-GENGAKU-RITUX         /
                          100
                 COMPUTE  WK-SEIHO-GENDO70-TOKU75  =
                          WK-SEIHO-GENDO70-TOKU75  *
                          WK-GENGAKU-RITUX         /
                          100
                 COMPUTE  WK-CYOKI-GENDO-TOKU75    =
                          WK-CYOKI-GENDO-TOKU75    *
                          WK-GENGAKU-RITUX         /
                          100
                 COMPUTE  WK-CYOKI-GENDO2-TOKU75   =
                          WK-CYOKI-GENDO2-TOKU75   *
                          WK-GENGAKU-RITUX         /
                          100
               END-IF
             WHEN          2
               IF  WK-SEIHO-GENDO-TOKU75 < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-SEIHO-GENDO-TOKU75
               ELSE
                 COMPUTE  WK-SEIHO-GENDO-TOKU75  =
                          WK-SEIHO-GENDO-TOKU75  -
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-SEIHO-GENDO70-TOKU75 < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-SEIHO-GENDO70-TOKU75
               ELSE
                 COMPUTE  WK-SEIHO-GENDO70-TOKU75  =
                          WK-SEIHO-GENDO70-TOKU75  -
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO-TOKU75 < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-CYOKI-GENDO-TOKU75
               ELSE
                 COMPUTE  WK-CYOKI-GENDO-TOKU75    =
                          WK-CYOKI-GENDO-TOKU75    -
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO2-TOKU75 < WK-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-CYOKI-GENDO2-TOKU75
               ELSE
                 COMPUTE  WK-CYOKI-GENDO2-TOKU75   =
                          WK-CYOKI-GENDO2-TOKU75   -
                          WK-GENGAKU-KIN
               END-IF
             WHEN          3
             WHEN          4
               MOVE     ZERO   TO   WK-SEIHO-GENDO-TOKU75
                                    WK-SEIHO-GENDO70-TOKU75
                                    WK-CYOKI-GENDO-TOKU75
                                    WK-CYOKI-GENDO2-TOKU75
             WHEN          5
               IF  WK-SEIHO-GENDO-TOKU75 > WK-GENGAKU-KIN
                 COMPUTE  WK-SEIHO-GENDO-TOKU75  =
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-SEIHO-GENDO70-TOKU75 > WK-GENGAKU-KIN
                 COMPUTE  WK-SEIHO-GENDO70-TOKU75  =
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO-TOKU75 > WK-GENGAKU-KIN
                 COMPUTE  WK-CYOKI-GENDO-TOKU75    =
                          WK-GENGAKU-KIN
               END-IF
               IF  WK-CYOKI-GENDO2-TOKU75 > WK-GENGAKU-KIN
                 COMPUTE  WK-CYOKI-GENDO2-TOKU75   =
                          WK-GENGAKU-KIN
               END-IF
           END-EVALUATE
           COMPUTE  WK-SEIHO-GENDO-TOKU75   =
                    WK-SEIHO-GENDO-TOKU75   +  5
           COMPUTE  WK-SEIHO-GENDO-TOKU75   =
                    WK-SEIHO-GENDO-TOKU75   /  10
           COMPUTE  WK-SEIHO-GENDO-TOKU75   =
                    WK-SEIHO-GENDO-TOKU75   *  10
           COMPUTE  WK-SEIHO-GENDO70-TOKU75 =
                    WK-SEIHO-GENDO70-TOKU75 +  5
           COMPUTE  WK-SEIHO-GENDO70-TOKU75 =
                    WK-SEIHO-GENDO70-TOKU75 /  10
           COMPUTE  WK-SEIHO-GENDO70-TOKU75 =
                    WK-SEIHO-GENDO70-TOKU75 *  10
           COMPUTE  WK-CYOKI-GENDO-TOKU75   =
                    WK-CYOKI-GENDO-TOKU75   +  5
           COMPUTE  WK-CYOKI-GENDO-TOKU75   =
                    WK-CYOKI-GENDO-TOKU75   /  10
           COMPUTE  WK-CYOKI-GENDO-TOKU75   =
                    WK-CYOKI-GENDO-TOKU75   *  10
           COMPUTE  WK-CYOKI-GENDO2-TOKU75  =
                    WK-CYOKI-GENDO2-TOKU75  +  5
           COMPUTE  WK-CYOKI-GENDO2-TOKU75  =
                    WK-CYOKI-GENDO2-TOKU75  /  10
           COMPUTE  WK-CYOKI-GENDO2-TOKU75  =
                    WK-CYOKI-GENDO2-TOKU75  *  10
      *
           .
      *
       2001X-KOHGENDO-GEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆÃÄê¼À´µÅù¤ÎÈ½Äê
      *****************************************************************
       2002-TOKUSITU-HANTEI-SEC               SECTION.
      *
           MOVE     ZERO      TO    FLG-TOKUSITU
           MOVE     ZERO      TO    FLG-TOKUSITU-TASU
           MOVE     ZERO      TO    FLG-TOKUSITU-XXX
           MOVE     ZERO      TO    FLG-TOKUSITU-KBN
           INITIALIZE               WK-TOKUSITU-SKJ-TBL
      *
           MOVE     ZERO      TO    FLG-KANGAN
           MOVE     ZERO      TO    FLG-KANGAN-XXX
           MOVE     ZERO      TO    FLG-KANGAN-TASU
           MOVE     ZERO      TO    FLG-KANGAN-KBN
      *
           IF   (LNK-SYU-SRYYMD(1:6)       >=  "200905" )
      *****AND  (COMB-HKNNUM            NOT =   SPACE   )
             IF (COMB-SYU-HKNKOHSBTKBN   =  "8" OR "9"  )
             OR (COMB-HKNNUM  =  "971" OR "973" OR "975"
                              OR "068" OR "069" OR "040")
             OR ((COMB-KOH1HKNNUM     =  "970"         ) AND
                 (FLG-DAISAN-GENBUTU  =   ZERO         ))
               CONTINUE
             ELSE
               MOVE   SPACE   TO    WK-KOH-FTNJANUM
               IF  ( COMB-KOH1HKNNUM = "051" OR "052" OR "091" )
               OR  ((COMB-KOH1HKNNUM      =  "054"            ) AND
                    (LNK-SYU-SRYYMD(1:6) >=  "201501"         ))
               OR  ( COMB-KOH2HKNNUM = "051" OR "091"          )
               OR  ((COMB-KOH2HKNNUM      =  "054"            ) AND
                    (LNK-SYU-SRYYMD(1:6) >=  "201501"         ))
               OR  ( WK-TOKATUKAI(1) =  1                      )
                  INITIALIZE                     PTKOHINF-REC
                  MOVE    LNK-SYU-HOSPNUM    TO  PTKOH-HOSPNUM
                  MOVE    LNK-SYU-PTID       TO  PTKOH-PTID
                  IF  ( COMB-KOH1HKNNUM = "051" OR "052" OR "091" )
                  OR  ((COMB-KOH1HKNNUM      =  "054"            ) AND
                       (LNK-SYU-SRYYMD(1:6) >=  "201501"         ))
                  OR  ( WK-TOKATUKAI(1) =  1                      )
                    MOVE  COMB-KOH1ID        TO  PTKOH-KOHID
                  ELSE
                    MOVE  COMB-KOH2ID        TO  PTKOH-KOHID
                  END-IF
                  MOVE    PTKOHINF-REC       TO  MCPDATA-REC
                  MOVE    "DBSELECT"         TO  MCP-FUNC
                  MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                  MOVE    "key8"             TO  MCP-PATHNAME
                  CALL    "ORCDBMAIN"        USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                  IF      MCP-RC  =  ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key8"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    IF       FLG-PTKOHINF    =   ZERO
                       MOVE  PTKOH-FTNJANUM  TO  WK-KOH-FTNJANUM
                    END-IF
                  END-IF
                  MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                  MOVE    "key8"             TO  MCP-PATHNAME
                  PERFORM  DB-CLOSE-SEC
               END-IF
               IF (((COMB-KOH1HKNNUM = "051" OR "091"      ) OR
                    (COMB-KOH2HKNNUM = "051" OR "091"      ) OR
                    (WK-TOKATUKAI(1) =  1                  )) AND
                   ( WK-KOH-FTNJANUM(5:3) = "601" OR "602"  ) AND
                   ( WK-KOH-FTNJANUM(1:2) = "51"            ))
               OR (((COMB-KOH1HKNNUM = "052"               ) OR
                    (WK-TOKATUKAI(1) =  1                  )) AND
                   ( WK-KOH-FTNJANUM(5:2) = "60"            ) AND
                   ( WK-KOH-FTNJANUM(1:2) = "52"            ) AND
                   ( LNK-SYU-SRYYMD(1:6) <= "201412"        ))
               OR (((COMB-KOH1HKNNUM = "052"               ) OR
                    (WK-TOKATUKAI(1) =  1                  )) AND
                   ( WK-KOH-FTNJANUM(5:1) = "7" OR "8"      ) AND
                   ( WK-KOH-FTNJANUM(1:2) = "52"            ) AND
                   ( LNK-SYU-SRYYMD(1:6) >= "201501"        ))
               OR (((COMB-KOH1HKNNUM = "054"               ) OR
                    (COMB-KOH2HKNNUM = "054"               )) AND
                   ( WK-KOH-FTNJANUM(5:3) = "601" OR "501"
                                                  OR "602"  ) AND
                   ( WK-KOH-FTNJANUM(1:2) = "54"            ) AND
                   ( LNK-SYU-SRYYMD(1:6) >= "201501"        ))
               OR (((COMB-KOH1HKNNUM = "054"               ) OR
                    (COMB-KOH2HKNNUM = "054"               )) AND
                   ( WK-KOH-FTNJANUM(5:1) = "7" OR "8"      ) AND
                   ( WK-KOH-FTNJANUM(1:2) = "54"            ) AND
                   ( LNK-SYU-SRYYMD(1:6) >= "201804"        ))
               OR (  WK-KOHJGNGET-TEKIYOFLG(1) =  1          )
                 IF   COMB-HKNNUM  NOT =  SPACE
                    IF     LNK-S02-KOUREI-NYUIN-KBN  =  "1"
                    OR     FLG-KOREI-TANYUIN         =   1
                      IF    COMB-HOJOKBN    =   "3" OR "7"
                            MOVE    1    TO   FLG-TOKUSITU
                      ELSE
                        IF  FLG-SANSHOU3    =   SPACE
                           MOVE     2    TO   FLG-TOKUSITU
                        ELSE
                           MOVE     3    TO   FLG-TOKUSITU
                        END-IF
                      END-IF
                    ELSE
                      PERFORM  20021-TOKUSITU-HENSYU-SEC
                    END-IF
                    IF   FLG-TOKUSITU  NOT = ZERO
                      MOVE       1       TO   FLG-TOKUSITU-XXX
                      IF     LNK-S02-KOUREI-NYUIN-KBN  =  "1"
                      OR     FLG-KOREI-TANYUIN         =   1
                        IF   LNK-SYU-TOTAL-HKNTEN  NOT = ZERO
                          IF  (COMB-KOH1HKNNUM =
                               "051" OR "052" OR "091" OR "054")
                          OR  (WK-TOKATUKAI(1) =  1            )
                            MOVE    1    TO   LNK-SYU-SKJ-FTNDAY(3)
                          END-IF
                        END-IF
                      ELSE
                        IF   LNK-SYU-TOTAL-HKNTEN  NOT = ZERO
      ********************MOVE  "1"      TO   LNK-S02-TOKUSYU-SAI-KBN
                          IF  (COMB-KOH1HKNNUM =
                               "051" OR "052" OR "091" OR "054")
                          OR  (WK-TOKATUKAI(1) =  1            )
                            MOVE    1    TO   LNK-SYU-SKJ-FTNDAY(3)
                          END-IF
                        END-IF
                      END-IF
                      MOVE     "958"     TO   WK-HANTEI-KOHNUM
                      PERFORM    20022-TOKUSITU-TASU-HANTEI-SEC
                    END-IF
                 END-IF
                 PERFORM         20023-TOKUSITU-SKJ-HENSYU-SEC
               ELSE
                 IF   COMB-HKNNUM  NOT =  SPACE
                    IF     LNK-S02-KOUREI-NYUIN-KBN  =  "1"
                    OR     FLG-KOREI-TANYUIN         =   1
                      CONTINUE
                    ELSE
      ****************IF    LNK-S02-TOKUSYU-SAI-KBN   =  "1"
      ****************  PERFORM  20021-TOKUSITU-HENSYU-SEC
      ****************ELSE
                        INITIALIZE                    SSRHKOH-AREA
                        MOVE  LNK-SYU-PTID        TO  SSRHKOH-PTID
                        MOVE  LNK-SYU-NYUGAIKBN   TO  SSRHKOH-NYUGAIKBN
                        MOVE  LNK-SYU-SRYYMD(1:6) TO  SSRHKOH-SRYYM
                        MOVE  LNK-SYU-HKNCOMBINUM TO  SSRHKOH-HKNCOMBI
                        CALL  "ORCSSRHKOH"        USING
                                                  SSRHKOH-AREA
                                                  SPA-AREA
                        IF   SSRHKOH-RC  =  1
                          PERFORM  20021-TOKUSITU-HENSYU-SEC
                        END-IF
      ****************END-IF
                    END-IF
                 END-IF
               END-IF
      *
               IF   (COMB-KOH1HKNNUM          =  "092"   )
               AND  (LNK-SYU-SRYYMD(1:6)     >=  "201812")
                 IF   COMB-HKNNUM  NOT =  SPACE
                   IF     LNK-S02-KOUREI-NYUIN-KBN  =  "1"
                   OR     FLG-KOREI-TANYUIN         =   1
                     IF    COMB-HOJOKBN    =   "3" OR "7"
                           MOVE    1    TO   FLG-KANGAN
                     ELSE
                       IF  FLG-SANSHOU3    =   SPACE
                          MOVE     2    TO   FLG-KANGAN
                       ELSE
                          MOVE     3    TO   FLG-KANGAN
                       END-IF
                     END-IF
                   ELSE
                     PERFORM  20021X-TOKUSITU2-HENSYU-SEC
                   END-IF
                   IF   FLG-KANGAN  NOT = ZERO
                     MOVE       1       TO   FLG-KANGAN-XXX
                     IF  WK-KOHJGNGET-CHECK092(1) = ZERO
                       IF   LNK-SYU-TOTAL-HKNTEN  NOT = ZERO
                         IF     LNK-S02-KOUREI-NYUIN-KBN  =  "1"
                         OR     FLG-KOREI-TANYUIN         =   1
                           EVALUATE  FLG-KANGAN
                             WHEN       1
                               MOVE    41   TO   LNK-SYU-SKJ-FTNDAY(3)
                             WHEN       2
                               MOVE    42   TO   LNK-SYU-SKJ-FTNDAY(3)
                             WHEN       3
                               MOVE    43   TO   LNK-SYU-SKJ-FTNDAY(3)
                           END-EVALUATE
                         ELSE
                           MOVE   FLG-KANGAN-KBN
                                            TO   LNK-SYU-SKJ-FTNDAY(3)
                         END-IF
                       END-IF
                       MOVE   "945"     TO   WK-HANTEI-KOHNUM
                       PERFORM    20022-TOKUSITU-TASU-HANTEI-SEC
                     END-IF
                   ELSE
                     MOVE       1       TO   WK-KOHJGNGET-CHECK092(1)
                   END-IF
                 ELSE
                     MOVE       1       TO   WK-KOHJGNGET-CHECK092(1)
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           MOVE     ZERO        TO   FLG-MARUKO
           IF  (WK-1001-PREFNUM  =  13            )
           AND (COMB-HKNNUM  NOT =  SPACE         )
           AND (COMB-HKNNUM  NOT = "060" AND "067")
           AND (COMB-KOH1HKNNUM  = "588"          )
           AND (LNK-SYU-SRYYMD(1:6) >= "200710"   )
           AND (LNK-SYU-SRYYMD(1:6) <= "200909"   )
                   MOVE    2    TO   FLG-MARUKO
           END-IF
      *
           .
       2002-TOKUSITU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆÃÄê¼À´µÅù¤ÎÊÔ½¸
      *****************************************************************
       20021-TOKUSITU-HENSYU-SEC               SECTION.
      *
           INITIALIZE                         PTKOHINF-REC
           MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
           MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
           MOVE    "966"                  TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC           TO  MCPDATA-REC
           MOVE    "DBSELECT"             TO  MCP-FUNC
           MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
           MOVE    "key4"                 TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"            USING  MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                  AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                  AND (PTKOH-SAKJOKBN   =  SPACE         )
                     MOVE    1    TO  FLG-TOKUSITU
                     IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                      IF  PTKOH-JKYSNUM(1:2) = "¥¤"
                       MOVE  12   TO  FLG-TOKUSITU-KBN
                      ELSE
                       MOVE  11   TO  FLG-TOKUSITU-KBN
                      END-IF
                     END-IF
                     MOVE    1    TO  FLG-PTKOHINF
                  ELSE
                     MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                     MOVE    "key4"          TO  MCP-PATHNAME
                     PERFORM  PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE    "key4"             TO  MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           IF    FLG-TOKUSITU  =  ZERO
               INITIALIZE                         PTKOHINF-REC
               MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
               MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
               MOVE    "967"                  TO  PTKOH-KOHNUM
               MOVE    PTKOHINF-REC           TO  MCPDATA-REC
               MOVE    "DBSELECT"             TO  MCP-FUNC
               MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
               MOVE    "key4"                 TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"            USING  MCPAREA
                                                     MCPDATA-REC
                                                     SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                   MOVE    "key4"             TO  MCP-PATHNAME
                   PERFORM  PTKOHINF-READ-SEC
                   PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                      AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                      AND (PTKOH-SAKJOKBN   =  SPACE         )
                         IF  FLG-SANSHOU3    =   SPACE
                            MOVE    2    TO   FLG-TOKUSITU
                            IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                             IF  PTKOH-JKYSNUM(1:2) = "¥¨"
                              MOVE  22   TO   FLG-TOKUSITU-KBN
                             ELSE
                              MOVE  21   TO   FLG-TOKUSITU-KBN
                             END-IF
                            END-IF
                         ELSE
                            MOVE    3    TO   FLG-TOKUSITU
                            IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                              MOVE  31   TO   FLG-TOKUSITU-KBN
                            END-IF
                         END-IF
                         MOVE       1    TO   FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                         MOVE    "key4"          TO  MCP-PATHNAME
                         PERFORM  PTKOHINF-READ-SEC
                      END-IF
                   END-PERFORM
               END-IF
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
           END-IF
      *
      ***
      *
           IF    FLG-TOKUSITU  =  ZERO
               INITIALIZE                         PTKOHINF-REC
               MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
               MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
               MOVE    "956"                  TO  PTKOH-KOHNUM
               MOVE    PTKOHINF-REC           TO  MCPDATA-REC
               MOVE    "DBSELECT"             TO  MCP-FUNC
               MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
               MOVE    "key4"                 TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"            USING  MCPAREA
                                                     MCPDATA-REC
                                                     SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                   MOVE    "key4"             TO  MCP-PATHNAME
                   PERFORM  PTKOHINF-READ-SEC
                   PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                      AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                      AND (PTKOH-SAKJOKBN   =  SPACE         )
                         MOVE    1    TO  FLG-TOKUSITU
                         IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                          IF  PTKOH-JKYSNUM(1:2) = "¥¤"
                           MOVE  12   TO  FLG-TOKUSITU-KBN
                          ELSE
                           MOVE  11   TO  FLG-TOKUSITU-KBN
                          END-IF
                         END-IF
                         MOVE    1    TO  FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                         MOVE    "key4"          TO  MCP-PATHNAME
                         PERFORM  PTKOHINF-READ-SEC
                      END-IF
                   END-PERFORM
               END-IF
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
           END-IF
      *
           IF    FLG-TOKUSITU  =  ZERO
               INITIALIZE                         PTKOHINF-REC
               MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
               MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
               MOVE    "957"                  TO  PTKOH-KOHNUM
               MOVE    PTKOHINF-REC           TO  MCPDATA-REC
               MOVE    "DBSELECT"             TO  MCP-FUNC
               MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
               MOVE    "key4"                 TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"            USING  MCPAREA
                                                     MCPDATA-REC
                                                     SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                   MOVE    "key4"             TO  MCP-PATHNAME
                   PERFORM  PTKOHINF-READ-SEC
                   PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                      AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                      AND (PTKOH-SAKJOKBN   =  SPACE         )
                         IF  FLG-SANSHOU3    =   SPACE
                            MOVE    2    TO   FLG-TOKUSITU
                            IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                             IF  PTKOH-JKYSNUM(1:2) = "¥¨"
                              MOVE  22   TO   FLG-TOKUSITU-KBN
                             ELSE
                              MOVE  21   TO   FLG-TOKUSITU-KBN
                             END-IF
                            END-IF
                         ELSE
                            MOVE    3    TO   FLG-TOKUSITU
                            IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                              MOVE  31   TO   FLG-TOKUSITU-KBN
                            END-IF
                         END-IF
                         MOVE       1    TO   FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                         MOVE    "key4"          TO  MCP-PATHNAME
                         PERFORM  PTKOHINF-READ-SEC
                      END-IF
                   END-PERFORM
               END-IF
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
           END-IF
      *
           .
       20021-TOKUSITU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆÃÄê¼À´µÅù¤ÎÊÔ½¸£²
      *****************************************************************
       20021X-TOKUSITU2-HENSYU-SEC               SECTION.
      *
           INITIALIZE                         PTKOHINF-REC
           MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
           MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
           MOVE    "966"                  TO  PTKOH-KOHNUM
           MOVE    PTKOHINF-REC           TO  MCPDATA-REC
           MOVE    "DBSELECT"             TO  MCP-FUNC
           MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
           MOVE    "key4"                 TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"            USING  MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  PTKOHINF-READ-SEC
               PERFORM  UNTIL   FLG-PTKOHINF    =   1
                  IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                  AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                  AND (PTKOH-SAKJOKBN   =  SPACE         )
                     MOVE    1    TO  FLG-KANGAN
                     IF  PTKOH-JKYSNUM(1:2) = "¥¤"
                       MOVE  12   TO  FLG-KANGAN-KBN
                     ELSE
                       MOVE  11   TO  FLG-KANGAN-KBN
                     END-IF
                     MOVE    1    TO  FLG-PTKOHINF
                  ELSE
                     MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                     MOVE    "key4"          TO  MCP-PATHNAME
                     PERFORM  PTKOHINF-READ-SEC
                  END-IF
               END-PERFORM
           END-IF
           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE    "key4"             TO  MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           IF    FLG-KANGAN  =  ZERO
               INITIALIZE                         PTKOHINF-REC
               MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
               MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
               MOVE    "967"                  TO  PTKOH-KOHNUM
               MOVE    PTKOHINF-REC           TO  MCPDATA-REC
               MOVE    "DBSELECT"             TO  MCP-FUNC
               MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
               MOVE    "key4"                 TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"            USING  MCPAREA
                                                     MCPDATA-REC
                                                     SPA-AREA
               IF      MCP-RC               =       ZERO
                   MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                   MOVE    "key4"             TO  MCP-PATHNAME
                   PERFORM  PTKOHINF-READ-SEC
                   PERFORM  UNTIL   FLG-PTKOHINF    =   1
                      IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                      AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                      AND (PTKOH-SAKJOKBN   =  SPACE         )
                         IF  FLG-SANSHOU3    =   SPACE
                            MOVE    2    TO   FLG-KANGAN
                            IF  PTKOH-JKYSNUM(1:2) = "¥¨"
                              MOVE  22   TO   FLG-KANGAN-KBN
                            ELSE
                              MOVE  21   TO   FLG-KANGAN-KBN
                            END-IF
                         ELSE
                            MOVE    3    TO   FLG-KANGAN
                            MOVE    31   TO   FLG-KANGAN-KBN
                         END-IF
                         MOVE       1    TO   FLG-PTKOHINF
                      ELSE
                         MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                         MOVE    "key4"          TO  MCP-PATHNAME
                         PERFORM  PTKOHINF-READ-SEC
                      END-IF
                   END-PERFORM
               END-IF
               MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
               MOVE    "key4"             TO  MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
           END-IF
      *
           .
       20021X-TOKUSITU2-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆÃÄê¼À´µÅù¤ÎÂ¿¿ô³ºÅö¤ÎÈ½Äê
      *    ´Î¤¬¤ó¼£ÎÅ¤ÎÂ¿¿ô³ºÅö¤ÎÈ½Äê
      *****************************************************************
       20022-TOKUSITU-TASU-HANTEI-SEC               SECTION.
      *
           IF   (((LNK-S02-KOUREI-NYUIN-KBN  =  "1"      ) OR
                  (FLG-KOREI-TANYUIN         =   1       )) AND
                 ( FLG-TOKUSITU              =   2  OR  3 ) AND
                 ( LNK-SYU-SRYYMD(1:6)      <   "201708"  ))
           OR   (((LNK-S02-KOUREI-NYUIN-KBN  =  "1"      ) OR
                  (FLG-KOREI-TANYUIN         =   1       )) AND
                 ( FLG-TOKUSITU              =   3        ) AND
                 ( LNK-SYU-SRYYMD(1:6)      >=  "201708"  ))
           OR   (((LNK-S02-KOUREI-NYUIN-KBN  =  "1"      ) OR
                  (FLG-KOREI-TANYUIN         =   1       )) AND
                 ( FLG-KANGAN                =   3        ))
             CONTINUE
           ELSE
             INITIALIZE                         PTKOHINF-REC
             MOVE    LNK-SYU-HOSPNUM        TO  PTKOH-HOSPNUM
             MOVE    LNK-SYU-PTID           TO  PTKOH-PTID
             MOVE    WK-HANTEI-KOHNUM       TO  PTKOH-KOHNUM
             MOVE    PTKOHINF-REC           TO  MCPDATA-REC
             MOVE    "DBSELECT"             TO  MCP-FUNC
             MOVE    "tbl_ptkohinf"         TO  MCP-TABLE
             MOVE    "key4"                 TO  MCP-PATHNAME
             CALL    "ORCDBMAIN"            USING  MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
             IF      MCP-RC               =       ZERO
                 MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
                 MOVE    "key4"             TO  MCP-PATHNAME
                 PERFORM  PTKOHINF-READ-SEC
                 PERFORM  UNTIL   FLG-PTKOHINF    =   1
                    IF  (PTKOH-TEKSTYMD  <=  LNK-SYU-SRYYMD)
                    AND (LNK-SYU-SRYYMD  <=  PTKOH-TEKEDYMD)
                    AND (PTKOH-SAKJOKBN   =  SPACE         )
                       IF   WK-HANTEI-KOHNUM  =  "958"
                         MOVE  1    TO  FLG-TOKUSITU-TASU
                       END-IF
                       IF   WK-HANTEI-KOHNUM  =  "945"
                         MOVE  1    TO  FLG-KANGAN-TASU
                       END-IF
                       MOVE    1    TO  FLG-PTKOHINF
                    ELSE
                       MOVE    "tbl_ptkohinf"  TO  MCP-TABLE
                       MOVE    "key4"          TO  MCP-PATHNAME
                       PERFORM  PTKOHINF-READ-SEC
                    END-IF
                 END-PERFORM
             END-IF
             MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
             MOVE    "key4"             TO  MCP-PATHNAME
             PERFORM  DB-CLOSE-SEC
           END-IF
      *
           .
       20022-TOKUSITU-TASU-HANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆÃÄê¼À´µÅù¤Î¿©»öÊÔ½¸
      *****************************************************************
       20023-TOKUSITU-SKJ-HENSYU-SEC               SECTION.
      *
           IF  (COMB-KOH1HKNNUM      = "052"       )
           AND (WK-KOH-FTNJANUM(5:1) = "7" OR "8"  )
           AND (WK-KOH-FTNJANUM(1:2) = "52"        )
           AND (LNK-SYU-SRYYMD(1:6) >= "201501"    )
             IF   WK-KOH-FTNJANUM(5:1) = "8"
               MOVE     9     TO    WK-TOKUSITU-SKJ(1)
             END-IF
             IF   WK-KOH-FTNJANUM(5:1) = "7"
               MOVE     2     TO    WK-TOKUSITU-SKJ(1)
             END-IF
           END-IF
      *
           IF  (COMB-KOH1HKNNUM      = "054"         )
           AND (WK-KOH-FTNJANUM(5:3) = "601" OR "501"
                                             OR "602")
           AND (WK-KOH-FTNJANUM(1:2) = "54"          )
           AND (LNK-SYU-SRYYMD(1:6) >= "201501"      )
             IF   WK-KOH-FTNJANUM(5:3) = "601"
               MOVE     9     TO    WK-TOKUSITU-SKJ(1)
             END-IF
             IF   WK-KOH-FTNJANUM(5:3) = "501"
               MOVE     1     TO    WK-TOKUSITU-SKJ(1)
             END-IF
             IF   WK-KOH-FTNJANUM(5:3) = "602"
               MOVE     3     TO    WK-TOKUSITU-SKJ(1)
             END-IF
           END-IF
           IF  (COMB-KOH1HKNNUM      = "054"         )
           AND (WK-KOH-FTNJANUM(5:1) = "7" OR "8"    )
           AND (WK-KOH-FTNJANUM(1:2) = "54"          )
           AND (LNK-SYU-SRYYMD(1:6) >= "201804"      )
             IF   WK-KOH-FTNJANUM(5:1) = "8"
               MOVE     3     TO    WK-TOKUSITU-SKJ(1)
             END-IF
           END-IF
      *
           IF  (COMB-KOH2HKNNUM      = "054"         )
           AND (WK-KOH-FTNJANUM(5:3) = "601" OR "501"
                                             OR "602")
           AND (WK-KOH-FTNJANUM(1:2) = "54"          )
           AND (LNK-SYU-SRYYMD(1:6) >= "201501"      )
             IF   WK-KOH-FTNJANUM(5:3) = "601"
               MOVE     9     TO    WK-TOKUSITU-SKJ(2)
             END-IF
             IF   WK-KOH-FTNJANUM(5:3) = "501"
               MOVE     1     TO    WK-TOKUSITU-SKJ(2)
             END-IF
             IF   WK-KOH-FTNJANUM(5:3) = "602"
               MOVE     3     TO    WK-TOKUSITU-SKJ(2)
             END-IF
           END-IF
           IF  (COMB-KOH2HKNNUM      = "054"         )
           AND (WK-KOH-FTNJANUM(5:1) = "7" OR "8"    )
           AND (WK-KOH-FTNJANUM(1:2) = "54"          )
           AND (LNK-SYU-SRYYMD(1:6) >= "201804"      )
             IF   WK-KOH-FTNJANUM(5:1) = "8"
               MOVE     3     TO    WK-TOKUSITU-SKJ(2)
             END-IF
           END-IF
      *
           .
       20023-TOKUSITU-SKJ-HENSYU-EXT.
           EXIT.
      *
      ***************************************************************
      *        ´µ¼ÔÊÝ¸±¾ðÊó¸¡º÷
      ***************************************************************
       2003-PTHKNINF-KENSAKU-SEC           SECTION.
      *
           MOVE   ZERO               TO    FLG-SEISINJYO
                                           FLG-TOKUREI-HKNJYA
           MOVE   SPACE              TO    WK-HKNJANUM-TBL
           MOVE   SPACE              TO    WK-CONTKBN
           MOVE   SPACE              TO    WK-TOKU75-TEKSTYMD
           MOVE   SPACE              TO    WK-TOKU75-TEKEDYMD
      *
           INITIALIZE                      PTHKNINF-REC
           MOVE   COMB-HOSPNUM       TO    PTHKN-HOSPNUM
           MOVE   COMB-PTID          TO    PTHKN-PTID
           MOVE   COMB-HKNID         TO    PTHKN-HKNID
           MOVE   PTHKNINF-REC       TO    MCPDATA-REC
           MOVE   "DBSELECT"         TO    MCP-FUNC
           MOVE   "tbl_pthkninf"     TO    MCP-TABLE
           MOVE   "key"              TO    MCP-PATHNAME
           CALL   "ORCDBMAIN"        USING MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
           IF      MCP-RC            =     ZERO
               MOVE    "tbl_pthkninf"     TO    MCP-TABLE
               MOVE    "key"              TO    MCP-PATHNAME
               PERFORM  PTHKNINF-READ-SEC
               IF      FLG-PTHKNINF   =     ZERO
                  IF   PTHKN-HKNJANUM      = "67330753"
                      MOVE    1      TO    FLG-TOKUREI-HKNJYA
                  END-IF
                  MOVE    PTHKN-HKNJANUM   TO    WK-HKNJANUM
                  MOVE    PTHKN-HONKZKKBN  TO    WK-HONKZKKBN
      ***         MOVE    PTHKN-KIGO       TO    WK-KIGO
      ***         MOVE    PTHKN-NUM        TO    WK-NUM
                  MOVE    PTHKN-CONTKBN    TO    WK-CONTKBN
                  MOVE    PTHKN-TEKSTYMD   TO    WK-TOKU75-TEKSTYMD
                  MOVE    PTHKN-TEKEDYMD   TO    WK-TOKU75-TEKEDYMD
               END-IF
           END-IF
      *
           MOVE     "tbl_pthkninf"   TO    MCP-TABLE
           MOVE     "key"            TO    MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
      *    Ë¡Äê³°¸½ÊªµëÉÕ
           IF  (PTHKN-HKNJANUM   NOT =   SPACE                      )
           AND (COMB-KOH1HKNNUM  =  "010" OR "011" OR "020" OR "021")
             IF     LNK-SYU-SRYYMD(1:6) >= "200804"
               INITIALIZE                   SYS-2012-REC
               MOVE    "2012"           TO  SYS-2012-KANRICD
               MOVE    PTHKN-HKNJANUM   TO  SYS-2012-KBNCD
               MOVE    LNK-SYU-HOSPNUM  TO  SYS-2012-HOSPNUM
               MOVE    LNK-SYU-SRYYMD   TO  SYS-2012-STYUKYMD
               MOVE    LNK-SYU-SRYYMD   TO  SYS-2012-EDYUKYMD
               MOVE    SYS-2012-REC     TO  MCPDATA-REC
               MOVE    "DBSELECT"       TO  MCP-FUNC
               MOVE    "tbl_syskanri"   TO  MCP-TABLE
               MOVE    "key10"          TO  MCP-PATHNAME
               CALL    "ORCDBMAIN"  USING   MCPAREA
                                            MCPDATA-REC
                                            SPA-AREA
               IF      MCP-RC         =   ZERO
                  MOVE  "tbl_syskanri"  TO  MCP-TABLE
                  MOVE  "key10"         TO  MCP-PATHNAME
                  PERFORM      SYSKANRI-READ-SEC
               ELSE
                  INITIALIZE   SYS-2012-REC
               END-IF
               PERFORM   20031-HBTNUMKBN-HENSYU-SEC
               MOVE     "tbl_syskanri"  TO  MCP-TABLE
               MOVE     "key10"         TO  MCP-PATHNAME
               PERFORM      DB-CLOSE-SEC
             ELSE
               PERFORM   20032-HBTNUMKBN-HENSYU2-SEC
             END-IF
           END-IF
      *
           .
      *
       2003-PTHKNINF-KENSAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    Ë¡Äê³°¸½ÊªµëÉÕ¤ÎÀßÄêÊÔ½¸
      ******************************************************************
       20031-HBTNUMKBN-HENSYU-SEC          SECTION.
      *
           IF   COMB-KOH1HKNNUM  =  "010"
             EVALUATE  SYS-2012-HBTNUM10KBN
               WHEN      SPACE
               WHEN      "0"
                 PERFORM   20032-HBTNUMKBN-HENSYU2-SEC
               WHEN      "1"
                 MOVE       1     TO    FLG-SEISINJYO
             END-EVALUATE
           END-IF
      *
           IF   COMB-KOH1HKNNUM  =  "011"
             EVALUATE  SYS-2012-HBTNUM11KBN
               WHEN      SPACE
               WHEN      "0"
                 MOVE      ZERO   TO    FLG-SEISINJYO
               WHEN      "1"
                 MOVE       1     TO    FLG-SEISINJYO
             END-EVALUATE
           END-IF
      *
           IF   COMB-KOH1HKNNUM  =  "020"
             EVALUATE  SYS-2012-HBTNUM20KBN
               WHEN      SPACE
               WHEN      "0"
                 MOVE      ZERO   TO    FLG-SEISINJYO
               WHEN      "1"
                 MOVE       1     TO    FLG-SEISINJYO
             END-EVALUATE
           END-IF
      *
           IF   COMB-KOH1HKNNUM  =  "021"
             EVALUATE  SYS-2012-HBTNUM21KBN
               WHEN      SPACE
               WHEN      "0"
                 PERFORM   20032-HBTNUMKBN-HENSYU2-SEC
               WHEN      "1"
                 MOVE       1     TO    FLG-SEISINJYO
             END-EVALUATE
           END-IF
      *
           .
      *
       20031-HBTNUMKBN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    Ë¡Äê³°¸½ÊªµëÉÕ¤ÎÀßÄêÊÔ½¸£²
      ******************************************************************
       20032-HBTNUMKBN-HENSYU2-SEC          SECTION.
      *
           IF ((PTHKN-HKNJANUM(1:6)  =  "233064" OR "133280") AND
               (LNK-SYU-SRYYMD(1:6) <=  "201103"            ))
           OR ((PTHKN-HKNJANUM(1:6)  =  "283077"            ) AND
               (LNK-SYU-SRYYMD(1:6) <=  "201111"            ))
           OR ((PTHKN-HKNJANUM(1:6)  =
                "133033" OR "133041" OR "133066" OR "133074" OR
                "133090" OR "133116" OR "133132" OR "133140" OR
                "133157" OR "133165" OR "133173" OR "133181" OR
                "133199" OR "133207" OR "133223" OR "133249" OR
                "133256" OR "133272"                        ) AND
               (LNK-SYU-SRYYMD(1:6) <=  "201203"            ))
              IF  (WK-1001-PREFNUM     =  29     )
              AND (PTHKN-HKNJANUM(1:6) = "133033")
                CONTINUE
              ELSE
                IF   COMB-KOH1HKNNUM  =  "010" OR "021"
                    MOVE    1      TO    FLG-SEISINJYO
                END-IF
              END-IF
           END-IF
      *
           .
      *
       20032-HBTNUMKBN-HENSYU2-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÃÏÊý¸øÈñ¤Î¾å¸Â³ÛÆþÎÏÂÐ¾Ý¶èÊ¬ÊÔ½¸                            *
      ******************************************************************
       2004-TAISYOKBN-HENSYU-SEC           SECTION.
      *
           INITIALIZE        WK-TOKATUKAI-TBL
           IF ((WK-1001-PREFNUM      =  13     ) AND
               (COMB-KOH1HKNNUM      = "151"   ) AND
               (LNK-SYU-SRYYMD(1:6) >= "200905"))
           OR ((WK-1001-PREFNUM      =  23     ) AND
               (COMB-KOH1HKNNUM      = "191"   ) AND
               (LNK-SYU-SRYYMD(1:6) >= "200910"))
           OR ((WK-1001-PREFNUM   =  23 OR 24  ) AND
               (COMB-KOH1HKNNUM      = "152"   ) AND
               (LNK-SYU-SRYYMD(1:6) >= "201104") AND
               (LNK-SYU-SRYYMD(1:6) <= "201412"))
               MOVE    1     TO    WK-TOKATUKAI(1)
           END-IF
      *
           INITIALIZE        WK-KOHJGNGET-TBL
           PERFORM   VARYING   IDX-CYO   FROM    1   BY  1
                      UNTIL    IDX-CYO     >     4
             IF   COMB-KOHHKNNUM(IDX-CYO)(1:1)  >=  "1" AND <=  "8"
                INITIALIZE                    PTKOHINF-REC
                MOVE  LNK-SYU-HOSPNUM     TO  PTKOH-HOSPNUM
                MOVE  LNK-SYU-PTID        TO  PTKOH-PTID
                MOVE  COMB-KOHID(IDX-CYO) TO  PTKOH-KOHID
                MOVE  PTKOHINF-REC        TO  MCPDATA-REC
                MOVE  "DBSELECT"          TO  MCP-FUNC
                MOVE  "tbl_ptkohinf"      TO  MCP-TABLE
                MOVE  "key8"              TO  MCP-PATHNAME
                CALL  "ORCDBMAIN"         USING  MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
                IF    MCP-RC              =   ZERO
                  MOVE  "tbl_ptkohinf"    TO  MCP-TABLE
                  MOVE  "key8"            TO  MCP-PATHNAME
                  PERFORM  PTKOHINF-READ-SEC
                  IF    FLG-PTKOHINF  =   ZERO
                     MOVE   PTKOH-TEKSTYMD
                                TO  WK-KOHJGNGET-TEKSTYMD(IDX-CYO)
                  END-IF
                END-IF
                MOVE    "tbl_ptkohinf"    TO  MCP-TABLE
                MOVE    "key8"            TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
      *
                INITIALIZE                    LNK-ORCSJGNGET-REC
                MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
                MOVE  COMB-KOHHKNNUM(IDX-CYO)
                                          TO  LNK-ORCSJGNGET-KOHHKNNUM
                MOVE  WK-KOHJGNGET-TEKSTYMD(IDX-CYO)
                                          TO  LNK-ORCSJGNGET-TEKSTYMD
                MOVE  WK-1001-PREFNUM     TO  LNK-ORCSJGNGET-PREFNUM
                MOVE   "1"                TO  LNK-ORCSJGNGET-HENFLG
                CALL  "ORCSJGNGET"        USING
                                          LNK-ORCSJGNGET-REC
                                          SPA-AREA
                IF    LNK-ORCSJGNGET-RC   =   ZERO
                   MOVE   LNK-ORCSJGNGET-TAISYOKBN
                                TO  WK-KOHJGNGET-TAISYOKBN(IDX-CYO)
                   IF  (LNK-SYU-SRYYMD(1:6)     >=  "201501")
                   AND (IDX-CYO                  =   1      )
                   AND (LNK-ORCSJGNGET-TEKIYOFLG =   1      )
                   AND (WK-TOKATUKAI(IDX-CYO)    =   ZERO   )
                     MOVE   1   TO  WK-KOHJGNGET-TEKIYOFLG(IDX-CYO)
      ***************MOVE   1   TO  WK-TOKATUKAI(IDX-CYO)
                   END-IF
                END-IF
             END-IF
      *
             IF  (COMB-KOHHKNNUM(IDX-CYO)  =  "092"   )
             AND (LNK-SYU-SRYYMD(1:6)     >=  "201812")
      *         ¸øÈñ·î¾å¸Â³Û¼èÆÀ
                INITIALIZE                    LNK-ORCSJGNGET-REC
                MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
                MOVE  LNK-SYU-NYUGAIKBN   TO  LNK-ORCSJGNGET-NYUGAIKBN
                MOVE  LNK-SYU-PTID        TO  LNK-ORCSJGNGET-PTID
                MOVE  COMB-KOHHKNNUM(IDX-CYO)
                                          TO  LNK-ORCSJGNGET-KOHHKNNUM
                MOVE  COMB-KOHID(IDX-CYO) TO  LNK-ORCSJGNGET-KOHID
                MOVE  LNK-SYU-SRYYMD(1:6) TO  LNK-ORCSJGNGET-SRYYM
                MOVE  LNK-SYU-SKYEDYMD    TO  LNK-ORCSJGNGET-SKYEDYMD
                CALL    "ORCSJGNGET"       USING
                                           LNK-ORCSJGNGET-REC
                                           SPA-AREA
                IF    LNK-ORCSJGNGET-RC   =   ZERO
                  IF   (LNK-ORCSJGNGET-NYUJGNGAK  =  9999999)
                  OR   (IDX-CYO               NOT =  1      )
                    MOVE  1  TO  WK-KOHJGNGET-CHECK092(IDX-CYO)
                  END-IF
                ELSE
                    MOVE  1  TO  WK-KOHJGNGET-CHECK092(IDX-CYO)
                END-IF
             END-IF
           END-PERFORM
      *
           .
      *
       2004-TAISYOKBN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°¤ÎÊÔ½¸                                  *
      ******************************************************************
       2005-SYSKAN2010-HENSYU-SEC           SECTION.
      *
           INITIALIZE        WK-SYS2010-TBL
           PERFORM   VARYING   IDX-CYO   FROM    1   BY  1
                      UNTIL    IDX-CYO     >     4
             IF   COMB-KOHHKNNUM(IDX-CYO)(1:1)  >=  "1" AND <=  "8"
      *
               MOVE    "0"    TO   WK-2010-SKJRYOKBN-HON(IDX-CYO)
                                   WK-2010-SEIRYOKBN-HON(IDX-CYO)
                                   WK-2010-SEIKANKBN-HON(IDX-CYO)
               MOVE    "0"    TO   WK-2010-SKJRYOKBN-TSY(IDX-CYO)
                                   WK-2010-SEIRYOKBN-TSY(IDX-CYO)
                                   WK-2010-SEIKANKBN-TSY(IDX-CYO)
               MOVE    "0"    TO   WK-2010-SKJRYOKBN-TNK(IDX-CYO)
                                   WK-2010-SEIRYOKBN-TNK(IDX-CYO)
                                   WK-2010-SEIKANKBN-TNK(IDX-CYO)
      *
               IF     LNK-SYU-SRYYMD(1:6) >= "200804"
                 INITIALIZE                   SYS-2010-REC
                 MOVE    "2010"           TO  SYS-2010-KANRICD
                 MOVE    COMB-KOHHKNNUM(IDX-CYO)
                                          TO  SYS-2010-KBNCD
                 MOVE    LNK-SYU-HOSPNUM  TO  SYS-2010-HOSPNUM
                 MOVE    LNK-SYU-SRYYMD   TO  SYS-2010-STYUKYMD
                 MOVE    LNK-SYU-SRYYMD   TO  SYS-2010-EDYUKYMD
                 MOVE    SYS-2010-REC     TO  MCPDATA-REC
                 MOVE    "DBSELECT"       TO  MCP-FUNC
                 MOVE    "tbl_syskanri"   TO  MCP-TABLE
                 MOVE    "key10"          TO  MCP-PATHNAME
                 CALL    "ORCDBMAIN"  USING   MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
                 IF      MCP-RC         =   ZERO
                    MOVE  "tbl_syskanri"  TO  MCP-TABLE
                    MOVE  "key10"         TO  MCP-PATHNAME
                    PERFORM      SYSKANRI-READ-SEC
                 ELSE
                    INITIALIZE   SYS-2010-REC
                 END-IF
                 PERFORM   20051-SYSKAN2010-SET-SEC
                 MOVE     "tbl_syskanri"  TO  MCP-TABLE
                 MOVE     "key10"         TO  MCP-PATHNAME
                 PERFORM   DB-CLOSE-SEC
                 IF  (WK-2010-NYUKEIKBN-N(IDX-CYO)   = "1"       )
                 AND (WK-2010-NYUKEI-KJNYMD(IDX-CYO) > "20120101")
                   PERFORM 20056-SYSKAN2010-SET6-SEC
                 END-IF
               ELSE
                 PERFORM   20052-SYSKAN2010-SET2-SEC
                 PERFORM   20053-SYSKAN2010-SET3-SEC
                 PERFORM   20054-SYSKAN2010-SET4-SEC
                 PERFORM   20055-SYSKAN2010-SET5-SEC
                 PERFORM   20057-SYSKAN2010-SET7-SEC
               END-IF
               IF  WK-2010-IRYOKEIKBN-N(IDX-CYO) = "1"
                 PERFORM   20059-KIZONHKNNUM-CHECK-SEC
               END-IF
               PERFORM     2005A-SYSKAN2010-KURIA-SEC
             END-IF
           END-PERFORM
      *
           .
      *
       2005-SYSKAN2010-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°¤Î¥»¥Ã¥È                                *
      ******************************************************************
       20051-SYSKAN2010-SET-SEC           SECTION.
      *
           EVALUATE  SYS-2010-JGNFTNKBN
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       42
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =  "180"
                     MOVE    "1"    TO  WK-2010-JGNFTNKBN(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-JGNFTNKBN(IDX-CYO)
           END-EVALUATE
      *
           MOVE      SYS-2010-JYUHENKBN
                                    TO  WK-2010-JYUHENKBN(IDX-CYO)
           MOVE      SYS-2010-JYUHEN-TAIKBN
                                    TO  WK-2010-JYUHEN-TAIKBN(IDX-CYO)
      *
           EVALUATE  SYS-2010-IRYOKEIKBN-N
             WHEN      SPACE
               PERFORM    20052-SYSKAN2010-SET2-SEC
             WHEN       "0"
               IF   (WK-1001-PREFNUM         =   11    )
               AND  (COMB-KOHHKNNUM(IDX-CYO) =  "281"  )
               AND  (LNK-SYU-SRYYMD(1:6)    >= "200704")
               AND  (LNK-SYU-SRYYMD(1:6)    <= "201904")
                     MOVE    "1"    TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
               END-IF
             WHEN       "1"
               EVALUATE   SYS-2010-IRYOKEI-TAIKBN-N
                 WHEN      "0"
                     MOVE    "1"    TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
                 WHEN      "1"
                     IF    FLG-SANSHOU2   = "2"  OR  "3"
                       MOVE  "1"    TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
                     END-IF
               END-EVALUATE
             WHEN       "2"
               EVALUATE   SYS-2010-IRYOKEI-TAIKBN-N
                 WHEN      "0"
                     MOVE    "2"    TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
                 WHEN      "1"
                     IF    FLG-SANSHOU2   = "2"  OR  "3"
                       MOVE  "2"    TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
                     END-IF
               END-EVALUATE
             WHEN       "3"
               EVALUATE   SYS-2010-IRYOKEI-TAIKBN-N
                 WHEN      "0"
                     MOVE    "3"    TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
                 WHEN      "1"
                     IF    FLG-SANSHOU2   = "2"  OR  "3"
                       MOVE  "3"    TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
                     END-IF
               END-EVALUATE
             WHEN       "4"
               EVALUATE   SYS-2010-IRYOKEI-TAIKBN-N
                 WHEN      "0"
                     MOVE    "4"    TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
                 WHEN      "1"
                     IF    FLG-SANSHOU2   = "2"  OR  "3"
                       MOVE  "4"    TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
                     END-IF
               END-EVALUATE
           END-EVALUATE
      *
           IF     LNK-SYU-SRYYMD(1:6)    >=  "200604"
             EVALUATE  SYS-2010-SKJKEIKBN
               WHEN      SPACE
                 PERFORM    20053-SYSKAN2010-SET3-SEC
               WHEN       "0"
                 IF ((WK-1001-PREFNUM         =   11     ) AND
                     (COMB-KOHHKNNUM(IDX-CYO) =  "543"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200710" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "201109" ))
                     MOVE     "1"     TO  WK-2010-SKJKEIKBN(IDX-CYO)
                 END-IF
                 IF ((WK-1001-PREFNUM         =   11     ) AND
                     (COMB-KOHHKNNUM(IDX-CYO) =  "281"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200704" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "201009" ))
                     MOVE     "2"     TO  WK-2010-SKJKEIKBN(IDX-CYO)
                 END-IF
               WHEN       "1"
                 EVALUATE   SYS-2010-SKJKEI-TAIKBN
                   WHEN      "0"
                       MOVE    "1"    TO  WK-2010-SKJKEIKBN(IDX-CYO)
                   WHEN      "1"
                       IF    FLG-SANSHOU2   = "2"  OR  "3"
                         MOVE  "1"    TO  WK-2010-SKJKEIKBN(IDX-CYO)
                       END-IF
                 END-EVALUATE
               WHEN       "2"
                 EVALUATE   SYS-2010-SKJKEI-TAIKBN
                   WHEN      "0"
                       MOVE    "2"    TO  WK-2010-SKJKEIKBN(IDX-CYO)
                   WHEN      "1"
                       IF    FLG-SANSHOU2   = "2"  OR  "3"
                         MOVE  "2"    TO  WK-2010-SKJKEIKBN(IDX-CYO)
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           EVALUATE  SYS-2010-KINJYOKBN-N
             WHEN      SPACE
               PERFORM    20057-SYSKAN2010-SET7-SEC
             WHEN       "0"
                 IF ((WK-1001-PREFNUM         =   33     ) AND
                     (COMB-KOHHKNNUM(IDX-CYO) =  "285"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200110" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "200609" ))
                       MOVE  "1"    TO  WK-2010-KINJYOKBN-N(IDX-CYO)
                 END-IF
             WHEN       "1"
                       MOVE  "1"    TO  WK-2010-KINJYOKBN-N(IDX-CYO)
           END-EVALUATE
      *
      *****
      *
           IF     LNK-SYU-SRYYMD(1:6)    >=  "200604"
             EVALUATE  SYS-2010-SKJRYOKBN-HON
               WHEN      SPACE
                 PERFORM    20054-SYSKAN2010-SET4-SEC
               WHEN       "0"
                 MOVE         "0"     TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =
                               "352" OR "353" OR "354"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "201412" ))
                     MOVE     "2"     TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
                 END-IF
                 IF ((WK-1001-PREFNUM         =   11     ) AND
                     (COMB-KOHHKNNUM(IDX-CYO) =  "382"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200910" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "201009" ))
                     MOVE     "2"     TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
                 END-IF
                 IF ((WK-1001-PREFNUM         =   08     ) AND
                     (COMB-KOHHKNNUM(IDX-CYO) =
                               "146" OR "183" OR "185"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200511" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "200703" ))
                     MOVE     "2"     TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
                 END-IF
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
                 MOVE  SYS-2010-SKJRYOKBN-HON
                                      TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
             END-EVALUATE
      *
             EVALUATE  SYS-2010-SEIRYOKBN-HON
               WHEN      SPACE
                 PERFORM    20054-SYSKAN2010-SET4-SEC
               WHEN       "0"
                 MOVE         "0"     TO  WK-2010-SEIRYOKBN-HON(IDX-CYO)
                 IF ((WK-1001-PREFNUM         =   11     ) AND
                     (COMB-KOHHKNNUM(IDX-CYO) =  "382"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200910" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "201009" ))
                     MOVE     "2"     TO  WK-2010-SEIRYOKBN-HON(IDX-CYO)
                 END-IF
                 IF ((WK-1001-PREFNUM         =   08     ) AND
                     (COMB-KOHHKNNUM(IDX-CYO) =
                               "146" OR "183" OR "185"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200511" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "200703" ))
                     MOVE     "2"     TO  WK-2010-SEIRYOKBN-HON(IDX-CYO)
                 END-IF
                 IF ((WK-1001-PREFNUM         =   10     ) AND
                     (COMB-KOHHKNNUM(IDX-CYO) =
                      "146" OR "246" OR "177" OR "187"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200610" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "201903" ))
                     MOVE     "3"     TO  WK-2010-SEIRYOKBN-HON(IDX-CYO)
                 END-IF
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
                 MOVE  SYS-2010-SEIRYOKBN-HON
                                      TO  WK-2010-SEIRYOKBN-HON(IDX-CYO)
             END-EVALUATE
      *
             EVALUATE  SYS-2010-SEIKANKBN-HON
               WHEN      SPACE
                 PERFORM    20054-SYSKAN2010-SET4-SEC
               WHEN       "0"
                 IF ((WK-1001-PREFNUM         =   08     ) AND
                     (COMB-KOHHKNNUM(IDX-CYO) =
                               "146" OR "183" OR "185"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200511" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "200703" ))
                     MOVE     "2"     TO  WK-2010-SEIKANKBN-HON(IDX-CYO)
                 END-IF
                 IF ((WK-1001-PREFNUM         =   10     ) AND
                     (COMB-KOHHKNNUM(IDX-CYO) =
                      "146" OR "246" OR "177" OR "187"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200610" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "201903" ))
                     MOVE     "3"     TO  WK-2010-SEIKANKBN-HON(IDX-CYO)
                 END-IF
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
                 MOVE  SYS-2010-SEIKANKBN-HON
                                      TO  WK-2010-SEIKANKBN-HON(IDX-CYO)
             END-EVALUATE
      *
             EVALUATE  SYS-2010-SKJRYOKBN-TSY
               WHEN      SPACE
                 PERFORM    20054-SYSKAN2010-SET4-SEC
               WHEN       "0"
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
                 MOVE  SYS-2010-SKJRYOKBN-TSY
                                      TO  WK-2010-SKJRYOKBN-TSY(IDX-CYO)
             END-EVALUATE
      *
             EVALUATE  SYS-2010-SEIRYOKBN-TSY
               WHEN      SPACE
                 PERFORM    20054-SYSKAN2010-SET4-SEC
               WHEN       "0"
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
                 MOVE  SYS-2010-SEIRYOKBN-TSY
                                      TO  WK-2010-SEIRYOKBN-TSY(IDX-CYO)
             END-EVALUATE
      *
             EVALUATE  SYS-2010-SEIKANKBN-TSY
               WHEN      SPACE
                 PERFORM    20054-SYSKAN2010-SET4-SEC
               WHEN       "0"
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
                 MOVE  SYS-2010-SEIKANKBN-TSY
                                      TO  WK-2010-SEIKANKBN-TSY(IDX-CYO)
             END-EVALUATE
      *
             EVALUATE  SYS-2010-SKJRYOKBN-TNK
               WHEN      SPACE
                 PERFORM    20054-SYSKAN2010-SET4-SEC
               WHEN       "0"
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
                 MOVE  SYS-2010-SKJRYOKBN-TNK
                                      TO  WK-2010-SKJRYOKBN-TNK(IDX-CYO)
             END-EVALUATE
      *
             EVALUATE  SYS-2010-SEIRYOKBN-TNK
               WHEN      SPACE
                 PERFORM    20054-SYSKAN2010-SET4-SEC
               WHEN       "0"
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
                 MOVE  SYS-2010-SEIRYOKBN-TNK
                                      TO  WK-2010-SEIRYOKBN-TNK(IDX-CYO)
             END-EVALUATE
      *
             EVALUATE  SYS-2010-SEIKANKBN-TNK
               WHEN      SPACE
                 PERFORM    20054-SYSKAN2010-SET4-SEC
               WHEN       "0"
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
                 MOVE  SYS-2010-SEIKANKBN-TNK
                                      TO  WK-2010-SEIKANKBN-TNK(IDX-CYO)
             END-EVALUATE
           END-IF
      *
      *****
      *
           EVALUATE  SYS-2010-SYOKEIKBN-N
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       01
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =
                          "142" OR "143" OR "144" OR "744" OR "364"
                                         OR "443" OR "444" OR "842"
                                         OR "190" OR "291" OR "292"
                     MOVE    "1"    TO  WK-2010-SYOKEIKBN-N(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-SYOKEIKBN-N(IDX-CYO)
           END-EVALUATE
      *
           IF   LNK-SYU-SRYYMD(1:6)  >= "201201"
             EVALUATE  SYS-2010-NYUKEIKBN-N
               WHEN      SPACE
                 EVALUATE   WK-1001-PREFNUM
                   WHEN       04
                     IF   COMB-KOHHKNNUM(IDX-CYO) =  "463" OR "563"
                       MOVE    "1"    TO  WK-2010-NYUKEIKBN-N(IDX-CYO)
                       MOVE    "20120101"
                                      TO  WK-2010-NYUKEI-KJNYMD(IDX-CYO)
                     END-IF
                 END-EVALUATE
               WHEN       "1"
                 IF  SYS-2010-STYUKYMD  <=  "20120101"
                       MOVE    "1"    TO  WK-2010-NYUKEIKBN-N(IDX-CYO)
                       MOVE    "20120101"
                                      TO  WK-2010-NYUKEI-KJNYMD(IDX-CYO)
                 ELSE
                       MOVE    "1"    TO  WK-2010-NYUKEIKBN-N(IDX-CYO)
                       MOVE    SYS-2010-STYUKYMD
                                      TO  WK-2010-NYUKEI-KJNYMD(IDX-CYO)
                 END-IF
             END-EVALUATE
           END-IF
      *
           EVALUATE  SYS-2010-DAYKEIKBN-N
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       15
                     MOVE    "1"    TO  WK-2010-DAYKEIKBN-N(IDX-CYO)
                 WHEN       40
                   IF   LNK-SYU-SRYYMD(1:6)      >=  "200810"
                     MOVE    "1"    TO  WK-2010-DAYKEIKBN-N(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-DAYKEIKBN-N(IDX-CYO)
           END-EVALUATE
      *
           IF   LNK-SYU-SRYYMD(1:6)  >= "201010"
             EVALUATE  SYS-2010-NINNASIKBN
               WHEN      SPACE
                 EVALUATE   WK-1001-PREFNUM
                   WHEN       04
                     IF   COMB-KOHHKNNUM(IDX-CYO)   =
                                              "583" OR "683" OR "783"
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "363" OR "563")
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201201"       )
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "263" OR "463")
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201201"       )
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                         MOVE  "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                       END-IF
                     END-IF
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "763"         )
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201310"       )
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "663"         )
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201310"       )
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                         MOVE  "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                       END-IF
                     END-IF
                   WHEN       10
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =
                                              "145" OR "245" OR "146"
                                           OR "246" OR "143" OR "243")
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201104"       )
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                       OR ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         MOVE  "8"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                       END-IF
                     END-IF
                   WHEN       11
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "772"         )
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201304"       )
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                   WHEN       12
                     IF  (COMB-KOHHKNNUM(IDX-CYO)   =
                                              "263" OR "363" OR "463")
                     AND (LNK-SYU-SRYYMD(1:6)      >= "201203"       )
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                   WHEN       40
                     IF   COMB-KOHHKNNUM(IDX-CYO)   =  "383"
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                   WHEN       44
                     IF   COMB-KOHHKNNUM(IDX-CYO)   =  "183" OR "283"
                       MOVE    "1"    TO  WK-2010-NINNASIKBN(IDX-CYO)
                     END-IF
                 END-EVALUATE
               WHEN       "1"
               WHEN       "2"
               WHEN       "3"
               WHEN       "4"
               WHEN       "5"
               WHEN       "6"
               WHEN       "7"
               WHEN       "8"
                 EVALUATE   SYS-2010-NINNASI-TAIKBN
                   WHEN      "0"
                       MOVE  SYS-2010-NINNASIKBN
                                      TO  WK-2010-NINNASIKBN(IDX-CYO)
                   WHEN      "1"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                       OR ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         MOVE  SYS-2010-NINNASIKBN
                                      TO  WK-2010-NINNASIKBN(IDX-CYO)
                       END-IF
                   WHEN      "2"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                         MOVE  SYS-2010-NINNASIKBN
                                      TO  WK-2010-NINNASIKBN(IDX-CYO)
                       END-IF
                   WHEN      "3"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         MOVE  SYS-2010-NINNASIKBN
                                      TO  WK-2010-NINNASIKBN(IDX-CYO)
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           IF   LNK-SYU-SRYYMD(1:6)  >= "201104"
             EVALUATE  SYS-2010-NINJYOKBN
               WHEN      SPACE
               WHEN       "0"
                 EVALUATE   WK-1001-PREFNUM
                   WHEN       10
                     IF   COMB-KOHHKNNUM(IDX-CYO)   =
                                              "145" OR "245" OR "146"
                                           OR "246" OR "143" OR "243"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                       OR ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         IF   LNK-SYU-SRYYMD(1:6) <= "201412"
                           MOVE  "2"    TO  WK-2010-NINJYOKBN(IDX-CYO)
                         END-IF
                       END-IF
                     END-IF
                 END-EVALUATE
               WHEN       "1"
               WHEN       "2"
                 EVALUATE   SYS-2010-NINJYO-TAIKBN
                   WHEN      "0"
                       MOVE  SYS-2010-NINJYOKBN
                                      TO  WK-2010-NINJYOKBN(IDX-CYO)
                   WHEN      "1"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                       OR ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         MOVE  SYS-2010-NINJYOKBN
                                      TO  WK-2010-NINJYOKBN(IDX-CYO)
                       END-IF
                   WHEN      "2"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                         MOVE  SYS-2010-NINJYOKBN
                                      TO  WK-2010-NINJYOKBN(IDX-CYO)
                       END-IF
                   WHEN      "3"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         MOVE  SYS-2010-NINJYOKBN
                                      TO  WK-2010-NINJYOKBN(IDX-CYO)
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           IF   LNK-SYU-SRYYMD(1:6)  >= "201204"
             EVALUATE  SYS-2010-KOGAKKEIKBN
               WHEN       "1"
                 EVALUATE   SYS-2010-KOGAKKEI-TAIKBN
                   WHEN      "0"
                       MOVE    "1"    TO  WK-2010-KOGAKKEIKBN(IDX-CYO)
                   WHEN      "1"
                       IF   LNK-SYU-SYUHKNNUM = "060" OR "067" OR "039"
                         MOVE  "1"    TO  WK-2010-KOGAKKEIKBN(IDX-CYO)
                       END-IF
                   WHEN      "2"
                       IF  (LNK-SYU-SYUHKNNUM  NOT = SPACE)
                       AND (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039")
                         MOVE  "1"    TO  WK-2010-KOGAKKEIKBN(IDX-CYO)
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           IF   LNK-SYU-SRYYMD(1:6)  >= "201404"
             EVALUATE  SYS-2010-TANKIKBN
               WHEN       "1"
                       MOVE    "1"    TO  WK-2010-TANKIKBN(IDX-CYO)
             END-EVALUATE
           END-IF
      *
           EVALUATE  SYS-2010-KAICNTKBN-N
               WHEN       "1"
                       MOVE    "1"    TO  WK-2010-KAICNTKBN-N(IDX-CYO)
           END-EVALUATE
      *
           EVALUATE  SYS-2010-ZENDAYKBN-N
               WHEN       "1"
                       MOVE    "1"    TO  WK-2010-ZENDAYKBN-N(IDX-CYO)
           END-EVALUATE
      *
           EVALUATE  SYS-2010-CYOKEIKBN-N
               WHEN       "1"
                       MOVE    "1"    TO  WK-2010-CYOKEIKBN-N(IDX-CYO)
           END-EVALUATE
      *
           EVALUATE  SYS-2010-JIRITUKBN
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       12
                 WHEN       14
                 WHEN       26
                 WHEN       27
                 WHEN       28
                 WHEN       39
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =  "100" OR "200"
                     MOVE    "1"    TO  WK-2010-JIRITUKBN(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-JIRITUKBN(IDX-CYO)
           END-EVALUATE
      *
           EVALUATE  SYS-2010-ZENDAY2KBN-N
               WHEN       "1"
                       MOVE    "1"    TO  WK-2010-ZENDAY2KBN-N(IDX-CYO)
           END-EVALUATE
      *
           EVALUATE  SYS-2010-SYOKEI2KBN-N
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       01
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =
                                   "642" OR "643" OR "644" OR "743"
                     MOVE    "1"    TO  WK-2010-SYOKEI2KBN-N(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-SYOKEI2KBN-N(IDX-CYO)
           END-EVALUATE
      *
           IF   LNK-SYU-SRYYMD(1:6)  >= "201808"
             EVALUATE  SYS-2010-NINNASIKBN-K
               WHEN       "2"
                 EVALUATE   SYS-2010-NINNASI-TAIKBN-K
                   WHEN      "0"
                         MOVE  SYS-2010-NINNASIKBN-K
                                      TO   WK-2010-NINNASIKBN-K(IDX-CYO)
                   WHEN      "1"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                       OR ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         MOVE  SYS-2010-NINNASIKBN-K
                                      TO   WK-2010-NINNASIKBN-K(IDX-CYO)
                       END-IF
                   WHEN      "2"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM  NOT =
                                 "060" AND "067" AND "039"))
                         MOVE  SYS-2010-NINNASIKBN-K
                                      TO   WK-2010-NINNASIKBN-K(IDX-CYO)
                       END-IF
                   WHEN      "3"
                       IF ((LNK-SYU-SYUHKNNUM  NOT = SPACE) AND
                           (LNK-SYU-SYUHKNNUM      = "060") AND
                           (WK-HKNJANUM(7:2)       = SPACE) AND
                           (WK-HKNJANUM(3:1)       = "3"  ))
                         MOVE  SYS-2010-NINNASIKBN-K
                                      TO   WK-2010-NINNASIKBN-K(IDX-CYO)
                       END-IF
                 END-EVALUATE
             END-EVALUATE
           END-IF
      *
           .
      *
       20051-SYSKAN2010-SET-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°¤Î¥»¥Ã¥È£²                              *
      ******************************************************************
       20052-SYSKAN2010-SET2-SEC           SECTION.
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       07
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "245"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200412" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "246"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "445" OR "545"
                                            OR "645"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "480"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
                 MOVE    "1"    TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
               END-IF
             WHEN       11
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                    "181" OR "182" OR "183"            ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200704" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "543" OR "582"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200710" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "381"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200801" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                             "743" OR "442" OR "542"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200804" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "681" OR "682"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "683"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "781"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "783"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201004" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "372" OR "373"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201101" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "462" OR "762"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201112" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "672"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "281"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200704" ) AND
                   (LNK-SYU-SRYYMD(1:6)    <= "201904" ))
                 MOVE    "1"    TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
               END-IF
             WHEN       43
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "341" OR "442"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200912" ))
                 MOVE    "1"    TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           .
      *
       20052-SYSKAN2010-SET2-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°¤Î¥»¥Ã¥È£³                              *
      ******************************************************************
       20053-SYSKAN2010-SET3-SEC           SECTION.
      *
           IF     LNK-SYU-SRYYMD(1:6)    >=  "200604"
      *
             EVALUATE   WK-1001-PREFNUM
               WHEN       07
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                        "445" OR "545"
                                              OR "645"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
                 OR ((COMB-KOHHKNNUM(IDX-CYO) =  "480"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
                   MOVE    "1"    TO  WK-2010-SKJKEIKBN(IDX-CYO)
                 END-IF
               WHEN       11
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =  "582"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200710" ))
                 OR ((COMB-KOHHKNNUM(IDX-CYO) =
                               "743" OR "442" OR "542"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200804" ))
                 OR ((COMB-KOHHKNNUM(IDX-CYO) =  "781"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
                 OR ((COMB-KOHHKNNUM(IDX-CYO) =  "381"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200801" ))
                 OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                        "372" OR "373"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "201101" ))
                 OR ((COMB-KOHHKNNUM(IDX-CYO) =  "543"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200710" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "201109" ))
                 OR ((COMB-KOHHKNNUM(IDX-CYO) =  "672"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
                   MOVE    "1"    TO  WK-2010-SKJKEIKBN(IDX-CYO)
                 END-IF
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =  "281"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200704" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "201009" ))
                 OR ((COMB-KOHHKNNUM(IDX-CYO) =  "682"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
                 OR ((COMB-KOHHKNNUM(IDX-CYO) =  "683"   ) AND
                     (FLG-SANSHOU2        =   "2" OR "3" ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
                   MOVE    "2"    TO  WK-2010-SKJKEIKBN(IDX-CYO)
                 END-IF
             END-EVALUATE
      *
           END-IF
      *
           .
      *
       20053-SYSKAN2010-SET3-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°¤Î¥»¥Ã¥È£´                              *
      ******************************************************************
       20054-SYSKAN2010-SET4-SEC           SECTION.
      *
           IF     LNK-SYU-SRYYMD(1:6)    >=  "200604"
      *
             EVALUATE   WK-1001-PREFNUM
               WHEN       04
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                        "183" OR "483"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200510" ))
                 OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                        "583" OR "783"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "201010" ))
                 OR ((COMB-KOHHKNNUM(IDX-CYO) =
                      "263" OR "363" OR "463" OR "563"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "201310" ))
                   MOVE    "2"    TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
                 END-IF
               WHEN       08
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =
                               "146" OR "183" OR "185"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200511" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "200703" ))
                   MOVE    "2"    TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
                                      WK-2010-SEIRYOKBN-HON(IDX-CYO)
                                      WK-2010-SEIKANKBN-HON(IDX-CYO)
                 END-IF
               WHEN       10
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =
                      "143" OR "243"                     ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200610" ))
                   MOVE    "3"    TO  WK-2010-SEIRYOKBN-HON(IDX-CYO)
                                      WK-2010-SEIKANKBN-HON(IDX-CYO)
                 END-IF
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =
                      "146" OR "246" OR "177" OR "187"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200610" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "201903" ))
                   MOVE    "3"    TO  WK-2010-SEIRYOKBN-HON(IDX-CYO)
                                      WK-2010-SEIKANKBN-HON(IDX-CYO)
                 END-IF
               WHEN       11
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =
                               "352" OR "353" OR "354"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "201412" ))
                   MOVE    "2"    TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
                 END-IF
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =  "683"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
                   MOVE    "2"    TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
                                      WK-2010-SEIRYOKBN-HON(IDX-CYO)
                                      WK-2010-SEIKANKBN-HON(IDX-CYO)
                 END-IF
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =  "382"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200910" ) AND
                     (LNK-SYU-SRYYMD(1:6)    <= "201009" ))
                   MOVE    "2"    TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
                                      WK-2010-SEIRYOKBN-HON(IDX-CYO)
                 END-IF
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =  "672"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
                   MOVE    "1"    TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
                   MOVE    "3"    TO  WK-2010-SEIRYOKBN-HON(IDX-CYO)
                   MOVE    "3"    TO  WK-2010-SEIKANKBN-HON(IDX-CYO)
                 END-IF
               WHEN       15
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =
                      "261" OR "361" OR "561" OR "264" OR
                      "364" OR "564" OR "298"            ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200610" ))
                   MOVE    "3"    TO  WK-2010-SEIRYOKBN-HON(IDX-CYO)
                                      WK-2010-SEIKANKBN-HON(IDX-CYO)
                 END-IF
                 IF ((COMB-KOHHKNNUM(IDX-CYO) =  "198"   ) AND
                     (LNK-SYU-SRYYMD(1:6)    >= "200610" ))
                   MOVE    "3"    TO  WK-2010-SEIRYOKBN-TSY(IDX-CYO)
                                      WK-2010-SEIKANKBN-TSY(IDX-CYO)
                                      WK-2010-SEIRYOKBN-TNK(IDX-CYO)
                                      WK-2010-SEIKANKBN-TNK(IDX-CYO)
                 END-IF
             END-EVALUATE
      *
           END-IF
      *
           .
      *
       20054-SYSKAN2010-SET4-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°¤Î¥»¥Ã¥È£µ                              *
      ******************************************************************
       20055-SYSKAN2010-SET5-SEC           SECTION.
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       01
               IF  (COMB-KOHHKNNUM(IDX-CYO)   =
                      "142" OR "143" OR "144" OR "744" OR "364"
                                     OR "443" OR "444" OR "842")
               AND (LNK-SYU-SRYYMD(1:6)      >= "200410"       )
                 MOVE    "1"    TO  WK-2010-SYOKEIKBN-N(IDX-CYO)
               END-IF
               IF  (COMB-KOHHKNNUM(IDX-CYO)   =
                                        "190" OR "291" OR "292")
               AND (LNK-SYU-SRYYMD(1:6)      >= "200708"       )
                 MOVE    "1"    TO  WK-2010-SYOKEIKBN-N(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       15
                 MOVE    "1"    TO  WK-2010-DAYKEIKBN-N(IDX-CYO)
           END-EVALUATE
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       12
             WHEN       14
             WHEN       26
             WHEN       27
             WHEN       28
             WHEN       39
               IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "100" OR "200")
               AND (LNK-SYU-SRYYMD(1:6)      >= "200604"       )
                 MOVE    "1"    TO  WK-2010-JIRITUKBN(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           EVALUATE  SYS-2010-SYOKEI2KBN-N
             WHEN      SPACE
               EVALUATE   WK-1001-PREFNUM
                 WHEN       01
                   IF   COMB-KOHHKNNUM(IDX-CYO)   =
                                   "642" OR "643" OR "644" OR "743"
                     MOVE    "1"    TO  WK-2010-SYOKEI2KBN-N(IDX-CYO)
                   END-IF
               END-EVALUATE
             WHEN       "1"
                     MOVE    "1"    TO  WK-2010-SYOKEI2KBN-N(IDX-CYO)
           END-EVALUATE
      *
           .
      *
       20055-SYSKAN2010-SET5-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°¤Î¥»¥Ã¥È£¶                              *
      ******************************************************************
       20056-SYSKAN2010-SET6-SEC           SECTION.
      *
           MOVE     ZERO             TO  FLG-OK
      *
           INITIALIZE                    SYS-2010-REC
           MOVE     "2010"           TO  SYS-2010-KANRICD
           MOVE     COMB-KOHHKNNUM(IDX-CYO)
                                     TO  SYS-2010-KBNCD
           MOVE     LNK-SYU-HOSPNUM  TO  SYS-2010-HOSPNUM
           MOVE     SYS-2010-REC     TO  MCPDATA-REC
           MOVE     "DBSELECT"       TO  MCP-FUNC
           MOVE     "tbl_syskanri"   TO  MCP-TABLE
           MOVE     "key8"           TO  MCP-PATHNAME
           CALL     "ORCDBMAIN"      USING   MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
           IF       MCP-RC           =   ZERO
             MOVE   "tbl_syskanri"   TO  MCP-TABLE
             MOVE   "key8"           TO  MCP-PATHNAME
             PERFORM      SYSKANRI-READ-SEC
             PERFORM  UNTIL  (FLG-SYSKANRI  =  1)
                       OR    (FLG-OK        =  1)
               IF    SYS-2010-STYUKYMD  >=
                                  WK-2010-NYUKEI-KJNYMD(IDX-CYO)
                 CONTINUE
               ELSE
                 IF  SYS-2010-NYUKEIKBN-N  =  "1"
                   IF  SYS-2010-STYUKYMD  <=  "20120101"
                     MOVE  "20120101"
                              TO  WK-2010-NYUKEI-KJNYMD(IDX-CYO)
                   ELSE
                     MOVE  SYS-2010-STYUKYMD
                              TO  WK-2010-NYUKEI-KJNYMD(IDX-CYO)
                   END-IF
                 ELSE
                   MOVE   1   TO  FLG-OK
                 END-IF
               END-IF
               MOVE "tbl_syskanri"   TO  MCP-TABLE
               MOVE "key8"           TO  MCP-PATHNAME
               PERFORM    SYSKANRI-READ-SEC
             END-PERFORM
           END-IF
           MOVE     "tbl_syskanri"   TO  MCP-TABLE
           MOVE     "key8"           TO  MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           .
      *
       20056-SYSKAN2010-SET6-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°¤Î¥»¥Ã¥È£·                              *
      ******************************************************************
       20057-SYSKAN2010-SET7-SEC           SECTION.
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       13
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "182" OR "382"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200610" ))
                 MOVE    "1"    TO  WK-2010-KINJYOKBN-N(IDX-CYO)
               END-IF
             WHEN       14
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "182"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200610" ))
                 MOVE    "1"    TO  WK-2010-KINJYOKBN-N(IDX-CYO)
               END-IF
             WHEN       33
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "285"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200110" ) AND
                   (LNK-SYU-SRYYMD(1:6)    <= "200609" ))
                 MOVE    "1"    TO  WK-2010-KINJYOKBN-N(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           .
      *
       20057-SYSKAN2010-SET7-EXT.
           EXIT.
      *
      ******************************************************************
      *    ´ûÂ¸Ê¬ÊÝ¸±ÈÖ¹æ¥Á¥§¥Ã¥¯                                      *
      ******************************************************************
       20059-KIZONHKNNUM-CHECK-SEC           SECTION.
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       07
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "245"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200412" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "246"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "445" OR "545"
                                            OR "645"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200604" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "480"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
                 MOVE    "1"    TO  WK-2010-IRYOKEIKBN-N-XXX(IDX-CYO)
               END-IF
             WHEN       11
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                    "181" OR "182" OR "183" OR "281"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200704" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "543" OR "582"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200710" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "381"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200801" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                             "743" OR "442" OR "542"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200804" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "681" OR "682"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "683"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "781"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "783"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201004" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "372" OR "373"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201101" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "462" OR "762"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201112" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "672"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "201210" ))
                 MOVE    "1"    TO  WK-2010-IRYOKEIKBN-N-XXX(IDX-CYO)
               END-IF
             WHEN       43
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "341" OR "442"   ) AND
                   (LNK-SYU-SRYYMD(1:6)    >= "200912" ))
                 MOVE    "1"    TO  WK-2010-IRYOKEIKBN-N-XXX(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           .
      *
       20059-KIZONHKNNUM-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°¤Î¥»¥Ã¥È¥¯¥ê¥¢                          *
      ******************************************************************
       2005A-SYSKAN2010-KURIA-SEC           SECTION.
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       07
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "245"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200412" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "246"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200604" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "445" OR "545"
                                            OR "645"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200604" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "480"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201210" ))
                 MOVE    SPACE  TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
               END-IF
             WHEN       11
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                    "181" OR "182" OR "183" OR "281"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200704" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "543" OR "582"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200710" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "381"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200801" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                             "743" OR "442" OR "542"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200804" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "681" OR "682"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "683"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "781"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "783"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201004" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "372" OR "373"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201101" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "462" OR "762"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201112" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "672"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201210" ))
                 MOVE    SPACE  TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
               END-IF
             WHEN       43
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "341" OR "442"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200912" ))
                 MOVE    SPACE  TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
               END-IF
           END-EVALUATE
           IF    FLG-FTNRATE100 = IDX-CYO
                 MOVE    SPACE  TO  WK-2010-IRYOKEIKBN-N(IDX-CYO)
           END-IF
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       07
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "480"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201210" ))
                 MOVE    SPACE  TO  WK-2010-SKJKEIKBN(IDX-CYO)
               END-IF
             WHEN       11
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "582"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200710" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                             "743" OR "442" OR "542"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200804" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "781"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "381"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200801" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "372" OR "373"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201101" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "281"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200704" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "682"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "683"   ) AND
                   (FLG-SANSHOU2        =   "2" OR "3" ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "672"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201210" ))
                 MOVE    SPACE  TO  WK-2010-SKJKEIKBN(IDX-CYO)
               END-IF
           END-EVALUATE
           IF    FLG-FTNRATE100 = IDX-CYO
                 MOVE    SPACE  TO  WK-2010-SKJKEIKBN(IDX-CYO)
           END-IF
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       13
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "182" OR "382"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200610" ))
                 MOVE    SPACE  TO  WK-2010-KINJYOKBN-N(IDX-CYO)
               END-IF
             WHEN       14
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "182"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200610" ))
                 MOVE    SPACE  TO  WK-2010-KINJYOKBN-N(IDX-CYO)
               END-IF
           END-EVALUATE
           IF    FLG-FTNRATE100 = IDX-CYO
                 MOVE    SPACE  TO  WK-2010-KINJYOKBN-N(IDX-CYO)
           END-IF
      *
           IF   (WK-2010-IRYOKEIKBN-N(IDX-CYO)  NOT = SPACE)
           AND  (WK-2010-KINJYOKBN-N(IDX-CYO)   NOT = SPACE)
                 MOVE    SPACE  TO  WK-2010-KINJYOKBN-N(IDX-CYO)
           END-IF
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       04
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                                      "583" OR "783"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201010" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =
                    "263" OR "363" OR "463" OR "563"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201310" ))
                 MOVE    "0"    TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
               END-IF
             WHEN       10
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                    "146" OR "246" OR "143" OR "243" OR
                    "177" OR "187"                     ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200610" ))
                 MOVE    "0"    TO  WK-2010-SEIRYOKBN-HON(IDX-CYO)
                                    WK-2010-SEIKANKBN-HON(IDX-CYO)
               END-IF
             WHEN       11
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "683"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200904" ))
               OR ((COMB-KOHHKNNUM(IDX-CYO) =  "672"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "201210" ))
                 MOVE    "0"    TO  WK-2010-SKJRYOKBN-HON(IDX-CYO)
                                    WK-2010-SEIRYOKBN-HON(IDX-CYO)
                                    WK-2010-SEIKANKBN-HON(IDX-CYO)
               END-IF
             WHEN       15
               IF ((COMB-KOHHKNNUM(IDX-CYO) =
                    "261" OR "361" OR "561" OR "264" OR
                    "364" OR "564" OR "298"            ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200610" ))
                 MOVE    "0"    TO  WK-2010-SEIRYOKBN-HON(IDX-CYO)
                                    WK-2010-SEIKANKBN-HON(IDX-CYO)
               END-IF
               IF ((COMB-KOHHKNNUM(IDX-CYO) =  "198"   ) AND
                   (LNK-SYU-SRYYMD(1:6)     < "200610" ))
                 MOVE    "0"    TO  WK-2010-SEIRYOKBN-TSY(IDX-CYO)
                                    WK-2010-SEIKANKBN-TSY(IDX-CYO)
                                    WK-2010-SEIRYOKBN-TNK(IDX-CYO)
                                    WK-2010-SEIKANKBN-TNK(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       01
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                    "142" OR "143" OR "144" OR "744" OR "364"
                                   OR "443" OR "444" OR "842")
               AND (LNK-SYU-SRYYMD(1:6)     < "200410"       )
                 MOVE    SPACE  TO  WK-2010-SYOKEIKBN-N(IDX-CYO)
               END-IF
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                                      "190" OR "291" OR "292")
               AND (LNK-SYU-SRYYMD(1:6)     < "200708"       )
                 MOVE    SPACE  TO  WK-2010-SYOKEIKBN-N(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       40
               IF   LNK-SYU-SRYYMD(1:6)     < "200810"
                 MOVE    SPACE  TO  WK-2010-DAYKEIKBN-N(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       04
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                      "363" OR "563" OR "263" OR "463")
               AND (LNK-SYU-SRYYMD(1:6)     < "201201")
                 MOVE    SPACE  TO  WK-2010-NINNASIKBN(IDX-CYO)
               END-IF
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                                        "663" OR "763")
               AND (LNK-SYU-SRYYMD(1:6)     < "201310")
                 MOVE    SPACE  TO  WK-2010-NINNASIKBN(IDX-CYO)
               END-IF
             WHEN       10
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                               "145" OR "245" OR "146"
                            OR "246" OR "143" OR "243")
               AND (LNK-SYU-SRYYMD(1:6)     < "201104")
                 MOVE    SPACE  TO  WK-2010-NINNASIKBN(IDX-CYO)
               END-IF
             WHEN       11
               IF  (COMB-KOHHKNNUM(IDX-CYO) =  "772"  )
               AND (LNK-SYU-SRYYMD(1:6)     < "201304")
                 MOVE    SPACE  TO  WK-2010-NINNASIKBN(IDX-CYO)
               END-IF
             WHEN       12
               IF  (COMB-KOHHKNNUM(IDX-CYO) =
                               "263" OR "363" OR "463")
               AND (LNK-SYU-SRYYMD(1:6)     < "201203")
                 MOVE    SPACE  TO  WK-2010-NINNASIKBN(IDX-CYO)
               END-IF
           END-EVALUATE
           IF  COMB-HKNNUM  =  SPACE
                 MOVE    SPACE  TO  WK-2010-NINNASIKBN(IDX-CYO)
           END-IF
      *
           IF   (WK-2010-KAICNTKBN-N(IDX-CYO)   NOT = SPACE)
           AND  (WK-2010-NYUKEIKBN-N(IDX-CYO)   NOT = SPACE)
                 MOVE    SPACE  TO  WK-2010-KAICNTKBN-N(IDX-CYO)
           END-IF
      *
           IF   (WK-2010-CYOKEIKBN-N(IDX-CYO)   NOT = SPACE)
           AND  (WK-2010-NYUKEIKBN-N(IDX-CYO)   NOT = SPACE)
                 MOVE    SPACE  TO  WK-2010-CYOKEIKBN-N(IDX-CYO)
           END-IF
      *
           EVALUATE   WK-1001-PREFNUM
             WHEN       12
             WHEN       14
             WHEN       26
             WHEN       27
             WHEN       28
             WHEN       39
               IF  (COMB-KOHHKNNUM(IDX-CYO)   =  "100" OR "200")
               AND (LNK-SYU-SRYYMD(1:6)       <  "200604"      )
                 MOVE    SPACE  TO  WK-2010-JIRITUKBN(IDX-CYO)
               END-IF
           END-EVALUATE
      *
           IF    LNK-SYU-SRYYMD(1:6)  <  "201501"
             IF  WK-2010-SKJRYOKBN-HON(IDX-CYO)  =  "4"
               MOVE    "0"    TO   WK-2010-SKJRYOKBN-HON(IDX-CYO)
             END-IF
             IF  WK-2010-SEIRYOKBN-HON(IDX-CYO)  =  "4"
               MOVE    "0"    TO   WK-2010-SEIRYOKBN-HON(IDX-CYO)
             END-IF
             IF  WK-2010-SEIKANKBN-HON(IDX-CYO)  =  "4"
               MOVE    "0"    TO   WK-2010-SEIKANKBN-HON(IDX-CYO)
             END-IF
             IF  WK-2010-SKJRYOKBN-TSY(IDX-CYO)  =  "4"
               MOVE    "0"    TO   WK-2010-SKJRYOKBN-TSY(IDX-CYO)
             END-IF
             IF  WK-2010-SEIRYOKBN-TSY(IDX-CYO)  =  "4"
               MOVE    "0"    TO   WK-2010-SEIRYOKBN-TSY(IDX-CYO)
             END-IF
             IF  WK-2010-SEIKANKBN-TSY(IDX-CYO)  =  "4"
               MOVE    "0"    TO   WK-2010-SEIKANKBN-TSY(IDX-CYO)
             END-IF
             IF  WK-2010-SKJRYOKBN-TNK(IDX-CYO)  =  "4"
               MOVE    "0"    TO   WK-2010-SKJRYOKBN-TNK(IDX-CYO)
             END-IF
             IF  WK-2010-SEIRYOKBN-TNK(IDX-CYO)  =  "4"
               MOVE    "0"    TO   WK-2010-SEIRYOKBN-TNK(IDX-CYO)
             END-IF
             IF  WK-2010-SEIKANKBN-TNK(IDX-CYO)  =  "4"
               MOVE    "0"    TO   WK-2010-SEIKANKBN-TNK(IDX-CYO)
             END-IF
           END-IF
      *
           .
      *
       2005A-SYSKAN2010-KURIA-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÊÝ¸±¡¦¸øÈñ¤ÎÀßÄê¾å¸Â¶â³Û¤Î¼èÆÀ¡¡¡¡¡¡¡¡¡¡                *
      ******************************************************************
       210-HOKEN-KAISU-SEC           SECTION.
      *
           INITIALIZE         WK-CHIHOU-FLG-TAIHI-AREA.
      *
           PERFORM    210B-TOKU75-SETTEI-SEC.
      *
      *    ´µ¼ÔÉéÃ´¶â»»½ÐÁ°¤Î£±£°£°¡óÉéÃ´³Û»»½Ð
           MOVE      ZERO      TO      WK-ZENGAKU.
           PERFORM   VARYING   IDX9    FROM    1   BY  1
                     UNTIL     IDX9       >   16
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +
                            (LNK-SYU-HKNTEN (IDX9) *  10)
           END-PERFORM.
      *
           INITIALIZE        WK-CYO-OKIKAE-TBL.
           IF    LNK-SYU-SRYYMD(1:6)   >=  "200901"
             PERFORM   VARYING   IDX-CYO   FROM    1   BY  1
                        UNTIL    IDX-CYO     >     4
               IF  (COMB-KOHHKNNUM(IDX-CYO)(1:1)  >=  "1" AND <=  "8")
               AND (FLG-FTNRATE100                 =   ZERO          )
                  IF ( WK-2010-IRYOKEIKBN-N(IDX-CYO)
                                                   =  "1" OR "2")
                  OR ( WK-KOHJGNGET-TAISYOKBN(IDX-CYO)
                                               NOT =  ZERO      )
                  OR ( WK-2010-KINJYOKBN-N(IDX-CYO)   =  "1"    )
                  OR ((WK-1001-PREFNUM         =  43           ) AND
                      (COMB-KOHHKNNUM(IDX-CYO) = "143" OR "342") AND
                      (LNK-SYU-SRYYMD(1:6)    >= "200912"      ))
                    MOVE     ZERO     TO   WK-CYO-OKIKAE(IDX-CYO)
                  ELSE
                    MOVE     1        TO   WK-CYO-OKIKAE(IDX-CYO)
                  END-IF
               END-IF
             END-PERFORM
           END-IF.
      *
      *    *¸øÈñ£±¤Î¾å¸Â¶â³Û¼è¹þ¤ß
           IF (COMB-KOH1HKNNUM           NOT =  SPACE)    AND
              (COMB-KOH1-NYUJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH1HKNNUM    TO    HKN-HKNNUM
               IF     COMB-KOH1HKNNUM    =     "027"
                       MOVE     COMB-KOH1PAYKBN
                                         TO    WK-PAYKBN
               ELSE
                       MOVE     "00"     TO    WK-PAYKBN
               END-IF
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                       OR
                  ((HKN-TEKSTYMD(1:6)     <=  LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <=  HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            =  HKN-PAYKBN))
                     MOVE     "tbl_hknnum"    TO    MCP-TABLE
                     MOVE     "key2"          TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   2103-KOH1-KAISU-SEC
                 END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"     TO    MCP-TABLE
               MOVE     "key2"           TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           ELSE
      *
               IF     COMB-KOH1HKNNUM(1:1) >= "1" AND <= "8"
                    MOVE   "1"           TO    FLG-CHIHOU2(1)
               END-IF
      *
               IF  ((LNK-S02-KOUREI-NYUIN-KBN =   "1") OR
                    (FLG-KOREI-TANYUIN        =    1 ))
               AND (COMB-KOH1HKNNUM           =  "010")
                    MOVE   WK-KOH-GENDOGAKU
                                       TO   MAX-KIN-KOHI1-M
                    MOVE    "1"        TO   COMB-KOH1-NYUJGNKBN
                    IF  FLG-TOKU75 = 1 OR 2
                       MOVE  WK-KOH-GENDOGAKU-TOKU75
                                       TO   MAX-KIN-KOHI1-M-TOKU75
                    END-IF
               END-IF
               IF ((FLG-GENBUTU70   NOT =   ZERO) AND
                   (COMB-KOH1HKNNUM     =  "010"))
               OR ((FLG-TOKU75-CYO      =   3   ) AND
                   (COMB-KOH1HKNNUM     =  "010"))
               OR ((FLG-CYOKI-ARI       =   2   ) AND
                   (COMB-KOH1HKNNUM     =  "010"))
                    MOVE   WK-GEN70-GENDOGAKU
                                       TO   MAX-KIN-KOHI1-M
                    MOVE    "1"        TO   COMB-KOH1-NYUJGNKBN
                    EVALUATE  WK-GEN70-GENDOGAKU
                      WHEN       80100
                        MOVE  WK-ZENGAKU TO WK-KOUREI-IRYOHI70K
                        MOVE  1          TO FLG-IRYOHI70K
                    END-EVALUATE
                    IF  FLG-TOKU75 = 3
                        MOVE     WK-GEN70-GENDOGAKU-TOKU75
                                     TO    MAX-KIN-KOHI1-M-TOKU75
                        EVALUATE  WK-GEN70-GENDOGAKU-TOKU75
                          WHEN       40050
                            MOVE  WK-ZENGAKU TO
                                  WK-KOUREI-IRYOHI70K-TOKU75
                        END-EVALUATE
                    END-IF
               END-IF
      *
               IF    (COMB-KOH1HKNNUM       =  "021"   )
               AND   (LNK-SYU-SRYYMD(1:6)   >= "200604")
                  CONTINUE
               ELSE
                 IF    COMB-KOH1HKNNUM       =  "010" OR "021"
                     IF    FLG-SEISINJYO  =   1
                        MOVE   ZERO   TO    MAX-KIN-KOHI1-M
                        MOVE   SPACE  TO    COMB-KOH1-NYUJGNKBN
                        MOVE   ZERO   TO    FLG-IRYOHI70K
                     END-IF
                 END-IF
               END-IF
      *
               IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
               AND ( COMB-KOH1HKNNUM(1:1)        >=       "1"  )
               AND ( COMB-KOH1HKNNUM(1:1)        <=       "8"  )
               AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
                 IF   WK-1001-PREFNUM       NOT   =
                                     20 AND 15 AND 22 AND 18 AND 03
                    MOVE   40200   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                    MOVE    "1"    TO    FLG-CHIHOU(1)
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  11   ) AND
                   ( COMB-KOH1HKNNUM(2:2)    = "41"  )
                 IF (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  22             ) AND
                   ( COMB-KOH1HKNNUM         = "184" OR "185"  )
                 IF (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  13             ) AND
                   ( COMB-KOH1HKNNUM         = "180" OR "380"  )
                 IF (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  33   ) AND
                   ( COMB-KOH1HKNNUM(2:2)    = "80"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)  >= "200610")
                 IF (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI1-M
                    MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF    WK-CYO-OKIKAE(1)  =  1
                   IF (COMB-KOH2HKNNUM         = "972") OR
                      (COMB-KOH3HKNNUM         = "972") OR
                      (COMB-KOH4HKNNUM         = "972")
                      MOVE   10000   TO    MAX-KIN-KOHI1-M
                      MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(1)
                      MOVE    "1"    TO    FLG-CHIHOU3(1)
                   END-IF
                   IF (COMB-KOH2HKNNUM         = "974") OR
                      (COMB-KOH3HKNNUM         = "974") OR
                      (COMB-KOH4HKNNUM         = "974")
                      MOVE   20000   TO    MAX-KIN-KOHI1-M
                      MOVE    "1"    TO    COMB-KOH1-NYUJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(1)
                      MOVE    "1"    TO    FLG-CHIHOU3(1)
                   END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM       =  35 OR 34)
               AND ( COMB-KOH1HKNNUM       = "781"    )
               AND ( LNK-SYU-SRYYMD(1:6)  >= "201309" )
                   IF  MAX-KIN-KOHI1-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI1-M
                      MOVE  "1"        TO   COMB-KOH1-NYUJGNKBN
                   END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM       =  23            )
               AND ( COMB-KOH1HKNNUM       = "781" OR "271" )
               AND ( LNK-SYU-SRYYMD(1:6)  >= "201504"       )
                   IF  MAX-KIN-KOHI1-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI1-M
                      MOVE  "1"        TO   COMB-KOH1-NYUJGNKBN
                   END-IF
               END-IF
      *
           END-IF.
      *
      *    *¸øÈñ£²¤Î¾å¸Â¶â³Û¼è¹þ¤ß
           IF (COMB-KOH2HKNNUM           NOT = SPACE)    AND
              (COMB-KOH2-NYUJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH2HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                      OR
                  ((HKN-TEKSTYMD(1:6)     <= LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <= HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            = HKN-PAYKBN))
                     MOVE     "tbl_hknnum"    TO    MCP-TABLE
                     MOVE     "key2"          TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   2104-KOH2-KAISU-SEC
                 END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"  TO    MCP-TABLE
               MOVE     "key2"        TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           ELSE
      *
               IF     COMB-KOH2HKNNUM(1:1) >= "1" AND <= "8"
                    MOVE   "1"           TO    FLG-CHIHOU2(2)
               END-IF
      *
               IF  (LNK-S02-KOUREI-NYUIN-KBN  =   "1" )
               AND (COMB-KOH2HKNNUM           =  "010")
                    MOVE   WK-KOH-GENDOGAKU
                                       TO   MAX-KIN-KOHI2-M
                    MOVE    "1"        TO   COMB-KOH2-NYUJGNKBN
               END-IF
      *
               IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
               AND ( COMB-KOH2HKNNUM(1:1)        >=       "1"  )
               AND ( COMB-KOH2HKNNUM(1:1)        <=       "8"  )
               AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
                 IF   WK-1001-PREFNUM       NOT   =
                                     20 AND 15 AND 22 AND 18 AND 03
                    MOVE   40200   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                    MOVE    "1"    TO    FLG-CHIHOU(2)
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  11   ) AND
                   ( COMB-KOH2HKNNUM(2:2)    = "41"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  22             ) AND
                   ( COMB-KOH2HKNNUM         = "184" OR "185"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  13             ) AND
                   ( COMB-KOH2HKNNUM         = "180" OR "380"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  33   ) AND
                   ( COMB-KOH2HKNNUM(2:2)    = "80"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)  >= "200610")
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI2-M
                    MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF    WK-CYO-OKIKAE(2)  =  1
                   IF (COMB-KOH1HKNNUM         = "972") OR
                      (COMB-KOH3HKNNUM         = "972") OR
                      (COMB-KOH4HKNNUM         = "972")
                      MOVE   10000   TO    MAX-KIN-KOHI2-M
                      MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(2)
                      MOVE    "1"    TO    FLG-CHIHOU3(2)
                   END-IF
                   IF (COMB-KOH1HKNNUM         = "974") OR
                      (COMB-KOH3HKNNUM         = "974") OR
                      (COMB-KOH4HKNNUM         = "974")
                      MOVE   20000   TO    MAX-KIN-KOHI2-M
                      MOVE    "1"    TO    COMB-KOH2-NYUJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(2)
                      MOVE    "1"    TO    FLG-CHIHOU3(2)
                   END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM       =  35 OR 34)
               AND ( COMB-KOH2HKNNUM       = "781"    )
               AND ( LNK-SYU-SRYYMD(1:6)  >= "201309" )
                   IF  MAX-KIN-KOHI2-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI2-M
                      MOVE  "1"        TO   COMB-KOH2-NYUJGNKBN
                   END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM       =  23            )
               AND ( COMB-KOH2HKNNUM       = "781" OR "271" )
               AND ( LNK-SYU-SRYYMD(1:6)  >= "201504"       )
                   IF  MAX-KIN-KOHI2-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI2-M
                      MOVE  "1"        TO   COMB-KOH2-NYUJGNKBN
                   END-IF
               END-IF
      *
           END-IF.
      *
      *    *¸øÈñ£³¤Î¾å¸Â¶â³Û¼è¹þ¤ß
           IF (COMB-KOH3HKNNUM           NOT = SPACE)    AND
              (COMB-KOH3-NYUJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH3HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                      OR
                  ((HKN-TEKSTYMD(1:6)     <= LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <= HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            = HKN-PAYKBN))
                     MOVE     "tbl_hknnum"    TO    MCP-TABLE
                     MOVE     "key2"          TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   2105-KOH3-KAISU-SEC
                 END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"  TO    MCP-TABLE
               MOVE     "key2"        TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           ELSE
      *
               IF     COMB-KOH3HKNNUM(1:1) >= "1" AND <= "8"
                    MOVE   "1"           TO    FLG-CHIHOU2(3)
               END-IF
      *
               IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
               AND ( COMB-KOH3HKNNUM(1:1)        >=       "1"  )
               AND ( COMB-KOH3HKNNUM(1:1)        <=       "8"  )
               AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
                 IF   WK-1001-PREFNUM       NOT   =
                                     20 AND 15 AND 22 AND 18 AND 03
                    MOVE   40200   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                    MOVE    "1"    TO    FLG-CHIHOU(3)
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  11   ) AND
                   ( COMB-KOH3HKNNUM(2:2)    = "41"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  22             ) AND
                   ( COMB-KOH3HKNNUM         = "184" OR "185"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  13             ) AND
                   ( COMB-KOH3HKNNUM         = "180" OR "380"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  33   ) AND
                   ( COMB-KOH3HKNNUM(2:2)    = "80"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)  >= "200610")
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH4HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH4HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI3-M
                    MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF    WK-CYO-OKIKAE(3)  =  1
                   IF (COMB-KOH1HKNNUM         = "972") OR
                      (COMB-KOH2HKNNUM         = "972") OR
                      (COMB-KOH4HKNNUM         = "972")
                      MOVE   10000   TO    MAX-KIN-KOHI3-M
                      MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(3)
                      MOVE    "1"    TO    FLG-CHIHOU3(3)
                   END-IF
                   IF (COMB-KOH1HKNNUM         = "974") OR
                      (COMB-KOH2HKNNUM         = "974") OR
                      (COMB-KOH4HKNNUM         = "974")
                      MOVE   20000   TO    MAX-KIN-KOHI3-M
                      MOVE    "1"    TO    COMB-KOH3-NYUJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(3)
                      MOVE    "1"    TO    FLG-CHIHOU3(3)
                   END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM       =  35 OR 34)
               AND ( COMB-KOH3HKNNUM       = "781"    )
               AND ( LNK-SYU-SRYYMD(1:6)  >= "201309" )
                   IF  MAX-KIN-KOHI3-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI3-M
                      MOVE  "1"        TO   COMB-KOH3-NYUJGNKBN
                   END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM       =  23            )
               AND ( COMB-KOH3HKNNUM       = "781" OR "271" )
               AND ( LNK-SYU-SRYYMD(1:6)  >= "201504"       )
                   IF  MAX-KIN-KOHI3-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI3-M
                      MOVE  "1"        TO   COMB-KOH3-NYUJGNKBN
                   END-IF
               END-IF
      *
           END-IF.
      *
      *    *¸øÈñ£´¤Î¾å¸Â¶â³Û¼è¹þ¤ß
           IF (COMB-KOH4HKNNUM           NOT = SPACE)    AND
              (COMB-KOH4-NYUJGNKBN       =     "1")
               INITIALIZE                      HKNNUM-REC
               MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM
               MOVE   COMB-KOH4HKNNUM    TO    HKN-HKNNUM
               MOVE     "00"             TO    WK-PAYKBN
               MOVE   HKNNUM-REC         TO    MCPDATA-REC
               MOVE   "DBSELECT"         TO    MCP-FUNC
               MOVE   "tbl_hknnum"       TO    MCP-TABLE
               MOVE   "key2"             TO    MCP-PATHNAME
               CALL   "ORCDBMAIN"        USING MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
               IF      MCP-RC            =     ZERO
                 MOVE    "tbl_hknnum"    TO    MCP-TABLE
                 MOVE    "key2"          TO    MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 PERFORM  UNTIL
                   (FLG-HKNNUM     =    1)                       OR
                  ((HKN-TEKSTYMD(1:6)     <= LNK-SYU-SRYYMD(1:6)  ) AND
                   (LNK-SYU-SRYYMD(1:6)   <= HKN-TEKEDYMD(1:6))     AND
                   (WK-PAYKBN            = HKN-PAYKBN))
                     MOVE     "tbl_hknnum"    TO    MCP-TABLE
                     MOVE     "key2"          TO    MCP-PATHNAME
                     PERFORM   HKNNUM-READ-SEC
                 END-PERFORM
                 IF     FLG-HKNNUM         =       0
                        PERFORM   2106-KOH4-KAISU-SEC
                 END-IF
               END-IF
      *
               MOVE     "tbl_hknnum"  TO    MCP-TABLE
               MOVE     "key2"        TO    MCP-PATHNAME
               PERFORM   DB-CLOSE-SEC
           ELSE
      *
               IF     COMB-KOH4HKNNUM(1:1) >= "1" AND <= "8"
                    MOVE   "1"           TO    FLG-CHIHOU2(4)
               END-IF
      *
               IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
               AND ( COMB-KOH4HKNNUM(1:1)        >=       "1"  )
               AND ( COMB-KOH4HKNNUM(1:1)        <=       "8"  )
               AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
                 IF   WK-1001-PREFNUM       NOT   =
                                     20 AND 15 AND 22 AND 18 AND 03
                    MOVE   40200   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                    MOVE    "1"    TO    FLG-CHIHOU(4)
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  11   ) AND
                   ( COMB-KOH4HKNNUM(2:2)    = "41"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  22             ) AND
                   ( COMB-KOH4HKNNUM         = "184" OR "185"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  13             ) AND
                   ( COMB-KOH4HKNNUM         = "180" OR "380"  )
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM         =  33   ) AND
                   ( COMB-KOH4HKNNUM(2:2)    = "80"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)  >= "200610")
                 IF (COMB-KOH1HKNNUM         = "972") OR
                    (COMB-KOH2HKNNUM         = "972") OR
                    (COMB-KOH3HKNNUM         = "972")
                    MOVE   10000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
                 IF (COMB-KOH1HKNNUM         = "974") OR
                    (COMB-KOH2HKNNUM         = "974") OR
                    (COMB-KOH3HKNNUM         = "974")
                    MOVE   20000   TO    MAX-KIN-KOHI4-M
                    MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                 END-IF
               END-IF
      *
               IF    WK-CYO-OKIKAE(4)  =  1
                   IF (COMB-KOH1HKNNUM         = "972") OR
                      (COMB-KOH2HKNNUM         = "972") OR
                      (COMB-KOH3HKNNUM         = "972")
                      MOVE   10000   TO    MAX-KIN-KOHI4-M
                      MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(4)
                      MOVE    "1"    TO    FLG-CHIHOU3(4)
                   END-IF
                   IF (COMB-KOH1HKNNUM         = "974") OR
                      (COMB-KOH2HKNNUM         = "974") OR
                      (COMB-KOH3HKNNUM         = "974")
                      MOVE   20000   TO    MAX-KIN-KOHI4-M
                      MOVE    "1"    TO    COMB-KOH4-NYUJGNKBN
                      MOVE    "1"    TO    FLG-CHIHOU(4)
                      MOVE    "1"    TO    FLG-CHIHOU3(4)
                   END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM       =  35 OR 34)
               AND ( COMB-KOH4HKNNUM       = "781"    )
               AND ( LNK-SYU-SRYYMD(1:6)  >= "201309" )
                   IF  MAX-KIN-KOHI4-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI4-M
                      MOVE  "1"        TO   COMB-KOH4-NYUJGNKBN
                   END-IF
               END-IF
      *
               IF  ( WK-1001-PREFNUM       =  23            )
               AND ( COMB-KOH4HKNNUM       = "781" OR "271" )
               AND ( LNK-SYU-SRYYMD(1:6)  >= "201504"       )
                   IF  MAX-KIN-KOHI4-M   =  ZERO
                      MOVE  99999999   TO   MAX-KIN-KOHI4-M
                      MOVE  "1"        TO   COMB-KOH4-NYUJGNKBN
                   END-IF
               END-IF
      *
           END-IF.
      *
      *    ËÌ³¤Æ»¡¦ÆÃÄê¼À´µ¡Ê£°£µ£±¡Ë¡ÊÆ»Ã±ÆÈ»ö¶È¡Ë
      *
           INITIALIZE        WK-DOTANDOKU-TBL.
      *
           IF     (WK-1001-PREFNUM         =  01     )
           AND    (LNK-SYU-SRYYMD(1:6)    >= "200510")
           AND    (LNK-SYU-SRYYMD(1:6)    <  "200810")
      *
             PERFORM    VARYING   KOH-IDX    FROM   1   BY   1
                         UNTIL    KOH-IDX      >    4
      *
              IF  COMB-KOHHKNNUM(KOH-IDX) = "051"
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    COMB-KOHID(KOH-IDX)  TO  PTKOH-KOHID
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key8"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key8"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    IF       FLG-PTKOHINF    =       ZERO
                      IF  PTKOH-JKYSNUM(1:2) >= "91" AND <= "95"
                         MOVE    1    TO   WK-DOTANDOKU(KOH-IDX)
                         MOVE    1    TO   WK-DOTANDOKUFLG(KOH-IDX)
                      END-IF
                      IF  PTKOH-JKYSNUM(1:2) >= "71" AND <= "88"
                         MOVE    1    TO   WK-DOTANDOKU(KOH-IDX)
                      END-IF
                    END-IF
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key8"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-IF
      *
             END-PERFORM
      *
           END-IF.
      *
           IF     (WK-1001-PREFNUM         =  01     )
           AND    (LNK-SYU-SRYYMD(1:6)    >= "200810")
      *
             PERFORM    VARYING   KOH-IDX    FROM   1   BY   1
                         UNTIL    KOH-IDX      >    4
      *
              IF  COMB-KOHHKNNUM(KOH-IDX) = "183"
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    COMB-KOHID(KOH-IDX)  TO  PTKOH-KOHID
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key8"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key8"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    IF       FLG-PTKOHINF    =       ZERO
                      IF  PTKOH-JKYSNUM(1:2) >= "91" AND <= "95"
                         MOVE    1    TO   WK-DOTANDOKUFLG(KOH-IDX)
                      END-IF
                    END-IF
                END-IF
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key8"               TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
              END-IF
      *
             END-PERFORM
      *
           END-IF.
      *
      *    ´µ¼Ô¸øÈñÉéÃ´¡Ê¶â³Û¡Ë¼è¤ê¹þ¤ß
           IF    LNK-SYU-SRYYMD(1:6)   <   "200304"
               CONTINUE
           ELSE
               PERFORM   2107-KOHFTN-KINGAKU-SEC
           END-IF.
      *
           IF  (FLG-GENBUTU70       NOT =   ZERO  )
           AND (FLG-OITA-GENBUTU70      =   ZERO  )
           AND (LNK-SYU-SRYYMD(1:6)    >= "201204")
             IF    (COMB-KOH1HKNNUM(1:1) = "0" )
             OR    (COMB-KOH2HKNNUM(1:1) = "0" )
             OR    (COMB-KOH3HKNNUM(1:1) = "0" )
             OR    (COMB-KOH4HKNNUM(1:1) = "0" )
             OR    (COMB-KOH1HKNNUM(1:2) = "99")
             OR    (COMB-KOH2HKNNUM(1:2) = "99")
             OR    (COMB-KOH3HKNNUM(1:2) = "99")
             OR    (COMB-KOH4HKNNUM(1:2) = "99")
               CONTINUE
             ELSE
               IF ((COMB-KOH1HKNNUM(1:1)    >= "1" AND <= "8") AND
                   (WK-2010-KOGAKKEIKBN(1)   = "1"           ))
               OR ((COMB-KOH1HKNNUM          = "092"         ) AND
                   (WK-KOHJGNGET-CHECK092(1) =  1            ) AND
                   (COMB-KOH2HKNNUM(1:1)    >= "1" AND <= "8") AND
                   (WK-2010-KOGAKKEIKBN(2)   = "1"           ))
                   MOVE     9     TO    LNK-SYU-SKJ-FTNGAKU(3)
               END-IF
             END-IF
           END-IF.
      *
      *    £·£°ºÐÌ¤Ëþ¸½ÊªµëÉÕ¤Î¼ýÇ¼¥Þ¥¹¥¿¸¡º÷
           INITIALIZE         WK-SYUNOU-GENBUTU70-TABLE.
           INITIALIZE         WK-SYUNOU-GENBUTU70T-TABLE.
           MOVE   ZERO   TO   WK-SYUNOU-GENBUTU70-KEISAN.
           MOVE   ZERO   TO   WK-SYUNOU-GENBUTU70-FTNRATE.
           IF    LNK-SYU-SRYYMD(1:6)   >=  "201204"
             PERFORM       210E-SYUNOU-FTNRATE-HENSYU-SEC
             IF  (FLG-GENBUTU70           NOT =   ZERO)
             AND (FLG-OITA-GENBUTU70          =   ZERO)
               IF   LNK-S02-TEIKI-KBN  =  "X"
                 CONTINUE
               ELSE
                 PERFORM 210C-SYUNOU-GEN70-KENSAKU-SEC
                 PERFORM 210D-SYUNOU-GEN70-HENSYU-SEC
               END-IF
             END-IF
           END-IF.
      *
      *    ÆàÎÉ¸©ÃÏÊý¸øÈñ¡Ê£±£·£³¡¢£±£¸£³¡¢£±£¹£³¡Ë¤Ë´Ø¤ï¤ë¼ýÇ¼¥Þ¥¹¥¿¸¡º÷
           INITIALIZE         WK-CHIHOU-SANTEIDAY-TBL.
           MOVE   ZERO   TO   WK-CHIHOU-SANTEIDAY-CNT.
           IF   (WK-1001-PREFNUM       =  29     )
           AND  (LNK-SYU-SRYYMD(1:6)  >= "201908")
             IF  (COMB-KOH1HKNNUM  = "173" OR "183" OR "193")
             OR  (COMB-KOH2HKNNUM  = "173" OR "183" OR "193")
             OR  (COMB-KOH3HKNNUM  = "173" OR "183" OR "193")
             OR  (COMB-KOH4HKNNUM  = "173" OR "183" OR "193")
               IF   LNK-S02-TEIKI-KBN  =  "X"
                 CONTINUE
               ELSE
                 PERFORM 210F-SYUNOU-NARA-KENSAKU-SEC
               END-IF
               PERFORM  VARYING  IDZ  FROM  1  BY  1
                         UNTIL  (IDZ                    >   10  )
                           OR   (LNK2-SYU-SKYSTYMD(IDZ) =  SPACE)
                 IF  LNK-SYU-SKYSTYMD(1:6) = LNK2-SYU-SKYSTYMD(IDZ)(1:6)
                   MOVE   LNK2-SYUNOU-REC(IDZ)    TO SYU-SYUNOU-REC
                   IF  (SYU-KOH1HKNNUM  = "173" OR "183" OR "193")
                   OR  (SYU-KOH2HKNNUM  = "173" OR "183" OR "193")
                   OR  (SYU-KOH3HKNNUM  = "173" OR "183" OR "193")
                   OR  (SYU-KOH4HKNNUM  = "173" OR "183" OR "193")
                     IF SYU-DAYINFFLG   = "1"
                       MOVE LNK-WRK-SYUDAY-REC(IDZ) TO SYU-SYUDAY-REC
                     ELSE
                       INITIALIZE  SYU-SYUDAY-REC
                     END-IF
                     MOVE    2     TO    FLG-NARA
                     PERFORM 210F1-SYUNOU-NARA-CNT-SEC
                   END-IF
                 END-IF
               END-PERFORM
               PERFORM 210G-SYUNOU-NARA-HENSYU-SEC
             END-IF
           END-IF.
      *
           MOVE   ZERO   TO   WK-CYOKI-SYUMAXKIN.
      *
           IF  LNK-S02-KOUREI-NYUIN-KBN   =   "1"
               IF  COMB-KOH1-HKNKOHSBTKBN   =   "3"
                   EVALUATE   COMB-KOH1PAYKBN
                       WHEN   "01"
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           MOVE  "1"          TO   COMB-KOH1-NYUJGNKBN
                           IF  FLG-SANSHOU3     =   SPACE               
                               MOVE   44400   TO   MAX-KIN-KOHI1-M
                           ELSE
                             IF  FLG-SANSHOU3     =   "1" OR "4"
                               MOVE   15000   TO   MAX-KIN-KOHI1-M
                             ELSE
                               MOVE   24600   TO   MAX-KIN-KOHI1-M
                             END-IF
                           END-IF
                         ELSE
                           MOVE  "1"          TO   COMB-KOH1-NYUJGNKBN
                           IF  FLG-SANSHOU3     =   SPACE               
                               MOVE   40200   TO   MAX-KIN-KOHI1-M
                           ELSE
                             IF  FLG-SANSHOU3     =   "1" OR "4"
                               MOVE   15000   TO   MAX-KIN-KOHI1-M
                             ELSE
                               MOVE   24600   TO   MAX-KIN-KOHI1-M
                             END-IF
                           END-IF
                         END-IF
                       WHEN   "02"
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           MOVE  "1"          TO   COMB-KOH1-NYUJGNKBN
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                           OR   FLG-KOHYONKAIME      =  1
                             MOVE   44400       TO   MAX-KIN-KOHI1-M
                           ELSE
                             MOVE   80100       TO   MAX-KIN-KOHI1-M
                             IF  (COMB-KOH2HKNNUM    =  SPACE)              
                             AND (COMB-KOH3HKNNUM    =  SPACE)
                             AND (COMB-KOH4HKNNUM    =  SPACE)
                               MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                               MOVE   1           TO   FLG-IRYOHI
                             END-IF
                           END-IF
                         ELSE
                           MOVE  "1"          TO   COMB-KOH1-NYUJGNKBN
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                           OR   FLG-KOHYONKAIME      =  1
                             MOVE   40200       TO   MAX-KIN-KOHI1-M
                           ELSE
                             MOVE   72300       TO   MAX-KIN-KOHI1-M
                             IF  (COMB-KOH2HKNNUM    =  SPACE)              
                             AND (COMB-KOH3HKNNUM    =  SPACE)
                             AND (COMB-KOH4HKNNUM    =  SPACE)
                               MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                               MOVE   1           TO   FLG-IRYOHI
                             END-IF
                           END-IF
                         END-IF
                       WHEN   "03"
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           MOVE  "1"          TO   COMB-KOH1-NYUJGNKBN
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                           OR   FLG-KOHYONKAIME      =  1
                             MOVE   44400       TO   MAX-KIN-KOHI1-M
                           ELSE
                             MOVE   80100       TO   MAX-KIN-KOHI1-M
                             IF  (COMB-KOH2HKNNUM    =  SPACE)              
                             AND (COMB-KOH3HKNNUM    =  SPACE)
                             AND (COMB-KOH4HKNNUM    =  SPACE)
                               MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                               MOVE   1           TO   FLG-IRYOHI
                             END-IF
                           END-IF
                         END-IF
                   END-EVALUATE
               ELSE
      ***        IF   FLG-ZEROKOGAITO   =   1
      ***          IF    LNK-SYU-SRYYMD(1:6)  >=  "201708"
      ***            MOVE   57600   TO   MAX-KIN-SYU-M
      ***          ELSE
      ***            MOVE   44400   TO   MAX-KIN-SYU-M
      ***          END-IF
      ***        ELSE
                   EVALUATE   COMB-HOJOKBN
                       WHEN   "1"
                       WHEN   "5"
                       WHEN   "9"
                        IF     LNK-SYU-SRYYMD(1:6)   >=  "201708"
                           IF  FLG-SANSHOU3      =   SPACE
                             IF  FLG-KOHYONKAIME    =   1
                               MOVE   44400   TO   MAX-KIN-SYU-M
                             ELSE
                               MOVE   57600   TO   MAX-KIN-SYU-M
                             END-IF
                           ELSE
                             IF  FLG-SANSHOU3     =   "1" OR "4"
                               MOVE   15000   TO   MAX-KIN-SYU-M
                             ELSE
                               MOVE   24600   TO   MAX-KIN-SYU-M
                             END-IF
                           END-IF
                        ELSE
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           IF  FLG-SANSHOU3      =   SPACE              
                               MOVE   44400   TO   MAX-KIN-SYU-M
                           ELSE
                             IF  FLG-SANSHOU3     =   "1" OR "4"
                               MOVE   15000   TO   MAX-KIN-SYU-M
                             ELSE
                               MOVE   24600   TO   MAX-KIN-SYU-M
                             END-IF
                           END-IF
                         ELSE
                           IF  FLG-SANSHOU3      =   SPACE              
                               MOVE   40200   TO   MAX-KIN-SYU-M
                           ELSE
                             IF  FLG-SANSHOU3     =   "1" OR "4"
                               MOVE   15000   TO   MAX-KIN-SYU-M
                             ELSE
                               MOVE   24600   TO   MAX-KIN-SYU-M
                             END-IF
                           END-IF
                         END-IF
                        END-IF
                       WHEN   "2"
                       WHEN   "6"
                       WHEN   "8"
                        IF     LNK-SYU-SRYYMD(1:6)   >=  "201708"
                             IF  FLG-SANSHOU3      =   SPACE
                               IF  FLG-KOHYONKAIME    =   1
                                 MOVE   44400   TO   MAX-KIN-SYU-M
                               ELSE
                                 MOVE   57600   TO   MAX-KIN-SYU-M
                               END-IF
                             ELSE
                               IF  FLG-SANSHOU3     =   "1" OR "4"
                                 MOVE   15000   TO   MAX-KIN-SYU-M
                               ELSE
                                 MOVE   24600   TO   MAX-KIN-SYU-M
                               END-IF
                             END-IF
                        ELSE
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200804"
                             IF  FLG-SANSHOU3      =   SPACE
                                 MOVE   44400   TO   MAX-KIN-SYU-M
                             ELSE
                               IF  FLG-SANSHOU3     =   "1" OR "4"
                                 MOVE   15000   TO   MAX-KIN-SYU-M
                               ELSE
                                 MOVE   24600   TO   MAX-KIN-SYU-M
                               END-IF
                             END-IF
                         ELSE
                          IF   LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                           OR   FLG-KOHYONKAIME      =  1
                             MOVE   44400       TO   MAX-KIN-SYU-M
                           ELSE
                             MOVE   80100       TO   MAX-KIN-SYU-M
                             IF  (COMB-KOH1HKNNUM    =  SPACE
                                                     OR "970")
                             AND (COMB-KOH2HKNNUM    =  SPACE)
                             AND (COMB-KOH3HKNNUM    =  SPACE)
                             AND (COMB-KOH4HKNNUM    =  SPACE)
                               MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                               MOVE   2           TO   FLG-IRYOHI
                             END-IF
                           END-IF
                          ELSE
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                           OR   FLG-KOHYONKAIME      =  1
                             MOVE   40200       TO   MAX-KIN-SYU-M
                           ELSE
                             MOVE   72300       TO   MAX-KIN-SYU-M
                             IF  (COMB-KOH1HKNNUM    =  SPACE
                                                     OR "970")
                             AND (COMB-KOH2HKNNUM    =  SPACE)
                             AND (COMB-KOH3HKNNUM    =  SPACE)
                             AND (COMB-KOH4HKNNUM    =  SPACE)
                               MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                               MOVE   2           TO   FLG-IRYOHI
                             END-IF
                           END-IF
                          END-IF
                         END-IF
                        END-IF
                       WHEN   "3"
                       WHEN   "7"
                        IF     LNK-SYU-SRYYMD(1:6)   >=  "201808"
                          EVALUATE   FLG-KOUREI-GENEKIKBN
                            WHEN         1
                              MOVE     252600   TO   MAX-KIN-SYU-M
                              IF  FLG-KOHYONKAIME = 1
                                 MOVE  140100   TO   MAX-KIN-SYU-M
                              END-IF
                            WHEN         2
                              MOVE     167400   TO   MAX-KIN-SYU-M
                              IF  FLG-KOHYONKAIME = 1
                                 MOVE   93000   TO   MAX-KIN-SYU-M
                              END-IF
                            WHEN         3
                              MOVE      80100   TO   MAX-KIN-SYU-M
                              IF  FLG-KOHYONKAIME = 1
                                 MOVE   44400   TO   MAX-KIN-SYU-M
                              END-IF
                          END-EVALUATE
                          IF  (COMB-KOH1HKNNUM  =  SPACE OR "970")
                          AND (COMB-KOH2HKNNUM  =  SPACE         )
                          AND (COMB-KOH3HKNNUM  =  SPACE         )
                          AND (COMB-KOH4HKNNUM  =  SPACE         )
                          AND (FLG-KOHYONKAIME  =  ZERO          )
                            MOVE    WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                            EVALUATE   FLG-KOUREI-GENEKIKBN
                              WHEN         1
                                MOVE    1       TO   FLG-IRYOHIKG
                              WHEN         2
                                MOVE    2       TO   FLG-IRYOHIKG
                              WHEN         3
                                MOVE    3       TO   FLG-IRYOHIKG
                            END-EVALUATE
                          END-IF
                        ELSE
                         IF    LNK-SYU-SRYYMD(1:6)   >=  "200610"
                           IF   FLG-KEIKASOCHI-IPAN  =  1
                           OR   FLG-KOHYONKAIME      =  1
                             MOVE   44400       TO   MAX-KIN-SYU-M
                           ELSE
                             MOVE   80100       TO   MAX-KIN-SYU-M
                             IF  (COMB-KOH1HKNNUM    =  SPACE
                                                     OR "970")
                             AND (COMB-KOH2HKNNUM    =  SPACE)
                             AND (COMB-KOH3HKNNUM    =  SPACE)
                             AND (COMB-KOH4HKNNUM    =  SPACE)
                               MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                               MOVE   2           TO   FLG-IRYOHI
                             END-IF
                           END-IF
                         END-IF
                        END-IF
                   END-EVALUATE
      ***        END-IF
                 IF    FLG-TOKU75  =  1 OR 2
                    COMPUTE  MAX-KIN-SYU-M  =
                             MAX-KIN-SYU-M  /  2
                 END-IF
                 MOVE    MAX-KIN-SYU-M   TO  WK-CYOKI-SYUMAXKIN
               END-IF
           END-IF.
      *
           IF  ( LNK-S02-KOUREI-NYUIN-KBN     =      "1"   )
           AND ( COMB-HKNNUM            NOT   =     SPACE  )
      *
                IF   COMB-KOH1HKNNUM      =    "027"
                   IF (( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH4HKNNUM(1:2)   =     "99"))
                   OR (( COMB-KOH2HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( WK-DOTANDOKU(2)        =      1  ) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( WK-DOTANDOKU(2)        =      1  ) AND
                       ( COMB-KOH3HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH3HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                          IF   MAX-KIN-KOHI1-M    =  72300 OR 80100
                             MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                             MOVE   1           TO   FLG-IRYOHI3
                             MOVE   21          TO   FLG-IRYOHI3X
                          END-IF
                   ELSE
                    IF   ( COMB-KOH2HKNNUM   =   "012" )
                    OR   ( COMB-KOH3HKNNUM   =   "012" )
                    OR   ( COMB-KOH4HKNNUM   =   "012" )
                        IF   MAX-KIN-KOHI1-M   >  15000
                            MOVE   15000   TO   MAX-KIN-KOHI1-M
                        END-IF
                    ELSE
                     IF   ( COMB-KOH2HKNNUM  =   "972" )
                     OR   ( COMB-KOH3HKNNUM  =   "972" )
                     OR   ( COMB-KOH4HKNNUM  =   "972" )
                        IF   MAX-KIN-KOHI1-M   >  10000
                            MOVE   10000   TO   MAX-KIN-KOHI1-M
                        END-IF
                     ELSE
                      IF  ( COMB-KOH2HKNNUM  =   "974" )
                      OR  ( COMB-KOH3HKNNUM  =   "974" )
                      OR  ( COMB-KOH4HKNNUM  =   "974" )
                        IF   MAX-KIN-KOHI1-M   >  20000
                            MOVE   20000   TO   MAX-KIN-KOHI1-M
                        END-IF
                      ELSE
                        IF  (COMB-KOH2HKNNUM(1:1) = "0")
                        OR  (COMB-KOH3HKNNUM(1:1) = "0")
                        OR  (COMB-KOH4HKNNUM(1:1) = "0")
                           CONTINUE
                        END-IF
                      END-IF
                     END-IF
                    END-IF
                   END-IF
                ELSE
                   IF (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH2HKNNUM        =    SPACE) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH2HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( COMB-KOH1HKNNUM(1:2)   =     "99") AND
                       ( COMB-KOH2HKNNUM        =    SPACE) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( WK-DOTANDOKU(1)        =      1  ) AND
                       ( COMB-KOH2HKNNUM        =    SPACE) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                   OR (( WK-DOTANDOKU(1)        =      1  ) AND
                       ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                       ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                       ( COMB-KOH3HKNNUM        =    SPACE) AND
                       ( COMB-KOH4HKNNUM        =    SPACE))
                          IF  (COMB-HOJOKBN  =  "3" OR "7")
                          AND (FLG-TOKUSITU-XXX    =  1   )
                          AND (FLG-KOHYONKAIME     =  ZERO)
                            IF    LNK-SYU-SRYYMD(1:6)  >=  "201808"
                              EVALUATE   FLG-KOUREI-GENEKIKBN
                                WHEN         1
                                  IF  FLG-TOKUSITU-TASU = 1
                                     MOVE 140100   TO  MAX-KIN-SYU-M
                                  END-IF
                                WHEN         2
                                  IF  FLG-TOKUSITU-TASU = 1
                                     MOVE  93000   TO  MAX-KIN-SYU-M
                                  END-IF
                                WHEN         3
                                  IF  FLG-TOKUSITU-TASU = 1
                                     MOVE  44400   TO  MAX-KIN-SYU-M
                                  END-IF
                              END-EVALUATE
                              IF  FLG-TOKUSITU-TASU  =  ZERO
                                MOVE  WK-ZENGAKU   TO  WK-KOUREI-IRYOHI
                                EVALUATE  FLG-KOUREI-GENEKIKBN
                                  WHEN       1
                                    MOVE  1        TO  FLG-IRYOHIKG2
                                  WHEN       2
                                    MOVE  2        TO  FLG-IRYOHIKG2
                                  WHEN       3
                                    MOVE  3        TO  FLG-IRYOHIKG2
                                END-EVALUATE
                              ELSE
                                IF   FLG-TOKU75  =  1 OR 2
                                  COMPUTE  MAX-KIN-SYU-M  =
                                           MAX-KIN-SYU-M  /  2
                                END-IF
                              END-IF
                            ELSE
                              IF  LNK-SYU-SRYYMD(1:6)  >=  "200905"
                                IF   FLG-TOKUSITU-TASU  =   1
                                  MOVE  44400      TO  MAX-KIN-SYU-M
                                END-IF
                                IF  FLG-TOKUSITU-TASU  =  ZERO
                                  MOVE  WK-ZENGAKU TO  WK-KOUREI-IRYOHI
                                  MOVE  2          TO  FLG-IRYOHI3
                                  MOVE  11         TO  FLG-IRYOHI3X
                                ELSE
                                  IF   FLG-TOKU75  =  1 OR 2
                                    COMPUTE  MAX-KIN-SYU-M  =
                                             MAX-KIN-SYU-M  /  2
                                  END-IF
                                END-IF
                              END-IF
                            END-IF
                          END-IF
                          IF  (COMB-HOJOKBN  =  "3" OR "7")
                          AND (FLG-TOKUSITU-XXX    =  ZERO)
                          AND (FLG-KEIKASOCHI-IPAN =  ZERO)
                          AND (FLG-KOHYONKAIME     =  ZERO)
                            IF    LNK-SYU-SRYYMD(1:6)  >=  "201808"
                              MOVE  WK-ZENGAKU   TO  WK-KOUREI-IRYOHI
                              EVALUATE  FLG-KOUREI-GENEKIKBN
                                WHEN       1
                                  MOVE  1        TO  FLG-IRYOHIKG2
                                WHEN       2
                                  MOVE  2        TO  FLG-IRYOHIKG2
                                WHEN       3
                                  MOVE  3        TO  FLG-IRYOHIKG2
                              END-EVALUATE
                            ELSE
                              IF  LNK-SYU-SRYYMD(1:6)  >=  "200610"
                                MOVE  WK-ZENGAKU TO  WK-KOUREI-IRYOHI
                                MOVE  2          TO  FLG-IRYOHI3
                                MOVE  11         TO  FLG-IRYOHI3X
                              END-IF
                            END-IF
                          END-IF
                          IF  (COMB-HOJOKBN  =  "1" OR "5" OR "9" OR
                                                "2" OR "6" OR "8"   )
                          AND (FLG-SANSHOU3         =   SPACE       )
                          AND (FLG-TOKUSITU-XXX     =   1           )
                          AND (FLG-KOHYONKAIME      =   ZERO        )
                          AND (LNK-SYU-SRYYMD(1:6) >=  "201708"     )
                            IF   FLG-TOKUSITU-TASU  =   1
                              IF    FLG-TOKU75  =  1 OR 2
                                MOVE  22200   TO   MAX-KIN-SYU-M
                              ELSE
                                MOVE  44400   TO   MAX-KIN-SYU-M
                              END-IF
                            END-IF
                          END-IF
                   ELSE
                    IF   ( COMB-KOH1HKNNUM   =   "012" OR "025" )
                    OR   ( COMB-KOH2HKNNUM   =   "012" OR "025" )
                    OR   ( COMB-KOH3HKNNUM   =   "012" OR "025" )
                    OR   ( COMB-KOH4HKNNUM   =   "012" OR "025" )
                      IF    FLG-TOKU75  =  1 OR 2
                        IF   MAX-KIN-SYU-M   >  7500
                            MOVE   7500    TO   MAX-KIN-SYU-M
                        END-IF
                      ELSE
                        IF   MAX-KIN-SYU-M   >  15000
                            MOVE   15000   TO   MAX-KIN-SYU-M
                        END-IF
                      END-IF
                    ELSE
                     IF   ( COMB-KOH1HKNNUM  =   "972" )
                     OR   ( COMB-KOH2HKNNUM  =   "972" )
                     OR   ( COMB-KOH3HKNNUM  =   "972" )
                     OR   ( COMB-KOH4HKNNUM  =   "972" )
                      IF    FLG-TOKU75  =  1 OR 2
                        IF   MAX-KIN-SYU-M   >  5000
                            MOVE   5000    TO   MAX-KIN-SYU-M
                        END-IF
                      ELSE
                        IF   MAX-KIN-SYU-M   >  10000
                            MOVE   10000   TO   MAX-KIN-SYU-M
                        END-IF
                      END-IF
                     ELSE
                      IF  ( COMB-KOH1HKNNUM  =   "974" )
                      OR  ( COMB-KOH2HKNNUM  =   "974" )
                      OR  ( COMB-KOH3HKNNUM  =   "974" )
                      OR  ( COMB-KOH4HKNNUM  =   "974" )
                        IF    FLG-TOKU75  =  1 OR 2
                          IF   MAX-KIN-SYU-M   >  10000
                              MOVE   10000   TO   MAX-KIN-SYU-M
                          END-IF
                        ELSE
                          IF   MAX-KIN-SYU-M   >  20000
                              MOVE   20000   TO   MAX-KIN-SYU-M
                          END-IF
                        END-IF
                      ELSE
                        IF  (COMB-KOH1HKNNUM(1:1) = "0")
                        OR  (COMB-KOH2HKNNUM(1:1) = "0")
                        OR  (COMB-KOH3HKNNUM(1:1) = "0")
                        OR  (COMB-KOH4HKNNUM(1:1) = "0")
                          IF  ( COMB-HOJOKBN  =  "3" OR "7" )
                          AND ((FLG-TOKUSITU-XXX   =  1    ) OR
                               (FLG-KANGAN-XXX     =  1    ))
                          AND ( FLG-KOHYONKAIME    =  ZERO  )
                            IF    LNK-SYU-SRYYMD(1:6)  >=  "201808"
                              EVALUATE   FLG-KOUREI-GENEKIKBN
                                WHEN         1
                                  IF  FLG-TOKUSITU-TASU = 1
                                  OR  FLG-KANGAN-TASU   = 1
                                     MOVE 140100   TO  MAX-KIN-SYU-M
                                  END-IF
                                WHEN         2
                                  IF  FLG-TOKUSITU-TASU = 1
                                  OR  FLG-KANGAN-TASU   = 1
                                     MOVE  93000   TO  MAX-KIN-SYU-M
                                  END-IF
                                WHEN         3
                                  IF  FLG-TOKUSITU-TASU = 1
                                  OR  FLG-KANGAN-TASU   = 1
                                     MOVE  44400   TO  MAX-KIN-SYU-M
                                  END-IF
                              END-EVALUATE
                              IF  FLG-TOKUSITU-TASU  =  ZERO
                              AND FLG-KANGAN-TASU    =  ZERO
                                MOVE  WK-ZENGAKU   TO  WK-KOUREI-IRYOHI
                                EVALUATE  FLG-KOUREI-GENEKIKBN
                                  WHEN       1
                                    MOVE  4        TO  FLG-IRYOHIKG2
                                  WHEN       2
                                    MOVE  5        TO  FLG-IRYOHIKG2
                                  WHEN       3
                                    MOVE  6        TO  FLG-IRYOHIKG2
                                END-EVALUATE
                              ELSE
                                IF   FLG-TOKU75  =  1 OR 2
                                  COMPUTE  MAX-KIN-SYU-M  =
                                           MAX-KIN-SYU-M  /  2
                                END-IF
                              END-IF
                            ELSE
                              IF  LNK-SYU-SRYYMD(1:6)  >=  "200905"
                                IF   FLG-TOKUSITU-TASU  =   1
                                  MOVE  44400      TO  MAX-KIN-SYU-M
                                END-IF
                                IF  FLG-TOKUSITU-TASU  =  ZERO
                                  MOVE  WK-ZENGAKU TO  WK-KOUREI-IRYOHI
                                  MOVE  3          TO  FLG-IRYOHI3
                                  MOVE  ZERO       TO  FLG-IRYOHI3X
                                ELSE
                                  IF   FLG-TOKU75  =  1 OR 2
                                    COMPUTE  MAX-KIN-SYU-M  =
                                             MAX-KIN-SYU-M  /  2
                                  END-IF
                                END-IF
                              END-IF
                            END-IF
                          END-IF
                          IF  ( COMB-HOJOKBN  =  "1" OR "5" OR "9" OR
                                                 "2" OR "6" OR "8"   )
                          AND ( FLG-SANSHOU3         =   SPACE       )
                          AND ((FLG-TOKUSITU-XXX     =   1          ) OR
                               (FLG-KANGAN-XXX       =   1          ))
                          AND ( FLG-KOHYONKAIME      =   ZERO        )
                          AND ( LNK-SYU-SRYYMD(1:6) >=  "201708"     )
                            IF   FLG-TOKUSITU-TASU  =   1
                            OR   FLG-KANGAN-TASU    =   1
                              IF    FLG-TOKU75  =  1 OR 2
                                MOVE  22200   TO   MAX-KIN-SYU-M
                              ELSE
                                MOVE  44400   TO   MAX-KIN-SYU-M
                              END-IF
                            END-IF
                          END-IF
      *                   º£¤Þ¤ÇÃÖ¤­´¹¤¨¤Æ¤¤¤Ê¤«¤Ã¤¿¤Î¤ÇH30.8¤«¤éÂÐ±þ
                          IF  (COMB-HOJOKBN  =  "3" OR "7"       )
                          AND (FLG-TOKUSITU-XXX       =   ZERO   )
                          AND (FLG-KANGAN-XXX         =   ZERO   )
                          AND (LNK-SYU-SRYYMD(1:6)   >=  "201808")
                            IF  FLG-KOHYONKAIME    =   1
                              IF    FLG-TOKU75  =  1 OR 2
                                MOVE  22200   TO   MAX-KIN-SYU-M
                              ELSE
                                MOVE  44400   TO   MAX-KIN-SYU-M
                              END-IF
                            ELSE
                              IF    FLG-TOKU75  =  1 OR 2
                                MOVE  28800   TO   MAX-KIN-SYU-M
                              ELSE
                                MOVE  57600   TO   MAX-KIN-SYU-M
                              END-IF
                            END-IF
                          END-IF
                        END-IF
                      END-IF
                     END-IF
                    END-IF
                   END-IF
                END-IF
      *
           END-IF.
      *
           IF  FLG-GENBUTU70   NOT =   ZERO
      *
      ***      IF   FLG-ZEROKOGAITO   =   1
      ***           MOVE     80100   TO   MAX-KIN-SYU-M
      ***      ELSE
                IF   LNK-SYU-SRYYMD(1:6) >=  "201501"
                 EVALUATE   FLG-GENBUTU70
                  WHEN        1
                    EVALUATE  FLG-GENBUTU70-KBN
                      WHEN      11
                        MOVE     252600  TO   MAX-KIN-SYU-M
                        IF  FLG-KOHYONKAIME = 1
                           MOVE  140100  TO   MAX-KIN-SYU-M
                        END-IF
                      WHEN      12
                        MOVE     167400  TO   MAX-KIN-SYU-M
                        IF  FLG-KOHYONKAIME = 1
                           MOVE   93000  TO   MAX-KIN-SYU-M
                        END-IF
                    END-EVALUATE
                  WHEN        2
                    EVALUATE  FLG-GENBUTU70-KBN
                      WHEN      21
                        MOVE      80100  TO   MAX-KIN-SYU-M
                        IF  FLG-KOHYONKAIME = 1
                           MOVE   44400  TO   MAX-KIN-SYU-M
                        END-IF
                      WHEN      22
                        MOVE      57600  TO   MAX-KIN-SYU-M
                        IF  FLG-KOHYONKAIME = 1
                           MOVE   44400  TO   MAX-KIN-SYU-M
                        END-IF
                    END-EVALUATE
                  WHEN        3
                    EVALUATE  FLG-GENBUTU70-KBN
                      WHEN      31
                        MOVE      35400  TO   MAX-KIN-SYU-M
                        IF  FLG-KOHYONKAIME = 1
                           MOVE   24600  TO   MAX-KIN-SYU-M
                        END-IF
                    END-EVALUATE
                 END-EVALUATE
                ELSE
                 EVALUATE   FLG-GENBUTU70
                  WHEN        1
                    MOVE    150000   TO   MAX-KIN-SYU-M
                    IF  FLG-KOHYONKAIME = 1
                       MOVE  83400   TO   MAX-KIN-SYU-M
                    END-IF
                  WHEN        2
                    MOVE     80100   TO   MAX-KIN-SYU-M
                    IF  FLG-KOHYONKAIME = 1
                       MOVE  44400   TO   MAX-KIN-SYU-M
                    END-IF
                  WHEN        3
                    MOVE     35400   TO   MAX-KIN-SYU-M
                    IF  FLG-KOHYONKAIME = 1
                       MOVE  24600   TO   MAX-KIN-SYU-M
                    END-IF
                 END-EVALUATE
                END-IF
      ***      END-IF
               IF    FLG-TOKU75  =  3
                      COMPUTE  MAX-KIN-SYU-M  =
                               MAX-KIN-SYU-M  /  2
               END-IF
               MOVE    MAX-KIN-SYU-M   TO  WK-CYOKI-SYUMAXKIN
      *
               IF  (COMB-KOH1HKNNUM    =  SPACE
                                       OR "970")
               AND (COMB-KOH2HKNNUM    =  SPACE)
               AND (COMB-KOH3HKNNUM    =  SPACE)
               AND (COMB-KOH4HKNNUM    =  SPACE)
                  EVALUATE  MAX-KIN-SYU-M
                   WHEN      150000
                   WHEN       75000
                     MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                     MOVE  1           TO  FLG-IRYOHI70
                   WHEN       80100
                   WHEN       40050
                     MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                     MOVE  2           TO  FLG-IRYOHI70
                   WHEN      252600
                   WHEN      126300
                     MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                     MOVE  7           TO  FLG-IRYOHI70
                   WHEN      167400
                   WHEN       83700
                     MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                     MOVE  8           TO  FLG-IRYOHI70
                  END-EVALUATE
               END-IF
      *
               IF (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH2HKNNUM        =    SPACE) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH2HKNNUM(1:2)   =     "99") AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( COMB-KOH1HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH1HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH3HKNNUM(1:2)   =     "99") AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( COMB-KOH1HKNNUM(1:2)   =     "99") AND
                   ( COMB-KOH2HKNNUM        =    SPACE) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( WK-DOTANDOKU(1)        =      1  ) AND
                   ( COMB-KOH2HKNNUM        =    SPACE) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
               OR (( WK-DOTANDOKU(1)        =      1  ) AND
                   ( COMB-KOH2HKNNUM(1:1)  >=     "1" ) AND
                   ( COMB-KOH2HKNNUM(1:1)  <=     "8" ) AND
                   ( COMB-KOH3HKNNUM        =    SPACE) AND
                   ( COMB-KOH4HKNNUM        =    SPACE))
                   IF  (WK-1001-PREFNUM  =  01            )
                   AND (COMB-HKNNUM  NOT = "060" AND "067")
                   AND (COMB-KOH1HKNNUM  =  "141" OR "241")
                   AND (LNK-SYU-SRYYMD(1:6)   <=  "200803")
                     MOVE     80100   TO   MAX-KIN-SYU-M
                     IF  FLG-KOHYONKAIME = 1
                        MOVE  44400   TO   MAX-KIN-SYU-M
                     END-IF
                   END-IF
                   IF  LNK-SYU-SRYYMD(1:6)  >=  "200905"
                   AND FLG-TOKUSITU-XXX      =   1
                   AND FLG-KOHYONKAIME       =   ZERO
                    IF   LNK-SYU-SRYYMD(1:6) >=  "201501"
                     EVALUATE   FLG-GENBUTU70
                       WHEN        1
                        EVALUATE  FLG-GENBUTU70-KBN
                          WHEN      11
                            IF    FLG-TOKUSITU-TASU  =  1
                             IF    FLG-TOKU75  =  3
                               MOVE    70050   TO  MAX-KIN-SYU-M
                             ELSE
                               MOVE   140100   TO  MAX-KIN-SYU-M
                             END-IF
                            END-IF
                          WHEN      12
                            IF    FLG-TOKUSITU-TASU  =  1
                             IF    FLG-TOKU75  =  3
                               MOVE    46500   TO  MAX-KIN-SYU-M
                             ELSE
                               MOVE    93000   TO  MAX-KIN-SYU-M
                             END-IF
                            END-IF
                        END-EVALUATE
                       WHEN        2
                        EVALUATE  FLG-GENBUTU70-KBN
                          WHEN      21
                            IF    FLG-TOKUSITU-TASU  =  1
                             IF    FLG-TOKU75  =  3
                               MOVE    22200   TO  MAX-KIN-SYU-M
                             ELSE
                               MOVE    44400   TO  MAX-KIN-SYU-M
                             END-IF
                            END-IF
                          WHEN      22
                            IF    FLG-TOKUSITU-TASU  =  1
                             IF    FLG-TOKU75  =  3
                               MOVE    22200   TO  MAX-KIN-SYU-M
                             ELSE
                               MOVE    44400   TO  MAX-KIN-SYU-M
                             END-IF
                            END-IF
                        END-EVALUATE
                       WHEN        3
                        EVALUATE  FLG-GENBUTU70-KBN
                          WHEN      31
                            IF    FLG-TOKUSITU-TASU  =  1
                             IF    FLG-TOKU75  =  3
                               MOVE    12300   TO  MAX-KIN-SYU-M
                             ELSE
                               MOVE    24600   TO  MAX-KIN-SYU-M
                             END-IF
                            END-IF
                        END-EVALUATE
                     END-EVALUATE
                    ELSE
                     EVALUATE   FLG-GENBUTU70
                       WHEN        1
                        IF    FLG-TOKUSITU-TASU  =  1
                         IF    FLG-TOKU75  =  3
                           MOVE   41700    TO  MAX-KIN-SYU-M
                         ELSE
                           MOVE   83400    TO  MAX-KIN-SYU-M
                         END-IF
                        END-IF
                       WHEN        2
                        IF    FLG-TOKUSITU-TASU  =  1
                         IF    FLG-TOKU75  =  3
                           MOVE   22200    TO  MAX-KIN-SYU-M
                         ELSE
                           MOVE   44400    TO  MAX-KIN-SYU-M
                         END-IF
                        END-IF
                       WHEN        3
                        IF    FLG-TOKUSITU-TASU  =  1
                         IF    FLG-TOKU75  =  3
                           MOVE   12300    TO  MAX-KIN-SYU-M
                         ELSE
                           MOVE   24600    TO  MAX-KIN-SYU-M
                         END-IF
                        END-IF
                     END-EVALUATE
                    END-IF
                   END-IF
                   EVALUATE  MAX-KIN-SYU-M
                     WHEN      150000
                     WHEN       75000
                       MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                       MOVE  3           TO  FLG-IRYOHI70
                     WHEN       80100
                     WHEN       40050
                       MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                       MOVE  4           TO  FLG-IRYOHI70
                     WHEN      252600
                     WHEN      126300
                       MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                       MOVE  9           TO  FLG-IRYOHI70
                     WHEN      167400
                     WHEN       83700
                       MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                       MOVE  10          TO  FLG-IRYOHI70
                   END-EVALUATE
               ELSE
                IF   ( COMB-KOH1HKNNUM   =   "012" OR "025" )
                OR   ( COMB-KOH2HKNNUM   =   "012" OR "025" )
                OR   ( COMB-KOH3HKNNUM   =   "012" OR "025" )
                OR   ( COMB-KOH4HKNNUM   =   "012" OR "025" )
      ****         IF  FLG-KOHYONKAIME = 1
      ****            MOVE  24600   TO   WK-GEN70-GENDOGAKU2
      ****         ELSE
                      MOVE  35400   TO   WK-GEN70-GENDOGAKU2
      ****         END-IF
                   IF    FLG-TOKU75  =  3
                      COMPUTE  WK-GEN70-GENDOGAKU2  =
                               WK-GEN70-GENDOGAKU2  /  2
                   END-IF
                   IF MAX-KIN-SYU-M  >   WK-GEN70-GENDOGAKU2
                      MOVE WK-GEN70-GENDOGAKU2
                                    TO   MAX-KIN-SYU-M
                   END-IF
                ELSE
                 IF   ( COMB-KOH1HKNNUM  =   "972" )
                 OR   ( COMB-KOH2HKNNUM  =   "972" )
                 OR   ( COMB-KOH3HKNNUM  =   "972" )
                 OR   ( COMB-KOH4HKNNUM  =   "972" )
                    IF    FLG-TOKU75  =  3
                      IF   MAX-KIN-SYU-M   >  5000
                          MOVE   5000    TO   MAX-KIN-SYU-M
                      END-IF
                    ELSE
                      IF   MAX-KIN-SYU-M   >  10000
                          MOVE   10000   TO   MAX-KIN-SYU-M
                      END-IF
                    END-IF
                 ELSE
                  IF  ( COMB-KOH1HKNNUM  =   "974" )
                  OR  ( COMB-KOH2HKNNUM  =   "974" )
                  OR  ( COMB-KOH3HKNNUM  =   "974" )
                  OR  ( COMB-KOH4HKNNUM  =   "974" )
                    IF    FLG-TOKU75  =  3
                      IF   MAX-KIN-SYU-M   >  10000
                          MOVE   10000   TO   MAX-KIN-SYU-M
                      END-IF
                    ELSE
                      IF   MAX-KIN-SYU-M   >  20000
                          MOVE   20000   TO   MAX-KIN-SYU-M
                      END-IF
                    END-IF
                  ELSE
                   IF  (COMB-KOH1HKNNUM(1:1) = "0")
                   OR  (COMB-KOH2HKNNUM(1:1) = "0")
                   OR  (COMB-KOH3HKNNUM(1:1) = "0")
                   OR  (COMB-KOH4HKNNUM(1:1) = "0")
                      IF  ( LNK-SYU-SRYYMD(1:6)  >=  "200905" )
                      AND ((FLG-TOKUSITU-XXX      =   1      ) OR
                           (FLG-KANGAN-XXX        =   1      ))
                      AND ( FLG-KOHYONKAIME       =   ZERO    )
                       IF   LNK-SYU-SRYYMD(1:6) >=  "201501"
                        EVALUATE   FLG-GENBUTU70
                          WHEN        1
                           EVALUATE  FLG-GENBUTU70-KBN
                             WHEN      11
                               IF    FLG-TOKUSITU-TASU  =  1
                               OR    FLG-KANGAN-TASU    =  1
                                IF    FLG-TOKU75  =  3
                                  MOVE    70050   TO  MAX-KIN-SYU-M
                                ELSE
                                  MOVE   140100   TO  MAX-KIN-SYU-M
                                END-IF
                               END-IF
                             WHEN      12
                               IF    FLG-TOKUSITU-TASU  =  1
                               OR    FLG-KANGAN-TASU    =  1
                                IF    FLG-TOKU75  =  3
                                  MOVE    46500   TO  MAX-KIN-SYU-M
                                ELSE
                                  MOVE    93000   TO  MAX-KIN-SYU-M
                                END-IF
                               END-IF
                           END-EVALUATE
                          WHEN        2
                           EVALUATE  FLG-GENBUTU70-KBN
                             WHEN      21
                               IF    FLG-TOKUSITU-TASU  =  1
                               OR    FLG-KANGAN-TASU    =  1
                                IF    FLG-TOKU75  =  3
                                  MOVE    22200   TO  MAX-KIN-SYU-M
                                ELSE
                                  MOVE    44400   TO  MAX-KIN-SYU-M
                                END-IF
                               END-IF
                             WHEN      22
                               IF    FLG-TOKUSITU-TASU  =  1
                               OR    FLG-KANGAN-TASU    =  1
                                IF    FLG-TOKU75  =  3
                                  MOVE    22200   TO  MAX-KIN-SYU-M
                                ELSE
                                  MOVE    44400   TO  MAX-KIN-SYU-M
                                END-IF
                               END-IF
                           END-EVALUATE
                          WHEN        3
                           EVALUATE  FLG-GENBUTU70-KBN
                             WHEN      31
                               IF    FLG-TOKUSITU-TASU  =  1
                               OR    FLG-KANGAN-TASU    =  1
                                IF    FLG-TOKU75  =  3
                                  MOVE    12300   TO  MAX-KIN-SYU-M
                                ELSE
                                  MOVE    24600   TO  MAX-KIN-SYU-M
                                END-IF
                               END-IF
                           END-EVALUATE
                        END-EVALUATE
                       ELSE
                        EVALUATE   FLG-GENBUTU70
                          WHEN        1
                           IF    FLG-TOKUSITU-TASU  =  1
                            IF    FLG-TOKU75  =  3
                              MOVE   41700    TO  MAX-KIN-SYU-M
                            ELSE
                              MOVE   83400    TO  MAX-KIN-SYU-M
                            END-IF
                           END-IF
                          WHEN        2
                           IF    FLG-TOKUSITU-TASU  =  1
                            IF    FLG-TOKU75  =  3
                              MOVE   22200    TO  MAX-KIN-SYU-M
                            ELSE
                              MOVE   44400    TO  MAX-KIN-SYU-M
                            END-IF
                           END-IF
                          WHEN        3
                           IF    FLG-TOKUSITU-TASU  =  1
                            IF    FLG-TOKU75  =  3
                              MOVE   12300    TO  MAX-KIN-SYU-M
                            ELSE
                              MOVE   24600    TO  MAX-KIN-SYU-M
                            END-IF
                           END-IF
                        END-EVALUATE
                       END-IF
                       EVALUATE  MAX-KIN-SYU-M
                         WHEN      150000
                         WHEN       75000
                           MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                           MOVE  5           TO  FLG-IRYOHI70
                         WHEN       80100
                         WHEN       40050
                           MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                           MOVE  6           TO  FLG-IRYOHI70
                         WHEN      252600
                         WHEN      126300
                           MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                           MOVE  11          TO  FLG-IRYOHI70
                         WHEN      167400
                         WHEN       83700
                           MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                           MOVE  12          TO  FLG-IRYOHI70
                       END-EVALUATE
                      ELSE
                       EVALUATE  MAX-KIN-SYU-M
                         WHEN       75000
                         WHEN      126300
                         WHEN       83700
                         WHEN       40050
      *
                         WHEN      150000
                         WHEN      252600
                         WHEN      167400
                         WHEN       80100
                           IF    FLG-TOKU75  =  3
                             MOVE   40050    TO   MAX-KIN-SYU-M
                           ELSE
                             MOVE   80100    TO   MAX-KIN-SYU-M
                           END-IF
                           MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI70
                           MOVE  6           TO  FLG-IRYOHI70
      *
                         WHEN       41700
                         WHEN       70050
                         WHEN       46500
                         WHEN       22200
      *
                         WHEN       83400
                         WHEN      140100
                         WHEN       93000
                         WHEN       44400
                           IF    FLG-TOKU75  =  3
                             MOVE   22200    TO   MAX-KIN-SYU-M
                           ELSE
                             MOVE   44400    TO   MAX-KIN-SYU-M
                           END-IF
                       END-EVALUATE
                      END-IF
                   END-IF
                  END-IF
                 END-IF
                END-IF
               END-IF
      *
           END-IF.
      *
           IF   (LNK-S02-KOUREI-NYUIN-KBN    =  "1")
           OR   (FLG-GENBUTU70  NOT =  ZERO        )
             IF   (COMB-KOH1HKNNUM  =  "972")
             OR   (COMB-KOH2HKNNUM  =  "972")
             OR   (COMB-KOH3HKNNUM  =  "972")
             OR   (COMB-KOH4HKNNUM  =  "972")
               IF    FLG-TOKU75 = 1 OR 2 OR 3
                 IF   WK-CYOKI-SYUMAXKIN  >  5000
                   MOVE 5000                 TO WK-CYOKI-SYUMAXKIN
                 END-IF
               ELSE
                 IF   WK-CYOKI-SYUMAXKIN  >  10000
                   MOVE 10000                TO WK-CYOKI-SYUMAXKIN
                 END-IF
               END-IF
             END-IF
             IF   (COMB-KOH1HKNNUM  =  "974")
             OR   (COMB-KOH2HKNNUM  =  "974")
             OR   (COMB-KOH3HKNNUM  =  "974")
             OR   (COMB-KOH4HKNNUM  =  "974")
               IF    FLG-TOKU75 = 1 OR 2 OR 3
                 IF   WK-CYOKI-SYUMAXKIN  >  10000
                   MOVE 10000                TO WK-CYOKI-SYUMAXKIN
                 END-IF
               ELSE
                 IF   WK-CYOKI-SYUMAXKIN  >  20000
                   MOVE 20000                TO WK-CYOKI-SYUMAXKIN
                 END-IF
               END-IF
             END-IF
           END-IF.
      *
           IF   FLG-TOKU75-CYO  =  3
             IF (COMB-KOH1HKNNUM  =  "972")
             OR (COMB-KOH2HKNNUM  =  "972")
             OR (COMB-KOH3HKNNUM  =  "972")
             OR (COMB-KOH4HKNNUM  =  "972")
                  MOVE   5000   TO   MAX-KIN-SYU-M
                                     WK-CYOKI-SYUMAXKIN
             END-IF
             IF (COMB-KOH1HKNNUM  =  "974")
             OR (COMB-KOH2HKNNUM  =  "974")
             OR (COMB-KOH3HKNNUM  =  "974")
             OR (COMB-KOH4HKNNUM  =  "974")
                  MOVE   10000  TO   MAX-KIN-SYU-M
                                     WK-CYOKI-SYUMAXKIN
             END-IF
           END-IF.
      *
           IF   FLG-CYOKI-ARI   =  2
             IF (COMB-KOH1HKNNUM  =  "972")
             OR (COMB-KOH2HKNNUM  =  "972")
             OR (COMB-KOH3HKNNUM  =  "972")
             OR (COMB-KOH4HKNNUM  =  "972")
                  MOVE   10000  TO   MAX-KIN-SYU-M
                                     WK-CYOKI-SYUMAXKIN
             END-IF
             IF (COMB-KOH1HKNNUM  =  "974")
             OR (COMB-KOH2HKNNUM  =  "974")
             OR (COMB-KOH3HKNNUM  =  "974")
             OR (COMB-KOH4HKNNUM  =  "974")
                  MOVE   20000  TO   MAX-KIN-SYU-M
                                     WK-CYOKI-SYUMAXKIN
             END-IF
           END-IF.
      *
      *    ¼çÊÝ¸±¤Î¸º³Û
      *    Ä¹´ü¤Î¸º³Û
           IF    WK-GENGAKUKBN     NOT  =   ZERO
           AND   WK-GENGAKUKBN-KEISAN   =   ZERO
               PERFORM   2109-KOHFTN-KINGAKU-GEN-SEC
           END-IF.
      *
      *    ¹â³Û°ÑÇ¤Ê§¤¤¶â³Û¼è¤ê¹þ¤ß
           IF    FLG-KOHININBARAI       =   1
               PERFORM   210A-KOHININBARAI-KINGAKU-SEC
           END-IF.
      *
      *    £´£±Ï·¿Í¾å¸Â³ÛÊÔ½¸½èÍýÅù
           PERFORM    2108-ROUJIN41-JYOGEN-HENSYU-SEC.
      *
       210-HOKEN-KAISU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñ£±¡Ê¶â³Û¡Ë¼è¹þ¤ß½èÍý                                *
      ******************************************************************
       2103-KOH1-KAISU-SEC           SECTION.
      *
           IF    COMB-KOH1HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                 WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      END-IF
                 WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  26  OR  27  OR
                                          34  OR  12  OR  19      ) AND
                   ( COMB-KOH1HKNNUM   = "141"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH1HKNNUM   = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOH1HKNNUM   = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOH1HKNNUM   = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  31                      ) AND
                   ( COMB-KOH1HKNNUM(1:1)  >=  "1"  AND  <=  "8"  ))
               OR (( WK-1001-PREFNUM   =  10                      ) AND
                   ( COMB-KOH1HKNNUM   = "155"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH1HKNNUM   = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOH1HKNNUM   = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  23  OR  14  OR  30      ) AND
                   ( COMB-KOH1HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  01                      ) AND
                   ( COMB-KOH1HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   <=   "200803"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                   WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
                 MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
                 MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
               END-IF
             END-IF
           ELSE
             MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI1-M
             MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI1-D
             MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI1-M
           END-IF.
           MOVE    MAX-KIN-KOHI1-M    TO  WK-TAIHI-MAX-KIN-KOHI1-M.
      *
           IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
           AND ( COMB-KOH1HKNNUM(1:1)        >=       "1"  )
           AND ( COMB-KOH1HKNNUM(1:1)        <=       "8"  )
           AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
              IF  (WK-1001-PREFNUM       NOT   =
                               20 AND 15 AND 22 AND 18 AND 03 )
              AND (MAX-KIN-KOHI1-M             >  40200       )
                IF    WK-1001-PREFNUM       =   07
                AND   COMB-KOH1HKNNUM       =  "246"
                AND   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                     CONTINUE
                ELSE
                     MOVE    40200   TO    MAX-KIN-KOHI1-M
                END-IF
              END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  11   ) AND
               ( COMB-KOH1HKNNUM(2:2)    = "41"  )
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI1-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI1-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  22             ) AND
               ( COMB-KOH1HKNNUM         = "184" OR "185"  )
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI1-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI1-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  13             ) AND
               ( COMB-KOH1HKNNUM         = "180" OR "380"  )
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI1-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI1-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  33   ) AND
               ( COMB-KOH1HKNNUM(2:2)    = "80"  ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200610")
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI1-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI1-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
               END-IF
             END-IF
           END-IF.
      *
           IF    WK-CYO-OKIKAE(1)  =  1
             IF (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
                IF   MAX-KIN-KOHI1-M   NOT = ZERO
                  IF   MAX-KIN-KOHI1-M   >   10000
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI1-D   NOT = ZERO
                     MOVE    10000   TO    MAX-KIN-KOHI1-M
                  END-IF
                END-IF
             END-IF
             IF (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
                IF   MAX-KIN-KOHI1-M   NOT = ZERO
                  IF   MAX-KIN-KOHI1-M   >   20000
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI1-D   NOT = ZERO
                     MOVE    20000   TO    MAX-KIN-KOHI1-M
                  END-IF
                END-IF
             END-IF
           END-IF.
      *
           IF  FLG-TOKU75 = 1 OR 2 OR 3
              IF  COMB-KOH1HKNNUM = "972"
                  MOVE   5000    TO    MAX-KIN-KOHI1-M-TOKU75
              END-IF
              IF  COMB-KOH1HKNNUM = "974"
                  MOVE   10000   TO    MAX-KIN-KOHI1-M-TOKU75
              END-IF
           END-IF.
      *
       2103-KOH1-KAISU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñ£²¡Ê¶â³Û¡Ë¼è¹þ¤ß½èÍý                                *
      ******************************************************************
       2104-KOH2-KAISU-SEC           SECTION.
      *
           IF    COMB-KOH2HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                 WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      END-IF
                 WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  26  OR  27  OR
                                          34  OR  12  OR  19      ) AND
                   ( COMB-KOH2HKNNUM   = "141"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH2HKNNUM   = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOH2HKNNUM   = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOH2HKNNUM   = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  31                      ) AND
                   ( COMB-KOH2HKNNUM(1:1)  >=  "1"  AND  <=  "8"  ))
               OR (( WK-1001-PREFNUM   =  10                      ) AND
                   ( COMB-KOH2HKNNUM   = "155"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH2HKNNUM   = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOH2HKNNUM   = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  23  OR  14  OR  30      ) AND
                   ( COMB-KOH2HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  01                      ) AND
                   ( COMB-KOH2HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   <=   "200803"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                   WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
                 MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
                 MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
               END-IF
             END-IF
           ELSE
             MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI2-M
             MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI2-D
             MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI2-M
           END-IF.
           MOVE    MAX-KIN-KOHI2-M    TO  WK-TAIHI-MAX-KIN-KOHI2-M.
      *
           IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
           AND ( COMB-KOH2HKNNUM(1:1)        >=       "1"  )
           AND ( COMB-KOH2HKNNUM(1:1)        <=       "8"  )
           AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
              IF  (WK-1001-PREFNUM       NOT   =
                               20 AND 15 AND 22 AND 18 AND 03 )
              AND (MAX-KIN-KOHI2-M             >  40200       )
                IF    WK-1001-PREFNUM       =   07
                AND   COMB-KOH2HKNNUM       =  "246"
                AND   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                     CONTINUE
                ELSE
                     MOVE    40200   TO    MAX-KIN-KOHI2-M
                END-IF
              END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  11   ) AND
               ( COMB-KOH2HKNNUM(2:2)    = "41"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI2-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI2-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  22             ) AND
               ( COMB-KOH2HKNNUM         = "184" OR "185"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI2-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI2-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  13             ) AND
               ( COMB-KOH2HKNNUM         = "180" OR "380"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI2-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI2-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  33   ) AND
               ( COMB-KOH2HKNNUM(2:2)    = "80"  ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200610")
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI2-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI2-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
               END-IF
             END-IF
           END-IF.
      *
           IF    WK-CYO-OKIKAE(2)  =  1
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
                IF   MAX-KIN-KOHI2-M   NOT = ZERO
                  IF   MAX-KIN-KOHI2-M   >   10000
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI2-D   NOT = ZERO
                     MOVE    10000   TO    MAX-KIN-KOHI2-M
                  END-IF
                END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
                IF   MAX-KIN-KOHI2-M   NOT = ZERO
                  IF   MAX-KIN-KOHI2-M   >   20000
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI2-D   NOT = ZERO
                     MOVE    20000   TO    MAX-KIN-KOHI2-M
                  END-IF
                END-IF
             END-IF
           END-IF.
      *
           IF  FLG-TOKU75 = 1 OR 2 OR 3
              IF  COMB-KOH2HKNNUM = "972"
                  MOVE   5000    TO    MAX-KIN-KOHI2-M-TOKU75
              END-IF
              IF  COMB-KOH2HKNNUM = "974"
                  MOVE   10000   TO    MAX-KIN-KOHI2-M-TOKU75
              END-IF
           END-IF.
      *
       2104-KOH2-KAISU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñ£³¡Ê¶â³Û¡Ë¼è¹þ¤ß½èÍý                                *
      ******************************************************************
       2105-KOH3-KAISU-SEC           SECTION.
      *
           IF    COMB-KOH3HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                 WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      END-IF
                 WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  26  OR  27  OR
                                          34  OR  12  OR  19      ) AND
                   ( COMB-KOH3HKNNUM   = "141"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH3HKNNUM   = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOH3HKNNUM   = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOH3HKNNUM   = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  31                      ) AND
                   ( COMB-KOH3HKNNUM(1:1)  >=  "1"  AND  <=  "8"  ))
               OR (( WK-1001-PREFNUM   =  10                      ) AND
                   ( COMB-KOH3HKNNUM   = "155"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH3HKNNUM   = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOH3HKNNUM   = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  23  OR  14  OR  30      ) AND
                   ( COMB-KOH3HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  01                      ) AND
                   ( COMB-KOH3HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   <=   "200803"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                   WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
                 MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
                 MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
               END-IF
             END-IF
           ELSE
             MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI3-M
             MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI3-D
             MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI3-M
           END-IF.
           MOVE    MAX-KIN-KOHI3-M    TO  WK-TAIHI-MAX-KIN-KOHI3-M.
      *
           IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
           AND ( COMB-KOH3HKNNUM(1:1)        >=       "1"  )
           AND ( COMB-KOH3HKNNUM(1:1)        <=       "8"  )
           AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
              IF  (WK-1001-PREFNUM       NOT   =
                               20 AND 15 AND 22 AND 18 AND 03 )
              AND (MAX-KIN-KOHI3-M             >  40200       )
                IF    WK-1001-PREFNUM       =   07
                AND   COMB-KOH3HKNNUM       =  "246"
                AND   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                     CONTINUE
                ELSE
                     MOVE    40200   TO    MAX-KIN-KOHI3-M
                END-IF
              END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  11   ) AND
               ( COMB-KOH3HKNNUM(2:2)    = "41"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI3-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI3-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  22             ) AND
               ( COMB-KOH3HKNNUM         = "184" OR "185"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI3-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI3-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  13             ) AND
               ( COMB-KOH3HKNNUM         = "180" OR "380"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI3-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI3-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  33   ) AND
               ( COMB-KOH3HKNNUM(2:2)    = "80"  ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200610")
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
               IF   MAX-KIN-KOHI3-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
               IF   MAX-KIN-KOHI3-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
               END-IF
             END-IF
           END-IF.
      *
           IF    WK-CYO-OKIKAE(3)  =  1
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH4HKNNUM         = "972")
                IF   MAX-KIN-KOHI3-M   NOT = ZERO
                  IF   MAX-KIN-KOHI3-M   >   10000
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI3-D   NOT = ZERO
                     MOVE    10000   TO    MAX-KIN-KOHI3-M
                  END-IF
                END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH4HKNNUM         = "974")
                IF   MAX-KIN-KOHI3-M   NOT = ZERO
                  IF   MAX-KIN-KOHI3-M   >   20000
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI3-D   NOT = ZERO
                     MOVE    20000   TO    MAX-KIN-KOHI3-M
                  END-IF
                END-IF
             END-IF
           END-IF.
      *
           IF  FLG-TOKU75 = 1 OR 2 OR 3
              IF  COMB-KOH3HKNNUM = "972"
                  MOVE   5000    TO    MAX-KIN-KOHI3-M-TOKU75
              END-IF
              IF  COMB-KOH3HKNNUM = "974"
                  MOVE   10000   TO    MAX-KIN-KOHI3-M-TOKU75
              END-IF
           END-IF.
      *
       2105-KOH3-KAISU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñ£´¡Ê¶â³Û¡Ë¼è¹þ¤ß½èÍý                                *
      ******************************************************************
       2106-KOH4-KAISU-SEC           SECTION.
      *
           IF    COMB-KOH4HKNNUM(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                 WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      END-IF
                 WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  26  OR  27  OR
                                          34  OR  12  OR  19      ) AND
                   ( COMB-KOH4HKNNUM   = "141"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH4HKNNUM   = "241" OR "180" OR
                                         "182" OR "143" OR
                                         "185" OR "127"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOH4HKNNUM   = "374" OR "474"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOH4HKNNUM   = "191" OR "391"           ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  31                      ) AND
                   ( COMB-KOH4HKNNUM(1:1)  >=  "1"  AND  <=  "8"  ))
               OR (( WK-1001-PREFNUM   =  10                      ) AND
                   ( COMB-KOH4HKNNUM   = "155"                    ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOH4HKNNUM   = "100"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOH4HKNNUM   = "141" OR "285" OR
                                         "485" OR "180" OR "186"  ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  23  OR  14  OR  30      ) AND
                   ( COMB-KOH4HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  01                      ) AND
                   ( COMB-KOH4HKNNUM   = "141"                    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   <=   "200803"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                      MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                      MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                      MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                   WHEN   "2"
                      IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      ELSE
                        MOVE  HKN-TSY-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-TSY-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-TSY-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      END-IF
                   WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      ELSE
                        MOVE  HKN-TNK-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                        MOVE  HKN-TNK-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                        MOVE  HKN-TNK-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
                 MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
                 MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
               END-IF
             END-IF
           ELSE
             MOVE  HKN-HON-NYUMJGNCNT TO  MAX-KAI-KOHI4-M
             MOVE  HKN-HON-NYUDJGNGAK TO  MAX-KIN-KOHI4-D
             MOVE  HKN-HON-NYUMJGNGAK TO  MAX-KIN-KOHI4-M
           END-IF.
           MOVE    MAX-KIN-KOHI4-M    TO  WK-TAIHI-MAX-KIN-KOHI4-M.
      *
           IF  ( LNK-S02-KOUREI-NYUIN-KBN     =       "1"  )
           AND ( COMB-KOH4HKNNUM(1:1)        >=       "1"  )
           AND ( COMB-KOH4HKNNUM(1:1)        <=       "8"  )
           AND ( LNK-SYU-SRYYMD(1:6)         <     "200610")
              IF  (WK-1001-PREFNUM       NOT   =
                               20 AND 15 AND 22 AND 18 AND 03 )
              AND (MAX-KIN-KOHI4-M             >  40200       )
                IF    WK-1001-PREFNUM       =   07
                AND   COMB-KOH4HKNNUM       =  "246"
                AND   LNK-SYU-SRYYMD(1:6)  >=  "200604"
                     CONTINUE
                ELSE
                     MOVE    40200   TO    MAX-KIN-KOHI4-M
                END-IF
              END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  11   ) AND
               ( COMB-KOH4HKNNUM(2:2)    = "41"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
               IF   MAX-KIN-KOHI4-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
               IF   MAX-KIN-KOHI4-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  22             ) AND
               ( COMB-KOH4HKNNUM         = "184" OR "185"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
               IF   MAX-KIN-KOHI4-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
               IF   MAX-KIN-KOHI4-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  13             ) AND
               ( COMB-KOH4HKNNUM         = "180" OR "380"  )
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
               IF   MAX-KIN-KOHI4-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
               IF   MAX-KIN-KOHI4-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
           END-IF.
      *
           IF  ( WK-1001-PREFNUM         =  33   ) AND
               ( COMB-KOH4HKNNUM(2:2)    = "80"  ) AND
               ( LNK-SYU-SRYYMD(1:6)  >= "200610")
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
               IF   MAX-KIN-KOHI4-M   >     10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
               IF   MAX-KIN-KOHI4-M   >     20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
               END-IF
             END-IF
           END-IF.
      *
           IF    WK-CYO-OKIKAE(4)  =  1
             IF (COMB-KOH1HKNNUM         = "972") OR
                (COMB-KOH2HKNNUM         = "972") OR
                (COMB-KOH3HKNNUM         = "972")
                IF   MAX-KIN-KOHI4-M   NOT = ZERO
                  IF   MAX-KIN-KOHI4-M   >   10000
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI4-D   NOT = ZERO
                     MOVE    10000   TO    MAX-KIN-KOHI4-M
                  END-IF
                END-IF
             END-IF
             IF (COMB-KOH1HKNNUM         = "974") OR
                (COMB-KOH2HKNNUM         = "974") OR
                (COMB-KOH3HKNNUM         = "974")
                IF   MAX-KIN-KOHI4-M   NOT = ZERO
                  IF   MAX-KIN-KOHI4-M   >   20000
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
                  END-IF
                ELSE
                  IF MAX-KIN-KOHI4-D   NOT = ZERO
                     MOVE    20000   TO    MAX-KIN-KOHI4-M
                  END-IF
                END-IF
             END-IF
           END-IF.
      *
           IF  FLG-TOKU75 = 1 OR 2 OR 3
              IF  COMB-KOH4HKNNUM = "972"
                  MOVE   5000    TO    MAX-KIN-KOHI4-M-TOKU75
              END-IF
              IF  COMB-KOH4HKNNUM = "974"
                  MOVE   10000   TO    MAX-KIN-KOHI4-M-TOKU75
              END-IF
           END-IF.
      *
       2106-KOH4-KAISU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ´µ¼Ô¸øÈñÉéÃ´¡Ê¶â³Û¡Ë¼è¹þ¤ß½èÍý                          *
      ******************************************************************
       2107-KOHFTN-KINGAKU-SEC           SECTION.
      *
           INITIALIZE                   WK-TAIHI-NYUJGNGAK-OCC.
           INITIALIZE                   WK-TAIHI-JGNGAKEN-OCC.
      *
           INITIALIZE                   WK-JIRITU-TBL.
           INITIALIZE                   WK-SYOGAI-TBL.
           INITIALIZE                   WK-SYOFUKUMU-TBL.
      *
           MOVE    9999999     TO       WK-SYOFUKUMU-GENDOGAK(1).
           MOVE    9999999     TO       WK-SYOFUKUMU-GENDOGAK(2).
           MOVE    9999999     TO       WK-SYOFUKUMU-GENDOGAK(3).
           MOVE    9999999     TO       WK-SYOFUKUMU-GENDOGAK(4).
      *
           MOVE       ZERO     TO       WK-TOTORI-JIRITU.
      *
           PERFORM    VARYING   KOH-IDX    FROM   1   BY   1
                      UNTIL    (KOH-IDX    >      4)
      *
             IF ( COMB-KOHHKNNUM(KOH-IDX)      = "015" OR "016" 
                                                       OR "012"      )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "051"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200310")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "052"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200504")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "021"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200604")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "024" OR "079" )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200610")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "011" OR "020" )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200704")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "038" OR "025" )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "200804")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "054"   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "201501")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)      = "092"   )  AND
                 (WK-KOHJGNGET-CHECK092(KOH-IDX)
                                               =  ZERO   )  AND
                 (LNK-SYU-SRYYMD(1:6)         >= "201812")           )
             OR ((COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                              >= "1" AND <= "8" )  AND
                 (WK-KOHJGNGET-TAISYOKBN(KOH-IDX)  NOT =  ZERO  )    )
      *
                MOVE       ZERO           TO  WK-NYUJGNGAK
                MOVE       ZERO           TO  FLG-JYOGEN-OKIKAE
      *
      *         ¸øÈñ·î¾å¸Â³Û¼èÆÀ
                INITIALIZE                    LNK-ORCSJGNGET-REC
                MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
                MOVE  LNK-SYU-NYUGAIKBN   TO  LNK-ORCSJGNGET-NYUGAIKBN
                MOVE  LNK-SYU-PTID        TO  LNK-ORCSJGNGET-PTID
                MOVE  COMB-KOHHKNNUM(KOH-IDX)
                                          TO  LNK-ORCSJGNGET-KOHHKNNUM
                MOVE  COMB-KOHID(KOH-IDX) TO  LNK-ORCSJGNGET-KOHID
                MOVE  LNK-SYU-SRYYMD(1:6) TO  LNK-ORCSJGNGET-SRYYM
                MOVE  LNK-SYU-SKYEDYMD    TO  LNK-ORCSJGNGET-SKYEDYMD
                IF  COMB-KOHHKNNUM(KOH-IDX)(1:1)  >=  "1" AND <=  "8"
                   MOVE  WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                          TO  LNK-ORCSJGNGET-SETKBN
                   MOVE  WK-KOHJGNGET-TEKIYOFLG(KOH-IDX)
                                          TO  LNK-ORCSJGNGET-SETKBN2
                END-IF
      *
                CALL    "ORCSJGNGET"       USING
                                           LNK-ORCSJGNGET-REC
                                           SPA-AREA
      *
                IF    LNK-ORCSJGNGET-RC   =   ZERO
      *
                     IF  (LNK-SYU-SRYYMD(1:6)     >= "200804"      )
                     AND (COMB-KOHHKNNUM(KOH-IDX)  = "015" OR "016"
                                                           OR "021")
                        IF  LNK-ORCSJGNGET-NYUJGNGAK
                                   = 9999999 OR 999999 OR 40200
                            CONTINUE
                        ELSE
                            MOVE    1    TO    WK-TOTORI-JIRITU
                        END-IF
                     END-IF
      *            Á´¹ñ¸øÈñ¤Î¸º³Û
                     IF    WK-GENGAKUKBN    NOT  =   ZERO
                     AND   WK-GENGAKUKBN-KEISAN  =   ZERO
                       PERFORM   21071-KOHFTN-KINGAKU-GEN3-SEC
                     END-IF
                     MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                          TO  WK-NYUJGNGAK
                     EVALUATE   KOH-IDX
                      WHEN  1
                        MOVE   WK-NYUJGNGAK    TO   MAX-KIN-KOHI1-M
                        MOVE   WK-NYUJGNGAK    TO
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                        MOVE   WK-NYUJGNGAK    TO
                                            WK-TAIHI-JGNGAKEN(KOH-IDX)
                        MOVE     "1"   TO     COMB-KOH1-NYUJGNKBN
                        IF   LNK-S02-KOUREI-NYUIN-KBN  =    "1" 
                        OR   FLG-KOREI-TANYUIN         =     1
                            IF  COMB-KOHHKNNUM(KOH-IDX) =
                                "012" OR "011" OR "025" OR "020"
                             EVALUATE  COMB-KOHHKNNUM(KOH-IDX)
                             WHEN  "012"
                             WHEN  "025"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI1-M > WK-SEIHO-GENDO)
                               IF   LNK-SYU-SRYYMD(1:6) >= "200604"
                                IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                    > WK-SEIHO-GENDO
                                   MOVE WK-SEIHO-GENDO
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                END-IF
                               ELSE
                                MOVE  WK-SEIHO-GENDO
                                     TO   MAX-KIN-KOHI1-M
                                          WK-TAIHI-NYUJGNGAK(KOH-IDX)
                               END-IF
                              END-IF
                              IF    FLG-TOKU75 = 1 OR 2
                                 MOVE   WK-NYUJGNGAK
                                     TO MAX-KIN-KOHI1-M-TOKU75
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                 IF  (WK-NYUJGNGAK
                                             >  WK-SEIHO-GENDO-TOKU75)
                                 AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                             >  WK-SEIHO-GENDO-TOKU75)
                                   MOVE WK-SEIHO-GENDO-TOKU75
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                             WHEN  "011"
                             WHEN  "020"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI1-M > WK-KOH-GENDOGAKU)
                                MOVE  WK-KOH-GENDOGAKU
                                     TO   MAX-KIN-KOHI1-M
                                          WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                              IF    FLG-TOKU75 = 1 OR 2
                                IF  WK-NYUJGNGAK >
                                               WK-KOH-GENDOGAKU-TOKU75
                                  MOVE  WK-KOH-GENDOGAKU-TOKU75
                                       TO   MAX-KIN-KOHI1-M-TOKU75
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                ELSE
                                  MOVE  WK-NYUJGNGAK
                                       TO   MAX-KIN-KOHI1-M-TOKU75
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                END-IF
                              END-IF
                             END-EVALUATE
                            ELSE
                              IF  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "015" OR "016" OR "021" ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "024" OR "079"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200610"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) = "038") AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200804"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "052" OR "054"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "201501"))
                              OR  ((WK-TOKATUKAI(KOH-IDX)   =  1   ) AND
                                   (WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                                            =  2   ))
                                 CONTINUE
                              ELSE
                                 IF  (MAX-KIN-KOHI1-M    >
                                                      WK-KOH-GENDOGAKU)
                                 AND ((COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                             = "0" ) OR
                                      (WK-TOKATUKAI(KOH-IDX) =  1  )  )
                                 AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                 AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX) >
                                                      WK-KOH-GENDOGAKU)
                                   MOVE  WK-KOH-GENDOGAKU
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                      TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                                 IF  (FLG-TOKU75 = 1 OR 2           )
                                 AND ((COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                             = "0") OR
                                      (WK-TOKATUKAI(KOH-IDX) =  1 ) )
                                   MOVE  WK-NYUJGNGAK
                                       TO   MAX-KIN-KOHI1-M-TOKU75
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                   IF  (WK-NYUJGNGAK
                                            >  WK-KOH-GENDOGAKU-TOKU75)
                                   AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                            >  WK-KOH-GENDOGAKU-TOKU75)
                                     MOVE  WK-KOH-GENDOGAKU-TOKU75
                                       TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                     MOVE  3
                                       TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                   END-IF
                                 END-IF
                              END-IF
                            END-IF
                            IF    FLG-CHIHOU(1)      =  "1"
                               MOVE   SPACE    TO   FLG-CHIHOU(1)
                            END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                        OR   FLG-TOKU75-CYO      =    3
                        OR   FLG-CYOKI-ARI       =    2
                            IF    COMB-KOHHKNNUM(KOH-IDX) =
                                  "012" OR "011" OR "025" OR "020"
                             EVALUATE  COMB-KOHHKNNUM(KOH-IDX)
                             WHEN  "012"
                             WHEN  "025"
                              IF  MAX-KIN-KOHI1-M > WK-SEIHO-GENDO70
                                 IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                  > WK-SEIHO-GENDO70
                                   MOVE WK-SEIHO-GENDO70
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                              IF    FLG-TOKU75 = 3
                                 MOVE   WK-NYUJGNGAK
                                     TO MAX-KIN-KOHI1-M-TOKU75
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                 IF  (WK-NYUJGNGAK
                                             >  WK-SEIHO-GENDO70-TOKU75)
                                 AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                             >  WK-SEIHO-GENDO70-TOKU75)
                                   MOVE WK-SEIHO-GENDO70-TOKU75
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                             WHEN  "011"
                             WHEN  "020"
                              IF  MAX-KIN-KOHI1-M > WK-GEN70-GENDOGAKU
                                MOVE WK-GEN70-GENDOGAKU
                                     TO MAX-KIN-KOHI1-M
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                              IF    FLG-TOKU75 = 3
                                IF  WK-NYUJGNGAK >
                                             WK-GEN70-GENDOGAKU-TOKU75
                                  MOVE  WK-GEN70-GENDOGAKU-TOKU75
                                       TO   MAX-KIN-KOHI1-M-TOKU75
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                ELSE
                                  MOVE  WK-NYUJGNGAK
                                       TO   MAX-KIN-KOHI1-M-TOKU75
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                END-IF
                              END-IF
                             END-EVALUATE
                            ELSE
                              IF  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "015" OR "016" OR "021" ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "024" OR "079"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200610"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) = "038") AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200804"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "052" OR "054"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "201501"))
                              OR  ((WK-TOKATUKAI(KOH-IDX)   =  1   ) AND
                                   (WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                                            =  2   ))
                                 CONTINUE
                              ELSE
                                 IF  (MAX-KIN-KOHI1-M    >
                                                    WK-GEN70-GENDOGAKU)
                                 AND ((COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                             = "0" ) OR
                                      (WK-TOKATUKAI(KOH-IDX) =  1  )  )
                                 AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                 AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX) >
                                                    WK-GEN70-GENDOGAKU)
                                   MOVE  WK-GEN70-GENDOGAKU
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                      TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                                 IF  (FLG-TOKU75 = 3                )
                                 AND ((COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                             = "0") OR
                                      (WK-TOKATUKAI(KOH-IDX) =  1 ) )
                                   MOVE  WK-NYUJGNGAK
                                       TO   MAX-KIN-KOHI1-M-TOKU75
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                   IF  (WK-NYUJGNGAK
                                          >  WK-GEN70-GENDOGAKU-TOKU75)
                                   AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                          >  WK-GEN70-GENDOGAKU-TOKU75)
                                     MOVE  WK-GEN70-GENDOGAKU-TOKU75
                                       TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                     MOVE  3
                                       TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                   END-IF
                                 END-IF
                              END-IF
                            END-IF
                        END-IF
                        IF  (( COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                              >= "1" AND <= "8"     ) OR
                             ((COMB-KOHHKNNUM(KOH-IDX)
                                               = "051" OR "052") AND
                              (LNK-SYU-SRYYMD(1:6) < "200901"  )    ))
                        AND (  WK-TOKATUKAI(KOH-IDX)          = ZERO )
                        AND (  WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                                            NOT = 2  )
                          IF  (COMB-KOH2HKNNUM  = "972") OR
                              (COMB-KOH3HKNNUM  = "972") OR
                              (COMB-KOH4HKNNUM  = "972")
                             IF  (MAX-KIN-KOHI1-M > WK-CYOKI-GENDO)
                             AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                  > WK-CYOKI-GENDO)
                               MOVE  WK-CYOKI-GENDO
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                               MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                             END-IF
                          END-IF
                          IF  (COMB-KOH2HKNNUM  = "974") OR
                              (COMB-KOH3HKNNUM  = "974") OR
                              (COMB-KOH4HKNNUM  = "974")
                             IF  (MAX-KIN-KOHI1-M > WK-CYOKI-GENDO2)
                             AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                  > WK-CYOKI-GENDO2)
                               MOVE  WK-CYOKI-GENDO2
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                               MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                             END-IF
                          END-IF
                        END-IF
                        IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                            IF  MAX-KIN-KOHI1-M = 9999999 OR 999999
                              MOVE  1  TO WK-JIRITU-CYUKANSOU(KOH-IDX)
                              MOVE  ZERO
                                       TO WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                            ELSE
                              MOVE  2  TO WK-JIRITU-CYUKANSOU(KOH-IDX)
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                              IF  (MAX-KIN-KOHI1-M   = ZERO)
                              AND (FLG-JYOGEN-OKIKAE = ZERO)
                                IF  WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                                              = 9999999 OR 999999
                                 CONTINUE
                                ELSE
                                 MOVE   1
                                       TO WK-JIRITU-SKJGENMEN(KOH-IDX)
                                END-IF
                              END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOH1HKNNUM = "024" OR "079"         )
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200610"  )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO WK-SYOGAI-SKJGAK(KOH-IDX)
                              IF   WK-SYOGAI-SKJGAK(KOH-IDX) = ZERO
                                 MOVE   1
                                       TO WK-SYOGAI-SKJGENMEN(KOH-IDX)
                              END-IF
                        END-IF
                        IF  (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                >=  "1" AND <=  "8")
                        AND (WK-KOHJGNGET-TAISYOKBN(KOH-IDX) =   2 )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-CHIHOU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                        IF  (COMB-KOH1HKNNUM      = "038"     )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200804"  )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-KANEN-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                        IF  (COMB-KOH1HKNNUM      = "054"         )
                        AND (LNK-SYU-SRYYMD(1:6) >= "201501"      )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-TOKUSITU-TAFTNRUIKEI(KOH-IDX)
                          IF  MAX-KIN-KOHI1-M = ZERO
                            IF  WK-TOKUSITU-TAFTNRUIKEI(KOH-IDX)
                                              = 9999999 OR 999999
                              CONTINUE
                            ELSE
                              MOVE  1
                                   TO WK-TOKUSITU-SKJGENMEN(KOH-IDX)
                            END-IF
                          END-IF
                        END-IF
                        IF  (COMB-KOH1HKNNUM      = "052"         )
                        AND (LNK-SYU-SRYYMD(1:6) >= "201501"      )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-TOKUSITU-TAFTNRUIKEI(KOH-IDX)
                          IF  (LNK-SYU-SRYYMD(1:6) >= "202004")
                          AND (MAX-KIN-KOHI1-M      =  ZERO   )
                            IF  WK-TOKUSITU-TAFTNRUIKEI(KOH-IDX)
                                              = 9999999 OR 999999
                              CONTINUE
                            ELSE
                              MOVE  1
                                   TO WK-TOKUSITU-SKJGENMEN(KOH-IDX)
                            END-IF
                          END-IF
                        END-IF
                        IF   LNK-S02-KOUREI-NYUIN-KBN  =    "1"
                        OR   FLG-KOREI-TANYUIN         =     1
                         IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                         AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                         AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  1        )
                            IF    MAX-KIN-KOHI1-M  >  WK-KOH-GENDOGAKU
                                MOVE    WK-KOH-GENDOGAKU
                                                TO   MAX-KIN-KOHI1-M
                                MOVE    WK-KOH-GENDOGAKU  TO
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            END-IF
                            IF  FLG-TOKU75 = 1 OR 2
                              IF  WK-NYUJGNGAK >
                                        WK-KOH-GENDOGAKU-TOKU75
                                MOVE  WK-KOH-GENDOGAKU-TOKU75
                                    TO   MAX-KIN-KOHI1-M-TOKU75
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              ELSE
                                MOVE  WK-NYUJGNGAK
                                    TO   MAX-KIN-KOHI1-M-TOKU75
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                            END-IF
                         END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                        OR   FLG-TOKU75-CYO      =    3
                        OR   FLG-CYOKI-ARI       =    2
                         IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                         AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  1        )
                            IF    MAX-KIN-KOHI1-M  >  WK-GEN70-GENDOGAKU
                              MOVE    WK-GEN70-GENDOGAKU
                                      TO MAX-KIN-KOHI1-M
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              EVALUATE  WK-GEN70-GENDOGAKU
                               WHEN       80100
                                 MOVE  WK-ZENGAKU TO WK-KOUREI-IRYOHI70K
                                 MOVE  2          TO FLG-IRYOHI70K
                              END-EVALUATE
                            END-IF
                            IF  FLG-TOKU75 = 3
                              IF  WK-NYUJGNGAK >
                                        WK-GEN70-GENDOGAKU-TOKU75
                                MOVE  WK-GEN70-GENDOGAKU-TOKU75
                                    TO   MAX-KIN-KOHI1-M-TOKU75
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              ELSE
                                MOVE  WK-NYUJGNGAK
                                    TO   MAX-KIN-KOHI1-M-TOKU75
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                              EVALUATE  WK-GEN70-GENDOGAKU-TOKU75
                               WHEN       40050
                                 MOVE  WK-ZENGAKU TO
                                       WK-KOUREI-IRYOHI70K-TOKU75
                              END-EVALUATE
                            END-IF
                         END-IF
                        END-IF
                        IF  ( LNK-SYU-SRYYMD(1:6)   >= "200604"  )
                        AND ( COMB-KOH1HKNNUM  = "015" OR "016"
                                                       OR "021"  )
                        AND ((COMB-KOH2HKNNUM  = "972") OR
                             (COMB-KOH3HKNNUM  = "972") OR
                             (COMB-KOH4HKNNUM  = "972")          )
                         IF   WK-JIRITU-CYUKANSOU(KOH-IDX) =  2
                          CONTINUE
                         ELSE
                          IF   MAX-KIN-KOHI1-M   >  WK-CYOKI-GENDO
                            MOVE  WK-CYOKI-GENDO
                                   TO  MAX-KIN-KOHI1-M
                                       WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO   TO  WK-KOUREI-IRYOHI70K
                            MOVE  ZERO   TO  FLG-IRYOHI70K
                          END-IF
                         END-IF
                        END-IF
                        IF  ( LNK-SYU-SRYYMD(1:6)   >= "200604"  )
                        AND ( COMB-KOH1HKNNUM  = "015" OR "016"
                                                       OR "021"  )
                        AND ((COMB-KOH2HKNNUM  = "974") OR
                             (COMB-KOH3HKNNUM  = "974") OR
                             (COMB-KOH4HKNNUM  = "974")          )
                         IF   WK-JIRITU-CYUKANSOU(KOH-IDX) =  2
                          CONTINUE
                         ELSE
                          IF   MAX-KIN-KOHI1-M   >  WK-CYOKI-GENDO2
                            MOVE  WK-CYOKI-GENDO2
                                   TO  MAX-KIN-KOHI1-M
                                       WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO   TO  WK-KOUREI-IRYOHI70K
                            MOVE  ZERO   TO  FLG-IRYOHI70K
                          END-IF
                         END-IF
                        END-IF
                        IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                            IF  MAX-KIN-KOHI1-M = 9999999 OR 999999
                              IF  LNK-SYU-SRYYMD(1:6)  >= "200610"
                                MOVE  80100   TO   MAX-KIN-KOHI1-M
                                MOVE  80100   TO
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI
                                MOVE  1           TO  FLG-IRYOHI4
                              ELSE
                                MOVE  72300   TO   MAX-KIN-KOHI1-M
                                MOVE  72300   TO
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                MOVE  WK-ZENGAKU  TO  WK-KOUREI-IRYOHI
                                MOVE  1           TO  FLG-IRYOHI4
                              END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOH1HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                          IF   WK-2010-JIRITUKBN(2) =  "1"
                            MOVE  MAX-KAI-KOHI2-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI2-D  TO  MAX-KIN-KOHI1-D
                            IF   FLG-CHIHOU2(2) = "1"
                              MOVE   ZERO          TO  MAX-KIN-KOHI1-M
                            ELSE
                              MOVE MAX-KIN-KOHI2-M TO  MAX-KIN-KOHI1-M
                            END-IF
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI70K
                            MOVE  ZERO  TO  FLG-IRYOHI70K
                            IF  FLG-TOKU75 = 1 OR 2 OR 3
                               MOVE MAX-KIN-KOHI1-M  TO
                                         MAX-KIN-KOHI1-M-TOKU75
                               MOVE ZERO TO WK-KOUREI-IRYOHI70K-TOKU75
                            END-IF
                          END-IF
                          IF   WK-2010-JIRITUKBN(3) =  "1"
                            MOVE  MAX-KAI-KOHI3-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI3-D  TO  MAX-KIN-KOHI1-D
                            IF   FLG-CHIHOU2(3) = "1"
                              MOVE   ZERO          TO  MAX-KIN-KOHI1-M
                            ELSE
                              MOVE MAX-KIN-KOHI3-M TO  MAX-KIN-KOHI1-M
                            END-IF
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI70K
                            MOVE  ZERO  TO  FLG-IRYOHI70K
                            IF  FLG-TOKU75 = 1 OR 2 OR 3
                               MOVE MAX-KIN-KOHI1-M  TO
                                         MAX-KIN-KOHI1-M-TOKU75
                               MOVE ZERO TO WK-KOUREI-IRYOHI70K-TOKU75
                            END-IF
                          END-IF
                          IF   WK-2010-JIRITUKBN(4) =  "1"
                            MOVE  MAX-KAI-KOHI4-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI4-D  TO  MAX-KIN-KOHI1-D
                            IF   FLG-CHIHOU2(4) = "1"
                              MOVE   ZERO          TO  MAX-KIN-KOHI1-M
                            ELSE
                              MOVE MAX-KIN-KOHI4-M TO  MAX-KIN-KOHI1-M
                            END-IF
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI70K
                            MOVE  ZERO  TO  FLG-IRYOHI70K
                            IF  FLG-TOKU75 = 1 OR 2 OR 3
                               MOVE MAX-KIN-KOHI1-M  TO
                                         MAX-KIN-KOHI1-M-TOKU75
                               MOVE ZERO TO WK-KOUREI-IRYOHI70K-TOKU75
                            END-IF
                          END-IF
                        END-IF
                        IF  (WK-1001-PREFNUM      =  09     )
                        AND (COMB-KOH1HKNNUM      = "016"   )
                        AND (LNK-SYU-SRYYMD(1:6) >= "200604")
                          IF   COMB-KOH2HKNNUM =  "116" OR "216"
                            MOVE  MAX-KAI-KOHI2-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI2-D  TO  MAX-KIN-KOHI1-D
                            MOVE  MAX-KIN-KOHI2-M  TO  MAX-KIN-KOHI1-M
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI70K
                            MOVE  ZERO  TO  FLG-IRYOHI70K
                            IF  FLG-TOKU75 = 1 OR 2 OR 3
                               MOVE MAX-KIN-KOHI1-M  TO
                                         MAX-KIN-KOHI1-M-TOKU75
                               MOVE ZERO TO WK-KOUREI-IRYOHI70K-TOKU75
                            END-IF
                          END-IF
                          IF   COMB-KOH3HKNNUM =  "116" OR "216"
                            MOVE  MAX-KAI-KOHI3-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI3-D  TO  MAX-KIN-KOHI1-D
                            MOVE  MAX-KIN-KOHI3-M  TO  MAX-KIN-KOHI1-M
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI70K
                            MOVE  ZERO  TO  FLG-IRYOHI70K
                            IF  FLG-TOKU75 = 1 OR 2 OR 3
                               MOVE MAX-KIN-KOHI1-M  TO
                                         MAX-KIN-KOHI1-M-TOKU75
                               MOVE ZERO TO WK-KOUREI-IRYOHI70K-TOKU75
                            END-IF
                          END-IF
                          IF   COMB-KOH4HKNNUM =  "116" OR "216"
                            MOVE  MAX-KAI-KOHI4-M  TO  MAX-KAI-KOHI1-M
                            MOVE  MAX-KIN-KOHI4-D  TO  MAX-KIN-KOHI1-D
                            MOVE  MAX-KIN-KOHI4-M  TO  MAX-KIN-KOHI1-M
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI70K
                            MOVE  ZERO  TO  FLG-IRYOHI70K
                            IF  FLG-TOKU75 = 1 OR 2 OR 3
                               MOVE MAX-KIN-KOHI1-M  TO
                                         MAX-KIN-KOHI1-M-TOKU75
                               MOVE ZERO TO WK-KOUREI-IRYOHI70K-TOKU75
                            END-IF
                          END-IF
                        END-IF
                      WHEN  2
                        MOVE   WK-NYUJGNGAK    TO   MAX-KIN-KOHI2-M
                        MOVE   WK-NYUJGNGAK    TO
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                        MOVE   WK-NYUJGNGAK    TO
                                            WK-TAIHI-JGNGAKEN(KOH-IDX)
                        MOVE     "1"   TO     COMB-KOH2-NYUJGNKBN
                        IF   LNK-S02-KOUREI-NYUIN-KBN  =    "1" 
                        OR   FLG-KOREI-TANYUIN         =     1
                            IF  COMB-KOHHKNNUM(KOH-IDX) =
                                "012" OR "011" OR "025" OR "020"
                             EVALUATE  COMB-KOHHKNNUM(KOH-IDX)
                             WHEN  "012"
                             WHEN  "025"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI2-M > WK-SEIHO-GENDO)

                               IF   LNK-SYU-SRYYMD(1:6) >= "200604"
                                IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                    > WK-SEIHO-GENDO
                                   MOVE WK-SEIHO-GENDO
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                END-IF
                               ELSE
                                MOVE  WK-SEIHO-GENDO
                                     TO   MAX-KIN-KOHI2-M
                                          WK-TAIHI-NYUJGNGAK(KOH-IDX)
                               END-IF
                              END-IF
                              IF    FLG-TOKU75 = 1 OR 2
                                 MOVE   WK-NYUJGNGAK
                                     TO MAX-KIN-KOHI2-M-TOKU75
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                 IF  (WK-NYUJGNGAK
                                             >  WK-SEIHO-GENDO-TOKU75)
                                 AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                             >  WK-SEIHO-GENDO-TOKU75)
                                   MOVE WK-SEIHO-GENDO-TOKU75
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                             WHEN  "011"
                             WHEN  "020"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI2-M > WK-KOH-GENDOGAKU)
                                MOVE  WK-KOH-GENDOGAKU
                                     TO   MAX-KIN-KOHI2-M
                                          WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                              IF    FLG-TOKU75 = 1 OR 2
                                IF  WK-NYUJGNGAK >
                                               WK-KOH-GENDOGAKU-TOKU75
                                  MOVE  WK-KOH-GENDOGAKU-TOKU75
                                       TO   MAX-KIN-KOHI2-M-TOKU75
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                ELSE
                                  MOVE  WK-NYUJGNGAK
                                       TO   MAX-KIN-KOHI2-M-TOKU75
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                END-IF
                              END-IF
                             END-EVALUATE
                            ELSE
                              IF  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "015" OR "016" OR "021" ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "024" OR "079"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200610"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "054"                   ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "201501"))
                                 CONTINUE
                              ELSE
                                 IF  (MAX-KIN-KOHI2-M    >
                                                      WK-KOH-GENDOGAKU)
                                 AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                                 = "0")
                                 AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                 AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX) >
                                                      WK-KOH-GENDOGAKU)
                                   MOVE  WK-KOH-GENDOGAKU
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                      TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                                 IF  (FLG-TOKU75 = 1 OR 2           )
                                 AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                               = "0")
                                   MOVE  WK-NYUJGNGAK
                                       TO   MAX-KIN-KOHI2-M-TOKU75
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                   IF  (WK-NYUJGNGAK
                                            >  WK-KOH-GENDOGAKU-TOKU75)
                                   AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                            >  WK-KOH-GENDOGAKU-TOKU75)
                                     MOVE  WK-KOH-GENDOGAKU-TOKU75
                                       TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                     MOVE  3
                                       TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                   END-IF
                                 END-IF
                              END-IF
                            END-IF
                            IF    FLG-CHIHOU(2)      =  "1"
                               MOVE   SPACE    TO   FLG-CHIHOU(2)
                            END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                        OR   FLG-TOKU75-CYO      =    3
                        OR   FLG-CYOKI-ARI       =    2
                            IF    COMB-KOHHKNNUM(KOH-IDX) =
                                  "012" OR "011" OR "025" OR "020"
                             EVALUATE  COMB-KOHHKNNUM(KOH-IDX)
                             WHEN  "012"
                             WHEN  "025"
                              IF  MAX-KIN-KOHI2-M > WK-SEIHO-GENDO70
                                 IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                  > WK-SEIHO-GENDO70
                                   MOVE WK-SEIHO-GENDO70
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                              IF    FLG-TOKU75 = 3
                                 MOVE   WK-NYUJGNGAK
                                     TO MAX-KIN-KOHI2-M-TOKU75
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                 IF  (WK-NYUJGNGAK
                                             >  WK-SEIHO-GENDO70-TOKU75)
                                 AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                             >  WK-SEIHO-GENDO70-TOKU75)
                                   MOVE WK-SEIHO-GENDO70-TOKU75
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                             WHEN  "011"
                             WHEN  "020"
                              IF  MAX-KIN-KOHI2-M > WK-GEN70-GENDOGAKU
                                MOVE WK-GEN70-GENDOGAKU
                                     TO MAX-KIN-KOHI2-M
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                              IF    FLG-TOKU75 = 3
                                IF  WK-NYUJGNGAK >
                                             WK-GEN70-GENDOGAKU-TOKU75
                                  MOVE  WK-GEN70-GENDOGAKU-TOKU75
                                       TO   MAX-KIN-KOHI2-M-TOKU75
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                ELSE
                                  MOVE  WK-NYUJGNGAK
                                       TO   MAX-KIN-KOHI2-M-TOKU75
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                END-IF
                              END-IF
                             END-EVALUATE
                            ELSE
                              IF  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "015" OR "016" OR "021" ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "024" OR "079"          ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "200610"))
                              OR  ((COMB-KOHHKNNUM(KOH-IDX) =
                                           "054"                   ) AND
                                   (LNK-SYU-SRYYMD(1:6) >= "201501"))
                                 CONTINUE
                              ELSE
                                 IF  (MAX-KIN-KOHI2-M    >
                                                    WK-GEN70-GENDOGAKU)
                                 AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                                 = "0")
                                 AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                                 AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX) >
                                                    WK-GEN70-GENDOGAKU)
                                   MOVE  WK-GEN70-GENDOGAKU
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                      TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                                 IF  (FLG-TOKU75 = 3                )
                                 AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                               = "0")
                                   MOVE  WK-NYUJGNGAK
                                       TO   MAX-KIN-KOHI2-M-TOKU75
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                   IF  (WK-NYUJGNGAK
                                          >  WK-GEN70-GENDOGAKU-TOKU75)
                                   AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                          >  WK-GEN70-GENDOGAKU-TOKU75)
                                     MOVE  WK-GEN70-GENDOGAKU-TOKU75
                                       TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                     MOVE  3
                                       TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                   END-IF
                                 END-IF
                              END-IF
                            END-IF
                        END-IF
                        IF  (( COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                              >= "1" AND <= "8"     ) OR
                             ((COMB-KOHHKNNUM(KOH-IDX)
                                               = "051" OR "052") AND
                              (LNK-SYU-SRYYMD(1:6) < "200901"  )    ))
                        AND (  WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                                            NOT = 2  )
                          IF  (COMB-KOH1HKNNUM  = "972") OR
                              (COMB-KOH3HKNNUM  = "972") OR
                              (COMB-KOH4HKNNUM  = "972")
                             IF  (MAX-KIN-KOHI2-M > WK-CYOKI-GENDO)
                             AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                  > WK-CYOKI-GENDO)
                               MOVE  WK-CYOKI-GENDO
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                               MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                             END-IF
                          END-IF
                          IF  (COMB-KOH1HKNNUM  = "974") OR
                              (COMB-KOH3HKNNUM  = "974") OR
                              (COMB-KOH4HKNNUM  = "974")
                             IF  (MAX-KIN-KOHI2-M > WK-CYOKI-GENDO2)
                             AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                  > WK-CYOKI-GENDO2)
                               MOVE  WK-CYOKI-GENDO2
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                               MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                             END-IF
                          END-IF
                        END-IF
                        IF  (COMB-KOH2HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                            IF  MAX-KIN-KOHI2-M = 9999999 OR 999999
                              MOVE  1  TO WK-JIRITU-CYUKANSOU(KOH-IDX)
                              MOVE  ZERO
                                       TO WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                            ELSE
                              MOVE  2  TO WK-JIRITU-CYUKANSOU(KOH-IDX)
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                              IF  (MAX-KIN-KOHI2-M   = ZERO)
                              AND (FLG-JYOGEN-OKIKAE = ZERO)
                                IF  WK-JIRITU-TAFTNRUIKEI(KOH-IDX)
                                              = 9999999 OR 999999
                                 CONTINUE
                                ELSE
                                 MOVE   1
                                       TO WK-JIRITU-SKJGENMEN(KOH-IDX)
                                END-IF
                              END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOH2HKNNUM = "024" OR "079"         )
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200610"  )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                       TO WK-SYOGAI-SKJGAK(KOH-IDX)
                              IF   WK-SYOGAI-SKJGAK(KOH-IDX) = ZERO
                                 MOVE   1
                                       TO WK-SYOGAI-SKJGENMEN(KOH-IDX)
                              END-IF
                        END-IF
                        IF  (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                >=  "1" AND <=  "8")
                        AND (WK-KOHJGNGET-TAISYOKBN(KOH-IDX) =   2 )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-CHIHOU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                        IF  (COMB-KOH2HKNNUM      = "054"   )
                        AND (LNK-SYU-SRYYMD(1:6) >= "201501")
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-TOKUSITU-TAFTNRUIKEI(KOH-IDX)
                          IF  MAX-KIN-KOHI2-M = ZERO
                            IF  WK-TOKUSITU-TAFTNRUIKEI(KOH-IDX)
                                              = 9999999 OR 999999
                              CONTINUE
                            ELSE
                              MOVE  1
                                   TO WK-TOKUSITU-SKJGENMEN(KOH-IDX)
                            END-IF
                          END-IF
                        END-IF
                        IF   LNK-S02-KOUREI-NYUIN-KBN  =    "1"
                         IF  (COMB-KOH2HKNNUM = "015" OR "016" OR "021")
                         AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                         AND (WK-JIRITU-CYUKANSOU(KOH-IDX) =  1        )
                            IF    MAX-KIN-KOHI2-M  >  WK-KOH-GENDOGAKU
                                MOVE    WK-KOH-GENDOGAKU
                                                TO   MAX-KIN-KOHI2-M
                                MOVE    WK-KOH-GENDOGAKU  TO
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            END-IF
                         END-IF
                        END-IF
                        IF  ( LNK-SYU-SRYYMD(1:6)   >= "200604"  )
                        AND ( COMB-KOH2HKNNUM  = "015" OR "016"
                                                       OR "021"  )
                        AND ((COMB-KOH1HKNNUM  = "972") OR
                             (COMB-KOH3HKNNUM  = "972") OR
                             (COMB-KOH4HKNNUM  = "972")          )
                         IF   WK-JIRITU-CYUKANSOU(KOH-IDX) =  2
                          CONTINUE
                         ELSE
                          IF   MAX-KIN-KOHI2-M   >  WK-CYOKI-GENDO
                            MOVE  WK-CYOKI-GENDO
                                   TO  MAX-KIN-KOHI2-M
                                       WK-TAIHI-NYUJGNGAK(KOH-IDX)
                          END-IF
                         END-IF
                        END-IF
                        IF  ( LNK-SYU-SRYYMD(1:6)   >= "200604"  )
                        AND ( COMB-KOH2HKNNUM  = "015" OR "016"
                                                       OR "021"  )
                        AND ((COMB-KOH1HKNNUM  = "974") OR
                             (COMB-KOH3HKNNUM  = "974") OR
                             (COMB-KOH4HKNNUM  = "974")          )
                         IF   WK-JIRITU-CYUKANSOU(KOH-IDX) =  2
                          CONTINUE
                         ELSE
                          IF   MAX-KIN-KOHI2-M   >  WK-CYOKI-GENDO2
                            MOVE  WK-CYOKI-GENDO2
                                   TO  MAX-KIN-KOHI2-M
                                       WK-TAIHI-NYUJGNGAK(KOH-IDX)
                          END-IF
                         END-IF
                        END-IF
                        IF  (COMB-KOH2HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                            IF  MAX-KIN-KOHI2-M = 9999999 OR 999999
                              IF  LNK-SYU-SRYYMD(1:6)  >= "200610"
                                MOVE  80100   TO   MAX-KIN-KOHI2-M
                                MOVE  80100   TO
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              ELSE
                                MOVE  72300   TO   MAX-KIN-KOHI2-M
                                MOVE  72300   TO
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                              END-IF
                            END-IF
                        END-IF
                        IF  (COMB-KOH2HKNNUM = "015" OR "016" OR "021")
                        AND (LNK-SYU-SRYYMD(1:6)         >= "200604"  )
                          IF   WK-2010-JIRITUKBN(3) =  "1"
                            MOVE  MAX-KAI-KOHI3-M  TO  MAX-KAI-KOHI2-M
                            MOVE  MAX-KIN-KOHI3-D  TO  MAX-KIN-KOHI2-D
                            IF   FLG-CHIHOU2(3) = "1"
                              MOVE   ZERO          TO  MAX-KIN-KOHI2-M
                            ELSE
                              MOVE MAX-KIN-KOHI3-M TO  MAX-KIN-KOHI2-M
                            END-IF
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                          END-IF
                          IF   WK-2010-JIRITUKBN(4) =  "1"
                            MOVE  MAX-KAI-KOHI4-M  TO  MAX-KAI-KOHI2-M
                            MOVE  MAX-KIN-KOHI4-D  TO  MAX-KIN-KOHI2-D
                            IF   FLG-CHIHOU2(4) = "1"
                              MOVE   ZERO          TO  MAX-KIN-KOHI2-M
                            ELSE
                              MOVE MAX-KIN-KOHI4-M TO  MAX-KIN-KOHI2-M
                            END-IF
                            MOVE  ZERO  TO  WK-TAIHI-NYUJGNGAK(KOH-IDX)
                            MOVE  ZERO  TO  WK-KOUREI-IRYOHI
                            MOVE  ZERO  TO  FLG-IRYOHI4
                          END-IF
                        END-IF
                      WHEN  3
                        MOVE   WK-NYUJGNGAK    TO   MAX-KIN-KOHI3-M
                        MOVE   WK-NYUJGNGAK    TO
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                        MOVE   WK-NYUJGNGAK    TO
                                            WK-TAIHI-JGNGAKEN(KOH-IDX)
                        MOVE     "1"   TO     COMB-KOH3-NYUJGNKBN
                        IF   LNK-S02-KOUREI-NYUIN-KBN  =    "1" 
                        OR   FLG-KOREI-TANYUIN         =     1
                            IF  COMB-KOHHKNNUM(KOH-IDX) =
                                          "012" OR "025"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI3-M > WK-SEIHO-GENDO)
                               IF   LNK-SYU-SRYYMD(1:6) >= "200604"
                                IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                    > WK-SEIHO-GENDO
                                   MOVE WK-SEIHO-GENDO
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                END-IF
                               ELSE
                                MOVE  WK-SEIHO-GENDO
                                     TO   MAX-KIN-KOHI3-M
                                          WK-TAIHI-NYUJGNGAK(KOH-IDX)
                               END-IF
                              END-IF
                              IF    FLG-TOKU75 = 1 OR 2
                                 MOVE   WK-NYUJGNGAK
                                     TO MAX-KIN-KOHI3-M-TOKU75
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                 IF  (WK-NYUJGNGAK
                                             >  WK-SEIHO-GENDO-TOKU75)
                                 AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                             >  WK-SEIHO-GENDO-TOKU75)
                                   MOVE WK-SEIHO-GENDO-TOKU75
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                            ELSE
                              IF  (MAX-KIN-KOHI3-M    >
                                                   WK-KOH-GENDOGAKU)
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                              AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                              AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX) >
                                                   WK-KOH-GENDOGAKU)
                                MOVE  WK-KOH-GENDOGAKU
                                   TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                MOVE 3
                                   TO WK-SYOFUKUMU-FLG(KOH-IDX)
                              END-IF
                              IF  (FLG-TOKU75 = 1 OR 2           )
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                            = "0")
                                MOVE  WK-NYUJGNGAK
                                    TO   MAX-KIN-KOHI3-M-TOKU75
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                IF  (WK-NYUJGNGAK
                                         >  WK-KOH-GENDOGAKU-TOKU75)
                                AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                         >  WK-KOH-GENDOGAKU-TOKU75)
                                  MOVE  WK-KOH-GENDOGAKU-TOKU75
                                    TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                  MOVE  3
                                    TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                END-IF
                              END-IF
                            END-IF
                            IF    FLG-CHIHOU(3)      =  "1"
                               MOVE   SPACE    TO   FLG-CHIHOU(3)
                            END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                        OR   FLG-TOKU75-CYO      =    3
                        OR   FLG-CYOKI-ARI       =    2
                            IF    COMB-KOHHKNNUM(KOH-IDX) =
                                          "012" OR "025"
                              IF  MAX-KIN-KOHI3-M > WK-SEIHO-GENDO70
                                 IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                  > WK-SEIHO-GENDO70
                                   MOVE WK-SEIHO-GENDO70
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                              IF    FLG-TOKU75 = 3
                                 MOVE   WK-NYUJGNGAK
                                     TO MAX-KIN-KOHI3-M-TOKU75
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                 IF  (WK-NYUJGNGAK
                                             >  WK-SEIHO-GENDO70-TOKU75)
                                 AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                             >  WK-SEIHO-GENDO70-TOKU75)
                                   MOVE WK-SEIHO-GENDO70-TOKU75
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                            ELSE
                              IF  (MAX-KIN-KOHI3-M    >
                                                 WK-GEN70-GENDOGAKU)
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                              AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                              AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX) >
                                                 WK-GEN70-GENDOGAKU)
                                MOVE  WK-GEN70-GENDOGAKU
                                   TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                MOVE 3
                                   TO WK-SYOFUKUMU-FLG(KOH-IDX)
                              END-IF
                              IF  (FLG-TOKU75 = 3                )
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                            = "0")
                                MOVE  WK-NYUJGNGAK
                                    TO   MAX-KIN-KOHI3-M-TOKU75
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                IF  (WK-NYUJGNGAK
                                       >  WK-GEN70-GENDOGAKU-TOKU75)
                                AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                       >  WK-GEN70-GENDOGAKU-TOKU75)
                                  MOVE  WK-GEN70-GENDOGAKU-TOKU75
                                    TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                  MOVE  3
                                    TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                END-IF
                              END-IF
                            END-IF
                        END-IF
                        IF  ( COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                              >= "1" AND <= "8"     )
                        AND ( WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                                           NOT = 2  )
                          IF  (COMB-KOH1HKNNUM  = "972") OR
                              (COMB-KOH2HKNNUM  = "972") OR
                              (COMB-KOH4HKNNUM  = "972")
                             IF  (MAX-KIN-KOHI3-M > WK-CYOKI-GENDO)
                             AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                  > WK-CYOKI-GENDO)
                               MOVE  WK-CYOKI-GENDO
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                               MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                             END-IF
                          END-IF
                          IF  (COMB-KOH1HKNNUM  = "974") OR
                              (COMB-KOH2HKNNUM  = "974") OR
                              (COMB-KOH4HKNNUM  = "974")
                             IF  (MAX-KIN-KOHI3-M > WK-CYOKI-GENDO2)
                             AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                  > WK-CYOKI-GENDO2)
                               MOVE  WK-CYOKI-GENDO2
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                               MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                             END-IF
                          END-IF
                        END-IF
                        IF  (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                >=  "1" AND <=  "8")
                        AND (WK-KOHJGNGET-TAISYOKBN(KOH-IDX) =   2 )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-CHIHOU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                      WHEN  4
                        MOVE   WK-NYUJGNGAK    TO   MAX-KIN-KOHI4-M
                        MOVE   WK-NYUJGNGAK    TO
                                            WK-TAIHI-NYUJGNGAK(KOH-IDX)
                        MOVE   WK-NYUJGNGAK    TO
                                            WK-TAIHI-JGNGAKEN(KOH-IDX)
                        MOVE     "1"   TO     COMB-KOH4-NYUJGNKBN
                        IF   LNK-S02-KOUREI-NYUIN-KBN  =    "1" 
                        OR   FLG-KOREI-TANYUIN         =     1
                            IF  COMB-KOHHKNNUM(KOH-IDX) =
                                          "012" OR "025"
                              IF   (COMB-HKNNUM  NOT   =   SPACE)
                              AND  (MAX-KIN-KOHI4-M > WK-SEIHO-GENDO)
                               IF   LNK-SYU-SRYYMD(1:6) >= "200604"
                                IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                    > WK-SEIHO-GENDO
                                   MOVE WK-SEIHO-GENDO
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                END-IF
                               ELSE
                                MOVE  WK-SEIHO-GENDO
                                     TO   MAX-KIN-KOHI4-M
                                          WK-TAIHI-NYUJGNGAK(KOH-IDX)
                               END-IF
                              END-IF
                              IF    FLG-TOKU75 = 1 OR 2
                                 MOVE   WK-NYUJGNGAK
                                     TO MAX-KIN-KOHI4-M-TOKU75
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                 IF  (WK-NYUJGNGAK
                                             >  WK-SEIHO-GENDO-TOKU75)
                                 AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                             >  WK-SEIHO-GENDO-TOKU75)
                                   MOVE WK-SEIHO-GENDO-TOKU75
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                            ELSE
                              IF  (MAX-KIN-KOHI4-M    >
                                                   WK-KOH-GENDOGAKU)
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                              AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                              AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX) >
                                                   WK-KOH-GENDOGAKU)
                                MOVE  WK-KOH-GENDOGAKU
                                   TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                MOVE 3
                                   TO WK-SYOFUKUMU-FLG(KOH-IDX)
                              END-IF
                              IF  (FLG-TOKU75 = 1 OR 2           )
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                            = "0")
                                MOVE  WK-NYUJGNGAK
                                    TO   MAX-KIN-KOHI4-M-TOKU75
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                IF  (WK-NYUJGNGAK
                                         >  WK-KOH-GENDOGAKU-TOKU75)
                                AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                         >  WK-KOH-GENDOGAKU-TOKU75)
                                  MOVE  WK-KOH-GENDOGAKU-TOKU75
                                    TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                  MOVE  3
                                    TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                END-IF
                              END-IF
                            END-IF
                            IF    FLG-CHIHOU(4)      =  "1"
                               MOVE   SPACE    TO   FLG-CHIHOU(4)
                            END-IF
                        END-IF
                        IF   FLG-GENBUTU70   NOT =   ZERO
                        OR   FLG-TOKU75-CYO      =    3
                        OR   FLG-CYOKI-ARI       =    2
                            IF    COMB-KOHHKNNUM(KOH-IDX) =
                                          "012" OR "025"
                              IF  MAX-KIN-KOHI4-M > WK-SEIHO-GENDO70
                                 IF  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                  > WK-SEIHO-GENDO70
                                   MOVE WK-SEIHO-GENDO70
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                              IF    FLG-TOKU75 = 3
                                 MOVE   WK-NYUJGNGAK
                                     TO MAX-KIN-KOHI4-M-TOKU75
                                        WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                 IF  (WK-NYUJGNGAK
                                             >  WK-SEIHO-GENDO70-TOKU75)
                                 AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                             >  WK-SEIHO-GENDO70-TOKU75)
                                   MOVE WK-SEIHO-GENDO70-TOKU75
                                     TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                   MOVE 3
                                     TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                 END-IF
                              END-IF
                            ELSE
                              IF  (MAX-KIN-KOHI4-M    >
                                                 WK-GEN70-GENDOGAKU)
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                              = "0")
                              AND (WK-DOTANDOKU(KOH-IDX)   =  ZERO )
                              AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX) >
                                                 WK-GEN70-GENDOGAKU)
                                MOVE  WK-GEN70-GENDOGAKU
                                   TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                MOVE 3
                                   TO WK-SYOFUKUMU-FLG(KOH-IDX)
                              END-IF
                              IF  (FLG-TOKU75 = 3                )
                              AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                            = "0")
                                MOVE  WK-NYUJGNGAK
                                    TO   MAX-KIN-KOHI4-M-TOKU75
                                         WK-TAIHI-NYUJGNGAK(KOH-IDX)
                                IF  (WK-NYUJGNGAK
                                       >  WK-GEN70-GENDOGAKU-TOKU75)
                                AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                       >  WK-GEN70-GENDOGAKU-TOKU75)
                                  MOVE  WK-GEN70-GENDOGAKU-TOKU75
                                    TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                  MOVE  3
                                    TO WK-SYOFUKUMU-FLG(KOH-IDX)
                                END-IF
                              END-IF
                            END-IF
                        END-IF
                        IF  ( COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                              >= "1" AND <= "8"     )
                        AND ( WK-KOHJGNGET-TAISYOKBN(KOH-IDX)
                                                           NOT = 2  )
                          IF  (COMB-KOH1HKNNUM  = "972") OR
                              (COMB-KOH2HKNNUM  = "972") OR
                              (COMB-KOH3HKNNUM  = "972")
                             IF  (MAX-KIN-KOHI4-M > WK-CYOKI-GENDO)
                             AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                  > WK-CYOKI-GENDO)
                               MOVE  WK-CYOKI-GENDO
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                               MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                             END-IF
                          END-IF
                          IF  (COMB-KOH1HKNNUM  = "974") OR
                              (COMB-KOH2HKNNUM  = "974") OR
                              (COMB-KOH3HKNNUM  = "974")
                             IF  (MAX-KIN-KOHI4-M > WK-CYOKI-GENDO2)
                             AND (WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                                  > WK-CYOKI-GENDO2)
                               MOVE  WK-CYOKI-GENDO2
                                      TO WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                               MOVE 3 TO WK-SYOFUKUMU-FLG(KOH-IDX)
                             END-IF
                          END-IF
                        END-IF
                        IF  (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                                >=  "1" AND <=  "8")
                        AND (WK-KOHJGNGET-TAISYOKBN(KOH-IDX) =   2 )
                              MOVE  LNK-ORCSJGNGET-TAFTNRUIKEI
                                   TO WK-CHIHOU-TAFTNRUIKEI(KOH-IDX)
                        END-IF
                     END-EVALUATE
                END-IF
      *
             END-IF
      *
             IF  (WK-1001-PREFNUM         =  16           )
             AND (COMB-KOHHKNNUM(KOH-IDX) = "185" OR "285")
             AND (LNK-SYU-SRYYMD(1:6)    >= "201904"      )
               IF  (LNK-SYU-KOH1HKNNUM  = "972" OR "974")
               OR  (LNK-SYU-KOH2HKNNUM  = "972" OR "974")
               OR  (LNK-SYU-KOH3HKNNUM  = "972" OR "974")
               OR  (LNK-SYU-KOH4HKNNUM  = "972" OR "974")
               OR  (LNK-S02-KOUREI-NYUIN-KBN   =   "1"  )
               OR  (FLG-KOREI-TANYUIN          =    1   )
                 CONTINUE
               ELSE
                 IF   (FLG-GENBUTU70          = ZERO )
                 AND  (LNK-SYU-SYUHKNNUM  NOT = SPACE)
                 AND  (LNK-SYU-SYUHKNNUM  NOT =
                            "060" AND "067" AND "039")
                    EVALUATE   KOH-IDX
                      WHEN        1
                        MOVE  80100       TO  MAX-KIN-KOHI1-M
                        MOVE  WK-ZENGAKU  TO  WK-IRYOHI-TOYAMA
                        IF    COMB-KOHHKNNUM(KOH-IDX) = "185"
                          MOVE    11      TO  FLG-IRYOHI-TOYAMA
                        ELSE
                          MOVE    12      TO  FLG-IRYOHI-TOYAMA
                        END-IF
                        MOVE     "1"      TO  COMB-KOH1-NYUJGNKBN
                      WHEN        2
                        MOVE  80100       TO  MAX-KIN-KOHI2-M
                        MOVE  WK-ZENGAKU  TO  WK-IRYOHI-TOYAMA
                        IF    COMB-KOHHKNNUM(KOH-IDX) = "185"
                          MOVE    21      TO  FLG-IRYOHI-TOYAMA
                        ELSE
                          MOVE    22      TO  FLG-IRYOHI-TOYAMA
                        END-IF
                        MOVE     "1"      TO  COMB-KOH2-NYUJGNKBN
                    END-EVALUATE
                 END-IF
               END-IF
             END-IF
      *
           END-PERFORM.
      *
      *    £±£¹¸¶Çú°ìÈÌ
      *
           MOVE     ZERO   TO   WK-NYUKFTNRATE019.
      *
           IF    (COMB-HKNNUM            =  SPACE   )
           AND   (COMB-KOH1HKNNUM        =  "019"   )
           AND   (COMB-KOH2HKNNUM        =  SPACE   )
           AND   (COMB-KOH3HKNNUM        =  SPACE   )
           AND   (COMB-KOH4HKNNUM        =  SPACE   )
           AND   (LNK-SYU-SRYYMD(1:6)   >=  "201604")
             INITIALIZE                    LNK-ORCSJGNGET-REC
             MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
             MOVE  LNK-SYU-NYUGAIKBN   TO  LNK-ORCSJGNGET-NYUGAIKBN
             MOVE  LNK-SYU-PTID        TO  LNK-ORCSJGNGET-PTID
             MOVE  COMB-KOHHKNNUM(1)   TO  LNK-ORCSJGNGET-KOHHKNNUM
             MOVE  COMB-KOHID(1)       TO  LNK-ORCSJGNGET-KOHID
             MOVE  LNK-SYU-SRYYMD(1:6) TO  LNK-ORCSJGNGET-SRYYM
             MOVE  LNK-SYU-SKYEDYMD    TO  LNK-ORCSJGNGET-SKYEDYMD
             IF  COMB-KOHHKNNUM(1)(1:1)  >=  "1" AND <=  "8"
                MOVE  WK-KOHJGNGET-TAISYOKBN(1)
                                       TO  LNK-ORCSJGNGET-SETKBN
                MOVE  WK-KOHJGNGET-TEKIYOFLG(1)
                                       TO  LNK-ORCSJGNGET-SETKBN2
             END-IF
             CALL    "ORCSJGNGET"      USING
                                       LNK-ORCSJGNGET-REC
                                       SPA-AREA
             IF    LNK-ORCSJGNGET-RC    =  ZERO
               IF    WK-GENGAKUKBN  NOT =  ZERO
                 MOVE     ZERO     TO     WK-NYUKFTNRATE019
               ELSE
                 MOVE     LNK-ORCSJGNGET-NYUJGNGAK
                                   TO     WK-NYUKFTNRATE019
               END-IF
             END-IF
           END-IF.
      *
       2107-KOHFTN-KINGAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    Á´¹ñ¸øÈñ¤Î¸º³Û
      ******************************************************************
       21071-KOHFTN-KINGAKU-GEN3-SEC           SECTION.
      *
           IF  ((COMB-KOHHKNNUM(KOH-IDX)(1:1)  =  "0"  ) AND
                (WK-DOTANDOKU(KOH-IDX)         =  ZERO ) AND
                (LNK-ORCSJGNGET-NYUJGNGAK  NOT =  ZERO ))
           OR  ((WK-TOKATUKAI(KOH-IDX)         =  1    ) AND
                (LNK-ORCSJGNGET-NYUJGNGAK  NOT =  ZERO ))
           OR  ((WK-KOHJGNGET-TEKIYOFLG(KOH-IDX)
                                               =  1    ) AND
                (LNK-ORCSJGNGET-NYUJGNGAK  NOT =  ZERO ))
      *
             IF  LNK-ORCSJGNGET-NYUJGNGAK = 9999999 OR 999999
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   LNK-ORCSJGNGET-NYUJGNGAK
                       MOVE    1     TO   FLG-JYOGEN-OKIKAE
                     END-IF
                   WHEN          2
                     CONTINUE
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   LNK-ORCSJGNGET-NYUJGNGAK
                     MOVE      1     TO   FLG-JYOGEN-OKIKAE
                   WHEN          5
                     MOVE     WK-GENGAKU-KIN
                                     TO   LNK-ORCSJGNGET-NYUJGNGAK
                     MOVE      1     TO   FLG-JYOGEN-OKIKAE
                 END-EVALUATE
             ELSE
                 EVALUATE   WK-GENGAKUKBN
                   WHEN          1
                     IF  WK-GENGAKU-RITU = 100
                       MOVE   ZERO   TO   WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                       MOVE    3     TO   WK-SYOFUKUMU-FLG(KOH-IDX)
                     ELSE
                       COMPUTE  WK-GENGAKU-RITUX =
                                100 - WK-GENGAKU-RITU
                       COMPUTE  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) =
                                LNK-ORCSJGNGET-NYUJGNGAK       *
                                WK-GENGAKU-RITUX               /
                                100
                       MOVE    3     TO   WK-SYOFUKUMU-FLG(KOH-IDX)
                     END-IF
                   WHEN          2
                     IF  LNK-ORCSJGNGET-NYUJGNGAK < WK-GENGAKU-KIN
                       MOVE   ZERO   TO   WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                       MOVE    3     TO   WK-SYOFUKUMU-FLG(KOH-IDX)
                     ELSE
                       COMPUTE  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) =
                                LNK-ORCSJGNGET-NYUJGNGAK       -
                                WK-GENGAKU-KIN
                       MOVE    3     TO   WK-SYOFUKUMU-FLG(KOH-IDX)
                     END-IF
                   WHEN          3
                   WHEN          4
                     MOVE     ZERO   TO   WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                     MOVE      3     TO   WK-SYOFUKUMU-FLG(KOH-IDX)
                   WHEN          5
                     IF  LNK-ORCSJGNGET-NYUJGNGAK > WK-GENGAKU-KIN
                       COMPUTE  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) =
                                WK-GENGAKU-KIN
                       MOVE    3     TO   WK-SYOFUKUMU-FLG(KOH-IDX)
                     END-IF
                 END-EVALUATE
                 COMPUTE  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) =
                          WK-SYOFUKUMU-GENDOGAK(KOH-IDX) +  5
                 COMPUTE  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) =
                          WK-SYOFUKUMU-GENDOGAK(KOH-IDX) /  10
                 COMPUTE  WK-SYOFUKUMU-GENDOGAK(KOH-IDX) =
                          WK-SYOFUKUMU-GENDOGAK(KOH-IDX) *  10
             END-IF
      *
           END-IF
      *
           .
      *
       21071-KOHFTN-KINGAKU-GEN3-EXT.
           EXIT.
      *
      ******************************************************************
      *        £´£±Ï·¿Í¾å¸Â³ÛÊÔ½¸½èÍý
      ******************************************************************
       2108-ROUJIN41-JYOGEN-HENSYU-SEC           SECTION.
      *
           IF  ( LNK-SYU-SRYYMD(1:6)   >=   "200901")
           AND ((COMB-KOH1HKNNUM = "972" OR "974") OR
                (COMB-KOH2HKNNUM = "972" OR "974") OR
                (COMB-KOH3HKNNUM = "972" OR "974") OR
                (COMB-KOH4HKNNUM = "972" OR "974")  )
            CONTINUE
           ELSE
            IF      FLG-GENBUTU70   NOT =   ZERO
      *      £´£±Ï·¿Í
             IF ((WK-1001-PREFNUM  =  26 OR 27 OR 34 OR 12       ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ))
             OR ((WK-1001-PREFNUM  =  33                         ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ))
             OR ((WK-1001-PREFNUM  =  23                         ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ))
             OR ((WK-1001-PREFNUM  =  14                         ) AND
                 (COMB-KOH1HKNNUM  =  "142"                      ))
             OR ((WK-1001-PREFNUM  =  01                         ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ) AND
                 (LNK-SYU-SRYYMD(1:6)   <=   "200803"            ))
             OR ((WK-1001-PREFNUM  =  10                         ) AND
                 (COMB-KOH1HKNNUM  =  "255"                      ) AND
                 (LNK-SYU-SRYYMD(1:6)   <=   "201403"            ))
                MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI70K
                IF   MAX-KIN-KOHI1-M    =    72300
                   MOVE   11       TO   FLG-IRYOHI70K
                END-IF
                IF   MAX-KIN-KOHI1-M    =    80100
                   MOVE   12       TO   FLG-IRYOHI70K
                END-IF
             END-IF
      *      ²¬»³¸©ÃÏÊý¸øÈñ
             IF   WK-1001-PREFNUM        =    33
               IF  COMB-KOH1HKNNUM   =   "385" OR "280" OR "286"
                 IF  ( COMB-KOH1HKNNUM  =  "280"          )
                 AND ((COMB-KOH2HKNNUM  =  "972" OR "974") OR
                      (COMB-KOH3HKNNUM  =  "972" OR "974") OR
                      (COMB-KOH4HKNNUM  =  "972" OR "974"))
                   CONTINUE
                 ELSE
                   MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI70K
                   MOVE   13          TO   FLG-IRYOHI70K
                 END-IF
               END-IF
               IF   COMB-KOH1HKNNUM  =   "585"
                   MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI70K
                   MOVE   14          TO   FLG-IRYOHI70K
               END-IF
             END-IF
      *
             IF  (COMB-KOH1HKNNUM          = "092")
             AND (WK-KOHJGNGET-CHECK092(1) =  1   )
               IF ((WK-1001-PREFNUM  =  26 OR 27 OR 34 OR 12       ) AND
                   (COMB-KOH2HKNNUM  =  "241"                      ))
               OR ((WK-1001-PREFNUM  =  33                         ) AND
                   (COMB-KOH2HKNNUM  =  "241"                      ))
               OR ((WK-1001-PREFNUM  =  23                         ) AND
                   (COMB-KOH2HKNNUM  =  "241"                      ))
               OR ((WK-1001-PREFNUM  =  14                         ) AND
                   (COMB-KOH2HKNNUM  =  "142"                      ))
                 MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI70K
                 IF  MAX-KIN-KOHI2-M   =   72300
                   MOVE   21        TO   FLG-IRYOHI70K
                 END-IF
                 IF  MAX-KIN-KOHI2-M   =   80100
                   MOVE   22        TO   FLG-IRYOHI70K
                 END-IF
               END-IF
               IF   WK-1001-PREFNUM        =    33
                 IF  COMB-KOH2HKNNUM   =   "385" OR "280" OR "286"
                   IF  ( COMB-KOH2HKNNUM  =  "280"          )
                   AND ((COMB-KOH3HKNNUM  =  "972" OR "974") OR
                        (COMB-KOH4HKNNUM  =  "972" OR "974"))
                     CONTINUE
                   ELSE
                     MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI70K
                     MOVE   23          TO   FLG-IRYOHI70K
                   END-IF
                 END-IF
                 IF  COMB-KOH2HKNNUM   =   "585"
                     MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI70K
                     MOVE   24          TO   FLG-IRYOHI70K
                 END-IF
               END-IF
             END-IF
            ELSE
      *      £´£±Ï·¿Í
             MOVE       ZERO        TO      FLG-ROJIN41
             IF ((WK-1001-PREFNUM  =  26 OR 27 OR 34 OR 12       ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ))
             OR ((WK-1001-PREFNUM  =  33                         ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ) AND
                 (LNK-SYU-SRYYMD(1:6)   >=   "200610"            ))
             OR ((WK-1001-PREFNUM  =  23                         ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ) AND
                 (LNK-SYU-SRYYMD(1:6)   >=   "200610"            ))
             OR ((WK-1001-PREFNUM  =  14                         ) AND
                 (COMB-KOH1HKNNUM  =  "142"                      ) AND
                 (LNK-SYU-SRYYMD(1:6)   >=   "200610"            ))
             OR ((WK-1001-PREFNUM  =  01                         ) AND
                 (COMB-KOH1HKNNUM  =  "241"                      ) AND
                 (LNK-SYU-SRYYMD(1:6)   <=   "200803"            ))
             OR ((WK-1001-PREFNUM  =  10                         ) AND
                 (COMB-KOH1HKNNUM  =  "255"                      ) AND
                 (LNK-SYU-SRYYMD(1:6)   <=   "201403"            ))
                IF  LNK-SYU-SRYYMD(1:6)   >=   "200610"
                    CONTINUE
                ELSE
                    MOVE  "1"      TO   COMB-KOH1-NYUJGNKBN
                    MOVE   72300   TO   MAX-KIN-KOHI1-M
                END-IF
                MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                MOVE   1           TO   FLG-IRYOHI2
                IF  LNK-SYU-SRYYMD(1:6)   >=   "200610"
                   IF   MAX-KIN-KOHI1-M    =    72300
                      MOVE     1      TO    FLG-ROJIN41
                   END-IF
                   IF   MAX-KIN-KOHI1-M    =    80100
                      MOVE     2      TO    FLG-ROJIN41
                   END-IF
                END-IF
             END-IF
      *      ²¬»³¸©ÃÏÊý¸øÈñ
             IF  (WK-1001-PREFNUM        =    33     )
             AND (LNK-SYU-SRYYMD(1:6)   >=   "200610")
               IF  COMB-KOH1HKNNUM   =   "385" OR "280" OR "286"
                 IF  ( COMB-KOH1HKNNUM  =  "280"          )
                 AND ((COMB-KOH2HKNNUM  =  "972" OR "974") OR
                      (COMB-KOH3HKNNUM  =  "972" OR "974") OR
                      (COMB-KOH4HKNNUM  =  "972" OR "974"))
                   CONTINUE
                 ELSE
                   MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI3
                   MOVE   11          TO   FLG-IRYOHI5
                 END-IF
               END-IF
               IF   COMB-KOH1HKNNUM  =   "585"
                   MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI3
                   MOVE   12          TO   FLG-IRYOHI5
               END-IF
               IF  (COMB-KOH1HKNNUM  =   "027"         )
               AND (COMB-KOH2HKNNUM  =   "280" OR "286")
                 IF  ( COMB-KOH2HKNNUM  =  "280"          )
                 AND ((COMB-KOH3HKNNUM  =  "972" OR "974") OR
                      (COMB-KOH4HKNNUM  =  "972" OR "974"))
                   CONTINUE
                 ELSE
                   MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI3
                   MOVE   21          TO   FLG-IRYOHI5
                 END-IF
               END-IF
             END-IF
      *
             IF  (COMB-KOH1HKNNUM          = "092")
             AND (WK-KOHJGNGET-CHECK092(1) =  1   )
               MOVE       ZERO       TO   FLG-ROJIN41
               IF ((WK-1001-PREFNUM  =  26 OR 27 OR 34 OR 12       ) AND
                   (COMB-KOH2HKNNUM  =  "241"                      ))
               OR ((WK-1001-PREFNUM  =  33                         ) AND
                   (COMB-KOH2HKNNUM  =  "241"                      ))
               OR ((WK-1001-PREFNUM  =  23                         ) AND
                   (COMB-KOH2HKNNUM  =  "241"                      ))
               OR ((WK-1001-PREFNUM  =  14                         ) AND
                   (COMB-KOH2HKNNUM  =  "142"                      ))
                 MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI
                 MOVE   2           TO   FLG-IRYOHI2
                 IF  MAX-KIN-KOHI2-M   =   72300
                   MOVE    1        TO   FLG-ROJIN41
                 END-IF
                 IF  MAX-KIN-KOHI2-M   =   80100
                   MOVE    2        TO   FLG-ROJIN41
                 END-IF
               END-IF
               IF   WK-1001-PREFNUM        =    33
                 IF  COMB-KOH2HKNNUM   =   "385" OR "280" OR "286"
                   IF  ( COMB-KOH2HKNNUM  =  "280"          )
                   AND ((COMB-KOH3HKNNUM  =  "972" OR "974") OR
                        (COMB-KOH4HKNNUM  =  "972" OR "974"))
                     CONTINUE
                   ELSE
                     MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI3
                     MOVE   22          TO   FLG-IRYOHI5
                   END-IF
                 END-IF
                 IF  COMB-KOH2HKNNUM   =   "585"
                     MOVE   WK-ZENGAKU  TO   WK-KOUREI-IRYOHI3
                     MOVE   23          TO   FLG-IRYOHI5
                 END-IF
               END-IF
             END-IF
            END-IF
           END-IF
      *
           IF  (WK-1001-PREFNUM       =    43     )
           AND (LNK-SYU-SRYYMD(1:6)  >=   "200912")
           AND ((COMB-KOH1HKNNUM = "143" OR "342") OR
                (COMB-KOH2HKNNUM = "143" OR "342") OR
                (COMB-KOH3HKNNUM = "143" OR "342") OR
                (COMB-KOH4HKNNUM = "143" OR "342"))
           AND ((COMB-KOH1HKNNUM = "972" OR "974") OR
                (COMB-KOH2HKNNUM = "972" OR "974") OR
                (COMB-KOH3HKNNUM = "972" OR "974") OR
                (COMB-KOH4HKNNUM = "972" OR "974"))
             IF  (COMB-KOH1HKNNUM = "143" OR "342")
             AND (MAX-KIN-KOHI1-M  NOT = ZERO     )
               COMPUTE   MAX-KIN-KOHI1-M  =
                        (MAX-KIN-SYU-M / 3) + 0.9
             END-IF
             IF  (COMB-KOH2HKNNUM = "143" OR "342")
             AND (MAX-KIN-KOHI2-M  NOT = ZERO     )
               COMPUTE   MAX-KIN-KOHI2-M  =
                        (MAX-KIN-SYU-M / 3) + 0.9
             END-IF
             IF  (COMB-KOH3HKNNUM = "143" OR "342")
             AND (MAX-KIN-KOHI3-M  NOT = ZERO     )
               COMPUTE   MAX-KIN-KOHI3-M  =
                        (MAX-KIN-SYU-M / 3) + 0.9
             END-IF
             IF  (COMB-KOH4HKNNUM = "143" OR "342")
             AND (MAX-KIN-KOHI4-M  NOT = ZERO     )
               COMPUTE   MAX-KIN-KOHI4-M  =
                        (MAX-KIN-SYU-M / 3) + 0.9
             END-IF
           END-IF
      *
           .
      *
       2108-ROUJIN41-JYOGEN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¼çÊÝ¸±¤Î¸º³Û                                            *
      *        Ä¹´ü¤Î¸º³Û                                              *
      ******************************************************************
       2109-KOHFTN-KINGAKU-GEN-SEC           SECTION.
      *
           IF  LNK-S02-KOUREI-NYUIN-KBN   =   "1"
      *
              IF   COMB-KOH1HKNNUM          =  "027"
                IF   MAX-KIN-KOHI1-M   NOT =  ZERO
                 IF  FLG-IRYOHI  = ZERO
                 AND FLG-IRYOHI3 = ZERO
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-KOHI1-M     =
                                   MAX-KIN-KOHI1-M     *
                                   WK-GENGAKU-RITUX    /
                                   100
                        END-IF
                     WHEN          2
                        IF  MAX-KIN-KOHI1-M < WK-GENGAKU-KIN
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                        ELSE
                          COMPUTE  MAX-KIN-KOHI1-M  =
                                   MAX-KIN-KOHI1-M  -
                                   WK-GENGAKU-KIN
                        END-IF
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                     WHEN          5
                        IF  MAX-KIN-KOHI1-M > WK-GENGAKU-KIN
                          COMPUTE  MAX-KIN-KOHI1-M  =
                                   WK-GENGAKU-KIN
                        END-IF
                   END-EVALUATE
                   COMPUTE  MAX-KIN-KOHI1-M =
                            MAX-KIN-KOHI1-M +  5
                   COMPUTE  MAX-KIN-KOHI1-M =
                            MAX-KIN-KOHI1-M /  10
                   COMPUTE  MAX-KIN-KOHI1-M =
                            MAX-KIN-KOHI1-M *  10
                 END-IF
                END-IF
              ELSE
                 IF   MAX-KIN-SYU-M     NOT =  ZERO
                 AND  FLG-IRYOHI            =  ZERO
                 AND  FLG-IRYOHI3           =  ZERO
                 AND  FLG-IRYOHIKG          =  ZERO
                 AND  FLG-IRYOHIKG2         =  ZERO
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-SYU-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-SYU-M       =
                                   MAX-KIN-SYU-M       *
                                   WK-GENGAKU-RITUX    /
                                   100
                        END-IF
                     WHEN          2
                        IF  MAX-KIN-SYU-M < WK-GENGAKU-KIN
                          MOVE   ZERO   TO   MAX-KIN-SYU-M
                        ELSE
                          COMPUTE  MAX-KIN-SYU-M  =
                                   MAX-KIN-SYU-M  -
                                   WK-GENGAKU-KIN
                        END-IF
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-SYU-M
                     WHEN          5
                        IF  MAX-KIN-SYU-M > WK-GENGAKU-KIN
                          COMPUTE  MAX-KIN-SYU-M  =
                                   WK-GENGAKU-KIN
                        END-IF
                   END-EVALUATE
                   COMPUTE  MAX-KIN-SYU-M =
                            MAX-KIN-SYU-M +  5
                   COMPUTE  MAX-KIN-SYU-M =
                            MAX-KIN-SYU-M /  10
                   COMPUTE  MAX-KIN-SYU-M =
                            MAX-KIN-SYU-M *  10
                 END-IF
              END-IF
      *
           END-IF
      *
           IF  FLG-GENBUTU70   NOT =   ZERO
      *
             IF   MAX-KIN-SYU-M     NOT =  ZERO
             AND  FLG-IRYOHI70          =  ZERO
                  EVALUATE   WK-GENGAKUKBN
                    WHEN          1
                       IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  MAX-KIN-SYU-M       =
                                  MAX-KIN-SYU-M       *
                                  WK-GENGAKU-RITUX    /
                                  100
                       END-IF
                    WHEN          2
                       IF  MAX-KIN-SYU-M < WK-GENGAKU-KIN
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  MAX-KIN-SYU-M  =
                                  MAX-KIN-SYU-M  -
                                  WK-GENGAKU-KIN
                       END-IF
                    WHEN          3
                    WHEN          4
                       MOVE   ZERO   TO   MAX-KIN-SYU-M
                    WHEN          5
                       IF  MAX-KIN-SYU-M > WK-GENGAKU-KIN
                         COMPUTE  MAX-KIN-SYU-M  =
                                  WK-GENGAKU-KIN
                       END-IF
                  END-EVALUATE
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M +  5
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M /  10
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M *  10
             END-IF
      *
           END-IF
      *
           IF   (LNK-S02-KOUREI-NYUIN-KBN    =  "1")
           OR   (FLG-GENBUTU70  NOT =  ZERO        )
           OR   (FLG-TOKU75-CYO     =   3          )
           OR   (FLG-CYOKI-ARI      =   2          )
      *
             IF    WK-CYOKI-SYUMAXKIN   NOT =  ZERO
               EVALUATE   WK-GENGAKUKBN
                 WHEN          1
                    IF  WK-GENGAKU-RITU = 100
                      MOVE   ZERO   TO   WK-CYOKI-SYUMAXKIN
                    ELSE
                      COMPUTE  WK-GENGAKU-RITUX =
                               100 - WK-GENGAKU-RITU
                      COMPUTE  WK-CYOKI-SYUMAXKIN  =
                               WK-CYOKI-SYUMAXKIN  *
                               WK-GENGAKU-RITUX    /
                               100
                    END-IF
                 WHEN          2
                    IF  WK-CYOKI-SYUMAXKIN < WK-GENGAKU-KIN
                      MOVE   ZERO   TO   WK-CYOKI-SYUMAXKIN
                    ELSE
                      COMPUTE  WK-CYOKI-SYUMAXKIN  =
                               WK-CYOKI-SYUMAXKIN  -
                               WK-GENGAKU-KIN
                    END-IF
                 WHEN          3
                 WHEN          4
                    MOVE   ZERO   TO   WK-CYOKI-SYUMAXKIN
                 WHEN          5
                    IF  WK-CYOKI-SYUMAXKIN > WK-GENGAKU-KIN
                      COMPUTE  WK-CYOKI-SYUMAXKIN  =
                               WK-GENGAKU-KIN
                    END-IF
               END-EVALUATE
               COMPUTE  WK-CYOKI-SYUMAXKIN =
                        WK-CYOKI-SYUMAXKIN +  5
               COMPUTE  WK-CYOKI-SYUMAXKIN =
                        WK-CYOKI-SYUMAXKIN /  10
               COMPUTE  WK-CYOKI-SYUMAXKIN =
                        WK-CYOKI-SYUMAXKIN *  10
             END-IF
      *
           END-IF
      *
           IF  (FLG-TOKU75-CYO   =   3)
           OR  (FLG-CYOKI-ARI    =   2)
      *
             IF   MAX-KIN-SYU-M     NOT =  ZERO
                  EVALUATE   WK-GENGAKUKBN
                    WHEN          1
                       IF  WK-GENGAKU-RITU = 100
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  WK-GENGAKU-RITUX =
                                  100 - WK-GENGAKU-RITU
                         COMPUTE  MAX-KIN-SYU-M       =
                                  MAX-KIN-SYU-M       *
                                  WK-GENGAKU-RITUX    /
                                  100
                       END-IF
                    WHEN          2
                       IF  MAX-KIN-SYU-M < WK-GENGAKU-KIN
                         MOVE   ZERO   TO   MAX-KIN-SYU-M
                       ELSE
                         COMPUTE  MAX-KIN-SYU-M  =
                                  MAX-KIN-SYU-M  -
                                  WK-GENGAKU-KIN
                       END-IF
                    WHEN          3
                    WHEN          4
                       MOVE   ZERO   TO   MAX-KIN-SYU-M
                    WHEN          5
                       IF  MAX-KIN-SYU-M > WK-GENGAKU-KIN
                         COMPUTE  MAX-KIN-SYU-M  =
                                  WK-GENGAKU-KIN
                       END-IF
                  END-EVALUATE
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M +  5
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M /  10
                  COMPUTE  MAX-KIN-SYU-M =
                           MAX-KIN-SYU-M *  10
             END-IF
      *
           END-IF
      *
      ***********
      *
           IF   COMB-KOH1HKNNUM  =  "972" OR "974"
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                                       MAX-KIN-KOHI1-M-TOKU75
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  MAX-KIN-KOHI1-M    =
                             MAX-KIN-KOHI1-M    *
                             WK-GENGAKU-RITUX   /
                             100
                    COMPUTE  MAX-KIN-KOHI1-M-TOKU75    =
                             MAX-KIN-KOHI1-M-TOKU75    *
                             WK-GENGAKU-RITUX   /
                             100
                  END-IF
                WHEN          2
                  IF  MAX-KIN-KOHI1-M < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                  ELSE
                    COMPUTE  MAX-KIN-KOHI1-M  =
                             MAX-KIN-KOHI1-M  -
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI1-M-TOKU75 < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI1-M-TOKU75
                  ELSE
                    COMPUTE  MAX-KIN-KOHI1-M-TOKU75  =
                             MAX-KIN-KOHI1-M-TOKU75  -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   MAX-KIN-KOHI1-M
                                       MAX-KIN-KOHI1-M-TOKU75
                WHEN          5
                  IF  MAX-KIN-KOHI1-M > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI1-M  =
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI1-M-TOKU75 > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI1-M-TOKU75  =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
              COMPUTE  MAX-KIN-KOHI1-M =
                       MAX-KIN-KOHI1-M +  5
              COMPUTE  MAX-KIN-KOHI1-M =
                       MAX-KIN-KOHI1-M /  10
              COMPUTE  MAX-KIN-KOHI1-M =
                       MAX-KIN-KOHI1-M *  10
              COMPUTE  MAX-KIN-KOHI1-M-TOKU75 =
                       MAX-KIN-KOHI1-M-TOKU75 +  5
              COMPUTE  MAX-KIN-KOHI1-M-TOKU75 =
                       MAX-KIN-KOHI1-M-TOKU75 /  10
              COMPUTE  MAX-KIN-KOHI1-M-TOKU75 =
                       MAX-KIN-KOHI1-M-TOKU75 *  10
           END-IF
      *
           IF   COMB-KOH2HKNNUM  =  "972" OR "974"
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   MAX-KIN-KOHI2-M
                                       MAX-KIN-KOHI2-M-TOKU75
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  MAX-KIN-KOHI2-M    =
                             MAX-KIN-KOHI2-M    *
                             WK-GENGAKU-RITUX   /
                             100
                    COMPUTE  MAX-KIN-KOHI2-M-TOKU75    =
                             MAX-KIN-KOHI2-M-TOKU75    *
                             WK-GENGAKU-RITUX   /
                             100
                  END-IF
                WHEN          2
                  IF  MAX-KIN-KOHI2-M < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI2-M
                  ELSE
                    COMPUTE  MAX-KIN-KOHI2-M  =
                             MAX-KIN-KOHI2-M  -
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI2-M-TOKU75 < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI2-M-TOKU75
                  ELSE
                    COMPUTE  MAX-KIN-KOHI2-M-TOKU75  =
                             MAX-KIN-KOHI2-M-TOKU75  -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   MAX-KIN-KOHI2-M
                                       MAX-KIN-KOHI2-M-TOKU75
                WHEN          5
                  IF  MAX-KIN-KOHI2-M > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI2-M  =
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI2-M-TOKU75 > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI2-M-TOKU75  =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
              COMPUTE  MAX-KIN-KOHI2-M =
                       MAX-KIN-KOHI2-M +  5
              COMPUTE  MAX-KIN-KOHI2-M =
                       MAX-KIN-KOHI2-M /  10
              COMPUTE  MAX-KIN-KOHI2-M =
                       MAX-KIN-KOHI2-M *  10
              COMPUTE  MAX-KIN-KOHI2-M-TOKU75 =
                       MAX-KIN-KOHI2-M-TOKU75 +  5
              COMPUTE  MAX-KIN-KOHI2-M-TOKU75 =
                       MAX-KIN-KOHI2-M-TOKU75 /  10
              COMPUTE  MAX-KIN-KOHI2-M-TOKU75 =
                       MAX-KIN-KOHI2-M-TOKU75 *  10
           END-IF
      *
           IF   COMB-KOH3HKNNUM  =  "972" OR "974"
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   MAX-KIN-KOHI3-M
                                       MAX-KIN-KOHI3-M-TOKU75
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  MAX-KIN-KOHI3-M    =
                             MAX-KIN-KOHI3-M    *
                             WK-GENGAKU-RITUX   /
                             100
                    COMPUTE  MAX-KIN-KOHI3-M-TOKU75    =
                             MAX-KIN-KOHI3-M-TOKU75    *
                             WK-GENGAKU-RITUX   /
                             100
                  END-IF
                WHEN          2
                  IF  MAX-KIN-KOHI3-M < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI3-M
                  ELSE
                    COMPUTE  MAX-KIN-KOHI3-M  =
                             MAX-KIN-KOHI3-M  -
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI3-M-TOKU75 < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI3-M-TOKU75
                  ELSE
                    COMPUTE  MAX-KIN-KOHI3-M-TOKU75  =
                             MAX-KIN-KOHI3-M-TOKU75  -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   MAX-KIN-KOHI3-M
                                       MAX-KIN-KOHI3-M-TOKU75
                WHEN          5
                  IF  MAX-KIN-KOHI3-M > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI3-M  =
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI3-M-TOKU75 > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI3-M-TOKU75  =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
              COMPUTE  MAX-KIN-KOHI3-M =
                       MAX-KIN-KOHI3-M +  5
              COMPUTE  MAX-KIN-KOHI3-M =
                       MAX-KIN-KOHI3-M /  10
              COMPUTE  MAX-KIN-KOHI3-M =
                       MAX-KIN-KOHI3-M *  10
              COMPUTE  MAX-KIN-KOHI3-M-TOKU75 =
                       MAX-KIN-KOHI3-M-TOKU75 +  5
              COMPUTE  MAX-KIN-KOHI3-M-TOKU75 =
                       MAX-KIN-KOHI3-M-TOKU75 /  10
              COMPUTE  MAX-KIN-KOHI3-M-TOKU75 =
                       MAX-KIN-KOHI3-M-TOKU75 *  10
           END-IF
      *
           IF   COMB-KOH4HKNNUM  =  "972" OR "974"
              EVALUATE   WK-GENGAKUKBN
                WHEN          1
                  IF  WK-GENGAKU-RITU = 100
                    MOVE   ZERO   TO   MAX-KIN-KOHI4-M
                                       MAX-KIN-KOHI4-M-TOKU75
                  ELSE
                    COMPUTE  WK-GENGAKU-RITUX =
                             100 - WK-GENGAKU-RITU
                    COMPUTE  MAX-KIN-KOHI4-M    =
                             MAX-KIN-KOHI4-M    *
                             WK-GENGAKU-RITUX   /
                             100
                    COMPUTE  MAX-KIN-KOHI4-M-TOKU75    =
                             MAX-KIN-KOHI4-M-TOKU75    *
                             WK-GENGAKU-RITUX   /
                             100
                  END-IF
                WHEN          2
                  IF  MAX-KIN-KOHI4-M < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI4-M
                  ELSE
                    COMPUTE  MAX-KIN-KOHI4-M  =
                             MAX-KIN-KOHI4-M  -
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI4-M-TOKU75 < WK-GENGAKU-KIN
                    MOVE   ZERO   TO   MAX-KIN-KOHI4-M-TOKU75
                  ELSE
                    COMPUTE  MAX-KIN-KOHI4-M-TOKU75  =
                             MAX-KIN-KOHI4-M-TOKU75  -
                             WK-GENGAKU-KIN
                  END-IF
                WHEN          3
                WHEN          4
                  MOVE     ZERO   TO   MAX-KIN-KOHI4-M
                                       MAX-KIN-KOHI4-M-TOKU75
                WHEN          5
                  IF  MAX-KIN-KOHI4-M > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI4-M  =
                             WK-GENGAKU-KIN
                  END-IF
                  IF  MAX-KIN-KOHI4-M-TOKU75 > WK-GENGAKU-KIN
                    COMPUTE  MAX-KIN-KOHI4-M-TOKU75  =
                             WK-GENGAKU-KIN
                  END-IF
              END-EVALUATE
              COMPUTE  MAX-KIN-KOHI4-M =
                       MAX-KIN-KOHI4-M +  5
              COMPUTE  MAX-KIN-KOHI4-M =
                       MAX-KIN-KOHI4-M /  10
              COMPUTE  MAX-KIN-KOHI4-M =
                       MAX-KIN-KOHI4-M *  10
              COMPUTE  MAX-KIN-KOHI4-M-TOKU75 =
                       MAX-KIN-KOHI4-M-TOKU75 +  5
              COMPUTE  MAX-KIN-KOHI4-M-TOKU75 =
                       MAX-KIN-KOHI4-M-TOKU75 /  10
              COMPUTE  MAX-KIN-KOHI4-M-TOKU75 =
                       MAX-KIN-KOHI4-M-TOKU75 *  10
           END-IF
      *
           .
      *
       2109-KOHFTN-KINGAKU-GEN-EXT.
           EXIT.
      *
      ******************************************************************
      *        ´µ¼Ô¸øÈñÉéÃ´¡Ê¹â³Û°ÑÇ¤Ê§¤¤¶â³Û¼è¤ê¹þ¤ß¡Ë¼è¹þ¤ß½èÍý
      ******************************************************************
       210A-KOHININBARAI-KINGAKU-SEC           SECTION.
      *
      *    ¸øÈñ·î¾å¸Â³Û¼èÆÀ
           INITIALIZE                    LNK-ORCSJGNGET-REC
           MOVE  LNK-SYU-HOSPNUM     TO  LNK-ORCSJGNGET-HOSPNUM
           MOVE  LNK-SYU-NYUGAIKBN   TO  LNK-ORCSJGNGET-NYUGAIKBN
           MOVE  LNK-SYU-PTID        TO  LNK-ORCSJGNGET-PTID
           MOVE    "964"             TO  LNK-ORCSJGNGET-KOHHKNNUM
           MOVE  WK-KOHININBARAI-KOHID
                                     TO  LNK-ORCSJGNGET-KOHID
           MOVE  LNK-SYU-SRYYMD(1:6) TO  LNK-ORCSJGNGET-SRYYM
      *
           CALL    "ORCSJGNGET"      USING
                                     LNK-ORCSJGNGET-REC
                                     SPA-AREA
      *
           IF    LNK-ORCSJGNGET-RC   =   ZERO
      ***     IF      LNK-ORCSJGNGET-NYUJGNGAK  =  ZERO
      ***        MOVE    ZERO        TO  FLG-KOHININBARAI
      ***     ELSE
                 MOVE    LNK-ORCSJGNGET-NYUJGNGAK
                                     TO  MAX-KIN-SYU-M
                 MOVE    1           TO  FLG-KOUGAKUCYO-ININ
      ***     END-IF
           ELSE
                 MOVE    ZERO        TO  FLG-KOHININBARAI
           END-IF
      *
           IF   (FLG-KOHININBARAI      =    1      )
           AND  (LNK-SYU-SRYYMD(1:6)  >=   "201501")
             IF    MAX-KIN-SYU-M = 9999999 OR 999999
               CONTINUE
             ELSE
               EVALUATE   WK-KOHININBARAI-JKYSNUM(1:2)
                 WHEN      "¥¢"
                   IF  FLG-KOHYONKAIME = 1
                      MOVE   140100     TO  MAX-KIN-SYU-M
                   ELSE
                      MOVE   252600     TO  MAX-KIN-SYU-M
                      MOVE   WK-ZENGAKU TO  WK-KOUREI-IRYOHI70
                      MOVE   7          TO  FLG-IRYOHI70
                   END-IF
                 WHEN      "¥¤"
                   IF  FLG-KOHYONKAIME = 1
                      MOVE   93000      TO  MAX-KIN-SYU-M
                   ELSE
                      MOVE   167400     TO  MAX-KIN-SYU-M
                      MOVE   WK-ZENGAKU TO  WK-KOUREI-IRYOHI70
                      MOVE   8          TO  FLG-IRYOHI70
                   END-IF
                 WHEN      "¥¦"
                   IF  FLG-KOHYONKAIME = 1
                      MOVE   44400      TO  MAX-KIN-SYU-M
                   ELSE
                      MOVE   80100      TO  MAX-KIN-SYU-M
                      MOVE   WK-ZENGAKU TO  WK-KOUREI-IRYOHI70
                      MOVE   2          TO  FLG-IRYOHI70
                   END-IF
                 WHEN      "¥¨"
                   IF  FLG-KOHYONKAIME = 1
                      MOVE   44400      TO  MAX-KIN-SYU-M
                   ELSE
                      MOVE   57600      TO  MAX-KIN-SYU-M
                   END-IF
                 WHEN      "¥ª"
                   IF  FLG-KOHYONKAIME = 1
                      MOVE   24600      TO  MAX-KIN-SYU-M
                   ELSE
                      MOVE   35400      TO  MAX-KIN-SYU-M
                   END-IF
               END-EVALUATE
             END-IF
           END-IF
      *
           .
      *
       210A-KOHININBARAI-KINGAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    £·£µºÐÅþÃ£·î¤ÎÆÃÎãÀßÄê                                      *
      ******************************************************************
       210B-TOKU75-SETTEI-SEC           SECTION.
      *
           MOVE     ZERO     TO   FLG-TOKU75-CYO
      *
           EVALUATE   FLG-TOKU75
             WHEN        1
             WHEN        2
               IF   LNK-S02-KOUREI-NYUIN-KBN     =  "1"
                 CONTINUE
               ELSE
                 IF (COMB-KOH1HKNNUM(1:1) = "0"      )
                 OR (COMB-KOH2HKNNUM(1:1) = "0"      )
                 OR (COMB-KOH3HKNNUM(1:1) = "0"      )
                 OR (COMB-KOH4HKNNUM(1:1) = "0"      )
                 OR (WK-TOKATUKAI(1) =  1            )
                       CONTINUE
                 ELSE
                       MOVE     9        TO  FLG-TOKU75
                 END-IF
               END-IF
             WHEN        3
               IF   FLG-GENBUTU70   NOT =  ZERO
                 CONTINUE
               ELSE
                 IF (COMB-KOH1HKNNUM = "972" OR "974")
                 OR (COMB-KOH2HKNNUM = "972" OR "974")
                 OR (COMB-KOH3HKNNUM = "972" OR "974")
                 OR (COMB-KOH4HKNNUM = "972" OR "974")
                       MOVE  FLG-TOKU75  TO  FLG-TOKU75-CYO
                 ELSE
                       MOVE     9        TO  FLG-TOKU75
                 END-IF
               END-IF
           END-EVALUATE
      *
           IF   FLG-TOKU75  = 1 OR 2 OR 3
              MOVE    FLG-TOKU75   TO   LNK-SYU-SKJ-FTNDAY(1)
              IF      WK-TOKU75-BIRTHDAY  NOT =  SPACE
                MOVE  WK-TOKU75-BIRTHDAY(7:2)
                                   TO   LNK-SYU-SKJ-FTNDAY(2)
              END-IF
              IF      FLG-KOHININBARAI    =    1
                MOVE  ZERO         TO   FLG-KOHININBARAI
              END-IF
           END-IF
      *
           .
      *
       210B-TOKU75-SETTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *    £·£°ºÐÌ¤Ëþ¸½ÊªµëÉÕ¤Î¼ýÇ¼¥Þ¥¹¥¿¸¡º÷
      ******************************************************************
       210C-SYUNOU-GEN70-KENSAKU-SEC           SECTION.
      *
           INITIALIZE                         SYU-SYUNOU-REC
           MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN    TO    SYU-NYUGAIKBN
           MOVE    LNK-SYU-PTID         TO    SYU-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYU-SRYYMD(1:6)
           MOVE    "__"                 TO    SYU-SRYYMD(7:2)
           MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
           MOVE    "DBSELECT"           TO    MCP-FUNC
           MOVE    "tbl_syunou"         TO    MCP-TABLE
           MOVE    "key14"              TO    MCP-PATHNAME
           CALL    "ORCDBMAIN"          USING MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_syunou"       TO    MCP-TABLE
             MOVE    "key14"            TO    MCP-PATHNAME
             PERFORM  SYUNOU-READ-SEC
             PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
               IF  SYU-DENPJTIKBN    NOT =  "3"
                 EVALUATE  LNK-S02-TEIKI-KBN
                   WHEN       "Y"
                     IF ( LNK-SYU-SKYSTYMD  > SYU-SKYEDYMD )
                     OR ((LNK-SYU-SKYSTYMD  > SYU-SKYSTYMD) AND
                         (LNK-SYU-SKYSTYMD  = SYU-SKYEDYMD) AND
                         (LNK-SYU-SAIKEISANKBN   =  "1"   ))
                     OR ((LNK-SYU-SKYSTYMD  = SYU-SKYSTYMD) AND
                         (LNK-SYU-SKYEDYMD >= SYU-SKYEDYMD) AND
                         (SYU-SAIKEISANKBN  = SPACE       ) AND
                         (LNK-SYU-SAIKEISANKBN   =  "1"   ))
                        MOVE    ZERO         TO    FLG-HANTEI
                        PERFORM 210C1-SYUNOU-GEN70-CNT-SEC
                     END-IF
                   WHEN      OTHER
                     IF ( LNK-SYU-SKYSTYMD >  SYU-SKYSTYMD )
                     OR ((LNK-SYU-SKYSTYMD  = SYU-SKYSTYMD) AND
                         (LNK-SYU-SKYEDYMD >= SYU-SKYEDYMD) AND
                         (SYU-SAIKEISANKBN  = SPACE       ) AND
                         (LNK-SYU-SAIKEISANKBN   =  "1"   ))
                        MOVE    ZERO         TO    FLG-HANTEI
                        PERFORM 210C1-SYUNOU-GEN70-CNT-SEC
                     END-IF
                 END-EVALUATE
               END-IF
               MOVE    "tbl_syunou"     TO    MCP-TABLE
               MOVE    "key14"          TO    MCP-PATHNAME
               PERFORM  SYUNOU-READ-SEC
             END-PERFORM
           END-IF
           MOVE     "tbl_syunou"        TO    MCP-TABLE
           MOVE     "key14"             TO    MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           PERFORM  VARYING  IDZ  FROM  1  BY  1
                     UNTIL  (IDZ                    >   10  )
                       OR   (LNK2-SYU-SKYSTYMD(IDZ) =  SPACE)
               IF  LNK-SYU-SKYSTYMD(1:6) = LNK2-SYU-SKYSTYMD(IDZ)(1:6)
                 MOVE    LNK2-SYUNOU-REC(IDZ)  TO  SYU-SYUNOU-REC
                 MOVE    1                     TO  FLG-HANTEI
                 PERFORM 210C1-SYUNOU-GEN70-CNT-SEC
               END-IF
           END-PERFORM
      *
           .
      *
       210C-SYUNOU-GEN70-KENSAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    £·£°ºÐÌ¤Ëþ¸½ÊªµëÉÕ¤Î¼ýÇ¼¥Þ¥¹¥¿¶â³ÛÊÔ½¸
      ******************************************************************
       210C1-SYUNOU-GEN70-CNT-SEC          SECTION.
      *
      *    ¼ýÇ¼ÊÝ¸±¾ðÊóÊÔ½¸
           MOVE    ZERO   TO   FLG-GENBUTU-CHECK
           PERFORM  22017-SYUNOU-HKN-HENSYU-SEC
           IF   FLG-SYUNOU-HKN-HANTEI  =  1
             GO   TO   210C1-SYUNOU-GEN70-CNT-EXT
           END-IF
      *
           IF ( SYU-SYUHKNNUM       =  "971" OR "973" OR "975"
                                    OR "068" OR "069" OR "040" )
           OR ( SYU-SYUHKNNUM(1:2)  =  "98"  OR "90"  OR "91"  )
           OR ((SYU-KOH1HKNNUM           =  "970"             ) AND
               (SYU-SKJ-FTNGAKU(2)       =   ZERO             ))
           OR ((COMB-KOH1HKNNUM     NOT  =  "970"             ) AND
               (SYU-KOH1HKNNUM           =  "970"             ) AND
               (SYU-SKJ-FTNGAKU(2)  NOT  =   ZERO             ) AND
               (SYU-PTFTNRATE            =   ZERO             ) AND
               (LNK-S02-DAISANYUSENFLG   =   SPACE            ))
             CONTINUE
           ELSE
             IF   (SYU-SYUHKNNUM      NOT = SPACE     )
             AND  (COMB-HKNNUM        NOT = SPACE     )
             AND  (LNK-SYU-YKZKENNUM = SYU-YKZKENNUM  )
             AND  (WK-HKNJANUM2-TBL  = WK-HKNJANUM-TBL)
                 MOVE     ZERO      TO     FLG-HANBETU
                 IF   ((SYU-KOH1HKNNUM  = SPACE OR "970") AND
                       (SYU-KOH2HKNNUM  = SPACE         ) AND
                       (SYU-KOH3HKNNUM  = SPACE         ) AND
                       (SYU-KOH4HKNNUM  = SPACE         ))
                 OR   ((SYU-KOH1HKNNUM  = "092"         ) AND
                       (SYU-NYNSHOKAISU =  7            ) AND
                       (SYU-KOH2HKNNUM  = SPACE         ) AND
                       (SYU-KOH3HKNNUM  = SPACE         ) AND
                       (SYU-KOH4HKNNUM  = SPACE         ))
                   ADD   SYU-TOTAL-HKNTEN      TO
                                   WK-SYUNOU-GENBUTU70T-TOTALTEN
                 ELSE
                  IF   (FLG-HANTEI         =   1   )
                  AND  (LNK-S02-RETRY-FLG  =  SPACE)
                  AND  (LNK-S02-IDX2       <   IDZ )
                    CONTINUE
                  ELSE
                   PERFORM VARYING IDX13  FROM   1   BY   1
                            UNTIL (IDX13   >    50                  )
                             OR   (WK-SYUNOU-GENBUTU70-HKNCOMBINUM
                                                     (IDX13) = SPACE)
                     IF  SYU-HKNCOMBINUM =
                               WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                       ADD   SYU-TOTAL-HKNTEN  TO
                               WK-SYUNOU-GENBUTU70-TOTALTEN(IDX13)
                       ADD   SYU-KOH1COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH1COMPFTN(IDX13)
                       ADD   SYU-KOH2COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH2COMPFTN(IDX13)
                       ADD   SYU-KOH3COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH3COMPFTN(IDX13)
                       ADD   SYU-KOH4COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH4COMPFTN(IDX13)
                       IF    SYU-SKJ-FTNGAKU(3)  =  9
                          MOVE    9            TO
                               WK-SYUNOU-GENBUTU70-GASSANFLG(IDX13)
                       END-IF
                       IF    SYU-NYNSHOKAISU     =  7
                          MOVE    7            TO
                               WK-SYUNOU-GENBUTU70-KANGANFLG(IDX13)
                       END-IF
                       MOVE  1                 TO  FLG-HANBETU
                       MOVE  50                TO  IDX13
                     END-IF
                   END-PERFORM
                   IF    FLG-HANBETU  =  ZERO
                       MOVE  SYU-HKNCOMBINUM   TO
                               WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                       ADD   SYU-TOTAL-HKNTEN  TO
                               WK-SYUNOU-GENBUTU70-TOTALTEN(IDX13)
                       MOVE  SYU-SYUHKNNUM     TO
                               WK-SYUNOU-GENBUTU70-SYUHKNNUM(IDX13)
                       MOVE  SYU-KOH1HKNNUM    TO
                               WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13)
                       ADD   SYU-KOH1COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH1COMPFTN(IDX13)
                       MOVE  SYU-KOH2HKNNUM    TO
                               WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13)
                       ADD   SYU-KOH2COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH2COMPFTN(IDX13)
                       MOVE  SYU-KOH3HKNNUM    TO
                               WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13)
                       ADD   SYU-KOH3COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH3COMPFTN(IDX13)
                       MOVE  SYU-KOH4HKNNUM    TO
                               WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13)
                       ADD   SYU-KOH4COMPFTN   TO
                               WK-SYUNOU-GENBUTU70-KOH4COMPFTN(IDX13)
                       IF    SYU-SKJ-FTNGAKU(3)  =  9
                          MOVE    9            TO
                               WK-SYUNOU-GENBUTU70-GASSANFLG(IDX13)
                       END-IF
                       IF    SYU-NYNSHOKAISU     =  7
                          MOVE    7            TO
                               WK-SYUNOU-GENBUTU70-KANGANFLG(IDX13)
                       END-IF
                   END-IF
                  END-IF
                 END-IF
             END-IF
           END-IF
      *
           .
      *
       210C1-SYUNOU-GEN70-CNT-EXT.
           EXIT.
      *
      ******************************************************************
      *    £·£°ºÐÌ¤Ëþ¸½ÊªµëÉÕ¤Î¥Ç¡¼¥¿ÊÔ½¸
      ******************************************************************
       210D-SYUNOU-GEN70-HENSYU-SEC          SECTION.
      *
      *    ¼çÊÝ¸±Ã±ÆÈÊ¬¤Î·×»»
           COMPUTE  WK-FUTANWARI  =  WK-SYUNOU-GENBUTU70-FTNRATE
                                  /  100
           COMPUTE  WK-SYUNOU-GENBUTU70-KEISAN
                      =  WK-SYUNOU-GENBUTU70T-TOTALTEN
                      *  10
                      *  WK-FUTANWARI
           IF    FLG-TOKU75  =  3
             IF  WK-SYUNOU-GENBUTU70-KEISAN >= 10500
               MOVE    1    TO    WK-SYUNOU-GENBUTU70T-HANTEIFLG
             END-IF
           ELSE
             IF  WK-SYUNOU-GENBUTU70-KEISAN >= 21000
               MOVE    1    TO    WK-SYUNOU-GENBUTU70T-HANTEIFLG
             END-IF
           END-IF
      *
      *    ¸øÈñÊ»ÍÑÊ¬¤Î·×»»
           PERFORM   VARYING   IDX13   FROM   1   BY   1
                      UNTIL   (IDX13     >   50                      )
                        OR    (WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                                                              = SPACE)
             IF ((WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13) =
                                                  "972" OR "974") AND
                 (WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13) =  SPACE) AND
                 (WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13) =  SPACE) AND
                 (WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13) =  SPACE))
             OR ((WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13) =  "092") AND
                 (WK-SYUNOU-GENBUTU70-KANGANFLG(IDX13)  =   7   ) AND
                 (WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13) =
                                                  "972" OR "974") AND
                 (WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13) =  SPACE) AND
                 (WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13) =  SPACE))
               CONTINUE
             ELSE
               COMPUTE  WK-FUTANWARI  =  WK-SYUNOU-GENBUTU70-FTNRATE
                                      /  100
               COMPUTE  WK-SYUNOU-GENBUTU70-KEISAN
                          =  WK-SYUNOU-GENBUTU70-TOTALTEN(IDX13)
                          *  10
                          *  WK-FUTANWARI
               IF ((WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13)
                                       NOT = SPACE          ) AND
                   (WK-SYUNOU-GENBUTU70-KOH1HKNNUM(IDX13)
                                       NOT = "972" AND "974") AND
                   (WK-SYUNOU-GENBUTU70-KOH1COMPFTN(IDX13)
                                       NOT = ZERO           ))
               OR ((WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13)
                                       NOT = SPACE          ) AND
                   (WK-SYUNOU-GENBUTU70-KOH2HKNNUM(IDX13)
                                       NOT = "972" AND "974") AND
                   (WK-SYUNOU-GENBUTU70-KOH2COMPFTN(IDX13)
                                       NOT = ZERO           ))
               OR ((WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13)
                                       NOT = SPACE          ) AND
                   (WK-SYUNOU-GENBUTU70-KOH3HKNNUM(IDX13)
                                       NOT = "972" AND "974") AND
                   (WK-SYUNOU-GENBUTU70-KOH3COMPFTN(IDX13)
                                       NOT = ZERO           ))
               OR ((WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13)
                                       NOT = SPACE          ) AND
                   (WK-SYUNOU-GENBUTU70-KOH4HKNNUM(IDX13)
                                       NOT = "972" AND "974") AND
                   (WK-SYUNOU-GENBUTU70-KOH4COMPFTN(IDX13)
                                       NOT = ZERO           ))
                 IF  FLG-TOKU75  =  3
                   IF  WK-SYUNOU-GENBUTU70-KEISAN >= 10500
                     MOVE  1  TO  WK-SYUNOU-GENBUTU70-HANTEIFLG(IDX13)
                   END-IF
                 ELSE
                   IF  WK-SYUNOU-GENBUTU70-KEISAN >= 21000
                     MOVE  1  TO  WK-SYUNOU-GENBUTU70-HANTEIFLG(IDX13)
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-PERFORM
      *
           .
      *
       210D-SYUNOU-GEN70-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÉéÃ´³ä¹ç¤ÎÊÔ½¸
      ******************************************************************
       210E-SYUNOU-FTNRATE-HENSYU-SEC          SECTION.
      *
      *    ÉéÃ´³ä¹ç
      *
           MOVE         30    TO   WK-SYUNOU-GENBUTU70-FTNRATE
           IF    COMB-HKNNUM   =   "060" OR "039"
             EVALUATE   COMB-HOJOKBN
               WHEN   "0"
               WHEN   "4"
                 MOVE   ZERO  TO   WK-SYUNOU-GENBUTU70-FTNRATE
               WHEN   "1"
               WHEN   "5"
                 MOVE   10    TO   WK-SYUNOU-GENBUTU70-FTNRATE
               WHEN   "2"
               WHEN   "6"
                 MOVE   20    TO   WK-SYUNOU-GENBUTU70-FTNRATE
               WHEN   "3"
                 MOVE   30    TO   WK-SYUNOU-GENBUTU70-FTNRATE
             END-EVALUATE
           ELSE
             EVALUATE   COMB-HOJOKBN
               WHEN   "9"
                 MOVE   10    TO   WK-SYUNOU-GENBUTU70-FTNRATE
               WHEN   "8"
                 MOVE   20    TO   WK-SYUNOU-GENBUTU70-FTNRATE
               WHEN   "7"
                 MOVE   30    TO   WK-SYUNOU-GENBUTU70-FTNRATE
             END-EVALUATE
           END-IF
      *
      *    µÁÌ³¶µ°é½¢³ØÁ°
           IF    LNK-SYU-SRYYMD   >=  "20080401"
             IF  FLG-SYUGAKUMAE    =   1
               IF   COMB-HKNNUM    =  "060"
                 IF   COMB-HOJOKBN   =  "0"  OR  "1"  OR  "4"  OR  "5"
                   CONTINUE
                 ELSE
                   MOVE   20  TO   WK-SYUNOU-GENBUTU70-FTNRATE
                 END-IF
               ELSE
                   MOVE   20  TO   WK-SYUNOU-GENBUTU70-FTNRATE
               END-IF
             END-IF
           END-IF
      *
           IF    COMB-HKNNUM                =    "002"
             EVALUATE   COMB-HOJOKBN
               WHEN   "1"
               WHEN   "2"
               WHEN   "3"
               WHEN   "A"
               WHEN   "B"
               WHEN   "C"
               WHEN   "D"
               WHEN   "E"
               WHEN   "F"
               WHEN   "G"
               WHEN   "H"
               WHEN   "I"
      *****      IF   LNK-S02-SENINFLG  NOT =    "1"
                   MOVE   ZERO   TO   WK-SYUNOU-GENBUTU70-FTNRATE
      *****      END-IF
             END-EVALUATE
           END-IF
      *
           IF    COMB-HKNNUM   =  "031" OR "032" OR "033" OR "034"
             EVALUATE   COMB-HOJOKBN
               WHEN   "2"
               WHEN   "B"
               WHEN   "E"
               WHEN   "H"
                   MOVE   ZERO   TO   WK-SYUNOU-GENBUTU70-FTNRATE
             END-EVALUATE
           END-IF
      *
           .
      *
       210E-SYUNOU-FTNRATE-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÆàÎÉ¸©ÃÏÊý¸øÈñ¤Î¼ýÇ¼¥Þ¥¹¥¿¸¡º÷
      ******************************************************************
       210F-SYUNOU-NARA-KENSAKU-SEC          SECTION.
      *
           INITIALIZE                         SYU-SYUNOU-REC
           MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN    TO    SYU-NYUGAIKBN
           MOVE    LNK-SYU-PTID         TO    SYU-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYU-SRYYMD(1:6)
           MOVE    "__"                 TO    SYU-SRYYMD(7:2)
           MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
           MOVE    "DBSELECT"           TO    MCP-FUNC
           MOVE    "tbl_syunou"         TO    MCP-TABLE
           MOVE    "key14"              TO    MCP-PATHNAME
           CALL    "ORCDBMAIN"          USING MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_syunou"       TO    MCP-TABLE
             MOVE    "key14"            TO    MCP-PATHNAME
             PERFORM  SYUNOU-READ-SEC
             PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
               IF  SYU-DENPJTIKBN    NOT =  "3"
                 EVALUATE  LNK-S02-TEIKI-KBN
                   WHEN       "Y"
                     IF ( LNK-SYU-SKYSTYMD  > SYU-SKYEDYMD )
                     OR ((LNK-SYU-SKYSTYMD  > SYU-SKYSTYMD) AND
                         (LNK-SYU-SKYSTYMD  = SYU-SKYEDYMD) AND
                         (LNK-SYU-SAIKEISANKBN   =  "1"   ))
                     OR ((LNK-SYU-SKYSTYMD  = SYU-SKYSTYMD) AND
                         (LNK-SYU-SKYEDYMD >= SYU-SKYEDYMD) AND
                         (SYU-SAIKEISANKBN  = SPACE       ) AND
                         (LNK-SYU-SAIKEISANKBN   =  "1"   ))
                        IF  (SYU-KOH1HKNNUM  = "173" OR "183" OR "193")
                        OR  (SYU-KOH2HKNNUM  = "173" OR "183" OR "193")
                        OR  (SYU-KOH3HKNNUM  = "173" OR "183" OR "193")
                        OR  (SYU-KOH4HKNNUM  = "173" OR "183" OR "193")
                          IF SYU-DAYINFFLG   = "1"
                            PERFORM     SYUDAY-READ-SEC
                          ELSE
                            INITIALIZE  SYU-SYUDAY-REC
                          END-IF
                          MOVE    1     TO    FLG-NARA
                          PERFORM 210F1-SYUNOU-NARA-CNT-SEC
                        END-IF
                     END-IF
                   WHEN      OTHER
                     IF ( LNK-SYU-SKYSTYMD >  SYU-SKYSTYMD )
                     OR ((LNK-SYU-SKYSTYMD  = SYU-SKYSTYMD) AND
                         (LNK-SYU-SKYEDYMD >= SYU-SKYEDYMD) AND
                         (SYU-SAIKEISANKBN  = SPACE       ) AND
                         (LNK-SYU-SAIKEISANKBN   =  "1"   ))
                        IF  (SYU-KOH1HKNNUM  = "173" OR "183" OR "193")
                        OR  (SYU-KOH2HKNNUM  = "173" OR "183" OR "193")
                        OR  (SYU-KOH3HKNNUM  = "173" OR "183" OR "193")
                        OR  (SYU-KOH4HKNNUM  = "173" OR "183" OR "193")
                          IF SYU-DAYINFFLG   = "1"
                            PERFORM     SYUDAY-READ-SEC
                          ELSE
                            INITIALIZE  SYU-SYUDAY-REC
                          END-IF
                          MOVE    1     TO    FLG-NARA
                          PERFORM 210F1-SYUNOU-NARA-CNT-SEC
                        END-IF
                     END-IF
                 END-EVALUATE
               END-IF
               MOVE    "tbl_syunou"     TO    MCP-TABLE
               MOVE    "key14"          TO    MCP-PATHNAME
               PERFORM  SYUNOU-READ-SEC
             END-PERFORM
           END-IF
           MOVE     "tbl_syunou"        TO    MCP-TABLE
           MOVE     "key14"             TO    MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           .
      *
       210F-SYUNOU-NARA-KENSAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÆàÎÉ¸©ÃÏÊý¸øÈñ¤Î¼ýÇ¼¥Þ¥¹¥¿»»ÄêÆüÊÔ½¸
      ******************************************************************
       210F1-SYUNOU-NARA-CNT-SEC          SECTION.
      *
      *    ¼ýÇ¼ÊÝ¸±¾ðÊóÊÔ½¸
           MOVE    ZERO   TO   FLG-GENBUTU-CHECK
           PERFORM  22017-SYUNOU-HKN-HENSYU-SEC
           IF   FLG-SYUNOU-HKN-HANTEI  =  1
             GO   TO   210F1-SYUNOU-NARA-CNT-EXT
           END-IF
      *
           MOVE    ZERO   TO   IDX27
           IF   (SYU-SYUHKNNUM      NOT = SPACE     )
           AND  (COMB-HKNNUM        NOT = SPACE     )
           AND  (LNK-SYU-YKZKENNUM = SYU-YKZKENNUM  )
           AND  (WK-HKNJANUM2-TBL  = WK-HKNJANUM-TBL)
             IF     COMB-KOH1HKNNUM  = "173" OR "183" OR "193"
               IF  (COMB-KOH1HKNNUM     =  SYU-KOH1HKNNUM )
               AND (COMB-KOH1ID         =  WRK-COMB-KOH1ID)
                 MOVE     1     TO   IDX27
               END-IF
               IF  (COMB-KOH1HKNNUM     =  SYU-KOH2HKNNUM )
               AND (COMB-KOH1ID         =  WRK-COMB-KOH2ID)
                 MOVE     2     TO   IDX27
               END-IF
               IF  (COMB-KOH1HKNNUM     =  SYU-KOH3HKNNUM )
               AND (COMB-KOH1ID         =  WRK-COMB-KOH3ID)
                 MOVE     3     TO   IDX27
               END-IF
               IF  (COMB-KOH1HKNNUM     =  SYU-KOH4HKNNUM )
               AND (COMB-KOH1ID         =  WRK-COMB-KOH4ID)
                 MOVE     4     TO   IDX27
               END-IF
             END-IF
             IF     COMB-KOH2HKNNUM  = "173" OR "183" OR "193"
               IF  (COMB-KOH2HKNNUM     =  SYU-KOH1HKNNUM )
               AND (COMB-KOH2ID         =  WRK-COMB-KOH1ID)
                 MOVE     1     TO   IDX27
               END-IF
               IF  (COMB-KOH2HKNNUM     =  SYU-KOH2HKNNUM )
               AND (COMB-KOH2ID         =  WRK-COMB-KOH2ID)
                 MOVE     2     TO   IDX27
               END-IF
               IF  (COMB-KOH2HKNNUM     =  SYU-KOH3HKNNUM )
               AND (COMB-KOH2ID         =  WRK-COMB-KOH3ID)
                 MOVE     3     TO   IDX27
               END-IF
               IF  (COMB-KOH2HKNNUM     =  SYU-KOH4HKNNUM )
               AND (COMB-KOH2ID         =  WRK-COMB-KOH4ID)
                 MOVE     4     TO   IDX27
               END-IF
             END-IF
             IF     COMB-KOH3HKNNUM  = "173" OR "183" OR "193"
               IF  (COMB-KOH3HKNNUM     =  SYU-KOH1HKNNUM )
               AND (COMB-KOH3ID         =  WRK-COMB-KOH1ID)
                 MOVE     1     TO   IDX27
               END-IF
               IF  (COMB-KOH3HKNNUM     =  SYU-KOH2HKNNUM )
               AND (COMB-KOH3ID         =  WRK-COMB-KOH2ID)
                 MOVE     2     TO   IDX27
               END-IF
               IF  (COMB-KOH3HKNNUM     =  SYU-KOH3HKNNUM )
               AND (COMB-KOH3ID         =  WRK-COMB-KOH3ID)
                 MOVE     3     TO   IDX27
               END-IF
               IF  (COMB-KOH3HKNNUM     =  SYU-KOH4HKNNUM )
               AND (COMB-KOH3ID         =  WRK-COMB-KOH4ID)
                 MOVE     4     TO   IDX27
               END-IF
             END-IF
             IF     COMB-KOH4HKNNUM  = "173" OR "183" OR "193"
               IF  (COMB-KOH4HKNNUM     =  SYU-KOH1HKNNUM )
               AND (COMB-KOH4ID         =  WRK-COMB-KOH1ID)
                 MOVE     1     TO   IDX27
               END-IF
               IF  (COMB-KOH4HKNNUM     =  SYU-KOH2HKNNUM )
               AND (COMB-KOH4ID         =  WRK-COMB-KOH2ID)
                 MOVE     2     TO   IDX27
               END-IF
               IF  (COMB-KOH4HKNNUM     =  SYU-KOH3HKNNUM )
               AND (COMB-KOH4ID         =  WRK-COMB-KOH3ID)
                 MOVE     3     TO   IDX27
               END-IF
               IF  (COMB-KOH4HKNNUM     =  SYU-KOH4HKNNUM )
               AND (COMB-KOH4ID         =  WRK-COMB-KOH4ID)
                 MOVE     4     TO   IDX27
               END-IF
             END-IF
           END-IF
      *
           IF   IDX27  NOT = ZERO
             PERFORM   VARYING  IDX28  FROM  1  BY  1
                        UNTIL   IDX28   >   31
               EVALUATE   FLG-NARA
                 WHEN       1
                   IF  SDAY-SANTEIFLG(IDX28 IDX27)  =  1
                       MOVE   1   TO   WK-CHIHOU-SANTEIDAY-RUI(IDX28)
                   END-IF
                 WHEN       2
                   IF   ((SYU-DAY(IDX28)               =  "1" OR "9") OR
                         (LNK-S02-NYUINDAY-KBN(IDX28)  =  "1"       ))
                   AND  ( LNK-S02-NYUSANTEI-KBN(IDX28) =  "1"        )
                       MOVE   1   TO   WK-CHIHOU-SANTEIDAY-RUI(IDX28)
                   ELSE
                     IF  (SYU-DAY(IDX28) = "2" OR "8" OR "9")
                     AND (SDAY-HKNTEN(IDX28)   NOT =  ZERO  )
                       MOVE   1   TO   WK-CHIHOU-SANTEIDAY-RUI(IDX28)
                     END-IF
                   END-IF
               END-EVALUATE
             END-PERFORM
           END-IF
      *
           .
      *
       210F1-SYUNOU-NARA-CNT-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÆàÎÉ¸©ÃÏÊý¸øÈñ¤Î¥Ç¡¼¥¿ÊÔ½¸
      ******************************************************************
       210G-SYUNOU-NARA-HENSYU-SEC          SECTION.
      *
           PERFORM   VARYING  IDX28  FROM  1  BY  1
                      UNTIL   IDX28   >   31
             IF   ((LNK-SYU-DAY(IDX28)           =  "1" OR "9") OR
                   (LNK-S02-NYUINDAY-KBN(IDX28)  =  "1"       ))
             AND  ( LNK-S02-NYUSANTEI-KBN(IDX28) =  "1"        )
                 MOVE   1   TO   WK-CHIHOU-SANTEIDAY-RUI(IDX28)
                 MOVE   1   TO   WK-CHIHOU-SANTEIDAY(IDX28)
             ELSE
               IF  (LNK-SYU-DAY(IDX28) = "2" OR "8" OR "9")
               AND (LNK-SDAY-HKNTEN(IDX28)   NOT =  ZERO  )
                 MOVE   1   TO   WK-CHIHOU-SANTEIDAY-RUI(IDX28)
                 MOVE   1   TO   WK-CHIHOU-SANTEIDAY(IDX28)
               END-IF
             END-IF
           END-PERFORM
      *
           PERFORM   VARYING  IDX28  FROM  1  BY  1
                      UNTIL   IDX28   >   31
             IF    WK-CHIHOU-SANTEIDAY-RUI(IDX28)  =  1
               ADD    1     TO   WK-CHIHOU-SANTEIDAY-CNT
             END-IF
           END-PERFORM
      *
           IF    COMB-KOH1HKNNUM  = "173" OR "183" OR "193"
             IF    WK-CHIHOU-SANTEIDAY-CNT  >=  14
               MOVE   1000  TO   MAX-KIN-KOHI1-M
             END-IF
             PERFORM   VARYING  IDX28  FROM  1  BY  1
                        UNTIL   IDX28   >   31
               IF  WK-CHIHOU-SANTEIDAY(IDX28)  =  1
                 MOVE   1   TO   LNK-SDAY-SANTEIFLG(IDX28 1)
                 MOVE  "1"  TO   LNK-SDAY-DAYINFFLG
                 MOVE  "1"  TO   LNK-SYU-DAYINFFLG
               END-IF
             END-PERFORM
           END-IF
           IF    COMB-KOH2HKNNUM  = "173" OR "183" OR "193"
             IF    WK-CHIHOU-SANTEIDAY-CNT  >=  14
               MOVE   1000  TO   MAX-KIN-KOHI2-M
             END-IF
             PERFORM   VARYING  IDX28  FROM  1  BY  1
                        UNTIL   IDX28   >   31
               IF  WK-CHIHOU-SANTEIDAY(IDX28)  =  1
                 MOVE   1   TO   LNK-SDAY-SANTEIFLG(IDX28 2)
                 MOVE  "1"  TO   LNK-SDAY-DAYINFFLG
                 MOVE  "1"  TO   LNK-SYU-DAYINFFLG
               END-IF
             END-PERFORM
           END-IF
           IF    COMB-KOH3HKNNUM  = "173" OR "183" OR "193"
             IF    WK-CHIHOU-SANTEIDAY-CNT  >=  14
               MOVE   1000  TO   MAX-KIN-KOHI3-M
             END-IF
             PERFORM   VARYING  IDX28  FROM  1  BY  1
                        UNTIL   IDX28   >   31
               IF  WK-CHIHOU-SANTEIDAY(IDX28)  =  1
                 MOVE   1   TO   LNK-SDAY-SANTEIFLG(IDX28 3)
                 MOVE  "1"  TO   LNK-SDAY-DAYINFFLG
                 MOVE  "1"  TO   LNK-SYU-DAYINFFLG
               END-IF
             END-PERFORM
           END-IF
           IF    COMB-KOH4HKNNUM  = "173" OR "183" OR "193"
             IF    WK-CHIHOU-SANTEIDAY-CNT  >=  14
               MOVE   1000  TO   MAX-KIN-KOHI4-M
             END-IF
             PERFORM   VARYING  IDX28  FROM  1  BY  1
                        UNTIL   IDX28   >   31
               IF  WK-CHIHOU-SANTEIDAY(IDX28)  =  1
                 MOVE   1   TO   LNK-SDAY-SANTEIFLG(IDX28 4)
                 MOVE  "1"  TO   LNK-SDAY-DAYINFFLG
                 MOVE  "1"  TO   LNK-SYU-DAYINFFLG
               END-IF
             END-PERFORM
           END-IF
      *
           .
      *
       210G-SYUNOU-NARA-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¿ÇÎÅ·îÆâ¤Î¼ýÇ¼¥Þ¥¹¥¿¤«¤é¸øÈñËè¤Î´µ¼ÔÉéÃ´¶â³Û¤Î
      *    Îß·×¤òÄ´ºº
      ******************************************************************
       220-SYUNOU-SEC           SECTION.
      *
           MOVE     ZERO        TO    FLG-NYUGAI.
           MOVE     ZERO        TO    FLG-NYUGAI2.
           MOVE     ZERO        TO    FLG-TOKYO.
           MOVE     ZERO        TO    FLG-GEN70-TOKUSYU.
      *
           MOVE     ZERO        TO    WK-CYOKI.
           MOVE     ZERO        TO    WK-CYOKI-ENTANI.
           MOVE     ZERO        TO    WK-CYOKI-TOKU75.
           MOVE     ZERO        TO    WK-CYOKI-ENTANI-TOKU75.
      *
           MOVE     ZERO        TO    WK-OITA-HKNFTNMONEY.
           MOVE     ZERO        TO    WK-OITA-CYOFTN.
      *
           MOVE     ZERO        TO    FLG-SYUKEI2.
      *
           MOVE     ZERO        TO    WK-GENBUTU-HKNKIN.
      *
           MOVE     ZERO        TO    WK-KUMAMOTO-HANTEIKIN.
      *
           MOVE     ZERO        TO    FLG-OITA-SYUKEI.
      *
           INITIALIZE                 WK-MARUKO-TBL.
           INITIALIZE                 WK-RUI-TBL.
           MOVE     ZERO        TO    FLG-RUIKEIYO.
           MOVE     ZERO        TO    FLG-RUIKEIYO2.
           MOVE     ZERO        TO    FLG-RUIKEIYO-DAY.
      *
           MOVE     ZERO        TO    WK-JYOSEI-KOHIKIN-RUI.
           MOVE     ZERO        TO    WK-JYOSEI-KOHIKIN-RUI2.
           MOVE     ZERO        TO    WK-JYOSEI-KOHIKIN-RUI3.
      *
           MOVE     ZERO        TO    WK-IRYOKEIKBN-HANTEITEN.
      *
           MOVE     ZERO        TO    WK-CYOKI-KEISAN4.
           MOVE     ZERO        TO    WK-CYOKI-FTN-SYU-M.
           MOVE     ZERO        TO    WK-CYOKI-FTN-SYU-M-ENTANI.
           INITIALIZE                 WK-SYS2010-CYOKI-TBL.
      *
           INITIALIZE                 WK-GENGAKU-TEN-TBL.
           MOVE     ZERO        TO    IDX14.
      *
           IF    COMB-KOH1HKNNUM     =  "970"
               IF   (FLG-GENBUTU70           NOT =  ZERO)
               OR   (LNK-S02-KOUREI-NYUIN-KBN    =  "1" )
                   MOVE  "1"    TO    WK-1001-DAISANKBN
               END-IF
           END-IF.
      *
           IF    LNK-SYU-SRYYMD(1:6)   >=  "202001"
             IF  (COMB-KOH1HKNNUM  = "972" OR "974")
             OR  (COMB-KOH2HKNNUM  = "972" OR "974")
             OR  (COMB-KOH3HKNNUM  = "972" OR "974")
             OR  (COMB-KOH4HKNNUM  = "972" OR "974")
               COMPUTE WK-FUTANWARI =
                       WK-SYUNOU-GENBUTU70-FTNRATE / 100
               COMPUTE WK-CYOKI-KEISAN3     =
                       LNK-SYU-TOTAL-HKNTEN * 10 * WK-FUTANWARI
               COMPUTE WK-CYOKI-KEISAN3 = WK-CYOKI-KEISAN3 +  5
               COMPUTE WK-CYOKI-KEISAN3 = WK-CYOKI-KEISAN3 / 10
               COMPUTE WK-CYOKI-KEISAN3 = WK-CYOKI-KEISAN3 * 10
      *
               COMPUTE WK-CYOKI-KEISAN4 = WK-CYOKI-KEISAN4
                                        + WK-CYOKI-KEISAN3
      *
               PERFORM 2206-CYOKI-SYSCHECK-SEC
             END-IF
           END-IF.
      *
      *    ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»Å¬ÍÑ³«»ÏÆü¥Á¥§¥Ã¥¯
           MOVE      LNK-SYU-SRYYMD(1:6)    TO   WK-CHECK-TEKYM.
           IF   COMB-TEKSTYMD(1:6)  >=  LNK-SYU-SRYYMD(1:6)
              MOVE   COMB-TEKSTYMD(7:2)     TO   WK-CHECK-TEKDD
           ELSE
              MOVE   01                     TO   WK-CHECK-TEKDD
           END-IF.
      *
           PERFORM     2204-FLG-HENSYU-SEC.
      *
      *    ¡ã£±Æþ±¡²ó¿ôÂÐ±þ¡ä
           PERFORM     2205-RIREKI-HENSYU-SEC.
      *
           IF  (COMB-KOH1-NYUJGNKBN       =  "1"       )
           OR  (COMB-KOH2-NYUJGNKBN       =  "1"       )
           OR  (COMB-KOH3-NYUJGNKBN       =  "1"       )
           OR  (COMB-KOH4-NYUJGNKBN       =  "1"       )
           OR  (WK-2010-IRYOKEIKBN-N(1)   =  "3" OR "4")
           OR  (WK-2010-IRYOKEIKBN-N(2)   =  "3" OR "4")
           OR  (WK-2010-IRYOKEIKBN-N(3)   =  "3" OR "4")
           OR  (WK-2010-IRYOKEIKBN-N(4)   =  "3" OR "4")
           OR  (LNK-S02-KOUREI-NYUIN-KBN  =  "1"       )
           OR  (FLG-KOREI-TANYUIN         =   1        )
           OR  (FLG-KOHININBARAI          =   1        )
           OR  (FLG-GENBUTU70         NOT =  ZERO      )
           OR  (FLG-TOKU75-CYO            =   3        )
           OR  (FLG-CYOKI-ARI             =   2        )
           OR  (LNK-SYU-YKZKENNUM         =   2 OR 5   )
      *
               IF   WK-1001-PREFNUM       =     32
               AND  LNK-SYU-SRYYMD(1:6)   <    "200510"
                    IF    LNK-SYU-KOH1HKNNUM = "190" OR "191"
                        MOVE     1    TO     FLG-NYUGAI2
                    END-IF
                    IF    LNK-SYU-KOH2HKNNUM = "190" OR "191"
                        MOVE     2    TO     FLG-NYUGAI2
                    END-IF
                    IF    LNK-SYU-KOH3HKNNUM = "190" OR "191"
                        MOVE     3    TO     FLG-NYUGAI2
                    END-IF
                    IF    LNK-SYU-KOH4HKNNUM = "190" OR "191"
                        MOVE     4    TO     FLG-NYUGAI2
                    END-IF
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)   >=   "200604"
                    IF    LNK-SYU-KOH1HKNNUM  = "015" OR "016" OR "021"
                      IF  WK-JIRITU-CYUKANSOU(1)   =  2
                        MOVE     1    TO     FLG-NYUGAI
                        MOVE  WK-JIRITU-TAFTNRUIKEI(1) TO FTN-KOHI1-M
                                                          FTN-KOHI1-M2
                                                          FTN-KOHI1-M3
                      END-IF
                    END-IF
                    IF    LNK-SYU-KOH2HKNNUM  = "015" OR "016" OR "021"
                      IF  WK-JIRITU-CYUKANSOU(2)   =  2
                        MOVE     2    TO     FLG-NYUGAI
                        MOVE  WK-JIRITU-TAFTNRUIKEI(2) TO FTN-KOHI2-M
                                                          FTN-KOHI2-M2
                                                          FTN-KOHI2-M3
                      END-IF
                    END-IF
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)   >=   "200610"
                    IF   LNK-SYU-KOH1HKNNUM  = "024" OR "079"
                        MOVE     1    TO     FLG-NYUGAI
                    END-IF
                    IF   LNK-SYU-KOH2HKNNUM  = "024" OR "079"
                        MOVE     2    TO     FLG-NYUGAI
                    END-IF
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)   >=   "200804"
                    IF   LNK-SYU-KOH1HKNNUM  = "038"
                        MOVE     1    TO     FLG-NYUGAI
                        MOVE  WK-KANEN-TAFTNRUIKEI(1)  TO FTN-KOHI1-M
                                                          FTN-KOHI1-M2
                                                          FTN-KOHI1-M3
                    END-IF
               END-IF
               IF   LNK-SYU-SRYYMD(1:6)   >=   "201501"
                    IF   LNK-SYU-KOH1HKNNUM  = "052" OR "054"
                        MOVE     1    TO     FLG-NYUGAI
                        MOVE  WK-TOKUSITU-TAFTNRUIKEI(1)
                                                       TO FTN-KOHI1-M
                                                          FTN-KOHI1-M2
                                                          FTN-KOHI1-M3
                    END-IF
                    IF   LNK-SYU-KOH2HKNNUM  = "054"
                        MOVE     2    TO     FLG-NYUGAI
                        MOVE  WK-TOKUSITU-TAFTNRUIKEI(2)
                                                       TO FTN-KOHI2-M
                                                          FTN-KOHI2-M2
                                                          FTN-KOHI2-M3
                    END-IF
               END-IF
      *
               IF  (LNK-SYU-KOH1HKNNUM(1:1)  >=  "1" AND <=  "8")
               AND (WK-KOHJGNGET-TAISYOKBN(1) =   2             )
                        MOVE  WK-CHIHOU-TAFTNRUIKEI(1) TO FTN-KOHI1-M
                                                          FTN-KOHI1-M2
                                                          FTN-KOHI1-M3
               END-IF
               IF  (LNK-SYU-KOH2HKNNUM(1:1)  >=  "1" AND <=  "8")
               AND (WK-KOHJGNGET-TAISYOKBN(2) =   2             )
                        MOVE  WK-CHIHOU-TAFTNRUIKEI(2) TO FTN-KOHI2-M
                                                          FTN-KOHI2-M2
                                                          FTN-KOHI2-M3
               END-IF
               IF  (LNK-SYU-KOH3HKNNUM(1:1)  >=  "1" AND <=  "8")
               AND (WK-KOHJGNGET-TAISYOKBN(3) =   2             )
                        MOVE  WK-CHIHOU-TAFTNRUIKEI(3) TO FTN-KOHI3-M
                                                          FTN-KOHI3-M2
                                                          FTN-KOHI3-M3
               END-IF
               IF  (LNK-SYU-KOH4HKNNUM(1:1)  >=  "1" AND <=  "8")
               AND (WK-KOHJGNGET-TAISYOKBN(4) =   2             )
                        MOVE  WK-CHIHOU-TAFTNRUIKEI(4) TO FTN-KOHI4-M
                                                          FTN-KOHI4-M2
                                                          FTN-KOHI4-M3
               END-IF
      *
               PERFORM     2203-JGNFTNKBN-HENSYU-SEC
      *
               IF   LNK-S02-TEIKI-KBN     =   "X"
                 IF    FLG-NYUGAI    NOT =   ZERO
                 OR    FLG-NYUGAI2   NOT =   ZERO
                   INITIALIZE                         SYU-SYUNOU-REC
                   MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
                   MOVE    "2"                  TO    SYU-NYUGAIKBN
                   MOVE    LNK-SYU-PTID         TO    SYU-PTID
                   MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYU-SRYYMD(1:6)
                   MOVE    "__"                 TO    SYU-SRYYMD(7:2)
                   MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
                   MOVE    "DBSELECT"           TO    MCP-FUNC
                   MOVE    "tbl_syunou"         TO    MCP-TABLE
                   MOVE    "key14"              TO    MCP-PATHNAME
                   CALL    "ORCDBMAIN"          USING MCPAREA
                                                      MCPDATA-REC
                                                      SPA-AREA
                   IF      MCP-RC             =       ZERO
                     MOVE    "tbl_syunou"       TO    MCP-TABLE
                     MOVE    "key14"            TO    MCP-PATHNAME
                     PERFORM  SYUNOU-READ-SEC
                     PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                       IF  SYU-DENPJTIKBN    NOT =  "3"
                             INITIALIZE     SYU-SYUDAY-REC
                             PERFORM        2201-SYUNOU-COUNT-SEC
                       END-IF
                       MOVE    "tbl_syunou"     TO    MCP-TABLE
                       MOVE    "key14"          TO    MCP-PATHNAME
                       PERFORM  SYUNOU-READ-SEC
                     END-PERFORM
                   END-IF
      *
                   MOVE     "tbl_syunou"        TO    MCP-TABLE
                   MOVE     "key14"             TO    MCP-PATHNAME
                   PERFORM   DB-CLOSE-SEC
                 END-IF
               ELSE
                 IF    FLG-NYUGAI    NOT =   ZERO
                 OR    FLG-NYUGAI2   NOT =   ZERO
                   INITIALIZE                         SYU-SYUNOU-REC
                   MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
                   MOVE    LNK-SYU-PTID         TO    SYU-PTID
                   MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYU-SRYYMD(1:6)
                   MOVE    "__"                 TO    SYU-SRYYMD(7:2)
                   MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
                   MOVE    "DBSELECT"           TO    MCP-FUNC
                   MOVE    "tbl_syunou"         TO    MCP-TABLE
                   MOVE    "key29"              TO    MCP-PATHNAME
                   CALL    "ORCDBMAIN"          USING MCPAREA
                                                      MCPDATA-REC
                                                      SPA-AREA
                   IF      MCP-RC             =       ZERO
                     MOVE    "tbl_syunou"       TO    MCP-TABLE
                     MOVE    "key29"            TO    MCP-PATHNAME
                     PERFORM  SYUNOU-READ-SEC
                     PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                       IF  SYU-DENPJTIKBN    NOT =  "3"
                          IF   SYU-NYUGAIKBN     =  "1"
                            EVALUATE  LNK-S02-TEIKI-KBN
                             WHEN       "Y"
                              IF ( LNK-SYU-SKYSTYMD  > SYU-SKYEDYMD )
                              OR ((LNK-SYU-SKYSTYMD  > SYU-SKYSTYMD) AND
                                  (LNK-SYU-SKYSTYMD  = SYU-SKYEDYMD) AND
                                  (LNK-SYU-SAIKEISANKBN   =  "1"   ))
                              OR ((LNK-SYU-SKYSTYMD  = SYU-SKYSTYMD) AND
                                  (LNK-SYU-SKYEDYMD >= SYU-SKYEDYMD) AND
                                  (SYU-SAIKEISANKBN  = SPACE       ) AND
                                  (LNK-SYU-SAIKEISANKBN   =  "1"   ))
                                 IF   SYU-DAYINFFLG  =  "1"
                                   PERFORM     SYUDAY-READ-SEC
                                 ELSE
                                   INITIALIZE  SYU-SYUDAY-REC
                                 END-IF
                                 PERFORM       2201-SYUNOU-COUNT-SEC
                              END-IF
                             WHEN      OTHER
                              IF ( LNK-SYU-SKYSTYMD >  SYU-SKYSTYMD )
                              OR ((LNK-SYU-SKYSTYMD  = SYU-SKYSTYMD) AND
                                  (LNK-SYU-SKYEDYMD >= SYU-SKYEDYMD) AND
                                  (SYU-SAIKEISANKBN  = SPACE       ) AND
                                  (LNK-SYU-SAIKEISANKBN   =  "1"   ))
                                 IF   SYU-DAYINFFLG  =  "1"
                                   PERFORM     SYUDAY-READ-SEC
                                 ELSE
                                   INITIALIZE  SYU-SYUDAY-REC
                                 END-IF
                                 PERFORM       2201-SYUNOU-COUNT-SEC
                              END-IF
                            END-EVALUATE
                          ELSE
                               INITIALIZE     SYU-SYUDAY-REC
                               PERFORM        2201-SYUNOU-COUNT-SEC
                          END-IF
                       END-IF
                       MOVE    "tbl_syunou"     TO    MCP-TABLE
                       MOVE    "key29"          TO    MCP-PATHNAME
                       PERFORM  SYUNOU-READ-SEC
                     END-PERFORM
                   END-IF
      *
                   MOVE     "tbl_syunou"        TO    MCP-TABLE
                   MOVE     "key29"             TO    MCP-PATHNAME
                   PERFORM   DB-CLOSE-SEC
                 ELSE
                   INITIALIZE                         SYU-SYUNOU-REC
                   MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
                   MOVE    LNK-SYU-NYUGAIKBN    TO    SYU-NYUGAIKBN
                   MOVE    LNK-SYU-PTID         TO    SYU-PTID
                   MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYU-SRYYMD(1:6)
                   MOVE    "__"                 TO    SYU-SRYYMD(7:2)
                   MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
                   MOVE    "DBSELECT"           TO    MCP-FUNC
                   MOVE    "tbl_syunou"         TO    MCP-TABLE
                   MOVE    "key14"              TO    MCP-PATHNAME
                   CALL    "ORCDBMAIN"          USING MCPAREA
                                                      MCPDATA-REC
                                                      SPA-AREA
                   IF      MCP-RC             =       ZERO
                     MOVE    "tbl_syunou"       TO    MCP-TABLE
                     MOVE    "key14"            TO    MCP-PATHNAME
                     PERFORM  SYUNOU-READ-SEC
                     PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                       IF  SYU-DENPJTIKBN    NOT =  "3"
                            EVALUATE  LNK-S02-TEIKI-KBN
                             WHEN       "Y"
                              IF ( LNK-SYU-SKYSTYMD  > SYU-SKYEDYMD )
                              OR ((LNK-SYU-SKYSTYMD  > SYU-SKYSTYMD) AND
                                  (LNK-SYU-SKYSTYMD  = SYU-SKYEDYMD) AND
                                  (LNK-SYU-SAIKEISANKBN   =  "1"   ))
                              OR ((LNK-SYU-SKYSTYMD  = SYU-SKYSTYMD) AND
                                  (LNK-SYU-SKYEDYMD >= SYU-SKYEDYMD) AND
                                  (SYU-SAIKEISANKBN  = SPACE       ) AND
                                  (LNK-SYU-SAIKEISANKBN   =  "1"   ))
                                 IF   SYU-DAYINFFLG  =  "1"
                                   PERFORM     SYUDAY-READ-SEC
                                 ELSE
                                   INITIALIZE  SYU-SYUDAY-REC
                                 END-IF
                                 PERFORM       2201-SYUNOU-COUNT-SEC
                              END-IF
                             WHEN      OTHER
                              IF ( LNK-SYU-SKYSTYMD >  SYU-SKYSTYMD )
                              OR ((LNK-SYU-SKYSTYMD  = SYU-SKYSTYMD) AND
                                  (LNK-SYU-SKYEDYMD >= SYU-SKYEDYMD) AND
                                  (SYU-SAIKEISANKBN  = SPACE       ) AND
                                  (LNK-SYU-SAIKEISANKBN   =  "1"   ))
                                 IF   SYU-DAYINFFLG  =  "1"
                                   PERFORM     SYUDAY-READ-SEC
                                 ELSE
                                   INITIALIZE  SYU-SYUDAY-REC
                                 END-IF
                                 PERFORM       2201-SYUNOU-COUNT-SEC
                              END-IF
                            END-EVALUATE
                       END-IF
                       MOVE    "tbl_syunou"     TO    MCP-TABLE
                       MOVE    "key14"          TO    MCP-PATHNAME
                       PERFORM  SYUNOU-READ-SEC
                     END-PERFORM
                   END-IF
      *
                   MOVE     "tbl_syunou"        TO    MCP-TABLE
                   MOVE     "key14"             TO    MCP-PATHNAME
                   PERFORM   DB-CLOSE-SEC
                 END-IF
               END-IF
      *
               PERFORM    VARYING   IDZ    FROM   1   BY   1
                           UNTIL  (IDZ    >    10)
                             OR   (LNK2-SYU-SKYSTYMD(IDZ) =  SPACE)
                 IF   (LNK-S02-RETRY-FLG  =  SPACE)
                 AND  (LNK-S02-IDX2       <   IDZ )
                   CONTINUE
                 ELSE
                   IF  LNK-SYU-SKYSTYMD(1:6)
                                      = LNK2-SYU-SKYSTYMD(IDZ)(1:6)
                     MOVE   LNK2-SYUNOU-REC(IDZ)    TO SYU-SYUNOU-REC
                     IF   SYU-DAYINFFLG  =  "1"
                       MOVE LNK-WRK-SYUDAY-REC(IDZ) TO SYU-SYUDAY-REC
                     ELSE
                       INITIALIZE SYU-SYUDAY-REC
                     END-IF
                     PERFORM      2201-SYUNOU-COUNT-SEC
                   END-IF
                 END-IF
               END-PERFORM
      *
           END-IF.
      *
           IF     FLG-GENBUTU70   NOT =   ZERO
              IF     FLG-IRYOHI70 =
                      1 OR 3 OR 5 OR 7 OR 8 OR 9 OR 10 OR 11 OR 12
                IF    FLG-TOKU75  =  3
                  IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                    EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF  WK-KOUREI-IRYOHI70  >  421000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 421000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                     WHEN      12
                       IF  WK-KOUREI-IRYOHI70  >  279000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 279000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                    END-EVALUATE
                  ELSE
                       IF  WK-KOUREI-IRYOHI70  >  250000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 250000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                  END-IF
                ELSE
                  IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                    EVALUATE  FLG-GENBUTU70-KBN
                     WHEN      11
                       IF  WK-KOUREI-IRYOHI70  >  842000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 842000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                     WHEN      12
                       IF  WK-KOUREI-IRYOHI70  >  558000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 558000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                    END-EVALUATE
                  ELSE
                       IF  WK-KOUREI-IRYOHI70  >  500000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 500000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                  END-IF
                END-IF
              END-IF
      *
              IF     FLG-IRYOHI70 =  2 OR 4 OR 6
                IF    FLG-TOKU75  =  3
                       IF  WK-KOUREI-IRYOHI70  >  133500
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 133500 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                ELSE
                       IF  WK-KOUREI-IRYOHI70  >  267000
                         COMPUTE WK-KOUREI-IRYOHI70X =
                              (( WK-KOUREI-IRYOHI70  - 267000 ) * 0.01 )
                                                                + 0.5
                         COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                                + WK-KOUREI-IRYOHI70X
                         MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                       END-IF
                END-IF
              END-IF
      *
              EVALUATE   FLG-IRYOHI70K
                WHEN         1
                  IF  WK-KOUREI-IRYOHI70K >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   IF   WK-KOUREI-IRYOHI70K   >  1935690
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                  END-IF
                  IF  FLG-TOKU75  =  3
                  AND WK-KOUREI-IRYOHI70K-TOKU75 >  133500
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K-TOKU75 - 133500 )
                                                        * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M-TOKU75
                                             =   MAX-KIN-KOHI1-M-TOKU75
                                             +   WK-KOUREI-IRYOHI70X
                   IF   WK-KOUREI-IRYOHI70K-TOKU75   >  967890
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K-TOKU75
                   END-IF
                  END-IF
                WHEN         2
                  IF  WK-KOUREI-IRYOHI70K >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   IF   WK-KOUREI-IRYOHI70K   >   860340
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                   END-IF
                  END-IF
                  IF  FLG-TOKU75  =  3
                  AND WK-KOUREI-IRYOHI70K-TOKU75 >  133500
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K-TOKU75 - 133500 )
                                                        * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M-TOKU75
                                             =   MAX-KIN-KOHI1-M-TOKU75
                                             +   WK-KOUREI-IRYOHI70X
                   IF   WK-KOUREI-IRYOHI70K-TOKU75   >  430140
                      MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K-TOKU75
                   END-IF
                  END-IF
                WHEN        11
                  IF  WK-KOUREI-IRYOHI70K >  361500
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 361500 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                  END-IF
                WHEN        12
                  IF  WK-KOUREI-IRYOHI70K >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                  END-IF
                WHEN        13
                  IF  WK-KOUREI-IRYOHI70K >  801000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 801000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                  END-IF
                WHEN        14
                  IF  WK-KOUREI-IRYOHI70K >  2002500
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 2002500) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                  END-IF
                WHEN        21
                  IF  WK-KOUREI-IRYOHI70K >  361500
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 361500 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI2-M  =   MAX-KIN-KOHI2-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                  END-IF
                WHEN        22
                  IF  WK-KOUREI-IRYOHI70K >  267000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI2-M  =   MAX-KIN-KOHI2-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                  END-IF
                WHEN        23
                  IF  WK-KOUREI-IRYOHI70K >  801000
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 801000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI2-M  =   MAX-KIN-KOHI2-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                  END-IF
                WHEN        24
                  IF  WK-KOUREI-IRYOHI70K >  2002500
                   COMPUTE WK-KOUREI-IRYOHI70X =
                        (( WK-KOUREI-IRYOHI70K - 2002500) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI2-M  =   MAX-KIN-KOHI2-M
                                             +   WK-KOUREI-IRYOHI70X
                   MOVE    1    TO    FLG-KOUGAKUCYO-GEN70K
                  END-IF
              END-EVALUATE
      *
              IF  (FLG-IRYOHI70   NOT =  ZERO    )
              OR  (FLG-IRYOHI70K      =  1  OR  2)
                IF    WK-GENGAKUKBN    NOT =  ZERO
                AND   WK-GENGAKUKBN-KEISAN =  ZERO
                     PERFORM   2202-KOHFTN-KINGAKU-GEN2-SEC
                END-IF
              END-IF
           ELSE
            IF    LNK-SYU-SRYYMD(1:6)  >= "200610"
              EVALUATE   FLG-IRYOHI
                WHEN         1
                  IF  WK-KOUREI-IRYOHI  >  267000
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 267000 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO
                  END-IF
                WHEN         2
                  IF    FLG-TOKU75     =   1 OR 2
                   IF  WK-KOUREI-IRYOHI  >  133500
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 133500 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-SYU-M    =   MAX-KIN-SYU-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO
                   END-IF
                  ELSE
                   IF  WK-KOUREI-IRYOHI  >  267000
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 267000 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-SYU-M    =   MAX-KIN-SYU-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO
                   END-IF
                  END-IF
              END-EVALUATE
      *
              EVALUATE   FLG-IRYOHI3
                WHEN         1
                  IF  WK-KOUREI-IRYOHI  >  267000
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 267000 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO3
                  END-IF
                WHEN         2
                WHEN         3
                  IF    FLG-TOKU75     =   1 OR 2
                   IF  WK-KOUREI-IRYOHI  >  133500
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 133500 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-SYU-M    =   MAX-KIN-SYU-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO3
                   END-IF
                  ELSE
                   IF  WK-KOUREI-IRYOHI  >  267000
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 267000 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-SYU-M    =   MAX-KIN-SYU-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO3
                   END-IF
                  END-IF
              END-EVALUATE
      *
              EVALUATE   FLG-IRYOHI2
                WHEN         1
                  IF  FLG-ROJIN41   =   1
                   IF  WK-KOUREI-IRYOHI  >  361500
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 361500 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO2
                   END-IF
                  END-IF
                  IF  FLG-ROJIN41   =   2
                   IF  WK-KOUREI-IRYOHI  >  267000
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 267000 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO2
                   END-IF
                  END-IF
                WHEN         2
                  IF  FLG-ROJIN41   =   1
                   IF  WK-KOUREI-IRYOHI  >  361500
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 361500 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI2-M  =   MAX-KIN-KOHI2-M
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO2
                   END-IF
                  END-IF
                  IF  FLG-ROJIN41   =   2
                   IF  WK-KOUREI-IRYOHI  >  267000
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 267000 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI2-M  =   MAX-KIN-KOHI2-M
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO2
                   END-IF
                  END-IF
              END-EVALUATE
      *
              EVALUATE   FLG-IRYOHI5
                WHEN        11
                  IF  WK-KOUREI-IRYOHI3  >  801000
                    COMPUTE WK-KOUREI-IRYOHI4 =
                         (( WK-KOUREI-IRYOHI3 - 801000 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                              +   WK-KOUREI-IRYOHI4
                    MOVE    1    TO    FLG-KOUGAKUCYO5
                  END-IF
                WHEN        12
                  IF  WK-KOUREI-IRYOHI3  >  2002500
                    COMPUTE WK-KOUREI-IRYOHI4 =
                         (( WK-KOUREI-IRYOHI3 - 2002500) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                              +   WK-KOUREI-IRYOHI4
                    MOVE    1    TO    FLG-KOUGAKUCYO5
                  END-IF
                WHEN        21
                WHEN        22
                  IF  WK-KOUREI-IRYOHI3  >  801000
                    COMPUTE WK-KOUREI-IRYOHI4 =
                         (( WK-KOUREI-IRYOHI3 - 801000 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI2-M  =   MAX-KIN-KOHI2-M 
                                              +   WK-KOUREI-IRYOHI4
                    MOVE    1    TO    FLG-KOUGAKUCYO5
                  END-IF
                WHEN        23
                  IF  WK-KOUREI-IRYOHI3  >  2002500
                    COMPUTE WK-KOUREI-IRYOHI4 =
                         (( WK-KOUREI-IRYOHI3 - 2002500) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI2-M  =   MAX-KIN-KOHI2-M 
                                              +   WK-KOUREI-IRYOHI4
                    MOVE    1    TO    FLG-KOUGAKUCYO5
                  END-IF
              END-EVALUATE
      *
              EVALUATE   FLG-IRYOHI4
                WHEN         1
                  IF  WK-KOUREI-IRYOHI  >  267000
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 267000 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                              +   WK-KOUREI-IRYOHI2
                    IF   WK-KOUREI-IRYOHI   >   860340
                         MOVE    1    TO    FLG-KOUGAKUCYO-JIRITU
                    END-IF
                  END-IF
              END-EVALUATE
      *
              EVALUATE   FLG-IRYOHIKG
                WHEN         1
                  IF   FLG-TOKU75  =  1 OR 2
                    IF   WK-KOUREI-IRYOHI  >  421000
                      COMPUTE WK-KOUREI-IRYOHI2 =
                           (( WK-KOUREI-IRYOHI  - 421000 ) * 0.01 )
                                                           + 0.5
                      COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                             + WK-KOUREI-IRYOHI2
                      MOVE   1   TO   FLG-KOUGAKUCYO
                    END-IF
                  ELSE
                    IF   WK-KOUREI-IRYOHI  >  842000
                      COMPUTE WK-KOUREI-IRYOHI2 =
                           (( WK-KOUREI-IRYOHI  - 842000 ) * 0.01 )
                                                           + 0.5
                      COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                             + WK-KOUREI-IRYOHI2
                      MOVE   1   TO   FLG-KOUGAKUCYO
                    END-IF
                  END-IF
                WHEN         2
                  IF   FLG-TOKU75  =  1 OR 2
                    IF   WK-KOUREI-IRYOHI  >  279000
                      COMPUTE WK-KOUREI-IRYOHI2 =
                           (( WK-KOUREI-IRYOHI  - 279000 ) * 0.01 )
                                                           + 0.5
                      COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                             + WK-KOUREI-IRYOHI2
                      MOVE   1   TO   FLG-KOUGAKUCYO
                    END-IF
                  ELSE
                    IF   WK-KOUREI-IRYOHI  >  558000
                      COMPUTE WK-KOUREI-IRYOHI2 =
                           (( WK-KOUREI-IRYOHI  - 558000 ) * 0.01 )
                                                           + 0.5
                      COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                             + WK-KOUREI-IRYOHI2
                      MOVE   1   TO   FLG-KOUGAKUCYO
                    END-IF
                  END-IF
                WHEN         3
                  IF   FLG-TOKU75  =  1 OR 2
                    IF   WK-KOUREI-IRYOHI  >  133500
                      COMPUTE WK-KOUREI-IRYOHI2 =
                           (( WK-KOUREI-IRYOHI  - 133500 ) * 0.01 )
                                                           + 0.5
                      COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                             + WK-KOUREI-IRYOHI2
                      MOVE   1   TO   FLG-KOUGAKUCYO
                    END-IF
                  ELSE
                    IF   WK-KOUREI-IRYOHI  >  267000
                      COMPUTE WK-KOUREI-IRYOHI2 =
                           (( WK-KOUREI-IRYOHI  - 267000 ) * 0.01 )
                                                           + 0.5
                      COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                             + WK-KOUREI-IRYOHI2
                      MOVE   1   TO   FLG-KOUGAKUCYO
                    END-IF
                  END-IF
              END-EVALUATE
      *
              EVALUATE   FLG-IRYOHIKG2
                WHEN         1
                WHEN         4
                  IF   FLG-TOKU75  =  1 OR 2
                    IF   WK-KOUREI-IRYOHI  >  421000
                      COMPUTE WK-KOUREI-IRYOHI2 =
                           (( WK-KOUREI-IRYOHI  - 421000 ) * 0.01 )
                                                           + 0.5
                      COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                             + WK-KOUREI-IRYOHI2
                      MOVE   1   TO   FLG-KOUGAKUCYO3
                    END-IF
                  ELSE
                    IF   WK-KOUREI-IRYOHI  >  842000
                      COMPUTE WK-KOUREI-IRYOHI2 =
                           (( WK-KOUREI-IRYOHI  - 842000 ) * 0.01 )
                                                           + 0.5
                      COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                             + WK-KOUREI-IRYOHI2
                      MOVE   1   TO   FLG-KOUGAKUCYO3
                    END-IF
                  END-IF
                WHEN         2
                WHEN         5
                  IF   FLG-TOKU75  =  1 OR 2
                    IF   WK-KOUREI-IRYOHI  >  279000
                      COMPUTE WK-KOUREI-IRYOHI2 =
                           (( WK-KOUREI-IRYOHI  - 279000 ) * 0.01 )
                                                           + 0.5
                      COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                             + WK-KOUREI-IRYOHI2
                      MOVE   1   TO   FLG-KOUGAKUCYO3
                    END-IF
                  ELSE
                    IF   WK-KOUREI-IRYOHI  >  558000
                      COMPUTE WK-KOUREI-IRYOHI2 =
                           (( WK-KOUREI-IRYOHI  - 558000 ) * 0.01 )
                                                           + 0.5
                      COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                             + WK-KOUREI-IRYOHI2
                      MOVE   1   TO   FLG-KOUGAKUCYO3
                    END-IF
                  END-IF
                WHEN         3
                WHEN         6
                  IF   FLG-TOKU75  =  1 OR 2
                    IF   WK-KOUREI-IRYOHI  >  133500
                      COMPUTE WK-KOUREI-IRYOHI2 =
                           (( WK-KOUREI-IRYOHI  - 133500 ) * 0.01 )
                                                           + 0.5
                      COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                             + WK-KOUREI-IRYOHI2
                      MOVE   1   TO   FLG-KOUGAKUCYO3
                    END-IF
                  ELSE
                    IF   WK-KOUREI-IRYOHI  >  267000
                      COMPUTE WK-KOUREI-IRYOHI2 =
                           (( WK-KOUREI-IRYOHI  - 267000 ) * 0.01 )
                                                           + 0.5
                      COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                             + WK-KOUREI-IRYOHI2
                      MOVE   1   TO   FLG-KOUGAKUCYO3
                    END-IF
                  END-IF
              END-EVALUATE
      *
              EVALUATE   FLG-IRYOHI-TOYAMA
                WHEN         11
                WHEN         12
                  IF  WK-IRYOHI-TOYAMA  >  267000
                   COMPUTE WK-KOUREI-IRYOHI2 =
                        (( WK-IRYOHI-TOYAMA - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M
                                             +   WK-KOUREI-IRYOHI2
                   IF  ((FLG-IRYOHI-TOYAMA = 11    ) AND
                        (WK-IRYOHI-TOYAMA  > 860340))
                   OR  ((FLG-IRYOHI-TOYAMA = 12    ) AND
                        (WK-IRYOHI-TOYAMA  > 407520))
                       MOVE  1    TO    FLG-KOUGAKUCYO-TOYAMA
                   END-IF
                  END-IF
                WHEN         21
                WHEN         22
                  IF  WK-IRYOHI-TOYAMA  >  267000
                   COMPUTE WK-KOUREI-IRYOHI2 =
                        (( WK-IRYOHI-TOYAMA - 267000 ) * 0.01 ) + 0.5
                   COMPUTE  MAX-KIN-KOHI2-M  =   MAX-KIN-KOHI2-M
                                             +   WK-KOUREI-IRYOHI2
                   IF  ((FLG-IRYOHI-TOYAMA = 21    ) AND
                        (WK-IRYOHI-TOYAMA  > 860340))
                   OR  ((FLG-IRYOHI-TOYAMA = 22    ) AND
                        (WK-IRYOHI-TOYAMA  > 407520))
                       MOVE  1    TO    FLG-KOUGAKUCYO-TOYAMA
                   END-IF
                  END-IF
              END-EVALUATE
            ELSE
              EVALUATE   FLG-IRYOHI
                WHEN         1
                  IF  WK-KOUREI-IRYOHI  >  361500
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 361500 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO
                  END-IF
                WHEN         2
                  IF  WK-KOUREI-IRYOHI  >  361500
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 361500 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-SYU-M    =   MAX-KIN-SYU-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO
                 END-IF
              END-EVALUATE
      *
              EVALUATE   FLG-IRYOHI3
                WHEN         1
                  IF  WK-KOUREI-IRYOHI  >  361500
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 361500 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO3
                  END-IF
                WHEN         2
                  IF  WK-KOUREI-IRYOHI  >  361500
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 361500 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-SYU-M    =   MAX-KIN-SYU-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO3
                  END-IF
              END-EVALUATE
      *
              EVALUATE   FLG-IRYOHI2
                WHEN         1
                  IF  WK-KOUREI-IRYOHI  >  361500
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 361500 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                              +   WK-KOUREI-IRYOHI2
                    MOVE    1    TO    FLG-KOUGAKUCYO2
                  END-IF
              END-EVALUATE
      *
              EVALUATE   FLG-IRYOHI4
                WHEN         1
                  IF  WK-KOUREI-IRYOHI  >  241000
                    COMPUTE WK-KOUREI-IRYOHI2 =
                         (( WK-KOUREI-IRYOHI  - 241000 ) * 0.01 ) + 0.5
                    COMPUTE  MAX-KIN-KOHI1-M  =   MAX-KIN-KOHI1-M 
                                              +   WK-KOUREI-IRYOHI2
                    IF   WK-KOUREI-IRYOHI   >   776540
                         MOVE    1    TO    FLG-KOUGAKUCYO-JIRITU
                    END-IF
                  END-IF
              END-EVALUATE
            END-IF
      *
            IF  (FLG-IRYOHI         =  1 OR 2     )
            OR  (FLG-IRYOHI3        =  1 OR 2 OR 3)
            OR  (FLG-IRYOHI4        =  1          )
            OR  (FLG-IRYOHIKG   NOT =  ZERO       )
            OR  (FLG-IRYOHIKG2  NOT =  ZERO       )
                IF   WK-GENGAKUKBN    NOT =  ZERO
                AND  WK-GENGAKUKBN-KEISAN =  ZERO
                   PERFORM   2202-KOHFTN-KINGAKU-GEN2-SEC
                END-IF
            END-IF
           END-IF.
      *
           IF   (FLG-KOHININBARAI      =    1      )
           AND  (LNK-SYU-SRYYMD(1:6)  >=   "201501")
              EVALUATE   FLG-IRYOHI70
                WHEN        7
                  IF  WK-KOUREI-IRYOHI70  >  842000
                    COMPUTE WK-KOUREI-IRYOHI70X =
                         (( WK-KOUREI-IRYOHI70  - 842000 ) * 0.01 )
                                                           + 0.5
                    COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                           + WK-KOUREI-IRYOHI70X
                    MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                  END-IF
                WHEN        8
                  IF  WK-KOUREI-IRYOHI70  >  558000
                    COMPUTE WK-KOUREI-IRYOHI70X =
                         (( WK-KOUREI-IRYOHI70  - 558000 ) * 0.01 )
                                                           + 0.5
                    COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                           + WK-KOUREI-IRYOHI70X
                    MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                  END-IF
                WHEN        2
                  IF  WK-KOUREI-IRYOHI70  >  267000
                    COMPUTE WK-KOUREI-IRYOHI70X =
                         (( WK-KOUREI-IRYOHI70  - 267000 ) * 0.01 )
                                                           + 0.5
                    COMPUTE  MAX-KIN-SYU-M = MAX-KIN-SYU-M 
                                           + WK-KOUREI-IRYOHI70X
                    MOVE   1   TO   FLG-KOUGAKUCYO-GEN70
                  END-IF
              END-EVALUATE
           END-IF.
      *
           IF    LNK-SYU-SRYYMD(1:6)   >=  "202001"
             IF    WK-CYOKI-RESULT  =  1
               IF    WK-2010-CYOKI-FTNKBN  =  "1"
                 IF  (COMB-KOH1HKNNUM    =  "972" OR "974")
                 AND (COMB-KOH2HKNNUM    =  SPACE         )
                 AND (COMB-KOH3HKNNUM    =  SPACE         )
                 AND (COMB-KOH4HKNNUM    =  SPACE         )
                   IF  WK-CYOKI-SYUMAXKIN <  WK-CYOKI-KEISAN4
                   AND WK-CYOKI-SYUMAXKIN NOT = ZERO
                     ADD  WK-CYOKI-FTN-SYU-M  TO  FTN-SYU-M
                     ADD  WK-CYOKI-FTN-SYU-M-ENTANI
                                              TO  FTN-SYU-M-ENTANI
                     MOVE   2    TO   LNK-SYU-SECMONEY
                   END-IF
                 ELSE
                   MOVE     3    TO   LNK-SYU-SECMONEY
                 END-IF
               ELSE
                 MOVE       1    TO   LNK-SYU-SECMONEY
               END-IF
             END-IF
           END-IF.
      *
       220-SYUNOU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¿ÇÎÅ·î¤Î¼ýÇ¼¥Þ¥¹¥¿¤«¤é¸øÈñ¤Î¶â³Û¥«¥¦¥ó¥È
      ******************************************************************
       2201-SYUNOU-COUNT-SEC          SECTION.
      *
      *    ¼ýÇ¼ÊÝ¸±¾ðÊóÊÔ½¸
           MOVE     1     TO   FLG-GENBUTU-CHECK.
           MOVE     ZERO  TO   FLG-GENBUTU-CHECK-ERR.
           PERFORM  22017-SYUNOU-HKN-HENSYU-SEC.
           IF   FLG-SYUNOU-HKN-HANTEI  =  1
             GO   TO   2201-SYUNOU-COUNT-EXT
           END-IF.
      *
      *    ¸øÈñ£É£ÄÊÔ½¸
           PERFORM  22014-KOHID-HENSYU-SEC.
      *
           IF  (( WK-1001-PREFNUM     =  44            ) AND
                ( LNK-SYU-SRYYMD(1:6) >= "200610"      ) AND
                ( LNK-SYU-SRYYMD(1:6) <  "201010"      ) AND
                ((LNK-SYU-KOH1HKNNUM  = "183" OR "283") OR
                 (LNK-SYU-KOH2HKNNUM  = "183" OR "283") OR
                 (LNK-SYU-KOH3HKNNUM  = "183" OR "283") OR
                 (LNK-SYU-KOH4HKNNUM  = "183" OR "283")) AND
                ((SYU-KOH1HKNNUM      = "183" OR "283") OR
                 (SYU-KOH2HKNNUM      = "183" OR "283") OR
                 (SYU-KOH3HKNNUM      = "183" OR "283") OR
                 (SYU-KOH4HKNNUM      = "183" OR "283")))
           OR  (((WK-2010-NINNASIKBN(1)   NOT = SPACE ) OR
                 (WK-2010-NINJYOKBN(1)    NOT = SPACE ) OR
                 (WK-2010-NINNASIKBN-K(1) NOT = SPACE )) AND
                ( LNK-SYU-KOH1HKNNUM  = SYU-KOH1HKNNUM
                                     OR SYU-KOH2HKNNUM
                                     OR SYU-KOH3HKNNUM
                                     OR SYU-KOH4HKNNUM ))
           OR  (((WK-2010-NINNASIKBN(2)   NOT = SPACE ) OR
                 (WK-2010-NINJYOKBN(2)    NOT = SPACE ) OR
                 (WK-2010-NINNASIKBN-K(2) NOT = SPACE )) AND
                ( LNK-SYU-KOH2HKNNUM  = SYU-KOH1HKNNUM
                                     OR SYU-KOH2HKNNUM
                                     OR SYU-KOH3HKNNUM
                                     OR SYU-KOH4HKNNUM ))
           OR  (((WK-2010-NINNASIKBN(3)   NOT = SPACE ) OR
                 (WK-2010-NINJYOKBN(3)    NOT = SPACE ) OR
                 (WK-2010-NINNASIKBN-K(3) NOT = SPACE )) AND
                ( LNK-SYU-KOH3HKNNUM  = SYU-KOH1HKNNUM
                                     OR SYU-KOH2HKNNUM
                                     OR SYU-KOH3HKNNUM
                                     OR SYU-KOH4HKNNUM ))
           OR  (((WK-2010-NINNASIKBN(4)   NOT = SPACE ) OR
                 (WK-2010-NINJYOKBN(4)    NOT = SPACE ) OR
                 (WK-2010-NINNASIKBN-K(4) NOT = SPACE )) AND
                ( LNK-SYU-KOH4HKNNUM  = SYU-KOH1HKNNUM
                                     OR SYU-KOH2HKNNUM
                                     OR SYU-KOH3HKNNUM
                                     OR SYU-KOH4HKNNUM ))
             IF   SYU-NYUGAIKBN   =  "1"
               COMPUTE  SYU-KOH-FTN         =  SYU-KOH-FTN
                                            -  SYU-JYO-COMPFTN
               COMPUTE  SYU-KOH-FTN-ENTANI  =  SYU-KOH-FTN-ENTANI
                                            -  SYU-JYO-COMPFTN
             END-IF
           END-IF.
      *
           IF   ((WK-2010-SYOKEI2KBN-N(1) = "1"        ) AND
                 (LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                                     OR  SYU-KOH2HKNNUM
                                     OR  SYU-KOH3HKNNUM
                                     OR  SYU-KOH4HKNNUM))
           OR   ((WK-2010-SYOKEI2KBN-N(2) = "1"        ) AND
                 (LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                                     OR  SYU-KOH2HKNNUM
                                     OR  SYU-KOH3HKNNUM
                                     OR  SYU-KOH4HKNNUM))
           OR   ((WK-2010-SYOKEI2KBN-N(3) = "1"        ) AND
                 (LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                                     OR  SYU-KOH2HKNNUM
                                     OR  SYU-KOH3HKNNUM
                                     OR  SYU-KOH4HKNNUM))
           OR   ((WK-2010-SYOKEI2KBN-N(4) = "1"        ) AND
                 (LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                                     OR  SYU-KOH2HKNNUM
                                     OR  SYU-KOH3HKNNUM
                                     OR  SYU-KOH4HKNNUM))
             IF   SYU-NYUGAIKBN   =  "1"
               COMPUTE  SYU-KOH-FTN         =  SYU-KOH-FTN
                                            +  SYU-JYO-COMPFTN
               COMPUTE  SYU-KOH-FTN-ENTANI  =  SYU-KOH-FTN-ENTANI
                                            +  SYU-JYO-COMPFTN-ENTANI
             END-IF
           END-IF.
      *
           IF  (WK-1001-PREFNUM          =  43      ) AND
               (LNK-SYU-SRYYMD(1:6)     >= "200912" )
             IF   SYU-NYUGAIKBN   =  "1"
              IF  ((LNK-SYU-KOH1HKNNUM  = "143" OR "342") OR
                   (LNK-SYU-KOH2HKNNUM  = "143" OR "342") OR
                   (LNK-SYU-KOH3HKNNUM  = "143" OR "342") OR
                   (LNK-SYU-KOH4HKNNUM  = "143" OR "342"))
              AND ((SYU-KOH1HKNNUM      = "143" OR "342") OR
                   (SYU-KOH2HKNNUM      = "143" OR "342") OR
                   (SYU-KOH3HKNNUM      = "143" OR "342") OR
                   (SYU-KOH4HKNNUM      = "143" OR "342"))
                 COMPUTE  WK-KUMAMOTO-HANTEIKIN  =
                          WK-KUMAMOTO-HANTEIKIN  +  SYU-JYO-HKNFTNMONEY
              END-IF
             END-IF
           END-IF.
      *
           IF   (WK-1001-PREFNUM       =  35 OR 34)
           AND  (LNK-SYU-SRYYMD(1:6)  >= "201309" )
             IF  ((LNK-SYU-KOH1HKNNUM  = "781") OR
                  (LNK-SYU-KOH2HKNNUM  = "781") OR
                  (LNK-SYU-KOH3HKNNUM  = "781") OR
                  (LNK-SYU-KOH4HKNNUM  = "781"))
             AND ((SYU-KOH1HKNNUM      = "781") OR
                  (SYU-KOH2HKNNUM      = "781") OR
                  (SYU-KOH3HKNNUM      = "781") OR
                  (SYU-KOH4HKNNUM      = "781"))
               IF   (SYU-NYUGAIKBN          =  "1"    )
               AND  (SYU-JYO-HKNFTNMONEY    =  9999999)
                 COMPUTE   SYU-KOH-FTN         =  SYU-JYO-COMPFTN
                 COMPUTE   SYU-KOH-FTN-ENTANI  =  SYU-JYO-COMPFTN-ENTANI
      *
                 ADD   SYU-JYO-COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI
                 IF    SYU-KOH1HKNNUM  = "781"
                   ADD SYU-KOH1HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH1COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
                 IF    SYU-KOH2HKNNUM  = "781"
                   ADD SYU-KOH2HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH2COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
                 IF    SYU-KOH3HKNNUM  = "781"
                   ADD SYU-KOH3HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH3COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
                 IF    SYU-KOH4HKNNUM  = "781"
                   ADD SYU-KOH4HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH4COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
               END-IF
             END-IF
           END-IF.
      *
           IF   (WK-1001-PREFNUM       =  23     )
           AND  (LNK-SYU-SRYYMD(1:6)  >= "201504")
             IF  ((LNK-SYU-KOH1HKNNUM  = "781" OR "271") OR
                  (LNK-SYU-KOH2HKNNUM  = "781" OR "271") OR
                  (LNK-SYU-KOH3HKNNUM  = "781" OR "271") OR
                  (LNK-SYU-KOH4HKNNUM  = "781" OR "271"))
             AND ((SYU-KOH1HKNNUM      = "781" OR "271") OR
                  (SYU-KOH2HKNNUM      = "781" OR "271") OR
                  (SYU-KOH3HKNNUM      = "781" OR "271") OR
                  (SYU-KOH4HKNNUM      = "781" OR "271"))
               IF   (SYU-NYUGAIKBN          =  "1"    )
               AND  (SYU-JYO-HKNFTNMONEY    =  9999999)
                 COMPUTE   SYU-KOH-FTN         =  SYU-JYO-COMPFTN
                 COMPUTE   SYU-KOH-FTN-ENTANI  =  SYU-JYO-COMPFTN-ENTANI
      *
                 ADD   SYU-JYO-COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI
                 IF    SYU-KOH1HKNNUM  = "781" OR "271"
                   ADD SYU-KOH1HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH1COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
                 IF    SYU-KOH2HKNNUM  = "781" OR "271"
                   ADD SYU-KOH2HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH2COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
                 IF    SYU-KOH3HKNNUM  = "781" OR "271"
                   ADD SYU-KOH3HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH3COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
                 IF    SYU-KOH4HKNNUM  = "781" OR "271"
                   ADD SYU-KOH4HKNFTNMONEY    TO WK-JYOSEI-KOHIKIN-RUI3
                   ADD SYU-KOH4COMPFTN-ENTANI TO WK-JYOSEI-KOHIKIN-RUI2
                 END-IF
               END-IF
             END-IF
           END-IF.
      *
           MOVE     ZERO     TO     FLG-KOUREI.                         
           MOVE     ZERO     TO     FLG-SYUKEI.
           MOVE     ZERO     TO     FLG-SYUKEI3.
           MOVE     ZERO     TO     FLG-TAISYO.
      *
           IF  SYU-NYUGAIKBN  =  "1"
             IF ( LNK-S02-KOUREI-NYUIN-KBN   =   "1" )
             OR ( FLG-KOHININBARAI           =    1  )
             OR ( FLG-GENBUTU70          NOT =   ZERO)
             OR ( FLG-TOKU75-CYO             =    3  )
             OR ( FLG-CYOKI-ARI              =    2  )
      *
              IF  LNK-SYU-YKZKENNUM  =  SYU-YKZKENNUM
      *
               IF ( SYU-SYUHKNNUM       =  "971" OR "973" OR "975"
                                        OR "068" OR "069" OR "040" )
               OR ( SYU-SYUHKNNUM(1:2)  =  "98"  OR "90"  OR "91"  )
               OR ((SYU-KOH1HKNNUM           =  "970"             ) AND
                   (SYU-SKJ-FTNGAKU(2)       =   ZERO             ))
               OR ((COMB-KOH1HKNNUM     NOT  =  "970"             ) AND
                   (SYU-KOH1HKNNUM           =  "970"             ) AND
                   (SYU-SKJ-FTNGAKU(2)  NOT  =   ZERO             ) AND
                   (SYU-PTFTNRATE            =   ZERO             ) AND
                   (LNK-S02-DAISANYUSENFLG   =   SPACE            ))
      *
                 CONTINUE
      *
               ELSE
      *
                 IF COMB-KOH1HKNNUM      =    "027"                     
      ***
                      IF    SYU-KOH1HKNNUM         = "027"
                       IF  (SYU-KOH2HKNNUM     NOT = SPACE)              
                       OR  (SYU-KOH3HKNNUM     NOT = SPACE)
                       OR  (SYU-KOH4HKNNUM     NOT = SPACE)
                        MOVE     SYU-KOH-FTN  TO  WK-SYU-SYUCOMPFTN
                        MOVE     SYU-KOH-FTN-ENTANI  TO  WK-ENTANI
                        PERFORM  22018-ENTANI-HENSYU-SEC
                       ELSE
                        MOVE     SYU-KOH1COMPFTN
                                              TO  WK-SYU-SYUCOMPFTN
                        MOVE     SYU-KOH1COMPFTN-ENTANI  TO  WK-ENTANI
                        PERFORM  22018-ENTANI-HENSYU-SEC
                       END-IF
                       ADD   WK-SYU-SYUCOMPFTN     TO   FTN-KOHI1-M      
                       ADD   WK-ENTANI       TO   FTN-KOHI1-M-ENTANI
                       IF  ( COMB-KOH2HKNNUM        =    SPACE)
                       AND ( COMB-KOH3HKNNUM        =    SPACE)
                       AND ( COMB-KOH4HKNNUM        =    SPACE)
                       AND ( SYU-KOH2HKNNUM         =    SPACE)
                       AND ( SYU-KOH3HKNNUM         =    SPACE)
                       AND ( SYU-KOH4HKNNUM         =    SPACE)
                       AND ( FLG-IRYOHI         NOT =    ZERO )
                          COMPUTE   WK-KOUREI-IRYOHI  =   
                                    WK-KOUREI-IRYOHI  +  
                                   (SYU-HKNTEN (17) * 10)
                       END-IF
      *
                       MOVE  1                     TO   FLG-KOUREI       
                      END-IF
                 ELSE                                                   
                    PERFORM  2201A-CYOKI-HANTEI-SEC
      ***
                    IF   (SYU-SYUHKNNUM      NOT = SPACE)
                    AND  (COMB-HKNNUM        NOT = SPACE)
                     IF  LNK-S02-KOUREI-NYUIN-KBN   =   "1"
                       PERFORM   22012-KOUREI-SYU-HENSYU-SEC
                     END-IF
                     IF   FLG-KOHININBARAI     =    1
                       IF  (SYU-KOH1HKNNUM     =  SPACE)
                       AND (SYU-KOH2HKNNUM     =  SPACE)
                       AND (SYU-KOH3HKNNUM     =  SPACE)
                       AND (SYU-KOH4HKNNUM     =  SPACE)
                        IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                          MOVE     SYU-SYUCOMPFTN
                                            TO   WK-SYU-SYUCOMPFTN
                          MOVE     SYU-SYUCOMPFTN-ENTANI  TO  WK-ENTANI
                          PERFORM  22018-ENTANI-HENSYU-SEC
                          ADD   WK-SYU-SYUCOMPFTN  TO  FTN-SYU-M
                          ADD   WK-ENTANI          TO  FTN-SYU-M-ENTANI
                          IF   (FLG-IRYOHI70  =  2 OR 7 OR 8      )
                          AND  (LNK-SYU-SRYYMD(1:6)  >=   "201501")
                            COMPUTE   WK-KOUREI-IRYOHI70  =
                                      WK-KOUREI-IRYOHI70  +
                                     (SYU-HKNTEN (17) * 10)
                          END-IF
                        END-IF
                       END-IF
                     END-IF
                     IF  FLG-GENBUTU70    NOT =  ZERO
                       PERFORM   22011-GEN70-SYU-HENSYU-SEC
                     END-IF
                     IF  FLG-TOKU75-CYO = 3
                       PERFORM   22015-TOKU75-CYO-HENSYU-SEC
                     END-IF
                     IF  FLG-CYOKI-ARI  = 2
                       PERFORM   22016-CYOKI-ARI-HENSYU-SEC
                     END-IF
                    END-IF
                 END-IF                                                 
      *
               END-IF
      *
              END-IF
      *
             END-IF
      *
             IF      LNK-SYU-KOH1HKNNUM  = "972" OR "974"
                IF ((SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
                OR ((SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
                OR ((SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
                OR ((SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                   PERFORM   22013-CYOKI-FTN-HENSYU-SEC
                END-IF
             END-IF
             IF      LNK-SYU-KOH2HKNNUM  = "972" OR "974"
                IF ((SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH2ID         =  WRK-COMB-KOH1ID))
                OR ((SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH2ID         =  WRK-COMB-KOH2ID))
                OR ((SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH2ID         =  WRK-COMB-KOH3ID))
                OR ((SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH2ID         =  WRK-COMB-KOH4ID))
                   PERFORM   22013-CYOKI-FTN-HENSYU-SEC
                END-IF
             END-IF
             IF      LNK-SYU-KOH3HKNNUM  = "972" OR "974"
                IF ((SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH3ID         =  WRK-COMB-KOH1ID))
                OR ((SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH3ID         =  WRK-COMB-KOH2ID))
                OR ((SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH3ID         =  WRK-COMB-KOH3ID))
                OR ((SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH3ID         =  WRK-COMB-KOH4ID))
                   PERFORM   22013-CYOKI-FTN-HENSYU-SEC
                END-IF
             END-IF
             IF      LNK-SYU-KOH4HKNNUM  = "972" OR "974"
                IF ((SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH4ID         =  WRK-COMB-KOH1ID))
                OR ((SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH4ID         =  WRK-COMB-KOH2ID))
                OR ((SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH4ID         =  WRK-COMB-KOH3ID))
                OR ((SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                    (COMB-KOH4ID         =  WRK-COMB-KOH4ID))
                   PERFORM   22013-CYOKI-FTN-HENSYU-SEC
                END-IF
             END-IF
      *
             IF (FLG-GENBUTU70          NOT =   ZERO)
             OR (FLG-TOKU75-CYO             =    3  )
             OR (FLG-CYOKI-ARI              =    2  )
               IF    FLG-MARUKO  =  2
                 IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
                 OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
                 OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
                 OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                   IF   LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                     COMPUTE   WK-MARUKO-XX    =
                               SYU-KOH1COMPFTN +  5
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    /  10
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    *  10
                     ADD  WK-MARUKO-XX            TO  WK-MARUKO-M
                     ADD  SYU-KOH1COMPFTN-ENTANI  TO  WK-MARUKO-ME
                     COMPUTE   WK-MARUKO-KIN   =
                               WK-MARUKO-KIN   +
                              (SYU-HKNTEN (17) * 10)
                   END-IF
                   IF   LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM
                     COMPUTE   WK-MARUKO-XX    =
                               SYU-KOH2COMPFTN +  5
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    /  10
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    *  10
                     ADD  WK-MARUKO-XX            TO  WK-MARUKO-M
                     ADD  SYU-KOH2COMPFTN-ENTANI  TO  WK-MARUKO-ME
                     COMPUTE   WK-MARUKO-KIN   =
                               WK-MARUKO-KIN   +
                              (SYU-HKNTEN (17) * 10)
                   END-IF
                   IF   LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM
                     COMPUTE   WK-MARUKO-XX    =
                               SYU-KOH3COMPFTN +  5
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    /  10
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    *  10
                     ADD  WK-MARUKO-XX            TO  WK-MARUKO-M
                     ADD  SYU-KOH3COMPFTN-ENTANI  TO  WK-MARUKO-ME
                     COMPUTE   WK-MARUKO-KIN   =
                               WK-MARUKO-KIN   +
                              (SYU-HKNTEN (17) * 10)
                   END-IF
                   IF   LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM
                     COMPUTE   WK-MARUKO-XX    =
                               SYU-KOH4COMPFTN +  5
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    /  10
                     COMPUTE   WK-MARUKO-XX    =
                               WK-MARUKO-XX    *  10
                     ADD  WK-MARUKO-XX            TO  WK-MARUKO-M
                     ADD  SYU-KOH4COMPFTN-ENTANI  TO  WK-MARUKO-ME
                     COMPUTE   WK-MARUKO-KIN   =
                               WK-MARUKO-KIN   +
                              (SYU-HKNTEN (17) * 10)
                   END-IF
                 END-IF
               END-IF
             END-IF
      *
             IF   (LNK-SYU-YKZKENNUM  =  SYU-YKZKENNUM  )
             AND  (SYU-YKZKENNUM      =  2 OR 5         )
             AND  (WK-HKNJANUM4-TBL   =  WK-HKNJANUM-TBL)
                 ADD     1                 TO  IDX14
                 IF   IDX14 <= 100
                   MOVE  SYU-TOTAL-HKNTEN  TO  WK-GENGAKU-TEN(IDX14)
                   IF    SYU-YKZKENNUM  =   5
                     IF   (SYU-SYUHKNNUM   NOT =  SPACE)
                     AND  (SYU-KOH1HKNNUM      =  SPACE)
                     AND  (SYU-KOH2HKNNUM      =  SPACE)
                     AND  (SYU-KOH3HKNNUM      =  SPACE)
                     AND  (SYU-KOH4HKNNUM      =  SPACE)
                       MOVE  SYU-SYUCOMPFTN
                                   TO  WK-GENGAKU-FTN(IDX14)
                       MOVE  SYU-SYUCOMPFTN-ENTANI
                                   TO  WK-GENGAKU-FTN-ENTANI(IDX14)
                     ELSE
                       MOVE  SYU-KOH-FTN
                                   TO  WK-GENGAKU-FTN(IDX14)
                       MOVE  SYU-KOH-FTN-ENTANI
                                   TO  WK-GENGAKU-FTN-ENTANI(IDX14)
                     END-IF
                   END-IF
                 END-IF
             END-IF
      *
           END-IF.
      *
      *    ¸øÈñ£±¥«¥¦¥ó¥È
           IF ((COMB-KOH1HKNNUM          NOT =   SPACE) AND
               (COMB-KOH1-NYUJGNKBN          =   "1"  ) AND
               (FLG-KOUREI                   =   ZERO ))
           OR ( WK-2010-IRYOKEIKBN-N(1)   = "3" OR "4" )
           OR ((FLG-IRYOHI70    =  3 OR  4 OR  5 OR  6
                                OR 9 OR 10 OR 11 OR 12) AND
               (COMB-KOH1HKNNUM          NOT =   SPACE))
           OR ((FLG-IRYOHI3               =  2 OR 3   ) AND
               (COMB-KOH1HKNNUM          NOT =   SPACE))
           OR ( FLG-OITA-SYUKEI           =   1        )
           OR ((FLG-IRYOHIKG2            NOT =   ZERO ) AND
               (COMB-KOH1HKNNUM          NOT =   SPACE))
             IF  ( SYU-NYUGAIKBN              =   "1"   )
             OR  ((SYU-NYUGAIKBN              =   "2"  ) AND
                  (FLG-NYUGAI                 =    1   ))
             OR  ((SYU-NYUGAIKBN              =   "2"  ) AND
                  (FLG-NYUGAI2                =    1   ))
               IF   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
      *
                IF   SYU-NYUGAIKBN  =   "1"
                 IF  FLG-GENBUTU70    NOT =  ZERO
                  IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                    IF   FLG-IRYOHI70  =  3 OR  4 OR  5 OR  6
                                       OR 9 OR 10 OR 11 OR 12
                     IF  FLG-SYUKEI  =  ZERO
                       IF  ((COMB-KOH1HKNNUM  =  "092"   ) AND
                            (WK-KOHJGNGET-CHECK092(1) = 1))
                       OR  ((SYU-KOH1HKNNUM   =  "092"   ) AND
                            (SYU-NYNSHOKAISU  =   7      ))
                         CONTINUE
                       ELSE
                         COMPUTE  WK-KOUREI-IRYOHI70  =
                                  WK-KOUREI-IRYOHI70  +
                                 (SYU-HKNTEN (17) * 10)
                         MOVE     1    TO      FLG-SYUKEI
                       END-IF
                     END-IF
                     IF  (SYU-KOH2HKNNUM   = "972" OR "974")
                     OR  (SYU-KOH3HKNNUM   = "972" OR "974")
                     OR  (SYU-KOH4HKNNUM   = "972" OR "974")
                        MOVE    1    TO      FLG-SYUKEI2
                        COMPUTE  WK-KOUREI-IRYOHI70-JYOGAI2 =
                                 WK-KOUREI-IRYOHI70-JYOGAI2 +
                                (SYU-HKNTEN (17) * 10)
                     ELSE
                      IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                          (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
                      OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                          (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
                      OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                          (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                        MOVE    1    TO      FLG-SYUKEI2
                        COMPUTE  WK-KOUREI-IRYOHI70-JYOGAI =
                                 WK-KOUREI-IRYOHI70-JYOGAI +
                                (SYU-HKNTEN (17) * 10)
                      END-IF
                     END-IF
                    ELSE
                     IF    FLG-OITA-SYUKEI  =   1
                       COMPUTE  WK-KOUREI-IRYOHI70  =
                                WK-KOUREI-IRYOHI70  +
                               (SYU-HKNTEN (17) * 10)
                       IF  (SYU-KOH2HKNNUM   = "972" OR "974")
                       OR  (SYU-KOH3HKNNUM   = "972" OR "974")
                       OR  (SYU-KOH4HKNNUM   = "972" OR "974")
                         MOVE    1    TO      FLG-SYUKEI2
                         COMPUTE  WK-KOUREI-IRYOHI70-JYOGAI2 =
                                  WK-KOUREI-IRYOHI70-JYOGAI2 +
                                 (SYU-HKNTEN (17) * 10)
                       ELSE
                        IF ((LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM ) AND
                            (COMB-KOH1ID        = WRK-COMB-KOH2ID))
                        OR ((LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM ) AND
                            (COMB-KOH1ID        = WRK-COMB-KOH3ID))
                        OR ((LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM ) AND
                            (COMB-KOH1ID        = WRK-COMB-KOH4ID))
                         MOVE    1    TO      FLG-SYUKEI2
                         COMPUTE  WK-KOUREI-IRYOHI70-JYOGAI =
                                  WK-KOUREI-IRYOHI70-JYOGAI +
                                 (SYU-HKNTEN (17) * 10)
                        END-IF
                       END-IF
                     END-IF
                    END-IF
                  END-IF
                  IF  (FLG-SYUKEI3   =  ZERO              )
                  AND (FLG-IRYOHI70K =  1 OR 2 OR 11 OR 12
                                               OR 13 OR 14)
                    COMPUTE  WK-KOUREI-IRYOHI70K =
                             WK-KOUREI-IRYOHI70K +
                            (SYU-HKNTEN (17) * 10)
                    IF   FLG-RUITAISYO  =  1
                       COMPUTE  WK-KOUREI-IRYOHI70K-TOKU75 =
                                WK-KOUREI-IRYOHI70K-TOKU75 +
                               (SYU-HKNTEN (17) * 10)
                    END-IF
                    MOVE     1    TO      FLG-SYUKEI3
                  END-IF
                 ELSE
                  IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                    IF  (FLG-IRYOHI3        =  2 OR 3)
                    OR  (FLG-IRYOHIKG2  NOT =  ZERO  )
                     IF  FLG-SYUKEI  =  ZERO
                       IF  ((COMB-KOH1HKNNUM  =  "092"   ) AND
                            (WK-KOHJGNGET-CHECK092(1) = 1))
                       OR  ((SYU-KOH1HKNNUM   =  "092"   ) AND
                            (SYU-NYNSHOKAISU  =   7      ))
                         CONTINUE
                       ELSE
                        IF   FLG-IRYOHIKG2 = 1 OR 2 OR 3
                         IF  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM )
                         AND (COMB-KOH1ID        = WRK-COMB-KOH1ID)
                          COMPUTE WK-KOUREI-IRYOHI  =
                                  WK-KOUREI-IRYOHI  +
                                 (SYU-HKNTEN (17) * 10)
                          MOVE    1    TO      FLG-SYUKEI
                          IF  (SYU-KOH2HKNNUM   = "972" OR "974")
                          OR  (SYU-KOH3HKNNUM   = "972" OR "974")
                          OR  (SYU-KOH4HKNNUM   = "972" OR "974")
                            MOVE  1    TO      FLG-SYUKEI2
                            COMPUTE  WK-KOUREI-IRYOHI-JYOGAI2 =
                                     WK-KOUREI-IRYOHI-JYOGAI2 +
                                    (SYU-HKNTEN (17) * 10)
                          END-IF
                         END-IF
                        ELSE
                         COMPUTE  WK-KOUREI-IRYOHI  =
                                  WK-KOUREI-IRYOHI  +
                                 (SYU-HKNTEN (17) * 10)
                         MOVE     1    TO      FLG-SYUKEI
                        END-IF
                       END-IF
                     END-IF
                    ELSE
                     IF    FLG-OITA-SYUKEI  =   1
                       IF  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM )
                       AND (COMB-KOH1ID        = WRK-COMB-KOH1ID)
                        COMPUTE  WK-KOUREI-IRYOHI  =
                                 WK-KOUREI-IRYOHI  +
                                (SYU-HKNTEN (17) * 10)
                        IF  (SYU-KOH2HKNNUM   = "972" OR "974")
                        OR  (SYU-KOH3HKNNUM   = "972" OR "974")
                        OR  (SYU-KOH4HKNNUM   = "972" OR "974")
                          MOVE  1    TO      FLG-SYUKEI2
                          COMPUTE  WK-KOUREI-IRYOHI-JYOGAI2 =
                                   WK-KOUREI-IRYOHI-JYOGAI2 +
                                  (SYU-HKNTEN (17) * 10)
                        END-IF
                       END-IF
                     END-IF
                    END-IF
                    IF  FLG-IRYOHI-TOYAMA  =  11 OR 12
                          COMPUTE  WK-IRYOHI-TOYAMA  =
                                   WK-IRYOHI-TOYAMA  +
                                  (SYU-HKNTEN (17) * 10)
                    END-IF
                  END-IF
                  IF    (FLG-IRYOHI2  =  1)
                  OR    (FLG-IRYOHI4  =  1)
                       COMPUTE  WK-KOUREI-IRYOHI  =
                                WK-KOUREI-IRYOHI  +
                               (SYU-HKNTEN (17) * 10)
                  END-IF
                  IF     FLG-IRYOHI5  =  11 OR 12
                       COMPUTE  WK-KOUREI-IRYOHI3  =
                                WK-KOUREI-IRYOHI3  +
                               (SYU-HKNTEN (17) * 10)
                  END-IF
                 END-IF
                END-IF
      *
                 IF   WK-2010-IRYOKEIKBN-N(1)  NOT = SPACE
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                         IF   FLG-GEN70-TOKUSYU  =  1
                         AND  FLG-TAISYO =  ZERO
                           COMPUTE  WK-KEISAN           =
                                    SYU-JYO-HKNFTNMONEY -
                                    SYU-KOH1HKNFTNMONEY
                           ADD      WK-KEISAN   TO   FTN-SYU-M
                           MOVE     SYU-JYO-COMPFTN-ENTANI
                                           TO   WK-TOKUSYU-KEISAN-EN1
                           MOVE     SYU-KOH1COMPFTN-ENTANI
                                           TO   WK-TOKUSYU-KEISAN-EN2
                           PERFORM  22019-ENTANI-HENSYU2-SEC
                           ADD      WK-TOKUSYU-KEISAN-EN3
                                           TO   FTN-SYU-M-ENTANI
                         END-IF
                         EVALUATE   WK-2010-IRYOKEIKBN-N(1)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH1HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH1COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH1COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(1)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM
                         IF   FLG-GEN70-TOKUSYU  =  1
                         AND  FLG-TAISYO =  ZERO
                           COMPUTE  WK-KEISAN           =
                                    SYU-JYO-HKNFTNMONEY -
                                    SYU-KOH2HKNFTNMONEY
                           ADD      WK-KEISAN   TO   FTN-SYU-M
                           MOVE     SYU-JYO-COMPFTN-ENTANI
                                           TO   WK-TOKUSYU-KEISAN-EN1
                           MOVE     SYU-KOH2COMPFTN-ENTANI
                                           TO   WK-TOKUSYU-KEISAN-EN2
                           PERFORM  22019-ENTANI-HENSYU2-SEC
                           ADD      WK-TOKUSYU-KEISAN-EN3
                                           TO   FTN-SYU-M-ENTANI
                         END-IF
                         EVALUATE   WK-2010-IRYOKEIKBN-N(1)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH2HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH2COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH2COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(1)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM
                         IF   FLG-GEN70-TOKUSYU  =  1
                         AND  FLG-TAISYO =  ZERO
                           COMPUTE  WK-KEISAN           =
                                    SYU-JYO-HKNFTNMONEY -
                                    SYU-KOH3HKNFTNMONEY
                           ADD      WK-KEISAN   TO   FTN-SYU-M
                           MOVE     SYU-JYO-COMPFTN-ENTANI
                                           TO   WK-TOKUSYU-KEISAN-EN1
                           MOVE     SYU-KOH3COMPFTN-ENTANI
                                           TO   WK-TOKUSYU-KEISAN-EN2
                           PERFORM  22019-ENTANI-HENSYU2-SEC
                           ADD      WK-TOKUSYU-KEISAN-EN3
                                           TO   FTN-SYU-M-ENTANI
                         END-IF
                         EVALUATE   WK-2010-IRYOKEIKBN-N(1)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH3HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH3COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH3COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(1)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM
                         IF   FLG-GEN70-TOKUSYU  =  1
                         AND  FLG-TAISYO =  ZERO
                           COMPUTE  WK-KEISAN           =
                                    SYU-JYO-HKNFTNMONEY -
                                    SYU-KOH4HKNFTNMONEY
                           ADD      WK-KEISAN   TO   FTN-SYU-M
                           MOVE     SYU-JYO-COMPFTN-ENTANI
                                           TO   WK-TOKUSYU-KEISAN-EN1
                           MOVE     SYU-KOH4COMPFTN-ENTANI
                                           TO   WK-TOKUSYU-KEISAN-EN2
                           PERFORM  22019-ENTANI-HENSYU2-SEC
                           ADD      WK-TOKUSYU-KEISAN-EN3
                                           TO   FTN-SYU-M-ENTANI
                         END-IF
                         EVALUATE   WK-2010-IRYOKEIKBN-N(1)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH4HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH4COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH4COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(1)
                         END-EVALUATE
                      END-IF
                      IF   WK-2010-IRYOKEIKBN-N(1) = "2"
                         COMPUTE   WK-IRYOKEIKBN-HANTEITEN  =
                                   WK-IRYOKEIKBN-HANTEITEN  +
                                   SYU-TOTAL-HKNTEN
                      END-IF
                 END-IF
      *
                 IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                      MOVE  SYU-KOH1HKNFTNMONEY
                                      TO  WK-RUI-TAIHI-HKNFTNMONEY
                      MOVE  SYU-KOH1COMPFTN
                                      TO  WK-RUI-TAIHI-COMPFTN
                      MOVE  SYU-KOH1COMPFTN-ENTANI
                                      TO  WK-RUI-TAIHI-COMPFTN-ENTANI
                 END-IF
      *
                 IF   WK-2010-KINJYOKBN-N(1)  = "1"
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH1HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH1HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-SYU-M
                          COMPUTE  FTN-SYU-M = FTN-SYU-M
                                             - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH1COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH1COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH1COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH1COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU-KEISAN-EN1
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD   WK-TOKUSYU-KEISAN-EN1
                                            TO  FTN-SYU-M-ENTANI
                          MOVE  SYU-KOH-FTN-ENTANI
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 IF    @@@
                            COMPUTE  WK-TOKUSYU-KEISAN-EN2 =
                                     WK-TOKUSYU-KEISAN-EN2 + 0.9
                            MOVE  WK-TOKUSYU-KEISAN-EN2
                                            TO  WK-TOKUSYU-KEISAN-EN21
                            MOVE  WK-TOKUSYU-KEISAN-EN21
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 END-IF
                          COMPUTE FTN-SYU-M-ENTANI =
                                  FTN-SYU-M-ENTANI -
                                  WK-TOKUSYU-KEISAN-EN2
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH2HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH2HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-SYU-M
                          COMPUTE  FTN-SYU-M = FTN-SYU-M
                                             - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH2COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH2COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH2COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH2COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU-KEISAN-EN1
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD   WK-TOKUSYU-KEISAN-EN1
                                            TO  FTN-SYU-M-ENTANI
                          MOVE  SYU-KOH-FTN-ENTANI
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 IF    @@@
                            COMPUTE  WK-TOKUSYU-KEISAN-EN2 =
                                     WK-TOKUSYU-KEISAN-EN2 + 0.9
                            MOVE  WK-TOKUSYU-KEISAN-EN2
                                            TO  WK-TOKUSYU-KEISAN-EN21
                            MOVE  WK-TOKUSYU-KEISAN-EN21
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 END-IF
                          COMPUTE FTN-SYU-M-ENTANI =
                                  FTN-SYU-M-ENTANI -
                                  WK-TOKUSYU-KEISAN-EN2
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH3HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH3HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-SYU-M
                          COMPUTE  FTN-SYU-M = FTN-SYU-M
                                             - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH3COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH3COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH3COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH3COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU-KEISAN-EN1
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD   WK-TOKUSYU-KEISAN-EN1
                                            TO  FTN-SYU-M-ENTANI
                          MOVE  SYU-KOH-FTN-ENTANI
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 IF    @@@
                            COMPUTE  WK-TOKUSYU-KEISAN-EN2 =
                                     WK-TOKUSYU-KEISAN-EN2 + 0.9
                            MOVE  WK-TOKUSYU-KEISAN-EN2
                                            TO  WK-TOKUSYU-KEISAN-EN21
                            MOVE  WK-TOKUSYU-KEISAN-EN21
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 END-IF
                          COMPUTE FTN-SYU-M-ENTANI =
                                  FTN-SYU-M-ENTANI -
                                  WK-TOKUSYU-KEISAN-EN2
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH4HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH4HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-SYU-M
                          COMPUTE  FTN-SYU-M = FTN-SYU-M
                                             - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH4COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH4COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH4COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH4COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU-KEISAN-EN1
                        END-IF
                        IF   FLG-TOKYO  =  1
                        AND  FLG-TAISYO =  ZERO
                          ADD   WK-TOKUSYU-KEISAN-EN1
                                            TO  FTN-SYU-M-ENTANI
                          MOVE  SYU-KOH-FTN-ENTANI
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 IF    @@@
                            COMPUTE  WK-TOKUSYU-KEISAN-EN2 =
                                     WK-TOKUSYU-KEISAN-EN2 + 0.9
                            MOVE  WK-TOKUSYU-KEISAN-EN2
                                            TO  WK-TOKUSYU-KEISAN-EN21
                            MOVE  WK-TOKUSYU-KEISAN-EN21
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 END-IF
                          COMPUTE FTN-SYU-M-ENTANI =
                                  FTN-SYU-M-ENTANI -
                                  WK-TOKUSYU-KEISAN-EN2
                        END-IF
                      END-IF
                 END-IF
      *
                 IF   WK-2010-SYOKEI2KBN-N(1) = "1"
                    IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH1HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH1COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH1COMPFTN-ENTANI
                    END-IF
                    IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH2HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH2COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH2COMPFTN-ENTANI
                    END-IF
                    IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH3HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH3COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH3COMPFTN-ENTANI
                    END-IF
                    IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH4HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH4COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH4COMPFTN-ENTANI
                    END-IF
                 END-IF
      *
                 IF ((WK-1001-PREFNUM          =  44      ) AND
                     (LNK-SYU-KOH1HKNNUM  = "183" OR "283") AND
                     (LNK-SYU-SRYYMD(1:6)     >= "200610" ) AND
                     (LNK-SYU-SRYYMD(1:6)     <  "201010" ))
                 OR ( WK-2010-NINNASIKBN(1)   NOT = SPACE  )
                 OR ( WK-2010-NINJYOKBN(1)    NOT = SPACE  )
                 OR ( WK-2010-NINNASIKBN-K(1) NOT = SPACE  )
                    IF    LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM
                                             OR  SYU-KOH2HKNNUM
                                             OR  SYU-KOH3HKNNUM
                                             OR  SYU-KOH4HKNNUM
                       ADD   SYU-JYO-HKNFTNMONEY
                                      TO  WK-OITA-HKNFTNMONEY
                       ADD   SYU-JYO-COMPFTN
                                      TO  WK-OITA-CYOFTN
                    END-IF
                 END-IF
      *
                 IF   SYU-NYUGAIKBN  =   "1"
                  IF     ((MAX-KIN-KOHI1-D       NOT = ZERO) AND
                          (MAX-KIN-KOHI1-M           = ZERO))
                  OR     ((MAX-KIN-KOHI1-D       NOT = ZERO) AND
                          (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                   PERFORM   VARYING  IDX2  FROM  1  BY  1
                              UNTIL   IDX2   >   31
                     IF ((SYU-DAY(IDX2) = "1" OR "2" OR "8" OR "9") AND
                         (SDAY-HKNTEN(IDX2)          NOT =  ZERO  ))
                     OR ((LNK-S02-NYUINDAY-KBN(IDX2)   =  "1") AND
                         (WK-2010-TANKIKBN(1)          =  "1")     )
                        EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM)
                             IF  KOHI1-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 1)     =  1
                               IF  SYU-KOH1HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI1-TBL(IDX2)
                                 ADD     1      TO    KOHI1-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI1-TBL2(IDX2)
                                 ADD     1      TO    KOHI1-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 1)
                                          TO  FTN-KOHI1-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 1)
                                          TO  FTN-KOHI1-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 1)
                                          TO  FTN-KOHI1-D3(IDX2)
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 1)
                                          TO  FTN-KOHI1-D(IDX2)
                                              FTN-KOHI1-D2(IDX2)
                                              FTN-KOHI1-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM)
                             IF  KOHI1-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 2)     =  1
                               IF  SYU-KOH2HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI1-TBL(IDX2)
                                 ADD     1      TO    KOHI1-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI1-TBL2(IDX2)
                                 ADD     1      TO    KOHI1-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 2)
                                          TO  FTN-KOHI1-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 2)
                                          TO  FTN-KOHI1-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 2)
                                          TO  FTN-KOHI1-D3(IDX2)
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 2)
                                          TO  FTN-KOHI1-D(IDX2)
                                              FTN-KOHI1-D2(IDX2)
                                              FTN-KOHI1-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM)
                             IF  KOHI1-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 3)     =  1
                               IF  SYU-KOH3HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI1-TBL(IDX2)
                                 ADD     1      TO    KOHI1-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI1-TBL2(IDX2)
                                 ADD     1      TO    KOHI1-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 3)
                                          TO  FTN-KOHI1-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 3)
                                          TO  FTN-KOHI1-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 3)
                                          TO  FTN-KOHI1-D3(IDX2)
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 3)
                                          TO  FTN-KOHI1-D(IDX2)
                                              FTN-KOHI1-D2(IDX2)
                                              FTN-KOHI1-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM)
                             IF  KOHI1-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 4)     =  1
                               IF  SYU-KOH4HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI1-TBL(IDX2)
                                 ADD     1      TO    KOHI1-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI1-TBL2(IDX2)
                                 ADD     1      TO    KOHI1-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 4)
                                          TO  FTN-KOHI1-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 4)
                                          TO  FTN-KOHI1-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 4)
                                          TO  FTN-KOHI1-D3(IDX2)
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 4)
                                          TO  FTN-KOHI1-D(IDX2)
                                              FTN-KOHI1-D2(IDX2)
                                              FTN-KOHI1-D3(IDX2)
                             END-IF
                        END-EVALUATE
                     END-IF
                   END-PERFORM
                  END-IF
                 END-IF
      *
                 IF   SYU-NYUGAIKBN  =   "2"
                  IF     ((MAX-KIN-KOHI1-D       NOT = ZERO) AND
                          (MAX-KIN-KOHI1-M           = ZERO))
                  OR     ((MAX-KIN-KOHI1-D       NOT = ZERO) AND
                          (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                    EVALUATE  TRUE
                      WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI1-TBL(IDX10)         = ZERO
                         AND SYU-KOH1HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI1-TBL(IDX10)
                            ADD   1   TO  KOHI1-TBL(32)
                         END-IF
                         ADD   SYU-KOH1HKNFTNMONEY
                                      TO  FTN-KOHI1-D(IDX10)
                         ADD   SYU-KOH1COMPFTN
                                      TO  FTN-KOHI1-D2(IDX10)
                         MOVE  SYU-KOH1COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI1-D3(IDX10)
                      WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI1-TBL(IDX10)         = ZERO
                         AND SYU-KOH2HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI1-TBL(IDX10)
                            ADD   1   TO  KOHI1-TBL(32)
                         END-IF
                         ADD   SYU-KOH2HKNFTNMONEY
                                      TO  FTN-KOHI1-D(IDX10)
                         ADD   SYU-KOH2COMPFTN
                                      TO  FTN-KOHI1-D2(IDX10)
                         MOVE  SYU-KOH2COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI1-D3(IDX10)
                      WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI1-TBL(IDX10)         = ZERO
                         AND SYU-KOH3HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI1-TBL(IDX10)
                            ADD   1   TO  KOHI1-TBL(32)
                         END-IF
                         ADD   SYU-KOH3HKNFTNMONEY
                                      TO  FTN-KOHI1-D(IDX10)
                         ADD   SYU-KOH3COMPFTN
                                      TO  FTN-KOHI1-D2(IDX10)
                         MOVE  SYU-KOH3COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI1-D3(IDX10)
                      WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI1-TBL(IDX10)         = ZERO
                         AND SYU-KOH4HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI1-TBL(IDX10)
                            ADD   1   TO  KOHI1-TBL(32)
                         END-IF
                         ADD   SYU-KOH4HKNFTNMONEY
                                      TO  FTN-KOHI1-D(IDX10)
                         ADD   SYU-KOH4COMPFTN
                                      TO  FTN-KOHI1-D2(IDX10)
                         MOVE  SYU-KOH4COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI1-D3(IDX10)
                    END-EVALUATE
                  END-IF
                 END-IF
      *
                 EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM)
                             IF  (WK-HKNJANUM2-TBL NOT =
                                                WK-HKNJANUM-TBL)
                             AND (FLG-IRYOHI-TOYAMA  = 11 OR 12)
                               MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                                               SYU-KOH1COMPFTN
                                               SYU-KOH1COMPFTN-ENTANI
                                               SYU-KOH1SKJ-FTN
                             END-IF
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                             ADD   SYU-KOH1COMPFTN
                                                TO  FTN-KOHI1-M2
                             MOVE  SYU-KOH1COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI1-M3
                             IF  SYU-KOH1SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI1-M
                                                    FTN-KOHI1-M2
                                                    FTN-KOHI1-M3
                             END-IF
                             IF  (FLG-RUIKEIYO =  1              )
                             AND (LNK-SYU-KOH2HKNNUM
                                               =  SYU-KOH2HKNNUM )
                             AND (COMB-KOH2ID  =  WRK-COMB-KOH2ID)
                             AND (WK-HKNJANUM3-TBL
                                               =  WK-HKNJANUM-TBL)
                              IF WK-2010-KINJYOKBN-N(1) = "1"
                               ADD   WK-RUI-TAIHI-HKNFTNMONEY
                                                TO  WK-RUI-FTN1-M
                               ADD   WK-RUI-TAIHI-COMPFTN
                                                TO  WK-RUI-FTN1-M2
                               ADD   WK-RUI-TAIHI-COMPFTN-ENTANI
                                                TO  WK-RUI-FTN1-M3
                               COMPUTE WK-ENTANI2 =
                                       WK-RUI-TAIHI-COMPFTN-ENTANI
                                                              + 0.9
                               ADD   WK-ENTANI2 TO  WK-RUI-FTN1-M4
                              ELSE
                               ADD   SYU-KOH1HKNFTNMONEY
                                                TO  WK-RUI-FTN1-M
                               ADD   SYU-KOH1COMPFTN
                                                TO  WK-RUI-FTN1-M2
                               ADD   SYU-KOH1COMPFTN-ENTANI
                                                TO  WK-RUI-FTN1-M3
                               COMPUTE WK-ENTANI2 =
                                       SYU-KOH1COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI2 TO  WK-RUI-FTN1-M4
                              END-IF
                              IF   SYU-KOH1SKJ-FTNKBN =  "2"
                               ADD   SYU-KOH1SKJ-FTN
                                                TO  WK-RUI-FTN1-M
                                                    WK-RUI-FTN1-M2
                                                    WK-RUI-FTN1-M3
                                                    WK-RUI-FTN1-M4
                              END-IF
                             END-IF
                             IF ((LNK-SYU-SRYYMD(1:6)  >=  "200604") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "015" OR "016" OR "021") AND
                                 (WK-JIRITU-CYUKANSOU(1)   =  2    ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200610") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "024" OR "079"         ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200804") AND
                                 (LNK-SYU-KOH1HKNNUM    =  "038"   ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "201501") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "052" OR "054"         ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-KOH1HKNNUM(1:1)
                                                 >= "1" AND <=  "8") AND
                                 (WK-KOHJGNGET-TAISYOKBN(1)
                                                           =  2    ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                                ADD   SYU-KOH1HKNFTNMONEY
                                                   TO  FTN-KOHI1-M-JI
                                ADD   SYU-KOH1COMPFTN
                                                   TO  FTN-KOHI1-M2-JI
                                MOVE  SYU-KOH1COMPFTN-ENTANI
                                                   TO  WK-ENTANI
                                PERFORM  22018-ENTANI-HENSYU-SEC
                                ADD   WK-ENTANI    TO  FTN-KOHI1-M3-JI
                                IF  (FLG-RUIKEIYO =  1              )
                                AND (LNK-SYU-KOH2HKNNUM
                                                  =  SYU-KOH2HKNNUM )
                                AND (COMB-KOH2ID  =  WRK-COMB-KOH2ID)
                                AND (WK-HKNJANUM3-TBL
                                                  =  WK-HKNJANUM-TBL)
                                  ADD   SYU-KOH1HKNFTNMONEY
                                                   TO  WK-RUI-FTN1-M-JI
                                  ADD   SYU-KOH1COMPFTN
                                                   TO  WK-RUI-FTN1-M2-JI
                                  ADD   SYU-KOH1COMPFTN-ENTANI
                                                   TO  WK-RUI-FTN1-M3-JI
                                  COMPUTE WK-ENTANI2 =
                                        SYU-KOH1COMPFTN-ENTANI + 0.9
                                  ADD   WK-ENTANI2 TO  WK-RUI-FTN1-M4-JI
                                END-IF
                                IF   FLG-RUITAISYO  =  1
                                  ADD   SYU-KOH1HKNFTNMONEY
                                            TO  FTN-KOHI1-M-JI-TOKU75
                                  ADD   SYU-KOH1COMPFTN
                                            TO  FTN-KOHI1-M2-JI-TOKU75
                                  MOVE  SYU-KOH1COMPFTN-ENTANI
                                            TO  WK-ENTANI
                                  PERFORM  22018-ENTANI-HENSYU-SEC
                                  ADD   WK-ENTANI
                                            TO  FTN-KOHI1-M3-JI-TOKU75
                                  IF  (FLG-RUIKEIYO =  1              )
                                  AND (LNK-SYU-KOH2HKNNUM
                                                    =  SYU-KOH2HKNNUM )
                                  AND (COMB-KOH2ID  =  WRK-COMB-KOH2ID)
                                  AND (WK-HKNJANUM3-TBL
                                                    =  WK-HKNJANUM-TBL)
                                    ADD   SYU-KOH1HKNFTNMONEY
                                            TO  WK-RUI-FTN1-M-JI-TOKU75
                                    ADD   SYU-KOH1COMPFTN
                                            TO  WK-RUI-FTN1-M2-JI-TOKU75
                                    ADD   SYU-KOH1COMPFTN-ENTANI
                                            TO  WK-RUI-FTN1-M3-JI-TOKU75
                                    COMPUTE WK-ENTANI2 =
                                          SYU-KOH1COMPFTN-ENTANI + 0.9
                                    ADD   WK-ENTANI2
                                            TO  WK-RUI-FTN1-M4-JI-TOKU75
                                  END-IF
                                END-IF
                             END-IF
                             IF  (LNK-SYU-SRYYMD(1:6)  >=  "200610")
                             AND (LNK-SYU-KOH1HKNNUM    =
                                            "024" OR "079"         )
                             AND (SYU-NYUGAIKBN            = "1"   )
                                ADD   SYU-KOH1SKJ-FTN
                                                   TO  FTN-KOHI1-SKJ
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH1HKNNUM(1:1) = "0" ) OR
                                  (WK-TOKATUKAI(1)         =  1  ) OR
                                  (LNK-SYU-KOH1HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI1-M-TOKU75
                               ADD   SYU-KOH1COMPFTN
                                                TO  FTN-KOHI1-M2-TOKU75
                               MOVE  SYU-KOH1COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI1-M3-TOKU75
                               IF  SYU-KOH1SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI1-M-TOKU75
                                                    FTN-KOHI1-M2-TOKU75
                                                    FTN-KOHI1-M3-TOKU75
                               END-IF
                               IF  (FLG-RUIKEIYO =  1              )
                               AND (LNK-SYU-KOH2HKNNUM
                                                 =  SYU-KOH2HKNNUM )
                               AND (COMB-KOH2ID  =  WRK-COMB-KOH2ID)
                               AND (WK-HKNJANUM3-TBL
                                                 =  WK-HKNJANUM-TBL)
                                 ADD   SYU-KOH1HKNFTNMONEY
                                        TO  WK-RUI-FTN1-M-TOKU75
                                 ADD   SYU-KOH1COMPFTN
                                        TO  WK-RUI-FTN1-M2-TOKU75
                                 ADD   SYU-KOH1COMPFTN-ENTANI
                                        TO  WK-RUI-FTN1-M3-TOKU75
                                 COMPUTE WK-ENTANI2 =
                                       SYU-KOH1COMPFTN-ENTANI + 0.9
                                 ADD   WK-ENTANI2
                                        TO  WK-RUI-FTN1-M4-TOKU75
                                 IF    SYU-KOH1SKJ-FTNKBN =  "2"
                                  ADD  SYU-KOH1SKJ-FTN
                                        TO  WK-RUI-FTN1-M-TOKU75
                                            WK-RUI-FTN1-M2-TOKU75
                                            WK-RUI-FTN1-M3-TOKU75
                                            WK-RUI-FTN1-M4-TOKU75
                                 END-IF
                               END-IF
                             END-IF
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM)
                             IF  (WK-HKNJANUM2-TBL NOT =
                                                WK-HKNJANUM-TBL)
                             AND (FLG-IRYOHI-TOYAMA  = 11 OR 12)
                               MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                                               SYU-KOH2COMPFTN
                                               SYU-KOH2COMPFTN-ENTANI
                                               SYU-KOH2SKJ-FTN
                             END-IF
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                             ADD   SYU-KOH2COMPFTN
                                                TO  FTN-KOHI1-M2
                             MOVE  SYU-KOH2COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI1-M3
                             IF  SYU-KOH2SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI1-M
                                                    FTN-KOHI1-M2
                                                    FTN-KOHI1-M3
                             END-IF
                             IF ((LNK-SYU-SRYYMD(1:6)  >=  "200604") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "015" OR "016" OR "021") AND
                                 (WK-JIRITU-CYUKANSOU(1)   =  2    ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200610") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "024" OR "079"         ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "201501") AND
                                 (LNK-SYU-KOH1HKNNUM    =
                                            "054"                  ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-KOH1HKNNUM(1:1)
                                                 >= "1" AND <=  "8") AND
                                 (WK-KOHJGNGET-TAISYOKBN(1)
                                                           =  2    ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                                ADD   SYU-KOH2HKNFTNMONEY
                                                   TO  FTN-KOHI1-M-JI
                                ADD   SYU-KOH2COMPFTN
                                                   TO  FTN-KOHI1-M2-JI
                                MOVE  SYU-KOH2COMPFTN-ENTANI
                                                   TO  WK-ENTANI
                                PERFORM  22018-ENTANI-HENSYU-SEC
                                ADD   WK-ENTANI    TO  FTN-KOHI1-M3-JI
                             END-IF
                             IF  (LNK-SYU-SRYYMD(1:6)  >=  "200610")
                             AND (LNK-SYU-KOH1HKNNUM    =
                                            "024" OR "079"         )
                             AND (SYU-NYUGAIKBN            = "1"   )
                                ADD   SYU-KOH2SKJ-FTN
                                                   TO  FTN-KOHI1-SKJ
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH1HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH1HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI1-M-TOKU75
                               ADD   SYU-KOH2COMPFTN
                                                TO  FTN-KOHI1-M2-TOKU75
                               MOVE  SYU-KOH2COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI1-M3-TOKU75
                               IF  SYU-KOH2SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI1-M-TOKU75
                                                    FTN-KOHI1-M2-TOKU75
                                                    FTN-KOHI1-M3-TOKU75
                               END-IF
                             END-IF
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                             ADD   SYU-KOH3COMPFTN
                                                TO  FTN-KOHI1-M2
                             MOVE  SYU-KOH3COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI1-M3
                             IF  SYU-KOH3SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI1-M
                                                    FTN-KOHI1-M2
                                                    FTN-KOHI1-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH1HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH1HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI1-M-TOKU75
                               ADD   SYU-KOH3COMPFTN
                                                TO  FTN-KOHI1-M2-TOKU75
                               MOVE  SYU-KOH3COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI1-M3-TOKU75
                               IF  SYU-KOH3SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI1-M-TOKU75
                                                    FTN-KOHI1-M2-TOKU75
                                                    FTN-KOHI1-M3-TOKU75
                               END-IF
                             END-IF
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI1-M
                             ADD   SYU-KOH4COMPFTN
                                                TO  FTN-KOHI1-M2
                             MOVE  SYU-KOH4COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI1-M3
                             IF  SYU-KOH4SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI1-M
                                                    FTN-KOHI1-M2
                                                    FTN-KOHI1-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH1HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH1HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI1-M-TOKU75
                               ADD   SYU-KOH4COMPFTN
                                                TO  FTN-KOHI1-M2-TOKU75
                               MOVE  SYU-KOH4COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI1-M3-TOKU75
                               IF  SYU-KOH4SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI1-M-TOKU75
                                                    FTN-KOHI1-M2-TOKU75
                                                    FTN-KOHI1-M3-TOKU75
                               END-IF
                             END-IF
                 END-EVALUATE
               END-IF
             END-IF
           END-IF.
      *    ¸øÈñ£²¥«¥¦¥ó¥È
           IF ((COMB-KOH2HKNNUM          NOT =   SPACE) AND
               (COMB-KOH2-NYUJGNKBN          =   "1"  ))
           OR ( WK-2010-IRYOKEIKBN-N(2)   = "3" OR "4" )
           OR ((FLG-IRYOHI3               =   1 OR 3  ) AND
               (COMB-KOH2HKNNUM          NOT =   SPACE))
           OR ((FLG-IRYOHI70  = 5 OR 6 OR 11 OR 12    ) AND
               (COMB-KOH2HKNNUM          NOT =   SPACE))
           OR ( FLG-RUIKEIYO              =   1        )
           OR ((FLG-IRYOHIKG2     =   4  OR  5  OR  6 ) AND
               (COMB-KOH2HKNNUM          NOT =   SPACE))
             IF  ( SYU-NYUGAIKBN              =   "1"   )
             OR  ((SYU-NYUGAIKBN              =   "2"  ) AND
                  (FLG-NYUGAI                 =    2   ))
             OR  ((SYU-NYUGAIKBN              =   "2"  ) AND
                  (FLG-NYUGAI2                =    2   ))
               IF   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH4ID))
      *
                IF   SYU-NYUGAIKBN  =   "1"
                 IF  FLG-GENBUTU70    NOT =  ZERO
                  IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                    IF   (FLG-IRYOHI70  =  5 OR 6 OR 11 OR 12  )
                    AND  (FLG-SYUKEI    =  ZERO                )
                      IF ( WK-2010-IRYOKEIKBN-N(2) NOT = SPACE )
                      OR ( WK-2010-KINJYOKBN-N(2)   =  "1"     )
                      OR ((WK-1001-PREFNUM    =  43           ) AND
                          (LNK-SYU-KOH2HKNNUM = "143" OR "342") AND
                          (LNK-SYU-SRYYMD(1:6)  >=  "200912"  ))
                      OR ( FLG-FTNRATE100     =  2             )
                        COMPUTE  WK-KOUREI-IRYOHI70  =
                                 WK-KOUREI-IRYOHI70  +
                                (SYU-HKNTEN (17) * 10)
                      END-IF
                    END-IF
                  END-IF
                  IF  (FLG-SYUKEI3    =  ZERO                )
                  AND (FLG-IRYOHI70K  =  21 OR 22 OR 23 OR 24)
                    COMPUTE  WK-KOUREI-IRYOHI70K =
                             WK-KOUREI-IRYOHI70K +
                            (SYU-HKNTEN (17) * 10)
                  END-IF
                 ELSE
                  IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                    IF   ((FLG-IRYOHI3     =  3          ) OR
                          (FLG-IRYOHIKG2   =  4 OR 5 OR 6))
                    AND  ( FLG-SYUKEI      =  ZERO        )
                      IF ( WK-2010-IRYOKEIKBN-N(2) NOT = SPACE )
                      OR ( WK-2010-KINJYOKBN-N(2)   =  "1"     )
                      OR ((WK-1001-PREFNUM    =  43           ) AND
                          (LNK-SYU-KOH2HKNNUM = "143" OR "342") AND
                          (LNK-SYU-SRYYMD(1:6)  >=  "200912"  ))
                      OR ( FLG-FTNRATE100     =  2             )
                       IF  (LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM )
                       AND (COMB-KOH2ID        = WRK-COMB-KOH2ID)
                        COMPUTE  WK-KOUREI-IRYOHI  =
                                 WK-KOUREI-IRYOHI  +
                                (SYU-HKNTEN (17) * 10)
                       END-IF
                      END-IF
                    END-IF
                    IF  FLG-IRYOHI-TOYAMA  =  21 OR 22
                        COMPUTE  WK-IRYOHI-TOYAMA  =
                                 WK-IRYOHI-TOYAMA  +
                                (SYU-HKNTEN (17) * 10)
                    END-IF
                  END-IF
                  IF     FLG-IRYOHI3  =  1
                        COMPUTE  WK-KOUREI-IRYOHI  =
                                 WK-KOUREI-IRYOHI  +
                                (SYU-HKNTEN (17) * 10)
                  END-IF
                  IF     FLG-IRYOHI2  =  2
                        COMPUTE  WK-KOUREI-IRYOHI  =
                                 WK-KOUREI-IRYOHI  +
                                (SYU-HKNTEN (17) * 10)
                  END-IF
                  IF     FLG-IRYOHI5  =  21 OR 22 OR 23
                        COMPUTE  WK-KOUREI-IRYOHI3  =
                                 WK-KOUREI-IRYOHI3  +
                                (SYU-HKNTEN (17) * 10)
                  END-IF
                 END-IF
                END-IF
      *
                 IF   WK-2010-IRYOKEIKBN-N(2)  NOT = SPACE
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-N(2)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH1HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH1COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH1COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(2)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-N(2)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH2HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH2COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH2COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(2)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-N(2)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH3HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH3COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH3COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(2)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-N(2)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH4HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH4COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH4COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(2)
                         END-EVALUATE
                      END-IF
                      IF   WK-2010-IRYOKEIKBN-N(2) = "2"
                         COMPUTE   WK-IRYOKEIKBN-HANTEITEN  =
                                   WK-IRYOKEIKBN-HANTEITEN  +
                                   SYU-TOTAL-HKNTEN
                      END-IF
                 END-IF
      *
                 IF   WK-2010-KINJYOKBN-N(2)  = "1"
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH1HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH1HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-KOHI1-M
                          COMPUTE  FTN-KOHI1-M = FTN-KOHI1-M
                                               - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH1COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH1COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH1COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH1COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU-KEISAN-EN1
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD   WK-TOKUSYU-KEISAN-EN1
                                            TO  FTN-KOHI1-M-ENTANI
                          MOVE  SYU-KOH-FTN-ENTANI
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 IF    @@@
                            COMPUTE  WK-TOKUSYU-KEISAN-EN2 =
                                     WK-TOKUSYU-KEISAN-EN2 + 0.9
                            MOVE  WK-TOKUSYU-KEISAN-EN2
                                            TO  WK-TOKUSYU-KEISAN-EN21
                            MOVE  WK-TOKUSYU-KEISAN-EN21
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 END-IF
                          COMPUTE FTN-KOHI1-M-ENTANI =
                                  FTN-KOHI1-M-ENTANI -
                                  WK-TOKUSYU-KEISAN-EN2
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH2HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH2HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-KOHI1-M
                          COMPUTE  FTN-KOHI1-M = FTN-KOHI1-M
                                               - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH2COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH2COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH2COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH2COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU-KEISAN-EN1
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD   WK-TOKUSYU-KEISAN-EN1
                                            TO  FTN-KOHI1-M-ENTANI
                          MOVE  SYU-KOH-FTN-ENTANI
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 IF    @@@
                            COMPUTE  WK-TOKUSYU-KEISAN-EN2 =
                                     WK-TOKUSYU-KEISAN-EN2 + 0.9
                            MOVE  WK-TOKUSYU-KEISAN-EN2
                                            TO  WK-TOKUSYU-KEISAN-EN21
                            MOVE  WK-TOKUSYU-KEISAN-EN21
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 END-IF
                          COMPUTE FTN-KOHI1-M-ENTANI =
                                  FTN-KOHI1-M-ENTANI -
                                  WK-TOKUSYU-KEISAN-EN2
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH3HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH3HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-KOHI1-M
                          COMPUTE  FTN-KOHI1-M = FTN-KOHI1-M
                                               - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH3COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH3COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH3COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH3COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU-KEISAN-EN1
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD   WK-TOKUSYU-KEISAN-EN1
                                            TO  FTN-KOHI1-M-ENTANI
                          MOVE  SYU-KOH-FTN-ENTANI
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 IF    @@@
                            COMPUTE  WK-TOKUSYU-KEISAN-EN2 =
                                     WK-TOKUSYU-KEISAN-EN2 + 0.9
                            MOVE  WK-TOKUSYU-KEISAN-EN2
                                            TO  WK-TOKUSYU-KEISAN-EN21
                            MOVE  WK-TOKUSYU-KEISAN-EN21
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 END-IF
                          COMPUTE FTN-KOHI1-M-ENTANI =
                                  FTN-KOHI1-M-ENTANI -
                                  WK-TOKUSYU-KEISAN-EN2
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH4HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH4HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4HKNFTNMONEY
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD  SYU-JYO-HKNFTNMONEY  TO   FTN-KOHI1-M
                          COMPUTE  FTN-KOHI1-M = FTN-KOHI1-M
                                               - SYU-KOH-FTN
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH4COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH4COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH4COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH4COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN-ENTANI
                         MOVE  ZERO  TO  WK-TOKUSYU-KEISAN-EN1
                        END-IF
                        IF   FLG-TOKYO  =  2
                        AND  FLG-TAISYO =  ZERO
                          ADD   WK-TOKUSYU-KEISAN-EN1
                                            TO  FTN-KOHI1-M-ENTANI
                          MOVE  SYU-KOH-FTN-ENTANI
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 IF    @@@
                            COMPUTE  WK-TOKUSYU-KEISAN-EN2 =
                                     WK-TOKUSYU-KEISAN-EN2 + 0.9
                            MOVE  WK-TOKUSYU-KEISAN-EN2
                                            TO  WK-TOKUSYU-KEISAN-EN21
                            MOVE  WK-TOKUSYU-KEISAN-EN21
                                            TO  WK-TOKUSYU-KEISAN-EN2
      ***                 END-IF
                          COMPUTE FTN-KOHI1-M-ENTANI =
                                  FTN-KOHI1-M-ENTANI -
                                  WK-TOKUSYU-KEISAN-EN2
                        END-IF
                      END-IF
                 END-IF
      *
                 IF   WK-2010-SYOKEI2KBN-N(2) = "1"
                    IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH1HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH1COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH1COMPFTN-ENTANI
                    END-IF
                    IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH2HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH2COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH2COMPFTN-ENTANI
                    END-IF
                    IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH3HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH3COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH3COMPFTN-ENTANI
                    END-IF
                    IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH4HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH4COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH4COMPFTN-ENTANI
                    END-IF
                 END-IF
      *
                 IF ((WK-1001-PREFNUM          =  44      ) AND
                     (LNK-SYU-KOH2HKNNUM  = "183" OR "283") AND
                     (LNK-SYU-SRYYMD(1:6)     >= "200610" ) AND
                     (LNK-SYU-SRYYMD(1:6)     <  "201010" ))
                 OR ( WK-2010-NINNASIKBN(2)   NOT = SPACE  )
                 OR ( WK-2010-NINJYOKBN(2)    NOT = SPACE  )
                 OR ( WK-2010-NINNASIKBN-K(2) NOT = SPACE  )
                    IF    LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM
                                             OR  SYU-KOH2HKNNUM
                                             OR  SYU-KOH3HKNNUM
                                             OR  SYU-KOH4HKNNUM
                       ADD   SYU-JYO-HKNFTNMONEY
                                      TO  WK-OITA-HKNFTNMONEY
                       ADD   SYU-JYO-COMPFTN
                                      TO  WK-OITA-CYOFTN
                    END-IF
                 END-IF
      *
                 IF   SYU-NYUGAIKBN  =   "1"
                  IF     ((MAX-KIN-KOHI2-D       NOT = ZERO) AND
                          (MAX-KIN-KOHI2-M           = ZERO))
                  OR     ((MAX-KIN-KOHI2-D       NOT = ZERO) AND
                          (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                   PERFORM   VARYING  IDX2  FROM  1  BY  1
                              UNTIL   IDX2   >   31
                     IF ((SYU-DAY(IDX2) = "1" OR "2" OR "8" OR "9") AND
                         (SDAY-HKNTEN(IDX2)          NOT =  ZERO  ))
                     OR ((LNK-S02-NYUINDAY-KBN(IDX2)   =  "1") AND
                         (WK-2010-TANKIKBN(2)          =  "1")     )
                        EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH1HKNNUM)
                             IF  KOHI2-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 1)     =  1
                               IF  SYU-KOH1HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI2-TBL(IDX2)
                                 ADD     1      TO    KOHI2-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI2-TBL2(IDX2)
                                 ADD     1      TO    KOHI2-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 1)
                                           TO  FTN-KOHI2-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 1)
                                           TO  FTN-KOHI2-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 1)
                                           TO  FTN-KOHI2-D3(IDX2)
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 1)
                                           TO  FTN-KOHI2-D(IDX2)
                                               FTN-KOHI2-D2(IDX2)
                                               FTN-KOHI2-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM)
                             IF  KOHI2-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 2)     =  1
                               IF  SYU-KOH2HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI2-TBL(IDX2)
                                 ADD     1      TO    KOHI2-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI2-TBL2(IDX2)
                                 ADD     1      TO    KOHI2-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 2)
                                           TO  FTN-KOHI2-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 2)
                                           TO  FTN-KOHI2-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 2)
                                           TO  FTN-KOHI2-D3(IDX2)
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 2)
                                           TO  FTN-KOHI2-D(IDX2)
                                               FTN-KOHI2-D2(IDX2)
                                               FTN-KOHI2-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH3HKNNUM)
                             IF  KOHI2-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 3)     =  1
                               IF  SYU-KOH3HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI2-TBL(IDX2)
                                 ADD     1      TO    KOHI2-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI2-TBL2(IDX2)
                                 ADD     1      TO    KOHI2-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 3)
                                           TO  FTN-KOHI2-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 3)
                                           TO  FTN-KOHI2-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 3)
                                           TO  FTN-KOHI2-D3(IDX2)
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 3)
                                           TO  FTN-KOHI2-D(IDX2)
                                               FTN-KOHI2-D2(IDX2)
                                               FTN-KOHI2-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH4HKNNUM)
                             IF  KOHI2-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 4)     =  1
                               IF  SYU-KOH4HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI2-TBL(IDX2)
                                 ADD     1      TO    KOHI2-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI2-TBL2(IDX2)
                                 ADD     1      TO    KOHI2-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 4)
                                           TO  FTN-KOHI2-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 4)
                                           TO  FTN-KOHI2-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 4)
                                           TO  FTN-KOHI2-D3(IDX2)
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 4)
                                           TO  FTN-KOHI2-D(IDX2)
                                               FTN-KOHI2-D2(IDX2)
                                               FTN-KOHI2-D3(IDX2)
                             END-IF
                        END-EVALUATE
                     END-IF
                   END-PERFORM
                  END-IF
                 END-IF
      *
                 IF   SYU-NYUGAIKBN  =   "2"
                  IF     ((MAX-KIN-KOHI2-D       NOT = ZERO) AND
                          (MAX-KIN-KOHI2-M           = ZERO))
                  OR     ((MAX-KIN-KOHI2-D       NOT = ZERO) AND
                          (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                    EVALUATE  TRUE
                      WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH1HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI2-TBL(IDX10)         = ZERO
                         AND SYU-KOH1HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI2-TBL(IDX10)
                            ADD   1   TO  KOHI2-TBL(32)
                         END-IF
                         ADD   SYU-KOH1HKNFTNMONEY
                                      TO  FTN-KOHI2-D(IDX10)
                         ADD   SYU-KOH1COMPFTN
                                      TO  FTN-KOHI2-D2(IDX10)
                         MOVE  SYU-KOH1COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI2-D3(IDX10)
                      WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI2-TBL(IDX10)         = ZERO
                         AND SYU-KOH2HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI2-TBL(IDX10)
                            ADD   1   TO  KOHI2-TBL(32)
                         END-IF
                         ADD   SYU-KOH2HKNFTNMONEY
                                      TO  FTN-KOHI2-D(IDX10)
                         ADD   SYU-KOH2COMPFTN
                                      TO  FTN-KOHI2-D2(IDX10)
                         MOVE  SYU-KOH2COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI2-D3(IDX10)
                      WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH3HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI2-TBL(IDX10)         = ZERO
                         AND SYU-KOH3HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI2-TBL(IDX10)
                            ADD   1   TO  KOHI2-TBL(32)
                         END-IF
                         ADD   SYU-KOH3HKNFTNMONEY
                                      TO  FTN-KOHI2-D(IDX10)
                         ADD   SYU-KOH3COMPFTN
                                      TO  FTN-KOHI2-D2(IDX10)
                         MOVE  SYU-KOH3COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI2-D3(IDX10)
                      WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH4HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI2-TBL(IDX10)         = ZERO
                         AND SYU-KOH4HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI2-TBL(IDX10)
                            ADD   1   TO  KOHI2-TBL(32)
                         END-IF
                         ADD   SYU-KOH4HKNFTNMONEY
                                      TO  FTN-KOHI2-D(IDX10)
                         ADD   SYU-KOH4COMPFTN
                                      TO  FTN-KOHI2-D2(IDX10)
                         MOVE  SYU-KOH4COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI2-D3(IDX10)
                    END-EVALUATE
                  END-IF
                 END-IF
      *
                 EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH1HKNNUM)
                             IF  (WK-HKNJANUM2-TBL NOT =
                                                WK-HKNJANUM-TBL)
                             AND (FLG-IRYOHI-TOYAMA  = 21 OR 22)
                               MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                                               SYU-KOH1COMPFTN
                                               SYU-KOH1COMPFTN-ENTANI
                                               SYU-KOH1SKJ-FTN
                             END-IF
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                             ADD   SYU-KOH1COMPFTN
                                                TO  FTN-KOHI2-M2
                             MOVE  SYU-KOH1COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI2-M3
                             IF  SYU-KOH1SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI2-M
                                                    FTN-KOHI2-M2
                                                    FTN-KOHI2-M3
                             END-IF
                             IF ((LNK-SYU-SRYYMD(1:6)  >=  "200604") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                            "015" OR "016" OR "021") AND
                                 (WK-JIRITU-CYUKANSOU(2)   =  2    ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200610") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                            "024" OR "079"         ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "201501") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                            "054"                  ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-KOH2HKNNUM(1:1)
                                                 >= "1" AND <=  "8") AND
                                 (WK-KOHJGNGET-TAISYOKBN(2)
                                                           =  2    ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                                ADD   SYU-KOH1HKNFTNMONEY
                                                   TO  FTN-KOHI2-M-JI
                                ADD   SYU-KOH1COMPFTN
                                                   TO  FTN-KOHI2-M2-JI
                                MOVE  SYU-KOH1COMPFTN-ENTANI
                                                   TO  WK-ENTANI
                                PERFORM  22018-ENTANI-HENSYU-SEC
                                ADD   WK-ENTANI    TO  FTN-KOHI2-M3-JI
                             END-IF
                             IF  (LNK-SYU-SRYYMD(1:6)  >=  "200610")
                             AND (LNK-SYU-KOH2HKNNUM    =
                                            "024" OR "079"         )
                             AND (SYU-NYUGAIKBN            = "1"   )
                                ADD   SYU-KOH1SKJ-FTN
                                                   TO  FTN-KOHI2-SKJ
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH2HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH2HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI2-M-TOKU75
                               ADD   SYU-KOH1COMPFTN
                                                TO  FTN-KOHI2-M2-TOKU75
                               MOVE  SYU-KOH1COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI2-M3-TOKU75
                               IF  SYU-KOH1SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI2-M-TOKU75
                                                    FTN-KOHI2-M2-TOKU75
                                                    FTN-KOHI2-M3-TOKU75
                               END-IF
                             END-IF
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM)
                             IF  (WK-HKNJANUM2-TBL NOT =
                                                WK-HKNJANUM-TBL)
                             AND (FLG-IRYOHI-TOYAMA  = 21 OR 22)
                               MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                                               SYU-KOH2COMPFTN
                                               SYU-KOH2COMPFTN-ENTANI
                                               SYU-KOH2SKJ-FTN
                             END-IF
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                             ADD   SYU-KOH2COMPFTN
                                                TO  FTN-KOHI2-M2
                             MOVE  SYU-KOH2COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI2-M3
                             IF  SYU-KOH2SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI2-M
                                                    FTN-KOHI2-M2
                                                    FTN-KOHI2-M3
                             END-IF
                             IF  (FLG-RUIKEIYO =  1              )
                             AND (LNK-SYU-KOH1HKNNUM
                                               =  SYU-KOH1HKNNUM )
                             AND (COMB-KOH1ID  =  WRK-COMB-KOH1ID)
                             AND (WK-HKNJANUM3-TBL
                                               =  WK-HKNJANUM-TBL)
                               IF  (COMB-KOH2-NYUJGNKBN = SPACE)
                               AND (SYU-KOH2HKNFTNMONEY = ZERO )
                                 IF  (WK-1001-PREFNUM    =  43  )
                                 AND (LNK-SYU-KOH2HKNNUM = "143"
                                                        OR "342")
                                 AND (LNK-SYU-SRYYMD(1:6)
                                                    <=  "200911")
                                   MOVE  SYU-KOH2COMPFTN  TO
                                           SYU-KOH2HKNFTNMONEY
                                 ELSE
                                   COMPUTE SYU-KOH2HKNFTNMONEY =
                                           SYU-KOH2COMPFTN     +  5
                                   COMPUTE SYU-KOH2HKNFTNMONEY =
                                           SYU-KOH2HKNFTNMONEY / 10
                                   COMPUTE SYU-KOH2HKNFTNMONEY =
                                           SYU-KOH2HKNFTNMONEY * 10
                                 END-IF
                               END-IF
                               ADD   SYU-KOH2HKNFTNMONEY
                                                TO  WK-RUI-FTN2-M
                               ADD   SYU-KOH2COMPFTN
                                                TO  WK-RUI-FTN2-M2
                               COMPUTE WK-ENTANI2 =
                                           SYU-KOH2COMPFTN-ENTANI + 0.9
                               ADD   WK-ENTANI2 TO  WK-RUI-FTN2-M3
                               ADD   SYU-KOH2COMPFTN-ENTANI
                                                TO  WK-RUI-FTN2-M3-XXX
                               COMPUTE  WK-RUI-ZENGAKU =
                                        WK-RUI-ZENGAKU +
                                       (SYU-HKNTEN (17) * 10)
                             END-IF
                             IF ((LNK-SYU-SRYYMD(1:6)  >=  "200604") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                            "015" OR "016" OR "021") AND
                                 (WK-JIRITU-CYUKANSOU(2)   =  2    ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "200610") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                            "024" OR "079"         ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-SRYYMD(1:6)  >=  "201501") AND
                                 (LNK-SYU-KOH2HKNNUM    =
                                            "054"                  ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                             OR ((LNK-SYU-KOH2HKNNUM(1:1)
                                                 >= "1" AND <=  "8") AND
                                 (WK-KOHJGNGET-TAISYOKBN(2)
                                                           =  2    ) AND
                                 (SYU-NYUGAIKBN            = "1"   ))
                                ADD   SYU-KOH2HKNFTNMONEY
                                                   TO  FTN-KOHI2-M-JI
                                ADD   SYU-KOH2COMPFTN
                                                   TO  FTN-KOHI2-M2-JI
                                MOVE  SYU-KOH2COMPFTN-ENTANI
                                                   TO  WK-ENTANI
                                PERFORM  22018-ENTANI-HENSYU-SEC
                                ADD   WK-ENTANI    TO  FTN-KOHI2-M3-JI
                             END-IF
                             IF  (LNK-SYU-SRYYMD(1:6)  >=  "200610")
                             AND (LNK-SYU-KOH2HKNNUM    =
                                            "024" OR "079"         )
                             AND (SYU-NYUGAIKBN            = "1"   )
                                ADD   SYU-KOH2SKJ-FTN
                                                   TO  FTN-KOHI2-SKJ
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH2HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH2HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI2-M-TOKU75
                               ADD   SYU-KOH2COMPFTN
                                                TO  FTN-KOHI2-M2-TOKU75
                               MOVE  SYU-KOH2COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI2-M3-TOKU75
                               IF  SYU-KOH2SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI2-M-TOKU75
                                                    FTN-KOHI2-M2-TOKU75
                                                    FTN-KOHI2-M3-TOKU75
                               END-IF
                             END-IF
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                             ADD   SYU-KOH3COMPFTN
                                                TO  FTN-KOHI2-M2
                             MOVE  SYU-KOH3COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI2-M3
                             IF  SYU-KOH3SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI2-M
                                                    FTN-KOHI2-M2
                                                    FTN-KOHI2-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH2HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH2HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI2-M-TOKU75
                               ADD   SYU-KOH3COMPFTN
                                                TO  FTN-KOHI2-M2-TOKU75
                               MOVE  SYU-KOH3COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI2-M3-TOKU75
                               IF  SYU-KOH3SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI2-M-TOKU75
                                                    FTN-KOHI2-M2-TOKU75
                                                    FTN-KOHI2-M3-TOKU75
                               END-IF
                             END-IF
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI2-M
                             ADD   SYU-KOH4COMPFTN
                                                TO  FTN-KOHI2-M2
                             MOVE  SYU-KOH4COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI2-M3
                             IF  SYU-KOH4SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI2-M
                                                    FTN-KOHI2-M2
                                                    FTN-KOHI2-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH2HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH2HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI2-M-TOKU75
                               ADD   SYU-KOH4COMPFTN
                                                TO  FTN-KOHI2-M2-TOKU75
                               MOVE  SYU-KOH4COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI2-M3-TOKU75
                               IF  SYU-KOH4SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI2-M-TOKU75
                                                    FTN-KOHI2-M2-TOKU75
                                                    FTN-KOHI2-M3-TOKU75
                               END-IF
                             END-IF
                 END-EVALUATE
               END-IF
             END-IF
           END-IF.
      *    ¸øÈñ£³¥«¥¦¥ó¥È
           IF ((COMB-KOH3HKNNUM          NOT =   SPACE) AND
               (COMB-KOH3-NYUJGNKBN          =   "1"  ))
           OR ( WK-2010-IRYOKEIKBN-N(3)   = "3" OR "4" )
             IF  ( SYU-NYUGAIKBN              =   "1"   )
             OR  ((SYU-NYUGAIKBN              =   "2"  ) AND
                  (FLG-NYUGAI                 =    3   ))
             OR  ((SYU-NYUGAIKBN              =   "2"  ) AND
                  (FLG-NYUGAI2                =    3   ))
               IF   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH4ID))
      *
                 IF   WK-2010-IRYOKEIKBN-N(3)  NOT = SPACE
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-N(3)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH1HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH1COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH1COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(3)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-N(3)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH2HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH2COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH2COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(3)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-N(3)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH3HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH3COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH3COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(3)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-N(3)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH4HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH4COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH4COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(3)
                         END-EVALUATE
                      END-IF
                      IF   WK-2010-IRYOKEIKBN-N(3) = "2"
                         COMPUTE   WK-IRYOKEIKBN-HANTEITEN  =
                                   WK-IRYOKEIKBN-HANTEITEN  +
                                   SYU-TOTAL-HKNTEN
                      END-IF
                 END-IF
      *
                 IF   WK-2010-KINJYOKBN-N(3)  = "1"
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH1HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH1HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH1COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH1COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH1COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH1COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH2HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH2HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH2COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH2COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH2COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH2COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH3HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH3HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH3COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH3COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH3COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH3COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH4HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH4HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH4COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH4COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH4COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH4COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN-ENTANI
                        END-IF
                      END-IF
                 END-IF
      *
                 IF   WK-2010-SYOKEI2KBN-N(3) = "1"
                    IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH1HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH1COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH1COMPFTN-ENTANI
                    END-IF
                    IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH2HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH2COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH2COMPFTN-ENTANI
                    END-IF
                    IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH3HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH3COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH3COMPFTN-ENTANI
                    END-IF
                    IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH4HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH4COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH4COMPFTN-ENTANI
                    END-IF
                 END-IF
      *
                 IF ((WK-1001-PREFNUM          =  44      ) AND
                     (LNK-SYU-KOH3HKNNUM  = "183" OR "283") AND
                     (LNK-SYU-SRYYMD(1:6)     >= "200610" ) AND
                     (LNK-SYU-SRYYMD(1:6)     <  "201010" ))
                 OR ( WK-2010-NINNASIKBN(3)   NOT = SPACE  )
                 OR ( WK-2010-NINJYOKBN(3)    NOT = SPACE  )
                 OR ( WK-2010-NINNASIKBN-K(3) NOT = SPACE  )
                    IF    LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM
                                             OR  SYU-KOH2HKNNUM
                                             OR  SYU-KOH3HKNNUM
                                             OR  SYU-KOH4HKNNUM
                       ADD   SYU-JYO-HKNFTNMONEY
                                      TO  WK-OITA-HKNFTNMONEY
                       ADD   SYU-JYO-COMPFTN
                                      TO  WK-OITA-CYOFTN
                    END-IF
                 END-IF
      *
                 IF   SYU-NYUGAIKBN  =   "1"
                  IF     ((MAX-KIN-KOHI3-D       NOT = ZERO) AND
                          (MAX-KIN-KOHI3-M           = ZERO))
                  OR     ((MAX-KIN-KOHI3-D       NOT = ZERO) AND
                          (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                   PERFORM   VARYING  IDX2  FROM  1  BY  1
                              UNTIL   IDX2   >   31
                     IF ((SYU-DAY(IDX2) = "1" OR "2" OR "8" OR "9") AND
                         (SDAY-HKNTEN(IDX2)          NOT =  ZERO  ))
                     OR ((LNK-S02-NYUINDAY-KBN(IDX2)   =  "1") AND
                         (WK-2010-TANKIKBN(3)          =  "1")     )
                        EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH1HKNNUM)
                             IF  KOHI3-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 1)     =  1
                               IF  SYU-KOH1HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI3-TBL(IDX2)
                                 ADD     1      TO    KOHI3-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI3-TBL2(IDX2)
                                 ADD     1      TO    KOHI3-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 1)
                                           TO  FTN-KOHI3-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 1)
                                           TO  FTN-KOHI3-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 1)
                                           TO  FTN-KOHI3-D3(IDX2)
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 1)
                                           TO  FTN-KOHI3-D(IDX2)
                                               FTN-KOHI3-D2(IDX2)
                                               FTN-KOHI3-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH2HKNNUM)
                             IF  KOHI3-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 2)     =  1
                               IF  SYU-KOH2HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI3-TBL(IDX2)
                                 ADD     1      TO    KOHI3-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI3-TBL2(IDX2)
                                 ADD     1      TO    KOHI3-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 2)
                                           TO  FTN-KOHI3-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 2)
                                           TO  FTN-KOHI3-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 2)
                                           TO  FTN-KOHI3-D3(IDX2)
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 2)
                                           TO  FTN-KOHI3-D(IDX2)
                                               FTN-KOHI3-D2(IDX2)
                                               FTN-KOHI3-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH3HKNNUM)
                             IF  KOHI3-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 3)     =  1
                               IF  SYU-KOH3HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI3-TBL(IDX2)
                                 ADD     1      TO    KOHI3-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI3-TBL2(IDX2)
                                 ADD     1      TO    KOHI3-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 3)
                                           TO  FTN-KOHI3-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 3)
                                           TO  FTN-KOHI3-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 3)
                                           TO  FTN-KOHI3-D3(IDX2)
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 3)
                                           TO  FTN-KOHI3-D(IDX2)
                                               FTN-KOHI3-D2(IDX2)
                                               FTN-KOHI3-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH4HKNNUM)
                             IF  KOHI3-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 4)     =  1
                               IF  SYU-KOH4HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI3-TBL(IDX2)
                                 ADD     1      TO    KOHI3-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI3-TBL2(IDX2)
                                 ADD     1      TO    KOHI3-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 4)
                                           TO  FTN-KOHI3-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 4)
                                           TO  FTN-KOHI3-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 4)
                                           TO  FTN-KOHI3-D3(IDX2)
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 4)
                                           TO  FTN-KOHI3-D(IDX2)
                                               FTN-KOHI3-D2(IDX2)
                                               FTN-KOHI3-D3(IDX2)
                             END-IF
                        END-EVALUATE
                     END-IF
                   END-PERFORM
                  END-IF
                 END-IF
      *
                 IF   SYU-NYUGAIKBN  =   "2"
                  IF     ((MAX-KIN-KOHI3-D       NOT = ZERO) AND
                          (MAX-KIN-KOHI3-M           = ZERO))
                  OR     ((MAX-KIN-KOHI3-D       NOT = ZERO) AND
                          (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                    EVALUATE  TRUE
                      WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH1HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI3-TBL(IDX10)         = ZERO
                         AND SYU-KOH1HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI3-TBL(IDX10)
                            ADD   1   TO  KOHI3-TBL(32)
                         END-IF
                         ADD   SYU-KOH1HKNFTNMONEY
                                      TO  FTN-KOHI3-D(IDX10)
                         ADD   SYU-KOH1COMPFTN
                                      TO  FTN-KOHI3-D2(IDX10)
                         MOVE  SYU-KOH1COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI3-D3(IDX10)
                      WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH2HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI3-TBL(IDX10)         = ZERO
                         AND SYU-KOH2HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI3-TBL(IDX10)
                            ADD   1   TO  KOHI3-TBL(32)
                         END-IF
                         ADD   SYU-KOH2HKNFTNMONEY
                                      TO  FTN-KOHI3-D(IDX10)
                         ADD   SYU-KOH2COMPFTN
                                      TO  FTN-KOHI3-D2(IDX10)
                         MOVE  SYU-KOH2COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI3-D3(IDX10)
                      WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH3HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI3-TBL(IDX10)         = ZERO
                         AND SYU-KOH3HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI3-TBL(IDX10)
                            ADD   1   TO  KOHI3-TBL(32)
                         END-IF
                         ADD   SYU-KOH3HKNFTNMONEY
                                      TO  FTN-KOHI3-D(IDX10)
                         ADD   SYU-KOH3COMPFTN
                                      TO  FTN-KOHI3-D2(IDX10)
                         MOVE  SYU-KOH3COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI3-D3(IDX10)
                      WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH4HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI3-TBL(IDX10)         = ZERO
                         AND SYU-KOH4HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI3-TBL(IDX10)
                            ADD   1   TO  KOHI3-TBL(32)
                         END-IF
                         ADD   SYU-KOH4HKNFTNMONEY
                                      TO  FTN-KOHI3-D(IDX10)
                         ADD   SYU-KOH4COMPFTN
                                      TO  FTN-KOHI3-D2(IDX10)
                         MOVE  SYU-KOH4COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI3-D3(IDX10)
                    END-EVALUATE
                  END-IF
                 END-IF
      *
                 EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                             ADD   SYU-KOH1COMPFTN
                                                TO  FTN-KOHI3-M2
                             MOVE  SYU-KOH1COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI3-M3
                             IF  SYU-KOH1SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI3-M
                                                    FTN-KOHI3-M2
                                                    FTN-KOHI3-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH3HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH3HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI3-M-TOKU75
                               ADD   SYU-KOH1COMPFTN
                                                TO  FTN-KOHI3-M2-TOKU75
                               MOVE  SYU-KOH1COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI3-M3-TOKU75
                               IF  SYU-KOH1SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI3-M-TOKU75
                                                    FTN-KOHI3-M2-TOKU75
                                                    FTN-KOHI3-M3-TOKU75
                               END-IF
                             END-IF
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                             ADD   SYU-KOH2COMPFTN
                                                TO  FTN-KOHI3-M2
                             MOVE  SYU-KOH2COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI3-M3
                             IF  SYU-KOH2SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI3-M
                                                    FTN-KOHI3-M2
                                                    FTN-KOHI3-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH3HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH3HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI3-M-TOKU75
                               ADD   SYU-KOH2COMPFTN
                                                TO  FTN-KOHI3-M2-TOKU75
                               MOVE  SYU-KOH2COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI3-M3-TOKU75
                               IF  SYU-KOH2SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI3-M-TOKU75
                                                    FTN-KOHI3-M2-TOKU75
                                                    FTN-KOHI3-M3-TOKU75
                               END-IF
                             END-IF
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                             ADD   SYU-KOH3COMPFTN
                                                TO  FTN-KOHI3-M2
                             MOVE  SYU-KOH3COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI3-M3
                             IF  SYU-KOH3SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI3-M
                                                    FTN-KOHI3-M2
                                                    FTN-KOHI3-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH3HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH3HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI3-M-TOKU75
                               ADD   SYU-KOH3COMPFTN
                                                TO  FTN-KOHI3-M2-TOKU75
                               MOVE  SYU-KOH3COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI3-M3-TOKU75
                               IF  SYU-KOH3SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI3-M-TOKU75
                                                    FTN-KOHI3-M2-TOKU75
                                                    FTN-KOHI3-M3-TOKU75
                               END-IF
                             END-IF
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI3-M
                             ADD   SYU-KOH4COMPFTN
                                                TO  FTN-KOHI3-M2
                             MOVE  SYU-KOH4COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI3-M3
                             IF  SYU-KOH4SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI3-M
                                                    FTN-KOHI3-M2
                                                    FTN-KOHI3-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH3HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH3HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI3-M-TOKU75
                               ADD   SYU-KOH4COMPFTN
                                                TO  FTN-KOHI3-M2-TOKU75
                               MOVE  SYU-KOH4COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI3-M3-TOKU75
                               IF  SYU-KOH4SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI3-M-TOKU75
                                                    FTN-KOHI3-M2-TOKU75
                                                    FTN-KOHI3-M3-TOKU75
                               END-IF
                             END-IF
                 END-EVALUATE
               END-IF
             END-IF
           END-IF.
      *    ¸øÈñ£´¥«¥¦¥ó¥È
           IF ((COMB-KOH4HKNNUM          NOT =   SPACE) AND
               (COMB-KOH4-NYUJGNKBN          =   "1"  ))
           OR ( WK-2010-IRYOKEIKBN-N(4)   = "3" OR "4" )
             IF  ( SYU-NYUGAIKBN              =   "1"   )
             OR  ((SYU-NYUGAIKBN              =   "2"  ) AND
                  (FLG-NYUGAI                 =    4   ))
             OR  ((SYU-NYUGAIKBN              =   "2"  ) AND
                  (FLG-NYUGAI2                =    4   ))
               IF   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH4ID))
      *
                 IF   WK-2010-IRYOKEIKBN-N(4)  NOT = SPACE
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-N(4)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH1HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH1COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH1COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(4)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-N(4)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH2HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH2COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH2COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(4)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-N(4)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH3HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH3COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH3COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(4)
                         END-EVALUATE
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM
                         EVALUATE   WK-2010-IRYOKEIKBN-N(4)
                           WHEN       "1"
                           WHEN       "2"
                             MOVE   SYU-JYO-HKNFTNMONEY
                                              TO  SYU-KOH4HKNFTNMONEY
                             MOVE   SYU-JYO-COMPFTN
                                              TO  SYU-KOH4COMPFTN
                             MOVE   SYU-JYO-COMPFTN-ENTANI
                                              TO  SYU-KOH4COMPFTN-ENTANI
                           WHEN       "3"
                           WHEN       "4"
                             ADD    SYU-JYO-HKNFTNMONEY
                                           TO  WK-TAIHI-FTN-KOHI-M(4)
                         END-EVALUATE
                      END-IF
                      IF   WK-2010-IRYOKEIKBN-N(4) = "2"
                         COMPUTE   WK-IRYOKEIKBN-HANTEITEN  =
                                   WK-IRYOKEIKBN-HANTEITEN  +
                                   SYU-TOTAL-HKNTEN
                      END-IF
                 END-IF
      *
                 IF   WK-2010-KINJYOKBN-N(4)  = "1"
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH1HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH1HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH1COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH1COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH1COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH1COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH1COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH2HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH2HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH2COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH2COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH2COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH2COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH2COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH3HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH3HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH3COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH3COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH3COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH3COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH3COMPFTN-ENTANI
                        END-IF
                      END-IF
                      IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM
                        IF  SYU-JYO-HKNFTNMONEY NOT = ZERO
                         COMPUTE  SYU-KOH4HKNFTNMONEY =
                                  SYU-JYO-HKNFTNMONEY -
                                  SYU-KOH4HKNFTNMONEY
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4HKNFTNMONEY
                        END-IF
                        IF  SYU-JYO-COMPFTN     NOT = ZERO
                         COMPUTE  SYU-KOH4COMPFTN     =
                                  SYU-JYO-COMPFTN     -
                                  SYU-KOH4COMPFTN
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN
                        END-IF
                        IF  SYU-JYO-COMPFTN-ENTANI  NOT = ZERO
                         MOVE     SYU-JYO-COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN1
                         MOVE     SYU-KOH4COMPFTN-ENTANI
                                         TO   WK-TOKUSYU-KEISAN-EN2
                         PERFORM  22019-ENTANI-HENSYU2-SEC
                         MOVE     WK-TOKUSYU-KEISAN-EN3
                                         TO   SYU-KOH4COMPFTN-ENTANI
                        ELSE
                         MOVE  ZERO  TO  SYU-KOH4COMPFTN-ENTANI
                        END-IF
                      END-IF
                 END-IF
      *
                 IF   WK-2010-SYOKEI2KBN-N(4) = "1"
                    IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH1HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH1COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH1COMPFTN-ENTANI
                    END-IF
                    IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH2HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH2COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH2COMPFTN-ENTANI
                    END-IF
                    IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH3HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH3COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH3COMPFTN-ENTANI
                    END-IF
                    IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM
                      ADD  SYU-JYO-HKNFTNMONEY TO SYU-KOH4HKNFTNMONEY
                      ADD  SYU-JYO-COMPFTN     TO SYU-KOH4COMPFTN
                      ADD  SYU-JYO-COMPFTN-ENTANI
                                            TO SYU-KOH4COMPFTN-ENTANI
                    END-IF
                 END-IF
      *
                 IF ((WK-1001-PREFNUM          =  44      ) AND
                     (LNK-SYU-KOH4HKNNUM  = "183" OR "283") AND
                     (LNK-SYU-SRYYMD(1:6)     >= "200610" ) AND
                     (LNK-SYU-SRYYMD(1:6)     <  "201010" ))
                 OR ( WK-2010-NINNASIKBN(4)   NOT = SPACE  )
                 OR ( WK-2010-NINJYOKBN(4)    NOT = SPACE  )
                 OR ( WK-2010-NINNASIKBN-K(4) NOT = SPACE  )
                    IF    LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM
                                             OR  SYU-KOH2HKNNUM
                                             OR  SYU-KOH3HKNNUM
                                             OR  SYU-KOH4HKNNUM
                       ADD   SYU-JYO-HKNFTNMONEY
                                      TO  WK-OITA-HKNFTNMONEY
                       ADD   SYU-JYO-COMPFTN
                                      TO  WK-OITA-CYOFTN
                    END-IF
                 END-IF
      *
                 IF   SYU-NYUGAIKBN  =   "1"
                  IF     ((MAX-KIN-KOHI4-D       NOT = ZERO) AND
                          (MAX-KIN-KOHI4-M           = ZERO))
                  OR     ((MAX-KIN-KOHI4-D       NOT = ZERO) AND
                          (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                   PERFORM   VARYING  IDX2  FROM  1  BY  1
                              UNTIL   IDX2   >   31
                     IF ((SYU-DAY(IDX2) = "1" OR "2" OR "8" OR "9") AND
                         (SDAY-HKNTEN(IDX2)          NOT =  ZERO  ))
                     OR ((LNK-S02-NYUINDAY-KBN(IDX2)   =  "1") AND
                         (WK-2010-TANKIKBN(4)          =  "1")     )
                        EVALUATE  TRUE
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH1HKNNUM)
                             IF  KOHI4-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 1)     =  1
                               IF  SYU-KOH1HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI4-TBL(IDX2)
                                 ADD     1      TO    KOHI4-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI4-TBL2(IDX2)
                                 ADD     1      TO    KOHI4-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 1)
                                           TO  FTN-KOHI4-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 1)
                                           TO  FTN-KOHI4-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 1)
                                           TO  FTN-KOHI4-D3(IDX2)
                             IF    SYU-KOH1SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 1)
                                           TO  FTN-KOHI4-D(IDX2)
                                               FTN-KOHI4-D2(IDX2)
                                               FTN-KOHI4-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH2HKNNUM)
                             IF  KOHI4-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 2)     =  1
                               IF  SYU-KOH2HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI4-TBL(IDX2)
                                 ADD     1      TO    KOHI4-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI4-TBL2(IDX2)
                                 ADD     1      TO    KOHI4-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 2)
                                           TO  FTN-KOHI4-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 2)
                                           TO  FTN-KOHI4-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 2)
                                           TO  FTN-KOHI4-D3(IDX2)
                             IF    SYU-KOH2SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 2)
                                           TO  FTN-KOHI4-D(IDX2)
                                               FTN-KOHI4-D2(IDX2)
                                               FTN-KOHI4-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH3HKNNUM)
                             IF  KOHI4-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 3)     =  1
                               IF  SYU-KOH3HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI4-TBL(IDX2)
                                 ADD     1      TO    KOHI4-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI4-TBL2(IDX2)
                                 ADD     1      TO    KOHI4-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 3)
                                           TO  FTN-KOHI4-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 3)
                                           TO  FTN-KOHI4-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 3)
                                           TO  FTN-KOHI4-D3(IDX2)
                             IF    SYU-KOH3SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 3)
                                           TO  FTN-KOHI4-D(IDX2)
                                               FTN-KOHI4-D2(IDX2)
                                               FTN-KOHI4-D3(IDX2)
                             END-IF
                           WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH4HKNNUM)
                             IF  KOHI4-TBL(IDX2)            =  ZERO
                             AND SDAY-SANTEIFLG(IDX2 4)     =  1
                               IF  SYU-KOH4HKNFTNMONEY  NOT =  ZERO
                                 ADD     1      TO    KOHI4-TBL(IDX2)
                                 ADD     1      TO    KOHI4-TBL(32)
                               ELSE
                                 ADD     1      TO    KOHI4-TBL2(IDX2)
                                 ADD     1      TO    KOHI4-TBL2(32)
                               END-IF
                             END-IF
                             ADD   SDAY-FTNMONEY(IDX2 4)
                                           TO  FTN-KOHI4-D(IDX2)
                             ADD   SDAY-COMPFTN(IDX2 4)
                                           TO  FTN-KOHI4-D2(IDX2)
                             ADD   SDAY-COMPFTNWK(IDX2 4)
                                           TO  FTN-KOHI4-D3(IDX2)
                             IF    SYU-KOH4SKJ-FTNKBN  =  "2"
                                ADD  SDAY-SKJFTN(IDX2 4)
                                           TO  FTN-KOHI4-D(IDX2)
                                               FTN-KOHI4-D2(IDX2)
                                               FTN-KOHI4-D3(IDX2)
                             END-IF
                        END-EVALUATE
                     END-IF
                   END-PERFORM
                  END-IF
                 END-IF
      *
                 IF   SYU-NYUGAIKBN  =   "2"
                  IF     ((MAX-KIN-KOHI4-D       NOT = ZERO) AND
                          (MAX-KIN-KOHI4-M           = ZERO))
                  OR     ((MAX-KIN-KOHI4-D       NOT = ZERO) AND
                          (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                    EVALUATE  TRUE
                      WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH1HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI4-TBL(IDX10)         = ZERO
                         AND SYU-KOH1HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI4-TBL(IDX10)
                            ADD   1   TO  KOHI4-TBL(32)
                         END-IF
                         ADD   SYU-KOH1HKNFTNMONEY
                                      TO  FTN-KOHI4-D(IDX10)
                         ADD   SYU-KOH1COMPFTN
                                      TO  FTN-KOHI4-D2(IDX10)
                         MOVE  SYU-KOH1COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI4-D3(IDX10)
                      WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH2HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI4-TBL(IDX10)         = ZERO
                         AND SYU-KOH2HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI4-TBL(IDX10)
                            ADD   1   TO  KOHI4-TBL(32)
                         END-IF
                         ADD   SYU-KOH2HKNFTNMONEY
                                      TO  FTN-KOHI4-D(IDX10)
                         ADD   SYU-KOH2COMPFTN
                                      TO  FTN-KOHI4-D2(IDX10)
                         MOVE  SYU-KOH2COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI4-D3(IDX10)
                      WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH3HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI4-TBL(IDX10)         = ZERO
                         AND SYU-KOH3HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI4-TBL(IDX10)
                            ADD   1   TO  KOHI4-TBL(32)
                         END-IF
                         ADD   SYU-KOH3HKNFTNMONEY
                                      TO  FTN-KOHI4-D(IDX10)
                         ADD   SYU-KOH3COMPFTN
                                      TO  FTN-KOHI4-D2(IDX10)
                         MOVE  SYU-KOH3COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI4-D3(IDX10)
                      WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH4HKNNUM)
                         MOVE  SYU-SRYYMD(7:2)  TO  IDX10X
                         IF  KOHI4-TBL(IDX10)         = ZERO
                         AND SYU-KOH4HKNFTNMONEY  NOT = ZERO
                            ADD   1   TO  KOHI4-TBL(IDX10)
                            ADD   1   TO  KOHI4-TBL(32)
                         END-IF
                         ADD   SYU-KOH4HKNFTNMONEY
                                      TO  FTN-KOHI4-D(IDX10)
                         ADD   SYU-KOH4COMPFTN
                                      TO  FTN-KOHI4-D2(IDX10)
                         MOVE  SYU-KOH4COMPFTN-ENTANI
                                      TO  WK-ENTANI
                         PERFORM  22018-ENTANI-HENSYU-SEC
                         ADD   WK-ENTANI
                                      TO  FTN-KOHI4-D3(IDX10)
                    END-EVALUATE
                  END-IF
                 END-IF
      *
                 EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH1HKNNUM)
                             ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                             ADD   SYU-KOH1COMPFTN
                                                TO  FTN-KOHI4-M2
                             MOVE  SYU-KOH1COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI4-M3
                             IF  SYU-KOH1SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI4-M
                                                    FTN-KOHI4-M2
                                                    FTN-KOHI4-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH4HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH4HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH1HKNFTNMONEY
                                                TO  FTN-KOHI4-M-TOKU75
                               ADD   SYU-KOH1COMPFTN
                                                TO  FTN-KOHI4-M2-TOKU75
                               MOVE  SYU-KOH1COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI4-M3-TOKU75
                               IF  SYU-KOH1SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH1SKJ-FTN
                                                TO  FTN-KOHI4-M-TOKU75
                                                    FTN-KOHI4-M2-TOKU75
                                                    FTN-KOHI4-M3-TOKU75
                               END-IF
                             END-IF
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH2HKNNUM)
                             ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                             ADD   SYU-KOH2COMPFTN
                                                TO  FTN-KOHI4-M2
                             MOVE  SYU-KOH2COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI4-M3
                             IF  SYU-KOH2SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI4-M
                                                    FTN-KOHI4-M2
                                                    FTN-KOHI4-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH4HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH4HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH2HKNFTNMONEY
                                                TO  FTN-KOHI4-M-TOKU75
                               ADD   SYU-KOH2COMPFTN
                                                TO  FTN-KOHI4-M2-TOKU75
                               MOVE  SYU-KOH2COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI4-M3-TOKU75
                               IF  SYU-KOH2SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH2SKJ-FTN
                                                TO  FTN-KOHI4-M-TOKU75
                                                    FTN-KOHI4-M2-TOKU75
                                                    FTN-KOHI4-M3-TOKU75
                               END-IF
                             END-IF
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH3HKNNUM)
                             ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                             ADD   SYU-KOH3COMPFTN
                                                TO  FTN-KOHI4-M2
                             MOVE  SYU-KOH3COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI4-M3
                             IF  SYU-KOH3SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI4-M
                                                    FTN-KOHI4-M2
                                                    FTN-KOHI4-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH4HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH4HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH3HKNFTNMONEY
                                                TO  FTN-KOHI4-M-TOKU75
                               ADD   SYU-KOH3COMPFTN
                                                TO  FTN-KOHI4-M2-TOKU75
                               MOVE  SYU-KOH3COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI4-M3-TOKU75
                               IF  SYU-KOH3SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH3SKJ-FTN
                                                TO  FTN-KOHI4-M-TOKU75
                                                    FTN-KOHI4-M2-TOKU75
                                                    FTN-KOHI4-M3-TOKU75
                               END-IF
                             END-IF
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH4HKNNUM)
                             ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI4-M
                             ADD   SYU-KOH4COMPFTN
                                                TO  FTN-KOHI4-M2
                             MOVE  SYU-KOH4COMPFTN-ENTANI
                                                TO  WK-ENTANI
                             PERFORM  22018-ENTANI-HENSYU-SEC
                             ADD   WK-ENTANI    TO  FTN-KOHI4-M3
                             IF  SYU-KOH4SKJ-FTNKBN  =  "2"
                               ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI4-M
                                                    FTN-KOHI4-M2
                                                    FTN-KOHI4-M3
                             END-IF
                             IF  ( FLG-RUITAISYO           =  1   )
                             AND ((LNK-SYU-KOH4HKNNUM(1:1) = "0" ) OR
                                  (LNK-SYU-KOH4HKNNUM = "972"
                                                     OR "974"    ))
                               ADD   SYU-KOH4HKNFTNMONEY
                                                TO  FTN-KOHI4-M-TOKU75
                               ADD   SYU-KOH4COMPFTN
                                                TO  FTN-KOHI4-M2-TOKU75
                               MOVE  SYU-KOH4COMPFTN-ENTANI
                                                TO  WK-ENTANI
                               PERFORM  22018-ENTANI-HENSYU-SEC
                               ADD   WK-ENTANI  TO  FTN-KOHI4-M3-TOKU75
                               IF  SYU-KOH4SKJ-FTNKBN  =  "2"
                                 ADD   SYU-KOH4SKJ-FTN
                                                TO  FTN-KOHI4-M-TOKU75
                                                    FTN-KOHI4-M2-TOKU75
                                                    FTN-KOHI4-M3-TOKU75
                               END-IF
                             END-IF
                 END-EVALUATE
               END-IF
             END-IF
           END-IF.
      *
       2201-SYUNOU-COUNT-EXT.
           EXIT.
      *
      ******************************************************************
      *    £·£°ºÐÌ¤Ëþ¸½ÊªµëÉÕ¤Î¼çÊÝ¸±Ê¬ÊÔ½¸
      ******************************************************************
       22011-GEN70-SYU-HENSYU-SEC          SECTION.
      *
           IF  ((COMB-KOH1HKNNUM    = SPACE OR "970") AND
                (COMB-KOH2HKNNUM    = SPACE         ) AND
                (COMB-KOH3HKNNUM    = SPACE         ) AND
                (COMB-KOH4HKNNUM    = SPACE         ))
           OR  ((COMB-KOH1HKNNUM    = "092"         ) AND
                (WK-KOHJGNGET-CHECK092(1) =   1     ) AND
                (COMB-KOH2HKNNUM    = SPACE         ) AND
                (COMB-KOH3HKNNUM    = SPACE         ) AND
                (COMB-KOH4HKNNUM    = SPACE         ))
             IF   ((SYU-KOH1HKNNUM  = SPACE OR "970") AND
                   (SYU-KOH2HKNNUM  = SPACE         ) AND
                   (SYU-KOH3HKNNUM  = SPACE         ) AND
                   (SYU-KOH4HKNNUM  = SPACE         ))
             OR   ((SYU-KOH1HKNNUM  = "092"         ) AND
                   (SYU-NYNSHOKAISU =  7            ) AND
                   (SYU-KOH2HKNNUM  = SPACE         ) AND
                   (SYU-KOH3HKNNUM  = SPACE         ) AND
                   (SYU-KOH4HKNNUM  = SPACE         ))
               IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                 MOVE  SYU-SYUCOMPFTN TO  WK-SYU-SYUCOMPFTN
                 MOVE  SYU-SYUCOMPFTN-ENTANI  TO  WK-ENTANI
                 PERFORM  22018-ENTANI-HENSYU-SEC
                 IF    FLG-IRYOHI70  =  1 OR 2 OR  7 OR  8
                                    OR  5 OR 6 OR 11 OR 12
                   COMPUTE   WK-KOUREI-IRYOHI70  =
                             WK-KOUREI-IRYOHI70  +
                            (SYU-HKNTEN (17) * 10)
                 END-IF
                 COMPUTE     WK-GENBUTU-HKNKIN   =
                             WK-GENBUTU-HKNKIN   +
                            (SYU-HKNTEN (17) * 10)
                 MOVE   ZERO  TO  FLG-TAISYO
               ELSE
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               END-IF
             ELSE
               MOVE   ZERO   TO   FLG-HANBETU2
               IF  (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
               AND (LNK-SYU-SRYYMD(1:6)  >=  "201204" )
                 PERFORM  220111-GEN70-KOH-CHECK-SEC
               END-IF
               IF ((SYU-KOHTAIYKZKBN =   "9"          ) AND
                   (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL))
               OR ((SYU-KOH1HKNNUM   = "972" OR "974" ) AND
                   (SYU-KOH2HKNNUM   = SPACE          ) AND
                   (SYU-KOH3HKNNUM   = SPACE          ) AND
                   (SYU-KOH4HKNNUM   = SPACE          ) AND
                   (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL))
               OR ((SYU-KOH1HKNNUM   = "092"          ) AND
                   (SYU-NYNSHOKAISU  =  7             ) AND
                   (SYU-KOH2HKNNUM   = "972" OR "974" ) AND
                   (SYU-KOH3HKNNUM   = SPACE          ) AND
                   (SYU-KOH4HKNNUM   = SPACE          ) AND
                   (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL))
               OR ((SYU-SKJ-FTNGAKU(3) =  9           ) AND
                   (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL) AND
                   (LNK-SYU-SRYYMD(1:6)  >=  "201204" ))
               OR ( FLG-HANBETU2     =    1  OR  9     )
                 MOVE  SYU-KOH-FTN    TO  WK-SYU-SYUCOMPFTN
                 MOVE  SYU-KOH-FTN-ENTANI  TO  WK-ENTANI
                 PERFORM  22018-ENTANI-HENSYU-SEC
                 IF    FLG-IRYOHI70  =  1 OR 2 OR  7 OR  8
                                    OR  5 OR 6 OR 11 OR 12
                   COMPUTE   WK-KOUREI-IRYOHI70  =
                             WK-KOUREI-IRYOHI70  +
                            (SYU-HKNTEN (17) * 10)
                 END-IF
                 IF ((SYU-KOH1HKNNUM   = "972" OR "974") AND
                     (SYU-KOH2HKNNUM   = SPACE         ) AND
                     (SYU-KOH3HKNNUM   = SPACE         ) AND
                     (SYU-KOH4HKNNUM   = SPACE         ))
                 OR ((SYU-KOH1HKNNUM   = "092"         ) AND
                     (SYU-NYNSHOKAISU  =  7            ) AND
                     (SYU-KOH2HKNNUM   = "972" OR "974") AND
                     (SYU-KOH3HKNNUM   = SPACE         ) AND
                     (SYU-KOH4HKNNUM   = SPACE         ))
                 OR ((SYU-SKJ-FTNGAKU(3)   =  9      ) AND
                     (LNK-SYU-SRYYMD(1:6) >= "201204"))
                 OR ( FLG-HANBETU2   =  9             )
                    COMPUTE     WK-GENBUTU-HKNKIN   =
                                WK-GENBUTU-HKNKIN   +
                               (SYU-HKNTEN (17) * 10)
                 END-IF
                 MOVE   ZERO  TO  FLG-TAISYO
               ELSE
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               END-IF
             END-IF
           ELSE
             IF   ((SYU-KOH1HKNNUM  = SPACE OR "970") AND
                   (SYU-KOH2HKNNUM  = SPACE         ) AND
                   (SYU-KOH3HKNNUM  = SPACE         ) AND
                   (SYU-KOH4HKNNUM  = SPACE         ))
             OR   ((SYU-KOH1HKNNUM  = "092"         ) AND
                   (SYU-NYNSHOKAISU =  7            ) AND
                   (SYU-KOH2HKNNUM  = SPACE         ) AND
                   (SYU-KOH3HKNNUM  = SPACE         ) AND
                   (SYU-KOH4HKNNUM  = SPACE         ))
               IF   WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                 MOVE   ZERO   TO   FLG-HANBETU2
                 IF  (LNK-SYU-SRYYMD(1:6)  >=  "201204"  )
                 AND (WK-SYUNOU-GENBUTU70T-HANTEIFLG =  1)
                   PERFORM  220112-GEN70-KOH-CHECK2-SEC
                 END-IF
                 IF ((LNK-SYU-KOH1HKNNUM = "972" OR "974") AND
                     (LNK-SYU-KOH2HKNNUM = SPACE         ) AND
                     (LNK-SYU-KOH3HKNNUM = SPACE         ) AND
                     (LNK-SYU-KOH4HKNNUM = SPACE         ))
                 OR ((LNK-SYU-KOH1HKNNUM = "092"         ) AND
                     (WK-KOHJGNGET-CHECK092(1) = 1       ) AND
                     (LNK-SYU-KOH2HKNNUM = "972" OR "974") AND
                     (LNK-SYU-KOH3HKNNUM = SPACE         ) AND
                     (LNK-SYU-KOH4HKNNUM = SPACE         ))
                   MOVE   ZERO   TO   FLG-HANBETU2
                 END-IF
                 IF  (LNK-SYU-SKJ-FTNGAKU(3) =   9      )
                 AND (LNK-SYU-SRYYMD(1:6)   >=  "201204")
                   MOVE   1      TO   FLG-HANBETU2
                 END-IF
                 IF   FLG-HANBETU2  =   1
                   MOVE  SYU-SYUCOMPFTN TO  WK-SYU-SYUCOMPFTN
                   MOVE  SYU-SYUCOMPFTN-ENTANI  TO  WK-ENTANI
                   PERFORM  22018-ENTANI-HENSYU-SEC
                   IF    FLG-IRYOHI70  =  3 OR  4 OR  5 OR  6
                                       OR 9 OR 10 OR 11 OR 12
                     COMPUTE   WK-KOUREI-IRYOHI70  =
                               WK-KOUREI-IRYOHI70  +
                              (SYU-HKNTEN (17) * 10)
                   END-IF
                   MOVE   ZERO  TO  FLG-TAISYO
                 ELSE
                   MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                   MOVE   ZERO  TO  WK-ENTANI
                   MOVE   1     TO  FLG-TAISYO
                 END-IF
               ELSE
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               END-IF
             ELSE
               IF WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL
                 IF    FLG-MARUKO  =  ZERO
                      IF  (LNK-SYU-KOH1HKNNUM
                                           = "015" OR "016" OR "021")
                      AND (WK-JIRITU-CYUKANSOU(1)   =  1            )
                      AND (LNK-SYU-KOH2HKNNUM  NOT = "972" AND "974")
                      AND (LNK-SYU-KOH3HKNNUM  NOT = "972" AND "974")
                      AND (LNK-SYU-KOH4HKNNUM  NOT = "972" AND "974")
                      AND (SYU-NYNSHOKAISU          =  1            )
                      AND (SYU-KOH2HKNNUM      NOT = "972" AND "974")
                      AND (SYU-KOH3HKNNUM      NOT = "972" AND "974")
                      AND (SYU-KOH4HKNNUM      NOT = "972" AND "974")
                      AND (LNK-SYU-KOH1HKNNUM      =  SYU-KOH1HKNNUM)
                        IF   FLG-IRYOHI70     =  5 OR 6 OR 11 OR 12
                          COMPUTE  WK-KOUREI-IRYOHI70  =
                                   WK-KOUREI-IRYOHI70  +
                                  (SYU-HKNTEN (17) * 10)
                          MOVE   1   TO  FLG-SYUKEI
                        END-IF
                        IF   FLG-IRYOHI70K  =  2
                          COMPUTE  WK-KOUREI-IRYOHI70K =
                                   WK-KOUREI-IRYOHI70K +
                                  (SYU-HKNTEN (17) * 10)
                          IF   FLG-RUITAISYO  =  1
                             COMPUTE  WK-KOUREI-IRYOHI70K-TOKU75 =
                                      WK-KOUREI-IRYOHI70K-TOKU75 +
                                     (SYU-HKNTEN (17) * 10)
                          END-IF
                          MOVE   1   TO  FLG-SYUKEI3
                        END-IF
                      END-IF
                      IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                           (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                           (COMB-KOH4HKNNUM   =  "972" OR "974"))
                      AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
                      AND ( SYU-KOH2HKNNUM    =   SPACE         )
                      AND ( SYU-KOH3HKNNUM    =   SPACE         )
                      AND ( SYU-KOH4HKNNUM    =   SPACE         )
                      AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                         MOVE    ZERO            TO  WK-SYU-SYUCOMPFTN
                         MOVE    ZERO            TO  WK-ENTANI
                         MOVE    1               TO  FLG-TAISYO
                      ELSE
                         MOVE    SYU-KOH-FTN     TO  WK-SYU-SYUCOMPFTN
                         MOVE    SYU-KOH-FTN-ENTANI  TO  WK-ENTANI
                         PERFORM 22018-ENTANI-HENSYU-SEC
                         MOVE    ZERO            TO  FLG-TAISYO
                      END-IF
                      IF  ( FLG-TOKYO           =  1    )
                      AND ((COMB-KOH2HKNNUM     = "974") OR
                           (COMB-KOH3HKNNUM     = "974") OR
                           (COMB-KOH4HKNNUM     = "974"))
                      AND ( COMB-KOH1HKNNUM NOT =
                                         SYU-KOH1HKNNUM )
                         MOVE    ZERO            TO  WK-SYU-SYUCOMPFTN
                         MOVE    ZERO            TO  WK-ENTANI
                         MOVE    1               TO  FLG-TAISYO
                      END-IF
                 ELSE
                   IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
                   OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
                   OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
                   OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                       (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                     MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                     MOVE   ZERO  TO  WK-ENTANI
                     MOVE   1     TO  FLG-TAISYO
                   ELSE
                     MOVE  SYU-KOH-FTN    TO  WK-SYU-SYUCOMPFTN
                     MOVE  SYU-KOH-FTN-ENTANI  TO  WK-ENTANI
                     PERFORM  22018-ENTANI-HENSYU-SEC
                     MOVE   ZERO  TO  FLG-TAISYO
                   END-IF
                 END-IF
               ELSE
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               END-IF
             END-IF
           END-IF
           ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
           ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
      *
           IF   FLG-GENBUTU-CHECK-ERR  =  1
                 MOVE   43    TO  LNK-S02-RC
           END-IF
      *
           .
      *
       22011-GEN70-SYU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    £·£°ºÐÌ¤Ëþ¸½ÊªµëÉÕ¤Î¸øÈñÊ»ÍÑÊ¬¹ç»»ÂÐ¾Ý¥Á¥§¥Ã¥¯
      ******************************************************************
       220111-GEN70-KOH-CHECK-SEC          SECTION.
      *
           PERFORM VARYING IDX13  FROM   1   BY   1
                    UNTIL (IDX13   >    50                       )
                     OR   (WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                                                          = SPACE)
             IF    SYU-HKNCOMBINUM =
                         WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
               IF    WK-SYUNOU-GENBUTU70-GASSANFLG(IDX13) =  9
                   MOVE  9   TO  FLG-HANBETU2
               ELSE
                 IF  WK-SYUNOU-GENBUTU70-HANTEIFLG(IDX13) =  1
                   MOVE  1   TO  FLG-HANBETU2
                 END-IF
               END-IF
               MOVE    50    TO  IDX13
             END-IF
           END-PERFORM
      *
           .
      *
       220111-GEN70-KOH-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *    £·£°ºÐÌ¤Ëþ¸½ÊªµëÉÕ¤Î¸øÈñÊ»ÍÑÊ¬¹ç»»ÂÐ¾Ý¥Á¥§¥Ã¥¯£²
      ******************************************************************
       220112-GEN70-KOH-CHECK2-SEC          SECTION.
      *
           MOVE     ZERO      TO     FLG-HANBETU
           PERFORM VARYING IDX13  FROM   1   BY   1
                    UNTIL (IDX13   >    50                       )
                     OR   (WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                                                          = SPACE)
             IF    LNK-SYU-HKNCOMBINUM =
                         WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
               ADD   LNK-SYU-TOTAL-HKNTEN  TO
                           WK-SYUNOU-GENBUTU70-TOTALTEN(IDX13)
               MOVE  1                 TO  FLG-HANBETU
               MOVE  50                TO  IDX13
             END-IF
           END-PERFORM
           IF   FLG-HANBETU   =   ZERO
               MOVE  LNK-SYU-HKNCOMBINUM   TO
                           WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
               ADD   LNK-SYU-TOTAL-HKNTEN  TO
                           WK-SYUNOU-GENBUTU70-TOTALTEN(IDX13)
           END-IF
      *
           PERFORM   VARYING   IDX13   FROM   1   BY   1
                      UNTIL   (IDX13     >   50                      )
                        OR    (WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
                                                              = SPACE)
             IF    LNK-SYU-HKNCOMBINUM =
                         WK-SYUNOU-GENBUTU70-HKNCOMBINUM(IDX13)
               COMPUTE  WK-FUTANWARI  =  WK-SYUNOU-GENBUTU70-FTNRATE
                                      /  100
               COMPUTE  WK-SYUNOU-GENBUTU70-KEISAN
                          =  WK-SYUNOU-GENBUTU70-TOTALTEN(IDX13)
                          *  10
                          *  WK-FUTANWARI
               IF  FLG-TOKU75  =  3
                 IF  WK-SYUNOU-GENBUTU70-KEISAN >= 10500
                   MOVE  1  TO  FLG-HANBETU2
                 END-IF
               ELSE
                 IF  WK-SYUNOU-GENBUTU70-KEISAN >= 21000
                   MOVE  1  TO  FLG-HANBETU2
                 END-IF
               END-IF
               MOVE         50     TO   IDX13
             END-IF
           END-PERFORM
      *
           .
      *
       220112-GEN70-KOH-CHECK2-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¹âÎð¼Ô¤Î¼çÊÝ¸±Ê¬ÊÔ½¸
      ******************************************************************
       22012-KOUREI-SYU-HENSYU-SEC          SECTION.
      *
           IF     COMB-HKNNUM     = "039"
             IF   (SYU-SYUHKNNUM    =  "039"         )
             AND  (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
               IF   ((SYU-KOH1HKNNUM  = SPACE OR "970") AND
                     (SYU-KOH2HKNNUM  = SPACE         ) AND
                     (SYU-KOH3HKNNUM  = SPACE         ) AND
                     (SYU-KOH4HKNNUM  = SPACE         ))
               OR   ((SYU-KOH1HKNNUM  = "092"         ) AND
                     (SYU-NYNSHOKAISU =  7            ) AND
                     (SYU-KOH2HKNNUM  = SPACE         ) AND
                     (SYU-KOH3HKNNUM  = SPACE         ) AND
                     (SYU-KOH4HKNNUM  = SPACE         ))
                    MOVE    SYU-SYUCOMPFTN  TO  WK-SYU-SYUCOMPFTN
                    MOVE    SYU-SYUCOMPFTN-ENTANI  TO  WK-ENTANI
                    PERFORM 22018-ENTANI-HENSYU-SEC
                    MOVE    ZERO            TO  FLG-TAISYO
                    IF ((COMB-KOH1HKNNUM  = "972" OR "974") AND
                        (COMB-KOH2HKNNUM  = SPACE         ) AND
                        (COMB-KOH3HKNNUM  = SPACE         ) AND
                        (COMB-KOH4HKNNUM  = SPACE         ))
                    OR ((COMB-KOH1HKNNUM  = "092"         ) AND
                        (WK-KOHJGNGET-CHECK092(1) =   1   ) AND
                        (COMB-KOH2HKNNUM  = "972" OR "974") AND
                        (COMB-KOH3HKNNUM  = SPACE         ) AND
                        (COMB-KOH4HKNNUM  = SPACE         ))
                      MOVE  ZERO            TO  WK-SYU-SYUCOMPFTN
                      MOVE  ZERO            TO  WK-ENTANI
                      MOVE  1               TO  FLG-TAISYO
                    END-IF
               ELSE
                 IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                      (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                      (COMB-KOH4HKNNUM   =  "972" OR "974"))
                 AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
                 AND ( SYU-KOH2HKNNUM    =   SPACE         )
                 AND ( SYU-KOH3HKNNUM    =   SPACE         )
                 AND ( SYU-KOH4HKNNUM    =   SPACE         )
                 AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                    MOVE    ZERO            TO  WK-SYU-SYUCOMPFTN
                    MOVE    ZERO            TO  WK-ENTANI
                    MOVE    1               TO  FLG-TAISYO
                 ELSE
                    MOVE    SYU-KOH-FTN     TO  WK-SYU-SYUCOMPFTN
                    MOVE    SYU-KOH-FTN-ENTANI  TO  WK-ENTANI
                    PERFORM 22018-ENTANI-HENSYU-SEC
                    MOVE    ZERO            TO  FLG-TAISYO
                 END-IF
               END-IF
               ADD   WK-SYU-SYUCOMPFTN   TO  FTN-SYU-M
               ADD   WK-ENTANI           TO  FTN-SYU-M-ENTANI
               IF  (((COMB-KOH1HKNNUM  =  SPACE OR "970") AND
                     (COMB-KOH2HKNNUM  =  SPACE         ) AND
                     (COMB-KOH3HKNNUM  =  SPACE         ) AND
                     (COMB-KOH4HKNNUM  =  SPACE         ))  OR
                    ((COMB-KOH1HKNNUM  =  "092"         ) AND
                     (WK-KOHJGNGET-CHECK092(1) =   1    ) AND
                     (COMB-KOH2HKNNUM  =  SPACE         ) AND
                     (COMB-KOH3HKNNUM  =  SPACE         ) AND
                     (COMB-KOH4HKNNUM  =  SPACE         )))
               AND (((SYU-KOH1HKNNUM   =  SPACE OR "970") AND
                     (SYU-KOH2HKNNUM   =  SPACE         ) AND
                     (SYU-KOH3HKNNUM   =  SPACE         ) AND
                     (SYU-KOH4HKNNUM   =  SPACE         ))  OR
                    ((SYU-KOH1HKNNUM   = "092"          ) AND
                     (SYU-NYNSHOKAISU  =  7             ) AND
                     (SYU-KOH2HKNNUM   = SPACE          ) AND
                     (SYU-KOH3HKNNUM   = SPACE          ) AND
                     (SYU-KOH4HKNNUM   = SPACE          )))
               AND (( FLG-IRYOHI       NOT =  ZERO       )  OR
                    ( FLG-IRYOHIKG     NOT =  ZERO       )  OR
                    ( FLG-IRYOHIKG2    NOT =  ZERO       ))
                   COMPUTE   WK-KOUREI-IRYOHI  =
                             WK-KOUREI-IRYOHI  +
                            (SYU-HKNTEN (17)   * 10)
               END-IF
             ELSE
               MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
               MOVE   ZERO    TO    WK-ENTANI
               MOVE   1       TO    FLG-TAISYO
             END-IF
           ELSE
             IF    LNK-SYU-SRYYMD(1:6)  >= "200804"
               IF   (SYU-SYUHKNNUM   NOT =  "039"      )
               AND  (WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
                 IF   ((SYU-KOH1HKNNUM  = SPACE OR "970") AND
                       (SYU-KOH2HKNNUM  = SPACE         ) AND
                       (SYU-KOH3HKNNUM  = SPACE         ) AND
                       (SYU-KOH4HKNNUM  = SPACE         ))
                 OR   ((SYU-KOH1HKNNUM  = "092"         ) AND
                       (SYU-NYNSHOKAISU =  7            ) AND
                       (SYU-KOH2HKNNUM  = SPACE         ) AND
                       (SYU-KOH3HKNNUM  = SPACE         ) AND
                       (SYU-KOH4HKNNUM  = SPACE         ))
                      MOVE    SYU-SYUCOMPFTN  TO  WK-SYU-SYUCOMPFTN
                      MOVE    SYU-SYUCOMPFTN-ENTANI  TO  WK-ENTANI
                      PERFORM 22018-ENTANI-HENSYU-SEC
                      MOVE    ZERO            TO  FLG-TAISYO
                      IF ((COMB-KOH1HKNNUM  = "972" OR "974") AND
                          (COMB-KOH2HKNNUM  = SPACE         ) AND
                          (COMB-KOH3HKNNUM  = SPACE         ) AND
                          (COMB-KOH4HKNNUM  = SPACE         ))
                      OR ((COMB-KOH1HKNNUM  = "092"         ) AND
                          (WK-KOHJGNGET-CHECK092(1) =   1   ) AND
                          (COMB-KOH2HKNNUM  = "972" OR "974") AND
                          (COMB-KOH3HKNNUM  = SPACE         ) AND
                          (COMB-KOH4HKNNUM  = SPACE         ))
                        MOVE  ZERO            TO  WK-SYU-SYUCOMPFTN
                        MOVE  ZERO            TO  WK-ENTANI
                        MOVE  1               TO  FLG-TAISYO
                      END-IF
                 ELSE
                   IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                        (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                        (COMB-KOH4HKNNUM   =  "972" OR "974"))
                   AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
                   AND ( SYU-KOH2HKNNUM    =   SPACE         )
                   AND ( SYU-KOH3HKNNUM    =   SPACE         )
                   AND ( SYU-KOH4HKNNUM    =   SPACE         )
                   AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                      MOVE    ZERO            TO  WK-SYU-SYUCOMPFTN
                      MOVE    ZERO            TO  WK-ENTANI
                      MOVE    1               TO  FLG-TAISYO
                   ELSE
                      MOVE    SYU-KOH-FTN     TO  WK-SYU-SYUCOMPFTN
                      MOVE    SYU-KOH-FTN-ENTANI  TO  WK-ENTANI
                      PERFORM 22018-ENTANI-HENSYU-SEC
                      MOVE    ZERO            TO  FLG-TAISYO
                   END-IF
                 END-IF
                 ADD   WK-SYU-SYUCOMPFTN   TO  FTN-SYU-M
                 ADD   WK-ENTANI           TO  FTN-SYU-M-ENTANI
                 IF  (((COMB-KOH1HKNNUM  =  SPACE OR "970") AND
                       (COMB-KOH2HKNNUM  =  SPACE         ) AND
                       (COMB-KOH3HKNNUM  =  SPACE         ) AND
                       (COMB-KOH4HKNNUM  =  SPACE         ))  OR
                      ((COMB-KOH1HKNNUM  =  "092"         ) AND
                       (WK-KOHJGNGET-CHECK092(1) =   1    ) AND
                       (COMB-KOH2HKNNUM  =  SPACE         ) AND
                       (COMB-KOH3HKNNUM  =  SPACE         ) AND
                       (COMB-KOH4HKNNUM  =  SPACE         )))
                 AND (((SYU-KOH1HKNNUM   =  SPACE OR "970") AND
                       (SYU-KOH2HKNNUM   =  SPACE         ) AND
                       (SYU-KOH3HKNNUM   =  SPACE         ) AND
                       (SYU-KOH4HKNNUM   =  SPACE         ))  OR
                      ((SYU-KOH1HKNNUM   = "092"          ) AND
                       (SYU-NYNSHOKAISU  =  7             ) AND
                       (SYU-KOH2HKNNUM   = SPACE          ) AND
                       (SYU-KOH3HKNNUM   = SPACE          ) AND
                       (SYU-KOH4HKNNUM   = SPACE          )))
                 AND (( FLG-IRYOHI       NOT =  ZERO       )  OR
                      ( FLG-IRYOHIKG     NOT =  ZERO       )  OR
                      ( FLG-IRYOHIKG2    NOT =  ZERO       ))
                     COMPUTE   WK-KOUREI-IRYOHI  =
                               WK-KOUREI-IRYOHI  +
                              (SYU-HKNTEN (17)   * 10)
                 END-IF
               ELSE
                 MOVE   ZERO    TO    WK-SYU-SYUCOMPFTN
                 MOVE   ZERO    TO    WK-ENTANI
                 MOVE   1       TO    FLG-TAISYO
               END-IF
             ELSE
               IF  (SYU-KOH1HKNNUM     NOT = SPACE)
               OR  (SYU-KOH2HKNNUM     NOT = SPACE)
               OR  (SYU-KOH3HKNNUM     NOT = SPACE)
               OR  (SYU-KOH4HKNNUM     NOT = SPACE)
                 MOVE    SYU-KOH-FTN     TO  WK-SYU-SYUCOMPFTN
                 MOVE    SYU-KOH-FTN-ENTANI  TO  WK-ENTANI
                 PERFORM 22018-ENTANI-HENSYU-SEC
               ELSE
                 MOVE    SYU-SYUCOMPFTN  TO  WK-SYU-SYUCOMPFTN
                 MOVE    SYU-SYUCOMPFTN-ENTANI  TO  WK-ENTANI
                 PERFORM 22018-ENTANI-HENSYU-SEC
               END-IF
               ADD   WK-SYU-SYUCOMPFTN   TO  FTN-SYU-M
               ADD   WK-ENTANI           TO  FTN-SYU-M-ENTANI
               IF  ( COMB-KOH1HKNNUM        =    SPACE)
               AND ( COMB-KOH2HKNNUM        =    SPACE)
               AND ( COMB-KOH3HKNNUM        =    SPACE)
               AND ( COMB-KOH4HKNNUM        =    SPACE)
               AND ( SYU-KOH1HKNNUM         =    SPACE)
               AND ( SYU-KOH2HKNNUM         =    SPACE)
               AND ( SYU-KOH3HKNNUM         =    SPACE)
               AND ( SYU-KOH4HKNNUM         =    SPACE)
               AND ( FLG-IRYOHI         NOT =    ZERO )
                   COMPUTE   WK-KOUREI-IRYOHI  =
                             WK-KOUREI-IRYOHI  +
                            (SYU-HKNTEN (17)   * 10)
               END-IF
             END-IF
           END-IF
      *
           IF   FLG-GENBUTU-CHECK-ERR  =  1
                 MOVE   43    TO  LNK-S02-RC
           END-IF
      *
           .
      *
       22012-KOUREI-SYU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    Ä¹´ü¤ÎÉéÃ´ÊÔ½¸
      ******************************************************************
       22013-CYOKI-FTN-HENSYU-SEC          SECTION.
      *
           COMPUTE WK-CYOKI        =  WK-CYOKI
                                   +  SYU-KOH-FTN
           MOVE    SYU-KOH-FTN-ENTANI  TO  WK-ENTANI
           PERFORM    22018-ENTANI-HENSYU-SEC
           ADD     WK-ENTANI           TO  WK-CYOKI-ENTANI
      *
           IF  (LNK-SYU-SRYYMD(1:6) >=  "200604"       )
           AND (SYU-KOH1HKNNUM   NOT =  "015" AND "016"
                                              AND "024")
           AND (SYU-KOH2HKNNUM   NOT =  "015" AND "016"
                                              AND "024")
              ADD   SYU-KOH-FTN  TO  FTN-CYOKI-M-JI
              ADD   SYU-KOH-FTN  TO  FTN-CYOKI-M2-JI
              MOVE  SYU-KOH-FTN-ENTANI  TO  WK-ENTANI
              PERFORM  22018-ENTANI-HENSYU-SEC
              ADD   WK-ENTANI           TO  FTN-CYOKI-M3-JI
           END-IF
      *
           IF   FLG-RUITAISYO  =  1
             COMPUTE WK-CYOKI-TOKU75 =  WK-CYOKI-TOKU75
                                     +  SYU-KOH-FTN
             MOVE  SYU-KOH-FTN-ENTANI  TO  WK-ENTANI
             PERFORM  22018-ENTANI-HENSYU-SEC
             ADD   WK-ENTANI           TO  WK-CYOKI-ENTANI-TOKU75
      *
             IF  (SYU-KOH1HKNNUM   NOT =  "015" AND "016"
                                                AND "024")
                ADD   SYU-KOH-FTN  TO  FTN-CYOKI-M-JI-TOKU75
                ADD   SYU-KOH-FTN  TO  FTN-CYOKI-M2-JI-TOKU75
                MOVE  SYU-KOH-FTN-ENTANI  TO  WK-ENTANI
                PERFORM  22018-ENTANI-HENSYU-SEC
                ADD   WK-ENTANI           TO  FTN-CYOKI-M3-JI-TOKU75
             END-IF
           END-IF
      *
           IF    LNK-SYU-SRYYMD(1:6)   >=  "202001"
             IF    WK-HKNJANUM-TBL = WK-HKNJANUM2-TBL
               COMPUTE WK-FUTANWARI =
                       WK-SYUNOU-GENBUTU70-FTNRATE / 100
               COMPUTE WK-CYOKI-KEISAN3 =
                       SYU-TOTAL-HKNTEN * 10 * WK-FUTANWARI
               COMPUTE WK-CYOKI-KEISAN3 = WK-CYOKI-KEISAN3 +  5
               COMPUTE WK-CYOKI-KEISAN3 = WK-CYOKI-KEISAN3 / 10
               COMPUTE WK-CYOKI-KEISAN3 = WK-CYOKI-KEISAN3 * 10
      *
               COMPUTE WK-CYOKI-KEISAN4 = WK-CYOKI-KEISAN4
                                        + WK-CYOKI-KEISAN3
             END-IF
           END-IF
      *
           .
      *
       22013-CYOKI-FTN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¸øÈñ£É£ÄÊÔ½¸
      ******************************************************************
       22014-KOHID-HENSYU-SEC          SECTION.
      *
      *    ¼«Î©»Ù±ç¡ÊÀº¿ÀÄÌ±¡¡¢¹¹À¸¡¢°éÀ®¡Ë
           IF    LNK-SYU-SRYYMD(1:6)         >= "200604"
              MOVE  LNK-SYU-SRYYMD(1:6)  TO  WK-JIRITU-SRYYMD(1:6)
              MOVE  "01"                 TO  WK-JIRITU-SRYYMD(7:2)
              IF     SYU-KOH1HKNNUM  =  "015" OR "016" OR "021"
                IF   (LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM  )
                AND  (COMB-KOH1ID     NOT =  WRK-COMB-KOH1ID )
                AND  (WK-JIRITU-CYUKANSOU(1)   =  2          )
                AND  (SYU-NYNSHOKAISU      NOT =  1          )
                AND  (COMB-TEKSTYMD      <=  WK-JIRITU-SRYYMD)
                AND  (WRK-COMB-TEKSTYMD  <=  WK-JIRITU-SRYYMD)
                   MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                END-IF
                IF   (LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM  )
                AND  (COMB-KOH2ID     NOT =  WRK-COMB-KOH1ID )
                AND  (WK-JIRITU-CYUKANSOU(2)   =  2          )
                AND  (SYU-NYNSHOKAISU      NOT =  1          )
                AND  (COMB-TEKSTYMD      <=  WK-JIRITU-SRYYMD)
                AND  (WRK-COMB-TEKSTYMD  <=  WK-JIRITU-SRYYMD)
                   MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                END-IF
              END-IF
              IF     SYU-KOH2HKNNUM  =  "015" OR "016" OR "021"
                IF   (LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM  )
                AND  (COMB-KOH1ID     NOT =  WRK-COMB-KOH2ID )
                AND  (WK-JIRITU-CYUKANSOU(1)   =  2          )
                AND  (SYU-NYNSHOKAISU      NOT =  1          )
                AND  (COMB-TEKSTYMD      <=  WK-JIRITU-SRYYMD)
                AND  (WRK-COMB-TEKSTYMD  <=  WK-JIRITU-SRYYMD)
                   MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                END-IF
                IF   (LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM  )
                AND  (COMB-KOH2ID     NOT =  WRK-COMB-KOH2ID )
                AND  (WK-JIRITU-CYUKANSOU(2)   =  2          )
                AND  (SYU-NYNSHOKAISU      NOT =  1          )
                AND  (COMB-TEKSTYMD      <=  WK-JIRITU-SRYYMD)
                AND  (WRK-COMB-TEKSTYMD  <=  WK-JIRITU-SRYYMD)
                   MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                END-IF
              END-IF
              IF     SYU-KOH1HKNNUM  =  "015" OR "016" OR "021"
                IF   (LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM    )
                AND  (COMB-KOH1ID     NOT =  WRK-COMB-KOH1ID   )
                AND  (WK-JIRITU-CYUKANSOU(1)   =  1            )
                AND  (LNK-SYU-KOH2HKNNUM  NOT = "972" AND "974")
                AND  (LNK-SYU-KOH3HKNNUM  NOT = "972" AND "974")
                AND  (LNK-SYU-KOH4HKNNUM  NOT = "972" AND "974")
                AND  (SYU-NYNSHOKAISU          =  1            )
                AND  (SYU-KOH2HKNNUM      NOT = "972" AND "974")
                AND  (SYU-KOH3HKNNUM      NOT = "972" AND "974")
                AND  (SYU-KOH4HKNNUM      NOT = "972" AND "974")
                   MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                END-IF
              END-IF
           END-IF
      *
      ***
      *
           PERFORM   VARYING   KOHFUKA-IDX   FROM   1   BY   1
                      UNTIL    KOHFUKA-IDX    >     4
             IF ((LNK-SYU-SRYYMD(1:6)         >=  "200310") AND
                 (SYU-KOH-HKNNUM(KOHFUKA-IDX)  =  "051"   ))
             OR ((LNK-SYU-SRYYMD(1:6)         >=  "200504") AND
                 (LNK-SYU-SRYYMD(1:6)         <=  "201412") AND
                 (SYU-KOH-HKNNUM(KOHFUKA-IDX)  =  "052"   ))
             OR ((LNK-SYU-SRYYMD(1:6)         >=  "200804") AND
                 (SYU-KOH-HKNNUM(KOHFUKA-IDX)  =  "038"   ))
             OR ((LNK-SYU-SRYYMD(1:6)         >=  "201501") AND
                 (SYU-KOH-HKNNUM(KOHFUKA-IDX)  =  "054"
                                               OR "052"   ))
                MOVE   1   TO   FLG-KOHFUKA-HENSYU
                PERFORM   220142-KOHFUKA-HENSYU1-SEC
             END-IF
           END-PERFORM
      *
           IF    (LNK-SYU-KOH1HKNNUM       =  "092"   )
           AND   (WK-KOHJGNGET-CHECK092(1) =   ZERO   )
           AND   (SYU-KOH1HKNNUM           =  "092"   )
           AND   (SYU-NYNSHOKAISU      NOT =   7      )
           AND   (LNK-SYU-SRYYMD(1:6)     >=  "201812")
                 MOVE     1   TO   KOHFUKA-IDX
                 IF   WK-HKNJANUM2  =  WK-HKNJANUM
                   MOVE   1   TO   FLG-KOHFUKA-HENSYU
                   PERFORM   220142-KOHFUKA-HENSYU1-SEC
                 ELSE
      *            ÊÝ¸±¼ÔÊÑ¹¹»þ
                   PERFORM   220144-KOHFUKA-HENSYU3-SEC
                 END-IF
           END-IF
      *
           INITIALIZE           WK-CHECK2010X-TBL
           IF     LNK-SYU-SRYYMD(1:6) >= "200804"
                PERFORM    220147-SYU-CHECK2010-SEC
                PERFORM    220148-SYU-CHECKHBT-SEC
           END-IF
      *
           PERFORM   VARYING   KOHFUKA-IDX   FROM   1   BY   1
                      UNTIL    KOHFUKA-IDX    >     4
             IF    SYU-KOH-HKNNUM(KOHFUKA-IDX)(1:1) >= "1" AND <= "8"
               IF     LNK-SYU-SRYYMD(1:6) >= "200804"
                 PERFORM   220145-JYUHENKBN-HENSYU-SEC
               ELSE
                 PERFORM   220146-JYUHENKBN-HENSYU2-SEC
               END-IF
             END-IF
           END-PERFORM
      *
           .
      *
       22014-KOHID-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¸øÈñ¾ðÊó¥Á¥§¥Ã¥¯
      ******************************************************************
       220141-KOHINF-CHECK-SEC          SECTION.
      *
           MOVE    ZERO               TO  FLG-CHECK-OK
           MOVE    SPACE              TO  WK-CHECK-FTNJANUM
                                          WK-CHECK-FTNJANUM2
                                          WK-CHECK-JKYSNUM
                                          WK-CHECK-JKYSNUM2
      *
           INITIALIZE                     PTKOHINF-REC
           MOVE    LNK-SYU-HOSPNUM    TO  PTKOH-HOSPNUM
           MOVE    LNK-SYU-PTID       TO  PTKOH-PTID
           MOVE    COMB-KOHID(CHECK-IDX)
                                      TO  PTKOH-KOHID
           MOVE    PTKOHINF-REC       TO  MCPDATA-REC
           MOVE    "DBSELECT"         TO  MCP-FUNC
           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE    "key8"             TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING  MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
             MOVE    "key8"           TO  MCP-PATHNAME
             PERFORM  PTKOHINF-READ-SEC
             IF       FLG-PTKOHINF    =   ZERO
               MOVE   PTKOH-FTNJANUM  TO  WK-CHECK-FTNJANUM
               MOVE   PTKOH-JKYSNUM   TO  WK-CHECK-JKYSNUM
             END-IF
           END-IF
           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE    "key8"             TO  MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           INITIALIZE                     PTKOHINF-REC
           MOVE    LNK-SYU-HOSPNUM    TO  PTKOH-HOSPNUM
           MOVE    LNK-SYU-PTID       TO  PTKOH-PTID
           MOVE    WRK-COMB-KOHID(CHECK-IDX2)
                                      TO  PTKOH-KOHID
           MOVE    PTKOHINF-REC       TO  MCPDATA-REC
           MOVE    "DBSELECT"         TO  MCP-FUNC
           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE    "key8"             TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING  MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
             MOVE    "key8"           TO  MCP-PATHNAME
             PERFORM  PTKOHINF-READ-SEC
             IF       FLG-PTKOHINF    =   ZERO
               MOVE   PTKOH-FTNJANUM  TO  WK-CHECK-FTNJANUM2
               MOVE   PTKOH-JKYSNUM   TO  WK-CHECK-JKYSNUM2
             END-IF
           END-IF
           MOVE    "tbl_ptkohinf"     TO  MCP-TABLE
           MOVE    "key8"             TO  MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           IF ( WK-CHECK-FTNJANUM(3:5)  =  WK-CHECK-FTNJANUM2(3:5) )
           OR ((WK-CHECK-FTNJANUM(3:5)  =
                "28401" OR "28402" OR "28403" OR "28405" OR
                "28406" OR "28407" OR "28408" OR "28409" OR
                "28410" OR "28411"                         ) AND
               (WK-CHECK-FTNJANUM2(3:5) =
                "28401" OR "28402" OR "28403" OR "28405" OR
                "28406" OR "28407" OR "28408" OR "28409" OR
                "28410" OR "28411"                         )       )
               MOVE       1           TO  FLG-CHECK-OK
           END-IF
      *
           .
      *
       220141-KOHINF-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¸øÈñÉÕ²Ã¾ðÊóÊÔ½¸¡Ê£±¡Ë
      ******************************************************************
       220142-KOHFUKA-HENSYU1-SEC          SECTION.
      *
           EVALUATE   KOHFUKA-IDX
             WHEN        1
               IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                   (COMB-KOH1ID     NOT =  WRK-COMB-KOH1ID))
               OR ( WK-CHECK2010X-TAISYOIDX(1)   =  1      )
                IF  ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH2ID) AND
                     (LNK-SYU-KOH1HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH1ID) AND
                     (LNK-SYU-KOH2HKNNUM  =  "051"          ))
      ***       OR  ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM ) AND
      ***            (COMB-KOH2ID         =  WRK-COMB-KOH2ID) AND
      ***            (LNK-SYU-KOH2HKNNUM  =  "051"          ))
                 CONTINUE
                ELSE
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                     MOVE   LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                      MOVE  LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
                END-IF
               END-IF
               IF ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM ) AND
                   (COMB-KOH2ID     NOT =  WRK-COMB-KOH1ID))
               OR ( WK-CHECK2010X-TAISYOIDX(1)   =  2      )
                IF  ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH1ID) AND
                     (LNK-SYU-KOH1HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH2ID) AND
                     (LNK-SYU-KOH2HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH2ID) AND
                     (LNK-SYU-KOH1HKNNUM  =  "051"          ))
                 CONTINUE
                ELSE
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                     MOVE   LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                      MOVE  LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
                END-IF
               END-IF
               IF ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM ) AND
                   (COMB-KOH3ID     NOT =  WRK-COMB-KOH1ID))
               OR ( WK-CHECK2010X-TAISYOIDX(1)   =  3      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH3ID    TO  WRK-COMB-KOH1ID
                     MOVE   LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH1ID
                      MOVE  LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM ) AND
                   (COMB-KOH4ID     NOT =  WRK-COMB-KOH1ID))
               OR ( WK-CHECK2010X-TAISYOIDX(1)   =  4      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH4ID    TO  WRK-COMB-KOH1ID
                     MOVE   LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH1ID
                      MOVE  LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
             WHEN        2
               IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                   (COMB-KOH1ID     NOT =  WRK-COMB-KOH2ID))
               OR ( WK-CHECK2010X-TAISYOIDX(2)   =  1      )
                IF  ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH1ID) AND
                     (LNK-SYU-KOH1HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH2ID) AND
                     (LNK-SYU-KOH2HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH1ID) AND
                     (LNK-SYU-KOH2HKNNUM  =  "051"          ))
                 CONTINUE
                ELSE
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                     MOVE   LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                      MOVE  LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
                END-IF
               END-IF
               IF ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM ) AND
                   (COMB-KOH2ID     NOT =  WRK-COMB-KOH2ID))
               OR ( WK-CHECK2010X-TAISYOIDX(2)   =  2      )
                IF  ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH2ID) AND
                     (LNK-SYU-KOH1HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH1ID) AND
                     (LNK-SYU-KOH2HKNNUM  =  "051"          ))
                OR  ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH1ID) AND
                     (LNK-SYU-KOH1HKNNUM  =  "051"          ))
                 CONTINUE
                ELSE
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                     MOVE   LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                      MOVE  LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
                END-IF
               END-IF
               IF ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM ) AND
                   (COMB-KOH3ID     NOT =  WRK-COMB-KOH2ID))
               OR ( WK-CHECK2010X-TAISYOIDX(2)   =  3      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH3ID    TO  WRK-COMB-KOH2ID
                     MOVE   LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH2ID
                      MOVE  LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM ) AND
                   (COMB-KOH4ID     NOT =  WRK-COMB-KOH2ID))
               OR ( WK-CHECK2010X-TAISYOIDX(2)   =  4      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH4ID    TO  WRK-COMB-KOH2ID
                     MOVE   LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH2ID
                      MOVE  LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
             WHEN        3
               IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                   (COMB-KOH1ID     NOT =  WRK-COMB-KOH3ID))
               OR ( WK-CHECK2010X-TAISYOIDX(3)   =  1      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH3ID
                     MOVE   LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH3ID
                      MOVE  LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM ) AND
                   (COMB-KOH2ID     NOT =  WRK-COMB-KOH3ID))
               OR ( WK-CHECK2010X-TAISYOIDX(3)   =  2      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH3ID
                     MOVE   LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH3ID
                      MOVE  LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM ) AND
                   (COMB-KOH3ID     NOT =  WRK-COMB-KOH3ID))
               OR ( WK-CHECK2010X-TAISYOIDX(3)   =  3      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH3ID    TO  WRK-COMB-KOH3ID
                     MOVE   LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH3ID
                      MOVE  LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM ) AND
                   (COMB-KOH4ID     NOT =  WRK-COMB-KOH3ID))
               OR ( WK-CHECK2010X-TAISYOIDX(3)   =  4      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH4ID    TO  WRK-COMB-KOH3ID
                     MOVE   LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH3ID
                      MOVE  LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
             WHEN        4
               IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                   (COMB-KOH1ID     NOT =  WRK-COMB-KOH4ID))
               OR ( WK-CHECK2010X-TAISYOIDX(4)   =  1      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH1ID    TO  WRK-COMB-KOH4ID
                     MOVE   LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH4ID
                      MOVE  LNK-SYU-KOH1HKNNUM
                                           TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM ) AND
                   (COMB-KOH2ID     NOT =  WRK-COMB-KOH4ID))
               OR ( WK-CHECK2010X-TAISYOIDX(4)   =  2      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH2ID    TO  WRK-COMB-KOH4ID
                     MOVE   LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH4ID
                      MOVE  LNK-SYU-KOH2HKNNUM
                                           TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM ) AND
                   (COMB-KOH3ID     NOT =  WRK-COMB-KOH4ID))
               OR ( WK-CHECK2010X-TAISYOIDX(4)   =  3      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH3ID    TO  WRK-COMB-KOH4ID
                     MOVE   LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH4ID
                      MOVE  LNK-SYU-KOH3HKNNUM
                                           TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM ) AND
                   (COMB-KOH4ID     NOT =  WRK-COMB-KOH4ID))
               OR ( WK-CHECK2010X-TAISYOIDX(4)   =  4      )
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE   COMB-KOH4ID    TO  WRK-COMB-KOH4ID
                     MOVE   LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                      MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH4ID
                      MOVE  LNK-SYU-KOH4HKNNUM
                                           TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
           END-EVALUATE
      *
           IF   WK-1001-PREFNUM  =  28
               PERFORM  220143-KOHFUKA-HENSYU2-SEC
           END-IF
      *
           .
      *
       220142-KOHFUKA-HENSYU1-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¸øÈñÉÕ²Ã¾ðÊóÊÔ½¸¡Ê£²¡Ë
      ******************************************************************
       220143-KOHFUKA-HENSYU2-SEC          SECTION.
      *
           EVALUATE   KOHFUKA-IDX
             WHEN        1
               IF ((SYU-KOH1HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH1HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                     MOVE    LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH1ID
                       MOVE  LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH1HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH1HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                     MOVE    LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH1ID
                       MOVE  LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH1HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH1HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH3ID    TO  WRK-COMB-KOH1ID
                     MOVE    LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH1ID
                       MOVE  LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH1HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH1HKNNUM))
               OR ((SYU-KOH1HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH1HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH4ID    TO  WRK-COMB-KOH1ID
                     MOVE    LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH1HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     1      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH1ID
                       MOVE  LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH1HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
             WHEN        2
               IF ((SYU-KOH2HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH2HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                     MOVE    LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH2ID
                       MOVE  LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH2HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH2HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                     MOVE    LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH2ID
                       MOVE  LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH2HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH2HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH3ID    TO  WRK-COMB-KOH2ID
                     MOVE    LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH2ID
                       MOVE  LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH2HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH2HKNNUM))
               OR ((SYU-KOH2HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH2HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH4ID    TO  WRK-COMB-KOH2ID
                     MOVE    LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH2HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     2      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH2ID
                       MOVE  LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH2HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
             WHEN        3
               IF ((SYU-KOH3HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH3HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH1ID    TO  WRK-COMB-KOH3ID
                     MOVE    LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH3ID
                       MOVE  LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH3HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH3HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH2ID    TO  WRK-COMB-KOH3ID
                     MOVE    LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH3ID
                       MOVE  LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH3HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH3HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH3ID    TO  WRK-COMB-KOH3ID
                     MOVE    LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH3ID
                       MOVE  LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH3HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH3HKNNUM))
               OR ((SYU-KOH3HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH3HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH4ID    TO  WRK-COMB-KOH3ID
                     MOVE    LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH3HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     3      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH3ID
                       MOVE  LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH3HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
             WHEN        4
               IF ((SYU-KOH4HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH1HKNNUM  NOT =  SYU-KOH4HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH1ID    TO  WRK-COMB-KOH4ID
                     MOVE    LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     1      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH1ID    TO  WRK-COMB-KOH4ID
                       MOVE  LNK-SYU-KOH1HKNNUM
                                            TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH4HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH2HKNNUM  NOT =  SYU-KOH4HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH2ID    TO  WRK-COMB-KOH4ID
                     MOVE    LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     2      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH2ID    TO  WRK-COMB-KOH4ID
                       MOVE  LNK-SYU-KOH2HKNNUM
                                            TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH4HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH3HKNNUM  NOT =  SYU-KOH4HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH3ID    TO  WRK-COMB-KOH4ID
                     MOVE    LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     3      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH3ID    TO  WRK-COMB-KOH4ID
                       MOVE  LNK-SYU-KOH3HKNNUM
                                            TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
               IF ((SYU-KOH4HKNNUM          = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "182" OR "158" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "382" OR "358" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "482" OR "458" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "143" OR "168" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "343" OR "368" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH4HKNNUM))
               OR ((SYU-KOH4HKNNUM          = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM      = "443" OR "468" ) AND
                   (LNK-SYU-KOH4HKNNUM  NOT =  SYU-KOH4HKNNUM))
                 EVALUATE  FLG-KOHFUKA-HENSYU
                   WHEN        1
                     MOVE    COMB-KOH4ID    TO  WRK-COMB-KOH4ID
                     MOVE    LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH4HKNNUM
                   WHEN        2
                     MOVE     4      TO    CHECK-IDX
                     MOVE     4      TO    CHECK-IDX2
                     PERFORM  220141-KOHINF-CHECK-SEC
                     IF   FLG-CHECK-OK  =  1
                       MOVE  COMB-KOH4ID    TO  WRK-COMB-KOH4ID
                       MOVE  LNK-SYU-KOH4HKNNUM
                                            TO  SYU-KOH4HKNNUM
                     END-IF
                 END-EVALUATE
               END-IF
           END-EVALUATE
      *
           .
      *
       220143-KOHFUKA-HENSYU2-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¸øÈñÉÕ²Ã¾ðÊóÊÔ½¸¡Ê£³¡Ë
      ******************************************************************
       220144-KOHFUKA-HENSYU3-SEC          SECTION.
      *
           EVALUATE   KOHFUKA-IDX
             WHEN        1
               IF  (LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM )
               AND (COMB-KOH1ID         =  WRK-COMB-KOH1ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH1ID
               END-IF
               IF  (LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM )
               AND (COMB-KOH2ID         =  WRK-COMB-KOH1ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH1ID
               END-IF
               IF  (LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM )
               AND (COMB-KOH3ID         =  WRK-COMB-KOH1ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH1ID
               END-IF
               IF  (LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM )
               AND (COMB-KOH4ID         =  WRK-COMB-KOH1ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH1ID
               END-IF
             WHEN        2
               IF  (LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM )
               AND (COMB-KOH1ID         =  WRK-COMB-KOH2ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH2ID
               END-IF
               IF  (LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM )
               AND (COMB-KOH2ID         =  WRK-COMB-KOH2ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH2ID
               END-IF
               IF  (LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM )
               AND (COMB-KOH3ID         =  WRK-COMB-KOH2ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH2ID
               END-IF
               IF  (LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM )
               AND (COMB-KOH4ID         =  WRK-COMB-KOH2ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH2ID
               END-IF
             WHEN        3
               IF  (LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM )
               AND (COMB-KOH1ID         =  WRK-COMB-KOH3ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH3ID
               END-IF
               IF  (LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM )
               AND (COMB-KOH2ID         =  WRK-COMB-KOH3ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH3ID
               END-IF
               IF  (LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM )
               AND (COMB-KOH3ID         =  WRK-COMB-KOH3ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH3ID
               END-IF
               IF  (LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM )
               AND (COMB-KOH4ID         =  WRK-COMB-KOH3ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH3ID
               END-IF
             WHEN        4
               IF  (LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM )
               AND (COMB-KOH1ID         =  WRK-COMB-KOH4ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH4ID
               END-IF
               IF  (LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM )
               AND (COMB-KOH2ID         =  WRK-COMB-KOH4ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH4ID
               END-IF
               IF  (LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM )
               AND (COMB-KOH3ID         =  WRK-COMB-KOH4ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH4ID
               END-IF
               IF  (LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM )
               AND (COMB-KOH4ID         =  WRK-COMB-KOH4ID)
                     MOVE   9999999999     TO  WRK-COMB-KOH4ID
               END-IF
           END-EVALUATE
      *
           .
      *
       220144-KOHFUKA-HENSYU3-EXT.
           EXIT.
      *
      ******************************************************************
      *    ·îÅÓÃæ¼õµë¼Ô¾ÚÊÑ¹¹»þÉéÃ´·×»»¤ÎÀßÄêÊÔ½¸
      ******************************************************************
       220145-JYUHENKBN-HENSYU-SEC          SECTION.
      *
           EVALUATE  WK-CHECK2010X-JYUHENKBN(KOHFUKA-IDX)
             WHEN      SPACE
             WHEN      "0"
                 PERFORM   220146-JYUHENKBN-HENSYU2-SEC
             WHEN      "1"
             WHEN      "2"
                 MOVE  WK-CHECK2010X-JYUHENKBN(KOHFUKA-IDX)
                                           TO  FLG-KOHFUKA-HENSYU
                 PERFORM   220142-KOHFUKA-HENSYU1-SEC
             WHEN      "3"
                 CONTINUE
             WHEN      "4"
                 IF ( WK-HKNJANUM2  =  WK-HKNJANUM        )
                 OR ((WK-HKNJANUM2  =
                      "284018" OR "284026" OR "284034" OR
                      "284059" OR "284067" OR "284075" OR
                      "284083" OR "284091" OR "284109" OR
                      "284117"                           ) AND
                     (WK-HKNJANUM   =
                      "284018" OR "284026" OR "284034" OR
                      "284059" OR "284067" OR "284075" OR
                      "284083" OR "284091" OR "284109" OR
                      "284117"                           ))
                   MOVE   1   TO   FLG-KOHFUKA-HENSYU
                   PERFORM   220142-KOHFUKA-HENSYU1-SEC
                 ELSE
      *            ÊÝ¸±¼ÔÊÑ¹¹»þ
                   PERFORM   220144-KOHFUKA-HENSYU3-SEC
                 END-IF
             WHEN      "5"
                 IF ( WK-HKNJANUM2  =  WK-HKNJANUM        )
                 OR ((WK-HKNJANUM2  =
                      "284018" OR "284026" OR "284034" OR
                      "284059" OR "284067" OR "284075" OR
                      "284083" OR "284091" OR "284109" OR
                      "284117"                           ) AND
                     (WK-HKNJANUM   =
                      "284018" OR "284026" OR "284034" OR
                      "284059" OR "284067" OR "284075" OR
                      "284083" OR "284091" OR "284109" OR
                      "284117"                           ))
                   MOVE   2   TO   FLG-KOHFUKA-HENSYU
                   PERFORM   220142-KOHFUKA-HENSYU1-SEC
                 ELSE
      *            ÊÝ¸±¼ÔÊÑ¹¹»þ
                   PERFORM   220144-KOHFUKA-HENSYU3-SEC
                 END-IF
             WHEN      "6"
                 MOVE     1   TO   FLG-KOHFUKA-HENSYU
                 PERFORM     220142-KOHFUKA-HENSYU1-SEC
             WHEN      "7"
                 IF ( WK-HKNJANUM2  =  WK-HKNJANUM        )
                 OR ((WK-HKNJANUM2  =
                      "284018" OR "284026" OR "284034" OR
                      "284059" OR "284067" OR "284075" OR
                      "284083" OR "284091" OR "284109" OR
                      "284117"                           ) AND
                     (WK-HKNJANUM   =
                      "284018" OR "284026" OR "284034" OR
                      "284059" OR "284067" OR "284075" OR
                      "284083" OR "284091" OR "284109" OR
                      "284117"                           ))
                   CONTINUE
                 ELSE
      *            ÊÝ¸±¼ÔÊÑ¹¹»þ
                   PERFORM   220144-KOHFUKA-HENSYU3-SEC
                 END-IF
             WHEN      "Z"
                 IF ((COMB-KOH1HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH1HKNNUM = WRK-COMB-KOH1HKNNUM) AND
                     (COMB-KOH1ID     = WRK-COMB-KOH1ID    ))
                 OR ((COMB-KOH1HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH1HKNNUM = WRK-COMB-KOH2HKNNUM) AND
                     (COMB-KOH1ID     = WRK-COMB-KOH2ID    ))
                 OR ((COMB-KOH1HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH1HKNNUM = WRK-COMB-KOH3HKNNUM) AND
                     (COMB-KOH1ID     = WRK-COMB-KOH3ID    ))
                 OR ((COMB-KOH1HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH1HKNNUM = WRK-COMB-KOH4HKNNUM) AND
                     (COMB-KOH1ID     = WRK-COMB-KOH4ID    ))
                 OR ((COMB-KOH2HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH2HKNNUM = WRK-COMB-KOH1HKNNUM) AND
                     (COMB-KOH2ID     = WRK-COMB-KOH1ID    ))
                 OR ((COMB-KOH2HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH2HKNNUM = WRK-COMB-KOH2HKNNUM) AND
                     (COMB-KOH2ID     = WRK-COMB-KOH2ID    ))
                 OR ((COMB-KOH2HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH2HKNNUM = WRK-COMB-KOH3HKNNUM) AND
                     (COMB-KOH2ID     = WRK-COMB-KOH3ID    ))
                 OR ((COMB-KOH2HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH2HKNNUM = WRK-COMB-KOH4HKNNUM) AND
                     (COMB-KOH2ID     = WRK-COMB-KOH4ID    ))
                 OR ((COMB-KOH3HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH3HKNNUM = WRK-COMB-KOH1HKNNUM) AND
                     (COMB-KOH3ID     = WRK-COMB-KOH1ID    ))
                 OR ((COMB-KOH3HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH3HKNNUM = WRK-COMB-KOH2HKNNUM) AND
                     (COMB-KOH3ID     = WRK-COMB-KOH2ID    ))
                 OR ((COMB-KOH3HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH3HKNNUM = WRK-COMB-KOH3HKNNUM) AND
                     (COMB-KOH3ID     = WRK-COMB-KOH3ID    ))
                 OR ((COMB-KOH3HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH3HKNNUM = WRK-COMB-KOH4HKNNUM) AND
                     (COMB-KOH3ID     = WRK-COMB-KOH4ID    ))
                 OR ((COMB-KOH4HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH4HKNNUM = WRK-COMB-KOH1HKNNUM) AND
                     (COMB-KOH4ID     = WRK-COMB-KOH1ID    ))
                 OR ((COMB-KOH4HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH4HKNNUM = WRK-COMB-KOH2HKNNUM) AND
                     (COMB-KOH4ID     = WRK-COMB-KOH2ID    ))
                 OR ((COMB-KOH4HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH4HKNNUM = WRK-COMB-KOH3HKNNUM) AND
                     (COMB-KOH4ID     = WRK-COMB-KOH3ID    ))
                 OR ((COMB-KOH4HKNNUM = "972" OR "974"     ) AND
                     (COMB-KOH4HKNNUM = WRK-COMB-KOH4HKNNUM) AND
                     (COMB-KOH4ID     = WRK-COMB-KOH4ID    ))
                   CONTINUE
                 ELSE
                   PERFORM   220144-KOHFUKA-HENSYU3-SEC
                 END-IF
           END-EVALUATE
      *
           .
      *
       220145-JYUHENKBN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ·îÅÓÃæ¼õµë¼Ô¾ÚÊÑ¹¹»þÉéÃ´·×»»¤ÎÀßÄêÊÔ½¸£²
      ******************************************************************
       220146-JYUHENKBN-HENSYU2-SEC          SECTION.
      *
           IF   WK-1001-PREFNUM             =  08 OR 31
               MOVE   1   TO   FLG-KOHFUKA-HENSYU
               PERFORM   220142-KOHFUKA-HENSYU1-SEC
           END-IF
           IF  (WK-1001-PREFNUM             =  34                    )
           AND (SYU-KOH-HKNNUM(KOHFUKA-IDX) = "191" OR "291" OR "491")
               MOVE   2   TO   FLG-KOHFUKA-HENSYU
               PERFORM   220142-KOHFUKA-HENSYU1-SEC
           END-IF
           IF ((WK-1001-PREFNUM             =  41           ) AND
               (SYU-KOH-HKNNUM(KOHFUKA-IDX) = "181"         ))
           OR ((WK-1001-PREFNUM             =  36           ) AND
               (SYU-KOH-HKNNUM(KOHFUKA-IDX) = "245" OR "445"))
             IF   WK-HKNJANUM2  =  WK-HKNJANUM
               MOVE   1   TO   FLG-KOHFUKA-HENSYU
               PERFORM   220142-KOHFUKA-HENSYU1-SEC
             ELSE
      *        ÊÝ¸±¼ÔÊÑ¹¹»þ
               PERFORM   220144-KOHFUKA-HENSYU3-SEC
             END-IF
           END-IF
      *
           .
      *
       220146-JYUHENKBN-HENSYU2-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¼ýÇ¼¥Ç¡¼¥¿¤Î¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°ÀßÄê¥Á¥§¥Ã¥¯
      ******************************************************************
       220147-SYU-CHECK2010-SEC          SECTION.
      *
           MOVE     ZERO     TO    FLG-ARI
           PERFORM  VARYING  IDX16  FROM  1  BY  1
                     UNTIL  (IDX16                            >  100 )
                      OR    (WK-CHECK2010-HKNCOMBINUM(IDX16)  = SPACE)
                      OR    (FLG-ARI                          =  1   )
             IF  SYU-HKNCOMBINUM = WK-CHECK2010-HKNCOMBINUM(IDX16)
               MOVE    1     TO    FLG-ARI
               PERFORM  VARYING  IDX17  FROM  1  BY  1
                         UNTIL  (IDX17                     >  4   )
                          OR    (WRK-COMB-KOHHKNNUM(IDX17) = SPACE)
                 IF   WRK-COMB-KOHHKNNUM(IDX17)(1:1) >= "1" AND <= "8"
                   MOVE  WK-CHECK2010-JYUHENKBN(IDX16 IDX17)
                             TO    WK-CHECK2010X-JYUHENKBN(IDX17)
                   MOVE  WK-CHECK2010-JYUHEN-TAIKBN(IDX16 IDX17)
                             TO    WK-CHECK2010X-JYUHEN-TAIKBN(IDX17)
                   MOVE  WK-CHECK2010-HBTNUM(IDX16 IDX17)
                             TO    WK-CHECK2010X-HBTNUM(IDX17)
                   MOVE  WK-CHECK2010-NG(IDX16 IDX17)
                             TO    WK-CHECK2010X-NG(IDX17)
                 END-IF
               END-PERFORM
             END-IF
           END-PERFORM
           IF    FLG-ARI  =   ZERO
           AND   IDX16   <=   100
             MOVE  SYU-HKNCOMBINUM  TO  WK-CHECK2010-HKNCOMBINUM(IDX16)
             PERFORM  VARYING  IDX17  FROM  1  BY  1
                       UNTIL  (IDX17                     >  4   )
                        OR    (WRK-COMB-KOHHKNNUM(IDX17) = SPACE)
               IF   WRK-COMB-KOHHKNNUM(IDX17)(1:1) >= "1" AND <= "8"
                 PERFORM   2201471-SYU-CHECK2010-XXX-SEC
               END-IF
             END-PERFORM
      *
             PERFORM  VARYING  IDX17  FROM  1  BY  1
                       UNTIL  (IDX17                     >  4   )
                        OR    (WRK-COMB-KOHHKNNUM(IDX17) = SPACE)
               IF   WRK-COMB-KOHHKNNUM(IDX17)(1:1) >= "1" AND <= "8"
                 PERFORM   2201472-SYU-CHECK2010-YYY-SEC
               END-IF
             END-PERFORM
      *
             PERFORM  VARYING  IDX17  FROM  1  BY  1
                       UNTIL  (IDX17                     >  4   )
                        OR    (WRK-COMB-KOHHKNNUM(IDX17) = SPACE)
               IF   WRK-COMB-KOHHKNNUM(IDX17)(1:1) >= "1" AND <= "8"
                 MOVE  WK-CHECK2010-JYUHENKBN(IDX16 IDX17)
                             TO    WK-CHECK2010X-JYUHENKBN(IDX17)
                 MOVE  WK-CHECK2010-JYUHEN-TAIKBN(IDX16 IDX17)
                             TO    WK-CHECK2010X-JYUHEN-TAIKBN(IDX17)
                 MOVE  WK-CHECK2010-HBTNUM(IDX16 IDX17)
                             TO    WK-CHECK2010X-HBTNUM(IDX17)
                 MOVE  WK-CHECK2010-NG(IDX16 IDX17)
                             TO    WK-CHECK2010X-NG(IDX17)
               END-IF
             END-PERFORM
           END-IF
      *
           .
      *
       220147-SYU-CHECK2010-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¼ýÇ¼¥Ç¡¼¥¿¤Î¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°ÀßÄê¥Á¥§¥Ã¥¯
      ******************************************************************
       2201471-SYU-CHECK2010-XXX-SEC          SECTION.
      *
           INITIALIZE                   SYS-2010-REC
           MOVE    "2010"           TO  SYS-2010-KANRICD
           MOVE    WRK-COMB-KOHHKNNUM(IDX17)
                                    TO  SYS-2010-KBNCD
           MOVE    SYU-HOSPNUM      TO  SYS-2010-HOSPNUM
           MOVE    SYU-SRYYMD       TO  SYS-2010-STYUKYMD
           MOVE    SYU-SRYYMD       TO  SYS-2010-EDYUKYMD
           MOVE    SYS-2010-REC     TO  MCPDATA-REC
           MOVE    "DBSELECT"       TO  MCP-FUNC
           MOVE    "tbl_syskanri"   TO  MCP-TABLE
           MOVE    "key10"          TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"  USING   MCPAREA
                                        MCPDATA-REC
                                        SPA-AREA
           IF      MCP-RC   =   ZERO
             MOVE  "tbl_syskanri"   TO  MCP-TABLE
             MOVE  "key10"          TO  MCP-PATHNAME
             PERFORM      SYSKANRI-READ-SEC
             MOVE  SYS-2010-JYUHENKBN
                            TO  WK-CHECK2010-JYUHENKBN(IDX16 IDX17)
      *
             IF ((COMB-KOH1HKNNUM  =  WRK-COMB-KOHHKNNUM(IDX17)) AND
                 (COMB-KOH1ID      =  WRK-COMB-KOHID(IDX17)    ) AND
                 (FLG-CHIHOU3(1)   =  "1"                      ))
             OR ((COMB-KOH2HKNNUM  =  WRK-COMB-KOHHKNNUM(IDX17)) AND
                 (COMB-KOH2ID      =  WRK-COMB-KOHID(IDX17)    ) AND
                 (FLG-CHIHOU3(2)   =  "1"                      ))
             OR ((COMB-KOH3HKNNUM  =  WRK-COMB-KOHHKNNUM(IDX17)) AND
                 (COMB-KOH3ID      =  WRK-COMB-KOHID(IDX17)    ) AND
                 (FLG-CHIHOU3(3)   =  "1"                      ))
             OR ((COMB-KOH4HKNNUM  =  WRK-COMB-KOHHKNNUM(IDX17)) AND
                 (COMB-KOH4ID      =  WRK-COMB-KOHID(IDX17)    ) AND
                 (FLG-CHIHOU3(4)   =  "1"                      ))
               MOVE   "Z"   TO  WK-CHECK2010-JYUHENKBN(IDX16 IDX17)
             END-IF
      *
             MOVE  SYS-2010-JYUHEN-TAIKBN
                            TO  WK-CHECK2010-JYUHEN-TAIKBN(IDX16 IDX17)
             IF    SYS-2010-JYUHEN-TAIKBN  =  "1"
               INITIALIZE                     HKNNUM-REC
               MOVE   SYU-HOSPNUM         TO  HKN-HOSPNUM
               MOVE   WRK-COMB-KOHHKNNUM(IDX17)
                                          TO  HKN-HKNNUM
               MOVE   "00"                TO  HKN-PAYKBN
               MOVE   SYU-SRYYMD(1:6)     TO  HKN-TEKSTYMD(1:6)
                                              HKN-TEKEDYMD(1:6)
               MOVE   "01"                TO  HKN-TEKSTYMD(7:2)
                                              HKN-TEKEDYMD(7:2)
               MOVE   HKNNUM-REC          TO  MCPDATA-REC
               MOVE   "DBSELECT"          TO  MCP-FUNC
               MOVE   "tbl_hknnum"        TO  MCP-TABLE
               MOVE   "key"               TO  MCP-PATHNAME
               CALL   "ORCDBMAIN"         USING   MCPAREA
                                                  MCPDATA-REC
                                                  SPA-AREA
               IF      MCP-RC       =   ZERO
                 MOVE "tbl_hknnum"        TO  MCP-TABLE
                 MOVE "key"               TO  MCP-PATHNAME
                 PERFORM  HKNNUM-READ-SEC
                 IF    FLG-HKNNUM   =   ZERO
                   MOVE   HKN-HBTNUM
                            TO  WK-CHECK2010-HBTNUM(IDX16 IDX17)
                 END-IF
               END-IF
               MOVE   "tbl_hknnum"        TO  MCP-TABLE
               MOVE   "key"               TO  MCP-PATHNAME
               PERFORM    DB-CLOSE-SEC
             END-IF
           END-IF
           MOVE    "tbl_syskanri"   TO  MCP-TABLE
           MOVE    "key10"          TO  MCP-PATHNAME
           PERFORM        DB-CLOSE-SEC
      *
           .
      *
       2201471-SYU-CHECK2010-XXX-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¼ýÇ¼¥Ç¡¼¥¿¤Î¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°ÀßÄê¥Á¥§¥Ã¥¯
      ******************************************************************
       2201472-SYU-CHECK2010-YYY-SEC          SECTION.
      *
           IF  (WK-CHECK2010-JYUHEN-TAIKBN(IDX16 IDX17) =  "1"  )
           AND (WK-CHECK2010-HBTNUM(IDX16 IDX17)    NOT =  SPACE)
             EVALUATE  IDX17
               WHEN       1
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 1) =
                             WK-CHECK2010-HBTNUM(IDX16 2)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 1) =
                             WK-CHECK2010-JYUHENKBN(IDX16 2)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 1) =
                             WK-CHECK2010-HBTNUM(IDX16 3)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 1) =
                             WK-CHECK2010-JYUHENKBN(IDX16 3)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 1) =
                             WK-CHECK2010-HBTNUM(IDX16 4)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 1) =
                             WK-CHECK2010-JYUHENKBN(IDX16 4)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 1)
                 END-IF
               WHEN       2
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 2) =
                             WK-CHECK2010-HBTNUM(IDX16 1)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 2) =
                             WK-CHECK2010-JYUHENKBN(IDX16 1)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 2) =
                             WK-CHECK2010-HBTNUM(IDX16 3)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 2) =
                             WK-CHECK2010-JYUHENKBN(IDX16 3)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 2) =
                             WK-CHECK2010-HBTNUM(IDX16 4)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 2) =
                             WK-CHECK2010-JYUHENKBN(IDX16 4)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 2)
                 END-IF
               WHEN       3
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 3) =
                             WK-CHECK2010-HBTNUM(IDX16 1)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 3) =
                             WK-CHECK2010-JYUHENKBN(IDX16 1)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 3) =
                             WK-CHECK2010-HBTNUM(IDX16 2)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 3) =
                             WK-CHECK2010-JYUHENKBN(IDX16 2)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 3) =
                             WK-CHECK2010-HBTNUM(IDX16 4)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 3) =
                             WK-CHECK2010-JYUHENKBN(IDX16 4)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 3)
                 END-IF
               WHEN       4
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 4) =
                             WK-CHECK2010-HBTNUM(IDX16 1)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 4) =
                             WK-CHECK2010-JYUHENKBN(IDX16 1)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 4) =
                             WK-CHECK2010-HBTNUM(IDX16 2)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 4) =
                             WK-CHECK2010-JYUHENKBN(IDX16 2)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3)) AND
                     (WK-CHECK2010-HBTNUM(IDX16 4) =
                             WK-CHECK2010-HBTNUM(IDX16 3)       ) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 4) =
                             WK-CHECK2010-JYUHENKBN(IDX16 3)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 4)
                 END-IF
             END-EVALUATE
           END-IF
      *
           IF   WK-CHECK2010-JYUHEN-TAIKBN(IDX16 IDX17) =
                        "A" OR "B" OR "C" OR "D" OR "E" OR
                        "F" OR "G" OR "H" OR "I" OR "J"
             EVALUATE  IDX17
               WHEN       1
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 1) =
                             WK-CHECK2010-JYUHENKBN(IDX16 2)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 1) =
                             WK-CHECK2010-JYUHENKBN(IDX16 3)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 1) =
                             WK-CHECK2010-JYUHENKBN(IDX16 4)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 1)
                 END-IF
               WHEN       2
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 2) =
                             WK-CHECK2010-JYUHENKBN(IDX16 1)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 2) =
                             WK-CHECK2010-JYUHENKBN(IDX16 3)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 2) =
                             WK-CHECK2010-JYUHENKBN(IDX16 4)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 2)
                 END-IF
               WHEN       3
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 3) =
                             WK-CHECK2010-JYUHENKBN(IDX16 1)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 3) =
                             WK-CHECK2010-JYUHENKBN(IDX16 2)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 3) =
                             WK-CHECK2010-JYUHENKBN(IDX16 4)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 3)
                 END-IF
               WHEN       4
                 IF ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 1)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 4) =
                             WK-CHECK2010-JYUHENKBN(IDX16 1)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 2)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 4) =
                             WK-CHECK2010-JYUHENKBN(IDX16 2)    ))
                 OR ((WK-CHECK2010-JYUHEN-TAIKBN(IDX16 4) =
                             WK-CHECK2010-JYUHEN-TAIKBN(IDX16 3)) AND
                     (WK-CHECK2010-JYUHENKBN(IDX16 4) =
                             WK-CHECK2010-JYUHENKBN(IDX16 3)    ))
                   MOVE   "1"  TO  WK-CHECK2010-NG(IDX16 4)
                 END-IF
             END-EVALUATE
           END-IF
      *
           .
      *
       2201472-SYU-CHECK2010-YYY-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¼ýÇ¼¥Ç¡¼¥¿¤ÎË¡ÊÌÈÖ¹æÅù¤Î¥Á¥§¥Ã¥¯
      ******************************************************************
       220148-SYU-CHECKHBT-SEC          SECTION.
      *
           PERFORM  VARYING  IDX17  FROM  1  BY  1
                     UNTIL  (IDX17                     >  4   )
                      OR    (WRK-COMB-KOHHKNNUM(IDX17) = SPACE)
             IF   WRK-COMB-KOHHKNNUM(IDX17)(1:1) >= "1" AND <= "8"
               IF  WRK-COMB-KOHHKNNUM(IDX17) =  COMB-KOHHKNNUM(1)
                                            OR  COMB-KOHHKNNUM(2)
                                            OR  COMB-KOHHKNNUM(3)
                                            OR  COMB-KOHHKNNUM(4)
                 CONTINUE
               ELSE
                 IF  (WK-CHECK2010X-JYUHEN-TAIKBN(IDX17)  =  "1"  )
                 AND (WK-CHECK2010X-HBTNUM(IDX17)     NOT =  SPACE)
                 AND (WK-CHECK2010X-NG(IDX17)             =  SPACE)
                   PERFORM  VARYING  IDX16  FROM  1  BY  1
                             UNTIL  (IDX16                 >  4   )
                              OR    (COMB-KOHHKNNUM(IDX16) = SPACE)
                     IF  (WK-CHECK2010X-JYUHEN-TAIKBN(IDX17) =
                                     WK-2010-JYUHEN-TAIKBN(IDX16))
                     AND (WK-CHECK2010X-HBTNUM(IDX17) =
                                     WK-HBTNUM(IDX16)            )
                     AND (WK-CHECK2010X-JYUHENKBN(IDX17) =
                                     WK-2010-JYUHENKBN(IDX16)    )
                        PERFORM   2201481-SYU-CHECKHBT-XXX-SEC
                        MOVE   4       TO   IDX16
                     END-IF
                   END-PERFORM
                 END-IF
      *
                 IF  (WK-CHECK2010X-JYUHEN-TAIKBN(IDX17)  =
                              "A" OR "B" OR "C" OR "D" OR "E" OR
                              "F" OR "G" OR "H" OR "I" OR "J"     )
                 AND (WK-CHECK2010X-NG(IDX17)             =  SPACE)
                   PERFORM  VARYING  IDX16  FROM  1  BY  1
                             UNTIL  (IDX16                 >  4   )
                              OR    (COMB-KOHHKNNUM(IDX16) = SPACE)
                     IF  (WK-CHECK2010X-JYUHEN-TAIKBN(IDX17) =
                                     WK-2010-JYUHEN-TAIKBN(IDX16))
                     AND (WK-CHECK2010X-JYUHENKBN(IDX17) =
                                     WK-2010-JYUHENKBN(IDX16)    )
                        PERFORM   2201482-SYU-CHECKHBT-YYY-SEC
                        MOVE   4       TO   IDX16
                     END-IF
                   END-PERFORM
                 END-IF
               END-IF
             END-IF
           END-PERFORM
      *
           .
      *
       220148-SYU-CHECKHBT-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¼ýÇ¼¥Ç¡¼¥¿¤ÎË¡ÊÌÈÖ¹æÅù¤Î¥Á¥§¥Ã¥¯
      ******************************************************************
       2201481-SYU-CHECKHBT-XXX-SEC          SECTION.
      *
           EVALUATE  IDX16
             WHEN      1
               IF ((WK-2010-JYUHEN-TAIKBN(1)
                                         = WK-2010-JYUHEN-TAIKBN(2)) AND
                   (WK-HBTNUM(1)         = WK-HBTNUM(2)            ) AND
                   (WK-2010-JYUHENKBN(1) = WK-2010-JYUHENKBN(2)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(1)
                                         = WK-2010-JYUHEN-TAIKBN(3)) AND
                   (WK-HBTNUM(1)         = WK-HBTNUM(3)            ) AND
                   (WK-2010-JYUHENKBN(1) = WK-2010-JYUHENKBN(3)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(1)
                                         = WK-2010-JYUHEN-TAIKBN(4)) AND
                   (WK-HBTNUM(1)         = WK-HBTNUM(4)            ) AND
                   (WK-2010-JYUHENKBN(1) = WK-2010-JYUHENKBN(4)    ))
                 CONTINUE
               ELSE
                 MOVE    1    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
             WHEN      2
               IF ((WK-2010-JYUHEN-TAIKBN(2)
                                         = WK-2010-JYUHEN-TAIKBN(1)) AND
                   (WK-HBTNUM(2)         = WK-HBTNUM(1)            ) AND
                   (WK-2010-JYUHENKBN(2) = WK-2010-JYUHENKBN(1)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(2)
                                         = WK-2010-JYUHEN-TAIKBN(3)) AND
                   (WK-HBTNUM(2)         = WK-HBTNUM(3)            ) AND
                   (WK-2010-JYUHENKBN(2) = WK-2010-JYUHENKBN(3)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(2)
                                         = WK-2010-JYUHEN-TAIKBN(4)) AND
                   (WK-HBTNUM(2)         = WK-HBTNUM(4)            ) AND
                   (WK-2010-JYUHENKBN(2) = WK-2010-JYUHENKBN(4)    ))
                 CONTINUE
               ELSE
                 MOVE    2    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
             WHEN      3
               IF ((WK-2010-JYUHEN-TAIKBN(3)
                                         = WK-2010-JYUHEN-TAIKBN(1)) AND
                   (WK-HBTNUM(3)         = WK-HBTNUM(1)            ) AND
                   (WK-2010-JYUHENKBN(3) = WK-2010-JYUHENKBN(1)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(3)
                                         = WK-2010-JYUHEN-TAIKBN(2)) AND
                   (WK-HBTNUM(3)         = WK-HBTNUM(2)            ) AND
                   (WK-2010-JYUHENKBN(3) = WK-2010-JYUHENKBN(2)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(3)
                                         = WK-2010-JYUHEN-TAIKBN(4)) AND
                   (WK-HBTNUM(3)         = WK-HBTNUM(4)            ) AND
                   (WK-2010-JYUHENKBN(3) = WK-2010-JYUHENKBN(4)    ))
                 CONTINUE
               ELSE
                 MOVE    3    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
             WHEN      4
               IF ((WK-2010-JYUHEN-TAIKBN(4)
                                         = WK-2010-JYUHEN-TAIKBN(1)) AND
                   (WK-HBTNUM(4)         = WK-HBTNUM(1)            ) AND
                   (WK-2010-JYUHENKBN(4) = WK-2010-JYUHENKBN(1)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(4)
                                         = WK-2010-JYUHEN-TAIKBN(2)) AND
                   (WK-HBTNUM(4)         = WK-HBTNUM(2)            ) AND
                   (WK-2010-JYUHENKBN(4) = WK-2010-JYUHENKBN(2)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(4)
                                         = WK-2010-JYUHEN-TAIKBN(3)) AND
                   (WK-HBTNUM(4)         = WK-HBTNUM(3)            ) AND
                   (WK-2010-JYUHENKBN(4) = WK-2010-JYUHENKBN(3)    ))
                 CONTINUE
               ELSE
                 MOVE    4    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
           END-EVALUATE
      *
           .
      *
       2201481-SYU-CHECKHBT-XXX-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¼ýÇ¼¥Ç¡¼¥¿¤ÎË¡ÊÌÈÖ¹æÅù¤Î¥Á¥§¥Ã¥¯
      ******************************************************************
       2201482-SYU-CHECKHBT-YYY-SEC          SECTION.
      *
           EVALUATE  IDX16
             WHEN      1
               IF ((WK-2010-JYUHEN-TAIKBN(1)
                                         = WK-2010-JYUHEN-TAIKBN(2)) AND
                   (WK-2010-JYUHENKBN(1) = WK-2010-JYUHENKBN(2)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(1)
                                         = WK-2010-JYUHEN-TAIKBN(3)) AND
                   (WK-2010-JYUHENKBN(1) = WK-2010-JYUHENKBN(3)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(1)
                                         = WK-2010-JYUHEN-TAIKBN(4)) AND
                   (WK-2010-JYUHENKBN(1) = WK-2010-JYUHENKBN(4)    ))
                 CONTINUE
               ELSE
                 MOVE    1    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
             WHEN      2
               IF ((WK-2010-JYUHEN-TAIKBN(2)
                                         = WK-2010-JYUHEN-TAIKBN(1)) AND
                   (WK-2010-JYUHENKBN(2) = WK-2010-JYUHENKBN(1)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(2)
                                         = WK-2010-JYUHEN-TAIKBN(3)) AND
                   (WK-2010-JYUHENKBN(2) = WK-2010-JYUHENKBN(3)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(2)
                                         = WK-2010-JYUHEN-TAIKBN(4)) AND
                   (WK-2010-JYUHENKBN(2) = WK-2010-JYUHENKBN(4)    ))
                 CONTINUE
               ELSE
                 MOVE    2    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
             WHEN      3
               IF ((WK-2010-JYUHEN-TAIKBN(3)
                                         = WK-2010-JYUHEN-TAIKBN(1)) AND
                   (WK-2010-JYUHENKBN(3) = WK-2010-JYUHENKBN(1)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(3)
                                         = WK-2010-JYUHEN-TAIKBN(2)) AND
                   (WK-2010-JYUHENKBN(3) = WK-2010-JYUHENKBN(2)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(3)
                                         = WK-2010-JYUHEN-TAIKBN(4)) AND
                   (WK-2010-JYUHENKBN(3) = WK-2010-JYUHENKBN(4)    ))
                 CONTINUE
               ELSE
                 MOVE    3    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
             WHEN      4
               IF ((WK-2010-JYUHEN-TAIKBN(4)
                                         = WK-2010-JYUHEN-TAIKBN(1)) AND
                   (WK-2010-JYUHENKBN(4) = WK-2010-JYUHENKBN(1)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(4)
                                         = WK-2010-JYUHEN-TAIKBN(2)) AND
                   (WK-2010-JYUHENKBN(4) = WK-2010-JYUHENKBN(2)    ))
               OR ((WK-2010-JYUHEN-TAIKBN(4)
                                         = WK-2010-JYUHEN-TAIKBN(3)) AND
                   (WK-2010-JYUHENKBN(4) = WK-2010-JYUHENKBN(3)    ))
                 CONTINUE
               ELSE
                 MOVE    4    TO  WK-CHECK2010X-TAISYOIDX(IDX17)
               END-IF
           END-EVALUATE
      *
           .
      *
       2201482-SYU-CHECKHBT-YYY-EXT.
           EXIT.
      *
      ******************************************************************
      *    £·£µºÐÅþÃ£·î¤ÎÆÃÎã¡Ê¸½ÊªµëÉÕ¤Ç¤Ê¤¤¾ì¹ç¡¢Ä¹´ü¤¢¤ê¡Ë
      ******************************************************************
       22015-TOKU75-CYO-HENSYU-SEC          SECTION.
      *
           IF  ( WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
           AND ((SYU-KOH1HKNNUM   = "972" OR "974") OR
                (SYU-KOH2HKNNUM   = "972" OR "974") OR
                (SYU-KOH3HKNNUM   = "972" OR "974") OR
                (SYU-KOH4HKNNUM   = "972" OR "974"))
             IF    FLG-MARUKO  =  ZERO
               IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                    (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                    (COMB-KOH4HKNNUM   =  "972" OR "974"))
               AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
               AND ( SYU-KOH2HKNNUM    =   SPACE         )
               AND ( SYU-KOH3HKNNUM    =   SPACE         )
               AND ( SYU-KOH4HKNNUM    =   SPACE         )
               AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                  MOVE  ZERO                TO   WK-SYU-SYUCOMPFTN
                  MOVE  ZERO                TO   WK-ENTANI
                  MOVE  1                   TO   FLG-TAISYO
               ELSE
                  MOVE  SYU-KOH-FTN         TO   WK-SYU-SYUCOMPFTN
                  ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
                  MOVE  SYU-KOH-FTN-ENTANI  TO   WK-ENTANI
                  PERFORM  22018-ENTANI-HENSYU-SEC
                  ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
                  MOVE  ZERO                TO   FLG-TAISYO
               END-IF
             ELSE
               IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                   (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
               OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                   (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
               OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                   (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
               OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                   (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               ELSE
                 MOVE  SYU-KOH-FTN         TO   WK-SYU-SYUCOMPFTN
                 ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
                 MOVE  SYU-KOH-FTN-ENTANI  TO   WK-ENTANI
                 PERFORM  22018-ENTANI-HENSYU-SEC
                 ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
                 MOVE   ZERO               TO   FLG-TAISYO
               END-IF
             END-IF
           ELSE
               MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
               MOVE   ZERO  TO  WK-ENTANI
               MOVE   1     TO  FLG-TAISYO
           END-IF
      *
           .
      *
       22015-TOKU75-CYO-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¤½¤ÎÂ¾¡ÊÄ¹´ü¤¢¤ê¡Ë
      ******************************************************************
       22016-CYOKI-ARI-HENSYU-SEC          SECTION.
      *
           IF  ( WK-HKNJANUM2-TBL = WK-HKNJANUM-TBL)
           AND ((SYU-KOH1HKNNUM   = "972" OR "974") OR
                (SYU-KOH2HKNNUM   = "972" OR "974") OR
                (SYU-KOH3HKNNUM   = "972" OR "974") OR
                (SYU-KOH4HKNNUM   = "972" OR "974"))
             IF    FLG-MARUKO  =  ZERO
               IF  ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                    (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                    (COMB-KOH4HKNNUM   =  "972" OR "974"))
               AND ( SYU-KOH1HKNNUM    =  "972" OR "974" )
               AND ( SYU-KOH2HKNNUM    =   SPACE         )
               AND ( SYU-KOH3HKNNUM    =   SPACE         )
               AND ( SYU-KOH4HKNNUM    =   SPACE         )
               AND ( WK-CHECK-TEKYMD  <= WK-CHECK2-TEKYMD)
                  MOVE  ZERO                TO   WK-SYU-SYUCOMPFTN
                  MOVE  ZERO                TO   WK-ENTANI
                  MOVE  1                   TO   FLG-TAISYO
               ELSE
                  MOVE  SYU-KOH-FTN         TO   WK-SYU-SYUCOMPFTN
                  ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
                  MOVE  SYU-KOH-FTN-ENTANI  TO   WK-ENTANI
                  PERFORM  22018-ENTANI-HENSYU-SEC
                  ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
                  MOVE  ZERO                TO   FLG-TAISYO
               END-IF
             ELSE
               IF ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                   (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
               OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                   (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
               OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                   (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
               OR ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                   (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                 MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
                 MOVE   ZERO  TO  WK-ENTANI
                 MOVE   1     TO  FLG-TAISYO
               ELSE
                 MOVE  SYU-KOH-FTN         TO   WK-SYU-SYUCOMPFTN
                 ADD   WK-SYU-SYUCOMPFTN   TO   FTN-SYU-M
                 MOVE  SYU-KOH-FTN-ENTANI  TO   WK-ENTANI
                 PERFORM  22018-ENTANI-HENSYU-SEC
                 ADD   WK-ENTANI           TO   FTN-SYU-M-ENTANI
                 MOVE   ZERO               TO   FLG-TAISYO
               END-IF
             END-IF
           ELSE
               MOVE   ZERO  TO  WK-SYU-SYUCOMPFTN
               MOVE   ZERO  TO  WK-ENTANI
               MOVE   1     TO  FLG-TAISYO
           END-IF
      *
           .
      *
       22016-CYOKI-ARI-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¼ýÇ¼ÊÝ¸±¾ðÊóÊÔ½¸
      ******************************************************************
       22017-SYUNOU-HKN-HENSYU-SEC           SECTION.
      *
           MOVE    ZERO               TO   FLG-SYUNOU-HKN-HANTEI
      *    ÊÝ¸±ÁÈ¹ç¤»¥Þ¥¹¥¿¤Î¸¡º÷
           INITIALIZE                      WRK-HKNCOMBI-REC
           MOVE    SYU-HOSPNUM        TO   WRK-COMB-HOSPNUM
           MOVE    SYU-PTID           TO   WRK-COMB-PTID
           MOVE    SYU-HKNCOMBINUM    TO   WRK-COMB-HKNCOMBINUM
           MOVE    WRK-HKNCOMBI-REC   TO   MCPDATA-REC
           MOVE    "DBSELECT"         TO   MCP-FUNC
           MOVE    "tbl_hkncombi"     TO   MCP-TABLE
           MOVE    "key"              TO   MCP-PATHNAME
           CALL    "ORCDBMAIN"     USING   MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_hkncombi" TO   MCP-TABLE
               MOVE    "key"          TO   MCP-PATHNAME
               PERFORM  HKNCOMBI-READ2-SEC
               IF      FLG-HKNCOMBI     =       1
                   DISPLAY "HKNCOMBI DBFETCH ERR"
                   MOVE     10             TO   LNK-S02-RC
                   MOVE    "tbl_hkncombi"  TO   MCP-TABLE
                   MOVE    "key"           TO   MCP-PATHNAME
                   PERFORM  DB-CLOSE-SEC
                   MOVE     1              TO   FLG-SYUNOU-HKN-HANTEI
               END-IF
           ELSE
               MOVE    1              TO   FLG-HKNCOMBI
               DISPLAY "HKNCOMBI DBSELECT ERR"
               MOVE     10            TO   LNK-S02-RC
               MOVE    "tbl_hkncombi" TO   MCP-TABLE
               MOVE    "key"          TO   MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
               MOVE     1             TO   FLG-SYUNOU-HKN-HANTEI
           END-IF
           IF  FLG-SYUNOU-HKN-HANTEI = ZERO
               MOVE    "tbl_hkncombi" TO   MCP-TABLE
               MOVE    "key"          TO   MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
           END-IF
      *
           MOVE   SPACE              TO    WK-HKNJANUM2-TBL
           MOVE   SPACE              TO    WK-CONTKBN2
           INITIALIZE                      PTHKNINF-REC
           MOVE   WRK-COMB-HOSPNUM   TO    PTHKN-HOSPNUM
           MOVE   WRK-COMB-PTID      TO    PTHKN-PTID
           MOVE   WRK-COMB-HKNID     TO    PTHKN-HKNID
           MOVE   PTHKNINF-REC       TO    MCPDATA-REC
           MOVE   "DBSELECT"         TO    MCP-FUNC
           MOVE   "tbl_pthkninf"     TO    MCP-TABLE
           MOVE   "key"              TO    MCP-PATHNAME
           CALL   "ORCDBMAIN"        USING MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
           IF      MCP-RC            =     ZERO
               MOVE    "tbl_pthkninf"     TO    MCP-TABLE
               MOVE    "key"              TO    MCP-PATHNAME
               PERFORM  PTHKNINF-READ-SEC
               IF      FLG-PTHKNINF   =     ZERO
                  MOVE  PTHKN-HKNJANUM    TO    WK-HKNJANUM2
                  MOVE  PTHKN-HONKZKKBN   TO    WK-HONKZKKBN2
      ***         MOVE  PTHKN-KIGO        TO    WK-KIGO2
      ***         MOVE  PTHKN-NUM         TO    WK-NUM2
                  MOVE  PTHKN-CONTKBN     TO    WK-CONTKBN2
               END-IF
           END-IF
           MOVE     "tbl_pthkninf"   TO    MCP-TABLE
           MOVE     "key"            TO    MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           IF  (WK-CONTKBN   NOT = SPACE)
           OR  (WK-CONTKBN2  NOT = SPACE)
              IF  (WK-HKNJANUM2  = WK-HKNJANUM )
              AND (WK-HONKZKKBN2 = WK-HONKZKKBN)
                MOVE  WK-KIGO       TO  WK-KIGO2
                MOVE  WK-NUM        TO  WK-NUM2
              END-IF
           END-IF
      *
           IF  (LNK-S02-KOUREI-NYUIN-KBN   =   "1" )
           OR  (FLG-KOREI-TANYUIN          =    1  )
           OR  (COMB-HKNNUM                =  "060")
              IF   WK-HKNJANUM2  = WK-HKNJANUM
                MOVE  WK-HONKZKKBN  TO  WK-HONKZKKBN2
                MOVE  WK-KIGO       TO  WK-KIGO2
                MOVE  WK-NUM        TO  WK-NUM2
              END-IF
           END-IF
      *
           MOVE   WK-HKNJANUM2-TBL      TO  WK-HKNJANUM3-TBL
           MOVE   WK-HKNJANUM2-TBL      TO  WK-HKNJANUM5-TBL
      *
           IF    (COMB-HKNNUM      =   "039")
           AND   (SYU-SYUHKNNUM    =   "039")
                 MOVE  WK-HKNJANUM-TBL  TO  WK-HKNJANUM2-TBL
           END-IF
      *
           MOVE    ZERO   TO   FLG-RUITAISYO
           EVALUATE  FLG-TOKU75
             WHEN        1
             WHEN        2
                 IF    COMB-HKNNUM    = "039"
                   IF  SYU-SYUHKNNUM  = "039"
                     IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                          MOVE    1    TO   FLG-RUITAISYO
                     END-IF
                   END-IF
                 ELSE
                   IF  FLG-TOKU75     =   1
                     IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                          MOVE    1    TO   FLG-RUITAISYO
                     END-IF
                   ELSE
                     IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                       IF ((WK-TOKU75-BIRTHDAY <= LNK-SYU-SRYYMD) AND
                           (WK-TOKU75-BIRTHDAY <= SYU-SRYYMD    ))
                       OR ((WK-TOKU75-BIRTHDAY >  LNK-SYU-SRYYMD) AND
                           (WK-TOKU75-BIRTHDAY >  SYU-SRYYMD    ))
                          MOVE    1    TO   FLG-RUITAISYO
                       ELSE
                          MOVE   "9"   TO   WK-HONKZKKBN2
                          MOVE  SPACE  TO   WK-KIGO2
                          MOVE  SPACE  TO   WK-NUM2
                       END-IF
                     END-IF
                   END-IF
                 END-IF
             WHEN        3
                 IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                   IF ((WK-TOKU75-BIRTHDAY <= LNK-SYU-SRYYMD) AND
                       (WK-TOKU75-BIRTHDAY <= SYU-SRYYMD    ))
                   OR ((WK-TOKU75-BIRTHDAY >  LNK-SYU-SRYYMD) AND
                       (WK-TOKU75-BIRTHDAY >  SYU-SRYYMD    ))
                      MOVE    1    TO   FLG-RUITAISYO
                   ELSE
                      MOVE   "9"   TO   WK-HONKZKKBN2
                      MOVE  SPACE  TO   WK-KIGO2
                      MOVE  SPACE  TO   WK-NUM2
                   END-IF
                 END-IF
           END-EVALUATE
      *
           IF     COMB-HKNNUM      =   "039"
             CONTINUE
           ELSE
             MOVE   WK-HKNJANUM2-TBL  TO  WK-HKNJANUM3-TBL
           END-IF
      *
           IF  (FLG-GENBUTU70    NOT =  ZERO)
           AND (FLG-OITA-GENBUTU70   =  ZERO)
               IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                 IF  ((SYU-SRYYMD  <  WK-GEN70-YMD   ) AND
                      (SYU-SKJ-FTNGAKU(2)     = ZERO ))
                 OR  ((SYU-SRYYMD  >  WK-GEN70-YMD-ED) AND
                      (SYU-SKJ-FTNGAKU(2)     = ZERO ))
                 OR  ((SYU-SKJ-FTNGAKU(2) NOT = ZERO ) AND
                      (SYU-SKJ-FTNGAKU(2) NOT =
                             LNK-SYU-SKJ-FTNGAKU(2)  ))
                    MOVE   "9"   TO   WK-HONKZKKBN2
                    MOVE  SPACE  TO   WK-KIGO2
                    MOVE  SPACE  TO   WK-NUM2
                 END-IF
                 IF   (FLG-GENBUTU-CHECK         =  1  )
                 AND  (LNK-SYU-TOTAL-HKNTEN  NOT = ZERO)
                   IF   (COMB-HKNID    NOT =  ZERO              )
                   AND  (COMB-HKNID        =  WRK-COMB-HKNID    )
                   AND  (LNK-SYU-SKJ-FTNGAKU(2)
                                       NOT =  SYU-SKJ-FTNGAKU(2))
                      MOVE    1    TO   FLG-GENBUTU-CHECK-ERR
                   END-IF
                   IF   (SYU-SKJ-FTNGAKU(2)   =  ZERO           )
                   AND  (WK-GEN70-YMD        <=  SYU-SRYYMD     )
                   AND  (SYU-SRYYMD          <=  WK-GEN70-YMD-ED)
                      MOVE    1    TO   FLG-GENBUTU-CHECK-ERR
                   END-IF
                 END-IF
               END-IF
           END-IF
           IF  LNK-S02-KOUREI-NYUIN-KBN    =  "1"
           OR  FLG-KOREI-TANYUIN           =   1
               IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                 IF   (SYU-SKJ-FTNGAKU(2) NOT = ZERO)
                 AND  (SYU-SKJ-FTNGAKU(2) NOT =
                             LNK-SYU-SKJ-FTNGAKU(2) )
                    MOVE   "9"   TO   WK-HONKZKKBN2
                    MOVE  SPACE  TO   WK-KIGO2
                    MOVE  SPACE  TO   WK-NUM2
                 END-IF
                 IF   (FLG-GENBUTU-CHECK         =  1  )
                 AND  (LNK-SYU-TOTAL-HKNTEN  NOT = ZERO)
                   IF   (COMB-HKNID    NOT =  ZERO              )
                   AND  (COMB-HKNID        =  WRK-COMB-HKNID    )
                   AND  (LNK-SYU-SKJ-FTNGAKU(2)
                                       NOT =  SYU-SKJ-FTNGAKU(2))
                      MOVE    1    TO   FLG-GENBUTU-CHECK-ERR
                   END-IF
                 END-IF
               END-IF
           END-IF
           IF  ( LNK-S02-KOUREI-NYUIN-KBN    =  "1"  )
           OR  ( FLG-KOREI-TANYUIN           =   1   )
           OR  ((FLG-GENBUTU70           NOT =  ZERO) AND
                (FLG-OITA-GENBUTU70          =  ZERO))
               CONTINUE
           ELSE
               IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM2-TBL
                 IF    SYU-SKJ-FTNGAKU(2) NOT = ZERO
                    MOVE   "9"   TO   WK-HONKZKKBN2
                    MOVE  SPACE  TO   WK-KIGO2
                    MOVE  SPACE  TO   WK-NUM2
                 END-IF
               END-IF
           END-IF
      *
           IF     COMB-HKNNUM      =   "039"
             IF  LNK-S02-KOUREI-NYUIN-KBN    =  "1"
             OR  FLG-KOREI-TANYUIN           =   1
               IF    WK-HKNJANUM-TBL  =  WK-HKNJANUM5-TBL
                 IF   (SYU-SKJ-FTNGAKU(2) NOT = ZERO)
                 AND  (SYU-SKJ-FTNGAKU(2) NOT =
                             LNK-SYU-SKJ-FTNGAKU(2) )
                    MOVE   "9"   TO   WK-HONKZKKBN5
                    MOVE  SPACE  TO   WK-KIGO5
                    MOVE  SPACE  TO   WK-NUM5
                 END-IF
               END-IF
             END-IF
             MOVE   WK-HKNJANUM5-TBL  TO  WK-HKNJANUM4-TBL
           ELSE
             MOVE   WK-HKNJANUM2-TBL  TO  WK-HKNJANUM4-TBL
           END-IF
      *
      ***
      *
      *    ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»Å¬ÍÑ³«»ÏÆü¥Á¥§¥Ã¥¯
           MOVE      SYU-SRYYMD(1:6)        TO   WK-CHECK2-TEKYM
           IF   WRK-COMB-TEKSTYMD(1:6)  >=  SYU-SRYYMD(1:6)
              MOVE   WRK-COMB-TEKSTYMD(7:2) TO   WK-CHECK2-TEKDD
           ELSE
              MOVE   01                     TO   WK-CHECK2-TEKDD
           END-IF
      *
           .
      *
       22017-SYUNOU-HKN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ±ßÃ±°ÌÊÔ½¸
      ******************************************************************
       22018-ENTANI-HENSYU-SEC          SECTION.
      *
      ***  IF    @@@
             COMPUTE WK-ENTANI = WK-ENTANI + 0.9
             MOVE    WK-ENTANI   TO  WK-ENTANI2
             MOVE    WK-ENTANI2  TO  WK-ENTANI
      ***  END-IF
      *
           .
      *
       22018-ENTANI-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ±ßÃ±°ÌÊÔ½¸£²
      ******************************************************************
       22019-ENTANI-HENSYU2-SEC          SECTION.
      *
      ***  IF    @@@
             COMPUTE  WK-TOKUSYU-KEISAN-EN1 = WK-TOKUSYU-KEISAN-EN1
                                            + 0.9
             COMPUTE  WK-TOKUSYU-KEISAN-EN2 = WK-TOKUSYU-KEISAN-EN2
                                            + 0.9
             MOVE  WK-TOKUSYU-KEISAN-EN1   TO  WK-TOKUSYU-KEISAN-EN11
             MOVE  WK-TOKUSYU-KEISAN-EN2   TO  WK-TOKUSYU-KEISAN-EN21
             MOVE  WK-TOKUSYU-KEISAN-EN11  TO  WK-TOKUSYU-KEISAN-EN1
             MOVE  WK-TOKUSYU-KEISAN-EN21  TO  WK-TOKUSYU-KEISAN-EN2
      ***  END-IF
           COMPUTE    WK-TOKUSYU-KEISAN-EN3 = WK-TOKUSYU-KEISAN-EN1
                                            - WK-TOKUSYU-KEISAN-EN2
      *
           .
      *
       22019-ENTANI-HENSYU2-EXT.
           EXIT.
      *
      ******************************************************************
      *    Ä¹´ü¤ÎÈ½Äê
      ******************************************************************
       2201A-CYOKI-HANTEI-SEC          SECTION.
      *
           IF  ( WK-HKNJANUM-TBL   =   WK-HKNJANUM2-TBL)
           AND ((COMB-KOH2HKNNUM   =  "972" OR "974") OR
                (COMB-KOH3HKNNUM   =  "972" OR "974") OR
                (COMB-KOH4HKNNUM   =  "972" OR "974")  )
           AND ( SYU-KOH1HKNNUM    =  "972" OR "974"   )
           AND ( SYU-KOH2HKNNUM    =   SPACE           )
           AND ( SYU-KOH3HKNNUM    =   SPACE           )
           AND ( SYU-KOH4HKNNUM    =   SPACE           )
           AND ( LNK-SYU-TOTAL-HKNTEN     NOT = ZERO   )
           AND ( SYU-TOTAL-HKNTEN         NOT = ZERO   )
           AND ( LNK-SYU-SRYYMD(1:6)  >=  "202001"     )
             IF ((COMB-KOH2HKNNUM     = "972" OR "974"  ) AND
                 (SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                 (COMB-KOH2ID         =  WRK-COMB-KOH1ID))
             OR ((COMB-KOH3HKNNUM     = "972" OR "974"  ) AND
                 (SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                 (COMB-KOH3ID         =  WRK-COMB-KOH1ID))
             OR ((COMB-KOH4HKNNUM     = "972" OR "974"  ) AND
                 (SYU-KOH1HKNNUM      = "972" OR "974"  ) AND
                 (COMB-KOH4ID         =  WRK-COMB-KOH1ID))
               IF   WK-CHECK-TEKYMD  >  WK-CHECK2-TEKYMD
                 CONTINUE
               ELSE
                 MOVE    1     TO  WK-CYOKI-RESULT
               END-IF
             END-IF
           END-IF
      *
           IF  ( WK-HKNJANUM-TBL   =   WK-HKNJANUM2-TBL)
           AND ( COMB-KOH1HKNNUM   =  "972" OR "974"   )
           AND ( COMB-KOH2HKNNUM   =   SPACE           )
           AND ( COMB-KOH3HKNNUM   =   SPACE           )
           AND ( COMB-KOH4HKNNUM   =   SPACE           )
           AND ((SYU-KOH2HKNNUM    =  "972" OR "974") OR
                (SYU-KOH3HKNNUM    =  "972" OR "974") OR
                (SYU-KOH4HKNNUM    =  "972" OR "974")  )
           AND ( LNK-SYU-TOTAL-HKNTEN     NOT = ZERO   )
           AND ( SYU-TOTAL-HKNTEN         NOT = ZERO   )
           AND ( LNK-SYU-SRYYMD(1:6)  >=  "202001"     )
             IF ((COMB-KOH1HKNNUM     = "972" OR "974"  ) AND
                 (SYU-KOH2HKNNUM      = "972" OR "974"  ) AND
                 (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
             OR ((COMB-KOH1HKNNUM     = "972" OR "974"  ) AND
                 (SYU-KOH3HKNNUM      = "972" OR "974"  ) AND
                 (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
             OR ((COMB-KOH1HKNNUM     = "972" OR "974"  ) AND
                 (SYU-KOH4HKNNUM      = "972" OR "974"  ) AND
                 (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
               IF   WK-CHECK-TEKYMD  <  WK-CHECK2-TEKYMD
                 CONTINUE
               ELSE
                 MOVE    1     TO  WK-CYOKI-RESULT
                 PERFORM  2201A1-CYOKI-HANTEI2-SEC
               END-IF
             END-IF
           END-IF
      *
           .
      *
       2201A-CYOKI-HANTEI-EXT.
           EXIT.
      *
      ******************************************************************
      *    Ä¹´ü¤ÎÈ½Äê
      ******************************************************************
       2201A1-CYOKI-HANTEI2-SEC          SECTION.
      *
           COMPUTE WK-FUTANWARI =
                   WK-SYUNOU-GENBUTU70-FTNRATE / 100
           COMPUTE WK-CYOKI-KEISAN3 =
                   SYU-TOTAL-HKNTEN * 10 * WK-FUTANWARI
           COMPUTE WK-CYOKI-KEISAN3 = WK-CYOKI-KEISAN3 +  5
           COMPUTE WK-CYOKI-KEISAN3 = WK-CYOKI-KEISAN3 / 10
           COMPUTE WK-CYOKI-KEISAN3 = WK-CYOKI-KEISAN3 * 10
           COMPUTE WK-CYOKI-KEISAN2 =
                   SYU-TOTAL-HKNTEN * 10 * WK-FUTANWARI
      *
           IF   WK-CYOKI-KEISAN3  >  SYU-KOH-FTN
             COMPUTE  WK-CYOKI-KEISAN  =  WK-CYOKI-KEISAN3
                                       -  SYU-KOH-FTN
             ADD   WK-CYOKI-KEISAN    TO  WK-CYOKI-FTN-SYU-M
           END-IF
           MOVE  SYU-KOH-FTN-ENTANI   TO  WK-ENTANI
           PERFORM  22018-ENTANI-HENSYU-SEC
           IF   WK-CYOKI-KEISAN2  >  WK-ENTANI
             COMPUTE  WK-CYOKI-KEISAN  =  WK-CYOKI-KEISAN2
                                       -  WK-ENTANI
             ADD   WK-CYOKI-KEISAN    TO  WK-CYOKI-FTN-SYU-M-ENTANI
           END-IF
      *
           .
      *
       2201A1-CYOKI-HANTEI2-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¼çÊÝ¸±¤Î¸º³Û¡Ê¡Ü¡÷¡Ë                                    *
      *        Á´¹ñ¸øÈñ¤Î¸º³Û¡Ê¡Ü¡÷¡Ë                                  *
      ******************************************************************
       2202-KOHFTN-KINGAKU-GEN2-SEC           SECTION.
      *
           IF  FLG-GENBUTU70   NOT =   ZERO
               IF  (FLG-IRYOHI70   NOT =  ZERO)
               AND (MAX-KIN-SYU-M  NOT =  ZERO)
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-SYU-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-SYU-M       =
                                  (MAX-KIN-SYU-M       *
                                   WK-GENGAKU-RITUX    /
                                   100) + 0.5
                        END-IF
                     WHEN          2
                        IF  MAX-KIN-SYU-M < WK-GENGAKU-KIN
                          MOVE   ZERO   TO   MAX-KIN-SYU-M
                        ELSE
                          COMPUTE  MAX-KIN-SYU-M  =
                                   MAX-KIN-SYU-M  -
                                   WK-GENGAKU-KIN
                        END-IF
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-SYU-M
                     WHEN          5
                        IF  MAX-KIN-SYU-M > WK-GENGAKU-KIN
                          COMPUTE  MAX-KIN-SYU-M  =
                                   WK-GENGAKU-KIN
                        END-IF
                   END-EVALUATE
                   IF   MAX-KIN-SYU-M  =  ZERO
                     MOVE     ZERO   TO   FLG-KOUGAKUCYO-GEN70
                   END-IF
               END-IF
               IF  (FLG-IRYOHI70K    =  1  OR  2)
               AND (MAX-KIN-KOHI1-M  NOT =  ZERO)
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-KOHI1-M     =
                                  (MAX-KIN-KOHI1-M     *
                                   WK-GENGAKU-RITUX    /
                                   100) + 0.5
                        END-IF
                     WHEN          2
                        IF  MAX-KIN-KOHI1-M < WK-GENGAKU-KIN
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                        ELSE
                          COMPUTE  MAX-KIN-KOHI1-M  =
                                   MAX-KIN-KOHI1-M  -
                                   WK-GENGAKU-KIN
                        END-IF
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                     WHEN          5
                        IF  MAX-KIN-KOHI1-M > WK-GENGAKU-KIN
                          COMPUTE  MAX-KIN-KOHI1-M  =
                                   WK-GENGAKU-KIN
                        END-IF
                   END-EVALUATE
                   IF   MAX-KIN-KOHI1-M  =  ZERO
                     MOVE     ZERO   TO   FLG-KOUGAKUCYO-GEN70K
                   END-IF
               END-IF
               IF  (FLG-IRYOHI70K           =  1  OR  2)
               AND (MAX-KIN-KOHI1-M-TOKU75  NOT =  ZERO)
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M-TOKU75
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-KOHI1-M-TOKU75     =
                                  (MAX-KIN-KOHI1-M-TOKU75     *
                                   WK-GENGAKU-RITUX    /
                                   100) + 0.5
                        END-IF
                     WHEN          2
                        IF  MAX-KIN-KOHI1-M-TOKU75 < WK-GENGAKU-KIN
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M-TOKU75
                        ELSE
                          COMPUTE  MAX-KIN-KOHI1-M-TOKU75  =
                                   MAX-KIN-KOHI1-M-TOKU75  -
                                   WK-GENGAKU-KIN
                        END-IF
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-KOHI1-M-TOKU75
                     WHEN          5
                        IF  MAX-KIN-KOHI1-M-TOKU75 > WK-GENGAKU-KIN
                          COMPUTE  MAX-KIN-KOHI1-M-TOKU75  =
                                   WK-GENGAKU-KIN
                        END-IF
                   END-EVALUATE
                   IF   MAX-KIN-KOHI1-M-TOKU75  =  ZERO
                     MOVE     ZERO   TO   FLG-KOUGAKUCYO-GEN70K-TOKU75
                   END-IF
               END-IF
           ELSE
               IF   ((FLG-IRYOHI           =  1   ) OR
                     (FLG-IRYOHI3          =  1   ) OR
                     (FLG-IRYOHI4          =  1   ))
               AND  ( MAX-KIN-KOHI1-M  NOT =  ZERO )
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-KOHI1-M     =
                                  (MAX-KIN-KOHI1-M     *
                                   WK-GENGAKU-RITUX    /
                                   100) + 0.5
                        END-IF
                     WHEN          2
                        IF  MAX-KIN-KOHI1-M < WK-GENGAKU-KIN
                          MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                        ELSE
                          COMPUTE  MAX-KIN-KOHI1-M  =
                                   MAX-KIN-KOHI1-M  -
                                   WK-GENGAKU-KIN
                        END-IF
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-KOHI1-M
                     WHEN          5
                        IF  MAX-KIN-KOHI1-M > WK-GENGAKU-KIN
                          COMPUTE  MAX-KIN-KOHI1-M  =
                                   WK-GENGAKU-KIN
                        END-IF
                   END-EVALUATE
                   IF   FLG-IRYOHI       =   1
                   AND  MAX-KIN-KOHI1-M  =  ZERO
                       MOVE     ZERO     TO    FLG-KOUGAKUCYO
                   END-IF
                   IF   FLG-IRYOHI3      =   1
                   AND  MAX-KIN-KOHI1-M  =  ZERO
                       MOVE     ZERO     TO    FLG-KOUGAKUCYO3
                   END-IF
                   IF   FLG-IRYOHI4      =   1
                   AND  MAX-KIN-KOHI1-M  =  ZERO
                       MOVE     ZERO     TO    FLG-KOUGAKUCYO-JIRITU
                   END-IF
               END-IF
               IF   ((FLG-IRYOHI           =  2     ) OR
                     (FLG-IRYOHI3          =  2 OR 3) OR
                     (FLG-IRYOHIKG     NOT =  ZERO  ) OR
                     (FLG-IRYOHIKG2    NOT =  ZERO  ))
               AND  ( MAX-KIN-SYU-M    NOT =  ZERO   )
                   EVALUATE   WK-GENGAKUKBN
                     WHEN          1
                        IF  WK-GENGAKU-RITU = 100
                          MOVE   ZERO   TO   MAX-KIN-SYU-M
                        ELSE
                          COMPUTE  WK-GENGAKU-RITUX =
                                   100 - WK-GENGAKU-RITU
                          COMPUTE  MAX-KIN-SYU-M       =
                                  (MAX-KIN-SYU-M       *
                                   WK-GENGAKU-RITUX    /
                                   100) + 0.5
                        END-IF
                     WHEN          2
                        IF  MAX-KIN-SYU-M < WK-GENGAKU-KIN
                          MOVE   ZERO   TO   MAX-KIN-SYU-M
                        ELSE
                          COMPUTE  MAX-KIN-SYU-M  =
                                   MAX-KIN-SYU-M  -
                                   WK-GENGAKU-KIN
                        END-IF
                     WHEN          3
                     WHEN          4
                        MOVE   ZERO   TO   MAX-KIN-SYU-M
                     WHEN          5
                        IF  MAX-KIN-SYU-M > WK-GENGAKU-KIN
                          COMPUTE  MAX-KIN-SYU-M  =
                                   WK-GENGAKU-KIN
                        END-IF
                   END-EVALUATE
                   IF   ((FLG-IRYOHI         =  2     ) OR
                         (FLG-IRYOHIKG   NOT =  ZERO  ))
                   AND  ( MAX-KIN-SYU-M      =  ZERO   )
                       MOVE     ZERO     TO    FLG-KOUGAKUCYO
                   END-IF
                   IF   ((FLG-IRYOHI3        =  2 OR 3) OR
                         (FLG-IRYOHIKG2  NOT =  ZERO  ))
                   AND  ( MAX-KIN-SYU-M      =  ZERO   )
                       MOVE     ZERO     TO    FLG-KOUGAKUCYO3
                   END-IF
               END-IF
           END-IF
      *
           .
      *
       2202-KOHFTN-KINGAKU-GEN2-EXT.
           EXIT.
      *
      ******************************************************************
      *    Æü¡¦·î¾å¸Â³ÛÉéÃ´·×»»¶èÊ¬ÊÔ½¸
      ******************************************************************
       2203-JGNFTNKBN-HENSYU-SEC          SECTION.
      *
           PERFORM   VARYING   KOHFUKA-IDX2   FROM   1   BY   1
                      UNTIL    KOHFUKA-IDX2    >     4
      *
             IF    (LNK-SYU-KOH-HKNNUM(KOHFUKA-IDX2)(1:1)
                                               >= "1" AND <= "8")
             AND   (WK-KOHJGNGET-TAISYOKBN(KOHFUKA-IDX2)   =  2 )
                  MOVE    KOHFUKA-IDX2     TO  FLG-NYUGAI2
             ELSE
               IF  (LNK-SYU-KOH-HKNNUM(KOHFUKA-IDX2)(1:1)
                                               >= "1" AND <= "8")
               AND (LNK-SYU-SRYYMD(1:6)        >= "201010"      )
                  EVALUATE  WK-2010-JGNFTNKBN(KOHFUKA-IDX2)
                    WHEN      "1"
                         MOVE  KOHFUKA-IDX2  TO  FLG-NYUGAI2
                  END-EVALUATE
               END-IF
             END-IF
      *
           END-PERFORM
      *
           .
      *
       2203-JGNFTNKBN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ³Æ¼ï¥Õ¥é¥°ÊÔ½¸
      ******************************************************************
       2204-FLG-HENSYU-SEC          SECTION.
      *
           IF  (WK-1001-PREFNUM  =  13           )
           AND (COMB-HKNNUM      = "060" OR "067")
           AND (COMB-KOH1HKNNUM  = "588"         )
           AND (LNK-SYU-SRYYMD(1:6) >= "200710"  )
           AND (LNK-SYU-SRYYMD(1:6) <= "200909"  )
              IF (FLG-GENBUTU70    NOT =   ZERO)
              OR (FLG-TOKU75-CYO       =    3  )
              OR (FLG-CYOKI-ARI        =    2  )
                   MOVE    2    TO   FLG-MARUKO
              END-IF
           END-IF
      *
           IF  ((FLG-IRYOHI70                =  ZERO   ) AND
                (FLG-KOHYONKAIME             =   1     ) AND
                (FLG-OITA-GENBUTU70          =  ZERO   ) AND
                (FLG-GENBUTU70               =   1     ) AND
                (WK-2010-NINJYOKBN(1)    NOT =  SPACE  ))
           OR  ((FLG-IRYOHI70                =  ZERO   ) AND
                (FLG-OITA-GENBUTU70          =   1     ) AND
                (FLG-GENBUTU70               =   2 OR 3) AND
                (WK-2010-NINNASIKBN(1)   NOT =  SPACE  ))
           OR  ((FLG-IRYOHIKG2               =  ZERO   ) AND
                (FLG-KOHYONKAIME             =   1     ) AND
                (FLG-OITA-GENBUTU70          =  ZERO   ) AND
                (LNK-S02-KOUREI-NYUIN-KBN    =  "1"    ) AND
                (LNK-SYU-SKJ-FTNGAKU(2)      =   1     ) AND
                (WK-2010-NINNASIKBN-K(1) NOT =  SPACE  ))
             IF  (LNK-SYU-KOH2HKNNUM      = "972" OR "974")
             OR  (LNK-SYU-KOH3HKNNUM      = "972" OR "974")
             OR  (LNK-SYU-KOH4HKNNUM      = "972" OR "974")
             OR  (LNK-SYU-KOH2HKNNUM(1:1) = "0"           )
             OR  (LNK-SYU-KOH3HKNNUM(1:1) = "0"           )
             OR  (LNK-SYU-KOH4HKNNUM(1:1) = "0"           )
               CONTINUE
             ELSE
               MOVE    1    TO   FLG-OITA-SYUKEI
             END-IF
           END-IF
      *
           IF   LNK-SYU-SYUHKNNUM  NOT =  SPACE
             IF   (FLG-TOKU75-CYO   =   3            )
             OR   (FLG-CYOKI-ARI    =   2            )
             OR   (LNK-S02-KOUREI-NYUIN-KBN    = "1" )
             OR   (FLG-GENBUTU70   NOT =  ZERO       )
               IF   WK-2010-KINJYOKBN-N(1) = "1"
                 MOVE    1    TO   FLG-TOKYO
               END-IF
             END-IF
             IF   (LNK-S02-KOUREI-NYUIN-KBN    = "1" )
             AND  (LNK-SYU-KOH1HKNNUM  =  "027"      )
               IF   WK-2010-KINJYOKBN-N(2) = "1"
                 MOVE    2    TO   FLG-TOKYO
               END-IF
             END-IF
           END-IF
      *
           IF   LNK-S02-KOUREI-NYUIN-KBN    =  "1"
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (WK-2010-IRYOKEIKBN-N(1)
                                        NOT = SPACE          )
              AND (LNK-SYU-KOH2HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972" AND "974")
      ***        IF   WK-2010-IRYOKEIKBN-N-XXX(1) = "1"
      ***          IF  (WK-1001-PREFNUM     =   11      )
      ***          AND (LNK-SYU-KOH1HKNNUM  =
      ***               "542" OR "682" OR "462" OR "762")
      ***            MOVE    1    TO   FLG-GEN70-TOKUSYU
      ***          END-IF
      ***        ELSE
                     MOVE    1    TO   FLG-GEN70-TOKUSYU
      ***        END-IF
              END-IF
           END-IF
      *
           IF   FLG-GENBUTU70         NOT =  ZERO
              IF  (LNK-SYU-SYUHKNNUM    NOT = SPACE          )
              AND (WK-2010-IRYOKEIKBN-N(1)
                                        NOT = SPACE          )
              AND (LNK-SYU-KOH2HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH3HKNNUM   NOT = "972" AND "974")
              AND (LNK-SYU-KOH4HKNNUM   NOT = "972" AND "974")
                     MOVE    1    TO   FLG-GEN70-TOKUSYU
              END-IF
           END-IF
      *
           IF  (LNK-SYU-SRYYMD(1:6)  >= "200904")
           AND (COMB-HKNNUM       NOT =  SPACE  )
           AND (COMB-KOH2HKNNUM   NOT =  SPACE  )
              IF ( LNK-SYU-KOH-HKNNUM(1) =
                   "015" OR "016" OR "021" OR "024" OR
                   "038" OR "051" OR "052" OR "079"    )
              OR ((LNK-SYU-KOH-HKNNUM(1) = "054"      ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "201501"   ))
              OR ((LNK-SYU-KOH-HKNNUM(1) = "092"      ) AND
                  (WK-KOHJGNGET-CHECK092(1)
                                         =  ZERO      ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "201812"   ))
              OR ( WK-TOKATUKAI(1)       =   1         )
              OR ( WK-2010-KINJYOKBN-N(1)
                                         =  "1"        )
                   MOVE    1    TO   FLG-RUIKEIYO
              END-IF
           END-IF
      *
           .
      *
       2204-FLG-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¡ã£±Æþ±¡²ó¿ôÂÐ±þ¡äÆþ±¡ÍúÎòÊÔ½¸
      ******************************************************************
       2205-RIREKI-HENSYU-SEC          SECTION.
      *
           INITIALIZE                WK-RRK-TBL
           INITIALIZE                WK-RRK2-TBL
           MOVE       ZERO     TO    RRK-IDX5
           MOVE       ZERO     TO    IDX15
      *
           IF  ((WK-2010-NYUKEIKBN-N(1)  =  "1" ) AND
                (MAX-KAI-KOHI1-M     NOT =  ZERO))
           OR  ((WK-2010-NYUKEIKBN-N(2)  =  "1" ) AND
                (MAX-KAI-KOHI2-M     NOT =  ZERO))
           OR  ((WK-2010-NYUKEIKBN-N(3)  =  "1" ) AND
                (MAX-KAI-KOHI3-M     NOT =  ZERO))
           OR  ((WK-2010-NYUKEIKBN-N(4)  =  "1" ) AND
                (MAX-KAI-KOHI4-M     NOT =  ZERO))
      *
             IF   WK-2010-NYUKEIKBN-N(1)  =  "1"
               MOVE      1     TO    WK-RRK2-FLG(1)
               MOVE      1     TO    IDX15
             END-IF
             IF   WK-2010-NYUKEIKBN-N(2)  =  "1"
               MOVE      1     TO    WK-RRK2-FLG(2)
               MOVE      2     TO    IDX15
             END-IF
             IF   WK-2010-NYUKEIKBN-N(3)  =  "1"
               MOVE      1     TO    WK-RRK2-FLG(3)
               MOVE      3     TO    IDX15
             END-IF
             IF   WK-2010-NYUKEIKBN-N(4)  =  "1"
               MOVE      1     TO    WK-RRK2-FLG(4)
               MOVE      4     TO    IDX15
             END-IF
      *
             PERFORM  VARYING  RRK-IDX  FROM  1  BY  1
                       UNTIL   RRK-IDX   >   31
      *
               IF ((LNK-SYU-DAY(RRK-IDX) = "1" OR "2" OR "8" OR "9") AND
                   (LNK-SDAY-HKNTEN(RRK-IDX)  NOT =  ZERO          ))
               OR ((LNK-S02-NYUINDAY-KBN(RRK-IDX) =  "1"           ) AND
                   (WK-2010-TANKIKBN(IDX15)       =  "1"           ))
      *
                 INITIALIZE                  PTNYUINRRK-REC
                 MOVE LNK-SYU-HOSPNUM     TO PTNYUINRRK-HOSPNUM
                 MOVE LNK-SYU-PTID        TO PTNYUINRRK-PTID
                 MOVE LNK-SYU-SRYYMD(1:6) TO PTNYUINRRK-NYUINYMD(1:6)
                 MOVE RRK-IDX             TO PTNYUINRRK-NYUINYMD(7:2)
                 MOVE LNK-SYU-SRYYMD(1:6) TO PTNYUINRRK-TAIINYMD(1:6)
                 MOVE RRK-IDX             TO PTNYUINRRK-TAIINYMD(7:2)
                 MOVE PTNYUINRRK-REC      TO MCPDATA-REC
                 MOVE "DBSELECT"          TO MCP-FUNC
                 MOVE "tbl_ptnyuinrrk"    TO MCP-TABLE
                 MOVE "key58"             TO MCP-PATHNAME
                 CALL "ORCDBMAIN"     USING  MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
                 IF    MCP-RC             =  ZERO
                   MOVE    "tbl_ptnyuinrrk"  TO  MCP-TABLE
                   MOVE    "key58"           TO  MCP-PATHNAME
                   PERFORM  PTNYUINRRK-READ-SEC
                   PERFORM  UNTIL   FLG-PTNYUINRRK  =   1
                     MOVE  PTNYUINRRK-NYUINYMD
                                     TO  WK-RRK-NYUINYMD(RRK-IDX)
                     MOVE       1    TO  FLG-PTNYUINRRK
                     IF    PTNYUINRRK-SHOKAIKBN     =  "1"
                       MOVE  ZERO    TO  WK-RRK-SHONUM(RRK-IDX)
                     ELSE
                       MOVE  PTNYUINRRK-SHONUM
                                     TO  WK-RRK-SHONUM(RRK-IDX)
                     END-IF
      ***            IF  PTNYUINRRK-DOUJITSUKBN  =  "1"
      ***              INITIALIZE        STS-AREA-DAY
      ***              INITIALIZE        LNK-DAY6-AREA
      ***              MOVE    "61"  TO  LNK-DAY6-IRAI
      ***              MOVE    PTNYUINRRK-NYUINYMD
      ***                            TO  LNK-DAY6-KIJUN
      ***              MOVE    "1"   TO  LNK-DAY6-ZOGENPTN
      ***              MOVE     1    TO  LNK-DAY6-ZOGEN
      ***              CALL    "ORCSDAY" USING   STS-AREA-DAY
      ***                                        LNK-DAY6-AREA
      ***              MOVE    LNK-DAY6-KEISAN
      ***                            TO  WK-RRK-NYUINYMD(RRK-IDX)
      ***            END-IF
                   END-PERFORM
                 END-IF
                 MOVE    "tbl_ptnyuinrrk" TO MCP-TABLE
                 MOVE    "key58"          TO MCP-PATHNAME
                 PERFORM  DB-CLOSE-SEC
      *
                 IF  WK-RRK-SHONUM(RRK-IDX)  NOT = ZERO
                   INITIALIZE                  PTNYUINRRK-REC
                   MOVE LNK-SYU-HOSPNUM     TO PTNYUINRRK-HOSPNUM
                   MOVE LNK-SYU-PTID        TO PTNYUINRRK-PTID
                   MOVE WK-RRK-SHONUM(RRK-IDX)
                                            TO PTNYUINRRK-SHONUM
                   MOVE PTNYUINRRK-REC      TO MCPDATA-REC
                   MOVE "DBSELECT"          TO MCP-FUNC
                   MOVE "tbl_ptnyuinrrk"    TO MCP-TABLE
                   MOVE "key57"             TO MCP-PATHNAME
                   CALL "ORCDBMAIN"     USING  MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
                   IF    MCP-RC             =  ZERO
                     MOVE    "tbl_ptnyuinrrk"  TO  MCP-TABLE
                     MOVE    "key57"           TO  MCP-PATHNAME
                     PERFORM  PTNYUINRRK-READ-SEC
                     PERFORM  UNTIL   FLG-PTNYUINRRK  =  1
                       MOVE  PTNYUINRRK-NYUINYMD
                                       TO  WK-RRK-NYUINYMD(RRK-IDX)
                       MOVE       1    TO  FLG-PTNYUINRRK
      ***              IF  PTNYUINRRK-DOUJITSUKBN  =  "1"
      ***                INITIALIZE        STS-AREA-DAY
      ***                INITIALIZE        LNK-DAY6-AREA
      ***                MOVE    "61"  TO  LNK-DAY6-IRAI
      ***                MOVE    PTNYUINRRK-NYUINYMD
      ***                              TO  LNK-DAY6-KIJUN
      ***                MOVE    "1"   TO  LNK-DAY6-ZOGENPTN
      ***                MOVE     1    TO  LNK-DAY6-ZOGEN
      ***                CALL    "ORCSDAY" USING   STS-AREA-DAY
      ***                                          LNK-DAY6-AREA
      ***                MOVE    LNK-DAY6-KEISAN
      ***                              TO  WK-RRK-NYUINYMD(RRK-IDX)
      ***              END-IF
                     END-PERFORM
                   END-IF
                   MOVE    "tbl_ptnyuinrrk" TO MCP-TABLE
                   MOVE    "key57"          TO MCP-PATHNAME
                   PERFORM  DB-CLOSE-SEC
                 END-IF
      *
                 IF  WK-RRK-NYUINYMD(RRK-IDX)  NOT = SPACE
                    IF   WK-2010-NYUKEIKBN-N(1)  =  "1"
                      IF   WK-RRK-NYUINYMD(RRK-IDX) <
                                               WK-2010-NYUKEI-KJNYMD(1)
                        MOVE   WK-2010-NYUKEI-KJNYMD(1)
                                          TO   WK-RRK-NYUINYMD(RRK-IDX)
                      END-IF
                    END-IF
                    IF   WK-2010-NYUKEIKBN-N(2)  =  "1"
                      IF   WK-RRK-NYUINYMD(RRK-IDX) <
                                               WK-2010-NYUKEI-KJNYMD(2)
                        MOVE   WK-2010-NYUKEI-KJNYMD(2)
                                          TO   WK-RRK-NYUINYMD(RRK-IDX)
                      END-IF
                    END-IF
                    IF   WK-2010-NYUKEIKBN-N(3)  =  "1"
                      IF   WK-RRK-NYUINYMD(RRK-IDX) <
                                               WK-2010-NYUKEI-KJNYMD(3)
                        MOVE   WK-2010-NYUKEI-KJNYMD(3)
                                          TO   WK-RRK-NYUINYMD(RRK-IDX)
                      END-IF
                    END-IF
                    IF   WK-2010-NYUKEIKBN-N(4)  =  "1"
                      IF   WK-RRK-NYUINYMD(RRK-IDX) <
                                               WK-2010-NYUKEI-KJNYMD(4)
                        MOVE   WK-2010-NYUKEI-KJNYMD(4)
                                          TO   WK-RRK-NYUINYMD(RRK-IDX)
                      END-IF
                    END-IF
                 ELSE
                    IF   WK-2010-NYUKEIKBN-N(1)  =  "1"
                        MOVE   WK-2010-NYUKEI-KJNYMD(1)
                                          TO   WK-RRK-NYUINYMD(RRK-IDX)
                    END-IF
                    IF   WK-2010-NYUKEIKBN-N(2)  =  "1"
                        MOVE   WK-2010-NYUKEI-KJNYMD(2)
                                          TO   WK-RRK-NYUINYMD(RRK-IDX)
                    END-IF
                    IF   WK-2010-NYUKEIKBN-N(3)  =  "1"
                        MOVE   WK-2010-NYUKEI-KJNYMD(3)
                                          TO   WK-RRK-NYUINYMD(RRK-IDX)
                    END-IF
                    IF   WK-2010-NYUKEIKBN-N(4)  =  "1"
                        MOVE   WK-2010-NYUKEI-KJNYMD(4)
                                          TO   WK-RRK-NYUINYMD(RRK-IDX)
                    END-IF
                 END-IF
      *
                 IF  (RRK-IDX5    NOT = ZERO                    )
                 AND (WK-RRK-NYUINYMD(RRK-IDX5)
                                      = WK-RRK-NYUINYMD(RRK-IDX))
                   MOVE  WK-RRK-KAISU(RRK-IDX5)
                                      TO   WK-RRK-KAISU(RRK-IDX)
                 ELSE
                   IF    WK-RRK-NYUINYMD(RRK-IDX)(1:6)
                                           <    LNK-SYU-SRYYMD(1:6)
                     PERFORM   22051-RIREKI-SYUDAY-HENSYU-SEC
                   ELSE
                     IF  WK-RRK-NYUINYMD(RRK-IDX)(1:6)
                                           >    LNK-SYU-SRYYMD(1:6)
                         MOVE   999   TO   WK-RRK-KAISU(RRK-IDX)
                     END-IF
                   END-IF
                 END-IF
      *
                 IF   WK-RRK2-FLG(1)      =   1
                    IF   MAX-KAI-KOHI1-M  > WK-RRK-KAISU(RRK-IDX)
                       COMPUTE  WK-RRK-KAISU-ZAN(RRK-IDX) =
                                MAX-KAI-KOHI1-M           -
                                WK-RRK-KAISU(RRK-IDX)
                    END-IF
                 END-IF
                 IF   WK-RRK2-FLG(2)      =   1
                    IF   MAX-KAI-KOHI2-M  > WK-RRK-KAISU(RRK-IDX)
                       COMPUTE  WK-RRK-KAISU-ZAN(RRK-IDX) =
                                MAX-KAI-KOHI2-M           -
                                WK-RRK-KAISU(RRK-IDX)
                    END-IF
                 END-IF
                 IF   WK-RRK2-FLG(3)      =   1
                    IF   MAX-KAI-KOHI3-M  > WK-RRK-KAISU(RRK-IDX)
                       COMPUTE  WK-RRK-KAISU-ZAN(RRK-IDX) =
                                MAX-KAI-KOHI3-M           -
                                WK-RRK-KAISU(RRK-IDX)
                    END-IF
                 END-IF
                 IF   WK-RRK2-FLG(4)      =   1
                    IF   MAX-KAI-KOHI4-M  > WK-RRK-KAISU(RRK-IDX)
                       COMPUTE  WK-RRK-KAISU-ZAN(RRK-IDX) =
                                MAX-KAI-KOHI4-M           -
                                WK-RRK-KAISU(RRK-IDX)
                    END-IF
                 END-IF
      *
                 MOVE    RRK-IDX      TO   RRK-IDX5
      *
               END-IF
      *
             END-PERFORM
      *
           END-IF
      *
           .
      *
       2205-RIREKI-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¡ã£±Æþ±¡²ó¿ôÂÐ±þ¡äÆüÊÌ¼ýÇ¼ÊÔ½¸¡ÊÁ°·î¤Þ¤Ç¡Ë
      ******************************************************************
       22051-RIREKI-SYUDAY-HENSYU-SEC          SECTION.
      *
           MOVE   WK-RRK-NYUINYMD(RRK-IDX)(1:6)  TO   WK-RRK-SRYYM
      *
           IF    WK-2010-NYUKEIKBN-N(1)  =  "1"
             MOVE  LNK-SYU-KOH1HKNNUM   TO  WK-RRK-HKNNUM
           END-IF
           IF    WK-2010-NYUKEIKBN-N(2)  =  "1"
             MOVE  LNK-SYU-KOH2HKNNUM   TO  WK-RRK-HKNNUM
           END-IF
           IF    WK-2010-NYUKEIKBN-N(3)  =  "1"
             MOVE  LNK-SYU-KOH3HKNNUM   TO  WK-RRK-HKNNUM
           END-IF
           IF    WK-2010-NYUKEIKBN-N(4)  =  "1"
             MOVE  LNK-SYU-KOH4HKNNUM   TO  WK-RRK-HKNNUM
           END-IF
      *
           PERFORM   UNTIL   WK-RRK-SRYYM  >=   LNK-SYU-SRYYMD(1:6)
      *
             INITIALIZE                         SYU-SYUNOU-REC
             MOVE    LNK-SYU-HOSPNUM      TO    SYU-HOSPNUM
             MOVE    LNK-SYU-NYUGAIKBN    TO    SYU-NYUGAIKBN
             MOVE    LNK-SYU-PTID         TO    SYU-PTID
             MOVE    WK-RRK-SRYYM         TO    SYU-SRYYMD(1:6)
             MOVE    "__"                 TO    SYU-SRYYMD(7:2)
             MOVE    WK-RRK-HKNNUM        TO    SYU-KOH1HKNNUM
             MOVE    WK-RRK-HKNNUM        TO    SYU-KOH2HKNNUM
             MOVE    WK-RRK-HKNNUM        TO    SYU-KOH3HKNNUM
             MOVE    WK-RRK-HKNNUM        TO    SYU-KOH4HKNNUM
             MOVE    SYU-SYUNOU-REC       TO    MCPDATA-REC
             MOVE    "DBSELECT"           TO    MCP-FUNC
             MOVE    "tbl_syunou"         TO    MCP-TABLE
             MOVE    "key25"              TO    MCP-PATHNAME
             CALL    "ORCDBMAIN"          USING MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA
             IF       MCP-RC              =     ZERO
               MOVE    "tbl_syunou"       TO    MCP-TABLE
               MOVE    "key25"            TO    MCP-PATHNAME
               PERFORM  SYUNOU-READ-SEC
               PERFORM  UNTIL  (FLG-SYUNOU   =    "1")
                 IF  SYU-DENPJTIKBN    NOT =  "3"
                   IF   SYU-DAYINFFLG  =  "1"
                      PERFORM   SYUDAY-READ-SEC
                      PERFORM   220511-RIREKI-SYUDAY-COUNT-SEC
                   END-IF
                 END-IF
                 MOVE    "tbl_syunou"     TO    MCP-TABLE
                 MOVE    "key25"          TO    MCP-PATHNAME
                 PERFORM  SYUNOU-READ-SEC
               END-PERFORM
             END-IF
             MOVE     "tbl_syunou"        TO    MCP-TABLE
             MOVE     "key25"             TO    MCP-PATHNAME
             PERFORM   DB-CLOSE-SEC
      *
             PERFORM  VARYING  RRK-IDX4  FROM  1  BY  1
                       UNTIL  (RRK-IDX4                >   10  )
                         OR   (LNK2-SYU-SKYSTYMD(RRK-IDX4)
                                                       =  SPACE)
               IF   (LNK-S02-RETRY-FLG  =  SPACE   )
               AND  (LNK-S02-IDX2       <  RRK-IDX4)
                CONTINUE
               ELSE
                IF  ( WK-RRK-SRYYM  =
                                LNK2-SYU-SKYSTYMD(RRK-IDX4)(1:6) )
                AND ((WK-RRK-HKNNUM =
                                LNK2-SYU-KOH1HKNNUM(RRK-IDX4)) OR
                     (WK-RRK-HKNNUM =
                                LNK2-SYU-KOH2HKNNUM(RRK-IDX4)) OR
                     (WK-RRK-HKNNUM =
                                LNK2-SYU-KOH3HKNNUM(RRK-IDX4)) OR
                     (WK-RRK-HKNNUM =
                                LNK2-SYU-KOH4HKNNUM(RRK-IDX4))   )
                  MOVE     LNK2-SYUNOU-REC(RRK-IDX4)
                                TO  SYU-SYUNOU-REC
                  IF   SYU-DAYINFFLG  =  "1"
                     MOVE  LNK-WRK-SYUDAY-REC(RRK-IDX4)
                                TO  SYU-SYUDAY-REC
                     PERFORM   220511-RIREKI-SYUDAY-COUNT-SEC
                  END-IF
                END-IF
               END-IF
             END-PERFORM
      *
             INITIALIZE        STS-AREA-DAY
             INITIALIZE        LNK-DAY6-AREA
             MOVE    "61"  TO  LNK-DAY6-IRAI
             MOVE    WK-RRK-SRYYM
                           TO  LNK-DAY6-KIJUN(1:6)
             MOVE    "01"  TO  LNK-DAY6-KIJUN(7:2)
             MOVE    "2"   TO  LNK-DAY6-ZOGENPTN
             MOVE     1    TO  LNK-DAY6-ZOGEN
             CALL    "ORCSDAY" USING   STS-AREA-DAY
                                       LNK-DAY6-AREA
             MOVE    LNK-DAY6-KEISAN(1:6)
                           TO  WK-RRK-SRYYM
      *
           END-PERFORM
      *
           .
      *
       22051-RIREKI-SYUDAY-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¡ã£±Æþ±¡²ó¿ôÂÐ±þ¡ä»»Äê²ó¿ô¥«¥¦¥ó¥È
      ******************************************************************
       220511-RIREKI-SYUDAY-COUNT-SEC          SECTION.
      *
      *    ÊÝ¸±ÁÈ¹ç¤»¥Þ¥¹¥¿¤Î¸¡º÷
           INITIALIZE                         WRK-HKNCOMBI-REC
           MOVE    SYU-HOSPNUM        TO      WRK-COMB-HOSPNUM
           MOVE    SYU-PTID           TO      WRK-COMB-PTID
           MOVE    SYU-HKNCOMBINUM    TO      WRK-COMB-HKNCOMBINUM
           MOVE    WRK-HKNCOMBI-REC   TO      MCPDATA-REC
           MOVE    "DBSELECT"         TO      MCP-FUNC
           MOVE    "tbl_hkncombi"     TO      MCP-TABLE
           MOVE    "key"              TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING   MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
           IF      MCP-RC               =       ZERO
             MOVE     "tbl_hkncombi"  TO      MCP-TABLE
             MOVE     "key"           TO      MCP-PATHNAME
             PERFORM   HKNCOMBI-READ2-SEC
           END-IF
           MOVE    "tbl_hkncombi"     TO      MCP-TABLE
           MOVE    "key"              TO      MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           PERFORM   VARYING   KOHFUKA-IDX   FROM   1   BY   1
                      UNTIL    KOHFUKA-IDX    >     4
             IF    SYU-KOH-HKNNUM(KOHFUKA-IDX)(1:1) >= "1" AND <= "8"
                 PERFORM   220145-JYUHENKBN-HENSYU-SEC
             END-IF
           END-PERFORM
      *
           IF   WK-RRK2-FLG(1)      =   1
               IF   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH1HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH1ID         =  WRK-COMB-KOH4ID))
                 PERFORM  VARYING  RRK-IDX2  FROM  1  BY  1
                           UNTIL   RRK-IDX2   >   31
                   MOVE WK-RRK-NYUINYMD(RRK-IDX)(7:2) TO RRK-IDX3
                   IF ((WK-RRK-NYUINYMD(RRK-IDX)(1:6)
                                           = SYU-SRYYMD(1:6)) AND
                       (RRK-IDX3          <= RRK-IDX2       ))
                   OR ( WK-RRK-NYUINYMD(RRK-IDX)(1:6)
                                          <  SYU-SRYYMD(1:6) )
                     EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH1HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 1)  =  1
                          AND SYU-KOH1HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH2HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 2)  =  1
                          AND SYU-KOH2HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH3HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 3)  =  1
                          AND SYU-KOH3HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                       WHEN  (LNK-SYU-KOH1HKNNUM = SYU-KOH4HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 4)  =  1
                          AND SYU-KOH4HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                     END-EVALUATE
                   END-IF
                 END-PERFORM
               END-IF
           END-IF
           IF   WK-RRK2-FLG(2)      =   1
               IF   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH2HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH2ID         =  WRK-COMB-KOH4ID))
                 PERFORM  VARYING  RRK-IDX2  FROM  1  BY  1
                           UNTIL   RRK-IDX2   >   31
                   MOVE WK-RRK-NYUINYMD(RRK-IDX)(7:2) TO RRK-IDX3
                   IF ((WK-RRK-NYUINYMD(RRK-IDX)(1:6)
                                           = SYU-SRYYMD(1:6)) AND
                       (RRK-IDX3          <= RRK-IDX2       ))
                   OR ( WK-RRK-NYUINYMD(RRK-IDX)(1:6)
                                          <  SYU-SRYYMD(1:6) )
                     EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH1HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 1)  =  1
                          AND SYU-KOH1HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH2HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 2)  =  1
                          AND SYU-KOH2HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH3HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 3)  =  1
                          AND SYU-KOH3HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                       WHEN  (LNK-SYU-KOH2HKNNUM = SYU-KOH4HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 4)  =  1
                          AND SYU-KOH4HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                     END-EVALUATE
                   END-IF
                 END-PERFORM
               END-IF
           END-IF
           IF   WK-RRK2-FLG(3)      =   1
               IF   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH3HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH3ID         =  WRK-COMB-KOH4ID))
                 PERFORM  VARYING  RRK-IDX2  FROM  1  BY  1
                           UNTIL   RRK-IDX2   >   31
                   MOVE WK-RRK-NYUINYMD(RRK-IDX)(7:2) TO RRK-IDX3
                   IF ((WK-RRK-NYUINYMD(RRK-IDX)(1:6)
                                           = SYU-SRYYMD(1:6)) AND
                       (RRK-IDX3          <= RRK-IDX2       ))
                   OR ( WK-RRK-NYUINYMD(RRK-IDX)(1:6)
                                          <  SYU-SRYYMD(1:6) )
                     EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH1HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 1)  =  1
                          AND SYU-KOH1HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH2HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 2)  =  1
                          AND SYU-KOH2HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH3HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 3)  =  1
                          AND SYU-KOH3HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                       WHEN  (LNK-SYU-KOH3HKNNUM = SYU-KOH4HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 4)  =  1
                          AND SYU-KOH4HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                     END-EVALUATE
                   END-IF
                 END-PERFORM
               END-IF
           END-IF
           IF   WK-RRK2-FLG(4)      =   1
               IF   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH1HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH1ID))
               OR   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH2HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH2ID))
               OR   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH3HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH3ID))
               OR   ((LNK-SYU-KOH4HKNNUM  =  SYU-KOH4HKNNUM ) AND
                     (COMB-KOH4ID         =  WRK-COMB-KOH4ID))
                 PERFORM  VARYING  RRK-IDX2  FROM  1  BY  1
                           UNTIL   RRK-IDX2   >   31
                   MOVE WK-RRK-NYUINYMD(RRK-IDX)(7:2) TO RRK-IDX3
                   IF ((WK-RRK-NYUINYMD(RRK-IDX)(1:6)
                                           = SYU-SRYYMD(1:6)) AND
                       (RRK-IDX3          <= RRK-IDX2       ))
                   OR ( WK-RRK-NYUINYMD(RRK-IDX)(1:6)
                                          <  SYU-SRYYMD(1:6) )
                     EVALUATE  TRUE
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH1HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 1)  =  1
                          AND SYU-KOH1HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH2HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 2)  =  1
                          AND SYU-KOH2HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH3HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 3)  =  1
                          AND SYU-KOH3HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                       WHEN  (LNK-SYU-KOH4HKNNUM = SYU-KOH4HKNNUM)
                          IF  SDAY-SANTEIFLG(RRK-IDX2 4)  =  1
                          AND SYU-KOH4HKNFTNMONEY     NOT =  ZERO
                             ADD     1      TO    WK-RRK-KAISU(RRK-IDX)
                          END-IF
                     END-EVALUATE
                   END-IF
                 END-PERFORM
               END-IF
           END-IF
      *
           .
      *
       220511-RIREKI-SYUDAY-COUNT-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¥Þ¥ëÄ¹¤Ë´Ø¤¹¤ë¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°¸¡º÷
      ******************************************************************
       2206-CYOKI-SYSCHECK-SEC         SECTION.
      *
           INITIALIZE                   SYS-2010-REC
           MOVE    "2010"           TO  SYS-2010-KANRICD
           MOVE    "972"            TO  SYS-2010-KBNCD
           MOVE    LNK-SYU-HOSPNUM  TO  SYS-2010-HOSPNUM
           MOVE    LNK-SYU-SRYYMD   TO  SYS-2010-STYUKYMD
           MOVE    LNK-SYU-SRYYMD   TO  SYS-2010-EDYUKYMD
           MOVE    SYS-2010-REC     TO  MCPDATA-REC
           MOVE    "DBSELECT"       TO  MCP-FUNC
           MOVE    "tbl_syskanri"   TO  MCP-TABLE
           MOVE    "key10"          TO  MCP-PATHNAME
           CALL    "ORCDBMAIN"  USING   MCPAREA
                                        MCPDATA-REC
                                        SPA-AREA
           IF      MCP-RC         =   ZERO
              MOVE  "tbl_syskanri"  TO  MCP-TABLE
              MOVE  "key10"         TO  MCP-PATHNAME
              PERFORM      SYSKANRI-READ-SEC
           ELSE
              INITIALIZE   SYS-2010-REC
           END-IF
      *
           EVALUATE  SYS-2010-CYOKI-FTNKBN
             WHEN      "1"
               MOVE  SYS-2010-CYOKI-FTNKBN
                                    TO  WK-2010-CYOKI-FTNKBN
           END-EVALUATE
      *
           MOVE     "tbl_syskanri"  TO  MCP-TABLE
           MOVE     "key10"         TO  MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           .
      *
       2206-CYOKI-SYSCHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÊÝ¸±¡¦¸øÈñ¤ÎÉéÃ´¶â·×»»
      ******************************************************************
       230-FTNKIN-SEC           SECTION.
      *
      *    £±ÆüÃ±°Ì¤Î»»Äê²ÄÇ½»Ä³Û¤ò»»½Ð¤¹¤ë
      *
           PERFORM        2301-DAY-ZAN-HENSYU-SEC.
      *
      *    »»Äê²ÄÇ½¥Õ¥é¥°¤Î½é´ü²½
           MOVE     SPACE                  TO     FLG-SANTEI1
                                                  FLG-SANTEI2
                                                  FLG-SANTEI3
                                                  FLG-SANTEI4.
      *
      *    ²áµî¤Î´µ¼ÔÊÝ¸±ÉéÃ´Îß·×³Û¤È¾å¸Â¶â³Û¤ÎÈæ³Ó
      *
           IF   (LNK-S02-KOUREI-NYUIN-KBN   =   "1")
           OR   (FLG-KOHININBARAI           =    1 )
           OR   (FLG-GENBUTU70          NOT =  ZERO)
           OR   (FLG-TOKU75-CYO             =    3 )
           OR   (FLG-CYOKI-ARI              =    2 )
               IF  MAX-KIN-SYU-M           NOT =  ZERO
                   IF  FTN-SYU-M           >=     MAX-KIN-SYU-M
                       MOVE  "1"           TO     FLG-SANTEI-SYU
                   END-IF
               END-IF
           END-IF.
      ***     IF       MAX-KIN-KOHI1-M        NOT =  ZERO
      ***         IF   FTN-KOHI1-M            >=     MAX-KIN-KOHI1-M
      ***              MOVE     "1"           TO     FLG-SANTEI1
      ***         END-IF
      ***     END-IF.
      ***     IF       MAX-KIN-KOHI2-M        NOT =  ZERO
      ***         IF   FTN-KOHI2-M            >=     MAX-KIN-KOHI2-M
      ***              MOVE     "1"           TO     FLG-SANTEI2
      ***         END-IF
      ***     END-IF.
      ***     IF       MAX-KIN-KOHI3-M        NOT =  ZERO
      ***         IF   FTN-KOHI3-M            >=     MAX-KIN-KOHI3-M
      ***              MOVE     "1"           TO     FLG-SANTEI3
      ***         END-IF
      ***     END-IF.
      ***     IF       MAX-KIN-KOHI4-M        NOT =  ZERO
      ***         IF   FTN-KOHI4-M            >=     MAX-KIN-KOHI4-M
      ***              MOVE     "1"           TO     FLG-SANTEI4
      ***         END-IF
      ***     END-IF.
      *
      *    ÊÝ¸±¡Ê¸øÈñ¡Ë¥Æ¡¼¥Ö¥ë¤Î´µ¼ÔÉéÃ´¾å¸Â³Û¤ÈÅö·î¤Î´µ¼ÔÉéÃ´Îß·×³Û
      *    ¤«¤é»»Äê²ÄÇ½»Ä³Û¤ò»»½Ð¤¹¤ë
      *
           IF   (LNK-S02-KOUREI-NYUIN-KBN   =   "1")
           OR   (FLG-KOHININBARAI           =    1 )
           OR   (FLG-GENBUTU70          NOT =  ZERO)
           OR   (FLG-TOKU75-CYO             =    3 )
           OR   (FLG-CYOKI-ARI              =    2 )
               IF  FLG-SANTEI-SYU            =   "1"                  
                       MOVE  ZERO        TO      ZAN-SYU-M            
               ELSE                                                   
                   IF  FTN-SYU-M         >=    MAX-KIN-SYU-M          
                       MOVE  ZERO        TO      ZAN-SYU-M
                   ELSE
                       COMPUTE  ZAN-SYU-M  =   MAX-KIN-SYU-M  -
                                               FTN-SYU-M
                   END-IF
               END-IF
           END-IF.
      *
      *    ·§ËÜ¸©ÃÏÊý¸øÈñ¸øÈñ¾å¸ÂÊÔ½¸
           IF  ( WK-1001-PREFNUM       =  43      )
           AND ( LNK-SYU-SRYYMD(1:6)  >= "201204" )
           AND ((COMB-KOH1HKNNUM = "343"         ) OR
                (COMB-KOH2HKNNUM = "343"         ) OR
                (COMB-KOH3HKNNUM = "343"         ) OR
                (COMB-KOH4HKNNUM = "343"         ))
      *
             IF  COMB-KOH1HKNNUM  =  "343"
               MOVE   99999990    TO  MAX-KIN-KOHI1-M
             END-IF
             IF  COMB-KOH2HKNNUM  =  "343"
               MOVE   99999990    TO  MAX-KIN-KOHI2-M
             END-IF
             IF  COMB-KOH3HKNNUM  =  "343"
               MOVE   99999990    TO  MAX-KIN-KOHI3-M
             END-IF
             IF  COMB-KOH4HKNNUM  =  "343"
               MOVE   99999990    TO  MAX-KIN-KOHI4-M
             END-IF
      *
             IF  (LNK-S02-KOUREI-NYUIN-KBN    = "1")
             OR  (FLG-KOREI-TANYUIN           =  1 )
               CONTINUE
             ELSE
               IF  (COMB-KOH1HKNNUM  = "972" OR "974")
               OR  (COMB-KOH2HKNNUM  = "972" OR "974")
               OR  (COMB-KOH3HKNNUM  = "972" OR "974")
               OR  (COMB-KOH4HKNNUM  = "972" OR "974")
                     IF  COMB-KOH1HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI1-M
                     END-IF
                     IF  COMB-KOH2HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI2-M
                     END-IF
                     IF  COMB-KOH3HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI3-M
                     END-IF
                     IF  COMB-KOH4HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI4-M
                     END-IF
               ELSE
                 IF  FLG-GENBUTU70   NOT =   ZERO
                   IF ((COMB-KOH1HKNNUM(1:1) = "0"            ) AND
                       (COMB-KOH1HKNNUM  NOT = "012" AND "025"))
                   OR ((COMB-KOH2HKNNUM(1:1) = "0"            ) AND
                       (COMB-KOH2HKNNUM  NOT = "012" AND "025"))
                   OR ((COMB-KOH3HKNNUM(1:1) = "0"            ) AND
                       (COMB-KOH3HKNNUM  NOT = "012" AND "025"))
                   OR ((COMB-KOH4HKNNUM(1:1) = "0"            ) AND
                       (COMB-KOH4HKNNUM  NOT = "012" AND "025"))
                     CONTINUE
                   ELSE
                     IF  COMB-KOH1HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI1-M
                     END-IF
                     IF  COMB-KOH2HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI2-M
                     END-IF
                     IF  COMB-KOH3HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI3-M
                     END-IF
                     IF  COMB-KOH4HKNNUM  =  "343"
                       MOVE   MAX-KIN-SYU-M   TO  MAX-KIN-KOHI4-M
                     END-IF
                   END-IF
                 END-IF
               END-IF
             END-IF
      *
           END-IF.
      *
           IF  FLG-SANTEI1               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI1-M
                                               ZAN-KOHI1-M2             
                                               ZAN-KOHI1-M3             
               MOVE     ZERO             TO    ZAN-KOHI1-M-TOKU75
                                               ZAN-KOHI1-M2-TOKU75
                                               ZAN-KOHI1-M3-TOKU75
           ELSE
               IF (COMB-KOH1HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH1-NYUJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI1-M       NOT = ZERO
                       IF   FTN-KOHI1-M           >=  MAX-KIN-KOHI1-M
                            MOVE     ZERO         TO  ZAN-KOHI1-M
                       ELSE
                            COMPUTE  ZAN-KOHI1-M  =   MAX-KIN-KOHI1-M -
                                                      FTN-KOHI1-M
                       END-IF
                       IF  COMB-KOH1HKNNUM    =   "027"                 
                            MOVE     ZERO         TO  ZAN-KOHI1-M2      
                       ELSE                                             
                         IF   FTN-KOHI1-M2        >=  MAX-KIN-KOHI1-M   
                            MOVE     ZERO         TO  ZAN-KOHI1-M2      
                         ELSE                                           
                            COMPUTE  ZAN-KOHI1-M2 =   MAX-KIN-KOHI1-M - 
                                                      FTN-KOHI1-M2      
                         END-IF                                         
                       END-IF                                           
                       IF  COMB-KOH1HKNNUM    =   "027"                 
                            MOVE     ZERO         TO  ZAN-KOHI1-M3      
                       ELSE                                             
                         IF   FTN-KOHI1-M3        >=  MAX-KIN-KOHI1-M   
                            MOVE     ZERO         TO  ZAN-KOHI1-M3      
                         ELSE                                           
                            COMPUTE  ZAN-KOHI1-M3 =   MAX-KIN-KOHI1-M - 
                                                      FTN-KOHI1-M3      
                         END-IF                                         
                       END-IF                                           
                   END-IF
                   IF  MAX-KIN-KOHI1-M-TOKU75       NOT = ZERO
                       IF  FTN-KOHI1-M-TOKU75  >= MAX-KIN-KOHI1-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI1-M-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI1-M-TOKU75     =
                                     MAX-KIN-KOHI1-M-TOKU75 -
                                     FTN-KOHI1-M-TOKU75
                       END-IF
                       IF  FTN-KOHI1-M2-TOKU75 >= MAX-KIN-KOHI1-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI1-M2-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI1-M2-TOKU75    =
                                     MAX-KIN-KOHI1-M-TOKU75 -
                                     FTN-KOHI1-M2-TOKU75
                       END-IF
                       IF  FTN-KOHI1-M3-TOKU75 >= MAX-KIN-KOHI1-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI1-M3-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI1-M3-TOKU75    =
                                     MAX-KIN-KOHI1-M-TOKU75 -
                                     FTN-KOHI1-M3-TOKU75
                       END-IF
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI2               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI2-M
                                               ZAN-KOHI2-M2             
                                               ZAN-KOHI2-M3             
               MOVE     ZERO             TO    ZAN-KOHI2-M-TOKU75
                                               ZAN-KOHI2-M2-TOKU75
                                               ZAN-KOHI2-M3-TOKU75
           ELSE
               IF (COMB-KOH2HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH2-NYUJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI2-M       NOT = ZERO
                       IF   FTN-KOHI2-M           >=  MAX-KIN-KOHI2-M
                            MOVE     ZERO         TO  ZAN-KOHI2-M
                       ELSE
                            COMPUTE  ZAN-KOHI2-M  =   MAX-KIN-KOHI2-M -
                                                      FTN-KOHI2-M
                       END-IF
                       IF   FTN-KOHI2-M2          >=  MAX-KIN-KOHI2-M   
                            MOVE     ZERO         TO  ZAN-KOHI2-M2      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI2-M2 =   MAX-KIN-KOHI2-M - 
                                                      FTN-KOHI2-M2      
                       END-IF                                           
                       IF   FTN-KOHI2-M3          >=  MAX-KIN-KOHI2-M   
                            MOVE     ZERO         TO  ZAN-KOHI2-M3      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI2-M3 =   MAX-KIN-KOHI2-M - 
                                                      FTN-KOHI2-M3      
                       END-IF                                           
                   END-IF
                   IF  MAX-KIN-KOHI2-M-TOKU75       NOT = ZERO
                       IF  FTN-KOHI2-M-TOKU75  >= MAX-KIN-KOHI2-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI2-M-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI2-M-TOKU75     =
                                     MAX-KIN-KOHI2-M-TOKU75 -
                                     FTN-KOHI2-M-TOKU75
                       END-IF
                       IF  FTN-KOHI2-M2-TOKU75 >= MAX-KIN-KOHI2-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI2-M2-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI2-M2-TOKU75    =
                                     MAX-KIN-KOHI2-M-TOKU75 -
                                     FTN-KOHI2-M2-TOKU75
                       END-IF
                       IF  FTN-KOHI2-M3-TOKU75 >= MAX-KIN-KOHI2-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI2-M3-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI2-M3-TOKU75    =
                                     MAX-KIN-KOHI2-M-TOKU75 -
                                     FTN-KOHI2-M3-TOKU75
                       END-IF
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI3               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI3-M
                                               ZAN-KOHI3-M2             
                                               ZAN-KOHI3-M3             
               MOVE     ZERO             TO    ZAN-KOHI3-M-TOKU75
                                               ZAN-KOHI3-M2-TOKU75
                                               ZAN-KOHI3-M3-TOKU75
           ELSE
               IF (COMB-KOH3HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH3-NYUJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI3-M       NOT = ZERO
                       IF   FTN-KOHI3-M           >=  MAX-KIN-KOHI3-M
                            MOVE     ZERO         TO  ZAN-KOHI3-M
                       ELSE
                            COMPUTE  ZAN-KOHI3-M  =   MAX-KIN-KOHI3-M -
                                                      FTN-KOHI3-M
                       END-IF
                       IF   FTN-KOHI3-M2          >=  MAX-KIN-KOHI3-M   
                            MOVE     ZERO         TO  ZAN-KOHI3-M2      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI3-M2 =   MAX-KIN-KOHI3-M - 
                                                      FTN-KOHI3-M2      
                       END-IF                                           
                       IF   FTN-KOHI3-M3          >=  MAX-KIN-KOHI3-M   
                            MOVE     ZERO         TO  ZAN-KOHI3-M3      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI3-M3 =   MAX-KIN-KOHI3-M - 
                                                      FTN-KOHI3-M3      
                       END-IF                                           
                   END-IF
                   IF  MAX-KIN-KOHI3-M-TOKU75       NOT = ZERO
                       IF  FTN-KOHI3-M-TOKU75  >= MAX-KIN-KOHI3-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI3-M-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI3-M-TOKU75     =
                                     MAX-KIN-KOHI3-M-TOKU75 -
                                     FTN-KOHI3-M-TOKU75
                       END-IF
                       IF  FTN-KOHI3-M2-TOKU75 >= MAX-KIN-KOHI3-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI3-M2-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI3-M2-TOKU75    =
                                     MAX-KIN-KOHI3-M-TOKU75 -
                                     FTN-KOHI3-M2-TOKU75
                       END-IF
                       IF  FTN-KOHI3-M3-TOKU75 >= MAX-KIN-KOHI3-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI3-M3-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI3-M3-TOKU75    =
                                     MAX-KIN-KOHI3-M-TOKU75 -
                                     FTN-KOHI3-M3-TOKU75
                       END-IF
                   END-IF
               END-IF
           END-IF.
           IF  FLG-SANTEI4               =     "1"
               MOVE     ZERO             TO    ZAN-KOHI4-M
                                               ZAN-KOHI4-M2             
                                               ZAN-KOHI4-M3             
               MOVE     ZERO             TO    ZAN-KOHI4-M-TOKU75
                                               ZAN-KOHI4-M2-TOKU75
                                               ZAN-KOHI4-M3-TOKU75
           ELSE
               IF (COMB-KOH4HKNNUM           NOT = SPACE)    AND
                  (COMB-KOH4-NYUJGNKBN       =     "1")
                   IF       MAX-KIN-KOHI4-M       NOT = ZERO
                       IF   FTN-KOHI4-M           >=  MAX-KIN-KOHI4-M
                            MOVE     ZERO         TO  ZAN-KOHI4-M
                       ELSE
                            COMPUTE  ZAN-KOHI4-M  =   MAX-KIN-KOHI4-M -
                                                      FTN-KOHI4-M
                       END-IF
                       IF   FTN-KOHI4-M2          >=  MAX-KIN-KOHI4-M   
                            MOVE     ZERO         TO  ZAN-KOHI4-M2      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI4-M2 =   MAX-KIN-KOHI4-M - 
                                                      FTN-KOHI4-M2      
                       END-IF                                           
                       IF   FTN-KOHI4-M3          >=  MAX-KIN-KOHI4-M   
                            MOVE     ZERO         TO  ZAN-KOHI4-M3      
                       ELSE                                             
                            COMPUTE  ZAN-KOHI4-M3 =   MAX-KIN-KOHI4-M - 
                                                      FTN-KOHI4-M3      
                       END-IF                                           
                   END-IF
                   IF  MAX-KIN-KOHI4-M-TOKU75       NOT = ZERO
                       IF  FTN-KOHI4-M-TOKU75  >= MAX-KIN-KOHI4-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI4-M-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI4-M-TOKU75     =
                                     MAX-KIN-KOHI4-M-TOKU75 -
                                     FTN-KOHI4-M-TOKU75
                       END-IF
                       IF  FTN-KOHI4-M2-TOKU75 >= MAX-KIN-KOHI4-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI4-M2-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI4-M2-TOKU75    =
                                     MAX-KIN-KOHI4-M-TOKU75 -
                                     FTN-KOHI4-M2-TOKU75
                       END-IF
                       IF  FTN-KOHI4-M3-TOKU75 >= MAX-KIN-KOHI4-M-TOKU75
                            MOVE  ZERO  TO  ZAN-KOHI4-M3-TOKU75
                       ELSE
                            COMPUTE  ZAN-KOHI4-M3-TOKU75    =
                                     MAX-KIN-KOHI4-M-TOKU75 -
                                     FTN-KOHI4-M3-TOKU75
                       END-IF
                   END-IF
               END-IF
           END-IF.
      *
      *    ·î¤Î´µ¼ÔÉéÃ´²ÄÇ½»Ä³Û¤ò¥»¥Ã¥È¤¹¤ë
           IF (COMB-KOH1HKNNUM              NOT = SPACE)    AND
              (COMB-KOH1-NYUJGNKBN          =     "1")
               MOVE   ZAN-KOHI1-M     TO   ZAN-KOHI1
               MOVE   ZAN-KOHI1-M2    TO   ZAN-KOHI12               
               MOVE   ZAN-KOHI1-M3    TO   ZAN-KOHI13               
      *
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI1-M          NOT =   ZERO) AND
                         (MAX-KIN-KOHI1-M-TOKU75   NOT =   ZERO)
                     IF    ZAN-KOHI1   >    ZAN-KOHI1-M-TOKU75
                        MOVE   ZAN-KOHI1-M-TOKU75   TO   ZAN-KOHI1
                        MOVE   ZAN-KOHI1-M2-TOKU75  TO   ZAN-KOHI12
                        MOVE   ZAN-KOHI1-M3-TOKU75  TO   ZAN-KOHI13
                        IF  FLG-KOUGAKUCYO-GEN70K = 1
                          MOVE  ZERO  TO  FLG-KOUGAKUCYO-GEN70K
                        END-IF
                        IF  FLG-KOUGAKUCYO-GEN70K-TOKU75 = 1
                          MOVE  1     TO  FLG-KOUGAKUCYO-GEN70K
                          MOVE  ZERO  TO  FLG-KOUGAKUCYO-GEN70K-TOKU75
                        END-IF
                     ELSE
                        IF  FLG-KOUGAKUCYO-GEN70K-TOKU75 = 1
                          MOVE  ZERO  TO  FLG-KOUGAKUCYO-GEN70K-TOKU75
                        END-IF
                     END-IF
               END-EVALUATE
      ****
               IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604"       ) AND
                   ( COMB-KOH1HKNNUM = "015" OR "016" OR "021") AND
                   ( WK-JIRITU-CYUKANSOU(1) =   2             ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610"       ) AND
                   ( COMB-KOH1HKNNUM = "024" OR "079"         ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200804"       ) AND
                   ( COMB-KOH1HKNNUM = "038"                  ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "201501"       ) AND
                   ( COMB-KOH1HKNNUM = "052" OR "054"         ))
               OR (( COMB-KOH1HKNNUM(1:1)  >= "1" AND <=  "8" ) AND
                   ( WK-KOHJGNGET-TAISYOKBN(1)  =  2          ))
                   IF  ((COMB-KOH2HKNNUM  = "972") OR
                        (COMB-KOH3HKNNUM  = "972") OR
                        (COMB-KOH4HKNNUM  = "972"))
                   AND ( MAX-KIN-KOHI1-M  >  WK-CYOKI-GENDO)
                      IF    FTN-KOHI1-M-JI   >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI1-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-KOHI1-M2-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI1-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-KOHI1-M3-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
                      ELSE
                        COMPUTE WK-ZAN-JIRITU-ENTANI =
                                WK-CYOKI-GENDO       -
                                FTN-KOHI1-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU-ENTANI
                        MOVE    WK-ZAN-JIRITU-ENTANI
                                        TO   ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ((COMB-KOH2HKNNUM  = "974") OR
                        (COMB-KOH3HKNNUM  = "974") OR
                        (COMB-KOH4HKNNUM  = "974"))
                   AND ( MAX-KIN-KOHI1-M  >  WK-CYOKI-GENDO2)
                      IF    FTN-KOHI1-M-JI   >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI1-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-KOHI1-M2-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI1-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-KOHI1-M3-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
                      ELSE
                        COMPUTE WK-ZAN-JIRITU-ENTANI =
                                WK-CYOKI-GENDO2      -
                                FTN-KOHI1-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU-ENTANI
                        MOVE    WK-ZAN-JIRITU-ENTANI
                                        TO   ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ((LNK-S02-KOUREI-NYUIN-KBN  =   "1") OR
                        (FLG-KOREI-TANYUIN         =    1 ))
                   AND ( MAX-KIN-KOHI1-M > WK-KOH-GENDOGAKU)
                     IF   (WK-TOKATUKAI(1)            =  ZERO)
                     AND  (WK-KOHJGNGET-TEKIYOFLG(1)  =  ZERO)
                     AND  (WK-KOHJGNGET-TAISYOKBN(1)  =   2  )
                      CONTINUE
                     ELSE
                      IF    FTN-KOHI1-M-JI   >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI1-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-KOHI1-M2-JI  >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI1-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-KOHI1-M3-JI  >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
                      ELSE
                        COMPUTE WK-ZAN-JIRITU-ENTANI =
                                WK-KOH-GENDOGAKU     -
                                FTN-KOHI1-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU-ENTANI
                        MOVE    WK-ZAN-JIRITU-ENTANI
                                        TO   ZAN-KOHI13
                      END-IF
                     END-IF
                   END-IF
                   IF  ( FLG-GENBUTU70   NOT =   ZERO        )
                   AND ( MAX-KIN-KOHI1-M > WK-GEN70-GENDOGAKU)
                     IF   (WK-TOKATUKAI(1)            =  ZERO)
                     AND  (WK-KOHJGNGET-TEKIYOFLG(1)  =  ZERO)
                     AND  (WK-KOHJGNGET-TAISYOKBN(1)  =   2  )
                      CONTINUE
                     ELSE
                      IF    FTN-KOHI1-M-JI   >=   WK-GEN70-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-GEN70-GENDOGAKU
                                              - FTN-KOHI1-M-JI
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
                      END-IF
                      IF    FTN-KOHI1-M2-JI  >=   WK-GEN70-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-GEN70-GENDOGAKU
                                              - FTN-KOHI1-M2-JI
                      END-IF
                      IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
                      END-IF
                      IF    FTN-KOHI1-M3-JI  >=   WK-GEN70-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
                      ELSE
                        COMPUTE WK-ZAN-JIRITU-ENTANI =
                                WK-GEN70-GENDOGAKU   -
                                FTN-KOHI1-M3-JI
                      END-IF
                      IF   ZAN-KOHI13 >  WK-ZAN-JIRITU-ENTANI
                        MOVE    WK-ZAN-JIRITU-ENTANI
                                        TO   ZAN-KOHI13
                      END-IF
                     END-IF
                   END-IF
               END-IF
      *+++
      ***      IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
      ***          ( COMB-KOH1HKNNUM  = "015" OR "016" ) AND
      ***          ((COMB-KOH2HKNNUM  = "972") OR
      ***           (COMB-KOH3HKNNUM  = "972") OR
      ***           (COMB-KOH4HKNNUM  = "972"))         )
      ***      OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
      ***          ( COMB-KOH1HKNNUM  = "024"          ) AND
      ***          ((COMB-KOH2HKNNUM  = "972") OR
      ***           (COMB-KOH3HKNNUM  = "972") OR
      ***           (COMB-KOH4HKNNUM  = "972"))         )
      ***             IF    FTN-CYOKI-M-JI   >=   WK-CYOKI-GENDO
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
      ***                                     - FTN-CYOKI-M-JI
      ***             END-IF
      ***             IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      ***             END-IF
      ***             IF    FTN-CYOKI-M2-JI  >=   WK-CYOKI-GENDO
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
      ***                                     - FTN-CYOKI-M2-JI
      ***             END-IF
      ***             IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      ***             END-IF
      ***             IF    FTN-CYOKI-M3-JI  >=   WK-CYOKI-GENDO
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU-ENTANI =
      ***                       WK-CYOKI-GENDO       -
      ***                       FTN-CYOKI-M3-JI
      ***             END-IF
      ***             IF   ZAN-KOHI13 >  WK-ZAN-JIRITU-ENTANI
      ***               MOVE    WK-ZAN-JIRITU-ENTANI
      ***                               TO   ZAN-KOHI13
      ***             END-IF
      ***      END-IF
      ***      IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
      ***          ( COMB-KOH1HKNNUM  = "015" OR "016" ) AND
      ***          ((COMB-KOH2HKNNUM  = "974") OR
      ***           (COMB-KOH3HKNNUM  = "974") OR
      ***           (COMB-KOH4HKNNUM  = "974"))         )
      ***      OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
      ***          ( COMB-KOH1HKNNUM  = "024"          ) AND
      ***          ((COMB-KOH2HKNNUM  = "974") OR
      ***           (COMB-KOH3HKNNUM  = "974") OR
      ***           (COMB-KOH4HKNNUM  = "974"))         )
      ***             IF    FTN-CYOKI-M-JI   >=   WK-CYOKI-GENDO2
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
      ***                                     - FTN-CYOKI-M-JI
      ***             END-IF
      ***             IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      ***             END-IF
      ***             IF    FTN-CYOKI-M2-JI  >=   WK-CYOKI-GENDO2
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
      ***                                     - FTN-CYOKI-M2-JI
      ***             END-IF
      ***             IF   ZAN-KOHI12 >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      ***             END-IF
      ***             IF    FTN-CYOKI-M3-JI  >=   WK-CYOKI-GENDO2
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU-ENTANI =
      ***                       WK-CYOKI-GENDO2      -
      ***                       FTN-CYOKI-M3-JI
      ***             END-IF
      ***             IF   ZAN-KOHI13 >  WK-ZAN-JIRITU-ENTANI
      ***               MOVE    WK-ZAN-JIRITU-ENTANI
      ***                               TO   ZAN-KOHI13
      ***             END-IF
      ***      END-IF
      *+++
               IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604"       ) AND
                   ( COMB-KOH1HKNNUM = "015" OR "016" OR "021") AND
                   ( WK-JIRITU-CYUKANSOU(1) =   2             ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610"       ) AND
                   ( COMB-KOH1HKNNUM = "024" OR "079"         ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200804"       ) AND
                   ( COMB-KOH1HKNNUM = "038"                  ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "201501"       ) AND
                   ( COMB-KOH1HKNNUM = "052" OR "054"         ))
               OR (( WK-TOKATUKAI(1)            =  1          ) AND
                   ( WK-KOHJGNGET-TAISYOKBN(1)  =  2          ))
                 IF  FLG-TOKU75 = 1 OR 2 OR 3
                   IF  ((COMB-KOH2HKNNUM  = "972") OR
                        (COMB-KOH3HKNNUM  = "972") OR
                        (COMB-KOH4HKNNUM  = "972"))
                   AND ( MAX-KIN-KOHI1-M  >  WK-CYOKI-GENDO-TOKU75  )
                      IF    FTN-KOHI1-M-JI-TOKU75
                                          >= WK-CYOKI-GENDO-TOKU75
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO-TOKU75
                                              - FTN-KOHI1-M-JI-TOKU75
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      *
                        IF    FTN-KOHI1-M2-JI-TOKU75
                                            >= WK-CYOKI-GENDO-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU
                        ELSE
                          COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO-TOKU75
                                                - FTN-KOHI1-M2-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      *
                        IF    FTN-KOHI1-M3-JI-TOKU75
                                            >= WK-CYOKI-GENDO-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
                        ELSE
                          COMPUTE WK-ZAN-JIRITU-ENTANI  =
                                  WK-CYOKI-GENDO-TOKU75 -
                                  FTN-KOHI1-M3-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU-ENTANI
                                              TO  ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ((COMB-KOH2HKNNUM  = "974") OR
                        (COMB-KOH3HKNNUM  = "974") OR
                        (COMB-KOH4HKNNUM  = "974"))
                   AND ( MAX-KIN-KOHI1-M  >  WK-CYOKI-GENDO2-TOKU75 )
                      IF    FTN-KOHI1-M-JI-TOKU75
                                          >= WK-CYOKI-GENDO2-TOKU75
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2-TOKU75
                                              - FTN-KOHI1-M-JI-TOKU75
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      *
                        IF    FTN-KOHI1-M2-JI-TOKU75
                                            >= WK-CYOKI-GENDO2-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU
                        ELSE
                          COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2-TOKU75
                                                - FTN-KOHI1-M2-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      *
                        IF    FTN-KOHI1-M3-JI-TOKU75
                                            >= WK-CYOKI-GENDO2-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
                        ELSE
                          COMPUTE WK-ZAN-JIRITU-ENTANI   =
                                  WK-CYOKI-GENDO2-TOKU75 -
                                  FTN-KOHI1-M3-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU-ENTANI
                                              TO  ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ((LNK-S02-KOUREI-NYUIN-KBN  =  "1") OR
                        (FLG-KOREI-TANYUIN         =   1 ))
                   AND ( FLG-TOKU75 = 1 OR 2              )
                   AND ( MAX-KIN-KOHI1-M  >
                                 WK-KOH-GENDOGAKU-TOKU75  )
                      IF    FTN-KOHI1-M-JI-TOKU75
                                          >= WK-KOH-GENDOGAKU-TOKU75
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU-TOKU75
                                              - FTN-KOHI1-M-JI-TOKU75
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      *
                        IF    FTN-KOHI1-M2-JI-TOKU75
                                            >= WK-KOH-GENDOGAKU-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU
                        ELSE
                          COMPUTE WK-ZAN-JIRITU
                                             = WK-KOH-GENDOGAKU-TOKU75
                                             - FTN-KOHI1-M2-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      *
                        IF    FTN-KOHI1-M3-JI-TOKU75
                                            >= WK-KOH-GENDOGAKU-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
                        ELSE
                          COMPUTE WK-ZAN-JIRITU-ENTANI    =
                                  WK-KOH-GENDOGAKU-TOKU75 -
                                  FTN-KOHI1-M3-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU-ENTANI
                                              TO  ZAN-KOHI13
                      END-IF
                   END-IF
                   IF  ((FLG-GENBUTU70   NOT =   ZERO  ) OR
                        (FLG-TOKU75-CYO      =    3    ))
                   AND ( FLG-TOKU75 = 3                 )
                   AND ( MAX-KIN-KOHI1-M  >
                              WK-GEN70-GENDOGAKU-TOKU75 )
                      IF    FTN-KOHI1-M-JI-TOKU75
                                          >= WK-GEN70-GENDOGAKU-TOKU75
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU
                                           = WK-GEN70-GENDOGAKU-TOKU75
                                           - FTN-KOHI1-M-JI-TOKU75
                      END-IF
                      IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      *
                        IF    FTN-KOHI1-M2-JI-TOKU75
                                            >= WK-GEN70-GENDOGAKU-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU
                        ELSE
                          COMPUTE WK-ZAN-JIRITU
                                             = WK-GEN70-GENDOGAKU-TOKU75
                                             - FTN-KOHI1-M2-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      *
                        IF    FTN-KOHI1-M3-JI-TOKU75
                                            >= WK-GEN70-GENDOGAKU-TOKU75
                          MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
                        ELSE
                          COMPUTE WK-ZAN-JIRITU-ENTANI      =
                                  WK-GEN70-GENDOGAKU-TOKU75 -
                                  FTN-KOHI1-M3-JI-TOKU75
                        END-IF
                        MOVE   WK-ZAN-JIRITU-ENTANI
                                              TO  ZAN-KOHI13
                      END-IF
                   END-IF
                 END-IF
               END-IF
      *+++
      ***      IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
      ***          ( COMB-KOH1HKNNUM  = "015" OR "016" ) AND
      ***          ((COMB-KOH2HKNNUM  = "972") OR
      ***           (COMB-KOH3HKNNUM  = "972") OR
      ***           (COMB-KOH4HKNNUM  = "972"))         )
      ***      OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
      ***          ( COMB-KOH1HKNNUM  = "024"          ) AND
      ***          ((COMB-KOH2HKNNUM  = "972") OR
      ***           (COMB-KOH3HKNNUM  = "972") OR
      ***           (COMB-KOH4HKNNUM  = "972"))         )
      ***        IF  FLG-TOKU75 = 1 OR 2 OR 3
      ***             IF    FTN-CYOKI-M-JI-TOKU75
      ***                            >=   WK-CYOKI-GENDO-TOKU75
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO-TOKU75
      ***                                     - FTN-CYOKI-M-JI-TOKU75
      ***             END-IF
      ***             IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      *
      ***               IF    FTN-CYOKI-M2-JI-TOKU75
      ***                                   >= WK-CYOKI-GENDO-TOKU75
      ***                 MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***               ELSE
      ***                 COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO-TOKU75
      ***                                       - FTN-CYOKI-M2-JI-TOKU75
      ***               END-IF
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      *
      ***               IF    FTN-CYOKI-M3-JI-TOKU75
      ***                                   >= WK-CYOKI-GENDO-TOKU75
      ***                 MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
      ***               ELSE
      ***                 COMPUTE WK-ZAN-JIRITU-ENTANI  =
      ***                         WK-CYOKI-GENDO-TOKU75 -
      ***                         FTN-CYOKI-M3-JI-TOKU75
      ***               END-IF
      ***               MOVE      WK-ZAN-JIRITU-ENTANI
      ***                                 TO   ZAN-KOHI13
      ***             END-IF
      ***        END-IF
      ***      END-IF
      ***      IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
      ***          ( COMB-KOH1HKNNUM  = "015" OR "016" ) AND
      ***          ((COMB-KOH2HKNNUM  = "974") OR
      ***           (COMB-KOH3HKNNUM  = "974") OR
      ***           (COMB-KOH4HKNNUM  = "974"))         )
      ***      OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
      ***          ( COMB-KOH1HKNNUM  = "024"          ) AND
      ***          ((COMB-KOH2HKNNUM  = "974") OR
      ***           (COMB-KOH3HKNNUM  = "974") OR
      ***           (COMB-KOH4HKNNUM  = "974"))         )
      ***        IF  FLG-TOKU75 = 1 OR 2 OR 3
      ***             IF    FTN-CYOKI-M-JI-TOKU75
      ***                            >=   WK-CYOKI-GENDO2-TOKU75
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2-TOKU75
      ***                                     - FTN-CYOKI-M-JI-TOKU75
      ***             END-IF
      ***             IF   ZAN-KOHI1  >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI1
      *
      ***               IF    FTN-CYOKI-M2-JI-TOKU75
      ***                                   >= WK-CYOKI-GENDO2-TOKU75
      ***                 MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***               ELSE
      ***                 COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2-TOKU75
      ***                                       - FTN-CYOKI-M2-JI-TOKU75
      ***               END-IF
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI12
      *
      ***               IF    FTN-CYOKI-M3-JI-TOKU75
      ***                                   >= WK-CYOKI-GENDO2-TOKU75
      ***                 MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
      ***               ELSE
      ***                 COMPUTE WK-ZAN-JIRITU-ENTANI   =
      ***                         WK-CYOKI-GENDO2-TOKU75 -
      ***                         FTN-CYOKI-M3-JI-TOKU75
      ***               END-IF
      ***               MOVE      WK-ZAN-JIRITU-ENTANI
      ***                                 TO   ZAN-KOHI13
      ***             END-IF
      ***        END-IF
      ***      END-IF
           END-IF.
      *
           IF (COMB-KOH2HKNNUM              NOT = SPACE)    AND
              (COMB-KOH2-NYUJGNKBN          =     "1")
               MOVE   ZAN-KOHI2-M     TO   ZAN-KOHI2
               MOVE   ZAN-KOHI2-M2    TO   ZAN-KOHI22               
               MOVE   ZAN-KOHI2-M3    TO   ZAN-KOHI23               
      *
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI2-M          NOT =   ZERO) AND
                         (MAX-KIN-KOHI2-M-TOKU75   NOT =   ZERO)
                     IF    ZAN-KOHI2   >    ZAN-KOHI2-M-TOKU75
                        MOVE   ZAN-KOHI2-M-TOKU75   TO   ZAN-KOHI2
                        MOVE   ZAN-KOHI2-M2-TOKU75  TO   ZAN-KOHI22
                        MOVE   ZAN-KOHI2-M3-TOKU75  TO   ZAN-KOHI23
                     END-IF
               END-EVALUATE
      ****
               IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604"       ) AND
                   ( COMB-KOH2HKNNUM = "015" OR "016" OR "021") AND
                   ( WK-JIRITU-CYUKANSOU(2) =   2             ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610"       ) AND
                   ( COMB-KOH2HKNNUM = "024" OR "079"         ))
               OR (( LNK-SYU-SRYYMD(1:6)   >=  "201501"       ) AND
                   ( COMB-KOH2HKNNUM = "054"                  ))
               OR (( COMB-KOH2HKNNUM(1:1)  >= "1" AND <=  "8" ) AND
                   ( WK-KOHJGNGET-TAISYOKBN(2)  =  2          ))
                   IF  ((COMB-KOH1HKNNUM  = "972") OR
                        (COMB-KOH3HKNNUM  = "972") OR
                        (COMB-KOH4HKNNUM  = "972"))
                   AND ( MAX-KIN-KOHI2-M  >  WK-CYOKI-GENDO)
                      IF    FTN-KOHI2-M-JI   >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI2-M-JI
                      END-IF
                      IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
                      END-IF
                      IF    FTN-KOHI2-M2-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
                                              - FTN-KOHI2-M2-JI
                      END-IF
                      IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
                      END-IF
                      IF    FTN-KOHI2-M3-JI  >=   WK-CYOKI-GENDO
                        MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
                      ELSE
                        COMPUTE WK-ZAN-JIRITU-ENTANI =
                                WK-CYOKI-GENDO       -
                                FTN-KOHI2-M3-JI
                      END-IF
                      IF   ZAN-KOHI23 >  WK-ZAN-JIRITU-ENTANI
                        MOVE    WK-ZAN-JIRITU-ENTANI
                                        TO   ZAN-KOHI23
                      END-IF
                   END-IF
                   IF  ((COMB-KOH1HKNNUM  = "974") OR
                        (COMB-KOH3HKNNUM  = "974") OR
                        (COMB-KOH4HKNNUM  = "974"))
                   AND ( MAX-KIN-KOHI2-M  >  WK-CYOKI-GENDO2)
                      IF    FTN-KOHI2-M-JI   >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI2-M-JI
                      END-IF
                      IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
                      END-IF
                      IF    FTN-KOHI2-M2-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
                                              - FTN-KOHI2-M2-JI
                      END-IF
                      IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
                      END-IF
                      IF    FTN-KOHI2-M3-JI  >=   WK-CYOKI-GENDO2
                        MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
                      ELSE
                        COMPUTE WK-ZAN-JIRITU-ENTANI =
                                WK-CYOKI-GENDO2      -
                                FTN-KOHI2-M3-JI
                      END-IF
                      IF   ZAN-KOHI23 >  WK-ZAN-JIRITU-ENTANI
                        MOVE    WK-ZAN-JIRITU-ENTANI
                                        TO   ZAN-KOHI23
                      END-IF
                   END-IF
                   IF  ( LNK-S02-KOUREI-NYUIN-KBN  =    "1")
                   AND ( MAX-KIN-KOHI2-M > WK-KOH-GENDOGAKU)
                     IF    WK-KOHJGNGET-TAISYOKBN(2)  =   2
                      CONTINUE
                     ELSE
                      IF    FTN-KOHI2-M-JI   >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI2-M-JI
                      END-IF
                      IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
                      END-IF
                      IF    FTN-KOHI2-M2-JI  >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU
                      ELSE
                        COMPUTE WK-ZAN-JIRITU = WK-KOH-GENDOGAKU
                                              - FTN-KOHI2-M2-JI
                      END-IF
                      IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
                        MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
                      END-IF
                      IF    FTN-KOHI2-M3-JI  >=   WK-KOH-GENDOGAKU
                        MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
                      ELSE
                        COMPUTE WK-ZAN-JIRITU-ENTANI =
                                WK-KOH-GENDOGAKU     -
                                FTN-KOHI2-M3-JI
                      END-IF
                      IF   ZAN-KOHI23 >  WK-ZAN-JIRITU-ENTANI
                        MOVE    WK-ZAN-JIRITU-ENTANI
                                        TO   ZAN-KOHI23
                      END-IF
                     END-IF
                   END-IF
               END-IF
      *+++
      ***      IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
      ***          ( COMB-KOH2HKNNUM  = "015" OR "016" ) AND
      ***          ((COMB-KOH1HKNNUM  = "972") OR
      ***           (COMB-KOH3HKNNUM  = "972") OR
      ***           (COMB-KOH4HKNNUM  = "972"))         )
      ***      OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
      ***          ( COMB-KOH2HKNNUM  = "024"          ) AND
      ***          ((COMB-KOH1HKNNUM  = "972") OR
      ***           (COMB-KOH3HKNNUM  = "972") OR
      ***           (COMB-KOH4HKNNUM  = "972"))         )
      ***             IF    FTN-CYOKI-M-JI   >=   WK-CYOKI-GENDO
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
      ***                                     - FTN-CYOKI-M-JI
      ***             END-IF
      ***             IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
      ***             END-IF
      ***             IF    FTN-CYOKI-M2-JI  >=   WK-CYOKI-GENDO
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO
      ***                                     - FTN-CYOKI-M2-JI
      ***             END-IF
      ***             IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
      ***             END-IF
      ***             IF    FTN-CYOKI-M3-JI  >=   WK-CYOKI-GENDO
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU-ENTANI =
      ***                       WK-CYOKI-GENDO       -
      ***                       FTN-CYOKI-M3-JI
      ***             END-IF
      ***             IF   ZAN-KOHI23 >  WK-ZAN-JIRITU-ENTANI
      ***               MOVE    WK-ZAN-JIRITU-ENTANI
      ***                               TO   ZAN-KOHI23
      ***             END-IF
      ***      END-IF
      ***      IF (( LNK-SYU-SRYYMD(1:6)   >=  "200604") AND
      ***          ( COMB-KOH2HKNNUM  = "015" OR "016" ) AND
      ***          ((COMB-KOH1HKNNUM  = "974") OR
      ***           (COMB-KOH3HKNNUM  = "974") OR
      ***           (COMB-KOH4HKNNUM  = "974"))         )
      ***      OR (( LNK-SYU-SRYYMD(1:6)   >=  "200610") AND
      ***          ( COMB-KOH2HKNNUM  = "024"          ) AND
      ***          ((COMB-KOH1HKNNUM  = "974") OR
      ***           (COMB-KOH3HKNNUM  = "974") OR
      ***           (COMB-KOH4HKNNUM  = "974"))         )
      ***             IF    FTN-CYOKI-M-JI   >=   WK-CYOKI-GENDO2
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
      ***                                     - FTN-CYOKI-M-JI
      ***             END-IF
      ***             IF   ZAN-KOHI2  >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI2
      ***             END-IF
      ***             IF    FTN-CYOKI-M2-JI  >=   WK-CYOKI-GENDO2
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU = WK-CYOKI-GENDO2
      ***                                     - FTN-CYOKI-M2-JI
      ***             END-IF
      ***             IF   ZAN-KOHI22 >  WK-ZAN-JIRITU
      ***               MOVE   WK-ZAN-JIRITU  TO  ZAN-KOHI22
      ***             END-IF
      ***             IF    FTN-CYOKI-M3-JI  >=   WK-CYOKI-GENDO2
      ***               MOVE    ZERO    TO   WK-ZAN-JIRITU-ENTANI
      ***             ELSE
      ***               COMPUTE WK-ZAN-JIRITU-ENTANI =
      ***                       WK-CYOKI-GENDO2      -
      ***                       FTN-CYOKI-M3-JI
      ***             END-IF
      ***             IF   ZAN-KOHI23 >  WK-ZAN-JIRITU-ENTANI
      ***               MOVE    WK-ZAN-JIRITU-ENTANI
      ***                               TO   ZAN-KOHI23
      ***             END-IF
      ***      END-IF
      ****
           END-IF.
      *
           IF (COMB-KOH3HKNNUM              NOT = SPACE)    AND
              (COMB-KOH3-NYUJGNKBN          =     "1")
               MOVE   ZAN-KOHI3-M     TO   ZAN-KOHI3
               MOVE   ZAN-KOHI3-M2    TO   ZAN-KOHI32               
               MOVE   ZAN-KOHI3-M3    TO   ZAN-KOHI33               
      *
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI3-M          NOT =   ZERO) AND
                         (MAX-KIN-KOHI3-M-TOKU75   NOT =   ZERO)
                     IF    ZAN-KOHI3   >    ZAN-KOHI3-M-TOKU75
                        MOVE   ZAN-KOHI3-M-TOKU75   TO   ZAN-KOHI3
                        MOVE   ZAN-KOHI3-M2-TOKU75  TO   ZAN-KOHI32
                        MOVE   ZAN-KOHI3-M3-TOKU75  TO   ZAN-KOHI33
                     END-IF
               END-EVALUATE
           END-IF.
      *
           IF (COMB-KOH4HKNNUM              NOT = SPACE)    AND
              (COMB-KOH4-NYUJGNKBN          =     "1")
               MOVE   ZAN-KOHI4-M     TO   ZAN-KOHI4
               MOVE   ZAN-KOHI4-M2    TO   ZAN-KOHI42               
               MOVE   ZAN-KOHI4-M3    TO   ZAN-KOHI43               
      *
               EVALUATE   TRUE
                   WHEN  (MAX-KIN-KOHI4-M          NOT =   ZERO) AND
                         (MAX-KIN-KOHI4-M-TOKU75   NOT =   ZERO)
                     IF    ZAN-KOHI4   >    ZAN-KOHI4-M-TOKU75
                        MOVE   ZAN-KOHI4-M-TOKU75   TO   ZAN-KOHI4
                        MOVE   ZAN-KOHI4-M2-TOKU75  TO   ZAN-KOHI42
                        MOVE   ZAN-KOHI4-M3-TOKU75  TO   ZAN-KOHI43
                     END-IF
               END-EVALUATE
           END-IF.
      *
           IF  LNK-SYU-SRYYMD(1:6)   >=  "200610"
               IF   COMB-KOH1HKNNUM   =  "024" OR "079"
                  IF  FTN-KOHI1-SKJ  >=  WK-SYOGAI-SKJGAK(1)
                       MOVE     ZERO   TO   ZAN-KOHI1-SKJ
                  ELSE
                       COMPUTE  ZAN-KOHI1-SKJ =  WK-SYOGAI-SKJGAK(1)
                                              -  FTN-KOHI1-SKJ
                  END-IF
               END-IF
               IF   COMB-KOH2HKNNUM   =  "024" OR "079"
                  IF  FTN-KOHI2-SKJ  >=  WK-SYOGAI-SKJGAK(2)
                       MOVE     ZERO   TO   ZAN-KOHI2-SKJ
                  ELSE
                       COMPUTE  ZAN-KOHI2-SKJ =  WK-SYOGAI-SKJGAK(2)
                                              -  FTN-KOHI2-SKJ
                  END-IF
               END-IF
           END-IF.
      *
      *    ¼çÊÝ¸±ÉéÃ´¶â³Û¤Î±ßÃ±°Ì¡¡»Ä¶â³Û·×»»                           
           IF   (LNK-S02-KOUREI-NYUIN-KBN   =   "1")
           OR   (FLG-KOHININBARAI           =    1 )
           OR   (FLG-GENBUTU70          NOT =  ZERO)
           OR   (FLG-TOKU75-CYO             =    3 )
           OR   (FLG-CYOKI-ARI              =    2 )
                PERFORM    2303-SYUENTANI-ZAN-KEISAN-SEC
           END-IF.
      *
      *    ¿©»öÎÅÍÜÈñÅù¤Î·×»»
           MOVE    ZERO   TO   WK-SKJ-ZEIKEI.
           MOVE    ZERO   TO   WK-SKJ-ZEIKEIL.
           MOVE    ZERO   TO   WK-SKJ-ZEIKEI2.
           MOVE    ZERO   TO   WK-SKJ-ZEIKEI2L.
           IF   LNK-SYU-SRYYMD(1:6)       >=   "200604"
                PERFORM       2304-SHOKUJI-KEISAN200604-SEC
           ELSE
                PERFORM       2304-SHOKUJI-KEISAN-SEC
           END-IF.
      *
      *    ÊÝ¸±¡¦¸øÈñËè¤Î´µ¼ÔÉéÃ´¶â³Û¤Î·×»»
           MOVE     ZERO       TO       WK-DAY-NYUKFTNRATE.
           MOVE     ZERO       TO       WK-DAY-NYUKFTNRATE2.
           MOVE     ZERO       TO       WK-DAY-NYUKFTNRATE-FLG.
           MOVE     ZERO       TO       WK-DAY-NYUKFTNRATE-FLG2.
           MOVE     ZERO       TO       WK-KOH-FTNRATE.
           MOVE     ZERO       TO       FLG-GENBUTU-TAISYODATA.
           MOVE     ZERO       TO       WK-KUMAMOTO-SYUCOMPFTN.
           MOVE     ZERO       TO       WK-SKYCHK-KEISAN9.
           MOVE     ZERO       TO       WK-SKYCHK-KEISAN10.
           IF    ((COMB-KOH1-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH1HKNNUM           =   "027")) OR 
                 ((COMB-KOH2-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH2HKNNUM           =   "027")) OR 
                 ((COMB-KOH3-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH3HKNNUM           =   "027")) OR 
                 ((COMB-KOH4-HKNKOHSBTKBN    =   "3")    AND
                  (COMB-KOH4HKNNUM           =   "027")) 
                  CONTINUE
           ELSE
               IF    COMB-HKNNUM             NOT =       SPACE
                  PERFORM    2305-SYUHOKEN-KEISAN-SEC
               END-IF
           END-IF.
      *
           MOVE     ZERO     TO     WK-TOKUTEI-COMPFTN3.
           MOVE     SPACE    TO     FLG-KUMAMOTO.
           MOVE     ZERO     TO     FLG-KUMAMOTO-CYO.
           MOVE     ZERO     TO     WK-KUMAMOTO-HANTEIJGN.
           INITIALIZE               WK-TAIHI-RECEFTNDSPKBN-OCC.
      *
           INITIALIZE               WK-SYOUKAN-FLG-TAIHI-AREA.
           INITIALIZE               WK-TAIHI-FTNGAKEN-OCC.
      *
           MOVE    ZERO      TO     WK-TOKUSYU-COMPFTN.
           MOVE    9999999   TO     WK-TOKUSYU-COMPFTN2.
           MOVE    ZERO      TO     WK-TOKUSYU-ENTANI.
      *
           MOVE    ZERO      TO     FLG-MARUTOARI.
           MOVE    ZERO      TO     FLG-MARUTOARI2.
           MOVE    ZERO      TO     WK-MARUTOARI-COMPFTN.
      *
           MOVE    ZERO      TO     WK-CYOKI-ZAN.
           MOVE    ZERO      TO     WK-CYOKI-ZAN-ENTANI.
           IF   (COMB-KOH1HKNNUM     = "972") OR
                (COMB-KOH2HKNNUM     = "972") OR
                (COMB-KOH3HKNNUM     = "972") OR
                (COMB-KOH4HKNNUM     = "972")
                 IF   WK-CYOKI         >   WK-CYOKI-GENDO
                    MOVE   ZERO   TO   WK-CYOKI-ZAN
                 ELSE
                    COMPUTE WK-CYOKI-ZAN  =  WK-CYOKI-GENDO
                                          -  WK-CYOKI
                 END-IF
                 IF   WK-CYOKI-ENTANI  >   WK-CYOKI-GENDO
                    MOVE   ZERO   TO   WK-CYOKI-ZAN-ENTANI
                 ELSE
                    COMPUTE WK-CYOKI-ZAN-ENTANI =  WK-CYOKI-GENDO
                                                -  WK-CYOKI-ENTANI
                 END-IF
                 IF  (FLG-TOKU75 = 1 OR 2 OR 3)
                   IF   WK-CYOKI-TOKU75 >   WK-CYOKI-GENDO-TOKU75
                     MOVE   ZERO   TO   WK-CYOKI-ZAN-XXX
                   ELSE
                     COMPUTE WK-CYOKI-ZAN-XXX
                                   =  WK-CYOKI-GENDO-TOKU75
                                   -  WK-CYOKI-TOKU75
                   END-IF
                   IF   WK-CYOKI-ZAN > WK-CYOKI-ZAN-XXX
                     MOVE  WK-CYOKI-ZAN-XXX
                                  TO  WK-CYOKI-ZAN
                     IF   WK-CYOKI-ENTANI-TOKU75
                                    > WK-CYOKI-GENDO-TOKU75
                       MOVE   ZERO   TO   WK-CYOKI-ZAN-XXX-ENTANI
                     ELSE
                       COMPUTE WK-CYOKI-ZAN-XXX-ENTANI
                                   =  WK-CYOKI-GENDO-TOKU75
                                   -  WK-CYOKI-ENTANI-TOKU75
                     END-IF
                     MOVE  WK-CYOKI-ZAN-XXX-ENTANI
                                  TO  WK-CYOKI-ZAN-ENTANI
                   END-IF
                 END-IF
           END-IF.
           IF   (COMB-KOH1HKNNUM     = "974") OR
                (COMB-KOH2HKNNUM     = "974") OR
                (COMB-KOH3HKNNUM     = "974") OR
                (COMB-KOH4HKNNUM     = "974")
                 IF   WK-CYOKI         >   WK-CYOKI-GENDO2
                    MOVE   ZERO   TO   WK-CYOKI-ZAN
                 ELSE
                    COMPUTE WK-CYOKI-ZAN  =  WK-CYOKI-GENDO2
                                          -  WK-CYOKI
                 END-IF
                 IF   WK-CYOKI-ENTANI  >   WK-CYOKI-GENDO2
                    MOVE   ZERO   TO   WK-CYOKI-ZAN-ENTANI
                 ELSE
                    COMPUTE WK-CYOKI-ZAN-ENTANI =  WK-CYOKI-GENDO2
                                                -  WK-CYOKI-ENTANI
                 END-IF
                 IF  (FLG-TOKU75 = 1 OR 2 OR 3)
                   IF   WK-CYOKI-TOKU75 >   WK-CYOKI-GENDO2-TOKU75
                     MOVE   ZERO   TO   WK-CYOKI-ZAN-XXX
                   ELSE
                     COMPUTE WK-CYOKI-ZAN-XXX
                                   =  WK-CYOKI-GENDO2-TOKU75
                                   -  WK-CYOKI-TOKU75
                   END-IF
                   IF   WK-CYOKI-ZAN > WK-CYOKI-ZAN-XXX
                     MOVE  WK-CYOKI-ZAN-XXX
                                  TO  WK-CYOKI-ZAN
                     IF   WK-CYOKI-ENTANI-TOKU75
                                    > WK-CYOKI-GENDO2-TOKU75
                       MOVE   ZERO   TO   WK-CYOKI-ZAN-XXX-ENTANI
                     ELSE
                       COMPUTE WK-CYOKI-ZAN-XXX-ENTANI
                                   =  WK-CYOKI-GENDO2-TOKU75
                                   -  WK-CYOKI-ENTANI-TOKU75
                     END-IF
                     MOVE  WK-CYOKI-ZAN-XXX-ENTANI
                                  TO  WK-CYOKI-ZAN-ENTANI
                   END-IF
                 END-IF
           END-IF.
      *
           INITIALIZE   WK-DAYINF-ZENKOH-AREA.
           PERFORM    VARYING   KOH-IDX    FROM   1   BY   1
                      UNTIL    (KOH-IDX    >      4)
               IF   COMB-KOHHKNNUM(KOH-IDX)  NOT =  SPACE
                    PERFORM    2306-KOH-HKNREAD-SEC
                    IF   COMB-KOH-NYUJGNKBN(KOH-IDX)  =  "1"
                         PERFORM   2307-KOH-KEISAN-SEC
                    ELSE
                         PERFORM   2308-KOH-KEISAN2-SEC
                    END-IF
      *
      *             ÆüÊÌ¼ýÇ¼»»Äê¡ÊÁ´¹ñ¸øÈñ¡Ë
                    IF  ((COMB-KOHHKNNUM(KOH-IDX) =
                                            "015" OR "016" OR "021") AND
                         (WK-JIRITU-CYUKANSOU(KOH-IDX) =  2        ))
                    OR  ( COMB-KOHHKNNUM(KOH-IDX) =
                          "052" OR "054" OR "024" OR "079" OR "038" )
                    OR  ((COMB-KOHHKNNUM(KOH-IDX) =  "092"         ) AND
                         (WK-KOHJGNGET-CHECK092(KOH-IDX)
                                                  =  ZERO          ) AND
                         (LNK-SYU-SRYYMD(1:6)    >= "201812"       ))
                      IF   (KOH-IDX               =   1     )
                      AND  (MAX-KIN-KOHI1-M   NOT =  ZERO   )
                      AND  (LNK-SYU-SRYYMD(1:6)  >= "201501")
                         PERFORM   230A-DAYINF-SANTEI-ZENKOH-SEC
                      END-IF
                    END-IF
               END-IF 
           END-PERFORM.
      *
      *     ¸øÈñÃ±°Ì¤Ç·×»»¤·¤¿´µ¼ÔÉéÃ´¶â³Û¤«¤éºÇ¾®¤ÎÃÍ¤òÁªÂò¥»¥Ã¥È
            PERFORM   2309-FTNKIN-HIKAKU-SEC.
      *
       230-FTNKIN-EXT.
           EXIT.
      *
      ******************************************************************
      *        £±ÆüÃ±°Ì¤Î»»Äê²ÄÇ½»Ä³Û¤ò»»½Ð¤¹¤ë
      ******************************************************************
       2301-DAY-ZAN-HENSYU-SEC           SECTION.
      *
           PERFORM   23011-DAY-ZAN-HENSYU-RRK-SEC.
      *
           INITIALIZE     WK-DAYINFFLG-AREA.
      *
           IF (COMB-KOH1HKNNUM           NOT = SPACE)    AND
              (COMB-KOH1-NYUJGNKBN       =     "1")
               IF     ((MAX-KIN-KOHI1-D       NOT = ZERO) AND
                       (MAX-KIN-KOHI1-M           = ZERO))
               OR     ((MAX-KIN-KOHI1-D       NOT = ZERO) AND
                       (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                  MOVE        1         TO    WK-DAYINFFLG(1)
                  PERFORM    VARYING   IDX2   FROM   1   BY   1
                              UNTIL    IDX2     >    31
                     IF  ((LNK-SYU-DAY(IDX2) =
                                       "1" OR "2" OR "8" OR "9") AND
                          (LNK-SDAY-HKNTEN(IDX2)  NOT =  ZERO  ))
                     OR  ((LNK-S02-NYUINDAY-KBN(IDX2) =  "1"   ) AND
                          (WK-2010-TANKIKBN(1)        =  "1"   ))
                       IF   WK-RRK2-FLG(1)  =   1
                        IF   WK-RRK-KAISU-ZAN(IDX2)  NOT = ZERO
                          MOVE        SPACE    TO    FLG-NG
                          MOVE         9       TO    KOHI1-TBL(IDX2)
                        ELSE
                          MOVE        "1"      TO    FLG-NG
                        END-IF
                       ELSE
                        IF   MAX-KAI-KOHI1-M       NOT = ZERO
                          IF  KOHI1-TBL(IDX2)  NOT = ZERO
                             MOVE     SPACE    TO    FLG-NG
                             MOVE      9       TO    KOHI1-TBL(IDX2)
                          ELSE
                             IF   KOHI1-TBL(32)  >=  MAX-KAI-KOHI1-M
                               MOVE   "1"      TO    FLG-NG
                             ELSE
                              IF  (WK-2010-SYOKEIKBN-N(1)      = "1"  )
                              AND (LNK-S02-SYOSINFLG-DAY(IDX2) = SPACE)
                               MOVE   "1"      TO    FLG-NG
                              ELSE
                               MOVE   SPACE    TO    FLG-NG
                               IF   WK-2010-KAICNTKBN-N(1) = "1"
                                 MOVE  8       TO    KOHI1-TBL(IDX2)
                               ELSE
                                 MOVE  9       TO    KOHI1-TBL(IDX2)
                               END-IF
                               ADD     1       TO    KOHI1-TBL(32)
                              END-IF
                             END-IF
                          END-IF
                        ELSE
                          MOVE        SPACE    TO    FLG-NG
                          MOVE         9       TO    KOHI1-TBL(IDX2)
                        END-IF
                       END-IF
                       IF     FLG-NG   =    SPACE  
                         IF   FTN-KOHI1-D(IDX2)     >=  MAX-KIN-KOHI1-D
                              MOVE     ZERO    TO  ZAN-KOHI1-D(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI1-D(IDX2) =
                                       MAX-KIN-KOHI1-D   -
                                       FTN-KOHI1-D(IDX2)
                         END-IF
                         IF   FTN-KOHI1-D2(IDX2)  >=  MAX-KIN-KOHI1-D
                              MOVE     ZERO    TO  ZAN-KOHI1-D2(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI1-D2(IDX2) =
                                       MAX-KIN-KOHI1-D    -
                                       FTN-KOHI1-D2(IDX2)
                         END-IF
                         IF   FTN-KOHI1-D3(IDX2)  >=  MAX-KIN-KOHI1-D
                              MOVE     ZERO    TO  ZAN-KOHI1-D3(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI1-D3(IDX2) =
                                       MAX-KIN-KOHI1-D    -
                                       FTN-KOHI1-D3(IDX2)
                         END-IF
                       END-IF
                     END-IF
                  END-PERFORM
      *
                  MOVE        ZERO     TO     WK-DAYCNT
                  PERFORM    VARYING   IDX2   FROM   1   BY   1
                              UNTIL    IDX2     >    31
                     IF   (WK-RRK2-FLG(1)         =  ZERO)
                     AND  (MAX-KAI-KOHI1-M    NOT =  ZERO)
                     AND  (WK-2010-KAICNTKBN-N(1) =  "1" )
                        IF   (KOHI1-TBL(IDX2)    =  8 OR 9)
                        OR   (KOHI1-TBL2(IDX2)   =  1     )
                          ADD    1     TO     WK-DAYCNT
                          IF  WK-DAYCNT  >  MAX-KAI-KOHI1-M
                             IF  KOHI1-TBL(IDX2) =  8
                               MOVE   ZERO  TO   KOHI1-TBL(IDX2)
                             END-IF
                          ELSE
                             IF  KOHI1-TBL(IDX2) =  8
                               MOVE    9    TO   KOHI1-TBL(IDX2)
                             END-IF
                          END-IF
                        END-IF
                     END-IF
                  END-PERFORM
               END-IF
           END-IF.
      *
           IF (COMB-KOH2HKNNUM           NOT = SPACE)    AND
              (COMB-KOH2-NYUJGNKBN       =     "1")
               IF     ((MAX-KIN-KOHI2-D       NOT = ZERO) AND
                       (MAX-KIN-KOHI2-M           = ZERO))
               OR     ((MAX-KIN-KOHI2-D       NOT = ZERO) AND
                       (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                  MOVE        1         TO    WK-DAYINFFLG(2)
                  PERFORM    VARYING   IDX2   FROM   1   BY   1
                              UNTIL    IDX2     >    31
                     IF  ((LNK-SYU-DAY(IDX2) =
                                       "1" OR "2" OR "8" OR "9") AND
                          (LNK-SDAY-HKNTEN(IDX2)  NOT =  ZERO  ))
                     OR  ((LNK-S02-NYUINDAY-KBN(IDX2) =  "1"   ) AND
                          (WK-2010-TANKIKBN(2)        =  "1"   ))
                       IF   WK-RRK2-FLG(2)  =   1
                        IF   WK-RRK-KAISU-ZAN(IDX2)  NOT = ZERO
                          MOVE        SPACE    TO    FLG-NG
                          MOVE         9       TO    KOHI2-TBL(IDX2)
                        ELSE
                          MOVE        "1"      TO    FLG-NG
                        END-IF
                       ELSE
                        IF   MAX-KAI-KOHI2-M       NOT = ZERO
                          IF  KOHI2-TBL(IDX2)  NOT = ZERO
                             MOVE     SPACE    TO    FLG-NG
                             MOVE      9       TO    KOHI2-TBL(IDX2)
                          ELSE
                             IF   KOHI2-TBL(32)  >=  MAX-KAI-KOHI2-M
                               MOVE   "1"      TO    FLG-NG
                             ELSE
                              IF  (WK-2010-SYOKEIKBN-N(2)      = "1"  )
                              AND (LNK-S02-SYOSINFLG-DAY(IDX2) = SPACE)
                               MOVE   "1"      TO    FLG-NG
                              ELSE
                               MOVE   SPACE    TO    FLG-NG
                               IF   WK-2010-KAICNTKBN-N(2) = "1"
                                 MOVE  8       TO    KOHI2-TBL(IDX2)
                               ELSE
                                 MOVE  9       TO    KOHI2-TBL(IDX2)
                               END-IF
                               ADD     1       TO    KOHI2-TBL(32)
                              END-IF
                             END-IF
                          END-IF
                        ELSE
                          MOVE        SPACE    TO    FLG-NG
                          MOVE         9       TO    KOHI2-TBL(IDX2)
                        END-IF
                       END-IF
                       IF     FLG-NG   =    SPACE  
                         IF   FTN-KOHI2-D(IDX2)     >=  MAX-KIN-KOHI2-D
                              MOVE     ZERO    TO  ZAN-KOHI2-D(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI2-D(IDX2) =
                                       MAX-KIN-KOHI2-D   -
                                       FTN-KOHI2-D(IDX2)
                         END-IF
                         IF   FTN-KOHI2-D2(IDX2)  >=  MAX-KIN-KOHI2-D
                              MOVE     ZERO    TO  ZAN-KOHI2-D2(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI2-D2(IDX2) =
                                       MAX-KIN-KOHI2-D    -
                                       FTN-KOHI2-D2(IDX2)
                         END-IF
                         IF   FTN-KOHI2-D3(IDX2)  >=  MAX-KIN-KOHI2-D
                              MOVE     ZERO    TO  ZAN-KOHI2-D3(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI2-D3(IDX2) =
                                       MAX-KIN-KOHI2-D    -
                                       FTN-KOHI2-D3(IDX2)
                         END-IF
                       END-IF
                     END-IF
                  END-PERFORM
      *
                  MOVE        ZERO     TO     WK-DAYCNT
                  PERFORM    VARYING   IDX2   FROM   1   BY   1
                              UNTIL    IDX2     >    31
                     IF   (WK-RRK2-FLG(2)         =  ZERO)
                     AND  (MAX-KAI-KOHI2-M    NOT =  ZERO)
                     AND  (WK-2010-KAICNTKBN-N(2) =  "1" )
                        IF   (KOHI2-TBL(IDX2)    =  8 OR 9)
                        OR   (KOHI2-TBL2(IDX2)   =  1     )
                          ADD    1     TO     WK-DAYCNT
                          IF  WK-DAYCNT  >  MAX-KAI-KOHI2-M
                             IF  KOHI2-TBL(IDX2) =  8
                               MOVE   ZERO  TO   KOHI2-TBL(IDX2)
                             END-IF
                          ELSE
                             IF  KOHI2-TBL(IDX2) =  8
                               MOVE    9    TO   KOHI2-TBL(IDX2)
                             END-IF
                          END-IF
                        END-IF
                     END-IF
                  END-PERFORM
               END-IF
           END-IF.
      *
           IF (COMB-KOH3HKNNUM           NOT = SPACE)    AND
              (COMB-KOH3-NYUJGNKBN       =     "1")
               IF     ((MAX-KIN-KOHI3-D       NOT = ZERO) AND
                       (MAX-KIN-KOHI3-M           = ZERO))
               OR     ((MAX-KIN-KOHI3-D       NOT = ZERO) AND
                       (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                  MOVE        1         TO    WK-DAYINFFLG(3)
                  PERFORM    VARYING   IDX2   FROM   1   BY   1
                              UNTIL    IDX2     >    31
                     IF  ((LNK-SYU-DAY(IDX2) =
                                       "1" OR "2" OR "8" OR "9") AND
                          (LNK-SDAY-HKNTEN(IDX2)  NOT =  ZERO  ))
                     OR  ((LNK-S02-NYUINDAY-KBN(IDX2) =  "1"   ) AND
                          (WK-2010-TANKIKBN(3)        =  "1"   ))
                       IF   WK-RRK2-FLG(3)  =   1
                        IF   WK-RRK-KAISU-ZAN(IDX2)  NOT = ZERO
                          MOVE        SPACE    TO    FLG-NG
                          MOVE         9       TO    KOHI3-TBL(IDX2)
                        ELSE
                          MOVE        "1"      TO    FLG-NG
                        END-IF
                       ELSE
                        IF   MAX-KAI-KOHI3-M       NOT = ZERO
                          IF  KOHI3-TBL(IDX2)  NOT = ZERO
                             MOVE     SPACE    TO    FLG-NG
                             MOVE      9       TO    KOHI3-TBL(IDX2)
                          ELSE
                             IF   KOHI3-TBL(32)  >=  MAX-KAI-KOHI3-M
                               MOVE   "1"      TO    FLG-NG
                             ELSE
                              IF  (WK-2010-SYOKEIKBN-N(3)      = "1"  )
                              AND (LNK-S02-SYOSINFLG-DAY(IDX2) = SPACE)
                               MOVE   "1"      TO    FLG-NG
                              ELSE
                               MOVE   SPACE    TO    FLG-NG
                               IF   WK-2010-KAICNTKBN-N(3) = "1"
                                 MOVE  8       TO    KOHI3-TBL(IDX2)
                               ELSE
                                 MOVE  9       TO    KOHI3-TBL(IDX2)
                               END-IF
                               ADD     1       TO    KOHI3-TBL(32)
                              END-IF
                             END-IF
                          END-IF
                        ELSE
                          MOVE        SPACE    TO    FLG-NG
                          MOVE         9       TO    KOHI3-TBL(IDX2)
                        END-IF
                       END-IF
                       IF     FLG-NG   =    SPACE  
                         IF   FTN-KOHI3-D(IDX2)     >=  MAX-KIN-KOHI3-D
                              MOVE     ZERO    TO  ZAN-KOHI3-D(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI3-D(IDX2) =
                                       MAX-KIN-KOHI3-D   -
                                       FTN-KOHI3-D(IDX2)
                         END-IF
                         IF   FTN-KOHI3-D2(IDX2)  >=  MAX-KIN-KOHI3-D
                              MOVE     ZERO    TO  ZAN-KOHI3-D2(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI3-D2(IDX2) =
                                       MAX-KIN-KOHI3-D    -
                                       FTN-KOHI3-D2(IDX2)
                         END-IF
                         IF   FTN-KOHI3-D3(IDX2)  >=  MAX-KIN-KOHI3-D
                              MOVE     ZERO    TO  ZAN-KOHI3-D3(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI3-D3(IDX2) =
                                       MAX-KIN-KOHI3-D    -
                                       FTN-KOHI3-D3(IDX2)
                         END-IF
                       END-IF
                     END-IF
                  END-PERFORM
      *
                  MOVE        ZERO     TO     WK-DAYCNT
                  PERFORM    VARYING   IDX2   FROM   1   BY   1
                              UNTIL    IDX2     >    31
                     IF   (WK-RRK2-FLG(3)         =  ZERO)
                     AND  (MAX-KAI-KOHI3-M    NOT =  ZERO)
                     AND  (WK-2010-KAICNTKBN-N(3) =  "1" )
                        IF   (KOHI3-TBL(IDX2)    =  8 OR 9)
                        OR   (KOHI3-TBL2(IDX2)   =  1     )
                          ADD    1     TO     WK-DAYCNT
                          IF  WK-DAYCNT  >  MAX-KAI-KOHI3-M
                             IF  KOHI3-TBL(IDX2) =  8
                               MOVE   ZERO  TO   KOHI3-TBL(IDX2)
                             END-IF
                          ELSE
                             IF  KOHI3-TBL(IDX2) =  8
                               MOVE    9    TO   KOHI3-TBL(IDX2)
                             END-IF
                          END-IF
                        END-IF
                     END-IF
                  END-PERFORM
               END-IF
           END-IF.
      *
           IF (COMB-KOH4HKNNUM           NOT = SPACE)    AND
              (COMB-KOH4-NYUJGNKBN       =     "1")
               IF     ((MAX-KIN-KOHI4-D       NOT = ZERO) AND
                       (MAX-KIN-KOHI4-M           = ZERO))
               OR     ((MAX-KIN-KOHI4-D       NOT = ZERO) AND
                       (LNK-SYU-SRYYMD(1:6) >= "200508" ))
                  MOVE        1         TO    WK-DAYINFFLG(4)
                  PERFORM    VARYING   IDX2   FROM   1   BY   1
                              UNTIL    IDX2     >    31
                     IF  ((LNK-SYU-DAY(IDX2) =
                                       "1" OR "2" OR "8" OR "9") AND
                          (LNK-SDAY-HKNTEN(IDX2)  NOT =  ZERO  ))
                     OR  ((LNK-S02-NYUINDAY-KBN(IDX2) =  "1"   ) AND
                          (WK-2010-TANKIKBN(4)        =  "1"   ))
                       IF   WK-RRK2-FLG(4)  =   1
                        IF   WK-RRK-KAISU-ZAN(IDX2)  NOT = ZERO
                          MOVE        SPACE    TO    FLG-NG
                          MOVE         9       TO    KOHI4-TBL(IDX2)
                        ELSE
                          MOVE        "1"      TO    FLG-NG
                        END-IF
                       ELSE
                        IF   MAX-KAI-KOHI4-M       NOT = ZERO
                          IF  KOHI4-TBL(IDX2)  NOT = ZERO
                             MOVE     SPACE    TO    FLG-NG
                             MOVE      9       TO    KOHI4-TBL(IDX2)
                          ELSE
                             IF   KOHI4-TBL(32)  >=  MAX-KAI-KOHI4-M
                               MOVE   "1"      TO    FLG-NG
                             ELSE
                              IF  (WK-2010-SYOKEIKBN-N(4)      = "1"  )
                              AND (LNK-S02-SYOSINFLG-DAY(IDX2) = SPACE)
                               MOVE   "1"      TO    FLG-NG
                              ELSE
                               MOVE   SPACE    TO    FLG-NG
                               IF   WK-2010-KAICNTKBN-N(4) = "1"
                                 MOVE  8       TO    KOHI4-TBL(IDX2)
                               ELSE
                                 MOVE  9       TO    KOHI4-TBL(IDX2)
                               END-IF
                               ADD     1       TO    KOHI4-TBL(32)
                              END-IF
                             END-IF
                          END-IF
                        ELSE
                          MOVE        SPACE    TO    FLG-NG
                          MOVE         9       TO    KOHI4-TBL(IDX2)
                        END-IF
                       END-IF
                       IF     FLG-NG   =    SPACE  
                         IF   FTN-KOHI4-D(IDX2)     >=  MAX-KIN-KOHI4-D
                              MOVE     ZERO    TO  ZAN-KOHI4-D(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI4-D(IDX2) =
                                       MAX-KIN-KOHI4-D   -
                                       FTN-KOHI4-D(IDX2)
                         END-IF
                         IF   FTN-KOHI4-D2(IDX2)  >=  MAX-KIN-KOHI4-D
                              MOVE     ZERO    TO  ZAN-KOHI4-D2(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI4-D2(IDX2) =
                                       MAX-KIN-KOHI4-D    -
                                       FTN-KOHI4-D2(IDX2)
                         END-IF
                         IF   FTN-KOHI4-D3(IDX2)  >=  MAX-KIN-KOHI4-D
                              MOVE     ZERO    TO  ZAN-KOHI4-D3(IDX2)
                         ELSE
                              COMPUTE  ZAN-KOHI4-D3(IDX2) =
                                       MAX-KIN-KOHI4-D    -
                                       FTN-KOHI4-D3(IDX2)
                         END-IF
                       END-IF
                     END-IF
                  END-PERFORM
      *
                  MOVE        ZERO     TO     WK-DAYCNT
                  PERFORM    VARYING   IDX2   FROM   1   BY   1
                              UNTIL    IDX2     >    31
                     IF   (WK-RRK2-FLG(4)         =  ZERO)
                     AND  (MAX-KAI-KOHI4-M    NOT =  ZERO)
                     AND  (WK-2010-KAICNTKBN-N(4) =  "1" )
                        IF   (KOHI4-TBL(IDX2)    =  8 OR 9)
                        OR   (KOHI4-TBL2(IDX2)   =  1     )
                          ADD    1     TO     WK-DAYCNT
                          IF  WK-DAYCNT  >  MAX-KAI-KOHI4-M
                             IF  KOHI4-TBL(IDX2) =  8
                               MOVE   ZERO  TO   KOHI4-TBL(IDX2)
                             END-IF
                          ELSE
                             IF  KOHI4-TBL(IDX2) =  8
                               MOVE    9    TO   KOHI4-TBL(IDX2)
                             END-IF
                          END-IF
                        END-IF
                     END-IF
                  END-PERFORM
               END-IF
           END-IF.
      *
       2301-DAY-ZAN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¡ã£±Æþ±¡²ó¿ôÂÐ±þ¡äÆüÊÌ¼ýÇ¼ÊÔ½¸¡ÊÅö·î¡Ë»»Äê²ó¿ô¥«¥¦¥ó¥È
      ******************************************************************
       23011-DAY-ZAN-HENSYU-RRK-SEC           SECTION.
      *
           IF   (WK-RRK2-FLG(1)   =   1)
           OR   (WK-RRK2-FLG(2)   =   1)
           OR   (WK-RRK2-FLG(3)   =   1)
           OR   (WK-RRK2-FLG(4)   =   1)
             PERFORM  VARYING  RRK-IDX  FROM  1  BY  1
                       UNTIL   RRK-IDX   >   31
               IF  (WK-RRK-NYUINYMD(RRK-IDX)  NOT = SPACE)
               AND (WK-RRK-KAISU-ZAN(RRK-IDX) NOT = ZERO )
                  MOVE  WK-RRK-NYUINYMD(RRK-IDX)(7:2)  TO  RRK-IDX3
                  PERFORM  VARYING  RRK-IDX2  FROM  1  BY  1
                            UNTIL   RRK-IDX2   >   31
                     IF ( WK-RRK-NYUINYMD(RRK-IDX)(1:6)
                                           <    LNK-SYU-SRYYMD(1:6) )
                     OR ((WK-RRK-NYUINYMD(RRK-IDX)(1:6)
                                           =    LNK-SYU-SRYYMD(1:6)) AND
                         (RRK-IDX3        <=    RRK-IDX2           ))
                       IF ((WK-RRK2-FLG(1)      =  1) AND
                           (KOHI1-TBL(RRK-IDX2) =  1))
                       OR ((WK-RRK2-FLG(2)      =  1) AND
                           (KOHI2-TBL(RRK-IDX2) =  1))
                       OR ((WK-RRK2-FLG(3)      =  1) AND
                           (KOHI3-TBL(RRK-IDX2) =  1))
                       OR ((WK-RRK2-FLG(4)      =  1) AND
                           (KOHI4-TBL(RRK-IDX2) =  1))
                          IF  RRK-IDX = RRK-IDX2
                            MOVE  999   TO  WK-RRK-KAISU-ZAN(RRK-IDX)
                          ELSE
                            IF  (WK-RRK-KAISU-ZAN(RRK-IDX) NOT = ZERO)
                            AND (WK-RRK-KAISU-ZAN(RRK-IDX) NOT = 999 )
                              COMPUTE  WK-RRK-KAISU-ZAN(RRK-IDX) =
                                       WK-RRK-KAISU-ZAN(RRK-IDX) -
                                       1
                            END-IF
                          END-IF
                       END-IF
                     END-IF
                  END-PERFORM
               END-IF
             END-PERFORM
             PERFORM  VARYING  RRK-IDX  FROM  1  BY  1
                       UNTIL   RRK-IDX   >   31
               IF  (WK-RRK-NYUINYMD(RRK-IDX)  NOT = SPACE)
               AND (WK-RRK-KAISU-ZAN(RRK-IDX) NOT = ZERO )
               AND (WK-RRK-KAISU-ZAN(RRK-IDX) NOT = 999  )
                  COMPUTE  RRK-IDX3 = RRK-IDX + 1
                  PERFORM  VARYING  RRK-IDX2  FROM  RRK-IDX3  BY  1
                            UNTIL   RRK-IDX2   >     31
                    IF  (WK-RRK-NYUINYMD(RRK-IDX2)  NOT = SPACE)
                    AND (WK-RRK-KAISU-ZAN(RRK-IDX2) NOT = ZERO )
                    AND (WK-RRK-KAISU-ZAN(RRK-IDX2) NOT = 999  )
                      IF  WK-RRK-NYUINYMD(RRK-IDX) =
                                      WK-RRK-NYUINYMD(RRK-IDX2)
                        COMPUTE  WK-RRK-KAISU-ZAN(RRK-IDX2) =
                                 WK-RRK-KAISU-ZAN(RRK-IDX2) -
                                 1
                      END-IF
                    END-IF
                  END-PERFORM
               END-IF
             END-PERFORM
           END-IF
      *
           .
      *
       23011-DAY-ZAN-HENSYU-RRK-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¼çÊÝ¸±ÉéÃ´¶â³Û¤Î±ßÃ±°Ì¡¡»Ä¶â³Û·×»»
      ******************************************************************
       2303-SYUENTANI-ZAN-KEISAN-SEC           SECTION.              
      *
      *    »»Äê²ÄÇ½¥Õ¥é¥°¤Î½é´ü²½
           MOVE     SPACE                  TO     FLG-SANTEI1-ENTANI
                                                  FLG-SANTEI-SYU-ENTANI.
      *
      *    ²áµî¤Î´µ¼ÔÊÝ¸±ÉéÃ´Îß·×³Û¤È¾å¸Â¶â³Û¤ÎÈæ³Ó
      *
           IF   COMB-KOH1HKNNUM      =    "027"
             IF       MAX-KIN-KOHI1-M        NOT =  ZERO
               IF   FTN-KOHI1-M-ENTANI        >=     MAX-KIN-KOHI1-M
                       MOVE     "1"       TO     FLG-SANTEI1-ENTANI
               END-IF
             END-IF
           END-IF.
      *
           IF         MAX-KIN-SYU-M          NOT =  ZERO
               IF  FTN-SYU-M-ENTANI           >=     MAX-KIN-SYU-M
                      MOVE  "1"           TO     FLG-SANTEI-SYU-ENTANI
               END-IF
           END-IF.
      *
      *    ÊÝ¸±¡Ê¸øÈñ¡Ë¥Æ¡¼¥Ö¥ë¤Î´µ¼ÔÉéÃ´¾å¸Â³Û¤ÈÅö·î¤Î´µ¼ÔÉéÃ´Îß·×³Û
      *    ¤«¤é»»Äê²ÄÇ½»Ä³Û¤ò»»½Ð¤¹¤ë
      *
           IF  FLG-SANTEI1-ENTANI           =     "1"
               MOVE     ZERO             TO    ZAN-KOHI1-ENTANI
           ELSE
               IF  COMB-KOH1HKNNUM           =   "027"
                   IF       MAX-KIN-KOHI1-M       NOT = ZERO
                       COMPUTE  ZAN-KOHI1-ENTANI =   MAX-KIN-KOHI1-M
                                                 -   FTN-KOHI1-M-ENTANI
                   END-IF
               END-IF
           END-IF.
      *
           IF  FLG-SANTEI-SYU-ENTANI        =     "1"
               MOVE     ZERO             TO    ZAN-SYU-M-ENTANI
           ELSE
               IF       MAX-KIN-SYU-M    NOT = ZERO
                     COMPUTE  ZAN-SYU-M-ENTANI  =   MAX-KIN-SYU-M
                                                -   FTN-SYU-M-ENTANI
               END-IF
           END-IF.
      *
       2303-SYUENTANI-ZAN-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¥·¥¹´É¡¦Æþ±¡²ñ·×¤«¤é¿©»öÎÅÍÜÈñÅù¤Î·×»»¤ò¹Ô¤¦            *
      ******************************************************************
       2304-SHOKUJI-KEISAN-SEC         SECTION.
      *
           INITIALIZE    WK-SHOKUJI-TAIHI-AREA
                         WK-DAY-SKJFTN-AREA
      *
           PERFORM       23045-SYS-5000-CHK-SEC
      *
           INITIALIZE                            NYUINACCT-REC
           MOVE    LNK-SYU-HOSPNUM       TO      NACCT-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN     TO      NACCT-NYUGAIKBN
           MOVE    LNK-SYU-PTID          TO      NACCT-PTID
      ***  MOVE    "00"                  TO      NACCT-SRYKA
           MOVE    LNK-SYU-SRYYMD(1:6)   TO      NACCT-SRYYM
           MOVE    NYUINACCT-REC         TO      MCPDATA-REC
           MOVE    "DBSELECT"            TO      MCP-FUNC
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key7"                TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING   MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC             =       ZERO
               MOVE    "tbl_nyuinacct"   TO      MCP-TABLE
               MOVE    "key7"            TO      MCP-PATHNAME
               PERFORM  NYUINACCT-READ-SEC
               PERFORM  UNTIL   FLG-NYUINACCT  =     1
      *
                 IF     NACCT-SRYCDTOTAL    =    197000570
                         PERFORM     23041-SHOKUDOKASANTOU-TAIHI-SEC
                 END-IF
      *
                 IF     NACCT-ZAISKBKBN     =    "2"
                         PERFORM     23042-GAIHAKU-TAIHI-SEC
                 END-IF
      *
                 MOVE     "tbl_nyuinacct"   TO   MCP-TABLE
                 MOVE     "key7"            TO   MCP-PATHNAME
                 PERFORM   NYUINACCT-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_nyuinacct" TO   MCP-TABLE
           MOVE    "key7"          TO   MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           INITIALIZE                            SRYACCT-REC
           MOVE    LNK-SYU-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    LNK-SYU-PTID          TO      ACCT-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)   TO      ACCT-SRYYM
           MOVE    SRYACCT-REC           TO      MCPDATA-REC
           MOVE    "DBSELECT"            TO      MCP-FUNC
           MOVE    "tbl_sryacct"         TO      MCP-TABLE
           MOVE    "key45"               TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING   MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC                =       ZERO
               MOVE    "tbl_sryacct"     TO      MCP-TABLE
               MOVE    "key45"           TO      MCP-PATHNAME
               PERFORM  SRYACCT-READ-SEC
               PERFORM  UNTIL   FLG-SRYACCT     =    1
      *
                 IF     LNK-SYU-HKNCOMBINUM  =    ACCT-HKNCOMBI
                         PERFORM    23043-ROSAITOKU-TAIHI1-SEC
                 END-IF
      *
                 MOVE    "tbl_sryacct"   TO      MCP-TABLE
                 MOVE    "key45"         TO      MCP-PATHNAME
                 PERFORM  SRYACCT-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_sryacct"         TO      MCP-TABLE
           MOVE    "key45"               TO      MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           IF    WK-SHOKUJIRYOYO-OCC   NOT =  ZERO
             INITIALIZE                            NYUINACCT-REC
             MOVE    LNK-SYU-HOSPNUM       TO      NACCT-HOSPNUM
             MOVE    LNK-SYU-NYUGAIKBN     TO      NACCT-NYUGAIKBN
             MOVE    LNK-SYU-PTID          TO      NACCT-PTID
      ***    MOVE    "00"                  TO      NACCT-SRYKA
             MOVE    LNK-SYU-SRYYMD(1:6)   TO      NACCT-SRYYM
             MOVE    NYUINACCT-REC         TO      MCPDATA-REC
             MOVE    "DBSELECT"            TO      MCP-FUNC
             MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
             MOVE    "key7"                TO      MCP-PATHNAME
             CALL    "ORCDBMAIN"           USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
             IF      MCP-RC             =       ZERO
                 MOVE    "tbl_nyuinacct"   TO      MCP-TABLE
                 MOVE    "key7"            TO      MCP-PATHNAME
                 PERFORM  NYUINACCT-READ-SEC
                 PERFORM  UNTIL   FLG-NYUINACCT  =     1
      *
                   IF     NACCT-SRYCDTOTAL    =    099999913
                           PERFORM    23044-SHOKUJI-COUNT-SEC
                   END-IF
      *
                   MOVE    "tbl_nyuinacct" TO      MCP-TABLE
                   MOVE    "key7"          TO      MCP-PATHNAME
                   PERFORM  NYUINACCT-READ-SEC
                 END-PERFORM
             END-IF
             MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
             MOVE    "key7"                TO      MCP-PATHNAME
             PERFORM  DB-CLOSE-SEC
           END-IF
      *
           .
      *
       2304-SHOKUJI-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¥·¥¹´É¡¦Æþ±¡²ñ·×¤«¤é¿©»öÎÅÍÜÈñÅù¤Î·×»»¤ò¹Ô¤¦(200604)    *
      ******************************************************************
       2304-SHOKUJI-KEISAN200604-SEC         SECTION.
      *
           INITIALIZE    WK-SHOKUJI-TAIHI-AREA
                         WK-DAY-SKJFTN-AREA
      *
           PERFORM       23045-SYS-5000-CHK-SEC
      *
           INITIALIZE                            NYUINACCT-REC
           MOVE    LNK-SYU-HOSPNUM       TO      NACCT-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN     TO      NACCT-NYUGAIKBN
           MOVE    LNK-SYU-PTID          TO      NACCT-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)   TO      NACCT-SRYYM
           MOVE    NYUINACCT-REC         TO      MCPDATA-REC
           MOVE    "DBSELECT"            TO      MCP-FUNC
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key29"               TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING   MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC                =       ZERO
               MOVE    "tbl_nyuinacct"   TO      MCP-TABLE
               MOVE    "key29"           TO      MCP-PATHNAME
               PERFORM  NYUINACCT-READ-SEC
               PERFORM  UNTIL   FLG-NYUINACCT   =    1
      *
                 IF     NACCT-ZAISKBKBN     =    "4"
                         PERFORM    23041-SHOKUDOKASANTOU-TAIHI-SEC
                 END-IF
      *
                 IF     NACCT-ZAISKBKBN     =    "2"
                         PERFORM    23042-GAIHAKU-TAIHI-SEC
                 END-IF
      *
                 MOVE    "tbl_nyuinacct" TO      MCP-TABLE
                 MOVE    "key29"         TO      MCP-PATHNAME
                 PERFORM  NYUINACCT-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_nyuinacct"       TO      MCP-TABLE
           MOVE    "key29"               TO      MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           INITIALIZE                            SRYACCT-REC
           MOVE    LNK-SYU-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    LNK-SYU-PTID          TO      ACCT-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)   TO      ACCT-SRYYM
           MOVE    SRYACCT-REC           TO      MCPDATA-REC
           MOVE    "DBSELECT"            TO      MCP-FUNC
           MOVE    "tbl_sryacct"         TO      MCP-TABLE
           MOVE    "key54"               TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING   MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC                =       ZERO
               MOVE    "tbl_sryacct"     TO      MCP-TABLE
               MOVE    "key54"           TO      MCP-PATHNAME
               PERFORM  SRYACCT-READ-SEC
               PERFORM  UNTIL   FLG-SRYACCT     =    1
      *
                 IF     LNK-SYU-HKNCOMBINUM  =    ACCT-HKNCOMBI
                         PERFORM    23043-ROSAITOKU-TAIHI2-SEC
                 END-IF
      *
                 MOVE    "tbl_sryacct"   TO      MCP-TABLE
                 MOVE    "key54"         TO      MCP-PATHNAME
                 PERFORM  SRYACCT-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_sryacct"         TO      MCP-TABLE
           MOVE    "key54"               TO      MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           INITIALIZE                            SRYACCT-REC
           MOVE    LNK-SYU-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    LNK-SYU-PTID          TO      ACCT-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)   TO      ACCT-SRYYM
           MOVE    SRYACCT-REC           TO      MCPDATA-REC
           MOVE    "DBSELECT"            TO      MCP-FUNC
           MOVE    "tbl_sryacct"         TO      MCP-TABLE
           MOVE    "key55"               TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING   MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC                =       ZERO
               MOVE    "tbl_sryacct"     TO      MCP-TABLE
               MOVE    "key55"           TO      MCP-PATHNAME
               PERFORM  SRYACCT-READ-SEC
               PERFORM  UNTIL   FLG-SRYACCT     =    1
      *
                 IF     LNK-SYU-HKNCOMBINUM  =    ACCT-HKNCOMBI
                         PERFORM    23043-ROSAITOKU-TAIHI2-SEC
                 END-IF
      *
                 MOVE    "tbl_sryacct"   TO      MCP-TABLE
                 MOVE    "key55"         TO      MCP-PATHNAME
                 PERFORM  SRYACCT-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_sryacct"         TO      MCP-TABLE
           MOVE    "key55"               TO      MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           INITIALIZE                            SRYACCT-REC
           MOVE    LNK-SYU-HOSPNUM       TO      ACCT-HOSPNUM
           MOVE    LNK-SYU-NYUGAIKBN     TO      ACCT-NYUGAIKBN
           MOVE    LNK-SYU-PTID          TO      ACCT-PTID
           MOVE    LNK-SYU-SRYYMD(1:6)   TO      ACCT-STSRYYM
           MOVE    LNK-SYU-SRYYMD(1:6)   TO      ACCT-EDSRYYM
           MOVE    SRYACCT-REC           TO      MCPDATA-REC
           MOVE    "DBSELECT"            TO      MCP-FUNC
           MOVE    "tbl_sryacct"         TO      MCP-TABLE
           MOVE    "key49"               TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"           USING   MCPAREA
                                                 MCPDATA-REC
                                                 SPA-AREA
           IF      MCP-RC                =       ZERO
               MOVE    "tbl_sryacct"     TO      MCP-TABLE
               MOVE    "key49"           TO      MCP-PATHNAME
               PERFORM  SRYACCT-READ-SEC
               PERFORM  UNTIL   FLG-SRYACCT     =    1
      *
                 IF     LNK-SYU-HKNCOMBINUM  =    ACCT-HKNCOMBI
                         PERFORM    23043-ROSAITOKU-TAIHI3-SEC
                 END-IF
      *
                 MOVE    "tbl_sryacct"   TO      MCP-TABLE
                 MOVE    "key49"         TO      MCP-PATHNAME
                 PERFORM  SRYACCT-READ-SEC
               END-PERFORM
           END-IF
           MOVE    "tbl_sryacct"         TO      MCP-TABLE
           MOVE    "key49"               TO      MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           PERFORM  23046-SHOKUJI-FURIWAKE-SEC
      *
           IF    WK-SHOKUJIRYOYO-OCC   NOT =  ZERO
                  PERFORM     23047-SHOKUJI-COUNT200604-SEC
           END-IF
      *
           IF    WK-SHOKUJIRYOYOCD-ERR     =   1
                  PERFORM     23048-SHOKUJI-CHECK-SEC
           END-IF
      *
           PERFORM            23049-SKJ-SANTEIFLG-KURIA-SEC
      *
           .
      *
       2304-SHOKUJI-KEISAN200604-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¿©Æ²²Ã»»ÅùÂàÈò                                            *
      ******************************************************************
       23041-SHOKUDOKASANTOU-TAIHI-SEC         SECTION.
      *
           IF   LNK-SYU-SRYYMD(1:6)       >=   "200604"
              EVALUATE   NACCT-SRYCDTOTAL
                 WHEN      099999918
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                               UNTIL    IDY    >    31
                     IF       NACCT-DAY(IDY)   NOT =  ZERO
                       MOVE   NACCT-DAY(IDY)  TO   WK-SHOKUJI-ASA (IDY)
                     END-IF
                   END-PERFORM
                 WHEN      099999919
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                               UNTIL    IDY    >    31
                     IF       NACCT-DAY(IDY)   NOT =  ZERO
                       MOVE   NACCT-DAY(IDY)  TO   WK-SHOKUJI-HIRU(IDY)
                     END-IF
                   END-PERFORM
                 WHEN      099999920
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                               UNTIL    IDY    >    31
                     IF       NACCT-DAY(IDY)   NOT =  ZERO
                       MOVE   NACCT-DAY(IDY)  TO   WK-SHOKUJI-YORU(IDY)
                     END-IF
                   END-PERFORM
                 WHEN      197000570
                   PERFORM    VARYING   IDY   FROM   1   BY   1
                               UNTIL    IDY    >    31
                     IF       NACCT-DAY(IDY)   NOT =  ZERO
                       MOVE   NACCT-DAY(IDY)  TO   WK-SHOKUDOKASAN(IDY)
                     END-IF
                   END-PERFORM
              END-EVALUATE
           ELSE
              PERFORM    VARYING   IDY   FROM   1   BY   1
                          UNTIL    IDY    >    31
                   IF       NACCT-DAY(IDY)   NOT =  ZERO
                       MOVE   NACCT-DAY(IDY)  TO   WK-SHOKUDOKASAN(IDY)
                   END-IF
              END-PERFORM
           END-IF
      *
           .
      *
       23041-SHOKUDOKASANTOU-TAIHI-EXT.
           EXIT.
      *
      ******************************************************************
      *        ³°ÇñÂàÈò                                            *
      ******************************************************************
       23042-GAIHAKU-TAIHI-SEC         SECTION.
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
             IF       NACCT-DAY(IDY)   NOT =  ZERO 
                    MOVE   NACCT-DAY(IDY)  TO   WK-GAIHAKU(IDY)
             END-IF
           END-PERFORM
      *
           .
      *
       23042-GAIHAKU-TAIHI-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÆÃÊÌ¿©²Ã»»ÂàÈò£±                                            *
      ******************************************************************
       23043-ROSAITOKU-TAIHI1-SEC         SECTION.
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
      *
             IF      LNK-S02-SKJHKN-HKNCOMBI-DOU-XXX(IDY) = SPACE
                    MOVE     1     TO     IDX26
                    PERFORM    230431-ROSAITOKU-TAIHI11-SEC
             ELSE
               IF  ( LNK-S02-TEIKI-KBN        =   "X" )
               OR  ((LNK-S02-TEIKI-KBN        =   "Y") AND
                    (LNK-S02-DOJITU-DAY2(IDY) =   "1"))
                    MOVE     1     TO     IDX26
                    PERFORM    230431-ROSAITOKU-TAIHI11-SEC
               ELSE
                 IF     LNK-S02-DOJITU-DAY(IDY)  =   0
                    MOVE     1     TO     IDX26
                    PERFORM    230431-ROSAITOKU-TAIHI11-SEC
                 END-IF
                 IF     LNK-S02-DOJITU-DAY(IDY)  =   1 OR 7
                    MOVE     2     TO     IDX26
                    PERFORM    230431-ROSAITOKU-TAIHI11-SEC
                 END-IF
                 IF     LNK-S02-DOJITU-DAY(IDY)  =   8 OR 9
                    MOVE     3     TO     IDX26
                    PERFORM    230431-ROSAITOKU-TAIHI11-SEC
                 END-IF
               END-IF
             END-IF
      *
           END-PERFORM
      *
           .
      *
       23043-ROSAITOKU-TAIHI1-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÆÃÊÌ¿©²Ã»»ÂàÈò£±¤Î£±                                        *
      ******************************************************************
       230431-ROSAITOKU-TAIHI11-SEC         SECTION.
      *
           IF   ACCT-SRYKBN               =  "95"
           AND  ACCT-DAY(IDX26 IDY)   NOT =  ZERO
                  COMPUTE  WK-ROSAITOKU95(IDY) =
                           WK-ROSAITOKU95(IDY) +
                           (ACCT-SURYOUTOTAL * ACCT-DAY(IDX26 IDY))
           END-IF
           IF   ACCT-SRYKBN               =  "96"
           AND  ACCT-DAY(IDX26 IDY)   NOT =  ZERO
                  COMPUTE  WK-ROSAITOKU96(IDY) =
                           WK-ROSAITOKU96(IDY) +
                           (ACCT-SURYOUTOTAL * ACCT-DAY(IDX26 IDY))
           END-IF
      *
           .
      *
       230431-ROSAITOKU-TAIHI11-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÆÃÊÌ¿©²Ã»»ÂàÈò£²                                            *
      ******************************************************************
       23043-ROSAITOKU-TAIHI2-SEC         SECTION.
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
      *
             IF      LNK-S02-SKJHKN-HKNCOMBI-DOU-XXX(IDY) = SPACE
                    MOVE     1     TO     IDX26
                    PERFORM    230431-ROSAITOKU-TAIHI21-SEC
             ELSE
               IF  ( LNK-S02-TEIKI-KBN        =   "X" )
               OR  ((LNK-S02-TEIKI-KBN        =   "Y") AND
                    (LNK-S02-DOJITU-DAY2(IDY) =   "1"))
                    MOVE     1     TO     IDX26
                    PERFORM    230431-ROSAITOKU-TAIHI21-SEC
               ELSE
                 IF     LNK-S02-DOJITU-DAY(IDY)  =   0
                    MOVE     1     TO     IDX26
                    PERFORM    230431-ROSAITOKU-TAIHI21-SEC
                 END-IF
                 IF     LNK-S02-DOJITU-DAY(IDY)  =   1 OR 7
                    MOVE     2     TO     IDX26
                    PERFORM    230431-ROSAITOKU-TAIHI21-SEC
                 END-IF
                 IF     LNK-S02-DOJITU-DAY(IDY)  =   8 OR 9
                    MOVE     3     TO     IDX26
                    PERFORM    230431-ROSAITOKU-TAIHI21-SEC
                 END-IF
               END-IF
             END-IF
      *
           END-PERFORM
      *
           .
      *
       23043-ROSAITOKU-TAIHI2-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÆÃÊÌ¿©²Ã»»ÂàÈò£²¤Î£±                                        *
      ******************************************************************
       230431-ROSAITOKU-TAIHI21-SEC         SECTION.
      *
           IF   ACCT-SRYKBN               =  "97"
           AND  ACCT-DAY(IDX26 IDY)   NOT =  ZERO
              COMPUTE  WK-ROSAITOKU97(IDY) =
                       WK-ROSAITOKU97(IDY) +
                       (ACCT-SURYOUTOTAL * ACCT-DAY(IDX26 IDY))
              IF   WK-SHOKUJIRYOYO(IDY) =  2
                 MOVE   29    TO   LNK-S02-RC
              END-IF
           END-IF
      *
           .
      *
       230431-ROSAITOKU-TAIHI21-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÆÃÊÌ¿©²Ã»»ÂàÈò£³                                            *
      ******************************************************************
       23043-ROSAITOKU-TAIHI3-SEC         SECTION.
      *
           PERFORM   VARYING   IDY2   FROM    1    BY    1
                      UNTIL    IDY2    >   TBL-TOKUSYOKU-MAX
      *
             INITIALIZE                        SRYACT-REC
             MOVE    ACCT-HOSPNUM         TO   SRY-HOSPNUM
             MOVE    ACCT-NYUGAIKBN       TO   SRY-NYUGAIKBN
             MOVE    ACCT-PTID            TO   SRY-PTID
             MOVE    ACCT-SRYYM           TO   SRY-SRYYM
             MOVE    ACCT-ZAINUM          TO   SRY-ZAINUM
             MOVE    TBL-TOKUSYOKU(IDY2)  TO   SRY-SRYCD (1)
             MOVE    TBL-TOKUSYOKU(IDY2)  TO   SRY-SRYCD (2)
             MOVE    TBL-TOKUSYOKU(IDY2)  TO   SRY-SRYCD (3)
             MOVE    TBL-TOKUSYOKU(IDY2)  TO   SRY-SRYCD (4)
             MOVE    TBL-TOKUSYOKU(IDY2)  TO   SRY-SRYCD (5)
             MOVE    SRYACT-REC           TO   MCPDATA-REC
             MOVE    "DBSELECT"           TO   MCP-FUNC
             MOVE    "tbl_sryact"         TO   MCP-TABLE
             MOVE    "key8"               TO   MCP-PATHNAME
             CALL    "ORCDBMAIN"          USING   MCPAREA
                                                  MCPDATA-REC
                                                  SPA-AREA
             IF      MCP-RC       =    ZERO
               MOVE     "tbl_sryact"      TO   MCP-TABLE
               MOVE     "key8"            TO   MCP-PATHNAME
               PERFORM   SRYACT-READ-SEC
               PERFORM  UNTIL   FLG-SRYACT     =    1
                 PERFORM    VARYING   IDY   FROM   1   BY   1
                             UNTIL    IDY    >    31
      *
                   IF      LNK-S02-SKJHKN-HKNCOMBI-DOU-XXX(IDY) = SPACE
                          MOVE     1     TO     IDX26
                          PERFORM    230431-ROSAITOKU-TAIHI31-SEC
                   ELSE
                     IF  ( LNK-S02-TEIKI-KBN        =   "X" )
                     OR  ((LNK-S02-TEIKI-KBN        =   "Y") AND
                          (LNK-S02-DOJITU-DAY2(IDY) =   "1"))
                          MOVE     1     TO     IDX26
                          PERFORM    230431-ROSAITOKU-TAIHI31-SEC
                     ELSE
                       IF     LNK-S02-DOJITU-DAY(IDY)  =   0
                          MOVE     1     TO     IDX26
                          PERFORM    230431-ROSAITOKU-TAIHI31-SEC
                       END-IF
                       IF     LNK-S02-DOJITU-DAY(IDY)  =   1 OR 7
                          MOVE     2     TO     IDX26
                          PERFORM    230431-ROSAITOKU-TAIHI31-SEC
                       END-IF
                       IF     LNK-S02-DOJITU-DAY(IDY)  =   8 OR 9
                          MOVE     3     TO     IDX26
                          PERFORM    230431-ROSAITOKU-TAIHI31-SEC
                       END-IF
                     END-IF
                   END-IF
      *
                 END-PERFORM
                 MOVE     "tbl_sryact"    TO   MCP-TABLE
                 MOVE     "key8"          TO   MCP-PATHNAME
                 PERFORM   SRYACT-READ-SEC
               END-PERFORM
             END-IF
             MOVE    "tbl_sryact"         TO   MCP-TABLE
             MOVE    "key8"               TO   MCP-PATHNAME
             PERFORM  DB-CLOSE-SEC
      *
           END-PERFORM
      *
           .
      *
       23043-ROSAITOKU-TAIHI3-EXT.
           EXIT.
      *
      ******************************************************************
      *    ÆÃÊÌ¿©²Ã»»ÂàÈò£³¤Î£±                                        *
      ******************************************************************
       230431-ROSAITOKU-TAIHI31-SEC         SECTION.
      *
           IF   ACCT-SRYKBN               =  "95"
           AND  ACCT-DAY(IDX26 IDY)   NOT =  ZERO
             IF  SRY-SRYCD (1)  =  TBL-TOKUSYOKU(IDY2)
               COMPUTE  WK-ROSAITOKU95(IDY) =
                        WK-ROSAITOKU95(IDY) +
                        (SRY-SRYSURYO(1) * ACCT-DAY(IDX26 IDY))
             END-IF
             IF  SRY-SRYCD (2)  =  TBL-TOKUSYOKU(IDY2)
               COMPUTE  WK-ROSAITOKU95(IDY) =
                        WK-ROSAITOKU95(IDY) +
                        (SRY-SRYSURYO(2) * ACCT-DAY(IDX26 IDY))
             END-IF
             IF  SRY-SRYCD (3)  =  TBL-TOKUSYOKU(IDY2)
               COMPUTE  WK-ROSAITOKU95(IDY) =
                        WK-ROSAITOKU95(IDY) +
                        (SRY-SRYSURYO(3) * ACCT-DAY(IDX26 IDY))
             END-IF
             IF  SRY-SRYCD (4)  =  TBL-TOKUSYOKU(IDY2)
               COMPUTE  WK-ROSAITOKU95(IDY) =
                        WK-ROSAITOKU95(IDY) +
                        (SRY-SRYSURYO(4) * ACCT-DAY(IDX26 IDY))
             END-IF
             IF  SRY-SRYCD (5)  =  TBL-TOKUSYOKU(IDY2)
               COMPUTE  WK-ROSAITOKU95(IDY) =
                        WK-ROSAITOKU95(IDY) +
                        (SRY-SRYSURYO(5) * ACCT-DAY(IDX26 IDY))
             END-IF
           END-IF
           IF   ACCT-SRYKBN               =  "96"
           AND  ACCT-DAY(IDX26 IDY)   NOT =  ZERO
             IF  SRY-SRYCD (1)  =  TBL-TOKUSYOKU(IDY2)
               COMPUTE  WK-ROSAITOKU96(IDY) =
                        WK-ROSAITOKU96(IDY) +
                        (SRY-SRYSURYO(1) * ACCT-DAY(IDX26 IDY))
             END-IF
             IF  SRY-SRYCD (2)  =  TBL-TOKUSYOKU(IDY2)
               COMPUTE  WK-ROSAITOKU96(IDY) =
                        WK-ROSAITOKU96(IDY) +
                        (SRY-SRYSURYO(2) * ACCT-DAY(IDX26 IDY))
             END-IF
             IF  SRY-SRYCD (3)  =  TBL-TOKUSYOKU(IDY2)
               COMPUTE  WK-ROSAITOKU96(IDY) =
                        WK-ROSAITOKU96(IDY) +
                        (SRY-SRYSURYO(3) * ACCT-DAY(IDX26 IDY))
             END-IF
             IF  SRY-SRYCD (4)  =  TBL-TOKUSYOKU(IDY2)
               COMPUTE  WK-ROSAITOKU96(IDY) =
                        WK-ROSAITOKU96(IDY) +
                        (SRY-SRYSURYO(4) * ACCT-DAY(IDX26 IDY))
             END-IF
             IF  SRY-SRYCD (5)  =  TBL-TOKUSYOKU(IDY2)
               COMPUTE  WK-ROSAITOKU96(IDY) =
                        WK-ROSAITOKU96(IDY) +
                        (SRY-SRYSURYO(5) * ACCT-DAY(IDX26 IDY))
             END-IF
           END-IF
      *
           .
      *
       230431-ROSAITOKU-TAIHI31-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¿©»öÎÅÍÜÈñÅù¤Î·×»»                                       *
      ******************************************************************
       23044-SHOKUJI-COUNT-SEC         SECTION.
      *
           MOVE       LNK-SYU-SKYSTYMD(7:2)  TO   IDX-ST.
           MOVE       LNK-SYU-SKYEDYMD(7:2)  TO   IDX-ED.
      *
           PERFORM    VARYING   IDY   FROM   IDX-ST   BY   1
                                    UNTIL    IDY     >    IDX-ED
      *
             MOVE     ZERO     TO      WK-SHOKUJI-JIHI
      *
             IF       ( NACCT-DAY(IDY)   NOT =  ZERO        )
             AND      ( LNK-SYU-DAY(IDY)     =  "1" OR "9"  )
             AND      ( LNK-S02-NYUSANTEI-KBN(IDY)
                                             =  "1"         )
             AND      ((WK-GAIHAKU(IDY)      =  ZERO       ) OR
                       (WK-GAIHAKU(IDY)     >=   4         ))
      *
              IF  WK-SHOKUDOKASAN(IDY)  =  ZERO
      *
                EVALUATE   NACCT-DAY(IDY)
                  WHEN  1
                      EVALUATE   WK-SHOKUJIRYOYO(IDY)
                        WHEN  1
                         IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI2-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   ÆÃÊÌ´ÉÍý²Ã»»
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
                         ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI1-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI1
                          END-IF
                         END-IF
                        WHEN  2
      *
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI5-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£²¡Ë
                          MOVE  "197000710"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI5
                          END-IF
                      END-EVALUATE
                  WHEN  2
                      IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI2-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   ÆÃÊÌ´ÉÍý²Ã»»
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   ÆÃÊÌ¿©²Ã»»
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
                      ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI1-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI1
                          END-IF
      *                   ÆÃÊÌ¿©²Ã»»
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
                      END-IF
                  WHEN  3
                      IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI2-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   ÆÃÊÌ´ÉÍý²Ã»»
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   Ê£¿ô¸¥Î©²Ã»»
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI1-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI1
                          END-IF
      *                   Ê£¿ô¸¥Î©²Ã»»
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      END-IF
                  WHEN  4
                      IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI2-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   ÆÃÊÌ´ÉÍý²Ã»»
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI2
                          END-IF
      *                   ÆÃÊÌ¿©²Ã»»
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
      *                   Ê£¿ô¸¥Î©²Ã»»
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI1-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI1
                          END-IF
      *                   ÆÃÊÌ¿©²Ã»»
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
      *                   Ê£¿ô¸¥Î©²Ã»»
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      END-IF
                END-EVALUATE
      *
              ELSE
      *
                EVALUATE   NACCT-DAY(IDY)
                  WHEN  1
                      EVALUATE   WK-SHOKUJIRYOYO(IDY)
                        WHEN  1
                         IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI4-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   ÆÃÊÌ´ÉÍý²Ã»»
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   ¿©Æ²²Ã»»
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
                         ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI3-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   ¿©Æ²²Ã»»
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
                         END-IF
                        WHEN  2
      *
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI5-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£²¡Ë
                          MOVE  "197000710"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI5
                          END-IF
                      END-EVALUATE
                  WHEN  2
                      IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI4-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   ÆÃÊÌ´ÉÍý²Ã»»
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   ¿©Æ²²Ã»»
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   ÆÃÊÌ¿©²Ã»»
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
                      ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI3-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   ¿©Æ²²Ã»»
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   ÆÃÊÌ¿©²Ã»»
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
                      END-IF
                  WHEN  3
                      IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI4-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   ÆÃÊÌ´ÉÍý²Ã»»
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   ¿©Æ²²Ã»»
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   Ê£¿ô¸¥Î©²Ã»»
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI3-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   ¿©Æ²²Ã»»
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   Ê£¿ô¸¥Î©²Ã»»
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      END-IF
                  WHEN  4
                      IF    WK-TOKUKANRIKASAN(IDY)  =  1
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI4-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   ÆÃÊÌ´ÉÍý²Ã»»
                          MOVE  "197000270"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   ¿©Æ²²Ã»»
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI4
                          END-IF
      *                   ÆÃÊÌ¿©²Ã»»
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
      *                   Ê£¿ô¸¥Î©²Ã»»
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      ELSE
                          ADD       1    TO   WK-SHOKUJI-NISSU
                                              LNK-SYU-SHOKUJI3-NISSU
                                              LNK-SYU-SHOKUJI6-NISSU
                                              LNK-SYU-SHOKUJI7-NISSU
      *                   Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
                          MOVE  "197000110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   ¿©Æ²²Ã»»
                          MOVE  "197000570"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             ADD     WK-KEISAN TO   LNK-SYU-SHOKUJI3
                          END-IF
      *                   ÆÃÊÌ¿©²Ã»»
                          MOVE  "197000470"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI6
                          END-IF
      *                   Ê£¿ô¸¥Î©²Ã»»
                          MOVE  "197000670"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     WK-KEISAN TO   WK-SHOKUJI-RYOYOHI
                                                    WK-SHOKUJI-JIHI
                             MOVE    WK-KEISAN TO   LNK-SYU-SHOKUJI7
                          END-IF
                      END-IF
                END-EVALUATE
      *
              END-IF
      *
              IF   ( COMB-SYU-HKNKOHSBTKBN   =   "8"  OR  "9"   )
              OR   ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                                OR  "068"  OR  "069"  OR  "040" )
                ADD   WK-SHOKUJI-JIHI    TO   WK-SHOKUJI-FTN
              ELSE
                EVALUATE   WK-SYOTOKU-SKJKBN(1)
                  WHEN  SPACE
      *                   É¸½àÉéÃ´³Û¡Ê°ìÈÌ¡Ë
                          MOVE  "197000810"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     TNS-TEN   TO   WK-SHOKUJI-FTN
                             MOVE    TNS-TEN   TO   WK-DAY-SKJFTN(IDY)
                          END-IF
                  WHEN  "1"
                  WHEN  "4"
      *                   É¸½àÉéÃ´³Û¡ÊÄã£±¡Ë
                          MOVE  "197001110"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     TNS-TEN   TO   WK-SHOKUJI-FTN
                             MOVE    TNS-TEN   TO   WK-DAY-SKJFTN(IDY)
                          END-IF
                  WHEN  "2"
      *                   É¸½àÉéÃ´³Û¡ÊÄã£²¡¦£¹£°Æü°Ê²¼¡Ë
                          MOVE  "197000910"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     TNS-TEN   TO   WK-SHOKUJI-FTN
                             MOVE    TNS-TEN   TO   WK-DAY-SKJFTN(IDY)
                          END-IF
                  WHEN  "3"
      *                   É¸½àÉéÃ´³Û¡ÊÄã£²¡¦£¹£°ÆüÄ¶¡Ë
                          MOVE  "197001010"    TO   WK-SRYCD
                          PERFORM    TENSU-TBL-SEC
                          IF       FLG-TENSU      =    ZERO
                             ADD     TNS-TEN   TO   WK-SHOKUJI-FTN
                             MOVE    TNS-TEN   TO   WK-DAY-SKJFTN(IDY)
                          END-IF
                END-EVALUATE
              END-IF
      *
             END-IF
      *
             IF         WK-ROSAITOKU95(IDY)  NOT =  ZERO
      *
      *         É¸½àÉéÃ´³Û¡ÊÏ«ºÒÆþ±¡Ãæ¡Ë
                MOVE  "197001210"    TO   WK-SRYCD
                PERFORM    TENSU-TBL-SEC
                IF       FLG-TENSU      =    ZERO
                   ADD     TNS-TEN   TO   WK-SHOKUJI-RYOYOHI95
                                          WK-SHOKUJI-FTN95
                END-IF
      *
             END-IF
      *
             IF         WK-ROSAITOKU96(IDY)  NOT =  ZERO
      *
      *         É¸½àÉéÃ´³Û¡ÊÏ«ºÒÆþ±¡Ãæ¡Ë
                MOVE  "197001210"    TO   WK-SRYCD
                PERFORM    TENSU-TBL-SEC
                IF       FLG-TENSU      =    ZERO
                   ADD     TNS-TEN   TO   WK-SHOKUJI-RYOYOHI96
                                          WK-SHOKUJI-FTN96
                END-IF
      *
             END-IF
      *
           END-PERFORM.
      *
       23044-SHOKUJI-COUNT-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¡Ê£µ£°£°£°¡Ë¤Î¿©»ö¾ðÊó¼èÆÀ
      ******************************************************************
       23045-SYS-5000-CHK-SEC                 SECTION.
      *
           MOVE    SPACE                TO    WK-BRMSGK-TAXKBN
      *
           MOVE    ZERO                 TO    WK-SHOKUJIRYOYOCD-ERR
      *
           INITIALIZE                         SYS-5000-REC
           MOVE    "5000"               TO    SYS-5000-KANRICD
           MOVE    "*"                  TO    SYS-5000-KBNCD
           MOVE    LNK-SYU-HOSPNUM      TO    SYS-5000-HOSPNUM
           MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYS-5000-STYUKYMD(1:6)
           MOVE    "01"                 TO    SYS-5000-STYUKYMD(7:2)
           MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYS-5000-EDYUKYMD(1:6)
           MOVE    "01"                 TO    SYS-5000-EDYUKYMD(7:2)
           MOVE    SYS-5000-REC         TO    MCPDATA-REC
           MOVE    "DBSELECT"           TO    MCP-FUNC
           MOVE    "tbl_syskanri"       TO    MCP-TABLE
           MOVE    "key10"              TO    MCP-PATHNAME
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA
           IF      MCP-RC               =     ZERO
                   MOVE    "tbl_syskanri"   TO   MCP-TABLE
                   MOVE    "key10"          TO   MCP-PATHNAME
                   PERFORM  SYSKANRI-READ-SEC
                   IF    MCP-RC             =     ZERO
      *
                     PERFORM   VARYING   IDX3   FROM  1  BY  1
                                UNTIL    IDX3    >   31
                      EVALUATE    SYS-5000-SHOKUJIRYOYOCD
      *                Æþ±¡¿©»öÎÅÍÜ¡Ê£±¡Ë
                       WHEN         "197000110"
                          MOVE     1      TO   WK-SHOKUJIRYOYO(IDX3)
                          EVALUATE  SYS-5000-SHOKUKBN(1)
                            WHEN     "1"
                              MOVE  ZERO  TO   WK-TOKUKANRIKASAN(IDX3)
                            WHEN     "2"
                              MOVE    1   TO   WK-TOKUKANRIKASAN(IDX3)
                          END-EVALUATE
      *                Æþ±¡¿©»öÎÅÍÜ¡Ê£²¡Ë
                       WHEN         "197000710"
                          MOVE     2      TO   WK-SHOKUJIRYOYO(IDX3)
                      END-EVALUATE
                     END-PERFORM
      *
                     MOVE   SYS-5000-BRMSGK-TAXKBN
                                          TO   WK-BRMSGK-TAXKBN
      *
      *              ¥·¥¹¥Æ¥à´ÉÍý£µ£°£°£°¡Ý¡ÖÆþ±¡»þ¿©»öÎÅÍÜ¡×¤¬Ì¤ÀßÄê»þ¤Ï¥¨¥é¡¼
                     IF     SYS-5000-SHOKUJIRYOYOCD = SPACE
                          MOVE     1      TO   WK-SHOKUJIRYOYOCD-ERR
                     END-IF
      *
                   END-IF
           END-IF
      *
           MOVE      "tbl_syskanri"       TO   MCP-TABLE
           MOVE      "key10"              TO   MCP-PATHNAME
           PERFORM    DB-CLOSE-SEC
      *
           INITIALIZE                         SYS-5000-REC
           MOVE    "5000"               TO    SYS-5000-KANRICD
           MOVE    "*"                  TO    SYS-5000-KBNCD
           MOVE    LNK-SYU-HOSPNUM      TO    SYS-5000-HOSPNUM
           MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYS-5000-STYUKYMD(1:6)
           MOVE    "__"                 TO    SYS-5000-STYUKYMD(7:2)
           MOVE    LNK-SYU-SRYYMD(1:6)  TO    SYS-5000-EDYUKYMD(1:6)
           MOVE    "__"                 TO    SYS-5000-EDYUKYMD(7:2)
           MOVE    SYS-5000-REC         TO    MCPDATA-REC
           MOVE    "DBSELECT"           TO    MCP-FUNC
           MOVE    "tbl_syskanri"       TO    MCP-TABLE
           MOVE    "key11"              TO    MCP-PATHNAME
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA
           IF      MCP-RC               =     ZERO
               MOVE     "tbl_syskanri"  TO    MCP-TABLE
               MOVE     "key11"         TO    MCP-PATHNAME
               PERFORM   SYSKANRI-READ-SEC
               PERFORM  UNTIL    FLG-SYSKANRI   =   1
                   MOVE   SYS-5000-STYUKYMD(7:2)  TO  KIRIKAE-IDX
                   PERFORM    VARYING  IDX3  FROM KIRIKAE-IDX BY 1
                              UNTIL    IDX3  >   31
                      EVALUATE    SYS-5000-SHOKUJIRYOYOCD
      *                Æþ±¡¿©»öÎÅÍÜ¡Ê£±¡Ë
                       WHEN         "197000110"
                          MOVE     1      TO   WK-SHOKUJIRYOYO(IDX3)
                          EVALUATE  SYS-5000-SHOKUKBN(1)
                            WHEN     "1"
                              MOVE  ZERO  TO   WK-TOKUKANRIKASAN(IDX3)
                            WHEN     "2"
                              MOVE    1   TO   WK-TOKUKANRIKASAN(IDX3)
                          END-EVALUATE
      *                Æþ±¡¿©»öÎÅÍÜ¡Ê£²¡Ë
                       WHEN         "197000710"
                          MOVE     2      TO   WK-SHOKUJIRYOYO(IDX3)
                          MOVE    ZERO    TO   WK-TOKUKANRIKASAN(IDX3)
                      END-EVALUATE
                   END-PERFORM
      *
      *            ¥·¥¹¥Æ¥à´ÉÍý£µ£°£°£°¡Ý¡ÖÆþ±¡»þ¿©»öÎÅÍÜ¡×¤¬Ì¤ÀßÄê»þ¤Ï¥¨¥é¡¼
                   IF     SYS-5000-SHOKUJIRYOYOCD = SPACE
                          MOVE     1      TO   WK-SHOKUJIRYOYOCD-ERR
                   END-IF
      *
                   MOVE    "tbl_syskanri" TO   MCP-TABLE
                   MOVE    "key11"        TO   MCP-PATHNAME
                   PERFORM  SYSKANRI-READ-SEC
               END-PERFORM
           END-IF
      *
           MOVE     "tbl_syskanri"        TO   MCP-TABLE
           MOVE     "key11"               TO   MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
      *    ¡ÖÆþ±¡»þ¿©»öÎÅÍÜ¡×Ì¤ÀßÄêÆü¤¬¤¢¤ì¤Ð¥¨¥é¡¼
           PERFORM   VARYING   IDX3   FROM   1   BY   1
                      UNTIL    IDX3     >   31
               IF    WK-SHOKUJIRYOYO(IDX3)  =  ZERO
                  MOVE     1      TO   WK-SHOKUJIRYOYOCD-ERR
               END-IF
           END-PERFORM
      *
           .
      *
       23045-SYS-5000-CHK-EXT.
           EXIT.
      *
      ******************************************************************
      *    Æþ±¡»þ¿©»öÎÅÍÜ¤ÈÆÃÊÌ¿©²Ã»»¤ò¤ï¤±¤ë
      ******************************************************************
       23046-SHOKUJI-FURIWAKE-SEC                 SECTION.
      *
      *    Æþ±¡»þÀ¸³èÎÅÍÜÈñÉéÃ´³Û¼èÆÀ
      *    ¿©»öÉéÃ´¿ø¤¨ÃÖ¤­ÂÐ¾Ý¼èÆÀ
           IF    LNK-SYU-SRYYMD(1:6)  >=  "201604"
             INITIALIZE                      ORCSNYULIFE2-AREA
             MOVE    LNK-SYU-HOSPNUM     TO  LNK-NYULIFE2-HOSPNUM
             MOVE    LNK-SYU-PTID        TO  LNK-NYULIFE2-PTID
             MOVE    LNK-SYU-SRYYMD(1:6) TO  LNK-NYULIFE2-SANTEIYM
             CALL    "ORCSNYULIFE2"      USING
                                         ORCSNYULIFE2-AREA
                                         SPA-AREA
             IF      LNK-NYULIFE2-RC =   ZERO
               PERFORM  VARYING  NYULIFE-IDX  FROM  1  BY  1
                         UNTIL   NYULIFE-IDX   >   31
                 MOVE  LNK-NYULIFE2-KBN(NYULIFE-IDX)
                             TO  WK-NYULIFE-KBN(NYULIFE-IDX)
                 PERFORM  VARYING  IDX23  FROM  1  BY  1
                           UNTIL   IDX23   >    3
                   MOVE  LNK-NYULIFE2-SKJ-MONEY(NYULIFE-IDX IDX23)
                       TO  WK-NYULIFE2-SKJ-MONEY(NYULIFE-IDX IDX23)
                   MOVE  LNK-NYULIFE2-SKJFTN-MONEY(NYULIFE-IDX IDX23)
                       TO  WK-NYULIFE2-SKJFTN-MONEY(NYULIFE-IDX IDX23)
                   EVALUATE  LNK-SYU-SYUHKNNUM
                     WHEN       "971"
                       IF   FLG-KENPOJYUNKYO  =  ZERO
                         COMPUTE   WK-KEISAN  =
                            WK-NYULIFE2-SKJ-MONEY(NYULIFE-IDX IDX23)
                                              *   1.2
                         COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                         COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                         COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                         MOVE      WK-KEISAN  TO
                            WK-NYULIFE2-SKJ-MONEY(NYULIFE-IDX IDX23)
                       END-IF
                     WHEN       "973"
                       IF   FLG-KENPOJYUNKYO  =  ZERO
                         COMPUTE   WK-KEISAN  =
                            WK-NYULIFE2-SKJ-MONEY(NYULIFE-IDX IDX23)
                                              *   1.2
                         COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                         COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                         COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                         IF   WK-4001-SKJKBN  =   "2"
                           COMPUTE WK-KEISAN  =   WK-KEISAN  *  1.2
                         END-IF
                         MOVE      WK-KEISAN  TO
                            WK-NYULIFE2-SKJ-MONEY(NYULIFE-IDX IDX23)
                       END-IF
                   END-EVALUATE
                 END-PERFORM
                 MOVE  LNK-NYULIFE2-KAN-MONEY(NYULIFE-IDX)
                             TO  WK-NYULIFE-KAN-MONEY(NYULIFE-IDX)
                 MOVE  LNK-NYULIFE2-KANFTN-MONEY(NYULIFE-IDX)
                             TO  WK-NYULIFE-KANFTN-MONEY(NYULIFE-IDX)
                 EVALUATE  LNK-SYU-SYUHKNNUM
                   WHEN       "971"
                     IF   FLG-KENPOJYUNKYO  =  ZERO
                       COMPUTE   WK-KEISAN  =
                          WK-NYULIFE-KAN-MONEY(NYULIFE-IDX)
                                            *   1.2
                       COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                       COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                       COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                       MOVE      WK-KEISAN  TO
                          WK-NYULIFE-KAN-MONEY(NYULIFE-IDX)
                     END-IF
                   WHEN       "973"
                     IF   FLG-KENPOJYUNKYO  =  ZERO
                       COMPUTE   WK-KEISAN  =
                          WK-NYULIFE-KAN-MONEY(NYULIFE-IDX)
                                            *   1.2
                       COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                       COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                       COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                       IF   WK-4001-SKJKBN  =   "2"
                         COMPUTE WK-KEISAN  =   WK-KEISAN  *  1.2
                       END-IF
                       MOVE      WK-KEISAN  TO
                          WK-NYULIFE-KAN-MONEY(NYULIFE-IDX)
                     END-IF
                 END-EVALUATE
                 IF   (LNK-SYU-SYUHKNNUM   =  "971" OR "973")
                 AND  (FLG-KENPOJYUNKYO    =  ZERO          )
                   MOVE  SPACE  TO  WK-NYULIFE-KBN(NYULIFE-IDX)
                 END-IF
               END-PERFORM
             END-IF
      *
             IF  (LNK-SYU-SYUHKNNUM = "971" OR "973" OR "975"
                                   OR "068" OR "069" OR "040"  )
             OR  (LNK-SYU-SYUHKNNUM(1:2) = "98" OR "90" OR "91")
               CONTINUE
             ELSE
               INITIALIZE                      ORCSSKJKEEP-AREA
               MOVE    LNK-SYU-HOSPNUM     TO  LNK-SKJKEEP-HOSPNUM
               MOVE    LNK-SYU-PTID        TO  LNK-SKJKEEP-PTID
               MOVE    LNK-SYU-SRYYMD(1:6) TO  LNK-SKJKEEP-SANTEIYM
               CALL    "ORCSSKJKEEP"       USING
                                           ORCSSKJKEEP-AREA
                                           SPA-AREA
               IF      LNK-SKJKEEP-RC  =   ZERO
                 PERFORM  VARYING  NYULIFE-IDX  FROM  1  BY  1
                           UNTIL   NYULIFE-IDX   >   31
                   MOVE  LNK-SKJKEEP-KBN(NYULIFE-IDX)
                                  TO  WK-SKJKEEP-KBN(NYULIFE-IDX)
                 END-PERFORM
               ELSE
                 IF    LNK-SKJKEEP-RC  =   5
                   MOVE     42    TO  LNK-S02-RC
                 END-IF
               END-IF
             END-IF
           ELSE
             IF    LNK-SYU-SRYYMD(1:6)  >=  "200610"
               INITIALIZE                      ORCSNYULIFE-AREA
               MOVE    LNK-SYU-HOSPNUM     TO  LNK-NYULIFE-HOSPNUM
               MOVE    LNK-SYU-PTID        TO  LNK-NYULIFE-PTID
               MOVE    LNK-SYU-SRYYMD(1:6) TO  LNK-NYULIFE-SANTEIYM
               CALL    "ORCSNYULIFE"       USING
                                           ORCSNYULIFE-AREA
                                           SPA-AREA
               IF      LNK-NYULIFE-RC  =   ZERO
                 PERFORM  VARYING  NYULIFE-IDX  FROM  1  BY  1
                           UNTIL   NYULIFE-IDX   >   31
                   MOVE  LNK-NYULIFE-KBN(NYULIFE-IDX)
                               TO  WK-NYULIFE-KBN(NYULIFE-IDX)
                   MOVE  LNK-NYULIFE-SKJ-MONEY(NYULIFE-IDX)
                               TO  WK-NYULIFE-SKJ-MONEY(NYULIFE-IDX)
                   MOVE  LNK-NYULIFE-KAN-MONEY(NYULIFE-IDX)
                               TO  WK-NYULIFE-KAN-MONEY(NYULIFE-IDX)
                   MOVE  LNK-NYULIFE-SKJFTN-MONEY(NYULIFE-IDX)
                               TO  WK-NYULIFE-SKJFTN-MONEY(NYULIFE-IDX)
                   MOVE  LNK-NYULIFE-KANFTN-MONEY(NYULIFE-IDX)
                               TO  WK-NYULIFE-KANFTN-MONEY(NYULIFE-IDX)
                   IF   (LNK-SYU-SYUHKNNUM   =  "971" OR "973")
                   AND  (FLG-KENPOJYUNKYO    =  ZERO          )
                     MOVE  SPACE  TO  WK-NYULIFE-KBN(NYULIFE-IDX)
                   END-IF
                 END-PERFORM
               END-IF
             END-IF
           END-IF
      *
      *****
      *
           INITIALIZE      WK-SKJHKN-TBL
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
      *
              PERFORM   230466-SKJ-SANTEIFLG-SET-SEC
      *
              IF   LNK-S02-SKJHKN-HKNCOMBI(IDY)     = SPACE
              AND  LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY) = SPACE
                IF  LNK-S02-DOJITU-DAY(IDY)  =  9
                      PERFORM   230461-SHOKUJI-FURIWAKE-SEC
                END-IF
                IF  LNK-S02-DOJITU-DAY(IDY)  =  1
                      PERFORM   230462-SHOKUJI-FURIWAKE2-SEC
                END-IF
                IF  LNK-S02-DOJITU-DAY(IDY)  =  7 OR 8
                      PERFORM   230463-SHOKUJI-FURIWAKE3-SEC
                END-IF
              ELSE
                IF  LNK-S02-SKJHKN-HKNCOMBI-DOU-XXX(IDY) = SPACE
                   IF   LNK-S02-SKJHKN-HKNCOMBI(IDY) NOT = SPACE
                     IF   LNK-S02-SKJHKN-HKNCOMBI(IDY)   =
                                                LNK-SYU-HKNCOMBINUM
                       MOVE   "1"   TO   WK-SKJHKN-SANTEIFLG(IDY)
                     ELSE
                       PERFORM  230463-SHOKUJI-FURIWAKE3-SEC
                     END-IF
                   END-IF
                ELSE
                   IF  ( LNK-S02-TEIKI-KBN        =   "X" )
                   OR  ((LNK-S02-TEIKI-KBN        =   "Y") AND
                        (LNK-S02-DOJITU-DAY2(IDY) =   "1"))
                      PERFORM   230464-SHOKUJI-FURIWAKE4-SEC
                   ELSE
                      PERFORM   230465-SHOKUJI-FURIWAKE5-SEC
                   END-IF
                END-IF
      *         Æþ±¡»þÀ¸³èÎÅÍÜ¡Ê´Ä¶­¡Ë¤ÏÆþ±¡²ñ·×¤ÎÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¤Ç»»Äê
                IF  (LNK-S02-SKJHKN-HKNCOMBI-XXX(IDY) NOT = SPACE)
                AND (LNK-S02-SKJHKN-HKNCOMBI-XXX(IDY)     =
                                              LNK-SYU-HKNCOMBINUM)
                AND (LNK-S02-DOJITU-DAY(IDY)  =  0 OR 1          )
                   MOVE   ZERO  TO   WK-SHOKUJI-KANFLG(IDY)
                ELSE
                   MOVE    1    TO   WK-SHOKUJI-KANFLG(IDY)
                END-IF
              END-IF
      *
           END-PERFORM
      *
           PERFORM    VARYING   IDY   FROM   1   BY   1
                       UNTIL    IDY    >    31
      *
              EVALUATE   WK-SHOKUJI-ASA (IDY)
                WHEN        1
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                                     WK-SHOKUJI-NYUINJI2(IDY)
                WHEN        2
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                                     WK-SHOKUJI-TOKUSYO(IDY)
                                     WK-SHOKUJI-NYUINJI2(IDY)
                WHEN        3
                  IF    LNK-SYU-SRYYMD(1:6)  >=  "201604"
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                  END-IF
              END-EVALUATE
              EVALUATE   WK-SHOKUJI-HIRU(IDY)
                WHEN        1
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                                     WK-SHOKUJI-NYUINJI2(IDY)
                WHEN        2
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                                     WK-SHOKUJI-TOKUSYO(IDY)
                                     WK-SHOKUJI-NYUINJI2(IDY)
                WHEN        3
                  IF    LNK-SYU-SRYYMD(1:6)  >=  "201604"
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                  END-IF
              END-EVALUATE
              EVALUATE   WK-SHOKUJI-YORU(IDY)
                WHEN        1
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                                     WK-SHOKUJI-NYUINJI2(IDY)
                WHEN        2
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                                     WK-SHOKUJI-TOKUSYO(IDY)
                                     WK-SHOKUJI-NYUINJI2(IDY)
                WHEN        3
                  IF    LNK-SYU-SRYYMD(1:6)  >=  "201604"
                    ADD   1     TO   WK-SHOKUJI-NYUINJI(IDY)
                  END-IF
              END-EVALUATE
      *
           END-PERFORM
      *
           .
      *
       23046-SHOKUJI-FURIWAKE-EXT.
           EXIT.
      *
      ******************************************************************
      *    Æþ±¡»þ¿©»öÎÅÍÜ¤ÈÆÃÊÌ¿©²Ã»»¤ò¤ï¤±¤ë
      ******************************************************************
       230461-SHOKUJI-FURIWAKE-SEC                 SECTION.
      *
           EVALUATE  LNK-S02-DOJITU-SKJST(IDY)
             WHEN     "0"
               MOVE   ZERO   TO  WK-SHOKUJI-ASA (IDY)
               MOVE   ZERO   TO  WK-SHOKUJI-HIRU(IDY)
               MOVE   ZERO   TO  WK-SHOKUJI-YORU(IDY)
               MOVE   ZERO   TO  WK-SHOKUDOKASAN(IDY)
             WHEN     "1"
               CONTINUE
             WHEN     "2"
               IF   WK-SHOKUJI-ASA (IDY)  NOT = ZERO
                 MOVE ZERO   TO  WK-SHOKUDOKASAN(IDY)
               END-IF
               MOVE   ZERO   TO  WK-SHOKUJI-ASA (IDY)
             WHEN     "3"
               IF   WK-SHOKUJI-ASA (IDY)  NOT = ZERO
               OR   WK-SHOKUJI-HIRU(IDY)  NOT = ZERO
                 MOVE ZERO   TO  WK-SHOKUDOKASAN(IDY)
               END-IF
               MOVE   ZERO   TO  WK-SHOKUJI-ASA (IDY)
               MOVE   ZERO   TO  WK-SHOKUJI-HIRU(IDY)
           END-EVALUATE
           MOVE        1     TO  WK-SHOKUJI-KANFLG(IDY)
      *
           .
      *
       230461-SHOKUJI-FURIWAKE-EXT.
           EXIT.
      *
      ******************************************************************
      *    Æþ±¡»þ¿©»öÎÅÍÜ¤ÈÆÃÊÌ¿©²Ã»»¤ò¤ï¤±¤ë
      ******************************************************************
       230462-SHOKUJI-FURIWAKE2-SEC                 SECTION.
      *
           EVALUATE  LNK-S02-DOJITU-SKJED(IDY)
             WHEN     "0"
               MOVE   ZERO   TO  WK-SHOKUJI-ASA (IDY)
               MOVE   ZERO   TO  WK-SHOKUJI-HIRU(IDY)
               MOVE   ZERO   TO  WK-SHOKUJI-YORU(IDY)
               MOVE   ZERO   TO  WK-SHOKUDOKASAN(IDY)
             WHEN     "1"
               IF   WK-SHOKUJI-ASA (IDY)  = ZERO
                 MOVE ZERO   TO  WK-SHOKUDOKASAN(IDY)
               END-IF
               MOVE   ZERO   TO  WK-SHOKUJI-HIRU(IDY)
               MOVE   ZERO   TO  WK-SHOKUJI-YORU(IDY)
             WHEN     "2"
               IF   WK-SHOKUJI-ASA (IDY)  = ZERO
               AND  WK-SHOKUJI-HIRU(IDY)  = ZERO
                 MOVE ZERO   TO  WK-SHOKUDOKASAN(IDY)
               END-IF
               MOVE   ZERO   TO  WK-SHOKUJI-YORU(IDY)
             WHEN     "3"
               CONTINUE
           END-EVALUATE
      *
           .
      *
       230462-SHOKUJI-FURIWAKE2-EXT.
           EXIT.
      *
      ******************************************************************
      *    Æþ±¡»þ¿©»öÎÅÍÜ¤ÈÆÃÊÌ¿©²Ã»»¤ò¤ï¤±¤ë
      ******************************************************************
       230463-SHOKUJI-FURIWAKE3-SEC                 SECTION.
      *
           MOVE   ZERO   TO  WK-SHOKUJI-ASA (IDY)
           MOVE   ZERO   TO  WK-SHOKUJI-HIRU(IDY)
           MOVE   ZERO   TO  WK-SHOKUJI-YORU(IDY)
           MOVE   ZERO   TO  WK-SHOKUDOKASAN(IDY)
           MOVE    1     TO  WK-SHOKUJI-KANFLG(IDY)
      *
           .
      *
       230463-SHOKUJI-FURIWAKE3-EXT.
           EXIT.
      *
      ******************************************************************
      *    Æþ±¡»þ¿©»öÎÅÍÜ¤ÈÆÃÊÌ¿©²Ã»»¤ò¤ï¤±¤ë
      ******************************************************************
       230464-SHOKUJI-FURIWAKE4-SEC                 SECTION.
      *
           IF   (LNK-S02-SKJHKN-HKNCOMBI(IDY)     NOT = SPACE)
           AND  (LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY) NOT = SPACE)
              IF      (LNK-S02-SKJHKN-HKNCOMBI(IDY)         =
                                                LNK-SYU-HKNCOMBINUM)
              AND     (LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY)     =
                                                LNK-SYU-HKNCOMBINUM)
                MOVE   "1"   TO   WK-SKJHKN-SANTEIFLG(IDY)
              ELSE
                IF    (LNK-S02-SKJHKN-HKNCOMBI(IDY)         =
                                                LNK-SYU-HKNCOMBINUM)
                AND   (LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY) NOT =
                                                LNK-SYU-HKNCOMBINUM)
                  PERFORM     230462-SHOKUJI-FURIWAKE2-SEC
                  MOVE   "1"   TO   WK-SKJHKN-SANTEIFLG(IDY)
                ELSE
                  IF  (LNK-S02-SKJHKN-HKNCOMBI(IDY)     NOT =
                                                LNK-SYU-HKNCOMBINUM)
                  AND (LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY)     =
                                                LNK-SYU-HKNCOMBINUM)
                    PERFORM   230461-SHOKUJI-FURIWAKE-SEC
                    MOVE   "1"   TO   WK-SKJHKN-SANTEIFLG(IDY)
                  ELSE
                    PERFORM   230463-SHOKUJI-FURIWAKE3-SEC
                  END-IF
                END-IF
              END-IF
           ELSE
              IF  LNK-S02-SKJHKN-HKNCOMBI(IDY) NOT = SPACE
                IF  LNK-S02-SKJHKN-HKNCOMBI(IDY)   =
                                          LNK-SYU-HKNCOMBINUM
                    IF  ( LNK-S02-DOJITU-DAY(IDY)  =  1 OR 7 OR 8 )
                    OR  ((LNK-S02-DOJITU-DAY(IDY)  =  0 ) AND
                         (LNK-SYU-DAY(IDY)         = "2")         )
                      PERFORM   230462-SHOKUJI-FURIWAKE2-SEC
                    END-IF
                    MOVE   "1"   TO   WK-SKJHKN-SANTEIFLG(IDY)
                ELSE
                    IF  LNK-S02-DOJITU-DAY(IDY)  =  1 OR 7 OR 8
                      PERFORM   230463-SHOKUJI-FURIWAKE3-SEC
                    END-IF
                    IF  LNK-S02-DOJITU-DAY(IDY)  =  9 OR 0
                      PERFORM   230461-SHOKUJI-FURIWAKE-SEC
                    END-IF
                END-IF
              ELSE
                IF  LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY)   =
                                          LNK-SYU-HKNCOMBINUM
                    IF  ( LNK-S02-DOJITU-DAY(IDY)  =  7 OR 8 OR 9 )
                    OR  ((LNK-S02-DOJITU-DAY(IDY)  =  0 ) AND
                         (LNK-SYU-DAY(IDY)         = "2")         )
                      PERFORM   230461-SHOKUJI-FURIWAKE-SEC
                    END-IF
                    MOVE   "1"   TO   WK-SKJHKN-SANTEIFLG(IDY)
                ELSE
                    IF  LNK-S02-DOJITU-DAY(IDY)  =  7 OR 8 OR 9
                      PERFORM   230463-SHOKUJI-FURIWAKE3-SEC
                    END-IF
                    IF  LNK-S02-DOJITU-DAY(IDY)  =  1 OR 0
                      PERFORM   230462-SHOKUJI-FURIWAKE2-SEC
                    END-IF
                END-IF
              END-IF
           END-IF
      *
           .
      *
       230464-SHOKUJI-FURIWAKE4-EXT.
           EXIT.
      *
      ******************************************************************
      *    Æþ±¡»þ¿©»öÎÅÍÜ¤ÈÆÃÊÌ¿©²Ã»»¤ò¤ï¤±¤ë
      ******************************************************************
       230465-SHOKUJI-FURIWAKE5-SEC                 SECTION.
      *
           IF  LNK-S02-DOJITU-DAY(IDY)  =  1 OR 7
             IF   LNK-S02-SKJHKN-HKNCOMBI(IDY) NOT = SPACE
                IF  LNK-S02-SKJHKN-HKNCOMBI(IDY)   =
                                          LNK-SYU-HKNCOMBINUM
                      PERFORM   230462-SHOKUJI-FURIWAKE2-SEC
                      MOVE   "1"   TO   WK-SKJHKN-SANTEIFLG(IDY)
                ELSE
                      PERFORM   230463-SHOKUJI-FURIWAKE3-SEC
                END-IF
             ELSE
                IF    LNK-S02-DOJITU-DAY(IDY)  =  1
                      PERFORM   230462-SHOKUJI-FURIWAKE2-SEC
                END-IF
                IF    LNK-S02-DOJITU-DAY(IDY)  =  7
                      PERFORM   230463-SHOKUJI-FURIWAKE3-SEC
                END-IF
             END-IF
           END-IF
      *
           IF  LNK-S02-DOJITU-DAY(IDY)  =  8 OR 9
             IF   LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY) NOT = SPACE
                IF  LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY)   =
                                              LNK-SYU-HKNCOMBINUM
                      PERFORM   230461-SHOKUJI-FURIWAKE-SEC
                      MOVE   "1"   TO   WK-SKJHKN-SANTEIFLG(IDY)
                ELSE
                      PERFORM   230463-SHOKUJI-FURIWAKE3-SEC
                END-IF
             ELSE
                IF    LNK-S02-DOJITU-DAY(IDY)  =  9
                      PERFORM   230461-SHOKUJI-FURIWAKE-SEC
                END-IF
                IF    LNK-S02-DOJITU-DAY(IDY)  =  8
                      PERFORM   230463-SHOKUJI-FURIWAKE3-SEC
                END-IF
             END-IF
           END-IF
      *
           IF  LNK-S02-DOJITU-DAY(IDY)  =  0
                      PERFORM   230464-SHOKUJI-FURIWAKE4-SEC
           END-IF
      *
           .
      *
       230465-SHOKUJI-FURIWAKE5-EXT.
           EXIT.
      *
      ******************************************************************
      *    Æþ±¡ÎÁ¤È°Û¤Ê¤ëÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¤Ç¤Î¿©»ö»»Äê¥Á¥§¥Ã¥¯¥Æ¡¼¥Ö¥ëÊÔ½¸
      ******************************************************************
       230466-SKJ-SANTEIFLG-SET-SEC                 SECTION.
      *
           IF   (LNK-S02-SKJHKN-SRYYM(1) = SPACE              )
           OR   (LNK-SYU-SRYYMD(1:6) = LNK-S02-SKJHKN-SRYYM(1))
             IF    LNK-S02-SKJHKN-SET(1 IDY) = SPACE
               MOVE  LNK-SYU-SRYYMD(1:6)
                            TO  LNK-S02-SKJHKN-SRYYM(1)
               MOVE  "1"    TO  LNK-S02-SKJHKN-SET(1 IDY)
               IF  LNK-S02-SKJHKN-HKNCOMBI(IDY) NOT = SPACE
                 MOVE   "1" TO LNK-S02-SKJHKN-AAA-TAIFLG(1 IDY)
                 PERFORM   2304661-SKJ-SANTEIFLG-SET1-SEC
                 IF   FLG-SET  =  1
                   MOVE "1" TO LNK-S02-SKJHKN-AAA-ARIFLG(1 IDY)
                 END-IF
               END-IF
               IF  LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY) NOT = SPACE
                 MOVE   "1" TO LNK-S02-SKJHKN-BBB-TAIFLG(1 IDY)
                 PERFORM   2304662-SKJ-SANTEIFLG-SET2-SEC
                 IF   FLG-SET  =  1
                   MOVE "1" TO LNK-S02-SKJHKN-BBB-ARIFLG(1 IDY)
                 END-IF
               END-IF
             END-IF
           ELSE
             IF   (LNK-S02-SKJHKN-SRYYM(2) = SPACE              )
             OR   (LNK-SYU-SRYYMD(1:6) = LNK-S02-SKJHKN-SRYYM(2))
               IF    LNK-S02-SKJHKN-SET(2 IDY) = SPACE
                 MOVE  LNK-SYU-SRYYMD(1:6)
                              TO  LNK-S02-SKJHKN-SRYYM(2)
                 MOVE  "1"    TO  LNK-S02-SKJHKN-SET(2 IDY)
                 IF  LNK-S02-SKJHKN-HKNCOMBI(IDY) NOT = SPACE
                   MOVE   "1" TO LNK-S02-SKJHKN-AAA-TAIFLG(2 IDY)
                   PERFORM   2304661-SKJ-SANTEIFLG-SET1-SEC
                   IF   FLG-SET  =  1
                     MOVE "1" TO LNK-S02-SKJHKN-AAA-ARIFLG(2 IDY)
                   END-IF
                 END-IF
                 IF  LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY) NOT = SPACE
                   MOVE   "1" TO LNK-S02-SKJHKN-BBB-TAIFLG(2 IDY)
                   PERFORM   2304662-SKJ-SANTEIFLG-SET2-SEC
                   IF   FLG-SET  =  1
                     MOVE "1" TO LNK-S02-SKJHKN-BBB-ARIFLG(2 IDY)
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           .
      *
       230466-SKJ-SANTEIFLG-SET-EXT.
           EXIT.
      *
      ******************************************************************
      *    Æþ±¡ÎÁ¤È°Û¤Ê¤ëÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¤Ç¤Î¿©»ö»»Äê¥Á¥§¥Ã¥¯¥Æ¡¼¥Ö¥ëÊÔ½¸
      ******************************************************************
       2304661-SKJ-SANTEIFLG-SET1-SEC                 SECTION.
      *
           MOVE      ZERO       TO    FLG-SET
           IF    LNK-S02-SKJHKN-HKNCOMBI-DOU-XXX(IDY) = SPACE
                 IF   WK-SHOKUJI-ASA (IDY)  NOT = ZERO
                 OR   WK-SHOKUJI-HIRU(IDY)  NOT = ZERO
                 OR   WK-SHOKUJI-YORU(IDY)  NOT = ZERO
                   MOVE    1    TO    FLG-SET
                 END-IF
           ELSE
             EVALUATE  LNK-S02-DOJITU-SKJED(IDY)
               WHEN     "0"
                 CONTINUE
               WHEN     "1"
                 IF   WK-SHOKUJI-ASA (IDY)  NOT = ZERO
                   MOVE    1    TO    FLG-SET
                 END-IF
               WHEN     "2"
                 IF   WK-SHOKUJI-ASA (IDY)  NOT = ZERO
                 OR   WK-SHOKUJI-HIRU(IDY)  NOT = ZERO
                   MOVE    1    TO    FLG-SET
                 END-IF
               WHEN     "3"
                 IF   WK-SHOKUJI-ASA (IDY)  NOT = ZERO
                 OR   WK-SHOKUJI-HIRU(IDY)  NOT = ZERO
                 OR   WK-SHOKUJI-YORU(IDY)  NOT = ZERO
                   MOVE    1    TO    FLG-SET
                 END-IF
             END-EVALUATE
           END-IF
      *    Æþ±¡»þÀ¸³èÎÅÍÜ¡Ê´Ä¶­¡Ë¤ÏÆþ±¡²ñ·×¤ÎÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¤Ç»»Äê
      *    ¤¹¤ë¤¿¤á¡¢¤³¤ÎÉôÊ¬¤Ï¥³¥á¥ó¥È¥¢¥¦¥È
      ****>IF         WK-NYULIFE-KBN(IDY)   NOT = SPACE
      ****>        MOVE    1    TO    FLG-SET
      ****>END-IF
      *
           .
      *
       2304661-SKJ-SANTEIFLG-SET1-EXT.
           EXIT.
      *
      ******************************************************************
      *    Æþ±¡ÎÁ¤È°Û¤Ê¤ëÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¤Ç¤Î¿©»ö»»Äê¥Á¥§¥Ã¥¯¥Æ¡¼¥Ö¥ëÊÔ½¸
      ******************************************************************
       2304662-SKJ-SANTEIFLG-SET2-SEC                 SECTION.
      *
           MOVE      ZERO     TO    FLG-SET
           EVALUATE  LNK-S02-DOJITU-SKJST(IDY)
             WHEN     "0"
               CONTINUE
             WHEN     "1"
               IF   WK-SHOKUJI-ASA (IDY)  NOT = ZERO
               OR   WK-SHOKUJI-HIRU(IDY)  NOT = ZERO
               OR   WK-SHOKUJI-YORU(IDY)  NOT = ZERO
                 MOVE    1    TO    FLG-SET
               END-IF
             WHEN     "2"
               IF   WK-SHOKUJI-HIRU(IDY)  NOT = ZERO
               OR   WK-SHOKUJI-YORU(IDY)  NOT = ZERO
                 MOVE    1    TO    FLG-SET
               END-IF
             WHEN     "3"
               IF   WK-SHOKUJI-YORU(IDY)  NOT = ZERO
                 MOVE    1    TO    FLG-SET
               END-IF
           END-EVALUATE
      *
           .
      *
       2304662-SKJ-SANTEIFLG-SET2-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¿©»öÎÅÍÜÈñÅù¤Î·×»»                                      *
      ******************************************************************
       23047-SHOKUJI-COUNT200604-SEC         SECTION.
      *
      *    Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë
           MOVE    "197000110"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(1)
           END-IF
      *    Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£²¡Ë
           MOVE    "197000710"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(2)
           END-IF
      *    ÆÃÊÌ¿©²Ã»»
           MOVE    "197000470"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(3)
           END-IF
      *    ¿©Æ²²Ã»»
           MOVE    "197000570"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(4)
           END-IF
      *    É¸½àÉéÃ´³Û¡ÊÏ«ºÒÆþ±¡Ãæ¡Ë
           MOVE    "197001210"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(5)
           END-IF
      *    ÆÃÊÌ¿©²Ã»»¡ÊÀ¸³èÎÅÍÜ¡Ë
           MOVE    "197001570"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(6)
           END-IF
      *    ¿©Æ²²Ã»»¡ÊÀ¸³èÎÅÍÜ¡Ë
           MOVE    "197001670"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(7)
           END-IF
      *    É¸½àÉéÃ´³Û¡Ê°ìÈÌ¡Ë
           MOVE    "197000810"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-HYOJYUNFTN(1)
           END-IF
      *    É¸½àÉéÃ´³Û¡ÊÄã£±¡Ë
           MOVE    "197001110"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-HYOJYUNFTN(2)
           END-IF
      *    É¸½àÉéÃ´³Û¡ÊÄã£²¡¦£¹£°Æü°Ê²¼¡Ë
           MOVE    "197000910"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-HYOJYUNFTN(3)
           END-IF
      *    É¸½àÉéÃ´³Û¡ÊÄã£²¡¦£¹£°ÆüÄ¶¡Ë
           MOVE    "197001010"    TO   WK-SRYCD
           PERFORM    TENSU-TBL-SEC
           IF       FLG-TENSU      =    ZERO
              MOVE    WK-KEISAN   TO  WK-SHOKUJI-HYOJYUNFTN(4)
           END-IF
      *
           IF    LNK-SYU-SRYYMD(1:6)  >=  "201604"
      *      Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£±¡Ë¡Ê£±¿©¤Ë¤Ä¤­¡Ë¡ÊÎ®Æ°¿©¤Î¤ß¤òÄó¶¡¡Ë
             MOVE    "197003110"    TO   WK-SRYCD
             PERFORM    TENSU-TBL-SEC
             IF       FLG-TENSU      =    ZERO
                MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(8)
             END-IF
      *      Æþ±¡»þ¿©»öÎÅÍÜ¡Ê£²¡Ë¡Ê£±¿©¤Ë¤Ä¤­¡Ë¡ÊÎ®Æ°¿©¤Î¤ß¤òÄó¶¡¡Ë
             MOVE    "197003210"    TO   WK-SRYCD
             PERFORM    TENSU-TBL-SEC
             IF       FLG-TENSU      =    ZERO
                MOVE    WK-KEISAN   TO  WK-SHOKUJI-KINGAKU(9)
             END-IF
      *      ¿©»öÎÅÍÜÉ¸½àÉéÃ´³Û¡Ê»ØÄêÆñÉÂ¡¦¾®»ùËýÀ­ÆÃÄê¼ÀÉÂ´µ¼Ô¡Ë¡Ê°ìÈÌ¡Ë
             MOVE    "197003310"    TO   WK-SRYCD
             PERFORM    TENSU-TBL-SEC
             IF       FLG-TENSU      =    ZERO
                MOVE    WK-KEISAN   TO  WK-SHOKUJI-HYOJYUNFTN(5)
             END-IF
      *      ¿©»öÎÅÍÜÉ¸½àÉéÃ´³Û¡ÊÀº¿À£±Ç¯Ä¶¡Ë¡Ê°ìÈÌ¡Ë
             MOVE    "197003410"    TO   WK-SRYCD
             PERFORM    TENSU-TBL-SEC
             IF       FLG-TENSU      =    ZERO
                MOVE    WK-KEISAN   TO  WK-SHOKUJI-HYOJYUNFTN(6)
             END-IF
           END-IF
      **
           IF    LNK-SYU-SRYYMD(1:6)  >=  "201604"
             PERFORM  230471-SHOKUJI-HEN201604-SEC
           ELSE
             PERFORM  230472-SHOKUJI-HEN200604-SEC
           END-IF
      *
           .
      *
       23047-SHOKUJI-COUNT200604-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¿©»öÎÅÍÜÈñÅù¤ÎÊÔ½¸¡ÊÊ¿À®£²£¸Ç¯£´·î¡Á¡Ë                  *
      ******************************************************************
       230471-SHOKUJI-HEN201604-SEC         SECTION.
      *
           MOVE       ZERO        TO  FLG-SEIKATU
           MOVE       ZERO        TO  FLG-SEIKATUS
           MOVE       ZERO        TO  FLG-SEIKATUL
           MOVE       ZERO        TO  FLG-SEIKATUL2
      **
           MOVE       LNK-SYU-SKYSTYMD(7:2)  TO   IDX-ST
           MOVE       LNK-SYU-SKYEDYMD(7:2)  TO   IDX-ED
      *
           PERFORM    VARYING   IDY   FROM   IDX-ST   BY   1
                       UNTIL    IDY     >    IDX-ED
      *
             MOVE     ZERO     TO      WK-SHOKUJI-JIHI
      *
             IF     WK-NYULIFE-KBN(IDY)   NOT =   SPACE
               IF   LNK-S02-SKJHKN-HKNCOMBI(IDY)     = SPACE
               AND  LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY) = SPACE
      *          Æþ±¡»þÀ¸³èÎÅÍÜ¡Ê¿©»ö¡Ë
                 IF   ( WK-SHOKUJI-NYUINJI(IDY)   NOT =  ZERO )
                 AND  ((LNK-SYU-DAY(IDY)       =  "1" OR "9" ) OR
                       (LNK-S02-NYUINDAY-KBN(IDY)     =  "1" ))
                 AND  ( LNK-S02-NYUSANTEI-KBN(IDY)    =  "1"  )
                 AND  ((WK-GAIHAKU(IDY)        =  ZERO       ) OR
                       (WK-GAIHAKU(IDY)       >=   4         ))
                    PERFORM   2304711-SHOKUJI-HEN201604X1-SEC
                 END-IF
      *          Æþ±¡»þÀ¸³èÎÅÍÜ¡Ê´Ä¶­¡Ë
                 MOVE     ZERO     TO      WK-SHOKUJI-JIHI
                 IF   ((LNK-SYU-DAY(IDY)       =  "1" OR "9" ) OR
                       (LNK-S02-NYUINDAY-KBN(IDY)     =  "1" ))
                 AND  ( LNK-S02-NYUSANTEI-KBN(IDY)    =  "1"  )
                 AND  ((WK-GAIHAKU(IDY)        =  ZERO       ) OR
                       (WK-GAIHAKU(IDY)       >=   4         ))
                 AND  ( WK-SHOKUJI-KANFLG(IDY) =  ZERO        )
                    PERFORM   2304712-SHOKUJI-HEN201604X2-SEC
                 END-IF
               ELSE
      *          Æþ±¡»þÀ¸³èÎÅÍÜ¡Ê¿©»ö¡Ë
                 IF   ( WK-SHOKUJI-NYUINJI(IDY)   NOT =  ZERO )
                 AND  ((LNK-SYU-DAY(IDY)       =  "1" OR "9" ) OR
                       (LNK-S02-NYUINDAY-KBN(IDY)     =  "1" ) OR
                       (WK-SKJHKN-SANTEIFLG(IDY)      =  "1" ))
                 AND  ( LNK-S02-NYUSANTEI-KBN(IDY)    =  "1"  )
                 AND  ((WK-GAIHAKU(IDY)        =  ZERO       ) OR
                       (WK-GAIHAKU(IDY)       >=   4         ))
                    PERFORM   2304711-SHOKUJI-HEN201604X1-SEC
                 END-IF
      *          Æþ±¡»þÀ¸³èÎÅÍÜ¡Ê´Ä¶­¡Ë
                 MOVE     ZERO     TO      WK-SHOKUJI-JIHI
                 IF   ((LNK-SYU-DAY(IDY)       =  "1" OR "9" ) OR
                       (LNK-S02-NYUINDAY-KBN(IDY)     =  "1" ) OR
                       (WK-SKJHKN-SANTEIFLG(IDY)      =  "1" ))
                 AND  ( LNK-S02-NYUSANTEI-KBN(IDY)    =  "1"  )
                 AND  ((WK-GAIHAKU(IDY)        =  ZERO       ) OR
                       (WK-GAIHAKU(IDY)       >=   4         ))
                 AND  ( WK-SHOKUJI-KANFLG(IDY) =  ZERO        )
                    PERFORM   2304712-SHOKUJI-HEN201604X2-SEC
                 END-IF
               END-IF
             ELSE
               IF   LNK-S02-SKJHKN-HKNCOMBI(IDY)     = SPACE
               AND  LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY) = SPACE
                 IF   ( WK-SHOKUJI-NYUINJI(IDY)   NOT =  ZERO )
                 AND  ((LNK-SYU-DAY(IDY)       =  "1" OR "9" ) OR
                       (LNK-S02-NYUINDAY-KBN(IDY)     =  "1" ))
                 AND  ( LNK-S02-NYUSANTEI-KBN(IDY)    =  "1"  )
                 AND  ((WK-GAIHAKU(IDY)        =  ZERO       ) OR
                       (WK-GAIHAKU(IDY)       >=   4         ))
                    PERFORM   2304713-SHOKUJI-HEN201604X3-SEC
                 END-IF
               ELSE
                 IF   ( WK-SHOKUJI-NYUINJI(IDY)   NOT =  ZERO )
                 AND  ((LNK-SYU-DAY(IDY)       =  "1" OR "9" ) OR
                       (LNK-S02-NYUINDAY-KBN(IDY)     =  "1" ) OR
                       (WK-SKJHKN-SANTEIFLG(IDY)      =  "1" ))
                 AND  ( LNK-S02-NYUSANTEI-KBN(IDY)    =  "1"  )
                 AND  ((WK-GAIHAKU(IDY)        =  ZERO       ) OR
                       (WK-GAIHAKU(IDY)       >=   4         ))
                    PERFORM   2304713-SHOKUJI-HEN201604X3-SEC
                 END-IF
               END-IF
             END-IF
      *
      *      ÆÃÊÌ¿©ÊÔ½¸¡Ê¿ÇÎÅ¹Ô°ÙÆþÎÏÊ¬¡Ë
             PERFORM        2304714-SHOKUJI-HENSINTOKU-SEC
      *
           END-PERFORM
      *
           .
      *
       230471-SHOKUJI-HEN201604-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¿©»öÎÅÍÜÈñÅù¤ÎÊÔ½¸¡ÊÊ¿À®£²£¸Ç¯£´·î¡Á¡Ë  £±              *
      ******************************************************************
       2304711-SHOKUJI-HEN201604X1-SEC    SECTION.
      *
           EVALUATE   WK-SHOKUJIRYOYO(IDY)
      *
             WHEN        1
      *
               PERFORM  VARYING  IDX23  FROM  1  BY  1
                         UNTIL   IDX23   >    3
                 EVALUATE  WK-SHOKUJI-AHY(IDY IDX23)
                   WHEN       1
                   WHEN       2
                     ADD     1                TO WK-SHOKUJI-NISSU
                                                 WK-SHOKUJI-NISSUL
                     ADD     WK-NYULIFE2-SKJ-MONEY(IDY IDX23)
                                              TO WK-SHOKUJI-RYOYOHI
                                                 WK-SHOKUJI-RYOYOHIL
                                                 WK-SHOKUJI-JIHI
                     ADD     1                TO LNK-SYU-SHOKUJI5-NISSU
                     MOVE    WK-NYULIFE2-SKJ-MONEY(IDY IDX23)
                                              TO LNK-SYU-SHOKUJI5
                     IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                       COMPUTE   WK-SKJ-ZEI   =
                                (WK-NYULIFE2-SKJ-MONEY(IDY IDX23)
                                                       * WK-S4)
                                                       + WK-S3
                       COMPUTE   WK-SKJ-ZEIKEI2L =
                                 WK-SKJ-ZEIKEI2L +
                                 WK-SKJ-ZEI
                     END-IF
                     IF    WK-SHOKUJI-AHY(IDY IDX23)  =  2
                         ADD     WK-SHOKUJI-KINGAKU(6)
                                              TO WK-SHOKUJI-RYOYOHI
                                                 WK-SHOKUJI-RYOYOHIL
                                                 WK-SHOKUJI-JIHI
                         ADD     1            TO LNK-SYU-SHOKUJI7-NISSU
                         MOVE    WK-SHOKUJI-KINGAKU(6)
                                              TO LNK-SYU-SHOKUJI7
                         IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                           COMPUTE   WK-SKJ-ZEI   =
                                    (WK-SHOKUJI-KINGAKU(6) * WK-S4)
                                                           + WK-S3
                           COMPUTE   WK-SKJ-ZEIKEI2L =
                                     WK-SKJ-ZEIKEI2L +
                                     WK-SKJ-ZEI
                         END-IF
                     END-IF
                   WHEN       3
                     ADD     1                TO WK-SHOKUJI-NISSU
                                                 WK-SHOKUJI-NISSUL
                     ADD     WK-NYULIFE2-SKJ-MONEY(IDY IDX23)
                                              TO WK-SHOKUJI-RYOYOHI
                                                 WK-SHOKUJI-RYOYOHIL
                                                 WK-SHOKUJI-JIHI
                     ADD     1                TO LNK-SYU-SHOKUJI13-NISSU
                     MOVE    WK-NYULIFE2-SKJ-MONEY(IDY IDX23)
                                              TO LNK-SYU-SHOKUJI13
                     IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                       COMPUTE   WK-SKJ-ZEI   =
                                (WK-NYULIFE2-SKJ-MONEY(IDY IDX23)
                                                       * WK-S4)
                                                       + WK-S3
                       COMPUTE   WK-SKJ-ZEIKEI2L =
                                 WK-SKJ-ZEIKEI2L +
                                 WK-SKJ-ZEI
                     END-IF
                 END-EVALUATE
               END-PERFORM
               IF   WK-SHOKUDOKASAN(IDY)     NOT =  ZERO
                     ADD     WK-SHOKUJI-KINGAKU(7)
                                              TO WK-SHOKUJI-RYOYOHI
                                                 WK-SHOKUJI-RYOYOHIL
                                                 WK-SHOKUJI-JIHI
                     ADD     1                TO LNK-SYU-SHOKUJI8-NISSU
                     MOVE    WK-SHOKUJI-KINGAKU(7)
                                              TO LNK-SYU-SHOKUJI8
                     IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                       COMPUTE   WK-SKJ-ZEI   =
                                (WK-SHOKUJI-KINGAKU(7) * WK-S4)
                                                       + WK-S3
                       COMPUTE   WK-SKJ-ZEIKEI2L =
                                 WK-SKJ-ZEIKEI2L +
                                 WK-SKJ-ZEI
                     END-IF
               END-IF
      *
             WHEN        2
      *
               PERFORM  VARYING  IDX23  FROM  1  BY  1
                         UNTIL   IDX23   >    3
                 EVALUATE  WK-SHOKUJI-AHY(IDY IDX23)
                   WHEN       1
                   WHEN       2
                     ADD     1                TO WK-SHOKUJI-NISSU
                                                 WK-SHOKUJI-NISSUL
                     ADD     WK-NYULIFE2-SKJ-MONEY(IDY IDX23)
                                              TO WK-SHOKUJI-RYOYOHI
                                                 WK-SHOKUJI-RYOYOHIL
                                                 WK-SHOKUJI-JIHI
                     ADD     1                TO LNK-SYU-SHOKUJI6-NISSU
                     MOVE    WK-NYULIFE2-SKJ-MONEY(IDY IDX23)
                                              TO LNK-SYU-SHOKUJI6
                     IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                       COMPUTE   WK-SKJ-ZEI   =
                                (WK-NYULIFE2-SKJ-MONEY(IDY IDX23)
                                                       * WK-S4)
                                                       + WK-S3
                       COMPUTE   WK-SKJ-ZEIKEI2L =
                                 WK-SKJ-ZEIKEI2L +
                                 WK-SKJ-ZEI
                     END-IF
                   WHEN       3
                     ADD     1                TO WK-SHOKUJI-NISSU
                                                 WK-SHOKUJI-NISSUL
                     ADD     WK-NYULIFE2-SKJ-MONEY(IDY IDX23)
                                              TO WK-SHOKUJI-RYOYOHI
                                                 WK-SHOKUJI-RYOYOHIL
                                                 WK-SHOKUJI-JIHI
                     ADD     1                TO LNK-SYU-SHOKUJI6-NISSU
                     MOVE    WK-NYULIFE2-SKJ-MONEY(IDY IDX23)
                                              TO LNK-SYU-SHOKUJI6
                     IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                       COMPUTE   WK-SKJ-ZEI   =
                                (WK-NYULIFE2-SKJ-MONEY(IDY IDX23)
                                                       * WK-S4)
                                                       + WK-S3
                       COMPUTE   WK-SKJ-ZEIKEI2L =
                                 WK-SKJ-ZEIKEI2L +
                                 WK-SKJ-ZEI
                     END-IF
      *
                     MOVE   31    TO   LNK-S02-RC
                 END-EVALUATE
               END-PERFORM
      *
           END-EVALUATE
      *
           IF   ( COMB-SYU-HKNKOHSBTKBN   =   "8"  OR  "9"   )
           OR   ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                             OR  "068"  OR  "069"  OR  "040" )
           OR   ((COMB-HKNNUM             =   SPACE         ) AND
                 (COMB-KOH1HKNNUM         =   "012" OR "025") AND
                 (COMB-KOH2HKNNUM         =   SPACE         ) AND
                 (COMB-KOH3HKNNUM         =   SPACE         ) AND
                 (COMB-KOH4HKNNUM         =   SPACE         ))
             ADD   WK-SHOKUJI-JIHI    TO   WK-SHOKUJI-FTN
                                           WK-SHOKUJI-FTNL
           ELSE
             PERFORM  VARYING  IDX23  FROM  1  BY  1
                       UNTIL   IDX23   >    3
               EVALUATE  WK-SHOKUJI-AHY(IDY IDX23)
                 WHEN       1
                 WHEN       2
                 WHEN       3
                   ADD     WK-NYULIFE2-SKJFTN-MONEY(IDY IDX23)
                                      TO   WK-SHOKUJI-FTN
                                           WK-SHOKUJI-FTNL
                   ADD     WK-NYULIFE2-SKJFTN-MONEY(IDY IDX23)
                                      TO   WK-DAY-SKJFTN(IDY)
                                           WK-DAY-SKJFTNL(IDY)
                   ADD     1          TO   WK-DAY-KAISU(IDY)
                                           WK-DAY-KAISUL(IDY)
               END-EVALUATE
             END-PERFORM
           END-IF
      *
           IF    FLG-SEIKATU   =  ZERO
               MOVE     2     TO      FLG-SEIKATU
           END-IF
           MOVE         1     TO      FLG-SEIKATUL
      *
           .
      *
       2304711-SHOKUJI-HEN201604X1-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¿©»öÎÅÍÜÈñÅù¤ÎÊÔ½¸¡ÊÊ¿À®£²£¸Ç¯£´·î¡Á¡Ë  £²              *
      ******************************************************************
       2304712-SHOKUJI-HEN201604X2-SEC    SECTION.
      *
           EVALUATE   WK-SHOKUJIRYOYO(IDY)
      *
             WHEN        1
      *
               ADD     WK-NYULIFE-KAN-MONEY(IDY)
                                     TO  WK-SHOKUJI-RYOYOHI
                                         WK-SHOKUJI-RYOYOHIL
                                         WK-SHOKUJI-JIHI
                                         WK-SHOKUJI-RYOYOHIL2
               ADD     1             TO  LNK-SYU-SHOKUJI9-NISSU
               MOVE    WK-NYULIFE-KAN-MONEY(IDY)
                                     TO  LNK-SYU-SHOKUJI9
               IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                 COMPUTE   WK-SKJ-ZEI   =
                          (WK-NYULIFE-KAN-MONEY(IDY) * WK-S4)
                                                     + WK-S3
                 COMPUTE   WK-SKJ-ZEIKEI2L  =
                           WK-SKJ-ZEIKEI2L  +
                           WK-SKJ-ZEI
               END-IF
      *
             WHEN        2
      *
               ADD     WK-NYULIFE-KAN-MONEY(IDY)
                                     TO  WK-SHOKUJI-RYOYOHI
                                         WK-SHOKUJI-RYOYOHIL
                                         WK-SHOKUJI-JIHI
                                         WK-SHOKUJI-RYOYOHIL2
               ADD     1             TO  LNK-SYU-SHOKUJI10-NISSU
               MOVE    WK-NYULIFE-KAN-MONEY(IDY)
                                     TO  LNK-SYU-SHOKUJI10
               IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                  COMPUTE   WK-SKJ-ZEI   =
                          (WK-NYULIFE-KAN-MONEY(IDY) * WK-S4)
                                                     + WK-S3
                 COMPUTE   WK-SKJ-ZEIKEI2L  =
                           WK-SKJ-ZEIKEI2L  +
                           WK-SKJ-ZEI
               END-IF
      *
           END-EVALUATE
      *
           IF   ( COMB-SYU-HKNKOHSBTKBN   =   "8"  OR  "9"   )
           OR   ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                             OR  "068"  OR  "069"  OR  "040" )
           OR   ((COMB-HKNNUM             =   SPACE         ) AND
                 (COMB-KOH1HKNNUM         =   "012" OR "025") AND
                 (COMB-KOH2HKNNUM         =   SPACE         ) AND
                 (COMB-KOH3HKNNUM         =   SPACE         ) AND
                 (COMB-KOH4HKNNUM         =   SPACE         ))
             ADD   WK-SHOKUJI-JIHI    TO   WK-SHOKUJI-FTN
                                           WK-SHOKUJI-FTNL
           ELSE
             ADD   WK-NYULIFE-KANFTN-MONEY(IDY)
                                      TO   WK-SHOKUJI-FTN
                                           WK-SHOKUJI-FTNL
                                           WK-SHOKUJI-FTNL2
             ADD   WK-NYULIFE-KANFTN-MONEY(IDY)
                                      TO   WK-DAY-SKJFTN(IDY)
                                           WK-DAY-SKJFTNL(IDY)
                                           WK-DAY-SKJFTNL2(IDY)
           END-IF
      *
           IF    FLG-SEIKATU   =  ZERO
               MOVE     2     TO      FLG-SEIKATU
           END-IF
           MOVE         1     TO      FLG-SEIKATUL
           MOVE         1     TO      FLG-SEIKATUL2
      *
           .
      *
       2304712-SHOKUJI-HEN201604X2-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¿©»öÎÅÍÜÈñÅù¤ÎÊÔ½¸¡ÊÊ¿À®£²£¸Ç¯£´·î¡Á¡Ë  £³              *
      ******************************************************************
       2304713-SHOKUJI-HEN201604X3-SEC    SECTION.
      *
           EVALUATE   WK-SHOKUJIRYOYO(IDY)
      *
             WHEN        1
      *
               PERFORM  VARYING  IDX23  FROM  1  BY  1
                         UNTIL   IDX23   >    3
                 EVALUATE  WK-SHOKUJI-AHY(IDY IDX23)
                   WHEN       1
                   WHEN       2
                     ADD     1                TO WK-SHOKUJI-NISSU
                                                 WK-SHOKUJI-NISSUS
                     ADD     WK-SHOKUJI-KINGAKU(1)
                                              TO WK-SHOKUJI-RYOYOHI
                                                 WK-SHOKUJI-RYOYOHIS
                                                 WK-SHOKUJI-JIHI
                     ADD     1                TO LNK-SYU-SHOKUJI1-NISSU
                     MOVE    WK-SHOKUJI-KINGAKU(1)
                                              TO LNK-SYU-SHOKUJI1
                     IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                       COMPUTE   WK-SKJ-ZEI   =
                                (WK-SHOKUJI-KINGAKU(1) * WK-S4)
                                                       + WK-S3
                       COMPUTE   WK-SKJ-ZEIKEI2  =
                                 WK-SKJ-ZEIKEI2  +
                                 WK-SKJ-ZEI
                     END-IF
                     IF    WK-SHOKUJI-AHY(IDY IDX23)  =  2
                         ADD     WK-SHOKUJI-KINGAKU(3)
                                              TO WK-SHOKUJI-RYOYOHI
                                                 WK-SHOKUJI-RYOYOHIS
                                                 WK-SHOKUJI-JIHI
                         ADD     1            TO LNK-SYU-SHOKUJI3-NISSU
                         MOVE    WK-SHOKUJI-KINGAKU(3)
                                              TO LNK-SYU-SHOKUJI3
                         IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                           COMPUTE   WK-SKJ-ZEI   =
                                    (WK-SHOKUJI-KINGAKU(3) * WK-S4)
                                                           + WK-S3
                           COMPUTE   WK-SKJ-ZEIKEI2  =
                                     WK-SKJ-ZEIKEI2  +
                                     WK-SKJ-ZEI
                         END-IF
                     END-IF
                   WHEN       3
                     ADD     1                TO WK-SHOKUJI-NISSU
                                                 WK-SHOKUJI-NISSUS
                     ADD     WK-SHOKUJI-KINGAKU(8)
                                              TO WK-SHOKUJI-RYOYOHI
                                                 WK-SHOKUJI-RYOYOHIS
                                                 WK-SHOKUJI-JIHI
                     ADD     1                TO LNK-SYU-SHOKUJI11-NISSU
                     MOVE    WK-SHOKUJI-KINGAKU(8)
                                              TO LNK-SYU-SHOKUJI11
                     IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                       COMPUTE   WK-SKJ-ZEI   =
                                (WK-SHOKUJI-KINGAKU(8) * WK-S4)
                                                       + WK-S3
                       COMPUTE   WK-SKJ-ZEIKEI2  =
                                 WK-SKJ-ZEIKEI2  +
                                 WK-SKJ-ZEI
                     END-IF
                 END-EVALUATE
               END-PERFORM
               IF   WK-SHOKUDOKASAN(IDY)     NOT =  ZERO
                     ADD     WK-SHOKUJI-KINGAKU(4)
                                              TO WK-SHOKUJI-RYOYOHI
                                                 WK-SHOKUJI-RYOYOHIS
                                                 WK-SHOKUJI-JIHI
                     ADD     1                TO LNK-SYU-SHOKUJI4-NISSU
                     MOVE    WK-SHOKUJI-KINGAKU(4)
                                              TO LNK-SYU-SHOKUJI4
                     IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                       COMPUTE   WK-SKJ-ZEI   =
                                (WK-SHOKUJI-KINGAKU(4) * WK-S4)
                                                       + WK-S3
                       COMPUTE   WK-SKJ-ZEIKEI2  =
                                 WK-SKJ-ZEIKEI2  +
                                 WK-SKJ-ZEI
                     END-IF
               END-IF
      *
             WHEN        2
      *
               PERFORM  VARYING  IDX23  FROM  1  BY  1
                         UNTIL   IDX23   >    3
                 EVALUATE  WK-SHOKUJI-AHY(IDY IDX23)
                   WHEN       1
                   WHEN       2
                     ADD     1                TO WK-SHOKUJI-NISSU
                                                 WK-SHOKUJI-NISSUS
                     ADD     WK-SHOKUJI-KINGAKU(2)
                                              TO WK-SHOKUJI-RYOYOHI
                                                 WK-SHOKUJI-RYOYOHIS
                                                 WK-SHOKUJI-JIHI
                     ADD     1                TO LNK-SYU-SHOKUJI2-NISSU
                     MOVE    WK-SHOKUJI-KINGAKU(2)
                                              TO LNK-SYU-SHOKUJI2
                     IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                       COMPUTE   WK-SKJ-ZEI   =
                                (WK-SHOKUJI-KINGAKU(2) * WK-S4)
                                                       + WK-S3
                       COMPUTE   WK-SKJ-ZEIKEI2  =
                                 WK-SKJ-ZEIKEI2  +
                                 WK-SKJ-ZEI
                     END-IF
                   WHEN       3
                     ADD     1                TO WK-SHOKUJI-NISSU
                                                 WK-SHOKUJI-NISSUS
                     ADD     WK-SHOKUJI-KINGAKU(9)
                                              TO WK-SHOKUJI-RYOYOHI
                                                 WK-SHOKUJI-RYOYOHIS
                                                 WK-SHOKUJI-JIHI
                     ADD     1                TO LNK-SYU-SHOKUJI12-NISSU
                     MOVE    WK-SHOKUJI-KINGAKU(9)
                                              TO LNK-SYU-SHOKUJI12
                     IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                       COMPUTE   WK-SKJ-ZEI   =
                                (WK-SHOKUJI-KINGAKU(9) * WK-S4)
                                                       + WK-S3
                       COMPUTE   WK-SKJ-ZEIKEI2  =
                                 WK-SKJ-ZEIKEI2  +
                                 WK-SKJ-ZEI
                     END-IF
                 END-EVALUATE
               END-PERFORM
      *
           END-EVALUATE
      *
           IF   ( COMB-SYU-HKNKOHSBTKBN   =   "8"  OR  "9"   )
           OR   ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                             OR  "068"  OR  "069"  OR  "040" )
           OR   ((COMB-HKNNUM             =   SPACE         ) AND
                 (COMB-KOH1HKNNUM         =   "012" OR "025") AND
                 (COMB-KOH2HKNNUM         =   SPACE         ) AND
                 (COMB-KOH3HKNNUM         =   SPACE         ) AND
                 (COMB-KOH4HKNNUM         =   SPACE         ))
             ADD   WK-SHOKUJI-JIHI    TO   WK-SHOKUJI-FTN
                                           WK-SHOKUJI-FTNS
           ELSE
             EVALUATE   WK-SYOTOKU-SKJKBN(IDY)
               WHEN       SPACE
                 EVALUATE  WK-SKJKEEP-KBN(IDY)
      *            É¸½àÉéÃ´³Û¡Ê°ìÈÌ¡Ë
                   WHEN     SPACE
                     COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(1)
                                          *  WK-SHOKUJI-NYUINJI(IDY)
      *            É¸½àÉéÃ´³Û¡Ê°ìÈÌ¡¦ÆñÉÂÅù¡Ë
                   WHEN     "1"
                     COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(5)
                                          *  WK-SHOKUJI-NYUINJI(IDY)
      *            É¸½àÉéÃ´³Û¡Ê°ìÈÌ¡¦Àº¿ÀÉÂ¾²¡Ë
                   WHEN     "2"
                     COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(6)
                                          *  WK-SHOKUJI-NYUINJI(IDY)
                 END-EVALUATE
                 ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                         WK-SHOKUJI-FTNS
                 MOVE    WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                         WK-DAY-SKJFTNS(IDY)
                 MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                      TO WK-DAY-KAISU(IDY)
                                         WK-DAY-KAISUS(IDY)
               WHEN       "1"
               WHEN       "4"
      *          É¸½àÉéÃ´³Û¡ÊÄã£±¡Ë
                 COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(2)
                                      *  WK-SHOKUJI-NYUINJI(IDY)
                 ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                         WK-SHOKUJI-FTNS
                 MOVE    WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                         WK-DAY-SKJFTNS(IDY)
                 MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                      TO WK-DAY-KAISU(IDY)
                                         WK-DAY-KAISUS(IDY)
               WHEN       "2"
      *          É¸½àÉéÃ´³Û¡ÊÄã£²¡¦£¹£°Æü°Ê²¼¡Ë
                 COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(3)
                                      *  WK-SHOKUJI-NYUINJI(IDY)
                 ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                         WK-SHOKUJI-FTNS
                 MOVE    WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                         WK-DAY-SKJFTNS(IDY)
                 MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                      TO WK-DAY-KAISU(IDY)
                                         WK-DAY-KAISUS(IDY)
               WHEN       "3"
      *          É¸½àÉéÃ´³Û¡ÊÄã£²¡¦£¹£°ÆüÄ¶¡Ë
                 COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(4)
                                      *  WK-SHOKUJI-NYUINJI(IDY)
                 ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                         WK-SHOKUJI-FTNS
                 MOVE    WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                         WK-DAY-SKJFTNS(IDY)
                 MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                      TO WK-DAY-KAISU(IDY)
                                         WK-DAY-KAISUS(IDY)
             END-EVALUATE
           END-IF
      *
           IF    FLG-SEIKATU   =  ZERO
               MOVE     1     TO      FLG-SEIKATU
           END-IF
           MOVE         1     TO      FLG-SEIKATUS
      *
           .
      *
       2304713-SHOKUJI-HEN201604X3-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÆÃÊÌ¿©ÊÔ½¸¡Ê¿ÇÎÅ¹Ô°ÙÆþÎÏÊ¬¡Ë                            *
      ******************************************************************
       2304714-SHOKUJI-HENSINTOKU-SEC    SECTION.
      *
           IF     WK-NYULIFE-KBN(IDY)   NOT =   SPACE
             IF         WK-ROSAITOKU95(IDY)  NOT =  ZERO
      *        É¸½àÉéÃ´³Û¡ÊÏ«ºÒÆþ±¡Ãæ¡Ë
               COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(5)
                                    *  WK-ROSAITOKU95(IDY)
               ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI95L
                                       WK-SHOKUJI-FTN95L
             END-IF
             IF         WK-ROSAITOKU96(IDY)  NOT =  ZERO
      *        É¸½àÉéÃ´³Û¡ÊÏ«ºÒÆþ±¡Ãæ¡Ë
               IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                 COMPUTE   WK-SKJ-ZEI   =
                          (WK-SHOKUJI-KINGAKU(5) * WK-S4)
                                                 + WK-S3
                 COMPUTE   WK-SKJ-ZEIKEIL  =
                           WK-SKJ-ZEIKEIL  +
                          (WK-SKJ-ZEI   *  WK-ROSAITOKU96(IDY))
               END-IF
               COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(5)
                                    *  WK-ROSAITOKU96(IDY)
               ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI96L
                                       WK-SHOKUJI-FTN96L
             END-IF
             MOVE     ZERO     TO      WK-SHOKUJI-JIHI
             IF    LNK-S02-SKJHKN-HKNCOMBI(IDY)         = SPACE
             AND   LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY)     = SPACE
             AND   LNK-S02-SKJHKN-HKNCOMBI-DOU-XXX(IDY) = SPACE
                IF   WK-ROSAITOKU97(IDY)  >  3
                  MOVE     3      TO    WK-ROSAITOKU97(IDY)
                END-IF
                IF   (LNK-S02-NYUSANTEI-KBN(IDY)    =  "1" )
                AND  (WK-SHOKUJIRYOYO(IDY)          =   1  )
                AND  ((WK-GAIHAKU(IDY)      =  ZERO       ) OR
                      (WK-GAIHAKU(IDY)     >=   4         ))
                AND  (WK-SHOKUJI-NYUINJI2(IDY)  NOT =  ZERO)
                  IF  WK-SHOKUJI-NYUINJI2(IDY) < WK-ROSAITOKU97(IDY)
                    MOVE  WK-SHOKUJI-NYUINJI2(IDY)
                                  TO    WK-ROSAITOKU97(IDY)
                  END-IF
                  COMPUTE  WK-TOKUSYOKU-SURYOU      =
                           WK-SHOKUJI-NYUINJI2(IDY) -
                           WK-SHOKUJI-TOKUSYO(IDY)
                  IF  WK-TOKUSYOKU-SURYOU < WK-ROSAITOKU97(IDY)
                    MOVE  WK-TOKUSYOKU-SURYOU
                                  TO    WK-ROSAITOKU97(IDY)
                  END-IF
                ELSE
                  MOVE     ZERO   TO    WK-ROSAITOKU97(IDY)
                END-IF
             END-IF
             IF         WK-ROSAITOKU97(IDY)  NOT =  ZERO
      *         É¸½àÉéÃ´³Û¡ÊÏ«ºÒÆþ±¡Ãæ¡Ë
                IF    LNK-S02-KOREI-TANYUIN      =  "1"
                  ADD     WK-ROSAITOKU97(IDY)
                                          TO  WK-SHOKUJI-NISSU
                                              WK-SHOKUJI-NISSUL
                END-IF
                COMPUTE WK-KEISAN-XX  =  WK-SHOKUJI-KINGAKU(5)
                                      *  WK-ROSAITOKU97(IDY)
                ADD     WK-KEISAN-XX      TO  WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIL
                                              WK-SHOKUJI-JIHI
                ADD     WK-ROSAITOKU97(IDY)
                                          TO  LNK-SYU-SHOKUJI7-NISSU
                MOVE    WK-SHOKUJI-KINGAKU(5)
                                          TO  LNK-SYU-SHOKUJI7
                IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                  COMPUTE   WK-SKJ-ZEI   =
                           (WK-SHOKUJI-KINGAKU(5) * WK-S4)
                                                  + WK-S3
                  COMPUTE   WK-SKJ-ZEIKEI2L =
                            WK-SKJ-ZEIKEI2L +
                           (WK-SKJ-ZEI   *  WK-ROSAITOKU97(IDY))
                END-IF
                IF ( COMB-SYU-HKNKOHSBTKBN   =   "8"  OR  "9"   )
                OR ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                                OR  "068"  OR  "069"  OR  "040" )
                  ADD   WK-SHOKUJI-JIHI   TO  WK-SHOKUJI-FTN
                                              WK-SHOKUJI-FTNL
                END-IF
                IF    FLG-SEIKATU   =  ZERO
                      MOVE    2     TO    FLG-SEIKATU
                END-IF
                MOVE          1     TO    FLG-SEIKATUL
             END-IF
           ELSE
             IF         WK-ROSAITOKU95(IDY)  NOT =  ZERO
      *        É¸½àÉéÃ´³Û¡ÊÏ«ºÒÆþ±¡Ãæ¡Ë
               COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(5)
                                    *  WK-ROSAITOKU95(IDY)
               ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI95
                                       WK-SHOKUJI-FTN95
             END-IF
             IF         WK-ROSAITOKU96(IDY)  NOT =  ZERO
      *        É¸½àÉéÃ´³Û¡ÊÏ«ºÒÆþ±¡Ãæ¡Ë
               IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                 COMPUTE   WK-SKJ-ZEI   =
                          (WK-SHOKUJI-KINGAKU(5) * WK-S4)
                                                 + WK-S3
                 COMPUTE   WK-SKJ-ZEIKEI   =
                           WK-SKJ-ZEIKEI   +
                          (WK-SKJ-ZEI   *  WK-ROSAITOKU96(IDY))
               END-IF
               COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(5)
                                    *  WK-ROSAITOKU96(IDY)
               ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI96
                                       WK-SHOKUJI-FTN96
             END-IF
             MOVE     ZERO     TO      WK-SHOKUJI-JIHI
             IF    LNK-S02-SKJHKN-HKNCOMBI(IDY)         = SPACE
             AND   LNK-S02-SKJHKN-HKNCOMBI-DOU(IDY)     = SPACE
             AND   LNK-S02-SKJHKN-HKNCOMBI-DOU-XXX(IDY) = SPACE
                IF   WK-ROSAITOKU97(IDY)  >  3
                  MOVE     3      TO    WK-ROSAITOKU97(IDY)
                END-IF
                IF   (LNK-S02-NYUSANTEI-KBN(IDY)    =  "1" )
                AND  (WK-SHOKUJIRYOYO(IDY)          =   1  )
                AND  ((WK-GAIHAKU(IDY)      =  ZERO       ) OR
                      (WK-GAIHAKU(IDY)     >=   4         ))
                AND  (WK-SHOKUJI-NYUINJI2(IDY)  NOT =  ZERO)
                  IF  WK-SHOKUJI-NYUINJI2(IDY) < WK-ROSAITOKU97(IDY)
                    MOVE  WK-SHOKUJI-NYUINJI2(IDY)
                                  TO    WK-ROSAITOKU97(IDY)
                  END-IF
                  COMPUTE  WK-TOKUSYOKU-SURYOU      =
                           WK-SHOKUJI-NYUINJI2(IDY) -
                           WK-SHOKUJI-TOKUSYO(IDY)
                  IF  WK-TOKUSYOKU-SURYOU < WK-ROSAITOKU97(IDY)
                    MOVE  WK-TOKUSYOKU-SURYOU
                                  TO    WK-ROSAITOKU97(IDY)
                  END-IF
                ELSE
                  MOVE     ZERO   TO    WK-ROSAITOKU97(IDY)
                END-IF
             END-IF
             IF         WK-ROSAITOKU97(IDY)  NOT =  ZERO
      *         É¸½àÉéÃ´³Û¡ÊÏ«ºÒÆþ±¡Ãæ¡Ë
                IF    LNK-S02-KOREI-TANYUIN      =  "1"
                  ADD     WK-ROSAITOKU97(IDY)
                                          TO  WK-SHOKUJI-NISSU
                                              WK-SHOKUJI-NISSUS
                END-IF
                COMPUTE WK-KEISAN-XX  =  WK-SHOKUJI-KINGAKU(5)
                                      *  WK-ROSAITOKU97(IDY)
                ADD     WK-KEISAN-XX      TO  WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIS
                                              WK-SHOKUJI-JIHI
                ADD     WK-ROSAITOKU97(IDY)
                                          TO  LNK-SYU-SHOKUJI3-NISSU
                MOVE    WK-SHOKUJI-KINGAKU(5)
                                          TO  LNK-SYU-SHOKUJI3
                IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                  COMPUTE   WK-SKJ-ZEI   =
                           (WK-SHOKUJI-KINGAKU(5) * WK-S4)
                                                  + WK-S3
                  COMPUTE   WK-SKJ-ZEIKEI2  =
                            WK-SKJ-ZEIKEI2  +
                           (WK-SKJ-ZEI   *  WK-ROSAITOKU97(IDY))
                END-IF
                IF ( COMB-SYU-HKNKOHSBTKBN   =   "8"  OR  "9"   )
                OR ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                                OR  "068"  OR  "069"  OR  "040" )
                  ADD   WK-SHOKUJI-JIHI   TO  WK-SHOKUJI-FTN
                                              WK-SHOKUJI-FTNS
                END-IF
                IF    FLG-SEIKATU   =  ZERO
                      MOVE    1     TO    FLG-SEIKATU
                END-IF
                MOVE          1     TO    FLG-SEIKATUS
             END-IF
           END-IF
      *
           .
      *
       2304714-SHOKUJI-HENSINTOKU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¿©»öÎÅÍÜÈñÅù¤ÎÊÔ½¸                                      *
      ******************************************************************
       230472-SHOKUJI-HEN200604-SEC         SECTION.
      *
           MOVE       ZERO        TO  FLG-SEIKATU
           MOVE       ZERO        TO  FLG-SEIKATUS
           MOVE       ZERO        TO  FLG-SEIKATUL
           MOVE       ZERO        TO  FLG-SEIKATUL2
      **
           MOVE       LNK-SYU-SKYSTYMD(7:2)  TO   IDX-ST
           MOVE       LNK-SYU-SKYEDYMD(7:2)  TO   IDX-ED
      *
           PERFORM    VARYING   IDY   FROM   IDX-ST   BY   1
                       UNTIL    IDY     >    IDX-ED
      *
             MOVE     ZERO     TO      WK-SHOKUJI-JIHI
      *
             IF     WK-NYULIFE-KBN(IDY)   NOT =   SPACE
      *
      *       Æþ±¡»þÀ¸³èÎÅÍÜ¡Ê¿©»ö¡Ë
              IF       ( WK-SHOKUJI-NYUINJI(IDY)   NOT =  ZERO )
              AND      ((LNK-SYU-DAY(IDY)       =  "1" OR "9" ) OR
                        (LNK-S02-NYUINDAY-KBN(IDY)     =  "1" ))
              AND      ( LNK-S02-NYUSANTEI-KBN(IDY)    =  "1"  )
              AND      ((WK-GAIHAKU(IDY)        =  ZERO       ) OR
                        (WK-GAIHAKU(IDY)       >=   4         ))
      *
               IF    LNK-SYU-SYUHKNNUM   =   "971" OR "973"
                 EVALUATE  LNK-SYU-SYUHKNNUM
                  WHEN       "971"
                    IF   FLG-KENPOJYUNKYO  =  ZERO
                      COMPUTE   WK-KEISAN  =   WK-NYULIFE-SKJ-MONEY(IDY)
                                           *   1.2
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                      MOVE      WK-KEISAN  TO  WK-NYULIFE-SKJ-MONEY(IDY)
                    END-IF
                  WHEN       "973"
                    IF   FLG-KENPOJYUNKYO  =  ZERO
                      COMPUTE   WK-KEISAN  =   WK-NYULIFE-SKJ-MONEY(IDY)
                                           *   1.2
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                      IF   WK-4001-SKJKBN  =   "2"
                       COMPUTE  WK-KEISAN  =   WK-KEISAN  *  1.2
                      END-IF
                      MOVE    WK-KEISAN    TO  WK-NYULIFE-SKJ-MONEY(IDY)
                    END-IF
                 END-EVALUATE
               END-IF
      *
               EVALUATE   WK-SHOKUJIRYOYO(IDY)
      *
                WHEN        1
      *
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO WK-SHOKUJI-NISSU
                                              WK-SHOKUJI-NISSUL
                  COMPUTE WK-KEISAN-XX     =  WK-NYULIFE-SKJ-MONEY(IDY)
                                           *  WK-SHOKUJI-NYUINJI(IDY)
                  ADD     WK-KEISAN-XX     TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIL
                                              WK-SHOKUJI-JIHI
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO LNK-SYU-SHOKUJI5-NISSU
                  MOVE    WK-NYULIFE-SKJ-MONEY(IDY)
                                           TO LNK-SYU-SHOKUJI5
                  IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                    COMPUTE   WK-SKJ-ZEI   =
                             (WK-NYULIFE-SKJ-MONEY(IDY) * WK-S4)
                                                        + WK-S3
                    COMPUTE   WK-SKJ-ZEIKEI2L  =
                              WK-SKJ-ZEIKEI2L  +
                             (WK-SKJ-ZEI   *  WK-SHOKUJI-NYUINJI(IDY))
                  END-IF
      *
                  IF   WK-SHOKUJI-TOKUSYO(IDY)  NOT = ZERO
                      COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(6)
                                           *  WK-SHOKUJI-TOKUSYO(IDY)
                      ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIL
                                              WK-SHOKUJI-JIHI
                      ADD     WK-SHOKUJI-TOKUSYO(IDY)
                                           TO LNK-SYU-SHOKUJI7-NISSU
                      MOVE    WK-SHOKUJI-KINGAKU(6)
                                           TO LNK-SYU-SHOKUJI7
                      IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                        COMPUTE   WK-SKJ-ZEI   =
                                 (WK-SHOKUJI-KINGAKU(6) * WK-S4)
                                                        + WK-S3
                        COMPUTE   WK-SKJ-ZEIKEI2L  =
                                  WK-SKJ-ZEIKEI2L  +
                                 (WK-SKJ-ZEI * WK-SHOKUJI-TOKUSYO(IDY))
                      END-IF
                  END-IF
      *
                  IF   WK-SHOKUDOKASAN(IDY)     NOT =  ZERO
                      COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(7)
                      ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIL
                                              WK-SHOKUJI-JIHI
                      ADD     1            TO LNK-SYU-SHOKUJI8-NISSU
                      MOVE    WK-SHOKUJI-KINGAKU(7)
                                           TO LNK-SYU-SHOKUJI8
                      IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                        COMPUTE   WK-SKJ-ZEI   =
                                 (WK-SHOKUJI-KINGAKU(7) * WK-S4)
                                                        + WK-S3
                        COMPUTE   WK-SKJ-ZEIKEI2L  =
                                  WK-SKJ-ZEIKEI2L  +
                                  WK-SKJ-ZEI
                      END-IF
                  END-IF
      *
                WHEN        2
      *
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO WK-SHOKUJI-NISSU
                                              WK-SHOKUJI-NISSUL
                  COMPUTE WK-KEISAN-XX     =  WK-NYULIFE-SKJ-MONEY(IDY)
                                           *  WK-SHOKUJI-NYUINJI(IDY)
                  ADD     WK-KEISAN-XX     TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIL
                                              WK-SHOKUJI-JIHI
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO LNK-SYU-SHOKUJI6-NISSU
                  MOVE    WK-NYULIFE-SKJ-MONEY(IDY)
                                           TO LNK-SYU-SHOKUJI6
                  IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                    COMPUTE   WK-SKJ-ZEI   =
                             (WK-NYULIFE-SKJ-MONEY(IDY) * WK-S4)
                                                        + WK-S3
                    COMPUTE   WK-SKJ-ZEIKEI2L  =
                              WK-SKJ-ZEIKEI2L  +
                             (WK-SKJ-ZEI   *  WK-SHOKUJI-NYUINJI(IDY))
                  END-IF
      *
               END-EVALUATE
      *
               IF   ( COMB-SYU-HKNKOHSBTKBN   =   "8"  OR  "9"   )
               OR   ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                                 OR  "068"  OR  "069"  OR  "040" )
               OR   ((COMB-HKNNUM             =   SPACE         ) AND
                     (COMB-KOH1HKNNUM         =   "012" OR "025") AND
                     (COMB-KOH2HKNNUM         =   SPACE         ) AND
                     (COMB-KOH3HKNNUM         =   SPACE         ) AND
                     (COMB-KOH4HKNNUM         =   SPACE         ))
                 ADD   WK-SHOKUJI-JIHI    TO   WK-SHOKUJI-FTN
                                               WK-SHOKUJI-FTNL
               ELSE
                 COMPUTE WK-KEISAN-XX =  WK-NYULIFE-SKJFTN-MONEY(IDY)
                                      *  WK-SHOKUJI-NYUINJI(IDY)
                 ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                         WK-SHOKUJI-FTNL
                 ADD     WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                         WK-DAY-SKJFTNL(IDY)
                 MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                      TO WK-DAY-KAISU(IDY)
                                         WK-DAY-KAISUL(IDY)
               END-IF
               IF    FLG-SEIKATU   =  ZERO
                   MOVE     2     TO      FLG-SEIKATU
               END-IF
               MOVE         1     TO      FLG-SEIKATUL
      *
              END-IF
      *
      *       Æþ±¡»þÀ¸³èÎÅÍÜ¡Ê´Ä¶­¡Ë
              MOVE     ZERO     TO      WK-SHOKUJI-JIHI
              IF       ((LNK-SYU-DAY(IDY)       =  "1" OR "9" ) OR
                        (LNK-S02-NYUINDAY-KBN(IDY)     =  "1" ))
              AND      ( LNK-S02-NYUSANTEI-KBN(IDY)    =  "1"  )
              AND      ((WK-GAIHAKU(IDY)        =  ZERO       ) OR
                        (WK-GAIHAKU(IDY)       >=   4         ))
              AND      ( WK-SHOKUJI-KANFLG(IDY) =  ZERO        )
      *
                IF    LNK-SYU-SYUHKNNUM   =   "971" OR "973"
                 EVALUATE  LNK-SYU-SYUHKNNUM
                  WHEN       "971"
                    IF   FLG-KENPOJYUNKYO  =  ZERO
                      COMPUTE   WK-KEISAN  =   WK-NYULIFE-KAN-MONEY(IDY)
                                           *   1.2
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                      MOVE      WK-KEISAN  TO  WK-NYULIFE-KAN-MONEY(IDY)
                    END-IF
                  WHEN       "973"
                    IF   FLG-KENPOJYUNKYO  =  ZERO
                      COMPUTE   WK-KEISAN  =   WK-NYULIFE-KAN-MONEY(IDY)
                                           *   1.2
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                      IF   WK-4001-SKJKBN  =   "2"
                       COMPUTE  WK-KEISAN  =   WK-KEISAN  *  1.2
                      END-IF
                      MOVE    WK-KEISAN    TO  WK-NYULIFE-KAN-MONEY(IDY)
                    END-IF
                 END-EVALUATE
                END-IF
      *
                EVALUATE   WK-SHOKUJIRYOYO(IDY)
      *
                 WHEN        1
      *
                  COMPUTE WK-KEISAN-XX  =   WK-NYULIFE-KAN-MONEY(IDY)
                  ADD     WK-KEISAN-XX  TO  WK-SHOKUJI-RYOYOHI
                                            WK-SHOKUJI-RYOYOHIL
                                            WK-SHOKUJI-JIHI
                                            WK-SHOKUJI-RYOYOHIL2
                  ADD     1             TO  LNK-SYU-SHOKUJI9-NISSU
                  MOVE    WK-NYULIFE-KAN-MONEY(IDY)
                                        TO  LNK-SYU-SHOKUJI9
                  IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                    COMPUTE   WK-SKJ-ZEI   =
                             (WK-NYULIFE-KAN-MONEY(IDY) * WK-S4)
                                                        + WK-S3
                    COMPUTE   WK-SKJ-ZEIKEI2L  =
                              WK-SKJ-ZEIKEI2L  +
                              WK-SKJ-ZEI
                  END-IF
      *
                 WHEN        2
      *
                  COMPUTE WK-KEISAN-XX  =   WK-NYULIFE-KAN-MONEY(IDY)
                  ADD     WK-KEISAN-XX  TO  WK-SHOKUJI-RYOYOHI
                                            WK-SHOKUJI-RYOYOHIL
                                            WK-SHOKUJI-JIHI
                                            WK-SHOKUJI-RYOYOHIL2
                  ADD     1             TO  LNK-SYU-SHOKUJI10-NISSU
                  MOVE    WK-NYULIFE-KAN-MONEY(IDY)
                                        TO  LNK-SYU-SHOKUJI10
                  IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                    COMPUTE   WK-SKJ-ZEI   =
                             (WK-NYULIFE-KAN-MONEY(IDY) * WK-S4)
                                                        + WK-S3
                    COMPUTE   WK-SKJ-ZEIKEI2L  =
                              WK-SKJ-ZEIKEI2L  +
                              WK-SKJ-ZEI
                  END-IF
      *
                END-EVALUATE
      *
                IF   ( COMB-SYU-HKNKOHSBTKBN   =   "8"  OR  "9"   )
                OR   ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                                  OR  "068"  OR  "069"  OR  "040" )
                OR   ((COMB-HKNNUM             =   SPACE         ) AND
                      (COMB-KOH1HKNNUM         =   "012" OR "025") AND
                      (COMB-KOH2HKNNUM         =   SPACE         ) AND
                      (COMB-KOH3HKNNUM         =   SPACE         ) AND
                      (COMB-KOH4HKNNUM         =   SPACE         ))
                  ADD   WK-SHOKUJI-JIHI    TO   WK-SHOKUJI-FTN
                                                WK-SHOKUJI-FTNL
                ELSE
                  COMPUTE WK-KEISAN-XX =  WK-NYULIFE-KANFTN-MONEY(IDY)
                  ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                          WK-SHOKUJI-FTNL
                                          WK-SHOKUJI-FTNL2
                  ADD     WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                          WK-DAY-SKJFTNL(IDY)
                                          WK-DAY-SKJFTNL2(IDY)
                END-IF
                IF   FLG-SEIKATU   =  ZERO
                   MOVE     2     TO      FLG-SEIKATU
                END-IF
                MOVE        1     TO      FLG-SEIKATUL
                MOVE        1     TO      FLG-SEIKATUL2
      *
              END-IF
      *
             ELSE
      *
              IF       ( WK-SHOKUJI-NYUINJI(IDY)   NOT =  ZERO )
              AND      ((LNK-SYU-DAY(IDY)       =  "1" OR "9" ) OR
                        (LNK-S02-NYUINDAY-KBN(IDY)     =  "1" ))
              AND      ( LNK-S02-NYUSANTEI-KBN(IDY)    =  "1"  )
              AND      ((WK-GAIHAKU(IDY)        =  ZERO       ) OR
                        (WK-GAIHAKU(IDY)       >=   4         ))
      *
               EVALUATE   WK-SHOKUJIRYOYO(IDY)
      *
                WHEN        1
      *
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO WK-SHOKUJI-NISSU
                                              WK-SHOKUJI-NISSUS
                  COMPUTE WK-KEISAN-XX     =  WK-SHOKUJI-KINGAKU(1)
                                           *  WK-SHOKUJI-NYUINJI(IDY)
                  ADD     WK-KEISAN-XX     TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIS
                                              WK-SHOKUJI-JIHI
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO LNK-SYU-SHOKUJI1-NISSU
                  MOVE    WK-SHOKUJI-KINGAKU(1)
                                           TO LNK-SYU-SHOKUJI1
                  IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                    COMPUTE   WK-SKJ-ZEI   =
                             (WK-SHOKUJI-KINGAKU(1) * WK-S4)
                                                    + WK-S3
                    COMPUTE   WK-SKJ-ZEIKEI2  =
                              WK-SKJ-ZEIKEI2  +
                             (WK-SKJ-ZEI   *  WK-SHOKUJI-NYUINJI(IDY))
                  END-IF
      *
                  IF   WK-SHOKUJI-TOKUSYO(IDY)  NOT = ZERO
                      COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(3)
                                           *  WK-SHOKUJI-TOKUSYO(IDY)
                      ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIS
                                              WK-SHOKUJI-JIHI
                      ADD     WK-SHOKUJI-TOKUSYO(IDY)
                                           TO LNK-SYU-SHOKUJI3-NISSU
                      MOVE    WK-SHOKUJI-KINGAKU(3)
                                           TO LNK-SYU-SHOKUJI3
                      IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                        COMPUTE   WK-SKJ-ZEI   =
                                 (WK-SHOKUJI-KINGAKU(3) * WK-S4)
                                                        + WK-S3
                        COMPUTE   WK-SKJ-ZEIKEI2  =
                                  WK-SKJ-ZEIKEI2  +
                                 (WK-SKJ-ZEI * WK-SHOKUJI-TOKUSYO(IDY))
                      END-IF
                  END-IF
      *
                  IF   WK-SHOKUDOKASAN(IDY)     NOT =  ZERO
                      COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-KINGAKU(4)
                      ADD     WK-KEISAN-XX TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIS
                                              WK-SHOKUJI-JIHI
                      ADD     1            TO LNK-SYU-SHOKUJI4-NISSU
                      MOVE    WK-SHOKUJI-KINGAKU(4)
                                           TO LNK-SYU-SHOKUJI4
                      IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                        COMPUTE   WK-SKJ-ZEI   =
                                 (WK-SHOKUJI-KINGAKU(4) * WK-S4)
                                                        + WK-S3
                        COMPUTE   WK-SKJ-ZEIKEI2  =
                                  WK-SKJ-ZEIKEI2  +
                                  WK-SKJ-ZEI
                      END-IF
                  END-IF
      *
                WHEN        2
      *
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO WK-SHOKUJI-NISSU
                                              WK-SHOKUJI-NISSUS
                  COMPUTE WK-KEISAN-XX     =  WK-SHOKUJI-KINGAKU(2)
                                           *  WK-SHOKUJI-NYUINJI(IDY)
                  ADD     WK-KEISAN-XX     TO WK-SHOKUJI-RYOYOHI
                                              WK-SHOKUJI-RYOYOHIS
                                              WK-SHOKUJI-JIHI
                  ADD     WK-SHOKUJI-NYUINJI(IDY)
                                           TO LNK-SYU-SHOKUJI2-NISSU
                  MOVE    WK-SHOKUJI-KINGAKU(2)
                                           TO LNK-SYU-SHOKUJI2
                  IF    LNK-SYU-SRYYMD(1:6)   >=   "200704"
                    COMPUTE   WK-SKJ-ZEI   =
                             (WK-SHOKUJI-KINGAKU(2) * WK-S4)
                                                    + WK-S3
                    COMPUTE   WK-SKJ-ZEIKEI2  =
                              WK-SKJ-ZEIKEI2  +
                             (WK-SKJ-ZEI   *  WK-SHOKUJI-NYUINJI(IDY))
                  END-IF
      *
               END-EVALUATE
      *
               IF   ( COMB-SYU-HKNKOHSBTKBN   =   "8"  OR  "9"   )
               OR   ( COMB-HKNNUM =  "971"  OR  "973"  OR  "975"
                                 OR  "068"  OR  "069"  OR  "040" )
               OR   ((COMB-HKNNUM             =   SPACE         ) AND
                     (COMB-KOH1HKNNUM         =   "012" OR "025") AND
                     (COMB-KOH2HKNNUM         =   SPACE         ) AND
                     (COMB-KOH3HKNNUM         =   SPACE         ) AND
                     (COMB-KOH4HKNNUM         =   SPACE         ))
                ADD   WK-SHOKUJI-JIHI    TO   WK-SHOKUJI-FTN
                                              WK-SHOKUJI-FTNS
               ELSE
                EVALUATE   WK-SYOTOKU-SKJKBN(IDY)
                  WHEN       SPACE
      *              É¸½àÉéÃ´³Û¡Ê°ìÈÌ¡Ë
                     COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(1)
                                          *  WK-SHOKUJI-NYUINJI(IDY)
                     ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                             WK-SHOKUJI-FTNS
                     MOVE    WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                             WK-DAY-SKJFTNS(IDY)
                     MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                          TO WK-DAY-KAISU(IDY)
                                             WK-DAY-KAISUS(IDY)
                  WHEN       "1"
                  WHEN       "4"
      *              É¸½àÉéÃ´³Û¡ÊÄã£±¡Ë
                     COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(2)
                                          *  WK-SHOKUJI-NYUINJI(IDY)
                     ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                             WK-SHOKUJI-FTNS
                     MOVE    WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                             WK-DAY-SKJFTNS(IDY)
                     MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                          TO WK-DAY-KAISU(IDY)
                                             WK-DAY-KAISUS(IDY)
                  WHEN       "2"
      *              É¸½àÉéÃ´³Û¡ÊÄã£²¡¦£¹£°Æü°Ê²¼¡Ë
                     COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(3)
                                          *  WK-SHOKUJI-NYUINJI(IDY)
                     ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                             WK-SHOKUJI-FTNS
                     MOVE    WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                             WK-DAY-SKJFTNS(IDY)
                     MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                          TO WK-DAY-KAISU(IDY)
                                             WK-DAY-KAISUS(IDY)
                  WHEN       "3"
      *              É¸½àÉéÃ´³Û¡ÊÄã£²¡¦£¹£°ÆüÄ¶¡Ë
                     COMPUTE WK-KEISAN-XX =  WK-SHOKUJI-HYOJYUNFTN(4)
                                          *  WK-SHOKUJI-NYUINJI(IDY)
                     ADD     WK-KEISAN-XX TO WK-SHOKUJI-FTN
                                             WK-SHOKUJI-FTNS
                     MOVE    WK-KEISAN-XX TO WK-DAY-SKJFTN(IDY)
                                             WK-DAY-SKJFTNS(IDY)
                     MOVE    WK-SHOKUJI-NYUINJI(IDY)
                                          TO WK-DAY-KAISU(IDY)
                                             WK-DAY-KAISUS(IDY)
                END-EVALUATE
               END-IF
               IF    FLG-SEIKATU   =  ZERO
                   MOVE     1     TO      FLG-SEIKATU
               END-IF
               MOVE         1     TO      FLG-SEIKATUS
      *
              END-IF
      *
             END-IF
      *
      *      ÆÃÊÌ¿©ÊÔ½¸¡Ê¿ÇÎÅ¹Ô°ÙÆþÎÏÊ¬¡Ë
             PERFORM        2304714-SHOKUJI-HENSINTOKU-SEC
      *
           END-PERFORM
      *
           .
      *
       230472-SHOKUJI-HEN200604-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¥·¥¹¥Æ¥à´ÉÍý£µ£°£°£°¡Ý¡ÖÆþ±¡»þ¿©»öÎÅÍÜ¡×Ì¤ÀßÄê»þ¤Î
      *        ¿©»öÎÅÍÜÈñÅù¤Î»»Äê¥Á¥§¥Ã¥¯
      ******************************************************************
       23048-SHOKUJI-CHECK-SEC         SECTION.
      *
           MOVE       LNK-SYU-SKYSTYMD(7:2)  TO   IDX-ST
           MOVE       LNK-SYU-SKYEDYMD(7:2)  TO   IDX-ED
      *
           PERFORM    VARYING   IDX25   FROM   IDX-ST   BY   1
                       UNTIL    IDX25     >    IDX-ED
      *
             IF     WK-NYULIFE-KBN(IDX25)   NOT =   SPACE
               IF   LNK-S02-SKJHKN-HKNCOMBI(IDX25)     = SPACE
               AND  LNK-S02-SKJHKN-HKNCOMBI-DOU(IDX25) = SPACE
      *          Æþ±¡»þÀ¸³èÎÅÍÜ¡Ê¿©»ö¡Ë
                 IF   ( WK-SHOKUJI-NYUINJI(IDX25)   NOT =  ZERO )
                 AND  ((LNK-SYU-DAY(IDX25)       =  "1" OR "9" ) OR
                       (LNK-S02-NYUINDAY-KBN(IDX25)     =  "1" ))
                 AND  ( LNK-S02-NYUSANTEI-KBN(IDX25)    =  "1"  )
                 AND  ((WK-GAIHAKU(IDX25)        =  ZERO       ) OR
                       (WK-GAIHAKU(IDX25)       >=   4         ))
                    MOVE    33      TO   LNK-S02-RC
                 END-IF
      *          Æþ±¡»þÀ¸³èÎÅÍÜ¡Ê´Ä¶­¡Ë
                 IF   ((LNK-SYU-DAY(IDX25)       =  "1" OR "9" ) OR
                       (LNK-S02-NYUINDAY-KBN(IDX25)     =  "1" ))
                 AND  ( LNK-S02-NYUSANTEI-KBN(IDX25)    =  "1"  )
                 AND  ((WK-GAIHAKU(IDX25)        =  ZERO       ) OR
                       (WK-GAIHAKU(IDX25)       >=   4         ))
                 AND  ( WK-SHOKUJI-KANFLG(IDX25) =  ZERO        )
                    MOVE    33      TO   LNK-S02-RC
                 END-IF
               ELSE
      *          Æþ±¡»þÀ¸³èÎÅÍÜ¡Ê¿©»ö¡Ë
                 IF   ( WK-SHOKUJI-NYUINJI(IDX25)   NOT =  ZERO )
                 AND  ((LNK-SYU-DAY(IDX25)       =  "1" OR "9" ) OR
                       (LNK-S02-NYUINDAY-KBN(IDX25)     =  "1" ) OR
                       (WK-SKJHKN-SANTEIFLG(IDX25)      =  "1" ))
                 AND  ( LNK-S02-NYUSANTEI-KBN(IDX25)    =  "1"  )
                 AND  ((WK-GAIHAKU(IDX25)        =  ZERO       ) OR
                       (WK-GAIHAKU(IDX25)       >=   4         ))
                    MOVE    33      TO   LNK-S02-RC
                 END-IF
      *          Æþ±¡»þÀ¸³èÎÅÍÜ¡Ê´Ä¶­¡Ë
                 IF   ((LNK-SYU-DAY(IDX25)       =  "1" OR "9" ) OR
                       (LNK-S02-NYUINDAY-KBN(IDX25)     =  "1" ) OR
                       (WK-SKJHKN-SANTEIFLG(IDX25)      =  "1" ))
                 AND  ( LNK-S02-NYUSANTEI-KBN(IDX25)    =  "1"  )
                 AND  ((WK-GAIHAKU(IDX25)        =  ZERO       ) OR
                       (WK-GAIHAKU(IDX25)       >=   4         ))
                 AND  ( WK-SHOKUJI-KANFLG(IDX25) =  ZERO        )
                    MOVE    33      TO   LNK-S02-RC
                 END-IF
               END-IF
             ELSE
               IF   LNK-S02-SKJHKN-HKNCOMBI(IDX25)     = SPACE
               AND  LNK-S02-SKJHKN-HKNCOMBI-DOU(IDX25) = SPACE
                 IF   ( WK-SHOKUJI-NYUINJI(IDX25)   NOT =  ZERO )
                 AND  ((LNK-SYU-DAY(IDX25)       =  "1" OR "9" ) OR
                       (LNK-S02-NYUINDAY-KBN(IDX25)     =  "1" ))
                 AND  ( LNK-S02-NYUSANTEI-KBN(IDX25)    =  "1"  )
                 AND  ((WK-GAIHAKU(IDX25)        =  ZERO       ) OR
                       (WK-GAIHAKU(IDX25)       >=   4         ))
                    MOVE    33      TO   LNK-S02-RC
                 END-IF
               ELSE
                 IF   ( WK-SHOKUJI-NYUINJI(IDX25)   NOT =  ZERO )
                 AND  ((LNK-SYU-DAY(IDX25)       =  "1" OR "9" ) OR
                       (LNK-S02-NYUINDAY-KBN(IDX25)     =  "1" ) OR
                       (WK-SKJHKN-SANTEIFLG(IDX25)      =  "1" ))
                 AND  ( LNK-S02-NYUSANTEI-KBN(IDX25)    =  "1"  )
                 AND  ((WK-GAIHAKU(IDX25)        =  ZERO       ) OR
                       (WK-GAIHAKU(IDX25)       >=   4         ))
                    MOVE    33      TO   LNK-S02-RC
                 END-IF
               END-IF
             END-IF
      *
             IF           WK-ROSAITOKU95(IDX25)  NOT =  ZERO
                      MOVE    33      TO   LNK-S02-RC
             END-IF
             IF           WK-ROSAITOKU96(IDX25)  NOT =  ZERO
                      MOVE    33      TO   LNK-S02-RC
             END-IF
             IF           WK-ROSAITOKU97(IDX25)  NOT =  ZERO
                      MOVE    33      TO   LNK-S02-RC
             END-IF
      *
           END-PERFORM
      *
           .
      *
       23048-SHOKUJI-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *    Æþ±¡ÎÁ¤È°Û¤Ê¤ëÊÝ¸±ÁÈ¤ß¹ç¤ï¤»¤Ç¤Î¿©»ö»»Äê¥Á¥§¥Ã¥¯¥Æ¡¼¥Ö¥ëÊÔ½¸
      *    ¡Ê¥¯¥ê¥¢¡Ë
      ******************************************************************
       23049-SKJ-SANTEIFLG-KURIA-SEC         SECTION.
      *
           PERFORM    VARYING   IDX25   FROM   1   BY   1
                       UNTIL    IDX25    >    31
      *
             IF   ( LNK-S02-NYUSANTEI-KBN(IDX25)    =  "1"  )
             AND  ((WK-GAIHAKU(IDX25)        =  ZERO       ) OR
                   (WK-GAIHAKU(IDX25)       >=   4         ))
               CONTINUE
             ELSE
               IF    LNK-SYU-SRYYMD(1:6) = LNK-S02-SKJHKN-SRYYM(1)
                 MOVE  SPACE  TO
                        LNK-S02-SKJHKN-AAA-ARIFLG(1 IDX25)
                 MOVE  SPACE  TO
                        LNK-S02-SKJHKN-BBB-ARIFLG(1 IDX25)
               END-IF
               IF    LNK-SYU-SRYYMD(1:6) = LNK-S02-SKJHKN-SRYYM(2)
                 MOVE  SPACE  TO
                        LNK-S02-SKJHKN-AAA-ARIFLG(2 IDX25)
                 MOVE  SPACE  TO
                        LNK-S02-SKJHKN-BBB-ARIFLG(2 IDX25)
               END-IF
             END-IF
      *
           END-PERFORM
      *
           .
      *
       23049-SKJ-SANTEIFLG-KURIA-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¼çÊÝ¸±¤Î´µ¼ÔÉéÃ´¶â³Û·×»»                                *
      ******************************************************************
       2305-SYUHOKEN-KEISAN-SEC           SECTION.
      *
      *    ³ºÅöÊÝ¸±ÈÖ¹æ¥Æ¡¼¥Ö¥ë¤Î¸¡º÷
           INITIALIZE                      HKNNUM-REC.
           MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM.
           MOVE   COMB-HKNNUM        TO    HKN-HKNNUM.
           MOVE   "00"               TO    WK-PAYKBN.
           MOVE   HKNNUM-REC         TO    MCPDATA-REC.
           MOVE   "DBSELECT"         TO    MCP-FUNC.
           MOVE   "tbl_hknnum"       TO    MCP-TABLE.
           MOVE   "key2"             TO    MCP-PATHNAME.
           CALL   "ORCDBMAIN"        USING MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA.
           IF      MCP-RC            =     ZERO
               MOVE    "tbl_hknnum"  TO    MCP-TABLE
               MOVE    "key2"        TO    MCP-PATHNAME
               PERFORM  HKNNUM-READ-SEC
               PERFORM  UNTIL
                 (FLG-HKNNUM     =    1)                       OR
                ((HKN-TEKSTYMD(1:6)     <=  LNK-SYU-SRYYMD(1:6)  ) AND
                 (LNK-SYU-SRYYMD(1:6)   <=  HKN-TEKEDYMD(1:6))     AND
                 (WK-PAYKBN            =  HKN-PAYKBN))
                   MOVE     "tbl_hknnum"  TO    MCP-TABLE
                   MOVE     "key2"        TO    MCP-PATHNAME
                   PERFORM   HKNNUM-READ-SEC
               END-PERFORM
               IF   FLG-HKNNUM   =    1
                 MOVE     11         TO    LNK-S02-RC
               END-IF
           ELSE
               MOVE       11         TO    LNK-S02-RC
           END-IF.
      *
           MOVE     "tbl_hknnum"     TO    MCP-TABLE.
           MOVE     "key2"           TO    MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
      *    ÊÝ¸±ÁÈ¹ç¤»¥Æ¡¼¥Ö¥ë¤ÎÊä½õ¶èÊ¬¤«¤é´µ¼Ô¤ÎÉéÃ´³ä¹ç¤òÊÝ¸±ÈÖ¹æ
      *    ¥Æ¡¼¥Ö¥ë¤ËºÆ¥»¥Ã¥È¡Ê¹ñÊÝ¤Î¤ß¡Ë
           IF    COMB-HKNNUM           =    "060" OR "039"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "0"
                   WHEN   "4"
                          MOVE   ZERO      TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                   WHEN   "1"
                   WHEN   "5"
                          MOVE   10        TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                   WHEN   "2"
                   WHEN   "6"
                          MOVE   20        TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                   WHEN   "3"
                          MOVE   30        TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
               END-EVALUATE
      *    ·òÊÝ¤Î¹âÎð¼Ô¤Ë¤Ä¤¤¤Æ¤âÊä½õ¶èÊ¬¤è¤êÉéÃ´³ä¹ç¥»¥Ã¥È
           ELSE
               EVALUATE   COMB-HOJOKBN
                   WHEN   "9"
                          MOVE   10        TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                   WHEN   "8"
                          MOVE   20        TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                   WHEN   "7"
                          MOVE   30        TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
               END-EVALUATE
           END-IF.
      *
      *    ²¬»³¸©À¾°ÀÁÒÂ¼Âà¿¦¼Ô¹ñÊÝ¡ÊÁ°´ü¹âÎð¼Ô¤ò½ü¤¯¡Ë
           IF  (FLG-TOKUREI-HKNJYA    =     1    )
           AND (COMB-HOJOKBN          =   SPACE  )
           AND (LNK-SYU-SRYYMD(1:6)  <=  "201109")
                 MOVE   20      TO   HKN-HON-NYUKFTNRATE
                                     HKN-KZK-NYUKFTNRATE
                                     HKN-TSY-NYUKFTNRATE
                                     HKN-TNK-NYUKFTNRATE
           END-IF.
      *
      *    Ç¯Îð£³ºÐÌ¤Ëþ
           IF      LNK-SYU-SRYYMD       >=      "20021001"
           AND     LNK-SYU-SRYYMD       <=      "20080331"
             INITIALIZE                           PTINF-REC
             MOVE    LNK-SYU-HOSPNUM      TO      PTINF-HOSPNUM
             MOVE    LNK-SYU-PTID         TO      PTINF-PTID
             MOVE    PTINF-REC            TO      MCPDATA-REC
             MOVE    "DBSELECT"           TO      MCP-FUNC
             MOVE    "tbl_ptinf"          TO      MCP-TABLE
             MOVE    "key"                TO      MCP-PATHNAME
             CALL    "ORCDBMAIN"          USING   MCPAREA
                                                  MCPDATA-REC
                                                  SPA-AREA
             IF      MCP-RC               =       ZERO
               MOVE    "tbl_ptinf"      TO      MCP-TABLE
               MOVE    "key"            TO      MCP-PATHNAME
               PERFORM  PTINF-READ-SEC
               IF       MCP-RC          =       ZERO
                    MOVE   PTINF-BIRTHDAY   TO  WRK-YMDS1
                    MOVE   LNK-SYU-SRYYMD   TO  WRK-YMDS2
                    MOVE   ZERO             TO  WRK-NENREI
                    COMPUTE  WRK-NENREI     =   WRK-YYS2
                                            -   WRK-YYS1
                    IF   WRK-YMDS1(5:4)     >   WRK-YMDS2(5:4)
                         ADD   -1           TO  WRK-NENREI
                    END-IF
                    IF   WRK-NENREI         =   3
                    AND  WRK-YMDS1(5:4)    <=   WRK-YMDS2(5:4)
                        IF    WRK-YMDS1(5:2)  = WRK-YMDS2(5:2)
                             IF   WRK-YMDS1(7:2)  NOT = "01"
                                   ADD   -1     TO  WRK-NENREI
                              END-IF
                        END-IF
                    END-IF
               ELSE
                    DISPLAY  "PTINF FETCH ERR"
                    MOVE     ZERO   TO      WRK-NENREI
               END-IF
             ELSE
               DISPLAY   "PTINF SELECT ERR"
               MOVE     ZERO   TO      WRK-NENREI
             END-IF
      *
             MOVE    "tbl_ptinf"          TO       MCP-TABLE
             MOVE    "key"                TO       MCP-PATHNAME
             PERFORM  DB-CLOSE-SEC
      *
             IF      WRK-NENREI         <     3
               IF   COMB-HKNNUM       =     "060"
                   IF   COMB-HOJOKBN  =     "0"  OR  "1"
                                       OR   "4"  OR  "5"
                       CONTINUE
                   ELSE
                       MOVE   20      TO   HKN-HON-NYUKFTNRATE
                                           HKN-KZK-NYUKFTNRATE
                                           HKN-TSY-NYUKFTNRATE
                                           HKN-TNK-NYUKFTNRATE
                   END-IF
               ELSE
                   IF    HKN-HKNKOHSBTKBN  =  "1" 
                       MOVE   20      TO   HKN-HON-NYUKFTNRATE
                                           HKN-KZK-NYUKFTNRATE
                                           HKN-TSY-NYUKFTNRATE
                                           HKN-TNK-NYUKFTNRATE
                   END-IF 
               END-IF
             END-IF
           END-IF.
      *
      *    µÁÌ³¶µ°é½¢³ØÁ°
           IF      LNK-SYU-SRYYMD       >=      "20080401"
             IF        FLG-SYUGAKUMAE    =       1
                   IF   COMB-HKNNUM       =     "060"
                       IF   COMB-HOJOKBN  =     "0"  OR  "1"
                                           OR   "4"  OR  "5"
                           CONTINUE
                       ELSE
                           MOVE   20      TO   HKN-HON-NYUKFTNRATE
                                               HKN-KZK-NYUKFTNRATE
                                               HKN-TSY-NYUKFTNRATE
                                               HKN-TNK-NYUKFTNRATE
                       END-IF
                   ELSE
                       IF    HKN-HKNKOHSBTKBN  =  "1" 
                           MOVE   20      TO   HKN-HON-NYUKFTNRATE
                                               HKN-KZK-NYUKFTNRATE
                                               HKN-TSY-NYUKFTNRATE
                                               HKN-TNK-NYUKFTNRATE
                       END-IF
                   END-IF
             END-IF
           END-IF.
      *
      *    ÊÝ¸±ÁÈ¹ç¤»¥Æ¡¼¥Ö¥ë¤ÎÊä½õ¶èÊ¬¤«¤é´µ¼Ô¤ÎÉéÃ´³ä¹ç¤òÊÝ¸±ÈÖ¹æ
      *    ¥Æ¡¼¥Ö¥ë¤ËºÆ¥»¥Ã¥È¡ÊÁ¥°÷ÊÝ¸±»þ¡Ë
           IF    COMB-HKNNUM           =    "002"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "1"
                   WHEN   "2"
                   WHEN   "3"
                   WHEN   "A"
                   WHEN   "B"
                   WHEN   "C"
                   WHEN   "D"
                   WHEN   "E"
                   WHEN   "F"
                   WHEN   "G"
                   WHEN   "H"
                   WHEN   "I"
                       IF   LNK-S02-SENINFLG  NOT =    "1"
                          MOVE   ZERO      TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                       END-IF
      *
                       MOVE      "0"       TO   HKN-HON-NYUSKJRYYKBN
                                                HKN-KZK-NYUSKJRYYKBN
                                                HKN-TSY-NYUSKJRYYKBN
                                                HKN-TNK-NYUSKJRYYKBN
               END-EVALUATE
           END-IF.
      *    ÊÝ¸±ÁÈ¹ç¤»¥Æ¡¼¥Ö¥ë¤ÎÊä½õ¶èÊ¬¤«¤é´µ¼Ô¤ÎÉéÃ´³ä¹ç¤òÊÝ¸±ÈÖ¹æ
      *    ¥Æ¡¼¥Ö¥ë¤ËºÆ¥»¥Ã¥È¡Ê¶¦ºÑÁÈ¹çÊÝ¸±»þ¡Ë
           IF    COMB-HKNNUM    =    "031" OR "032" OR "033" OR "034"
               EVALUATE   COMB-HOJOKBN
                   WHEN   "2"
                   WHEN   "B"
                   WHEN   "E"
                   WHEN   "H"
                          MOVE   ZERO      TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
      *
                          MOVE   "0"       TO   HKN-HON-NYUSKJRYYKBN
                                                HKN-KZK-NYUSKJRYYKBN
                                                HKN-TSY-NYUSKJRYYKBN
                                                HKN-TNK-NYUSKJRYYKBN
               END-EVALUATE
           END-IF.
      *
      *    ÆÃÊÌÎÅÍÜÈñ
           IF    COMB-HKNNUM    =    "068" OR "069" OR "040"
                          MOVE   100       TO   HKN-HON-NYUKFTNRATE
                                                HKN-KZK-NYUKFTNRATE
                                                HKN-TSY-NYUKFTNRATE
                                                HKN-TNK-NYUKFTNRATE
                          MOVE   "1"       TO   HKN-HON-NYUSKJRYYKBN
                                                HKN-KZK-NYUSKJRYYKBN
                                                HKN-TSY-NYUSKJRYYKBN
                                                HKN-TNK-NYUSKJRYYKBN
           END-IF.
      *
      *    ´µ¼ÔÉéÃ´¶â»»½ÐÁ°¤Î£±£°£°¡óÉéÃ´³Û»»½Ð
           IF    (WK-HKNKBN         =   "1" OR "2")
           OR    (COMB-HKNNUM(1:1)  =   "0"       )
                 MOVE    10    TO      HKN-TENTNK
           ELSE
             IF   HKN-TENTNK   =   ZERO
                 MOVE    10    TO      HKN-TENTNK
             END-IF
           END-IF.
           MOVE      ZERO      TO      WK-ZENGAKU.
           PERFORM   VARYING   IDX9    FROM    1   BY  1
                     UNTIL     IDX9       >   16
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +
                            (LNK-SYU-HKNTEN (IDX9) *  HKN-TENTNK)
           END-PERFORM.
      *
           IF   (COMB-SYU-HKNKOHSBTKBN  =   "8" OR "9")
           AND  (HKN-TENTNK              NOT =   10   )
               IF   HKN-HON-NYUKFTNRATE     NOT =   ZERO
                   MOVE     100       TO   HKN-HON-NYUKFTNRATE
               END-IF
               IF   HKN-KZK-NYUKFTNRATE     NOT =   ZERO
                   MOVE     100       TO   HKN-KZK-NYUKFTNRATE
               END-IF
           END-IF.
      *
      *    ¡Ê£×£Ë¡Ý£È£Ë£Î£Ë£Â£Î¡¡¶õÇò¡§°åÊÝ¡¡£±¡§Ï«ºÒ¡¦¼«Çå¡Ë
           EVALUATE   WK-HKNKBN
             WHEN   SPACE
               IF   COMB-HONKZKKBN        =   "1"
                        MOVE    1   TO   WK-DAY-NYUKFTNRATE-FLG
                        MOVE    1   TO   WK-DAY-NYUKFTNRATE-FLG2
                        IF    HKN-HON-NYUKFTNRATE     NOT =    ZERO
                              MOVE   HKN-HON-NYUKFTNRATE
                                           TO   WK-DAY-NYUKFTNRATE
                                                WK-DAY-NYUKFTNRATE2
                                                WK-KOH-FTNRATE
                              COMPUTE   WK-FUTANWARI  =
                                        HKN-HON-NYUKFTNRATE  /  100
                              COMPUTE   LNK-SYU-SYUCOMPFTN  =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              COMPUTE   LNK-SYU-SYUCOMPFTN-ENTANI  =    
                                        WK-ZENGAKU   *  WK-FUTANWARI    
                              COMPUTE   WK-SKYCHK-KEISAN9 =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              COMPUTE   WK-SKYCHK-KEISAN9 =
                                        WK-SKYCHK-KEISAN9 +
                                        WK-SKYMONEY-ZEI
                              IF (FLG-GENBUTU70          NOT =   ZERO)
                              OR (FLG-TOKU75-CYO             =    3  )
                              OR (FLG-CYOKI-ARI              =    2  )
                                IF   FLG-MARUKO  =  2
                                   COMPUTE  WK-MARUKO-XX    =
                                            WK-ZENGAKU      +
                                            WK-MARUKO-KIN
                                   COMPUTE  WK-MARUKO-FTN   =
                                            WK-MARUKO-XX    *
                                            WK-FUTANWARI
                                END-IF
                              END-IF
                              IF   LNK-S02-SENINFLG    =  "1"           
                                IF LNK-SYU-SYUCOMPFTN  >  200           
                                   MOVE   200  TO  LNK-SYU-SYUCOMPFTN   
                                            LNK-SYU-SYUCOMPFTN-ENTANI   
                                END-IF                                  
                              END-IF                                    
                              IF ((COMB-SYU-HKNKOHSBTKBN     = "8" ) AND
                                  (WK-1001-JIHIPOSITION  NOT = "2" ) AND
                                  (COMB-HOJOKBN              = "1" ) AND
                                  (LNK-SYU-SRYYMD(1:6)  >= "200704"))
                              OR ((COMB-SYU-HKNKOHSBTKBN     = "9" ) AND
                                  (COMB-HOJOKBN              = "1" ) AND
                                  (LNK-SYU-SRYYMD(1:6)  >= "200704"))
                                 COMPUTE  LNK-SYU-SYUCOMPFTN =
                                          LNK-SYU-SYUCOMPFTN +
                                          WK-SKYMONEY-ZEI
                                 COMPUTE  LNK-SYU-SYUCOMPFTN-ENTANI =
                                          LNK-SYU-SYUCOMPFTN-ENTANI +
                                          WK-SKYMONEY-ZEI
                              END-IF
                              MOVE      LNK-SYU-SYUCOMPFTN
                                                 TO WK-TOKUTEI-COMPFTN4
      *                       ¸º³Û
                              MOVE      WK-KOH-FTNRATE
                                                 TO WK-NYUKFTNRATE2
                              PERFORM   23052-SYU-GENGAKU-HENSYU-SEC
                              IF  WK-GENGAKUKBN  NOT =  ZERO
                                  MOVE  WK-GENGAKU-GAK
                                          TO  LNK-SYU-SYUCOMPFTN
                                  MOVE  WK-GENGAKU-GAK-ENTANI
                                          TO  LNK-SYU-SYUCOMPFTN-ENTANI
                              END-IF
                              MOVE      LNK-SYU-SYUCOMPFTN
                                          TO WK-TOKUTEI-COMPFTN2
                              MOVE      LNK-SYU-SYUCOMPFTN-ENTANI
                                          TO WK-TOKUTEI-COMPFTN2-ENTANI
                              IF ((COMB-SYU-HKNKOHSBTKBN  =  "8"  ) AND
                                  (WK-1001-JIHIPOSITION   =  "3"  ) AND
                                  (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR ( COMB-SYU-HKNKOHSBTKBN  =  "9"   )
                                 CONTINUE
                              ELSE
                                 COMPUTE   LNK-SYU-SYUCOMPFTN =
                                           LNK-SYU-SYUCOMPFTN  +  5
                                 COMPUTE   WK-FTN      =
                                           LNK-SYU-SYUCOMPFTN  /  10
                                 COMPUTE   LNK-SYU-SYUCOMPFTN =
                                           WK-FTN   *  10
                              END-IF
                              MOVE  LNK-SYU-SYUCOMPFTN  TO
                                              WK-KUMAMOTO-SYUCOMPFTN
                        END-IF
      *
                        IF    FLG-GENBUTU70          NOT =  ZERO
                          IF  FLG-TOKU75  =  3
      ***                   IF  WK-TOKUTEI-COMPFTN2  >=  10500
                            IF  WK-TOKUTEI-COMPFTN4  >=  10500
                               MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                            END-IF
                            IF  (((COMB-KOH1HKNNUM   = SPACE
                                                    OR "970"     ) AND
                                  (COMB-KOH2HKNNUM   = SPACE     ) AND
                                  (COMB-KOH3HKNNUM   = SPACE     ) AND
                                  (COMB-KOH4HKNNUM   = SPACE     ))  OR
                                 ((COMB-KOH1HKNNUM   = "092"     ) AND
                                  (WK-KOHJGNGET-CHECK092(1) = 1  ) AND
                                  (COMB-KOH2HKNNUM   =      SPACE) AND
                                  (COMB-KOH3HKNNUM   =      SPACE) AND
                                  (COMB-KOH4HKNNUM   =      SPACE)))
                            AND (  FLG-GENBUTU-TAISYODATA =  ZERO  )
                            AND (  WK-GENBUTU-HKNKIN  NOT =  ZERO  )
                               COMPUTE  WK-GENBUTU-HKNKIN2 =
                                       (WK-ZENGAKU + WK-GENBUTU-HKNKIN)
                               COMPUTE  WK-GENBUTU-HKNKIN3  =
                                       (WK-GENBUTU-HKNKIN2  *
                                        WK-FUTANWARI)
                               IF  WK-GENBUTU-HKNKIN3  >=  10500
                                 MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                               END-IF
                            END-IF
                          ELSE
      ***                   IF  LNK-SYU-SYUCOMPFTN   >=  21000
      ***                   IF  WK-TOKUTEI-COMPFTN2  >=  21000
                            IF  WK-TOKUTEI-COMPFTN4  >=  21000
                               MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                            END-IF
                            IF  (((COMB-KOH1HKNNUM   = SPACE
                                                    OR "970"     ) AND
                                  (COMB-KOH2HKNNUM   = SPACE     ) AND
                                  (COMB-KOH3HKNNUM   = SPACE     ) AND
                                  (COMB-KOH4HKNNUM   = SPACE     ))  OR
                                 ((COMB-KOH1HKNNUM   = "092"     ) AND
                                  (WK-KOHJGNGET-CHECK092(1) = 1  ) AND
                                  (COMB-KOH2HKNNUM   =      SPACE) AND
                                  (COMB-KOH3HKNNUM   =      SPACE) AND
                                  (COMB-KOH4HKNNUM   =      SPACE)))
                            AND (  FLG-GENBUTU-TAISYODATA =  ZERO  )
                            AND (  WK-GENBUTU-HKNKIN  NOT =  ZERO  )
                               COMPUTE  WK-GENBUTU-HKNKIN2 =
                                       (WK-ZENGAKU + WK-GENBUTU-HKNKIN)
                               COMPUTE  WK-GENBUTU-HKNKIN3  =
                                       (WK-GENBUTU-HKNKIN2  *
                                        WK-FUTANWARI)
                               IF  WK-GENBUTU-HKNKIN3  >=  21000
                                 MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                               END-IF
                            END-IF
                          END-IF
                        END-IF
                        IF   (LNK-S02-KOUREI-NYUIN-KBN   =   "1")
                        OR   (FLG-KOHININBARAI           =    1 )
                        OR   (FLG-GENBUTU70          NOT =  ZERO)
                        OR   (FLG-TOKU75-CYO             =    3 )
                        OR   (FLG-CYOKI-ARI              =    2 )
                         IF  (  FLG-GENBUTU70     NOT  =  ZERO  )
                         AND (((COMB-KOH1HKNNUM   = SPACE
                                                 OR "970"     ) AND
                               (COMB-KOH2HKNNUM   = SPACE     ) AND
                               (COMB-KOH3HKNNUM   = SPACE     ) AND
                               (COMB-KOH4HKNNUM   = SPACE     ))  OR
                              ((COMB-KOH1HKNNUM   = "092"     ) AND
                               (WK-KOHJGNGET-CHECK092(1) = 1  ) AND
                               (COMB-KOH2HKNNUM   =      SPACE) AND
                               (COMB-KOH3HKNNUM   =      SPACE) AND
                               (COMB-KOH4HKNNUM   =      SPACE)))
                         AND (  FLG-GENBUTU-TAISYODATA =  ZERO  )
                            MOVE WK-TOKUTEI-COMPFTN2
                                                 TO  WK-TOKUTEI-COMPFTN
                            IF    FLG-KOUGAKUCYO-GEN70 =    1
                               MOVE   ZERO  TO  FLG-KOUGAKUCYO-GEN70
                            END-IF
                         ELSE
                            IF  ZAN-SYU-M     <=    WK-TOKUTEI-COMPFTN2 
                                MOVE ZAN-SYU-M   TO  LNK-SYU-SYUCOMPFTN
                                                     WK-TOKUTEI-COMPFTN 
                                IF  (( FLG-GENBUTU70 NOT = ZERO  )  OR
                                     ( LNK-S02-KOUREI-NYUIN-KBN
                                                         = "1 "  ))
                                AND (((COMB-KOH1HKNNUM   = SPACE
                                                        OR "970") AND
                                      (COMB-KOH2HKNNUM   = SPACE) AND
                                      (COMB-KOH3HKNNUM   = SPACE) AND
                                      (COMB-KOH4HKNNUM   = SPACE))  OR
                                     ((COMB-KOH1HKNNUM   = "092") AND
                                      (WK-KOHJGNGET-CHECK092(1)
                                                         =  1   ) AND
                                      (COMB-KOH2HKNNUM   = SPACE) AND
                                      (COMB-KOH3HKNNUM   = SPACE) AND
                                      (COMB-KOH4HKNNUM   = SPACE)))
                                AND (  LNK-SYU-SRYYMD(1:6)
                                                     >=  "201204" )
                                  MOVE   1  TO   LNK-SYU-SKJ-FTNGAKU(1)
                                END-IF
                            ELSE                                        
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                                IF    FLG-KOUGAKUCYO    =    1
                                   MOVE    ZERO    TO   FLG-KOUGAKUCYO
                                END-IF
                                IF    FLG-KOUGAKUCYO3   =    1
                                   MOVE    ZERO    TO   FLG-KOUGAKUCYO3
                                END-IF
                                IF    FLG-KOUGAKUCYO-ININ  =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO-ININ
                                END-IF
                                IF    FLG-KOUGAKUCYO-GEN70 =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO-GEN70
                                END-IF
                            END-IF
                            IF  ZAN-SYU-M-ENTANI
                                          <   WK-TOKUTEI-COMPFTN2-ENTANI
                                MOVE  ZAN-SYU-M-ENTANI
                                          TO  LNK-SYU-SYUCOMPFTN-ENTANI
                            END-IF
                         END-IF
                        ELSE
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                        END-IF
                        COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                                  LNK-SYU-SYUCOMPFTN     
                        MOVE  HKN-HON-NYUSKJRYYKBN
                                             TO   LNK-SYU-SYUSKJ-FTNKBN
                        MOVE  WK-SHOKUJI-NISSU
                                             TO   LNK-SYU-SYUSKJ-NISSU
                        MOVE  WK-SHOKUJI-RYOYOHI
                                             TO   LNK-SYU-SYUSKJ-RYOYOHI
                        IF    HKN-HON-NYUSKJRYYKBN  NOT =  "0"
                            IF    HKN-HON-NYUSKJRYYKBN  NOT =  "3"
                              MOVE  WK-SHOKUJI-FTN
                                             TO   LNK-SYU-SYUSKJ-FTN
                            END-IF
                            MOVE  WK-SHOKUJI-FTN
                                            TO   LNK-SYU-SYUSKJ-FTN-RECE
                            IF   (WK-GENGAKUKBN        =   3 OR 4)
                            AND  (FLG-SAIGAI-TAISYO    =   1     )
                            AND  (LNK-SYU-SRYYMD(1:6) <= "201202")
                              MOVE  ZERO    TO   LNK-SYU-SYUSKJ-FTN
                            END-IF
                        END-IF
                        IF   COMB-KOH1HKNNUM  =  "970"
                          COMPUTE   LNK-SYU-RSIJIBAI-SKYMONEY  =
                                    WK-TOKUTEI-COMPFTN         +
                                    WK-SHOKUJI-FTN
                          IF   WK-1001-DAISANKBN     =  "1"
                          AND  FLG-KOUGAKUCYO-GEN70  =  ZERO
                          AND  FLG-KOUGAKUCYO        =  ZERO
                            COMPUTE LNK-SYU-RSIJIBAI-SKYMONEY =
                                    LNK-SYU-RSIJIBAI-SKYMONEY +  5
                            COMPUTE WK-FTN      =
                                    LNK-SYU-RSIJIBAI-SKYMONEY /  10
                            COMPUTE LNK-SYU-RSIJIBAI-SKYMONEY =
                                    WK-FTN   *  10
                          END-IF
                          MOVE    LNK-SYU-RSIJIBAI-SKYMONEY
                                        TO  WK-SKYCHK-KEISAN10
                        END-IF
               ELSE
                        MOVE    1   TO   WK-DAY-NYUKFTNRATE-FLG
                        MOVE    1   TO   WK-DAY-NYUKFTNRATE-FLG2
                        IF    HKN-KZK-NYUKFTNRATE     NOT =    ZERO
                              MOVE   HKN-KZK-NYUKFTNRATE
                                           TO   WK-DAY-NYUKFTNRATE
                                                WK-DAY-NYUKFTNRATE2
                                                WK-KOH-FTNRATE
                              COMPUTE   WK-FUTANWARI  =
                                        HKN-KZK-NYUKFTNRATE  /  100
                              COMPUTE   LNK-SYU-SYUCOMPFTN  =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              COMPUTE   LNK-SYU-SYUCOMPFTN-ENTANI  =    
                                        WK-ZENGAKU   *  WK-FUTANWARI    
                              COMPUTE   WK-SKYCHK-KEISAN9 =
                                        WK-ZENGAKU   *  WK-FUTANWARI
                              COMPUTE   WK-SKYCHK-KEISAN9 =
                                        WK-SKYCHK-KEISAN9 +
                                        WK-SKYMONEY-ZEI
                              IF (FLG-GENBUTU70          NOT =   ZERO)
                              OR (FLG-TOKU75-CYO             =    3  )
                              OR (FLG-CYOKI-ARI              =    2  )
                                IF   FLG-MARUKO  =  2
                                   COMPUTE  WK-MARUKO-XX    =
                                            WK-ZENGAKU      +
                                            WK-MARUKO-KIN
                                   COMPUTE  WK-MARUKO-FTN   =
                                            WK-MARUKO-XX    *
                                            WK-FUTANWARI
                                END-IF
                              END-IF
                              IF ((COMB-SYU-HKNKOHSBTKBN     = "8" ) AND
                                  (WK-1001-JIHIPOSITION  NOT = "2" ) AND
                                  (COMB-HOJOKBN              = "1" ) AND
                                  (LNK-SYU-SRYYMD(1:6)  >= "200704"))
                              OR ((COMB-SYU-HKNKOHSBTKBN     = "9" ) AND
                                  (COMB-HOJOKBN              = "1" ) AND
                                  (LNK-SYU-SRYYMD(1:6)  >= "200704"))
                                 COMPUTE  LNK-SYU-SYUCOMPFTN =
                                          LNK-SYU-SYUCOMPFTN +
                                          WK-SKYMONEY-ZEI
                                 COMPUTE  LNK-SYU-SYUCOMPFTN-ENTANI =
                                          LNK-SYU-SYUCOMPFTN-ENTANI +
                                          WK-SKYMONEY-ZEI
                              END-IF
                              MOVE      LNK-SYU-SYUCOMPFTN
                                                 TO WK-TOKUTEI-COMPFTN4
      *                       ¸º³Û
                              MOVE      WK-KOH-FTNRATE
                                                 TO WK-NYUKFTNRATE2
                              PERFORM   23052-SYU-GENGAKU-HENSYU-SEC
                              IF  WK-GENGAKUKBN  NOT =  ZERO
                                  MOVE  WK-GENGAKU-GAK
                                          TO  LNK-SYU-SYUCOMPFTN
                                  MOVE  WK-GENGAKU-GAK-ENTANI
                                          TO  LNK-SYU-SYUCOMPFTN-ENTANI
                              END-IF
                              MOVE      LNK-SYU-SYUCOMPFTN
                                          TO WK-TOKUTEI-COMPFTN2
                              MOVE      LNK-SYU-SYUCOMPFTN-ENTANI
                                          TO WK-TOKUTEI-COMPFTN2-ENTANI
                              IF ((COMB-SYU-HKNKOHSBTKBN  =  "8"  ) AND
                                  (WK-1001-JIHIPOSITION   =  "3"  ) AND
                                  (LNK-SYU-SRYYMD(1:6) >= "200604"))
                              OR ( COMB-SYU-HKNKOHSBTKBN  =  "9"   )
                                 CONTINUE
                              ELSE
                                 COMPUTE   LNK-SYU-SYUCOMPFTN =
                                           LNK-SYU-SYUCOMPFTN  +  5
                                 COMPUTE   WK-FTN      =
                                           LNK-SYU-SYUCOMPFTN  /  10
                                 COMPUTE   LNK-SYU-SYUCOMPFTN =
                                           WK-FTN   *  10
                              END-IF
                              MOVE  LNK-SYU-SYUCOMPFTN  TO
                                              WK-KUMAMOTO-SYUCOMPFTN
                        END-IF
      *
                        IF    FLG-GENBUTU70          NOT =  ZERO
                          IF  FLG-TOKU75  =  3
      ***                   IF  WK-TOKUTEI-COMPFTN2  >=  10500
                            IF  WK-TOKUTEI-COMPFTN4  >=  10500
                               MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                            END-IF
                            IF  (((COMB-KOH1HKNNUM   = SPACE
                                                    OR "970"     ) AND
                                  (COMB-KOH2HKNNUM   = SPACE     ) AND
                                  (COMB-KOH3HKNNUM   = SPACE     ) AND
                                  (COMB-KOH4HKNNUM   = SPACE     ))  OR
                                 ((COMB-KOH1HKNNUM   = "092"     ) AND
                                  (WK-KOHJGNGET-CHECK092(1) = 1  ) AND
                                  (COMB-KOH2HKNNUM   =      SPACE) AND
                                  (COMB-KOH3HKNNUM   =      SPACE) AND
                                  (COMB-KOH4HKNNUM   =      SPACE)))
                            AND (  FLG-GENBUTU-TAISYODATA =  ZERO  )
                            AND (  WK-GENBUTU-HKNKIN  NOT =  ZERO  )
                               COMPUTE  WK-GENBUTU-HKNKIN2 =
                                       (WK-ZENGAKU + WK-GENBUTU-HKNKIN)
                               COMPUTE  WK-GENBUTU-HKNKIN3  =
                                       (WK-GENBUTU-HKNKIN2  *
                                        WK-FUTANWARI)
                               IF  WK-GENBUTU-HKNKIN3  >=  10500
                                 MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                               END-IF
                            END-IF
                          ELSE
      ***                   IF  LNK-SYU-SYUCOMPFTN   >=  21000
      ***                   IF  WK-TOKUTEI-COMPFTN2  >=  21000
                            IF  WK-TOKUTEI-COMPFTN4  >=  21000
                               MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                            END-IF
                            IF  (((COMB-KOH1HKNNUM   = SPACE
                                                    OR "970"     ) AND
                                  (COMB-KOH2HKNNUM   = SPACE     ) AND
                                  (COMB-KOH3HKNNUM   = SPACE     ) AND
                                  (COMB-KOH4HKNNUM   = SPACE     ))  OR
                                 ((COMB-KOH1HKNNUM   = "092"     ) AND
                                  (WK-KOHJGNGET-CHECK092(1) = 1  ) AND
                                  (COMB-KOH2HKNNUM   =      SPACE) AND
                                  (COMB-KOH3HKNNUM   =      SPACE) AND
                                  (COMB-KOH4HKNNUM   =      SPACE)))
                            AND (  FLG-GENBUTU-TAISYODATA =  ZERO  )
                            AND (  WK-GENBUTU-HKNKIN  NOT =  ZERO  )
                               COMPUTE  WK-GENBUTU-HKNKIN2 =
                                       (WK-ZENGAKU + WK-GENBUTU-HKNKIN)
                               COMPUTE  WK-GENBUTU-HKNKIN3  =
                                       (WK-GENBUTU-HKNKIN2  *
                                        WK-FUTANWARI)
                               IF  WK-GENBUTU-HKNKIN3  >=  21000
                                 MOVE   1   TO  FLG-GENBUTU-TAISYODATA
                               END-IF
                            END-IF
                          END-IF
                        END-IF
                        IF   (LNK-S02-KOUREI-NYUIN-KBN   =   "1")
                        OR   (FLG-KOHININBARAI           =    1 )
                        OR   (FLG-GENBUTU70          NOT =  ZERO)
                        OR   (FLG-TOKU75-CYO             =    3 )
                        OR   (FLG-CYOKI-ARI              =    2 )
                         IF  (  FLG-GENBUTU70     NOT  =  ZERO  )
                         AND (((COMB-KOH1HKNNUM   = SPACE
                                                 OR "970"     ) AND
                               (COMB-KOH2HKNNUM   = SPACE     ) AND
                               (COMB-KOH3HKNNUM   = SPACE     ) AND
                               (COMB-KOH4HKNNUM   = SPACE     ))  OR
                              ((COMB-KOH1HKNNUM   = "092"     ) AND
                               (WK-KOHJGNGET-CHECK092(1) = 1  ) AND
                               (COMB-KOH2HKNNUM   =      SPACE) AND
                               (COMB-KOH3HKNNUM   =      SPACE) AND
                               (COMB-KOH4HKNNUM   =      SPACE)))
                         AND (  FLG-GENBUTU-TAISYODATA =  ZERO  )
                            MOVE WK-TOKUTEI-COMPFTN2
                                                 TO  WK-TOKUTEI-COMPFTN
                            IF    FLG-KOUGAKUCYO-GEN70 =    1
                               MOVE   ZERO  TO  FLG-KOUGAKUCYO-GEN70
                            END-IF
                         ELSE
                            IF  ZAN-SYU-M     <=    WK-TOKUTEI-COMPFTN2 
                                MOVE ZAN-SYU-M   TO  LNK-SYU-SYUCOMPFTN
                                                     WK-TOKUTEI-COMPFTN 
                                IF  (( FLG-GENBUTU70 NOT = ZERO  )  OR
                                     ( LNK-S02-KOUREI-NYUIN-KBN
                                                         = "1 "  ))
                                AND (((COMB-KOH1HKNNUM   = SPACE
                                                        OR "970") AND
                                      (COMB-KOH2HKNNUM   = SPACE) AND
                                      (COMB-KOH3HKNNUM   = SPACE) AND
                                      (COMB-KOH4HKNNUM   = SPACE))  OR
                                     ((COMB-KOH1HKNNUM   = "092") AND
                                      (WK-KOHJGNGET-CHECK092(1)
                                                         =  1   ) AND
                                      (COMB-KOH2HKNNUM   = SPACE) AND
                                      (COMB-KOH3HKNNUM   = SPACE) AND
                                      (COMB-KOH4HKNNUM   = SPACE)))
                                AND (  LNK-SYU-SRYYMD(1:6)
                                                     >=  "201204" )
                                  MOVE   1  TO   LNK-SYU-SKJ-FTNGAKU(1)
                                END-IF
                            ELSE                                        
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                                IF    FLG-KOUGAKUCYO    =    1
                                   MOVE    ZERO    TO   FLG-KOUGAKUCYO
                                END-IF
                                IF    FLG-KOUGAKUCYO3   =    1
                                   MOVE    ZERO    TO   FLG-KOUGAKUCYO3
                                END-IF
                                IF    FLG-KOUGAKUCYO-ININ  =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO-ININ
                                END-IF
                                IF    FLG-KOUGAKUCYO-GEN70 =    1
                                   MOVE   ZERO  TO  FLG-KOUGAKUCYO-GEN70
                                END-IF
                            END-IF
                            IF  ZAN-SYU-M-ENTANI
                                          <   WK-TOKUTEI-COMPFTN2-ENTANI
                                MOVE  ZAN-SYU-M-ENTANI
                                          TO  LNK-SYU-SYUCOMPFTN-ENTANI
                            END-IF
                         END-IF
                        ELSE
                                MOVE WK-TOKUTEI-COMPFTN2                
                                                 TO  WK-TOKUTEI-COMPFTN 
                        END-IF
                        COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                                  LNK-SYU-SYUCOMPFTN     
                        MOVE  HKN-KZK-NYUSKJRYYKBN
                                             TO   LNK-SYU-SYUSKJ-FTNKBN
                        MOVE  WK-SHOKUJI-NISSU
                                             TO   LNK-SYU-SYUSKJ-NISSU
                        MOVE  WK-SHOKUJI-RYOYOHI
                                             TO   LNK-SYU-SYUSKJ-RYOYOHI
                        IF    HKN-KZK-NYUSKJRYYKBN  NOT =  "0"
                            IF    HKN-KZK-NYUSKJRYYKBN  NOT =  "3"
                              MOVE  WK-SHOKUJI-FTN
                                             TO   LNK-SYU-SYUSKJ-FTN
                            END-IF
                            MOVE  WK-SHOKUJI-FTN
                                            TO   LNK-SYU-SYUSKJ-FTN-RECE
                            IF   (WK-GENGAKUKBN        =   3 OR 4)
                            AND  (FLG-SAIGAI-TAISYO    =   1     )
                            AND  (LNK-SYU-SRYYMD(1:6) <= "201202")
                              MOVE  ZERO    TO   LNK-SYU-SYUSKJ-FTN
                            END-IF
                        END-IF
                        IF   COMB-KOH1HKNNUM  =  "970"
                          COMPUTE   LNK-SYU-RSIJIBAI-SKYMONEY  =
                                    WK-TOKUTEI-COMPFTN         +
                                    WK-SHOKUJI-FTN
                          IF   WK-1001-DAISANKBN     =  "1"
                          AND  FLG-KOUGAKUCYO-GEN70  =  ZERO
                          AND  FLG-KOUGAKUCYO        =  ZERO
                            COMPUTE LNK-SYU-RSIJIBAI-SKYMONEY =
                                    LNK-SYU-RSIJIBAI-SKYMONEY +  5
                            COMPUTE WK-FTN      =
                                    LNK-SYU-RSIJIBAI-SKYMONEY /  10
                            COMPUTE LNK-SYU-RSIJIBAI-SKYMONEY =
                                    WK-FTN   *  10
                          END-IF
                          MOVE    LNK-SYU-RSIJIBAI-SKYMONEY
                                        TO  WK-SKYCHK-KEISAN10
                        END-IF
               END-IF
             WHEN   "1"
               IF    WK-4001-KSNRATE1(1:3)   =  SPACE
                  IF    WK-4001-KSNRATE(1:2)   =    SPACE
                      MOVE     100        TO   WK-KSNRATE9
                      COMPUTE  WK-KSNRATE   =  WK-KSNRATE9  /  100
                  ELSE
                      COMPUTE  WK-KSNRATE9  =  WK-4001-KSNRATE
                                            +  100 
                      COMPUTE  WK-KSNRATE   =  WK-KSNRATE9  /  100
                  END-IF  
               ELSE
                 MOVE WK-4001-KSNRATE1    TO   WK-KSNRATE9
                 COMPUTE  WK-KSNRATE   =  WK-KSNRATE9  /  100
               END-IF
               IF     LNK-SYU-SYUHKNNUM       =  "971" OR "973"
                 IF   LNK-SYU-PTFTNRATE       =   100
                   MOVE     100      TO   HKN-HON-NYUKFTNRATE
                                          HKN-KZK-NYUKFTNRATE
                                          HKN-TSY-NYUKFTNRATE
                                          HKN-TNK-NYUKFTNRATE
                   MOVE     "1"      TO   HKN-HON-NYUSKJRYYKBN
                                          HKN-KZK-NYUSKJRYYKBN
                                          HKN-TSY-NYUSKJRYYKBN
                                          HKN-TNK-NYUSKJRYYKBN
                 ELSE
                   MOVE     ZERO     TO   HKN-HON-NYUKFTNRATE
                                          HKN-KZK-NYUKFTNRATE
                                          HKN-TSY-NYUKFTNRATE
                                          HKN-TNK-NYUKFTNRATE
                   MOVE     "0"      TO   HKN-HON-NYUSKJRYYKBN
                                          HKN-KZK-NYUSKJRYYKBN
                                          HKN-TSY-NYUSKJRYYKBN
                                          HKN-TNK-NYUSKJRYYKBN
                 END-IF
               END-IF
               IF     LNK-SYU-SYUHKNNUM       =  "971"
                 IF   FLG-KENPOJYUNKYO  =  ZERO
                   MOVE   ZERO   TO   FLG-KOMURSI
                   IF  (WK-4001-KOMURSITANKAKBN     =  "2"  )
                   AND (WK-4001-KOMURSITANKA-G  NOT =  SPACE)
                     PERFORM   23051-PTRSIINF-KENSAKU-SEC
                   END-IF
                   IF   FLG-KOMURSI  =   1
                       COMPUTE      WK-ZENGAKU  =
                                   (WK-ZENGAKU  / 10
                                     *  WK-4001-KOMURSITANKA)
                   ELSE
                       EVALUATE  WK-4001-TENKBN
                         WHEN  "1"
                           COMPUTE  WK-ZENGAKU  =  
                                   (WK-ZENGAKU  / 10 * 11.5)
                         WHEN  "2"
                           COMPUTE  WK-ZENGAKU  =  
                                   (WK-ZENGAKU  / 10 * 12.0)
                       END-EVALUATE
                   END-IF
                 ELSE
                   COMPUTE WK-ZENGAKU =
                          (WK-ZENGAKU / 10 * WK-4001-KOMUTENTANKA)
                 END-IF
               ELSE
                 IF   FLG-KENPOJYUNKYO  =  ZERO
                   EVALUATE  WK-4001-TENKBN
                     WHEN  "1"
                        COMPUTE  WK-ZENGAKU  =  WK-ZENGAKU  /  10  
                        MOVE  LNK-S02-SYUTEN  TO  WK-ZENGAKU-SYU
                        COMPUTE  WK-ZENGAKU-YAK = WK-ZENGAKU 
                                                - LNK-S02-SYUTEN
                        COMPUTE  WK-ZENGAKU-SYU =
                          (WK-ZENGAKU-SYU * 11.5 * WK-KSNRATE)
                                                 + 0.5
                        COMPUTE  WK-ZENGAKU-YAK =
                          (WK-ZENGAKU-YAK * 11.5)
                                                 + 0.5
                        COMPUTE  WK-ZENGAKU     = WK-ZENGAKU-SYU
                                                + WK-ZENGAKU-YAK
                     WHEN  "2"
                        COMPUTE  WK-ZENGAKU  =  WK-ZENGAKU  /  10  
                        MOVE  LNK-S02-SYUTEN  TO  WK-ZENGAKU-SYU
                        COMPUTE  WK-ZENGAKU-YAK = WK-ZENGAKU 
                                                - LNK-S02-SYUTEN
                        COMPUTE  WK-ZENGAKU-SYU =
                          (WK-ZENGAKU-SYU * 12.0 * WK-KSNRATE)
                                                 + 0.5
                        COMPUTE  WK-ZENGAKU-YAK =
                          (WK-ZENGAKU-YAK * 12.0)
                                                 + 0.5
                        COMPUTE  WK-ZENGAKU     = WK-ZENGAKU-SYU
                                                + WK-ZENGAKU-YAK
                   END-EVALUATE
                 ELSE
                   COMPUTE  WK-ZENGAKU     =  WK-ZENGAKU  /  10
                   MOVE   LNK-S02-SYUTEN  TO  WK-ZENGAKU-SYU
                   COMPUTE  WK-ZENGAKU-YAK =  WK-ZENGAKU
                                           -  LNK-S02-SYUTEN
                   COMPUTE  WK-ZENGAKU-SYU =
                           (WK-ZENGAKU-SYU *  WK-4001-SYUTENTANKA)
                                           +  0.5
                   COMPUTE  WK-ZENGAKU-YAK =
                           (WK-ZENGAKU-YAK *  WK-4001-YKZTENTANKA)
                                           +  0.5
                   COMPUTE  WK-ZENGAKU     =  WK-ZENGAKU-SYU
                                           +  WK-ZENGAKU-YAK
                 END-IF
               END-IF 
      *
               COMPUTE   LNK-SYU-RSIJIBAI-SKYMONEY  =
                         WK-ZENGAKU                 +
                         WK-SHOKUJI-FTN
      *
               COMPUTE   WK-SKYCHK-KEISAN9          =
                         WK-ZENGAKU                 +
                         WK-SHOKUJI-FTN
      *
               COMPUTE   WK-FUTANWARI  =
                         HKN-HON-NYUKFTNRATE  /  100
               COMPUTE   LNK-SYU-SYUCOMPFTN  =
                         WK-ZENGAKU   *  WK-FUTANWARI
      *         COMPUTE   LNK-SYU-SYUCOMPFTN =
      *                   LNK-SYU-SYUCOMPFTN  +  5
      *         COMPUTE   WK-FTN      =
      *                   LNK-SYU-SYUCOMPFTN  /  10
      *         COMPUTE   LNK-SYU-SYUCOMPFTN =
      *                   WK-FTN   *  10
               COMPUTE   LNK-SYU-SYUCOMPTOTAL   =
                         LNK-SYU-SYUCOMPFTN     
               MOVE  HKN-HON-NYUSKJRYYKBN
                                        TO   LNK-SYU-SYUSKJ-FTNKBN
               MOVE  WK-SHOKUJI-NISSU
                                        TO   LNK-SYU-SYUSKJ-NISSU
               MOVE  WK-SHOKUJI-RYOYOHI
                                        TO   LNK-SYU-SYUSKJ-RYOYOHI
               IF    HKN-HON-NYUSKJRYYKBN  NOT =  "0"
                       IF    HKN-HON-NYUSKJRYYKBN  NOT =  "3"
                         MOVE  WK-SHOKUJI-FTN
                                        TO   LNK-SYU-SYUSKJ-FTN
                       END-IF
                       MOVE  WK-SHOKUJI-FTN
                                        TO   LNK-SYU-SYUSKJ-FTN-RECE
               END-IF
             WHEN   "2"
               MOVE     ZERO            TO   HKN-HON-NYUKFTNRATE
                                             HKN-KZK-NYUKFTNRATE
                                             HKN-TSY-NYUKFTNRATE
                                             HKN-TNK-NYUKFTNRATE
               MOVE     "0"             TO   HKN-HON-NYUSKJRYYKBN
                                             HKN-KZK-NYUSKJRYYKBN
                                             HKN-TSY-NYUSKJRYYKBN
                                             HKN-TNK-NYUSKJRYYKBN
      *
               COMPUTE  WK-ZENGAKU      =    WK-ZENGAKU  /  10
               MOVE     LNK-S02-SYUTEN  TO   WK-ZENGAKU-SYU
               COMPUTE  WK-ZENGAKU-YAK  =    WK-ZENGAKU
                                        -    LNK-S02-SYUTEN
               COMPUTE  WK-ZENGAKU-SYU  =    WK-ZENGAKU-SYU * 12
               COMPUTE  WK-ZENGAKU-YAK  =    WK-ZENGAKU-YAK * 10
               COMPUTE  WK-ZENGAKU      =    WK-ZENGAKU-SYU
                                        +    WK-ZENGAKU-YAK
      *
               COMPUTE  WK-SHOKUJI-RYOYOHI-KOGAI =  WK-SHOKUJI-RYOYOHI
                                                 *  1.2
      *
               COMPUTE  LNK-SYU-RSIJIBAI-SKYMONEY  =
                        WK-ZENGAKU                 +
                        WK-SHOKUJI-RYOYOHI-KOGAI
      *
               COMPUTE  WK-SKYCHK-KEISAN9          =
                        WK-ZENGAKU                 +
                        WK-SHOKUJI-RYOYOHI-KOGAI
      *
               COMPUTE  WK-FUTANWARI  =
                        HKN-HON-NYUKFTNRATE  /  100
               COMPUTE  LNK-SYU-SYUCOMPFTN  =
                        WK-ZENGAKU    *  WK-FUTANWARI
      *
               COMPUTE  LNK-SYU-SYUCOMPTOTAL   =
                        LNK-SYU-SYUCOMPFTN
      *
               MOVE     HKN-HON-NYUSKJRYYKBN TO  LNK-SYU-SYUSKJ-FTNKBN
               MOVE     WK-SHOKUJI-NISSU     TO  LNK-SYU-SYUSKJ-NISSU
      ***      MOVE     WK-SHOKUJI-RYOYOHI   TO  LNK-SYU-SYUSKJ-RYOYOHI
               MOVE     WK-SHOKUJI-RYOYOHI-KOGAI
                                             TO  LNK-SYU-SYUSKJ-RYOYOHI
               IF    HKN-HON-NYUSKJRYYKBN  NOT =  "0"
                 IF  HKN-HON-NYUSKJRYYKBN  NOT =  "3"
                   MOVE WK-SHOKUJI-FTN       TO  LNK-SYU-SYUSKJ-FTN
                 END-IF
                 MOVE   WK-SHOKUJI-FTN       TO  LNK-SYU-SYUSKJ-FTN-RECE
               END-IF
           END-EVALUATE.
      *
       2305-SYUHOKEN-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        Ï«ºÒ¤ÎÊÝ¸±¶èÊ¬¼èÆÀ                                      *
      ******************************************************************
       23051-PTRSIINF-KENSAKU-SEC           SECTION.
      *
           INITIALIZE                     PTRSIINF-REC
           MOVE    COMB-HOSPNUM      TO   PTRSI-HOSPNUM
           MOVE    COMB-PTID         TO   PTRSI-PTID
           MOVE    COMB-HKNID        TO   PTRSI-HKNID
           MOVE    PTRSIINF-REC      TO   MCPDATA-REC
           MOVE    "DBSELECT"        TO   MCP-FUNC
           MOVE    "tbl_ptrsiinf"    TO   MCP-TABLE
           MOVE    "key"             TO   MCP-PATHNAME
           CALL    "ORCDBMAIN"       USING   MCPAREA
                                             MCPDATA-REC
                                             SPA-AREA
           IF      MCP-RC  =  ZERO
             MOVE    "tbl_ptrsiinf"  TO   MCP-TABLE
             MOVE    "key"           TO   MCP-PATHNAME
             PERFORM  PTRSIINF-READ-SEC
             IF    FLG-PTRSIINF     =  ZERO
               IF     PTRSI-HKNKBN  =  "5"
                  MOVE     1         TO   FLG-KOMURSI
               END-IF
             END-IF
           END-IF
           MOVE    "tbl_ptrsiinf"    TO   MCP-TABLE
           MOVE    "key"             TO   MCP-PATHNAME
           PERFORM  DB-CLOSE-SEC
      *
           .
      *
       23051-PTRSIINF-KENSAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¼çÊÝ¸±°ìÉôÉéÃ´¶â¸º³Û
      ******************************************************************
       23052-SYU-GENGAKU-HENSYU-SEC           SECTION.
      *
           EVALUATE  WK-GENGAKUKBN
             WHEN      1
               IF  WK-GENGAKUKBN-KEISAN  =  2
                 IF    WK-GENGAKU-RITU   =  ZERO
                     MOVE  LNK-SYU-SYUCOMPFTN
                                 TO  WK-GENGAKU-GAK
                     MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                 TO  WK-GENGAKU-GAK-ENTANI
                 ELSE
                   IF  WK-NYUKFTNRATE2  <= WK-GENGAKU-RITU
                     MOVE  ZERO  TO  WK-GENGAKU-GAK
                     MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                     MOVE  ZERO  TO  WK-MARUKO-FTN
                   ELSE
                     COMPUTE  WK-FUTANWARI2   =
                              WK-GENGAKU-RITU / 100
                     COMPUTE  WK-GENGAKU-GAK2 =
                              WK-ZENGAKU      * WK-FUTANWARI2
                     COMPUTE  WK-GENGAKU-GAK2-ENTANI =
                              WK-ZENGAKU      * WK-FUTANWARI2
                     COMPUTE  WK-MARUKO-FTN2  =
                              WK-MARUKO-XX    * WK-FUTANWARI2
                     IF  LNK-SYU-SYUCOMPFTN
                                 > WK-GENGAKU-GAK2
                       COMPUTE WK-GENGAKU-GAK     =
                               LNK-SYU-SYUCOMPFTN -
                               WK-GENGAKU-GAK2
                     ELSE
                       MOVE  ZERO  TO  WK-GENGAKU-GAK
                     END-IF
                     IF  LNK-SYU-SYUCOMPFTN-ENTANI
                                 > WK-GENGAKU-GAK2-ENTANI
                       COMPUTE WK-GENGAKU-GAK-ENTANI     =
                               LNK-SYU-SYUCOMPFTN-ENTANI -
                               WK-GENGAKU-GAK2-ENTANI
                     ELSE
                       MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                     END-IF
                     IF  WK-MARUKO-FTN
                                 > WK-MARUKO-FTN2
                       COMPUTE WK-MARUKO-FTN      =
                               WK-MARUKO-FTN      -
                               WK-MARUKO-FTN2
                     ELSE
                       MOVE  ZERO  TO  WK-MARUKO-FTN
                     END-IF
                   END-IF
                 END-IF
               ELSE
                 IF  WK-GENGAKU-RITU = 100
                   MOVE  ZERO  TO  WK-GENGAKU-GAK
                   MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                   MOVE  ZERO  TO  WK-MARUKO-FTN
                 ELSE
                   COMPUTE  WK-GENGAKU-RITUX =
                            100 - WK-GENGAKU-RITU
                   COMPUTE  WK-GENGAKU-GAK      =
                            LNK-SYU-SYUCOMPFTN  *
                            WK-GENGAKU-RITUX    /
                            100
                   COMPUTE  WK-GENGAKU-GAK-ENTANI     =
                            LNK-SYU-SYUCOMPFTN-ENTANI *
                            WK-GENGAKU-RITUX          /
                            100
                   COMPUTE  WK-MARUKO-FTN       =
                            WK-MARUKO-FTN       *
                            WK-GENGAKU-RITUX    /
                            100
                 END-IF
               END-IF
             WHEN      2
               PERFORM   230521-GENGAKU-ZAN1-SEC
             WHEN      3
             WHEN      4
               MOVE  ZERO  TO  WK-GENGAKU-GAK
               MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
               MOVE  ZERO  TO  WK-MARUKO-FTN
             WHEN      5
               PERFORM   230522-GENGAKU-ZAN2-SEC
           END-EVALUATE
      *
           .
       23052-SYU-GENGAKU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸ºÌÈ»Ä·×»»£±                                            *
      ******************************************************************
       230521-GENGAKU-ZAN1-SEC           SECTION.
      *
           MOVE  ZERO  TO WK-GENGAKU-GAK9
           MOVE  ZERO  TO WK-GENGAKU-GAK9-ENTANI
           PERFORM VARYING IDX14 FROM 1 BY 1
                    UNTIL  IDX14   >  100
             COMPUTE  WK-GENGAKU-GAK8       =
                      WK-GENGAKU-TEN(IDX14) *
                      10                    *
                      WK-FUTANWARI
             COMPUTE  WK-GENGAKU-GAK8 = WK-GENGAKU-GAK8 +   5
             COMPUTE  WK-GENGAKU-GAK8 = WK-GENGAKU-GAK8 /  10
             COMPUTE  WK-GENGAKU-GAK8 = WK-GENGAKU-GAK8 *  10
             COMPUTE  WK-GENGAKU-GAK8-ENTANI  =
                      WK-GENGAKU-TEN(IDX14)   *
                      10                      *
                      WK-FUTANWARI
             ADD  WK-GENGAKU-GAK8         TO  WK-GENGAKU-GAK9
             ADD  WK-GENGAKU-GAK8-ENTANI  TO  WK-GENGAKU-GAK9-ENTANI
           END-PERFORM
      *
           IF  WK-GENGAKU-KIN <= WK-GENGAKU-GAK9
             MOVE   ZERO  TO  WK-GENGAKU-KIN2
           ELSE
             COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN
                                      - WK-GENGAKU-GAK9
           END-IF
           IF  WK-GENGAKU-KIN <= WK-GENGAKU-GAK9-ENTANI
             MOVE   ZERO  TO  WK-GENGAKU-KIN2-ENTANI
           ELSE
             COMPUTE  WK-GENGAKU-KIN2-ENTANI = WK-GENGAKU-KIN
                                             - WK-GENGAKU-GAK9-ENTANI
           END-IF
      *
           IF  LNK-SYU-SYUCOMPFTN < WK-GENGAKU-KIN2
             MOVE   ZERO  TO  WK-GENGAKU-GAK
           ELSE
             COMPUTE  WK-GENGAKU-GAK = LNK-SYU-SYUCOMPFTN
                                     - WK-GENGAKU-KIN2
           END-IF
           IF  LNK-SYU-SYUCOMPFTN-ENTANI < WK-GENGAKU-KIN2-ENTANI
             MOVE   ZERO  TO  WK-GENGAKU-GAK-ENTANI
           ELSE
             COMPUTE  WK-GENGAKU-GAK-ENTANI = LNK-SYU-SYUCOMPFTN-ENTANI
                                            - WK-GENGAKU-KIN2-ENTANI
           END-IF
           IF  WK-MARUKO-FTN < WK-GENGAKU-KIN2
             MOVE   ZERO  TO  WK-MARUKO-FTN
           ELSE
             COMPUTE  WK-MARUKO-FTN = WK-MARUKO-FTN
                                    - WK-GENGAKU-KIN2
           END-IF
      *
           .
      *
       230521-GENGAKU-ZAN1-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸ºÌÈ»Ä·×»»£²                                            *
      ******************************************************************
       230522-GENGAKU-ZAN2-SEC           SECTION.
      *
           MOVE  ZERO  TO WK-GENGAKU-GAK9
           MOVE  ZERO  TO WK-GENGAKU-GAK9-ENTANI
           PERFORM VARYING IDX14 FROM 1 BY 1
                    UNTIL  IDX14   >  100
             ADD  WK-GENGAKU-FTN(IDX14)   TO  WK-GENGAKU-GAK9
             ADD  WK-GENGAKU-FTN-ENTANI(IDX14)
                                          TO  WK-GENGAKU-GAK9-ENTANI
           END-PERFORM
      *
           IF  WK-GENGAKU-KIN <= WK-GENGAKU-GAK9
             MOVE   ZERO  TO  WK-GENGAKU-KIN2
           ELSE
             COMPUTE  WK-GENGAKU-KIN2 = WK-GENGAKU-KIN
                                      - WK-GENGAKU-GAK9
           END-IF
           IF  WK-GENGAKU-KIN <= WK-GENGAKU-GAK9-ENTANI
             MOVE   ZERO  TO  WK-GENGAKU-KIN2-ENTANI
           ELSE
             COMPUTE  WK-GENGAKU-KIN2-ENTANI = WK-GENGAKU-KIN
                                             - WK-GENGAKU-GAK9-ENTANI
           END-IF
      *
           IF  LNK-SYU-SYUCOMPFTN < WK-GENGAKU-KIN2
             MOVE   LNK-SYU-SYUCOMPFTN      TO  WK-GENGAKU-GAK
           ELSE
             MOVE   WK-GENGAKU-KIN2         TO  WK-GENGAKU-GAK
           END-IF
           IF  LNK-SYU-SYUCOMPFTN-ENTANI < WK-GENGAKU-KIN2-ENTANI
             MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                            TO  WK-GENGAKU-GAK-ENTANI
           ELSE
             MOVE   WK-GENGAKU-KIN2-ENTANI  TO  WK-GENGAKU-GAK-ENTANI
           END-IF
           IF  WK-MARUKO-FTN < WK-GENGAKU-KIN2
             CONTINUE
           ELSE
             MOVE   WK-GENGAKU-KIN2         TO  WK-MARUKO-FTN
           END-IF
      *
           .
      *
       230522-GENGAKU-ZAN2-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñ¤ÎÊÝ¸±ÈÖ¹æ¥Æ¡¼¥Ö¥ë¸¡º÷                              *
      ******************************************************************
       2306-KOH-HKNREAD-SEC           SECTION.
      *
      *    ³ºÅöÊÝ¸±ÈÖ¹æ¥Æ¡¼¥Ö¥ë¤Î¸¡º÷
           INITIALIZE                      HKNNUM-REC.
           MOVE   COMB-HOSPNUM       TO    HKN-HOSPNUM.
           MOVE   COMB-KOHHKNNUM(KOH-IDX)
                                     TO    HKN-HKNNUM.
           IF     COMB-KOHHKNNUM(KOH-IDX)  =     "027"
                  MOVE     COMB-KOH1PAYKBN
                                     TO    WK-PAYKBN
           ELSE
                  MOVE     "00"      TO    WK-PAYKBN
           END-IF.
           MOVE   HKNNUM-REC         TO    MCPDATA-REC.
           MOVE   "DBSELECT"         TO    MCP-FUNC.
           MOVE   "tbl_hknnum"       TO    MCP-TABLE.
           MOVE   "key2"             TO    MCP-PATHNAME.
           CALL   "ORCDBMAIN"        USING MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA.
           IF      MCP-RC            =     ZERO
               MOVE    "tbl_hknnum"  TO    MCP-TABLE
               MOVE    "key2"        TO    MCP-PATHNAME
               PERFORM  HKNNUM-READ-SEC
               PERFORM  UNTIL
                 (FLG-HKNNUM     =    1)                       OR
                ((HKN-TEKSTYMD(1:6)     <=  LNK-SYU-SRYYMD(1:6)  ) AND
                 (LNK-SYU-SRYYMD(1:6)   <=  HKN-TEKEDYMD(1:6))     AND
                 (WK-PAYKBN            =  HKN-PAYKBN))
                   MOVE     "tbl_hknnum"  TO    MCP-TABLE
                   MOVE     "key2"        TO    MCP-PATHNAME
                   PERFORM   HKNNUM-READ-SEC
               END-PERFORM
               IF   FLG-HKNNUM   =    1
                 MOVE     11         TO    LNK-S02-RC
               END-IF
           ELSE
               MOVE       11         TO    LNK-S02-RC
           END-IF.
      *
           MOVE     "tbl_hknnum"  TO    MCP-TABLE.
           MOVE     "key2"        TO    MCP-PATHNAME.
           PERFORM   DB-CLOSE-SEC.
      *
      *    ´µ¼ÔÉéÃ´¶â»»½ÐÁ°¤Î£±£°£°¡óÉéÃ´³Û»»½Ð
           IF    (COMB-KOHHKNNUM(KOH-IDX)(1:1)   =   "0"           )
           OR    (COMB-KOHHKNNUM(KOH-IDX)        =   "972" OR "974")
                 MOVE    10    TO      HKN-TENTNK
           ELSE
             IF   HKN-TENTNK   =   ZERO
                 MOVE    10    TO      HKN-TENTNK
             END-IF
           END-IF.
           MOVE      ZERO      TO      WK-ZENGAKU.
           PERFORM   VARYING   IDX9    FROM    1   BY  1
                     UNTIL     IDX9       >   16
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +
                            (LNK-SYU-HKNTEN (IDX9) *  HKN-TENTNK)
           END-PERFORM.
      *
           MOVE       ZERO                TO   WK-NYUKFTNRATE.
           MOVE       SPACE               TO   WK-NYUSKJRYYKBN.
           MOVE       ZERO                TO   WK-NYUSKJJYOGAK.
           MOVE       ZERO                TO   FLG-NYUSKJJYOGAK.
           MOVE       SPACE               TO   FLG-SANSHOU4.
      *
           IF    COMB-KOHHKNNUM(KOH-IDX)(1:1)   >=  "1" AND <=  "8"
             IF  WK-1001-CHIHOUNUMKBN       =   "1"
               EVALUATE   FLG-SANSHOU2
                 WHEN   "1"
                     MOVE   HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                     MOVE   HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                     MOVE   HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                     MOVE   "1"                  TO  FLG-SANSHOU4
                 WHEN   "2"
                   IF   HKN-TSY-NYUFTNNBK      =  "0"
                     MOVE   HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                     MOVE   HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                     MOVE   HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                     MOVE   "1"                  TO  FLG-SANSHOU4
                   ELSE
                     MOVE   HKN-TSY-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                     MOVE   HKN-TSY-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                     MOVE   HKN-TSY-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                     MOVE   "2"                  TO  FLG-SANSHOU4
                   END-IF
                 WHEN   "3"
                   IF  HKN-TNK-NYUFTNKBN       =  "0"
                     MOVE   HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                     MOVE   HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                     MOVE   HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                     MOVE   "1"                  TO  FLG-SANSHOU4
                   ELSE
                     MOVE   HKN-TNK-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                     MOVE   HKN-TNK-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                     MOVE   HKN-TNK-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                     MOVE   "3"                  TO  FLG-SANSHOU4
                   END-IF
               END-EVALUATE
             ELSE
               IF (( WK-1001-PREFNUM   =  26  OR  27  OR
                                          34  OR  12  OR  19      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "141"             ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "241" OR "180" OR
                                                "182" OR "143" OR
                                                "185" OR "127"    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200507"          ))
               OR (( WK-1001-PREFNUM   =  05                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "374" OR "474"    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200508"          ))
               OR (( WK-1001-PREFNUM   =  32                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "191" OR "391"    ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200510"          ))
               OR (( WK-1001-PREFNUM   =  31                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                           >=  "1"  AND  <=  "8"  ))
               OR (( WK-1001-PREFNUM   =  10                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "155"             ))
               OR (( WK-1001-PREFNUM   =  28                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "100"             ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200604"          ))
               OR (( WK-1001-PREFNUM   =  33                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "141" OR "285" OR
                                                "485" OR "180" OR
                                                "186"             ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  23  OR  14  OR  30      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "141"             ) AND
                   ( LNK-SYU-SRYYMD(1:6)   >=   "200610"          ))
               OR (( WK-1001-PREFNUM   =  01                      ) AND
                   ( COMB-KOHHKNNUM(KOH-IDX)  = "141"             ) AND
                   ( LNK-SYU-SRYYMD(1:6)   <=   "200803"          ))
                 EVALUATE   FLG-SANSHOU2
                   WHEN   "1"
                        MOVE  HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                        MOVE  HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                        MOVE  HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                        MOVE  "1"                  TO  FLG-SANSHOU4
                   WHEN   "2"
                     IF   HKN-TSY-NYUFTNNBK      =  "0"
                        MOVE  HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                        MOVE  HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                        MOVE  HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                        MOVE  "1"                  TO  FLG-SANSHOU4
                     ELSE
                        MOVE  HKN-TSY-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                        MOVE  HKN-TSY-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                        MOVE  HKN-TSY-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                        MOVE  "2"                  TO  FLG-SANSHOU4
                     END-IF
                   WHEN   "3"
                      IF  HKN-TNK-NYUFTNKBN       =  "0"
                        MOVE  HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                        MOVE  HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                        MOVE  HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                        MOVE  "1"                  TO  FLG-SANSHOU4
                      ELSE
                        MOVE  HKN-TNK-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                        MOVE  HKN-TNK-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                        MOVE  HKN-TNK-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                        MOVE  "3"                  TO  FLG-SANSHOU4
                      END-IF
                 END-EVALUATE
               ELSE
                 MOVE  HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
                 MOVE  HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
                 MOVE  HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
                 MOVE  "1"                  TO  FLG-SANSHOU4
               END-IF
             END-IF
           ELSE
             MOVE      HKN-HON-NYUKFTNRATE  TO  WK-NYUKFTNRATE
             MOVE      HKN-HON-NYUSKJRYYKBN TO  WK-NYUSKJRYYKBN
             MOVE      HKN-HON-NYUSKJJYOGAK TO  WK-NYUSKJJYOGAK
           END-IF.
      *
           IF  (LNK-SYU-SRYYMD(1:6)      >=  "200304"      )
           AND (LNK-SYU-SRYYMD(1:6)      <   "200604"      )
           AND (COMB-KOHHKNNUM(KOH-IDX)   =  "015" OR "016")
                MOVE    "2"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  WK-JIRITU-SKJGENMEN(KOH-IDX)  =   1
                MOVE    "3"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  WK-SYOGAI-SKJGENMEN(KOH-IDX)  =   1
                MOVE    "3"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  (LNK-SYU-SRYYMD(1:6)      >=  "200604"      )
           AND (COMB-KOHHKNNUM(KOH-IDX)   =  "012"         )
                MOVE    "2"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  (COMB-KOHHKNNUM(KOH-IDX)   =  "025"         )
                MOVE    "2"              TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  (LNK-SYU-SRYYMD(1:6)      >=  "200310"      )
           AND (COMB-KOHHKNNUM(KOH-IDX)   =  "051"         )
                MOVE    "2"              TO   WK-NYUSKJRYYKBN
           END-IF.
      ***  IF  (LNK-SYU-SRYYMD(1:6)      >=  "200310"      )
      ***  AND (WK-1001-PREFNUM           =   13           )
      ***  AND (COMB-KOHHKNNUM(KOH-IDX)   =  "151"         )
      ***       MOVE    "2"              TO   WK-NYUSKJRYYKBN
      ***  END-IF.
      ***  IF  (LNK-SYU-SRYYMD(1:6)      >=  "200310"      )
      ***  AND (WK-1001-PREFNUM           =   28           )
      ***  AND (COMB-KOHHKNNUM(KOH-IDX)   =  "186"         )
      ***       MOVE    "2"              TO   WK-NYUSKJRYYKBN
      ***  END-IF.
           IF  (LNK-SYU-SRYYMD(1:6)      >=  "200504"      )
           AND (LNK-SYU-SRYYMD(1:6)      <=  "201412"      )
           AND (COMB-KOHHKNNUM(KOH-IDX)   =  "052"         )
                MOVE    "2"              TO   WK-NYUSKJRYYKBN
           END-IF.
      ***  IF  (LNK-SYU-SRYYMD(1:6)      >=  "200702"      )
      ***  AND (WK-1001-PREFNUM           =   07           )
      ***  AND (COMB-KOHHKNNUM(KOH-IDX)   =  "281"         )
      ***       MOVE    "2"              TO   WK-NYUSKJRYYKBN
      ***  END-IF.
      ***  IF  (LNK-SYU-SRYYMD(1:6)      >=  "200810"      )
      ***  AND (WK-1001-PREFNUM           =   01           )
      ***  AND (COMB-KOHHKNNUM(KOH-IDX)   =  "183"         )
      ***       MOVE    "2"              TO   WK-NYUSKJRYYKBN
      ***  END-IF.
      ***  IF  (LNK-SYU-SRYYMD(1:6)      >=  "200910"      )
      ***  AND (WK-1001-PREFNUM           =   23           )
      ***  AND (COMB-KOHHKNNUM(KOH-IDX)   =  "191"         )
      ***       MOVE    "2"              TO   WK-NYUSKJRYYKBN
      ***  END-IF.
      ***  IF  (LNK-SYU-SRYYMD(1:6)      >=  "201104"      )
      ***  AND (LNK-SYU-SRYYMD(1:6)      <=  "201412"      )
      ***  AND (WK-1001-PREFNUM           =   23 OR 24     )
      ***  AND (COMB-KOHHKNNUM(KOH-IDX)   =  "152"         )
      ***       MOVE    "2"              TO   WK-NYUSKJRYYKBN
      ***  END-IF.
      *
           IF   COMB-KOHHKNNUM(KOH-IDX)  =  "027"
                MOVE    HKN-HON-NYUKFTNRATE  TO   WK-KOH-FTNRATE
                MOVE    "1"                  TO   HKN-RECEFTNDSPKBN
           END-IF.
      *
           IF  (COMB-KOHHKNNUM(KOH-IDX)  =  "011" OR "020")
           AND (LNK-SYU-SRYYMD(1:6)     >=  "200704"      )
                MOVE    "2"                  TO   HKN-RECEFTNDSPKBN
           END-IF.
           IF   COMB-KOHHKNNUM(KOH-IDX)  =  "012"
           AND  LNK-SYU-SRYYMD(1:6)     >=  "200604"
                MOVE    "2"                  TO   HKN-RECEFTNDSPKBN
           END-IF.
           IF   COMB-KOHHKNNUM(KOH-IDX)  =  "025"
                MOVE    "2"                  TO   HKN-RECEFTNDSPKBN
           END-IF.
      *
           IF  (COMB-KOHHKNNUM(KOH-IDX)  =  "970")
           AND (LNK-SYU-PTFTNRATE    NOT =  ZERO )
                MOVE    LNK-SYU-PTFTNRATE    TO   WK-NYUKFTNRATE
                IF   WK-1001-DAISANKBN   =  "2"
                  MOVE  "2"                  TO   HKN-RECEFTNDSPKBN
                END-IF
                MOVE    "1"                  TO   WK-NYUSKJRYYKBN
           END-IF.
           IF  (COMB-KOHHKNNUM(KOH-IDX)  =  "970")
           AND (LNK-SYU-PTFTNRATE        =  ZERO )
                IF   WK-1001-DAISANKBN   =  "2"
                  MOVE  "2"                  TO   HKN-RECEFTNDSPKBN
                END-IF
           END-IF.
      *
           IF  (KOH-IDX                  =    1           )
           AND (COMB-KOHHKNNUM(KOH-IDX)  =  "010" OR "021")
              IF    (COMB-KOHHKNNUM(KOH-IDX)  =  "021"   )
              AND   (LNK-SYU-SRYYMD(1:6)     >=  "200604")
                 IF   FLG-SEISINJYO  =  1
                   MOVE     "3"      TO    WK-NYUSKJRYYKBN
                 END-IF
              ELSE
                 IF   FLG-SEISINJYO  =  1
                   MOVE     ZERO     TO    WK-NYUKFTNRATE
                   MOVE     "3"      TO    WK-NYUSKJRYYKBN
                 END-IF
              END-IF
           END-IF.
      *
           IF  (COMB-HKNNUM              =  SPACE  )
           AND (COMB-KOHHKNNUM(KOH-IDX)  =  "010"  )
           AND (WK-GENGAKUKBN            =   3 OR 4)
           AND (FLG-SAIGAI-TAISYO        =   1     )
                   MOVE     SPACE    TO    COMB-KOH-NYUJGNKBN(KOH-IDX)
                   MOVE     ZERO     TO    WK-NYUKFTNRATE
           END-IF.
           IF  (COMB-HKNNUM              =  SPACE  )
           AND (COMB-KOHHKNNUM(KOH-IDX)(1:1)
                                >=  "1" AND <=  "8")
           AND (WK-GENGAKUKBN            =   3 OR 4)
           AND (FLG-SAIGAI-TAISYO        =   1     )
                   MOVE     SPACE    TO    COMB-KOH-NYUJGNKBN(KOH-IDX)
                   MOVE     ZERO     TO    WK-NYUKFTNRATE
           END-IF.
      *
           IF   (WK-1001-PREFNUM         =  35 OR 34)
           AND  (COMB-KOHHKNNUM(KOH-IDX) = "781"    )
           AND  (LNK-SYU-SRYYMD(1:6)    >= "201309" )
                   MOVE     ZERO     TO    WK-NYUKFTNRATE
                   MOVE     SPACE    TO    FLG-CHIHOU(KOH-IDX)
           END-IF.
      *
           IF   (WK-1001-PREFNUM         =  23           )
           AND  (COMB-KOHHKNNUM(KOH-IDX) = "781" OR "271")
           AND  (LNK-SYU-SRYYMD(1:6)    >= "201504"      )
                   MOVE     ZERO     TO    WK-NYUKFTNRATE
                   MOVE     SPACE    TO    FLG-CHIHOU(KOH-IDX)
           END-IF.
      *
           MOVE      ZERO      TO        FLG-MIYAGI.
           IF     (WK-1001-PREFNUM         =  04           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "183" OR "483") AND
                  (LNK-SYU-SRYYMD(1:6)    >= "200510"      ) AND
                  (LNK-SYU-SRYYMD(1:6)    <  "200610"      )
      *
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    COMB-KOHHKNNUM(KOH-IDX)
                                             TO  PTKOH-KOHNUM
                MOVE    LNK-SYU-SRYYMD       TO  PTKOH-TEKSTYMD
                MOVE    LNK-SYU-SRYYMD       TO  PTKOH-TEKEDYMD
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key6"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key6"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF   PTKOH-KOHID  =  COMB-KOHID(KOH-IDX)
                           EVALUATE  PTKOH-FTNJANUM(1:7)
                             WHEN    "8304004"
                             WHEN    "8304009"
                             WHEN    "8304017"
                             WHEN    "8304023"
                             WHEN    "8304026"
                             WHEN    "8304028"
                             WHEN    "8304036"
                             WHEN    "8304041"
                               MOVE    1    TO  FLG-MIYAGI
                           END-EVALUATE
                           MOVE    1        TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key6"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key6"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
      *
           END-IF.
           IF    ((WK-1001-PREFNUM         =  04           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "183" OR "483") AND
                  (LNK-SYU-SRYYMD(1:6)    >= "200610"      ))
           OR    ((WK-1001-PREFNUM         =  04           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "583" OR "783") AND
                  (LNK-SYU-SRYYMD(1:6)    >= "201010"      ))
           OR    ((WK-1001-PREFNUM         =  04           ) AND
                  (COMB-KOHHKNNUM(KOH-IDX) = "263" OR "363"
                                          OR "463" OR "563") AND
                  (LNK-SYU-SRYYMD(1:6)    >= "201310"      ))
      *
                INITIALIZE                       PTKOHINF-REC
                MOVE    LNK-SYU-HOSPNUM      TO  PTKOH-HOSPNUM
                MOVE    LNK-SYU-PTID         TO  PTKOH-PTID
                MOVE    COMB-KOHHKNNUM(KOH-IDX)
                                             TO  PTKOH-KOHNUM
                MOVE    LNK-SYU-SRYYMD       TO  PTKOH-TEKSTYMD
                MOVE    LNK-SYU-SRYYMD       TO  PTKOH-TEKEDYMD
                MOVE    PTKOHINF-REC         TO  MCPDATA-REC
                MOVE    "DBSELECT"           TO  MCP-FUNC
                MOVE    "tbl_ptkohinf"       TO  MCP-TABLE
                MOVE    "key6"               TO  MCP-PATHNAME
                CALL    "ORCDBMAIN"          USING  MCPAREA
                                                    MCPDATA-REC
                                                    SPA-AREA
                IF      MCP-RC               =       ZERO
                    MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                    MOVE    "key6"           TO  MCP-PATHNAME
                    PERFORM  PTKOHINF-READ-SEC
                    PERFORM  UNTIL   FLG-PTKOHINF    =   1
                        IF   PTKOH-KOHID  =  COMB-KOHID(KOH-IDX)
                           EVALUATE  PTKOH-FTNJANUM(1:7)
                             WHEN    "8304017"
                             WHEN    "8304028"
                               MOVE    1    TO  FLG-MIYAGI
                             WHEN    "8304079"
                               IF  LNK-SYU-SRYYMD(1:6) <= "201409"
                                 MOVE  1    TO  FLG-MIYAGI
                               END-IF
                           END-EVALUATE
                           MOVE    1        TO  FLG-PTKOHINF
                        ELSE
                           MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                           MOVE    "key6"           TO  MCP-PATHNAME
                           PERFORM  PTKOHINF-READ-SEC
                        END-IF
                    END-PERFORM
                END-IF
                MOVE    "tbl_ptkohinf"   TO  MCP-TABLE
                MOVE    "key6"           TO  MCP-PATHNAME
                PERFORM  DB-CLOSE-SEC
      *
           END-IF.
      *
      *    ËÌ³¤Æ»¡¦ÆÃÄê¼À´µ¡Ê£°£µ£±¡Ë¡ÊÆ»Ã±ÆÈ»ö¶È¡Ë
           IF    WK-DOTANDOKUFLG(KOH-IDX)  =   1
               MOVE    "1"       TO   WK-NYUSKJRYYKBN
               MOVE    9999999   TO   WK-TAIHI-NYUJGNGAK(KOH-IDX)
           END-IF.
      *
           IF     LNK-SYU-SRYYMD(1:6)     >=  "200604"
             IF   WK-2010-SKJKEIKBN(KOH-IDX)  =  "1"  OR  "2"
               EVALUATE   WK-2010-SKJKEIKBN(KOH-IDX)
                 WHEN       "1"
                    MOVE    2    TO   FLG-NYUSKJJYOGAK
                 WHEN       "2"
                    MOVE    1    TO   FLG-NYUSKJJYOGAK
               END-EVALUATE
               PERFORM    23065-SKJKBN-HENSYU2-SEC
             ELSE
               PERFORM    23064-SKJKBN-HENSYU-SEC
             END-IF
           ELSE
             IF ((WK-1001-PREFNUM          =   11           ) AND
                 (COMB-KOHHKNNUM(KOH-IDX)  =  "352" OR "353"
                                                    OR "354"))
             OR ( FLG-MIYAGI          NOT  =   ZERO          )
             OR ((WK-1001-PREFNUM          =   08           ) AND
                 (COMB-KOHHKNNUM(KOH-IDX)  =  "146"
                                           OR "183" OR "185") AND
                 (LNK-SYU-SRYYMD(1:6)    >= "200511"
                                     AND <= "200703"        ))
                 EVALUATE   WK-SYOTOKU-SKJKBN(1)
                     WHEN      SPACE
                       MOVE    390    TO   WK-NYUSKJJYOGAK
                     WHEN      "1"
                     WHEN      "4"
                       MOVE    150    TO   WK-NYUSKJJYOGAK
                     WHEN      "2"
                       MOVE    325    TO   WK-NYUSKJJYOGAK
                     WHEN      "3"
                       MOVE    250    TO   WK-NYUSKJJYOGAK
                 END-EVALUATE
             END-IF
           END-IF.
      *
           IF    LNK-SYU-SRYYMD(1:6)  >=  "201501"
             IF     COMB-KOHHKNNUM(KOH-IDX)   =  "054"
      ***      MOVE     "1"    TO   WK-NYUSKJRYYKBN
               IF   WK-TOKUSITU-SKJ(KOH-IDX)  =   1
                  MOVE   1     TO   FLG-NYUSKJJYOGAK
               END-IF
               IF  (WK-TOKUSITU-SKJ(KOH-IDX)        =   9)
               AND (WK-TOKUSITU-SKJGENMEN(KOH-IDX)  =   1)
                  MOVE  "3"    TO   WK-NYUSKJRYYKBN
                  MOVE  ZERO   TO   FLG-NYUSKJJYOGAK
               END-IF
               IF  (WK-TOKUSITU-SKJ(KOH-IDX)        =   3)
               AND (WK-TOKUSITU-SKJGENMEN(KOH-IDX)  =   1)
                  MOVE  "3"    TO   WK-NYUSKJRYYKBN
                  MOVE  ZERO   TO   FLG-NYUSKJJYOGAK
               END-IF
             END-IF
             IF     COMB-KOHHKNNUM(KOH-IDX)   =  "052"
      ***      MOVE     "1"    TO   WK-NYUSKJRYYKBN
               MOVE      1     TO   FLG-NYUSKJJYOGAK
               IF   WK-TOKUSITU-SKJ(KOH-IDX)  =   2
                  MOVE  "3"    TO   WK-NYUSKJRYYKBN
                  MOVE  ZERO   TO   FLG-NYUSKJJYOGAK
               END-IF
               IF  (WK-TOKUSITU-SKJ(KOH-IDX)        =   9)
               AND (WK-TOKUSITU-SKJGENMEN(KOH-IDX)  =   1)
                  MOVE  "3"    TO   WK-NYUSKJRYYKBN
                  MOVE  ZERO   TO   FLG-NYUSKJJYOGAK
               END-IF
             END-IF
           END-IF.
      *
           MOVE   ZERO   TO   FLG-SKJ-HANGAKCHK.
           IF     LNK-SYU-SRYYMD(1:6)  >=  "201501"
             EVALUATE  KOH-IDX
               WHEN      2
                 IF     LNK-SYU-SKJ-FTN(1)      =  ZERO
                   MOVE       1    TO   FLG-SKJ-HANGAKCHK
                 ELSE
                   IF   ((COMB-KOHHKNNUM(1)       = "054"         ) AND
                         (WK-TOKUSITU-SKJ(1)      =  1            ))
                   OR   ((COMB-KOHHKNNUM(1)       = "024" OR "079") AND
                         (WK-SYOGAI-SKJGENMEN(1)  =  ZERO         ))
                     MOVE     2    TO   FLG-SKJ-HANGAKCHK
                   END-IF
                   IF     COMB-KOHHKNNUM(1)       = "052"
                     IF ( WK-TOKUSITU-SKJ(1)        =   2 )
                     OR ((WK-TOKUSITU-SKJ(1)        =   9) AND
                         (WK-TOKUSITU-SKJGENMEN(1)  =   1))
                       CONTINUE
                     ELSE
                       MOVE   2    TO   FLG-SKJ-HANGAKCHK
                     END-IF
                   END-IF
                 END-IF
               WHEN      3
                 IF     LNK-SYU-SKJ-FTN(1)      =  ZERO
                 OR     LNK-SYU-SKJ-FTN(2)      =  ZERO
                   MOVE       1    TO   FLG-SKJ-HANGAKCHK
                 ELSE
                   IF   ((COMB-KOHHKNNUM(1)       = "054"         ) AND
                         (WK-TOKUSITU-SKJ(1)      =  1            ))
                   OR   ((COMB-KOHHKNNUM(1)       = "024" OR "079") AND
                         (WK-SYOGAI-SKJGENMEN(1)  =  ZERO         ))
                     MOVE     2    TO   FLG-SKJ-HANGAKCHK
                   END-IF
                   IF     COMB-KOHHKNNUM(1)       = "052"
                     IF ( WK-TOKUSITU-SKJ(1)        =   2 )
                     OR ((WK-TOKUSITU-SKJ(1)        =   9) AND
                         (WK-TOKUSITU-SKJGENMEN(1)  =   1))
                       CONTINUE
                     ELSE
                       MOVE   2    TO   FLG-SKJ-HANGAKCHK
                     END-IF
                   END-IF
                 END-IF
               WHEN      4
                 IF     LNK-SYU-SKJ-FTN(1)      =  ZERO
                 OR     LNK-SYU-SKJ-FTN(2)      =  ZERO
                 OR     LNK-SYU-SKJ-FTN(3)      =  ZERO
                   MOVE       1    TO   FLG-SKJ-HANGAKCHK
                 ELSE
                   IF   ((COMB-KOHHKNNUM(1)       = "054"         ) AND
                         (WK-TOKUSITU-SKJ(1)      =  1            ))
                   OR   ((COMB-KOHHKNNUM(1)       = "024" OR "079") AND
                         (WK-SYOGAI-SKJGENMEN(1)  =  ZERO         ))
                     MOVE     2    TO   FLG-SKJ-HANGAKCHK
                   END-IF
                   IF     COMB-KOHHKNNUM(1)       = "052"
                     IF ( WK-TOKUSITU-SKJ(1)        =   2 )
                     OR ((WK-TOKUSITU-SKJ(1)        =   9) AND
                         (WK-TOKUSITU-SKJGENMEN(1)  =   1))
                       CONTINUE
                     ELSE
                       MOVE   2    TO   FLG-SKJ-HANGAKCHK
                     END-IF
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF.
      *
           IF    FLG-NYUSKJJYOGAK  =  3
             EVALUATE  FLG-SKJ-HANGAKCHK
               WHEN      ZERO
                 MOVE          1     TO  FLG-NYUSKJJYOGAK
               WHEN       1
                 MOVE         ZERO   TO  FLG-NYUSKJJYOGAK
                 MOVE         "3"    TO  WK-NYUSKJRYYKBN
               WHEN       2
                 CONTINUE
             END-EVALUATE
           END-IF.
      *
      *    Ê¡²¬¸©¤ÎÃÏÊý¸øÈñÂÐ±þ¡Ê¸øÈñÉÕ²Ã¾ðÊó¤Î¼èÆÀ¡Ë
           MOVE     SPACE     TO     WK-KOH-FTNKBN.
           IF  (WK-1001-PREFNUM           =       40)    AND
               (COMB-KOHHKNNUM(KOH-IDX)(1:1)  >= "1")    AND
               (COMB-KOHHKNNUM(KOH-IDX)(1:1)  <= "8")
               PERFORM     23061-KOHPLUS-FUKUOKA-SEC
           END-IF.
      *
           IF  ((WK-1001-PREFNUM         =  13           ) AND
                (COMB-KOHHKNNUM(KOH-IDX) = "588"         ) AND
                (LNK-SYU-SRYYMD(1:6)    >= "200710"      ) AND
                (LNK-SYU-SRYYMD(1:6)    <= "200909"      ))
           OR  ((WK-1001-PREFNUM         =  31           ) AND
                (COMB-KOHHKNNUM(KOH-IDX) = "281" OR "282"
                                                 OR "283") AND
                (LNK-SYU-SRYYMD(1:6)    >= "200804"      ) AND
                (WK-TOTORI-JIRITU        =  1            ))
                    MOVE    SPACE   TO   COMB-KOH-NYUJGNKBN(KOH-IDX)
                    MOVE    ZERO    TO   WK-NYUKFTNRATE
           END-IF.
      *
           IF  ((WK-2010-SYOKEIKBN-N(KOH-IDX)  =  "1"    ) AND
                (LNK-S02-SYOSINFLG             =  SPACE  ))
           OR  ((WK-2010-SYOKEIKBN-N(KOH-IDX)  =  "1"    ) AND
                (LNK-S02-SYOSINFLG2            =  "1"    ))
                    MOVE    SPACE   TO   COMB-KOH-NYUJGNKBN(KOH-IDX)
                    MOVE    ZERO    TO   WK-NYUKFTNRATE
           END-IF.
      *
           MOVE     ZERO            TO   FLG-ICHIBU-JYOSEI.
           IF  (WK-2010-SYOKEI2KBN-N(KOH-IDX) = "1"  )
           AND (LNK-S02-SYOSINFLG             = "1"  )
           AND (LNK-S02-SYOSINFLG2            = SPACE)
                    MOVE     1      TO   FLG-ICHIBU-JYOSEI
      **************MOVE     2      TO   FLG-ICHIBU-JYOSEI
           END-IF.
      *
           IF  (WK-1001-PREFNUM         =  43           ) AND
               (COMB-KOHHKNNUM(KOH-IDX) = "143" OR "342") AND
               (LNK-SYU-SRYYMD(1:6)    >= "200912"      )
            MOVE       "1"       TO   LNK-S02-TOKUSYU-SAI-KBN
            IF    COMB-KOH-NYUJGNKBN(KOH-IDX)  =  SPACE
             MOVE      ZERO      TO   WK-KUMAMOTO-SYUCOMPFTN
            ELSE
             IF   LNK-S02-KOUREI-NYUIN-KBN   =  "1"
             OR   FLG-KOREI-TANYUIN          =   1
               MOVE      100     TO   WK-NYUKFTNRATE
               MOVE    SPACE     TO   COMB-KOH-NYUJGNKBN(KOH-IDX)
               MOVE    ZERO      TO   WK-KUMAMOTO-SYUCOMPFTN
             ELSE
               COMPUTE  WK-KUMAMOTO-HANTEIKIN = WK-KUMAMOTO-HANTEIKIN
                                              + WK-KUMAMOTO-SYUCOMPFTN
               IF  (LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                   (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                   (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                   (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974")
                 MOVE      1          TO   FLG-KUMAMOTO-CYO
               ELSE
                 EVALUATE   KOH-IDX
                   WHEN       1
                     MOVE  MAX-KIN-KOHI1-M  TO  WK-KUMAMOTO-HANTEIJGN
                   WHEN       2
                     MOVE  MAX-KIN-KOHI2-M  TO  WK-KUMAMOTO-HANTEIJGN
                   WHEN       3
                     MOVE  MAX-KIN-KOHI3-M  TO  WK-KUMAMOTO-HANTEIJGN
                   WHEN       4
                     MOVE  MAX-KIN-KOHI4-M  TO  WK-KUMAMOTO-HANTEIJGN
                 END-EVALUATE
                 IF   WK-KUMAMOTO-HANTEIKIN  >= WK-KUMAMOTO-HANTEIJGN
                   MOVE      100     TO   WK-NYUKFTNRATE
                   MOVE    SPACE     TO   COMB-KOH-NYUJGNKBN(KOH-IDX)
                   IF  FLG-GENBUTU70  NOT =  ZERO
                      MOVE   "1"     TO   FLG-SYOUKAN(KOH-IDX)
                   END-IF
                 END-IF
               END-IF
             END-IF
            END-IF
           END-IF.
           IF  (WK-1001-PREFNUM         =  43           ) AND
               (COMB-KOHHKNNUM(KOH-IDX) = "343"         ) AND
               (LNK-SYU-SRYYMD(1:6)    >= "201204"      )
             IF   LNK-S02-KOUREI-NYUIN-KBN   =  "1"
             OR   FLG-KOREI-TANYUIN          =   1
               MOVE      100     TO   WK-NYUKFTNRATE
               MOVE    SPACE     TO   COMB-KOH-NYUJGNKBN(KOH-IDX)
             END-IF
           END-IF.
      *
           IF   WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"
                COMPUTE   WK-IRYOKEIKBN-HANTEITEN  =
                          WK-IRYOKEIKBN-HANTEITEN  +
                          LNK-SYU-TOTAL-HKNTEN
      *
                EVALUATE   KOH-IDX
                  WHEN        1
                    MOVE  MAX-KIN-KOHI1-M  TO  WK-IRYOKEIKBN-MAXTEN
                  WHEN        2
                    MOVE  MAX-KIN-KOHI2-M  TO  WK-IRYOKEIKBN-MAXTEN
                  WHEN        3
                    MOVE  MAX-KIN-KOHI3-M  TO  WK-IRYOKEIKBN-MAXTEN
                  WHEN        4
                    MOVE  MAX-KIN-KOHI4-M  TO  WK-IRYOKEIKBN-MAXTEN
                END-EVALUATE
           END-IF.
      *
      *    ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°ÀßÄê³ÛÌ¤Ëþ¡¦°Ê¾å¤Ç°Û¤Ê¤ëÉéÃ´¶â·×»»
      *    ÀßÄê¡Ö£³¡×¡Ö£´¡×¤Î¥Á¥§¥Ã¥¯
           IF   WK-2010-IRYOKEIKBN-N(KOH-IDX) = "3" OR "4"
                MOVE      "1"     TO    LNK-S02-TOKUSYU-SAI-KBN
                PERFORM   23066-IRYOKEIKBN-CHECK-SEC
           END-IF.
      *
           IF  (COMB-KOHHKNNUM(KOH-IDX)(1:2)  = "99"  ) AND
               (WK-NYUKFTNRATE                =  ZERO )
                    MOVE    WK-KOH-FTNRATE   TO   WK-NYUKFTNRATE
           END-IF.
      *
           IF  (COMB-KOHHKNNUM(KOH-IDX)         =  "092")
           AND (WK-KOHJGNGET-CHECK092(KOH-IDX)  =   1   )
                   MOVE    100     TO  WK-NYUKFTNRATE
                   MOVE    SPACE   TO  COMB-KOH-NYUJGNKBN(KOH-IDX)
                   MOVE    7       TO  LNK-SYU-NYNSHOKAISU
           END-IF.
      *
           IF  (LNK-SYU-SRYYMD(1:6)     >= "200604"               )
           AND (COMB-KOHHKNNUM(KOH-IDX)  = "015" OR "016" OR "021")
           AND (WK-JIRITU-CYUKANSOU(KOH-IDX)   =  1               )
                   MOVE    1       TO  LNK-SYU-NYNSHOKAISU
           END-IF.
      *
           IF  ((LNK-S02-KOUREI-NYUIN-KBN        =     "1" ) OR
                (FLG-GENBUTU70               NOT =     ZERO) OR
                (FLG-KOUGAKUCYO-JIRITU       NOT =     ZERO))
           AND ( COMB-KOHHKNNUM(KOH-IDX)(1:1)   >=     "1"  )
           AND ( COMB-KOHHKNNUM(KOH-IDX)(1:1)   <=     "8"  )
           AND ( COMB-KOH-NYUJGNKBN(KOH-IDX)     =   SPACE  )
           AND ( WK-NYUKFTNRATE                  =     100
                                                OR      30  )
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
           END-IF.
      *
           IF    LNK-S02-KOUREI-NYUIN-KBN    =   "1"
             IF   WK-2010-KINJYOKBN-N(KOH-IDX)   = "1"
                    MOVE  "1"   TO    FLG-SYOUKAN(KOH-IDX)
             END-IF
             IF   WK-2010-IRYOKEIKBN-N(KOH-IDX)  = "1" OR "2"
      ***       IF   WK-2010-IRYOKEIKBN-N-XXX(KOH-IDX) = "1"
      ***         IF  (WK-1001-PREFNUM     =   11      )
      ***         AND (COMB-KOHHKNNUM(KOH-IDX)  =
      ***              "542" OR "682" OR "462" OR "762")
      ***           MOVE  "1"   TO    FLG-SYOUKAN(KOH-IDX)
      ***         END-IF
      ***       ELSE
                    MOVE  "1"   TO    FLG-SYOUKAN(KOH-IDX)
      ***       END-IF
             END-IF
           END-IF.
      *
           IF    FLG-GENBUTU70   NOT =  ZERO
             IF   WK-2010-KINJYOKBN-N(KOH-IDX)   = "1"
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
             END-IF
             IF   WK-2010-IRYOKEIKBN-N(KOH-IDX)  = "1" OR "2"
                 MOVE    "1"    TO    FLG-SYOUKAN(KOH-IDX)
             END-IF
           END-IF.
      *
           IF   FLG-CHIHOU(KOH-IDX)  =  "1"
             IF    WK-NYUKFTNRATE  =  ZERO
                 MOVE  SPACE  TO  COMB-KOH-NYUJGNKBN(KOH-IDX)
             END-IF
           END-IF.
      *
           IF   (WK-GENGAKUKBN        =   3 OR 4)
           AND  (FLG-SAIGAI-TAISYO    =   1     )
           AND  (LNK-SYU-SRYYMD(1:6) <= "201202")
                 MOVE   "3"   TO  WK-NYUSKJRYYKBN
           END-IF.
      *
      *    Îß·×¥Ù¡¼¥¹·×»»
           IF    FLG-RUIKEIYO   =  1
             EVALUATE  KOH-IDX
               WHEN      1
                 IF    WK-KOH-FTNRATE   NOT = ZERO
                   IF  WK-NYUKFTNRATE   NOT = ZERO
                     MOVE  WK-NYUKFTNRATE    TO  WK-RUI-FTNRATE
                   ELSE
                     MOVE  WK-KOH-FTNRATE    TO  WK-RUI-FTNRATE
                   END-IF
                 END-IF
               WHEN      2
                 IF   (WK-RUI-FTNRATE     NOT = ZERO               )
                 AND  (LNK-SYU-KOH-HKNNUM(2)(1:1) >= "1" AND <= "8")
                 AND  (WK-TOKATUKAI(2)        = ZERO               )
                   IF  WK-NYUKFTNRATE     NOT = ZERO
                     IF   WK-RUI-FTNRATE  >  WK-NYUKFTNRATE
                       IF COMB-KOH-NYUJGNKBN(2)  =  "1"
                         IF ( MAX-KIN-KOHI2-M  NOT = ZERO )
                         OR ( MAX-KIN-KOHI2-D  NOT = ZERO )
                           MOVE   1    TO  WK-RUI-TAISYO
                           PERFORM   23062-FTNGAK-HENSYU-SEC
                           MOVE   1    TO  FLG-RUIKEIYO2
                           PERFORM   23063-ZAN-HENSYU-SEC
                         END-IF
                       ELSE
                         MOVE   1    TO  WK-RUI-TAISYO
                         MOVE  "1"   TO  COMB-KOH-NYUJGNKBN(2)
                         PERFORM   23062-FTNGAK-HENSYU-SEC
                         MOVE   2    TO  FLG-RUIKEIYO2
                         PERFORM   23063-ZAN-HENSYU-SEC
                       END-IF
                     ELSE
                       IF   WK-RUI-FTNRATE  =  WK-NYUKFTNRATE
                         IF COMB-KOH-NYUJGNKBN(2)  =  "1"
                           IF  (MAX-KIN-KOHI2-D  NOT = ZERO)
                           AND (MAX-KIN-KOHI2-D  NOT =
                                            MAX-KIN-KOHI2-M)
                             MOVE   1    TO  WK-RUI-TAISYO
                             PERFORM   23062-FTNGAK-HENSYU-SEC
                             MOVE   1    TO  FLG-RUIKEIYO2
                             PERFORM   23063-ZAN-HENSYU-SEC
                           END-IF
                         END-IF
                       END-IF
                     END-IF
                   ELSE
                     IF COMB-KOH-NYUJGNKBN(2)  =  "1"
                       IF  (MAX-KIN-KOHI2-D  NOT = ZERO)
                       AND (MAX-KIN-KOHI2-D  NOT =
                                        MAX-KIN-KOHI2-M)
                         MOVE   1    TO  WK-RUI-TAISYO
                         PERFORM   23062-FTNGAK-HENSYU-SEC
                         MOVE   1    TO  FLG-RUIKEIYO2
                         PERFORM   23063-ZAN-HENSYU-SEC
                       END-IF
                       IF  (WK-1001-PREFNUM       =  43           )
                       AND (LNK-SYU-KOH-HKNNUM(2) = "143" OR "342")
                       AND (LNK-SYU-SRYYMD(1:6)  >= "200912"      )
                         MOVE   1    TO  WK-RUI-TAISYO
                         PERFORM   23062-FTNGAK-HENSYU-SEC
                         IF  FLG-KUMAMOTO-CYO  =  1
                           MOVE   1    TO  FLG-RUIKEIYO2
                         ELSE
                           MOVE   2    TO  FLG-RUIKEIYO2
                         END-IF
                         PERFORM   23063-ZAN-HENSYU-SEC
                       END-IF
                       IF  (WK-1001-PREFNUM       =  43           )
                       AND (LNK-SYU-KOH-HKNNUM(2) = "343"         )
                       AND (LNK-SYU-SRYYMD(1:6)  >= "201204"      )
                         MOVE   1    TO  WK-RUI-TAISYO
                         PERFORM   23062-FTNGAK-HENSYU-SEC
                         MOVE   1    TO  FLG-RUIKEIYO2
                         PERFORM   23063-ZAN-HENSYU-SEC
                       END-IF
                     ELSE
                       IF  (WK-1001-PREFNUM       =  43           )
                       AND (LNK-SYU-KOH-HKNNUM(2) = "143" OR "342")
                       AND (LNK-SYU-SRYYMD(1:6)  <= "200911"      )
                           MOVE   1    TO  WK-RUI-TAISYO
                           MOVE  "1"   TO  COMB-KOH-NYUJGNKBN(2)
                           PERFORM   23062-FTNGAK-HENSYU-SEC
                           MOVE   2    TO  FLG-RUIKEIYO2
                           PERFORM   23063-ZAN-HENSYU-SEC
                       END-IF
                       IF  (WK-1001-PREFNUM       =  13     )
                       AND (LNK-SYU-KOH-HKNNUM(2) = "588"   )
                       AND (LNK-SYU-SRYYMD(1:6)  <= "200909")
                         IF ( WK-KOH-FTNRATE  = 10             )
                         OR ((WK-KOH-FTNRATE  > 10            ) AND
                             (LNK-SYU-KOH-HKNNUM(1)
                                     = "038" OR "051" OR "052"))
                           MOVE   1    TO  WK-RUI-TAISYO
                           MOVE  "1"   TO  COMB-KOH-NYUJGNKBN(2)
                           PERFORM   23062-FTNGAK-HENSYU-SEC
                           MOVE   2    TO  FLG-RUIKEIYO2
                           PERFORM   23063-ZAN-HENSYU-SEC
                         END-IF
                       END-IF
                     END-IF
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF.
      *
           IF  (  KOH-IDX               =  2     )
           AND (  WK-RUI-TAISYO         =  1     )
           AND (  WK-2010-KINJYOKBN-N(1)
                                        = "1"    )
           AND (((WK-NYUKFTNRATE    NOT =  ZERO) AND
                 (COMB-KOH-NYUJGNKBN(2) = "1"  )) OR
                ( WK-DAYINFFLG(2)       =  1    ))
             MOVE       1    TO   FLG-MARUTOARI
             IF WK-DAYINFFLG(2)    NOT  =  1
               MOVE     1    TO   FLG-MARUTOARI2
               COMPUTE WK-ZENGAKU  =   WK-ZENGAKU  +  WK-RUI-ZENGAKU
             END-IF
           END-IF.
      *
           MOVE   ZAN-KOHI-T (KOH-IDX)
                             TO   WK-DAYINF-ZENKOH-ZAN-T(KOH-IDX)
                                  WK-TAIHI-ZAN-KOHI-T.
           MOVE   ZAN-KOHI-T2(KOH-IDX)
                             TO   WK-DAYINF-ZENKOH-ZAN-T2(KOH-IDX)
                                  WK-TAIHI-ZAN-KOHI-T2.
           MOVE   ZAN-KOHI-T3(KOH-IDX)
                             TO   WK-DAYINF-ZENKOH-ZAN-T3(KOH-IDX)
                                  WK-TAIHI-ZAN-KOHI-T3.
      *
           IF   COMB-KOH-NYUJGNKBN(KOH-IDX)  =  "1"
             IF   WK-NYUKFTNRATE  NOT =  ZERO
                 COMPUTE  WK-FUTANWARI      =  WK-NYUKFTNRATE
                                            /  100
                 COMPUTE  WK-SKYCHK-KEISAN  =  WK-ZENGAKU
                                            *  WK-FUTANWARI
                 IF  WK-SKYCHK-KEISAN9 < WK-SKYCHK-KEISAN
                   MOVE  WK-SKYCHK-KEISAN  TO  WK-SKYCHK-KEISAN9
                 END-IF
             ELSE
               IF  (COMB-KOHHKNNUM(KOH-IDX) = "972" OR "974")
               AND (FLG-ZENKI-TOKUREI       =  1            )
                 COMPUTE  WK-SKYCHK-KEISAN  =  WK-ZENGAKU
                                            *  0.2
                 IF  WK-SKYCHK-KEISAN9 < WK-SKYCHK-KEISAN
                   MOVE  WK-SKYCHK-KEISAN  TO  WK-SKYCHK-KEISAN9
                 END-IF
               END-IF
             END-IF
           ELSE
             IF   WK-NYUKFTNRATE  NOT =  ZERO
                 COMPUTE  WK-FUTANWARI      =  WK-NYUKFTNRATE
                                            /  100
                 COMPUTE  WK-SKYCHK-KEISAN  =  WK-ZENGAKU
                                            *  WK-FUTANWARI
                 IF  WK-SKYCHK-KEISAN9 < WK-SKYCHK-KEISAN
                   MOVE  WK-SKYCHK-KEISAN  TO  WK-SKYCHK-KEISAN9
                 END-IF
             ELSE
               IF  (COMB-KOHHKNNUM(KOH-IDX) = "019")
               AND (WK-NYUKFTNRATE019   NOT = ZERO )
                 COMPUTE  WK-FUTANWARI      =  WK-NYUKFTNRATE019
                                            /  100
                 COMPUTE  WK-SKYCHK-KEISAN  =  WK-ZENGAKU
                                            *  WK-FUTANWARI
                 IF  WK-SKYCHK-KEISAN9 < WK-SKYCHK-KEISAN
                   MOVE  WK-SKYCHK-KEISAN  TO  WK-SKYCHK-KEISAN9
                 END-IF
               END-IF
             END-IF
           END-IF.
      *
       2306-KOH-HKNREAD-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñÉÕ²Ã¾ðÊó¤Î¼èÆÀ¡ÊÊ¡²¬¸©ÂÐ±þ¡Ë                  *
      ******************************************************************
       23061-KOHPLUS-FUKUOKA-SEC           SECTION.
      *
           INITIALIZE                  ORCSKOHPLUS-AREA
           MOVE    LNK-SYU-HOSPNUM TO  LNK-SKOHPLUS-HOSPNUM
           MOVE    WK-1001-PREFNUM TO  LNK-SKOHPLUS-PREFNUM
           MOVE    LNK-SYU-PTID    TO  LNK-SKOHPLUS-PTID
           MOVE    LNK-SYU-HKNCOMBINUM
                                   TO  LNK-SKOHPLUS-HKNCOMBI
           MOVE    LNK-SYU-SRYYMD  TO  LNK-SKOHPLUS-SRYYMD
           CALL    "ORCSKOHPLUS"       USING
                                       ORCSKOHPLUS-AREA
                                       SPA-AREA
           IF      LNK-SKOHPLUS-RC =   ZERO
               MOVE   LNK-SKOHPLUS-FTNKBN    TO   WK-KOH-FTNKBN
               MOVE   LNK-SKOHPLUS-NYUSKJRYYKBN
                                             TO   WK-NYUSKJRYYKBN
               MOVE   WK-KOH-FTNRATE         TO   WK-NYUKFTNRATE
               IF     WK-NYUKFTNRATE  =  ZERO
                      MOVE    SPACE   TO  COMB-KOH-NYUJGNKBN(KOH-IDX)
               END-IF
           END-IF
           IF  (LNK-SKOHPLUS-RC     = ZERO)
           AND (LNK-SKOHPLUS-FTNKBN = "1" )
           AND (WK-NYUKFTNRATE  NOT = ZERO)
               CONTINUE
           ELSE
               MOVE    ZERO   TO   LNK-SYU-KYUFUGAI-SHOSHIN-TEN
                                   LNK-SYU-KYUFUGAI-SIDOU-TEN
                                   LNK-SYU-KYUFUGAI-OSIN1-TEN
                                   LNK-SYU-KYUFUGAI-OSIN2-TEN
                                   LNK-SYU-KYUFUGAI-OSIN3-TEN
                                   LNK-SYU-KYUFUGAI-GOKEI-TEN
           END-IF
      *
           .
      *
       23061-KOHPLUS-FUKUOKA-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÉéÃ´³ÛÊÔ½¸
      ******************************************************************
       23062-FTNGAK-HENSYU-SEC           SECTION.
      *
           IF    LNK-SYU-KOH1COMPFTN  >  LNK-SYU-SYUCOMPFTN
              MOVE   LNK-SYU-SYUCOMPFTN    TO   WK-RUI-COMPFTN-XXX
           ELSE
              MOVE   LNK-SYU-KOH1COMPFTN   TO   WK-RUI-COMPFTN-XXX
           END-IF
      *
           COMPUTE  WK-RUI-HKNFTNMONEY  =
                    WK-RUI-COMPFTN-XXX  +   5
           COMPUTE  WK-RUI-HKNFTNMONEY  =
                    WK-RUI-HKNFTNMONEY  /  10
           COMPUTE  WK-RUI-HKNFTNMONEY  =
                    WK-RUI-HKNFTNMONEY  *  10
      *
           IF    LNK-SYU-KOH1COMPFTN-ENTANI
                                      >  LNK-SYU-SYUCOMPFTN-ENTANI
              MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                           TO   WK-RUI-COMPFTN-ENTANI
           ELSE
              MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                           TO   WK-RUI-COMPFTN-ENTANI
           END-IF
           COMPUTE  WK-RUI-COMPFTN-ENTANI2 =
                    WK-RUI-COMPFTN-ENTANI  + 0.9
      *
           IF    WK-KOH-COMPFTN(1)  =  ALL"9"
              MOVE   LNK-SYU-KOH1COMPFTN   TO   WK-RUI-COMPFTN-XXX
           ELSE
              MOVE   WK-KOH-COMPFTN(1)     TO   WK-RUI-COMPFTN-XXX
           END-IF
      *
           IF    WK-RUI-COMPFTN-XXX   >  LNK-SYU-SYUCOMPFTN
              MOVE   LNK-SYU-SYUCOMPFTN    TO   WK-RUI-COMPFTN
           ELSE
              MOVE   WK-RUI-COMPFTN-XXX    TO   WK-RUI-COMPFTN
           END-IF
      *
           IF    LNK-SYU-KOH1SKJ-FTNKBN   =  "2"
                 ADD  LNK-SYU-KOH1SKJ-FTN    TO  WK-RUI-HKNFTNMONEY
                                                 WK-RUI-COMPFTN
                                                 WK-RUI-COMPFTN-ENTANI
                                                 WK-RUI-COMPFTN-ENTANI2
           END-IF
      *
           IF ((LNK-SYU-KOH1HKNNUM  =  "015" OR "016" OR "021") AND
               (WK-JIRITU-CYUKANSOU(1)   =  2                 ))
           OR ( LNK-SYU-KOH1HKNNUM  =  "024" OR "079" OR "038" )
           OR ((LNK-SYU-KOH1HKNNUM  =  "052" OR "054"         ) AND
               (LNK-SYU-SRYYMD(1:6)     >= "201501"           ))
           OR ((WK-TOKATUKAI(1)              =  1             ) AND
               (WK-KOHJGNGET-TAISYOKBN(1)    =  2             ))
              IF  FLG-TOKU75  = 1 OR 2 OR 3
               ADD  WK-RUI-FTN1-M-JI-TOKU75  TO  WK-RUI-HKNFTNMONEY
               ADD  WK-RUI-FTN1-M2-JI-TOKU75 TO  WK-RUI-COMPFTN
               ADD  WK-RUI-FTN1-M3-JI-TOKU75 TO  WK-RUI-COMPFTN-ENTANI
               ADD  WK-RUI-FTN1-M4-JI-TOKU75 TO  WK-RUI-COMPFTN-ENTANI2
              ELSE
               ADD  WK-RUI-FTN1-M-JI         TO  WK-RUI-HKNFTNMONEY
               ADD  WK-RUI-FTN1-M2-JI        TO  WK-RUI-COMPFTN
               ADD  WK-RUI-FTN1-M3-JI        TO  WK-RUI-COMPFTN-ENTANI
               ADD  WK-RUI-FTN1-M4-JI        TO  WK-RUI-COMPFTN-ENTANI2
              END-IF
           ELSE
            IF   WK-2010-KINJYOKBN-N(1) = "1"
               ADD  WK-RUI-FTN1-M            TO  WK-RUI-HKNFTNMONEY
               ADD  WK-RUI-FTN1-M2           TO  WK-RUI-COMPFTN
               ADD  WK-RUI-FTN1-M3           TO  WK-RUI-COMPFTN-ENTANI
               ADD  WK-RUI-FTN1-M4           TO  WK-RUI-COMPFTN-ENTANI2
            ELSE
              IF  FLG-TOKU75  = 1 OR 2 OR 3
               ADD  WK-RUI-FTN1-M-TOKU75     TO  WK-RUI-HKNFTNMONEY
               ADD  WK-RUI-FTN1-M2-TOKU75    TO  WK-RUI-COMPFTN
               ADD  WK-RUI-FTN1-M3-TOKU75    TO  WK-RUI-COMPFTN-ENTANI
               ADD  WK-RUI-FTN1-M4-TOKU75    TO  WK-RUI-COMPFTN-ENTANI2
              ELSE
               ADD  WK-RUI-FTN1-M            TO  WK-RUI-HKNFTNMONEY
               ADD  WK-RUI-FTN1-M2           TO  WK-RUI-COMPFTN
               ADD  WK-RUI-FTN1-M3           TO  WK-RUI-COMPFTN-ENTANI
               ADD  WK-RUI-FTN1-M4           TO  WK-RUI-COMPFTN-ENTANI2
              END-IF
            END-IF
           END-IF
      *
           .
      *
       23062-FTNGAK-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        »ÄÊÔ½¸
      ******************************************************************
       23063-ZAN-HENSYU-SEC           SECTION.
      *
           IF  WK-RUI-HKNFTNMONEY   NOT =  ZERO
               IF   WK-RUI-FTN2-M         >=  WK-RUI-HKNFTNMONEY
                    MOVE     ZERO         TO  ZAN-KOHI2-M
               ELSE
                    COMPUTE  ZAN-KOHI2-M  =   WK-RUI-HKNFTNMONEY -
                                              WK-RUI-FTN2-M
               END-IF
               EVALUATE  FLG-RUIKEIYO2
                 WHEN       1
                   IF  MAX-KIN-KOHI2-M   NOT  = ZERO
                     IF  ZAN-KOHI2   >  ZAN-KOHI2-M
                       MOVE   ZAN-KOHI2-M      TO  ZAN-KOHI2
                     END-IF
                   ELSE
                     MOVE     ZAN-KOHI2-M      TO  ZAN-KOHI2
                   END-IF
                 WHEN       2
                   MOVE       ZAN-KOHI2-M      TO  ZAN-KOHI2
               END-EVALUATE
           ELSE
               MOVE   ZERO      TO  ZAN-KOHI2
           END-IF
      *
           IF  WK-RUI-COMPFTN   NOT =  ZERO
               IF   WK-RUI-FTN2-M2        >=  WK-RUI-COMPFTN
                    MOVE     ZERO         TO  ZAN-KOHI2-M2
               ELSE
                    COMPUTE  ZAN-KOHI2-M2 =   WK-RUI-COMPFTN -
                                              WK-RUI-FTN2-M2
               END-IF
               EVALUATE  FLG-RUIKEIYO2
                 WHEN       1
                   IF  MAX-KIN-KOHI2-M   NOT  = ZERO
                     IF  ZAN-KOHI22  >  ZAN-KOHI2-M2
                       MOVE   ZAN-KOHI2-M2     TO  ZAN-KOHI22
                     END-IF
                   ELSE
                     MOVE     ZAN-KOHI2-M2     TO  ZAN-KOHI22
                   END-IF
                 WHEN       2
                   MOVE       ZAN-KOHI2-M2     TO  ZAN-KOHI22
               END-EVALUATE
           ELSE
               MOVE   ZERO      TO  ZAN-KOHI22
           END-IF
      *
      ***  IF    @@@
             IF  WK-RUI-COMPFTN-ENTANI2  NOT =  ZERO
               IF   WK-RUI-FTN2-M3        >=  WK-RUI-COMPFTN-ENTANI2
                    MOVE     ZERO         TO  ZAN-KOHI2-M3
               ELSE
                    COMPUTE  ZAN-KOHI2-M3 =   WK-RUI-COMPFTN-ENTANI2 -
                                              WK-RUI-FTN2-M3
               END-IF
               EVALUATE  FLG-RUIKEIYO2
                 WHEN       1
                   IF  MAX-KIN-KOHI2-M   NOT  = ZERO
                     IF  ZAN-KOHI23  >  ZAN-KOHI2-M3
                       MOVE   ZAN-KOHI2-M3     TO  ZAN-KOHI23
                     END-IF
                   ELSE
                     MOVE     ZAN-KOHI2-M3     TO  ZAN-KOHI23
                   END-IF
                 WHEN       2
                   MOVE       ZAN-KOHI2-M3     TO  ZAN-KOHI23
               END-EVALUATE
             ELSE
               MOVE   ZERO      TO  ZAN-KOHI23
             END-IF
      ***  ELSE
      ***    IF  WK-RUI-COMPFTN-ENTANI   NOT =  ZERO
      ***      IF   WK-RUI-FTN2-M3-XXX    >=  WK-RUI-COMPFTN-ENTANI
      ***           MOVE     ZERO         TO  ZAN-KOHI2-M3
      ***      ELSE
      ***           COMPUTE  ZAN-KOHI2-M3 =   WK-RUI-COMPFTN-ENTANI -
      ***                                     WK-RUI-FTN2-M3-XXX
      ***      END-IF
      ***      EVALUATE  FLG-RUIKEIYO2
      ***        WHEN       1
      ***          IF  MAX-KIN-KOHI2-M   NOT  = ZERO
      ***            IF  ZAN-KOHI23  >  ZAN-KOHI2-M3
      ***              MOVE   ZAN-KOHI2-M3     TO  ZAN-KOHI23
      ***            END-IF
      ***          ELSE
      ***            MOVE     ZAN-KOHI2-M3     TO  ZAN-KOHI23
      ***          END-IF
      ***        WHEN       2
      ***          MOVE       ZAN-KOHI2-M3     TO  ZAN-KOHI23
      ***      END-EVALUATE
      ***    ELSE
      ***      MOVE   ZERO      TO  ZAN-KOHI23
      ***    END-IF
      ***  END-IF
      *
           MOVE     1           TO  FLG-RUIKEIYO-DAY
      *
           .
      *
       23063-ZAN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¿©»öÎÅÍÜÈñ¶èÊ¬ÊÔ½¸
      ******************************************************************
       23064-SKJKBN-HENSYU-SEC           SECTION.
      *
           IF  ((WK-1001-PREFNUM         =  04           ) AND
                (COMB-KOHHKNNUM(KOH-IDX) = "183" OR "483") AND
                (LNK-SYU-SRYYMD(1:6)    >= "200510"      ) AND
                (FLG-MIYAGI              =  ZERO         ))
           OR  ((WK-1001-PREFNUM         =  04           ) AND
                (COMB-KOHHKNNUM(KOH-IDX) = "583" OR "783") AND
                (LNK-SYU-SRYYMD(1:6)    >= "201010"      ) AND
                (FLG-MIYAGI              =  ZERO         ))
           OR  ((WK-1001-PREFNUM         =  04           ) AND
                (COMB-KOHHKNNUM(KOH-IDX) =
                         "263" OR "363" OR "463" OR "563") AND
                (LNK-SYU-SRYYMD(1:6)    >= "201310"      ) AND
                (FLG-MIYAGI              =  ZERO         ))
              MOVE    "0"    TO   WK-2010-SKJRYOKBN-HON(KOH-IDX)
                                  WK-2010-SEIRYOKBN-HON(KOH-IDX)
                                  WK-2010-SEIKANKBN-HON(KOH-IDX)
              MOVE    "0"    TO   WK-2010-SKJRYOKBN-TSY(KOH-IDX)
                                  WK-2010-SEIRYOKBN-TSY(KOH-IDX)
                                  WK-2010-SEIKANKBN-TSY(KOH-IDX)
              MOVE    "0"    TO   WK-2010-SKJRYOKBN-TNK(KOH-IDX)
                                  WK-2010-SEIRYOKBN-TNK(KOH-IDX)
                                  WK-2010-SEIKANKBN-TNK(KOH-IDX)
           END-IF
      *
           EVALUATE   FLG-SANSHOU4
      *      ËÜ¿Í¥¿¥Ö
             WHEN       "1"
               EVALUATE  WK-NYUSKJRYYKBN
                 WHEN        "1"
                   IF ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "3") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "3") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "3") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "3") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
                     MOVE   "0"  TO   WK-2010-SKJRYOKBN-HON(KOH-IDX)
                                      WK-2010-SEIRYOKBN-HON(KOH-IDX)
                                      WK-2010-SEIKANKBN-HON(KOH-IDX)
                   END-IF
                   IF   WK-2010-SKJRYOKBN-HON(KOH-IDX) = "2"
                   AND  WK-2010-SEIRYOKBN-HON(KOH-IDX) = "2"
                   AND  WK-2010-SEIKANKBN-HON(KOH-IDX) = "2"
                     MOVE       1     TO  FLG-NYUSKJJYOGAK
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "2") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "2") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "2") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "2") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
                     MOVE       1     TO  FLG-NYUSKJJYOGAK
      *              À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÈ¾³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL2           =   1      )
                       IF   ( FLG-SEIKATUS          =  1   )
                       OR   ((FLG-SEIKATUL          =  1  ) AND
                             (WK-SHOKUJI-NISSUL NOT = ZERO))
                         MOVE  "8"    TO  WK-NYUSKJRYYKBN
                         MOVE  "3"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       ELSE
                         MOVE  ZERO   TO  FLG-NYUSKJJYOGAK
                       END-IF
                     END-IF
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "2") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "2") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
                     MOVE       1     TO  FLG-NYUSKJJYOGAK
      *              À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÈ¾³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL            =   1      )
                       IF     FLG-SEIKATUS   =   1
                         MOVE  "7"    TO  WK-NYUSKJRYYKBN
                         MOVE  "2"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       ELSE
                         MOVE  ZERO   TO  FLG-NYUSKJJYOGAK
                       END-IF
                     END-IF
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
      *              À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÁ´³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL2           =   1      )
                       IF   ( FLG-SEIKATUS          =  1   )
                       OR   ((FLG-SEIKATUL          =  1  ) AND
                             (WK-SHOKUJI-NISSUL NOT = ZERO))
                         MOVE  "9"    TO  WK-NYUSKJRYYKBN
                         MOVE  "4"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       END-IF
                     ELSE
                         MOVE  "3"    TO  WK-NYUSKJRYYKBN
                     END-IF
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
      *              À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÁ´³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL            =   1      )
                       IF     FLG-SEIKATUS   =   1
                         MOVE  "5"    TO  WK-NYUSKJRYYKBN
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       END-IF
                     ELSE
                         MOVE  "3"    TO  WK-NYUSKJRYYKBN
                     END-IF
                   END-IF
                   IF   WK-2010-SKJRYOKBN-HON(KOH-IDX) = "4"
                   AND  WK-2010-SEIRYOKBN-HON(KOH-IDX) = "4"
                   AND  WK-2010-SEIKANKBN-HON(KOH-IDX) = "4"
                     MOVE       3     TO  FLG-NYUSKJJYOGAK
                   END-IF
                 WHEN        "3"
                   IF ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "1"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "1"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "1"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "1"))
                     MOVE   "0"  TO   WK-2010-SKJRYOKBN-HON(KOH-IDX)
                                      WK-2010-SEIRYOKBN-HON(KOH-IDX)
                                      WK-2010-SEIKANKBN-HON(KOH-IDX)
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
      *              À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÁ´³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL2           =   1      )
                       IF   ( FLG-SEIKATUS          =  1   )
                       OR   ((FLG-SEIKATUL          =  1  ) AND
                             (WK-SHOKUJI-NISSUL NOT = ZERO))
                         MOVE  "9"    TO  WK-NYUSKJRYYKBN
                         MOVE  "4"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       ELSE
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN
                       END-IF
                     END-IF
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
      *              À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÁ´³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL            =   1      )
                       IF     FLG-SEIKATUS   =   1
                         MOVE  "5"    TO  WK-NYUSKJRYYKBN
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       ELSE
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN
                       END-IF
                     END-IF
                   END-IF
               END-EVALUATE
      *      Äã½êÆÀ¥¿¥Ö
             WHEN       "2"
               EVALUATE  WK-NYUSKJRYYKBN
                 WHEN        "1"
                   IF ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "3") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "3") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "3") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "3") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
                     MOVE   "0"  TO   WK-2010-SKJRYOKBN-TSY(KOH-IDX)
                                      WK-2010-SEIRYOKBN-TSY(KOH-IDX)
                                      WK-2010-SEIKANKBN-TSY(KOH-IDX)
                   END-IF
                   IF   WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "2"
                   AND  WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "2"
                   AND  WK-2010-SEIKANKBN-TSY(KOH-IDX) = "2"
                     MOVE       1     TO  FLG-NYUSKJJYOGAK
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "2") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "2") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "2") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "2") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
                     MOVE       1     TO  FLG-NYUSKJJYOGAK
      *              À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÈ¾³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL2           =   1      )
                       IF   ( FLG-SEIKATUS          =  1   )
                       OR   ((FLG-SEIKATUL          =  1  ) AND
                             (WK-SHOKUJI-NISSUL NOT = ZERO))
                         MOVE  "8"    TO  WK-NYUSKJRYYKBN
                         MOVE  "3"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       ELSE
                         MOVE  ZERO   TO  FLG-NYUSKJJYOGAK
                       END-IF
                     END-IF
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "2") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "2") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
                     MOVE       1     TO  FLG-NYUSKJJYOGAK
      *              À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÈ¾³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL            =   1      )
                       IF     FLG-SEIKATUS   =   1
                         MOVE  "7"    TO  WK-NYUSKJRYYKBN
                         MOVE  "2"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       ELSE
                         MOVE  ZERO   TO  FLG-NYUSKJJYOGAK
                       END-IF
                     END-IF
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
      *              À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÁ´³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL2           =   1      )
                       IF   ( FLG-SEIKATUS          =  1   )
                       OR   ((FLG-SEIKATUL          =  1  ) AND
                             (WK-SHOKUJI-NISSUL NOT = ZERO))
                         MOVE  "9"    TO  WK-NYUSKJRYYKBN
                         MOVE  "4"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       END-IF
                     ELSE
                         MOVE  "3"    TO  WK-NYUSKJRYYKBN
                     END-IF
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
      *              À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÁ´³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL            =   1      )
                       IF     FLG-SEIKATUS   =   1
                         MOVE  "5"    TO  WK-NYUSKJRYYKBN
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       END-IF
                     ELSE
                         MOVE  "3"    TO  WK-NYUSKJRYYKBN
                     END-IF
                   END-IF
                   IF   WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "4"
                   AND  WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "4"
                   AND  WK-2010-SEIKANKBN-TSY(KOH-IDX) = "4"
                     MOVE       3     TO  FLG-NYUSKJJYOGAK
                   END-IF
                 WHEN        "3"
                   IF ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "1"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "1"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "1"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "1"))
                     MOVE   "0"  TO   WK-2010-SKJRYOKBN-TSY(KOH-IDX)
                                      WK-2010-SEIRYOKBN-TSY(KOH-IDX)
                                      WK-2010-SEIKANKBN-TSY(KOH-IDX)
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
      *              À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÁ´³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL2           =   1      )
                       IF   ( FLG-SEIKATUS          =  1   )
                       OR   ((FLG-SEIKATUL          =  1  ) AND
                             (WK-SHOKUJI-NISSUL NOT = ZERO))
                         MOVE  "9"    TO  WK-NYUSKJRYYKBN
                         MOVE  "4"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       ELSE
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN
                       END-IF
                     END-IF
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
      *              À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÁ´³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL            =   1      )
                       IF     FLG-SEIKATUS   =   1
                         MOVE  "5"    TO  WK-NYUSKJRYYKBN
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       ELSE
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN
                       END-IF
                     END-IF
                   END-IF
               END-EVALUATE
      *      ÄãÇ¯¶â¥¿¥Ö
             WHEN       "3"
               EVALUATE  WK-NYUSKJRYYKBN
                 WHEN        "1"
                   IF ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "3") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "3") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "3") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "3") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
                     MOVE   "0"  TO   WK-2010-SKJRYOKBN-TNK(KOH-IDX)
                                      WK-2010-SEIRYOKBN-TNK(KOH-IDX)
                                      WK-2010-SEIKANKBN-TNK(KOH-IDX)
                   END-IF
                   IF   WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "2"
                   AND  WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "2"
                   AND  WK-2010-SEIKANKBN-TNK(KOH-IDX) = "2"
                     MOVE       1     TO  FLG-NYUSKJJYOGAK
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "2") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "2") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "2") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "2") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
                     MOVE       1     TO  FLG-NYUSKJJYOGAK
      *              À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÈ¾³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL2           =   1      )
                       IF   ( FLG-SEIKATUS          =  1   )
                       OR   ((FLG-SEIKATUL          =  1  ) AND
                             (WK-SHOKUJI-NISSUL NOT = ZERO))
                         MOVE  "8"    TO  WK-NYUSKJRYYKBN
                         MOVE  "3"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       ELSE
                         MOVE  ZERO   TO  FLG-NYUSKJJYOGAK
                       END-IF
                     END-IF
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "2") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "2") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
                     MOVE       1     TO  FLG-NYUSKJJYOGAK
      *              À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÈ¾³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL            =   1      )
                       IF     FLG-SEIKATUS   =   1
                         MOVE  "7"    TO  WK-NYUSKJRYYKBN
                         MOVE  "2"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       ELSE
                         MOVE  ZERO   TO  FLG-NYUSKJJYOGAK
                       END-IF
                     END-IF
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
      *              À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÁ´³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL2           =   1      )
                       IF   ( FLG-SEIKATUS          =  1   )
                       OR   ((FLG-SEIKATUL          =  1  ) AND
                             (WK-SHOKUJI-NISSUL NOT = ZERO))
                         MOVE  "9"    TO  WK-NYUSKJRYYKBN
                         MOVE  "4"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       END-IF
                     ELSE
                         MOVE  "3"    TO  WK-NYUSKJRYYKBN
                     END-IF
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
      *              À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÁ´³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL            =   1      )
                       IF     FLG-SEIKATUS   =   1
                         MOVE  "5"    TO  WK-NYUSKJRYYKBN
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       END-IF
                     ELSE
                         MOVE  "3"    TO  WK-NYUSKJRYYKBN
                     END-IF
                   END-IF
                   IF   WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "4"
                   AND  WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "4"
                   AND  WK-2010-SEIKANKBN-TNK(KOH-IDX) = "4"
                     MOVE       3     TO  FLG-NYUSKJJYOGAK
                   END-IF
                 WHEN        "3"
                   IF ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "1"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "1"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "1"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "0"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "1"))
                     MOVE   "0"  TO   WK-2010-SKJRYOKBN-TNK(KOH-IDX)
                                      WK-2010-SEIRYOKBN-TNK(KOH-IDX)
                                      WK-2010-SEIKANKBN-TNK(KOH-IDX)
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
      *              À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÁ´³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL2           =   1      )
                       IF   ( FLG-SEIKATUS          =  1   )
                       OR   ((FLG-SEIKATUL          =  1  ) AND
                             (WK-SHOKUJI-NISSUL NOT = ZERO))
                         MOVE  "9"    TO  WK-NYUSKJRYYKBN
                         MOVE  "4"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       ELSE
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN
                       END-IF
                     END-IF
                   END-IF
                   IF ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "0") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
                   OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "1") AND
                       (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "3") AND
                       (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
      *              À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÁ´³Û½õÀ®¡Ë
                     IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                     AND  (FLG-SEIKATUL            =   1      )
                       IF     FLG-SEIKATUS   =   1
                         MOVE  "5"    TO  WK-NYUSKJRYYKBN
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                       ELSE
                         MOVE  "1"    TO  WK-NYUSKJRYYKBN
                       END-IF
                     END-IF
                   END-IF
               END-EVALUATE
           END-EVALUATE
      *
           .
      *
       23064-SKJKBN-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¿©»öÎÅÍÜÈñ¶èÊ¬ÊÔ½¸£²
      ******************************************************************
       23065-SKJKBN-HENSYU2-SEC           SECTION.
      *
           IF  ((WK-1001-PREFNUM         =  04           ) AND
                (COMB-KOHHKNNUM(KOH-IDX) = "183" OR "483") AND
                (LNK-SYU-SRYYMD(1:6)    >= "200510"      ) AND
                (FLG-MIYAGI              =  ZERO         ))
           OR  ((WK-1001-PREFNUM         =  04           ) AND
                (COMB-KOHHKNNUM(KOH-IDX) = "583" OR "783") AND
                (LNK-SYU-SRYYMD(1:6)    >= "201010"      ) AND
                (FLG-MIYAGI              =  ZERO         ))
           OR  ((WK-1001-PREFNUM         =  04           ) AND
                (COMB-KOHHKNNUM(KOH-IDX) =
                         "263" OR "363" OR "463" OR "563") AND
                (LNK-SYU-SRYYMD(1:6)    >= "201310"      ) AND
                (FLG-MIYAGI              =  ZERO         ))
              MOVE    "0"    TO   WK-2010-SKJRYOKBN-HON(KOH-IDX)
                                  WK-2010-SEIRYOKBN-HON(KOH-IDX)
                                  WK-2010-SEIKANKBN-HON(KOH-IDX)
              MOVE    "0"    TO   WK-2010-SKJRYOKBN-TSY(KOH-IDX)
                                  WK-2010-SEIRYOKBN-TSY(KOH-IDX)
                                  WK-2010-SEIKANKBN-TSY(KOH-IDX)
              MOVE    "0"    TO   WK-2010-SKJRYOKBN-TNK(KOH-IDX)
                                  WK-2010-SEIRYOKBN-TNK(KOH-IDX)
                                  WK-2010-SEIKANKBN-TNK(KOH-IDX)
           END-IF
      *
           EVALUATE   FLG-SANSHOU4
      *      ËÜ¿Í¥¿¥Ö
             WHEN       "1"
               EVALUATE  WK-NYUSKJRYYKBN
                 WHEN        "1"
                   EVALUATE   WK-2010-SKJKEIKBN(KOH-IDX)
                     WHEN       "1"
      ****             <FLG-NYUSKJJYOGAK = 2>
                       IF   WK-2010-SKJRYOKBN-HON(KOH-IDX) = "1"
                       AND  WK-2010-SEIRYOKBN-HON(KOH-IDX) = "1"
                       AND  WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"
      *                  À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÁ´³Û½õÀ®¡Ë
                         IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                         AND  (FLG-SEIKATUL2           =   1      )
                           IF   ( FLG-SEIKATUS          =  1   )
                           OR   ((FLG-SEIKATUL          =  1  ) AND
                                 (WK-SHOKUJI-NISSUL NOT = ZERO))
                             MOVE  "9" TO WK-NYUSKJRYYKBN
                             MOVE  "4" TO WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                           ELSE
                             MOVE ZERO TO FLG-NYUSKJJYOGAK
                           END-IF
                         END-IF
                       END-IF
                       IF   WK-2010-SKJRYOKBN-HON(KOH-IDX) = "1"
                       AND  WK-2010-SEIRYOKBN-HON(KOH-IDX) = "3"
                       AND  WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"
      *                  À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÁ´³Û½õÀ®¡Ë
                         IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                         AND  (FLG-SEIKATUL            =   1      )
                           IF     FLG-SEIKATUS   =   1
                             MOVE  "5" TO WK-NYUSKJRYYKBN
                             MOVE  "1" TO WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                           ELSE
                             MOVE ZERO TO FLG-NYUSKJJYOGAK
                           END-IF
                         END-IF
                       END-IF
                     WHEN       "2"
      ****             <FLG-NYUSKJJYOGAK = 1>
                       IF ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "2") AND
                           (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "2") AND
                           (WK-2010-SEIKANKBN-HON(KOH-IDX) = "0"))
                       OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "2") AND
                           (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "2") AND
                           (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
      *                  À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÈ¾³Û½õÀ®¡Ë
                         IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                         AND  (FLG-SEIKATUL2           =   1      )
                           IF   ( FLG-SEIKATUS          =  1   )
                           OR   ((FLG-SEIKATUL          =  1  ) AND
                                 (WK-SHOKUJI-NISSUL NOT = ZERO))
                             MOVE  "8" TO WK-NYUSKJRYYKBN
                             MOVE  "3" TO WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                           ELSE
                             MOVE ZERO TO FLG-NYUSKJJYOGAK
                           END-IF
                         END-IF
                       END-IF
                       IF ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "2") AND
                           (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "0") AND
                           (WK-2010-SEIKANKBN-HON(KOH-IDX) = "0"))
                       OR ((WK-2010-SKJRYOKBN-HON(KOH-IDX) = "2") AND
                           (WK-2010-SEIRYOKBN-HON(KOH-IDX) = "3") AND
                           (WK-2010-SEIKANKBN-HON(KOH-IDX) = "3"))
      *                  À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÈ¾³Û½õÀ®¡Ë
                         IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                         AND  (FLG-SEIKATUL            =   1      )
                           IF     FLG-SEIKATUS   =   1
                             MOVE  "7" TO WK-NYUSKJRYYKBN
                             MOVE  "2" TO WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                           ELSE
                             MOVE ZERO TO FLG-NYUSKJJYOGAK
                           END-IF
                         END-IF
                       END-IF
                       IF   WK-2010-SKJRYOKBN-HON(KOH-IDX) = "4"
                       AND  WK-2010-SEIRYOKBN-HON(KOH-IDX) = "4"
                       AND  WK-2010-SEIKANKBN-HON(KOH-IDX) = "4"
                         MOVE       3     TO  FLG-NYUSKJJYOGAK
                       END-IF
                   END-EVALUATE
               END-EVALUATE
      *      Äã½êÆÀ¥¿¥Ö
             WHEN       "2"
               EVALUATE  WK-NYUSKJRYYKBN
                 WHEN        "1"
                   EVALUATE   WK-2010-SKJKEIKBN(KOH-IDX)
                     WHEN       "1"
      ****             <FLG-NYUSKJJYOGAK = 2>
                       IF   WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "1"
                       AND  WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "1"
                       AND  WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"
      *                  À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÁ´³Û½õÀ®¡Ë
                         IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                         AND  (FLG-SEIKATUL2           =   1      )
                           IF   ( FLG-SEIKATUS          =  1   )
                           OR   ((FLG-SEIKATUL          =  1  ) AND
                                 (WK-SHOKUJI-NISSUL NOT = ZERO))
                             MOVE  "9" TO WK-NYUSKJRYYKBN
                             MOVE  "4" TO WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                           ELSE
                             MOVE ZERO TO FLG-NYUSKJJYOGAK
                           END-IF
                         END-IF
                       END-IF
                       IF   WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "1"
                       AND  WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "3"
                       AND  WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"
      *                  À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÁ´³Û½õÀ®¡Ë
                         IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                         AND  (FLG-SEIKATUL            =   1      )
                           IF     FLG-SEIKATUS   =   1
                             MOVE  "5" TO WK-NYUSKJRYYKBN
                             MOVE  "1" TO WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                           ELSE
                             MOVE ZERO TO FLG-NYUSKJJYOGAK
                           END-IF
                         END-IF
                       END-IF
                     WHEN       "2"
      ****             <FLG-NYUSKJJYOGAK = 1>
                       IF ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "2") AND
                           (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "2") AND
                           (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "0"))
                       OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "2") AND
                           (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "2") AND
                           (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
      *                  À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÈ¾³Û½õÀ®¡Ë
                         IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                         AND  (FLG-SEIKATUL2           =   1      )
                           IF   ( FLG-SEIKATUS          =  1   )
                           OR   ((FLG-SEIKATUL          =  1  ) AND
                                 (WK-SHOKUJI-NISSUL NOT = ZERO))
                             MOVE  "8" TO WK-NYUSKJRYYKBN
                             MOVE  "3" TO WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                           ELSE
                             MOVE ZERO TO FLG-NYUSKJJYOGAK
                           END-IF
                         END-IF
                       END-IF
                       IF ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "2") AND
                           (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "0") AND
                           (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "0"))
                       OR ((WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "2") AND
                           (WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "3") AND
                           (WK-2010-SEIKANKBN-TSY(KOH-IDX) = "3"))
      *                  À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÈ¾³Û½õÀ®¡Ë
                         IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                         AND  (FLG-SEIKATUL            =   1      )
                           IF     FLG-SEIKATUS   =   1
                             MOVE  "7" TO WK-NYUSKJRYYKBN
                             MOVE  "2" TO WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                           ELSE
                             MOVE ZERO TO FLG-NYUSKJJYOGAK
                           END-IF
                         END-IF
                       END-IF
                       IF   WK-2010-SKJRYOKBN-TSY(KOH-IDX) = "4"
                       AND  WK-2010-SEIRYOKBN-TSY(KOH-IDX) = "4"
                       AND  WK-2010-SEIKANKBN-TSY(KOH-IDX) = "4"
                         MOVE       3     TO  FLG-NYUSKJJYOGAK
                       END-IF
                   END-EVALUATE
               END-EVALUATE
      *      ÄãÇ¯¶â¥¿¥Ö
             WHEN       "3"
               EVALUATE  WK-NYUSKJRYYKBN
                 WHEN        "1"
                   EVALUATE   WK-2010-SKJKEIKBN(KOH-IDX)
                     WHEN       "1"
      ****             <FLG-NYUSKJJYOGAK = 2>
                       IF   WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "1"
                       AND  WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "1"
                       AND  WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"
      *                  À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÁ´³Û½õÀ®¡Ë
                         IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                         AND  (FLG-SEIKATUL2           =   1      )
                           IF   ( FLG-SEIKATUS          =  1   )
                           OR   ((FLG-SEIKATUL          =  1  ) AND
                                 (WK-SHOKUJI-NISSUL NOT = ZERO))
                             MOVE  "9" TO WK-NYUSKJRYYKBN
                             MOVE  "4" TO WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                           ELSE
                             MOVE ZERO TO FLG-NYUSKJJYOGAK
                           END-IF
                         END-IF
                       END-IF
                       IF   WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "1"
                       AND  WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "3"
                       AND  WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"
      *                  À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÁ´³Û½õÀ®¡Ë
                         IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                         AND  (FLG-SEIKATUL            =   1      )
                           IF     FLG-SEIKATUS   =   1
                             MOVE  "5" TO WK-NYUSKJRYYKBN
                             MOVE  "1" TO WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                           ELSE
                             MOVE ZERO TO FLG-NYUSKJJYOGAK
                           END-IF
                         END-IF
                       END-IF
                     WHEN       "2"
      ****             <FLG-NYUSKJJYOGAK = 1>
                       IF ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "2") AND
                           (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "2") AND
                           (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "0"))
                       OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "2") AND
                           (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "2") AND
                           (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
      *                  À¸³èÎÅÍÜÊ¬¡Ê´Ä¶­¡Ë¤Î½õÀ®¤ÏÌµ¤·¡Ê¤½¤ÎÂ¾¤ÏÈ¾³Û½õÀ®¡Ë
                         IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                         AND  (FLG-SEIKATUL2           =   1      )
                           IF   ( FLG-SEIKATUS          =  1   )
                           OR   ((FLG-SEIKATUL          =  1  ) AND
                                 (WK-SHOKUJI-NISSUL NOT = ZERO))
                             MOVE  "8" TO WK-NYUSKJRYYKBN
                             MOVE  "3" TO WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                           ELSE
                             MOVE ZERO TO FLG-NYUSKJJYOGAK
                           END-IF
                         END-IF
                       END-IF
                       IF ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "2") AND
                           (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "0") AND
                           (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "0"))
                       OR ((WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "2") AND
                           (WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "3") AND
                           (WK-2010-SEIKANKBN-TNK(KOH-IDX) = "3"))
      *                  À¸³èÎÅÍÜÊ¬¤Î½õÀ®¤ÏÌµ¤·¡Ê°ìÈÌÊ¬¤ÏÈ¾³Û½õÀ®¡Ë
                         IF   (LNK-SYU-SRYYMD(1:6)    >=  "200610")
                         AND  (FLG-SEIKATUL            =   1      )
                           IF     FLG-SEIKATUS   =   1
                             MOVE  "7" TO WK-NYUSKJRYYKBN
                             MOVE  "2" TO WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                           ELSE
                             MOVE ZERO TO FLG-NYUSKJJYOGAK
                           END-IF
                         END-IF
                       END-IF
                       IF   WK-2010-SKJRYOKBN-TNK(KOH-IDX) = "4"
                       AND  WK-2010-SEIRYOKBN-TNK(KOH-IDX) = "4"
                       AND  WK-2010-SEIKANKBN-TNK(KOH-IDX) = "4"
                         MOVE       3     TO  FLG-NYUSKJJYOGAK
                       END-IF
                   END-EVALUATE
               END-EVALUATE
           END-EVALUATE
      *
           .
      *
       23065-SKJKBN-HENSYU2-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¥·¥¹¥Æ¥à´ÉÍý£²£°£±£°ÀßÄê³ÛÌ¤Ëþ¡¦°Ê¾å¤Ç°Û¤Ê¤ëÉéÃ´¶â·×»»
      *        ÀßÄê¡Ö£³¡×¡Ö£´¡×¤Î¥Á¥§¥Ã¥¯
      ******************************************************************
       23066-IRYOKEIKBN-CHECK-SEC           SECTION.
      *
           MOVE       ZERO         TO   FLG-IRYOKEIKBN
      *
           EVALUATE   WK-2010-IRYOKEIKBN-N(KOH-IDX)
             WHEN     "3"
                MOVE      21000    TO   WK-TAIHI-MAX-KIN-KOHI-M
             WHEN     "4"
                MOVE      20000    TO   WK-TAIHI-MAX-KIN-KOHI-M
           END-EVALUATE
      *
           IF  WK-TAIHI-FTN-KOHI-M(KOH-IDX) >= WK-TAIHI-MAX-KIN-KOHI-M
                MOVE      ZERO     TO   WK-TAIHI-ZAN-KOHI-M
           ELSE
                COMPUTE   WK-TAIHI-ZAN-KOHI-M       =
                          WK-TAIHI-MAX-KIN-KOHI-M   -
                          WK-TAIHI-FTN-KOHI-M(KOH-IDX)
           END-IF
      *
           IF   LNK-SYU-SYUHKNNUM  NOT =  SPACE
                MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                   TO   WK-TOKUSYU-ENTANI
           ELSE
                MOVE  WK-ZENGAKU   TO   WK-TOKUSYU-ENTANI
           END-IF
      *
           IF   HKN-RECEFTNDSPKBN  =  "2"
             IF   LNK-SYU-SYUHKNNUM  NOT =  SPACE
                MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                   TO   WK-TOKUSYU-COMPFTN2
             ELSE
                MOVE  WK-ZENGAKU   TO   WK-TOKUSYU-COMPFTN2
             END-IF
           END-IF
      *
           IF   LNK-SYU-SYUHKNNUM  NOT =  SPACE
             IF  (FLG-KOUGAKUCYO3      =     1)
             OR  (FLG-KOUGAKUCYO-GEN70 =     1)
               MOVE  LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU
             ELSE
               COMPUTE  WK-TOKUSYU = LNK-SYU-SYUCOMPFTN +  5
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU         / 10
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU         * 10
             END-IF
      *
             IF  ( KOH-IDX  =  1                            )
             AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
               IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI1
                   MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI2
                   MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI3
                   MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI4
                   MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF  WK-TOKUSYU >= WK-TAIHI-ZAN-KOHI-M
                 MOVE   1                  TO  FLG-IRYOKEIKBN
                 MOVE   WK-TOKUSYU         TO  WK-TAIHI-KARI-COMPFTN
               ELSE
                 MOVE   ZERO               TO  FLG-IRYOKEIKBN
                 MOVE   ZERO               TO  WK-TAIHI-KARI-COMPFTN
               END-IF
             ELSE
               IF  WK-TOKUSYU >= WK-TAIHI-ZAN-KOHI-M
                 MOVE   1                  TO  FLG-IRYOKEIKBN
                 MOVE   LNK-SYU-SYUCOMPFTN TO  WK-TAIHI-KARI-COMPFTN
               ELSE
                 MOVE   ZERO               TO  FLG-IRYOKEIKBN
                 MOVE   ZERO               TO  WK-TAIHI-KARI-COMPFTN
               END-IF
             END-IF
      *
             EVALUATE   KOH-IDX
               WHEN   2
                 IF  LNK-SYU-KOH-COMPFTN(1) <  WK-TAIHI-KARI-COMPFTN
                 AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                   MOVE  LNK-SYU-KOH-COMPFTN(1)
                                           TO  WK-TAIHI-KARI-COMPFTN
                 END-IF
               WHEN   3
                 IF  LNK-SYU-KOH-COMPFTN(2) <  WK-TAIHI-KARI-COMPFTN
                   MOVE  LNK-SYU-KOH-COMPFTN(2)
                                           TO  WK-TAIHI-KARI-COMPFTN
                 END-IF
               WHEN   4
                 IF  LNK-SYU-KOH-COMPFTN(3) <  WK-TAIHI-KARI-COMPFTN
                   MOVE  LNK-SYU-KOH-COMPFTN(3)
                                           TO  WK-TAIHI-KARI-COMPFTN
                 END-IF
             END-EVALUATE
      *
             MOVE    LNK-SYU-SYUCOMPFTN    TO  WK-TOKUSYU-COMPFTN
      *
             IF    KOH-IDX  >  1
               COMPUTE  WK-TOKUSYU = WK-TAIHI-KARI-COMPFTN +  5
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU            / 10
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU            * 10
               IF  WK-TOKUSYU  >=  WK-TAIHI-ZAN-KOHI-M
                 CONTINUE
               ELSE
                 MOVE   ZERO   TO  FLG-IRYOKEIKBN
                 MOVE   ZERO   TO  WK-TAIHI-KARI-COMPFTN
               END-IF
             END-IF
           ELSE
             COMPUTE  WK-TOKUSYU = WK-ZENGAKU +  5
             COMPUTE  WK-TOKUSYU = WK-TOKUSYU / 10
             COMPUTE  WK-TOKUSYU = WK-TOKUSYU * 10
      *
             IF  ( KOH-IDX  =  1                            )
             AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
               IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI1
                   MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI2
                   MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI3
                   MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI4
                   MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF  WK-TOKUSYU >= WK-TAIHI-ZAN-KOHI-M
                 MOVE   1                  TO  FLG-IRYOKEIKBN
                 MOVE   WK-TOKUSYU         TO  WK-TAIHI-KARI-COMPFTN
               ELSE
                 MOVE   ZERO               TO  FLG-IRYOKEIKBN
                 MOVE   ZERO               TO  WK-TAIHI-KARI-COMPFTN
               END-IF
             ELSE
               IF  WK-TOKUSYU >= WK-TAIHI-ZAN-KOHI-M
                 MOVE   1                  TO  FLG-IRYOKEIKBN
                 MOVE   WK-ZENGAKU         TO  WK-TAIHI-KARI-COMPFTN
               ELSE
                 MOVE   ZERO               TO  FLG-IRYOKEIKBN
                 MOVE   ZERO               TO  WK-TAIHI-KARI-COMPFTN
               END-IF
             END-IF
      *
             EVALUATE   KOH-IDX
               WHEN   2
                 IF  LNK-SYU-KOH-COMPFTN(1) <  WK-TAIHI-KARI-COMPFTN
                 AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                   MOVE  LNK-SYU-KOH-COMPFTN(1)
                                           TO  WK-TAIHI-KARI-COMPFTN
                 END-IF
               WHEN   3
                 IF  LNK-SYU-KOH-COMPFTN(2) <  WK-TAIHI-KARI-COMPFTN
                   MOVE  LNK-SYU-KOH-COMPFTN(2)
                                           TO  WK-TAIHI-KARI-COMPFTN
                 END-IF
               WHEN   4
                 IF  LNK-SYU-KOH-COMPFTN(3) <  WK-TAIHI-KARI-COMPFTN
                   MOVE  LNK-SYU-KOH-COMPFTN(3)
                                           TO  WK-TAIHI-KARI-COMPFTN
                 END-IF
             END-EVALUATE
      *
             MOVE    WK-ZENGAKU            TO  WK-TOKUSYU-COMPFTN
      *
             IF    KOH-IDX  >  1
               COMPUTE  WK-TOKUSYU = WK-TAIHI-KARI-COMPFTN +  5
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU            / 10
               COMPUTE  WK-TOKUSYU = WK-TOKUSYU            * 10
               IF  WK-TOKUSYU  >=  WK-TAIHI-ZAN-KOHI-M
                 CONTINUE
               ELSE
                 MOVE   ZERO   TO  FLG-IRYOKEIKBN
                 MOVE   ZERO   TO  WK-TAIHI-KARI-COMPFTN
               END-IF
             END-IF
           END-IF
      *
      ***
      *
           EVALUATE   KOH-IDX
             WHEN   2
               IF  LNK-SYU-KOH-COMPFTN(1) <  WK-TOKUSYU-COMPFTN
               AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                 MOVE  LNK-SYU-KOH-COMPFTN(1)
                                         TO  WK-TOKUSYU-COMPFTN
               END-IF
             WHEN   3
               IF  LNK-SYU-KOH-COMPFTN(2) <  WK-TOKUSYU-COMPFTN
                 MOVE  LNK-SYU-KOH-COMPFTN(2)
                                         TO  WK-TOKUSYU-COMPFTN
               END-IF
             WHEN   4
               IF  LNK-SYU-KOH-COMPFTN(3) <  WK-TOKUSYU-COMPFTN
                 MOVE  LNK-SYU-KOH-COMPFTN(3)
                                         TO  WK-TOKUSYU-COMPFTN
               END-IF
           END-EVALUATE
      *
           IF    HKN-RECEFTNDSPKBN  =  "2"
             EVALUATE   KOH-IDX
               WHEN   2
                 IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                   IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                     IF  LNK-SYU-KOH-COMPFTN(1) <  WK-TOKUSYU-COMPFTN2
                     AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                               TO  WK-TOKUSYU-COMPFTN2
                     END-IF
                   ELSE
                     IF  WK-KOH-COMPFTN(1)      <  WK-TOKUSYU-COMPFTN2
                     AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                       MOVE  WK-KOH-COMPFTN(1) TO  WK-TOKUSYU-COMPFTN2
                     END-IF
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                <  WK-TOKUSYU-COMPFTN2
                   AND LNK-SYU-KOH1HKNNUM       NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                               TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN   3
                 IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                   IF  WK-KOH-COMPFTN(2)  =  ALL"9"
                     IF  LNK-SYU-KOH-COMPFTN(2) <  WK-TOKUSYU-COMPFTN2
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                               TO  WK-TOKUSYU-COMPFTN2
                     END-IF
                   ELSE
                     IF  WK-KOH-COMPFTN(2)      <  WK-TOKUSYU-COMPFTN2
                       MOVE  WK-KOH-COMPFTN(2) TO  WK-TOKUSYU-COMPFTN2
                     END-IF
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                                <  WK-TOKUSYU-COMPFTN2
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                               TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN   4
                 IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                   IF  WK-KOH-COMPFTN(3)  =  ALL"9"
                     IF  LNK-SYU-KOH-COMPFTN(3) <  WK-TOKUSYU-COMPFTN2
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                               TO  WK-TOKUSYU-COMPFTN2
                     END-IF
                   ELSE
                     IF  WK-KOH-COMPFTN(3)      <  WK-TOKUSYU-COMPFTN2
                       MOVE  WK-KOH-COMPFTN(3) TO  WK-TOKUSYU-COMPFTN2
                     END-IF
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                                <  WK-TOKUSYU-COMPFTN2
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                               TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF
      *
           EVALUATE   KOH-IDX
             WHEN   2
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                          <  WK-TOKUSYU-ENTANI
               AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                 MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                         TO  WK-TOKUSYU-ENTANI
               END-IF
             WHEN   3
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                          <  WK-TOKUSYU-ENTANI
                 MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                         TO  WK-TOKUSYU-ENTANI
               END-IF
             WHEN   4
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                          <  WK-TOKUSYU-ENTANI
                 MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                         TO  WK-TOKUSYU-ENTANI
               END-IF
           END-EVALUATE
      *
           IF   FLG-IRYOKEIKBN  =  1
             MOVE        100     TO  WK-NYUKFTNRATE
             MOVE      SPACE     TO  COMB-KOH-NYUJGNKBN(KOH-IDX)
             IF  FLG-GENBUTU70         NOT =  ZERO
             OR  LNK-S02-KOUREI-NYUIN-KBN  =  "1"
               MOVE    "1"       TO  FLG-SYOUKAN(KOH-IDX)
             END-IF
             MOVE       1        TO  WK-TAIHI-HANTEIFLG(KOH-IDX)
           ELSE
             IF  (WK-1001-PREFNUM               = 11               )
             AND (COMB-KOHHKNNUM(KOH-IDX) = "683" OR "783" OR "673"
                                                           OR "773")
             AND (FLG-SANSHOU2                  = "2" OR "3"       )
             AND (WK-2010-IRYOKEIKBN-N(KOH-IDX) = "3"              )
               EVALUATE   KOH-IDX
                 WHEN       1
                   IF  (WK-TAIHI-MAX-KIN-KOHI1-M
                                         =  WK-TAIHI-MAX-KIN-KOHI-M)
                   AND (WK-NYUKFTNRATE   =  ZERO                   )
                     MOVE  SPACE  TO  COMB-KOH-NYUJGNKBN(KOH-IDX)
                   END-IF
                 WHEN       2
                   IF  (WK-TAIHI-MAX-KIN-KOHI2-M
                                         =  WK-TAIHI-MAX-KIN-KOHI-M)
                   AND (WK-NYUKFTNRATE   =  ZERO                   )
                     MOVE  SPACE  TO  COMB-KOH-NYUJGNKBN(KOH-IDX)
                   END-IF
                 WHEN       3
                   IF  (WK-TAIHI-MAX-KIN-KOHI3-M
                                         =  WK-TAIHI-MAX-KIN-KOHI-M)
                   AND (WK-NYUKFTNRATE   =  ZERO                   )
                     MOVE  SPACE  TO  COMB-KOH-NYUJGNKBN(KOH-IDX)
                   END-IF
                 WHEN       4
                   IF  (WK-TAIHI-MAX-KIN-KOHI4-M
                                         =  WK-TAIHI-MAX-KIN-KOHI-M)
                   AND (WK-NYUKFTNRATE   =  ZERO                   )
                     MOVE  SPACE  TO  COMB-KOH-NYUJGNKBN(KOH-IDX)
                   END-IF
               END-EVALUATE
             END-IF
           END-IF
      *
           .
      *
       23066-IRYOKEIKBN-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñ¤Î´µ¼ÔÉéÃ´¶â³Û·×»»¡Ê¾å¸Â³Û¤¢¤ê¡Ë                    *
      ******************************************************************
       2307-KOH-KEISAN-SEC           SECTION.
      *
      *    ÆüÊÌ¼ýÇ¼»»Äê
           IF   WK-DAYINFFLG(KOH-IDX)  =    1
               PERFORM    23071-DAYINF-SANTEI-SEC
               GO    TO   2307-KOH-KEISAN-EXT
           END-IF.
      *
      *    ÉéÃ´¶â³Û¤Î·×»»
           IF  WK-NYUKFTNRATE     NOT =    ZERO
      *
               IF   WK-DAY-NYUKFTNRATE       =  ZERO
               AND  WK-DAY-NYUKFTNRATE-FLG   =  ZERO
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE
                    MOVE      1            TO   WK-DAY-NYUKFTNRATE-FLG
               END-IF
      *
               IF   WK-DAY-NYUKFTNRATE2      =  ZERO
               AND  WK-DAY-NYUKFTNRATE-FLG2  =  ZERO
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE2
                    MOVE      1            TO   WK-DAY-NYUKFTNRATE-FLG2
               ELSE
                 IF  (WK-DAY-NYUKFTNRATE2 > WK-NYUKFTNRATE    )
                 AND (LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1)  =  "0")
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE2
                 END-IF
               END-IF
      *
               COMPUTE   WK-FUTANWARI  =
                              WK-NYUKFTNRATE  /  100
               IF    WK-KOH-FTNKBN   NOT =  SPACE
                 EVALUATE  WK-KOH-FTNKBN
                    WHEN  "1"
                      COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                                LNK-SYU-KYUFUGAI-GOKEI-TEN
                                        *  HKN-TENTNK
                                        *  WK-FUTANWARI
                      COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KYUFUGAI-GOKEI-TEN
                                        *  HKN-TENTNK
                                        *  WK-FUTANWARI
                    WHEN  "2"
                      MOVE    ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                      MOVE    ZERO   TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                      MOVE    ZERO   TO   LNK-SYU-KYUFUGAI-SHOSHIN-TEN
                                          LNK-SYU-KYUFUGAI-SIDOU-TEN
                                          LNK-SYU-KYUFUGAI-OSIN1-TEN
                                          LNK-SYU-KYUFUGAI-OSIN2-TEN
                                          LNK-SYU-KYUFUGAI-OSIN3-TEN
                                          LNK-SYU-KYUFUGAI-GOKEI-TEN
                 END-EVALUATE
               ELSE
                 COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                           WK-ZENGAKU   *  WK-FUTANWARI
                 COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                           WK-ZENGAKU   *  WK-FUTANWARI
               END-IF
      *
               IF  ((LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1)  =  "0"  ) AND
                    (WK-DOTANDOKU(KOH-IDX)             =  ZERO ))
               OR  ( WK-TOKATUKAI(KOH-IDX)             =  1     )
               OR  ( WK-KOHJGNGET-TEKIYOFLG(KOH-IDX)   =  1     )
      *             ¸º³Û
                    MOVE      999   TO     WK-NYUKFTNRATE2
                    MOVE      1     TO     FLG-GENGAKU-HENSYU
                    PERFORM   2307A-KOH-GENGAKU-HENSYU-SEC
                    IF  WK-GENGAKUKBN  NOT =  ZERO
                        MOVE  WK-GENGAKU-GAK
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                        MOVE  WK-GENGAKU-GAK-ENTANI
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                    END-IF
                    IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "027"
                        MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)                 
                                            TO WK-TOKUTEI-COMPFTN3      
                    END-IF
               END-IF                                      
               IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          ) OR
                  ( HKN-RECEFTNDSPKBN           = "2"            ) OR
                  ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016"))
                   MOVE    "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                   IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN
                                        TO  LNK-SYU-SYUCOMPFTN
                   END-IF
                   IF    LNK-SYU-KOH-HKNNUM(1)    =    "027"
                     IF  WK-TOKUTEI-COMPFTN3  NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN3
                                        TO  LNK-SYU-KOH-COMPFTN(1)
                     END-IF
                   END-IF
               ELSE
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                   COMPUTE   WK-FTN      =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  / 10
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             WK-FTN   *  10
               END-IF
      *
               IF  (KOH-IDX               =  2   )
               AND (WK-RUI-TAISYO         =  1   )
               AND (WK-2010-KINJYOKBN-N(1)
                                          = "1"  )
               AND (FLG-MARUTOARI         =  1   )
               AND (FLG-MARUTOARI2        =  1   )
                 IF  HKN-RECEFTNDSPKBN  =  "2"
                   MOVE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  TO
                                        WK-MARUTOARI-COMPFTN
                   IF  LNK-SYU-KOH-COMPFTN(KOH-IDX) >
                                              WK-RUI-FTN2-M2
                     COMPUTE LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                             WK-RUI-FTN2-M2
                   ELSE
                     MOVE  ZERO  TO
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN(KOH-IDX) >
                                              WK-RUI-FTN2-M
                     COMPUTE LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                             WK-RUI-FTN2-M
                   ELSE
                     MOVE  ZERO  TO
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 END-IF
                 IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) >
                                            WK-RUI-FTN2-M3-XXX
                   COMPUTE LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                           LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  -
                           WK-RUI-FTN2-M3-XXX
                 ELSE
                   MOVE  ZERO  TO
                           LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
               END-IF
      *
               IF  ( LNK-S02-KOUREI-NYUIN-KBN     =   "1"  )            
               AND ( LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "027" )            
                 IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     >      ZAN-KOHI1-ENTANI            
                     MOVE   ZAN-KOHI1-ENTANI       TO                   
                                    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) 
                 END-IF                                                 
               ELSE                                                     
                IF  (KOH-IDX         =   2)
                AND (WK-RUI-TAISYO   =   1)
                AND (FLG-RUIKEIYO2   =   2)
                 IF    WK-RUI-FTN2-M3-XXX  >=  WK-RUI-COMPFTN-ENTANI
                     MOVE     ZERO         TO  WK-ZAN-FTN2-M3-XXX
                 ELSE
                     COMPUTE  WK-ZAN-FTN2-M3-XXX
                                            =  WK-RUI-COMPFTN-ENTANI -
                                               WK-RUI-FTN2-M3-XXX
                 END-IF
                 IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     >      WK-ZAN-FTN2-M3-XXX
                     MOVE   WK-ZAN-FTN2-M3-XXX     TO
                                    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                ELSE
                 IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     >      ZAN-KOHI-T3(KOH-IDX)        
                     MOVE   ZAN-KOHI-T3(KOH-IDX)   TO                   
                                    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) 
                 END-IF                                                 
                END-IF
               END-IF                                                   
      *
               IF    FLG-ICHIBU-JYOSEI  =   1
                   IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <  580
                      MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                      MOVE  ZERO  TO
                               LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   ELSE
                      MOVE  580   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                      COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                               LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                               580
                   END-IF
               END-IF
      *
               IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
               AND (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                IF  (KOH-IDX               =  2   )
                AND (WK-RUI-TAISYO         =  1   )
                AND (WK-2010-KINJYOKBN-N(1)
                                           = "1"  )
                AND (FLG-MARUTOARI         =  1   )
                 CONTINUE
                ELSE
                 IF    FLG-ICHIBU-JYOSEI  =  1
                 AND   KOH-IDX            =  1
                   IF  LNK-SYU-SYUCOMPFTN-ENTANI
                             >   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     COMPUTE  WK-KEISAN-JYOSEI-EN          =
                              LNK-SYU-SYUCOMPFTN-ENTANI    -
                              LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                     IF  WK-KEISAN-JYOSEI-EN
                             <   LNK-SYU-JYO-COMPFTN-ENTANI
                       MOVE   WK-KEISAN-JYOSEI-EN
                                 TO  LNK-SYU-JYO-COMPFTN-ENTANI
                     END-IF
                   ELSE
                     MOVE  ZERO  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                   END-IF
                 END-IF
                 IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     >      LNK-SYU-SYUCOMPFTN-ENTANI
                     MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                END-IF
               END-IF
      *
               PERFORM    23075-KOHHI-HIKAKU4-SEC
      *
               IF    FLG-ICHIBU-JYOSEI  =   2
                   IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <  580
                      MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                      MOVE  ZERO  TO
                               LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   ELSE
                      MOVE  580   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                      COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                               LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                               580
                   END-IF
               END-IF
      *
               IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          ) OR
                  ( HKN-RECEFTNDSPKBN           = "2"            ) OR
                  ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016"))
                 IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)   >                 
                                            ZAN-KOHI-T2(KOH-IDX)        
                     MOVE   ZAN-KOHI-T2(KOH-IDX)   TO                   
                                          WK-KOH-COMPFTN(KOH-IDX)       
                 ELSE
                     MOVE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  TO
                                          WK-KOH-COMPFTN(KOH-IDX)       
                 END-IF                                                 
      *
                 IF   (FLG-ICHIBU-JYOSEI     =  1      )
                 AND  (LNK-SYU-SRYYMD(1:6)  >= "201808")
                   IF   WK-KOH-COMPFTN(KOH-IDX)  <  580
                      MOVE  ZERO  TO
                               WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                      COMPUTE  WK-KOH-COMPFTN(KOH-IDX) =
                               WK-KOH-COMPFTN(KOH-IDX) -
                               580
                   END-IF
                 END-IF
      *
                 IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                 AND (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                  IF  (KOH-IDX               =  2   )
                  AND (WK-RUI-TAISYO         =  1   )
                  AND (WK-2010-KINJYOKBN-N(1)
                                             = "1"  )
                  AND (FLG-MARUTOARI         =  1   )
                     CONTINUE
                  ELSE
                     IF   WK-KOH-COMPFTN(KOH-IDX)
                                         >  LNK-SYU-SYUCOMPFTN-ENTANI
                       MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                     END-IF
                  END-IF
                 END-IF
      *
                 PERFORM    23073-KOHHI-HIKAKU2-SEC
      *
                 IF    FLG-ICHIBU-JYOSEI  =  2
                   IF   WK-KOH-COMPFTN(KOH-IDX)  <  580
                      MOVE  ZERO  TO
                               WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                      COMPUTE  WK-KOH-COMPFTN(KOH-IDX) =
                               WK-KOH-COMPFTN(KOH-IDX) -
                               580
                   END-IF
                 END-IF
               END-IF
      *
               IF  (KOH-IDX               =  2   )
               AND (WK-RUI-TAISYO         =  1   )
               AND (WK-2010-KINJYOKBN-N(1)
                                          = "1"  )
               AND (FLG-MARUTOARI         =  1   )
               AND (FLG-MARUTOARI2        =  1   )
                 IF  HKN-RECEFTNDSPKBN  =  "2"
                   IF  WK-MARUTOARI-COMPFTN > WK-RUI-FTN2-M
                     COMPUTE LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                             WK-MARUTOARI-COMPFTN          -
                             WK-RUI-FTN2-M
                   ELSE
                     MOVE  ZERO  TO
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 END-IF
               END-IF
      *
               IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)   >
                                            ZAN-KOHI-T(KOH-IDX)
                     MOVE   ZAN-KOHI-T(KOH-IDX)   TO
                                          LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "027"     
                          MOVE   LNK-SYU-KOH-COMPFTN(KOH-IDX)           
                                            TO WK-TOKUTEI-COMPFTN3      
                     END-IF         
               ELSE
                     IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "027"     
                     AND  FLG-KOUGAKUCYO               =        1
                          MOVE    ZERO      TO FLG-KOUGAKUCYO
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =      "027"     
                     AND  FLG-KOUGAKUCYO3              =        1
                          MOVE    ZERO      TO FLG-KOUGAKUCYO3
                     END-IF
               END-IF
      *
               IF    FLG-ICHIBU-JYOSEI  =   1
                   IF   LNK-SYU-KOH-COMPFTN(KOH-IDX)  <  580
                      COMPUTE   WK-KEISAN-JYOSEI              =
                                LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                      COMPUTE   WK-KEISAN-JYOSEI              =
                                WK-KEISAN-JYOSEI              / 10
                      COMPUTE   WK-KEISAN-JYOSEI              =
                                WK-KEISAN-JYOSEI              * 10
                      MOVE  WK-KEISAN-JYOSEI
                                  TO  LNK-SYU-JYO-HKNFTNMONEY
                                      LNK-SYU-JYO-COMPFTN
                      MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   ELSE
                      MOVE  580   TO  LNK-SYU-JYO-HKNFTNMONEY
                                      LNK-SYU-JYO-COMPFTN
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                               580
                   END-IF
               END-IF
      *
               IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
               AND (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                IF  (KOH-IDX               =  2   )
                AND (WK-RUI-TAISYO         =  1   )
                AND (WK-2010-KINJYOKBN-N(1)
                                           = "1"  )
                AND (FLG-MARUTOARI         =  1   )
                 CONTINUE
                ELSE
                 IF    FLG-ICHIBU-JYOSEI  =  1
                 AND   KOH-IDX            =  1
                   IF  LNK-SYU-SYUCOMPFTN
                             >   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     COMPUTE  WK-KEISAN-JYOSEI             =
                              LNK-SYU-SYUCOMPFTN           +  5
                     COMPUTE  WK-KEISAN-JYOSEI             =
                              WK-KEISAN-JYOSEI             / 10
                     COMPUTE  WK-KEISAN-JYOSEI             =
                              WK-KEISAN-JYOSEI             * 10
                     COMPUTE  WK-KEISAN-JYOSEI2            =
                              LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                     COMPUTE  WK-KEISAN-JYOSEI2            =
                              WK-KEISAN-JYOSEI2            / 10
                     COMPUTE  WK-KEISAN-JYOSEI2            =
                              WK-KEISAN-JYOSEI2            * 10
                     COMPUTE  WK-KEISAN-JYOSEI3            =
                              WK-KEISAN-JYOSEI             -
                              WK-KEISAN-JYOSEI2
                     IF WK-KEISAN-JYOSEI3 < LNK-SYU-JYO-COMPFTN
                       MOVE   WK-KEISAN-JYOSEI3
                                 TO  LNK-SYU-JYO-HKNFTNMONEY
                                     LNK-SYU-JYO-COMPFTN
                     END-IF
                   ELSE
                     MOVE  ZERO  TO  LNK-SYU-JYO-HKNFTNMONEY
                                     LNK-SYU-JYO-COMPFTN
                   END-IF
                 END-IF
                 IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                     >  LNK-SYU-SYUCOMPFTN
                   MOVE   LNK-SYU-SYUCOMPFTN  TO
                                    LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
                END-IF
               END-IF
      *
               PERFORM   23072-KOHHI-HIKAKU-SEC
      *
               IF    FLG-ICHIBU-JYOSEI  =   2
                   IF   LNK-SYU-KOH-COMPFTN(KOH-IDX)  <  580
                      COMPUTE   WK-KEISAN-JYOSEI              =
                                LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                      COMPUTE   WK-KEISAN-JYOSEI              =
                                WK-KEISAN-JYOSEI              / 10
                      COMPUTE   WK-KEISAN-JYOSEI              =
                                WK-KEISAN-JYOSEI              * 10
                      MOVE  WK-KEISAN-JYOSEI
                                  TO  LNK-SYU-JYO-HKNFTNMONEY
                                      LNK-SYU-JYO-COMPFTN
                      MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   ELSE
                      MOVE  580   TO  LNK-SYU-JYO-HKNFTNMONEY
                                      LNK-SYU-JYO-COMPFTN
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                               580
                   END-IF
               END-IF
      *
               COMPUTE   ZAN-KOHI-T(KOH-IDX)    =
                         ZAN-KOHI-T(KOH-IDX)    -
                         LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
               IF   (LNK-SYU-KOH-HKNNUM(KOH-IDX)         =
                                                 "024" OR "079")
               AND  (WK-TAIHI-JGNGAKEN(KOH-IDX)(7:1) NOT = "0" )
               AND  (LNK-SYU-KOH-COMPFTN(KOH-IDX)    NOT = ZERO)
               AND  (ZAN-KOHI-T(KOH-IDX)                 = ZERO)
                  MOVE     1    TO    WK-TAIHI-FTNGAKEN(KOH-IDX)
               END-IF
      *
               COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                         LNK-SYU-KOH-COMPFTN(KOH-IDX)     
               IF    ZAN-KOHI-T(KOH-IDX)   NOT =   ZERO
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =
      ***                    ZAN-KOHI-T(KOH-IDX)  +  5
                             ZAN-KOHI-T(KOH-IDX)  +  4
                   COMPUTE   WK-FTN      =
                             ZAN-KOHI-T(KOH-IDX)  /  10
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                             WK-FTN   *  10
               END-IF
      *
      *        ¸øÈñ¤Î¿©»öÊÔ½¸
               PERFORM   23089-KOH-SKJ-HENSYU-SEC
           ELSE
      *
               IF   WK-DAY-NYUKFTNRATE       =  ZERO
               AND  WK-DAY-NYUKFTNRATE-FLG   =  ZERO
                    MOVE      100          TO   WK-DAY-NYUKFTNRATE
                    MOVE      1            TO   WK-DAY-NYUKFTNRATE-FLG
               END-IF
      *
               IF   WK-DAY-NYUKFTNRATE2      =  ZERO
               AND  WK-DAY-NYUKFTNRATE-FLG2  =  ZERO
                    MOVE      100          TO   WK-DAY-NYUKFTNRATE2
                    MOVE      1            TO   WK-DAY-NYUKFTNRATE-FLG2
               END-IF
      *
               IF  ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          )
               OR  ( HKN-RECEFTNDSPKBN           = "2"            )
               OR  ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                    (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016"))
                 IF    WK-2010-IRYOKEIKBN-N(KOH-IDX)  =  "1" OR "2"
                   CONTINUE
                 ELSE
                   MOVE    "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                   IF  WK-TOKUTEI-COMPFTN  NOT =  ZERO
                     MOVE  WK-TOKUTEI-COMPFTN
                                          TO  LNK-SYU-SYUCOMPFTN
                   END-IF
                   IF  LNK-SYU-KOH-HKNNUM(1)   =  "027"
                     IF  WK-TOKUTEI-COMPFTN3  NOT =  ZERO
                       MOVE  WK-TOKUTEI-COMPFTN3
                                          TO  LNK-SYU-KOH-COMPFTN(1)
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
      *        ÆÃ¼ì·×»»¡Ê¸ÂÅÙ¤òÄ¶¤¨¤¿¾ì¹ç¡¢´µ¼ÔÉéÃ´È¯À¸¡ÊÁ´³Û¡Ë¡Ë
      *
               IF   WK-2010-IRYOKEIKBN-N(KOH-IDX)  =  "1" OR "2"
                  MOVE     "1"     TO    LNK-S02-TOKUSYU-SAI-KBN
                  PERFORM   23076-TOKUSYU-SANTEI-SEC
                  GO    TO  2307-KOH-KEISAN-EXT
               END-IF
      *        ÆÃ¼ì·×»»¡Ê¸ÂÅÙ¤òÄ¶¤¨¤¿¾ì¹ç¡¢´µ¼ÔÉéÃ´È¯À¸¡ÊÄ¶¤¨¤¿³Û¡Ë¡Ë
      *********¡Ê²¬»³¸©¡Ë
      *********¡ÊÅìµþÅÔ¡Ë
               IF   WK-2010-KINJYOKBN-N(KOH-IDX)   =  "1"
                  PERFORM   23077-TOKUSYU-SANTEI2-SEC
                  GO    TO  2307-KOH-KEISAN-EXT
               END-IF
      *        ÆÃ¼ì·×»»¡Ê£²³äËô¤Ï£³³ä¤Î³Û¤ò»»½Ð¸å¡¢È¾³Û¤ò´µ¼ÔÉéÃ´¤È¤¹¤ë¡Ë
      *********¡Ê½©ÅÄ¸©¡Ë
               IF  (WK-1001-PREFNUM             =  05             ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "374" OR "474"
                                                        OR "280"  ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200508" )
                  PERFORM   23078-TOKUSYU-SANTEI3-SEC
                  GO    TO  2307-KOH-KEISAN-EXT
               END-IF
      *        ÆÃ¼ì·×»»¡ÊÄ¹´ü¤Î·×»»¡Ë
               IF  (LNK-SYU-SRYYMD(1:6)        >= "200804"      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "972" OR "974")
                  PERFORM   23079-TOKUSYU-SANTEI4-SEC
                  GO    TO  2307-KOH-KEISAN-EXT
               END-IF
      *        ÆÃ¼ì·×»»
      *********¡Ê·§ËÜ¸©¡Ë
               IF  (WK-1001-PREFNUM             =  43           ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "143" OR "342") AND
                   (LNK-SYU-SRYYMD(1:6)        >= "200912"      )
                  MOVE   1    TO  WK-TAIHI-FTNGAKEN(KOH-IDX)
                  MOVE  "1"   TO  WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                  PERFORM   23081-KUMAMOTO-KOHI2-SEC
                  GO    TO  2307-KOH-KEISAN-EXT
               END-IF
               IF  (WK-1001-PREFNUM             =  43           ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "343"         ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "201204"      )
                  PERFORM   23081-KUMAMOTO-KOHI3-SEC
                  GO    TO  2307-KOH-KEISAN-EXT
               END-IF
      *        ÆÃ¼ì·×»»
      *********¡Ê»³¸ý¸©¡Ë
               IF  (WK-1001-PREFNUM             =  35 OR 34     ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "781"         ) AND
                   (LNK-SYU-SRYYMD(1:6)        >= "201309"      )
                  PERFORM   23083-JYOSEI-KOHI-SEC
                  GO    TO  2307-KOH-KEISAN-EXT
               END-IF
      *********¡Ê°¦ÃÎ¸©¡Ë
               IF  (WK-1001-PREFNUM             =  23           ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "781" OR "271") AND
                   (LNK-SYU-SRYYMD(1:6)        >= "201504"      )
                  PERFORM   23084-JYOSEI-KOHI2-SEC
                  GO    TO  2307-KOH-KEISAN-EXT
               END-IF
      *
               IF  (KOH-IDX         =   2)
               AND (WK-RUI-TAISYO   =   1)
               AND (FLG-RUIKEIYO2   =   2)
                 IF  (WK-1001-PREFNUM         =  43           )
                 AND (COMB-KOHHKNNUM(KOH-IDX) = "143" OR "342")
                 AND (LNK-SYU-SRYYMD(1:6)    <= "200911"      )
                      MOVE  "1"  TO  FLG-KUMAMOTO
                      MOVE  "1"  TO  WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                      PERFORM   23081-KUMAMOTO-KOHI-SEC
                      PERFORM   2308B-RUIKEIYO-HENSYU-SEC
                      GO    TO  2307-KOH-KEISAN-EXT
                 END-IF
                 IF  (WK-1001-PREFNUM         =  13     )
                 AND (COMB-KOHHKNNUM(KOH-IDX) = "588"   )
                 AND (LNK-SYU-SRYYMD(1:6)    >= "200710")
                 AND (LNK-SYU-SRYYMD(1:6)    <= "200909")
                      PERFORM   23082-TOKYO-KOHI-SEC
                      PERFORM   2308B-RUIKEIYO-HENSYU-SEC
                      GO    TO  2307-KOH-KEISAN-EXT
                 END-IF
               END-IF
      *
               IF    FLG-ICHIBU-JYOSEI  =   1
                 IF  LNK-SYU-SYUHKNNUM  NOT =  SPACE
                   COMPUTE  WK-FUTANWARI = WK-KOH-FTNRATE / 100
                 ELSE
                   COMPUTE  WK-FUTANWARI = 100            / 100
                 END-IF
                 COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                          WK-ZENGAKU * WK-FUTANWARI
      *
                 IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     >  ZAN-KOHI-T3(KOH-IDX)
                   MOVE  ZAN-KOHI-T3(KOH-IDX)
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                 IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <  580
                   MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                               TO  LNK-SYU-JYO-COMPFTN-ENTANI
                   MOVE  ZERO  TO
                            LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE  580   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                   COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                            LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                            580
                 END-IF
      *
                 IF    LNK-SYU-SYUHKNNUM  NOT =  SPACE
                   IF  KOH-IDX  =  1
                     IF  LNK-SYU-SYUCOMPFTN-ENTANI
                               >   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       COMPUTE  WK-KEISAN-JYOSEI-EN          =
                                LNK-SYU-SYUCOMPFTN-ENTANI    -
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       IF  WK-KEISAN-JYOSEI-EN
                               <   LNK-SYU-JYO-COMPFTN-ENTANI
                         MOVE   WK-KEISAN-JYOSEI-EN
                                   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                     END-IF
                   END-IF
                   IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                               >   LNK-SYU-SYUCOMPFTN-ENTANI
                       MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                 END-IF
               ELSE
                 IF      (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                 AND     (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                       IF    LNK-SYU-SYUCOMPFTN-ENTANI
                                                 >  ZAN-KOHI-T3(KOH-IDX)
                           MOVE   ZAN-KOHI-T3(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       ELSE
                           MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                 ELSE
                   IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                   AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                       IF    LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                 >  ZAN-KOHI-T3(KOH-IDX)
                           MOVE   ZAN-KOHI-T3(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       ELSE
                           MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                   ELSE
                       IF    WK-ZENGAKU   >  ZAN-KOHI-T3(KOH-IDX)
                           MOVE   ZAN-KOHI-T3(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       ELSE
                           MOVE   WK-ZENGAKU
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                   END-IF
                 END-IF
               END-IF
      *
               PERFORM    23075-KOHHI-HIKAKU4-SEC
      *
               IF    FLG-ICHIBU-JYOSEI  =   2
                 IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <  580
                   MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                               TO  LNK-SYU-JYO-COMPFTN-ENTANI
                   MOVE  ZERO  TO
                            LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE  580   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                   COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                            LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                            580
                 END-IF
               END-IF
      *
               IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          ) OR
                  ( HKN-RECEFTNDSPKBN           = "2"            ) OR
                  ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                   (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016"))
                 IF   (FLG-ICHIBU-JYOSEI     =  1      )
                 AND  (LNK-SYU-SRYYMD(1:6)  >= "201808")
                   IF  LNK-SYU-SYUHKNNUM  NOT =  SPACE
                     COMPUTE  WK-FUTANWARI = WK-KOH-FTNRATE / 100
                   ELSE
                     COMPUTE  WK-FUTANWARI = 100            / 100
                   END-IF
                   COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                            WK-ZENGAKU * WK-FUTANWARI
      *
                   IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                       >  ZAN-KOHI-T2(KOH-IDX)
                     MOVE  ZAN-KOHI-T2(KOH-IDX)
                                 TO  WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                     MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                 TO  WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                   IF  WK-KOH-COMPFTN(KOH-IDX)  <  580
                     MOVE  ZERO  TO  WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                     COMPUTE  WK-KOH-COMPFTN(KOH-IDX) =
                              WK-KOH-COMPFTN(KOH-IDX) -
                              580
                   END-IF
      *
                   IF    LNK-SYU-SYUHKNNUM  NOT =  SPACE
                     IF    WK-KOH-COMPFTN(KOH-IDX)
                                 >   LNK-SYU-SYUCOMPFTN-ENTANI
                         MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                 TO  WK-KOH-COMPFTN(KOH-IDX)
                     END-IF
                   END-IF
                 ELSE
                   IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                   AND    (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                     IF    LNK-SYU-SYUCOMPFTN-ENTANI
                                         >= ZAN-KOHI-T2(KOH-IDX)
                       MOVE  ZAN-KOHI-T2(KOH-IDX)
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                     ELSE
                       MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                     END-IF
                   ELSE
                     IF   (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                     AND  (LNK-SYU-KOH1HKNNUM        =   "027")
                         IF   LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                             >  ZAN-KOHI-T2(KOH-IDX)
                           MOVE  ZAN-KOHI-T2(KOH-IDX)
                                         TO  WK-KOH-COMPFTN(KOH-IDX)
                         ELSE
                           MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                         TO  WK-KOH-COMPFTN(KOH-IDX)
                         END-IF
                     ELSE
                         IF   WK-ZENGAKU     >  ZAN-KOHI-T2(KOH-IDX)
                           MOVE  ZAN-KOHI-T2(KOH-IDX)
                                         TO  WK-KOH-COMPFTN(KOH-IDX)
                         ELSE
                           MOVE  WK-ZENGAKU
                                         TO  WK-KOH-COMPFTN(KOH-IDX)
                         END-IF
                     END-IF
                   END-IF
                 END-IF
      *
                 PERFORM 23073-KOHHI-HIKAKU2-SEC
      *
                 IF    FLG-ICHIBU-JYOSEI  =   2
                   IF  WK-KOH-COMPFTN(KOH-IDX)  <  580
                     MOVE  ZERO  TO  WK-KOH-COMPFTN(KOH-IDX)
                   ELSE
                     COMPUTE  WK-KOH-COMPFTN(KOH-IDX) =
                              WK-KOH-COMPFTN(KOH-IDX) -
                              580
                   END-IF
                 END-IF
               END-IF
      *
               IF    FLG-ICHIBU-JYOSEI  =   1
                 IF  LNK-SYU-SYUHKNNUM  NOT =  SPACE
                   COMPUTE  WK-FUTANWARI = WK-KOH-FTNRATE / 100
                 ELSE
                   COMPUTE  WK-FUTANWARI = 100            / 100
                 END-IF
                 COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                          WK-ZENGAKU * WK-FUTANWARI
                 IF  HKN-RECEFTNDSPKBN  =  "2"
                   CONTINUE
                 ELSE
                   COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                   COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            LNK-SYU-KOH-COMPFTN(KOH-IDX)  / 10
                   COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            LNK-SYU-KOH-COMPFTN(KOH-IDX)  * 10
                 END-IF
      *
                 IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                     >  ZAN-KOHI-T(KOH-IDX)
                   MOVE  ZAN-KOHI-T(KOH-IDX)
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
                 IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)  <  580
                    COMPUTE   WK-KEISAN-JYOSEI              =
                              LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                    COMPUTE   WK-KEISAN-JYOSEI              =
                              WK-KEISAN-JYOSEI              / 10
                    COMPUTE   WK-KEISAN-JYOSEI              =
                              WK-KEISAN-JYOSEI              * 10
                    MOVE  WK-KEISAN-JYOSEI
                                TO  LNK-SYU-JYO-HKNFTNMONEY
                                    LNK-SYU-JYO-COMPFTN
                    MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 ELSE
                    MOVE  580   TO  LNK-SYU-JYO-HKNFTNMONEY
                                    LNK-SYU-JYO-COMPFTN
                    COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                             580
                 END-IF
      *
                 IF    LNK-SYU-SYUHKNNUM  NOT =  SPACE
                   IF  KOH-IDX  =  1
                     IF  LNK-SYU-SYUCOMPFTN
                               >   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       COMPUTE  WK-KEISAN-JYOSEI             =
                                LNK-SYU-SYUCOMPFTN           +  5
                       COMPUTE  WK-KEISAN-JYOSEI             =
                                WK-KEISAN-JYOSEI             / 10
                       COMPUTE  WK-KEISAN-JYOSEI             =
                                WK-KEISAN-JYOSEI             * 10
                       COMPUTE  WK-KEISAN-JYOSEI2            =
                                LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                       COMPUTE  WK-KEISAN-JYOSEI2            =
                                WK-KEISAN-JYOSEI2            / 10
                       COMPUTE  WK-KEISAN-JYOSEI2            =
                                WK-KEISAN-JYOSEI2            * 10
                       COMPUTE  WK-KEISAN-JYOSEI3            =
                                WK-KEISAN-JYOSEI             -
                                WK-KEISAN-JYOSEI2
                       IF WK-KEISAN-JYOSEI3 < LNK-SYU-JYO-COMPFTN
                         MOVE   WK-KEISAN-JYOSEI3
                                   TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                     END-IF
                   END-IF
                   IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)
                               >   LNK-SYU-SYUCOMPFTN
                       MOVE  LNK-SYU-SYUCOMPFTN
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 END-IF
               ELSE
                 IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                 AND    (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                     IF  LNK-SYU-SYUCOMPFTN > ZAN-KOHI-T(KOH-IDX)
                       MOVE   ZAN-KOHI-T(KOH-IDX)
                                   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                       MOVE   LNK-SYU-SYUCOMPFTN
                                   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     END-IF
                 ELSE
                   IF   (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                   AND  (LNK-SYU-KOH1HKNNUM        =   "027")
                     IF  LNK-SYU-KOH-COMPFTN(1) > ZAN-KOHI-T(KOH-IDX)
                       MOVE   ZAN-KOHI-T(KOH-IDX)
                                   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                       MOVE   LNK-SYU-KOH-COMPFTN(1)
                                   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     END-IF
                   ELSE
                     IF  WK-ZENGAKU > ZAN-KOHI-T(KOH-IDX)
                       MOVE   ZAN-KOHI-T(KOH-IDX)
                                   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     ELSE
                       MOVE   WK-ZENGAKU
                                   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                     END-IF
                   END-IF
                 END-IF
               END-IF
      *
               PERFORM   23072-KOHHI-HIKAKU-SEC
      *
               IF    FLG-ICHIBU-JYOSEI  =   2
                 IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)  <  580
                    COMPUTE   WK-KEISAN-JYOSEI              =
                              LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                    COMPUTE   WK-KEISAN-JYOSEI              =
                              WK-KEISAN-JYOSEI              / 10
                    COMPUTE   WK-KEISAN-JYOSEI              =
                              WK-KEISAN-JYOSEI              * 10
                    MOVE  WK-KEISAN-JYOSEI
                                TO  LNK-SYU-JYO-HKNFTNMONEY
                                    LNK-SYU-JYO-COMPFTN
                    MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 ELSE
                    MOVE  580   TO  LNK-SYU-JYO-HKNFTNMONEY
                                    LNK-SYU-JYO-COMPFTN
                    COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                             580
                 END-IF
               END-IF
      *
               MOVE   ZAN-KOHI-T(KOH-IDX)  TO  WK-ZAN-SEIHO
      *
               IF  (  FLG-ZENKI-TOKUREI           =   1    )
               AND (( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051" )
                 OR ((WK-1001-PREFNUM             =  13  ) AND
                     (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "151") AND
                     (WK-NYUSKJRYYKBN             = "2"  ))
                 OR ((WK-1001-PREFNUM             =  23  ) AND
                     (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "191") AND
                     (WK-NYUSKJRYYKBN             = "2"  ) AND
                     (LNK-SYU-SRYYMD(1:6)     >= "200910")))
                  COMPUTE  WK-ZENKI-TOKUREI-MONEY
                                   =  WK-ZENGAKU  *  0.2
                  COMPUTE  WK-ZENKI-TOKUREI-MONEY  =
                           WK-ZENKI-TOKUREI-MONEY  +  5
                  COMPUTE  WK-ZENKI-TOKUREI-MONEY  =
                           WK-ZENKI-TOKUREI-MONEY  / 10
                  COMPUTE  WK-ZENKI-TOKUREI-MONEY  =
                           WK-ZENKI-TOKUREI-MONEY  * 10
                  IF   WK-ZENKI-TOKUREI-MONEY > WK-KOH-GENDOGAKU
                    MOVE   WK-KOH-GENDOGAKU
                                     TO   WK-ZENKI-TOKUREI-MONEY
                  END-IF
                  IF   WK-GENGAKUKBN   =   3 OR 4
                    MOVE      ZERO   TO   WK-ZENKI-TOKUREI-MONEY
                  END-IF
                  IF   WK-ZENKI-TOKUREI-MONEY  <  ZAN-KOHI-T(KOH-IDX)
                    COMPUTE   ZAN-KOHI-T(KOH-IDX)  =
                              ZAN-KOHI-T(KOH-IDX)  -
                              WK-ZENKI-TOKUREI-MONEY
                  ELSE
                    MOVE      ZERO   TO   ZAN-KOHI-T(KOH-IDX)
                  END-IF
               ELSE
                  COMPUTE   ZAN-KOHI-T(KOH-IDX)  =
                            ZAN-KOHI-T(KOH-IDX)  -
                            LNK-SYU-KOH-COMPFTN(KOH-IDX)
               END-IF
      *
               IF   (LNK-SYU-KOH-COMPFTN(KOH-IDX)    NOT = ZERO)
               AND  (ZAN-KOHI-T(KOH-IDX)                 = ZERO)
                 IF  ((LNK-SYU-KOH-HKNNUM(KOH-IDX)         =
                                 "011" OR "020" OR "012" OR "025") AND
                      (WK-TAIHI-JGNGAKEN(KOH-IDX)(7:1) NOT = "0" ))
                 OR  ((LNK-SYU-KOH-HKNNUM(KOH-IDX)         =
                                                   "012" OR "025") AND
                      (COMB-HKNNUM              =  SPACE         ) AND
                      (COMB-KOH1HKNNUM          =  "012" OR "025") AND
                      (COMB-KOH2HKNNUM          =  SPACE         ) AND
                      (COMB-KOH3HKNNUM          =  SPACE         ) AND
                      (COMB-KOH4HKNNUM          =  SPACE         ) AND
                      (WK-ZAN-SEIHO(8:1)    NOT =  "0"           ))
                   MOVE     1    TO    WK-TAIHI-FTNGAKEN(KOH-IDX)
                 END-IF
               END-IF
      *
               COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                         LNK-SYU-KOH-COMPFTN(KOH-IDX)     
      *
               IF    ZAN-KOHI-T(KOH-IDX)   NOT =   ZERO
                 IF  ((LNK-SYU-KOH-HKNNUM(KOH-IDX)         =
                                 "011" OR "020" OR "012" OR "025") AND
                      (WK-TAIHI-JGNGAKEN(KOH-IDX)(7:1) NOT = "0" ))
                 OR  ((LNK-SYU-KOH-HKNNUM(KOH-IDX)         =
                                                   "012" OR "025") AND
                      (COMB-HKNNUM              =  SPACE         ) AND
                      (COMB-KOH1HKNNUM          =  "012" OR "025") AND
                      (COMB-KOH2HKNNUM          =  SPACE         ) AND
                      (COMB-KOH3HKNNUM          =  SPACE         ) AND
                      (COMB-KOH4HKNNUM          =  SPACE         ) AND
                      (WK-ZAN-SEIHO(8:1)    NOT =  "0"           ))
                   CONTINUE
                 ELSE
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =
      ***                    ZAN-KOHI-T(KOH-IDX)  +  5
                             ZAN-KOHI-T(KOH-IDX)  +  4
                   COMPUTE   WK-FTN      =
                             ZAN-KOHI-T(KOH-IDX)  /  10
                   COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                             WK-FTN   *  10
                 END-IF
               END-IF
      *
      *        ¸øÈñ¤Î¿©»öÊÔ½¸
               PERFORM   23089-KOH-SKJ-HENSYU-SEC
           END-IF.
      *
       2307-KOH-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÆüÊÌ¼ýÇ¼»»Äê
      ******************************************************************
       23071-DAYINF-SANTEI-SEC           SECTION.
      *
           INITIALIZE   WK-TANKI-TBL.
           IF  (LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1) >= "1" AND <= "8")
           AND (LNK-S02-NYUINDAY-TANKI-TBL    NOT = SPACE         )
             PERFORM    230713-TANKITAIZAI-CHECK-SEC
           END-IF.
      *
           MOVE    LNK-S02-IDX    TO    IDX20.
           MOVE    ZERO           TO    FLG-CYOKEIKBN-N.
           IF     WK-2010-CYOKEIKBN-N(KOH-IDX)  =  "1"
             EVALUATE   KOH-IDX
               WHEN       1
                 IF  (LNK-SYU-KOH-HKNNUM(2) = "972" OR "974")
                 OR  (LNK-SYU-KOH-HKNNUM(3) = "972" OR "974")
                 OR  (LNK-SYU-KOH-HKNNUM(4) = "972" OR "974")
                    PERFORM    230711-ZANOKIKAE-HENSYU-SEC
                 END-IF
               WHEN       2
                 IF  (LNK-SYU-KOH-HKNNUM(3) = "972" OR "974")
                 OR  (LNK-SYU-KOH-HKNNUM(4) = "972" OR "974")
                    PERFORM    230711-ZANOKIKAE-HENSYU-SEC
                 END-IF
               WHEN       3
                 IF  (LNK-SYU-KOH-HKNNUM(4) = "972" OR "974")
                    PERFORM    230711-ZANOKIKAE-HENSYU-SEC
                 END-IF
             END-EVALUATE
           END-IF.
      *
           MOVE       ZERO        TO       FLG-HIKOTEI.
           IF      WK-2010-DAYKEIKBN-N(KOH-IDX)  =  "1"
                 MOVE         1      TO      FLG-HIKOTEI
           END-IF.
      *
           MOVE       ZERO        TO       FLG-TUKIHIKAKU.
           EVALUATE     KOH-IDX
              WHEN        1
                  IF    MAX-KIN-KOHI1-M     NOT  = ZERO
                      MOVE     1     TO     FLG-TUKIHIKAKU
                  END-IF
              WHEN        2
                  IF   (MAX-KIN-KOHI2-M     NOT  = ZERO)
                  OR   (FLG-RUIKEIYO-DAY         =  1  )
                      MOVE     1     TO     FLG-TUKIHIKAKU
                  END-IF
              WHEN        3
                  IF    MAX-KIN-KOHI3-M     NOT  = ZERO
                      MOVE     1     TO     FLG-TUKIHIKAKU
                  END-IF
              WHEN        4
                  IF    MAX-KIN-KOHI4-M     NOT  = ZERO
                      MOVE     1     TO     FLG-TUKIHIKAKU
                  END-IF
           END-EVALUATE.
      *
           MOVE    "1"    TO   LNK-SDAY-DAYINFFLG.
      *
           MOVE    ZERO   TO   WK-DAY-KOH-COMPFTN(KOH-IDX).
      *
           IF      WK-2010-ZENDAYKBN-N(KOH-IDX)  =  "1"
             MOVE  WK-DAY-NYUKFTNRATE2      TO  WK-DAY-NYUKFTNRATE9
             MOVE  WK-DAY-NYUKFTNRATE-FLG2  TO  WK-DAY-NYUKFTNRATE-FLG9
           ELSE
             MOVE  WK-DAY-NYUKFTNRATE       TO  WK-DAY-NYUKFTNRATE9
             MOVE  WK-DAY-NYUKFTNRATE-FLG   TO  WK-DAY-NYUKFTNRATE-FLG9
           END-IF.
      *
           IF    WK-NYUKFTNRATE    NOT =  ZERO
             IF    WK-DAY-NYUKFTNRATE9      =  ZERO
             AND   WK-DAY-NYUKFTNRATE-FLG9  =  ZERO
                 MOVE  WK-NYUKFTNRATE  TO  WK-DAY-NYUKFTNRATE9
             ELSE
               IF  WK-DAY-NYUKFTNRATE9  > WK-NYUKFTNRATE
                 MOVE  WK-NYUKFTNRATE  TO  WK-DAY-NYUKFTNRATE9
               END-IF
             END-IF
           END-IF.
      *
           COMPUTE   WK-FUTANWARI  =
                                WK-DAY-NYUKFTNRATE9  /  100.
      *
           PERFORM    VARYING   IDX2   FROM   1   BY   1
                         UNTIL    IDX2     >    31
      *
               IF     FLG-CYOKEIKBN-N  NOT = ZERO
                  MOVE  LNK-SYU-SKYSTYMD(7:2)  TO  IDX-ST
                  MOVE  LNK-SYU-SKYEDYMD(7:2)  TO  IDX-ED
                  IF   (IDX-ST <= IDX2  )
                  AND  (IDX2   <= IDX-ED)
                     PERFORM    230712-ZANOKIKAE-HENSYU2-SEC
                  END-IF
               END-IF
      *
               IF    KOHI-TBL(IDX2 KOH-IDX)  =   9
      *
                 MOVE   99999    TO   WK-DAY-COMPFTN
      *
                 MOVE      1     TO    LNK-SDAY-SANTEIFLG(IDX2 KOH-IDX)
                 IF     WK-RRK2-FLG(KOH-IDX)    =   1
                   IF   WK-RRK-KAISU-ZAN(IDX2)  =  999
                     MOVE  ZERO  TO    LNK-SDAY-SANTEIFLG(IDX2 KOH-IDX)
                   END-IF
                 END-IF
      *
                 MOVE   ZERO     TO    WK-TAIHI-SDAY-COMPFTN
                                       WK-TAIHI-SDAY-COMPFTNWK
                                       WK-TAIHI-SDAY-FTNMONEY
      *
                 IF     WK-DAY-NYUKFTNRATE9    NOT =    ZERO
                    COMPUTE   WK-TAIHI-SDAY-COMPFTN =
                              LNK-SDAY-HKNTEN(IDX2) *
                              HKN-TENTNK            *
                              WK-FUTANWARI
                    COMPUTE   WK-TAIHI-SDAY-COMPFTNWK =
                              LNK-SDAY-HKNTEN(IDX2)   *
                              HKN-TENTNK              *
                              WK-FUTANWARI
                 ELSE
                    COMPUTE   WK-TAIHI-SDAY-COMPFTN =
                              LNK-SDAY-HKNTEN(IDX2) *
                              HKN-TENTNK
                    COMPUTE   WK-TAIHI-SDAY-COMPFTNWK  =
                              LNK-SDAY-HKNTEN(IDX2)    *
                              HKN-TENTNK
                 END-IF
      *
                 IF   (LNK-S02-NYUINDAY-KBN(IDX2)   =  "1")
                 AND  (WK-2010-TANKIKBN(KOH-IDX)    =  "1")
                    MOVE   ZAN-KOHI-D(IDX2 KOH-IDX)   TO
                                    WK-TAIHI-SDAY-COMPFTN
                    MOVE   ZAN-KOHI-D3(IDX2 KOH-IDX)  TO
                                    WK-TAIHI-SDAY-COMPFTNWK
                 END-IF
      *
                 IF ((KOH-IDX                   =    1   ) AND
                     (LNK-SYU-SYUHKNNUM     NOT =   SPACE) AND
                     (LNK-SYU-SYUCOMPFTN        =   ZERO ))
                 OR ((KOH-IDX                   >    1   ) AND
                     (LNK-SYU-SYUHKNNUM     NOT =   SPACE) AND
                     (LNK-SYU-KOH-HKNNUM(1) NOT =   "027") AND
                     (LNK-SYU-SYUCOMPFTN        =   ZERO ))
                   MOVE   ZERO   TO  WK-TAIHI-SDAY-COMPFTN
                                     WK-TAIHI-SDAY-COMPFTNWK
                 ELSE
                   IF  (KOH-IDX         =   2)
                   AND (WK-RUI-TAISYO   =   1)
                     CONTINUE
                   ELSE
                     IF  (KOH-IDX                             >  1   )
                     AND (LNK-SYU-KOH-HKNNUM(KOH-IDX - 1) NOT = SPACE)
                     AND (LNK-SYU-KOH-COMPFTN(KOH-IDX - 1)    = ZERO )
                       MOVE   ZERO   TO  WK-TAIHI-SDAY-COMPFTN
                                         WK-TAIHI-SDAY-COMPFTNWK
                     END-IF
                   END-IF
                 END-IF
      *
                 IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          ) OR
                    ( HKN-RECEFTNDSPKBN           = "2"            ) OR
                    ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                     (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016"))
                     MOVE  "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                     IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                         MOVE  WK-TOKUTEI-COMPFTN
                                           TO  LNK-SYU-SYUCOMPFTN
                     END-IF
                     IF    LNK-SYU-KOH-HKNNUM(1)    =    "027"
                       IF  WK-TOKUTEI-COMPFTN3  NOT =    ZERO
                         MOVE  WK-TOKUTEI-COMPFTN3
                                           TO  LNK-SYU-KOH-COMPFTN(1)
                       END-IF
                     END-IF
                 ELSE
                     COMPUTE   WK-TAIHI-SDAY-COMPFTN  =
                               WK-TAIHI-SDAY-COMPFTN  +  5
                     COMPUTE   WK-FTN      =
                               WK-TAIHI-SDAY-COMPFTN  / 10
                     COMPUTE   WK-TAIHI-SDAY-COMPFTN  =
                               WK-FTN   *  10
                 END-IF
      *
                 IF      WK-TAIHI-SDAY-COMPFTNWK
                                          >   ZAN-KOHI-D3(IDX2 KOH-IDX)
                       MOVE   ZAN-KOHI-D3(IDX2 KOH-IDX)  TO
                                       WK-TAIHI-SDAY-COMPFTNWK
                 END-IF
      *
                 IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          ) OR
                    ( HKN-RECEFTNDSPKBN           = "2"            ) OR
                    ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                     (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016"))
                   IF    WK-TAIHI-SDAY-COMPFTN
                                          >   ZAN-KOHI-D2(IDX2 KOH-IDX)
                       MOVE   ZAN-KOHI-D2(IDX2 KOH-IDX)  TO
                                     WK-DAY-COMPFTN
                   ELSE
                       MOVE   WK-TAIHI-SDAY-COMPFTN      TO
                                     WK-DAY-COMPFTN
                   END-IF
                 END-IF
      *
                 MOVE    ZAN-KOHI-D(IDX2 KOH-IDX)   TO   WK-ZAN-KOHI-D
      *
                 IF      WK-TAIHI-SDAY-COMPFTN
                                          >   ZAN-KOHI-D(IDX2 KOH-IDX)
                       MOVE   ZAN-KOHI-D(IDX2 KOH-IDX)   TO
                                    WK-TAIHI-SDAY-COMPFTN
                       MOVE   ZERO        TO  ZAN-KOHI-D(IDX2 KOH-IDX)
                 ELSE
                       COMPUTE  ZAN-KOHI-D(IDX2 KOH-IDX)    =
                                ZAN-KOHI-D(IDX2 KOH-IDX)    -
                                WK-TAIHI-SDAY-COMPFTN
                 END-IF
      *
                 IF    ZAN-KOHI-D(IDX2 KOH-IDX)   NOT =   ZERO
                     COMPUTE   ZAN-KOHI-D(IDX2 KOH-IDX) =
      ***                      ZAN-KOHI-D(IDX2 KOH-IDX) +  5
                               ZAN-KOHI-D(IDX2 KOH-IDX) +  4
                     COMPUTE   WK-FTN      =
                               ZAN-KOHI-D(IDX2 KOH-IDX) /  10
                     COMPUTE   ZAN-KOHI-D(IDX2 KOH-IDX) =
                               WK-FTN   *  10
                 END-IF
      *
                 IF   ( FLG-HIKOTEI            NOT =  ZERO )
                 AND  ( WK-TAIHI-SDAY-COMPFTN  NOT =  ZERO )
                    MOVE   ZAN-KOHI-D3(IDX2 KOH-IDX)  TO
                                 WK-TAIHI-SDAY-COMPFTNWK
                    MOVE   ZAN-KOHI-D2(IDX2 KOH-IDX)  TO
                                 WK-TAIHI-SDAY-COMPFTN
                    MOVE   WK-ZAN-KOHI-D              TO
                                 WK-TAIHI-SDAY-FTNMONEY
                    MOVE   ZERO        TO   ZAN-KOHI-D(IDX2 KOH-IDX)
                 ELSE
                    MOVE      WK-TAIHI-SDAY-COMPFTN
                                  TO   WK-TAIHI-SDAY-FTNMONEY
                    COMPUTE   WK-TAIHI-SDAY-FTNMONEY  =
                              WK-TAIHI-SDAY-FTNMONEY  +  5
                    COMPUTE   WK-FTN      =
                              WK-TAIHI-SDAY-FTNMONEY  / 10
                    COMPUTE   WK-TAIHI-SDAY-FTNMONEY  =
                              WK-FTN   *  10
      *
                    IF    WK-DAY-COMPFTN    =  ALL"9"
                          CONTINUE
                    ELSE
                          MOVE  WK-DAY-COMPFTN     TO   
                                     WK-TAIHI-SDAY-COMPFTN
                    END-IF
                 END-IF
      *
                 IF    WK-TANKI-CYOSYU(IDX2)    NOT = ZERO
                   EVALUATE     KOH-IDX
                     WHEN        1
                       MOVE  MAX-KIN-KOHI1-D  TO  WK-TANKI-DAYJGN
                     WHEN        2
                       MOVE  MAX-KIN-KOHI2-D  TO  WK-TANKI-DAYJGN
                     WHEN        3
                       MOVE  MAX-KIN-KOHI3-D  TO  WK-TANKI-DAYJGN
                     WHEN        4
                       MOVE  MAX-KIN-KOHI4-D  TO  WK-TANKI-DAYJGN
                   END-EVALUATE
                   COMPUTE  WK-TAIHI-SDAY-COMPFTNWK   =
                            WK-TANKI-DAYJGN           *
                            WK-TANKI-CYOSYU(IDX2)
                   COMPUTE  WK-TAIHI-SDAY-COMPFTN     =
                            WK-TANKI-DAYJGN           *
                            WK-TANKI-CYOSYU(IDX2)
                   COMPUTE  WK-TAIHI-SDAY-FTNMONEY    =
                            WK-TANKI-DAYJGN           *
                            WK-TANKI-CYOSYU(IDX2)
                   MOVE     ZERO  TO  ZAN-KOHI-D(IDX2 KOH-IDX)
                 ELSE
                   IF  WK-TANKI-MICYOSYU(IDX2)  NOT = ZERO
                     MOVE   ZERO  TO  WK-TAIHI-SDAY-COMPFTNWK
                     MOVE   ZERO  TO  WK-TAIHI-SDAY-COMPFTN
                     MOVE   ZERO  TO  WK-TAIHI-SDAY-FTNMONEY
                     MOVE   ZERO  TO  ZAN-KOHI-D(IDX2 KOH-IDX)
                   END-IF
                 END-IF
      *
                 IF    (WK-DAYINF-ZENKOH-FLG(1)        =   1 )
                 AND   (KOH-IDX                        >   1 )
                 AND   (WK-2010-ZENDAY2KBN-N(KOH-IDX)  =  "1")
                   IF     LNK-SDAY-FTNMONEY(IDX2 1)  <
                                       WK-TAIHI-SDAY-FTNMONEY
                       MOVE  LNK-SDAY-FTNMONEY(IDX2 1)
                                     TO  WK-TAIHI-SDAY-FTNMONEY
                   END-IF
                   IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"    )
                   OR ( HKN-RECEFTNDSPKBN           = "2"      )
                   OR ((LNK-SYU-SRYYMD(1:6)        >= "200404") AND
                       (LNK-SYU-KOH-HKNNUM(KOH-IDX) =
                                             "015" OR "016"   ))
                        IF   LNK-SDAY-COMPFTN(IDX2 1)   <
                                          WK-TAIHI-SDAY-COMPFTN
                          MOVE    LNK-SDAY-COMPFTN(IDX2 1)
                                        TO  WK-TAIHI-SDAY-COMPFTN
                        END-IF
                   ELSE
                        IF   LNK-SDAY-FTNMONEY(IDX2 1)  <
                                          WK-TAIHI-SDAY-COMPFTN
                          MOVE    LNK-SDAY-FTNMONEY(IDX2 1)
                                        TO  WK-TAIHI-SDAY-COMPFTN
                        END-IF
                   END-IF
                   IF     LNK-SDAY-COMPFTNWK(IDX2 1) <
                                       WK-TAIHI-SDAY-COMPFTNWK
                       MOVE  LNK-SDAY-COMPFTNWK(IDX2 1)
                                     TO  WK-TAIHI-SDAY-COMPFTNWK
                   END-IF
                 END-IF
      *
                 MOVE  WK-TAIHI-SDAY-COMPFTN  
                                   TO  LNK-SDAY-COMPFTN(IDX2 KOH-IDX)
                 MOVE  WK-TAIHI-SDAY-FTNMONEY
                                   TO  LNK-SDAY-FTNMONEY(IDX2 KOH-IDX)
                 MOVE  WK-TAIHI-SDAY-COMPFTNWK
                                   TO  LNK-SDAY-COMPFTNWK(IDX2 KOH-IDX)
      *
                 ADD   LNK-SDAY-COMPFTN(IDX2 KOH-IDX)  TO
                                 WK-DAY-KOH-COMPFTN(KOH-IDX)
      *
      *          ¼ýÇ¼¹àÌÜ
                 ADD   LNK-SDAY-FTNMONEY(IDX2 KOH-IDX)
                            TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
                 IF    LNK-SYU-SRYYMD(1:6)  < "201904"
                    ADD   LNK-SDAY-COMPFTNWK(IDX2 KOH-IDX)
                            TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                    ADD   WK-TAIHI-SDAY-COMPFTNWK
                            TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
      *
               END-IF
      *
               EVALUATE   WK-NYUSKJRYYKBN
                 WHEN   "1"
                 WHEN   "2"
                 WHEN   "4"
                   MOVE  WK-DAY-SKJFTN(IDX2)
                            TO   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                   IF ((WK-2010-IRYOKEIKBN-N(KOH-IDX)  = "3" OR "4") AND
                       (WK-2010-SKJKEIKBN(KOH-IDX) NOT = SPACE     ) AND
                       (WK-TAIHI-HANTEIFLG(KOH-IDX)    = ZERO      ) AND
                       (FLG-NYUSKJJYOGAK           NOT = ZERO      ))
                   OR ((WK-2010-IRYOKEIKBN-N(KOH-IDX)  = "3" OR "4") AND
                       (WK-2010-SKJKEIKBN(KOH-IDX)     = SPACE     ) AND
                       (FLG-NYUSKJJYOGAK           NOT = ZERO      ))
                   OR ((WK-2010-IRYOKEIKBN-N(KOH-IDX)  = SPACE     ) AND
                       (FLG-NYUSKJJYOGAK           NOT = ZERO      ))
                     EVALUATE  FLG-NYUSKJJYOGAK
                       WHEN     1
                         IF  LNK-SDAY-SKJFTN(IDX2 KOH-IDX) NOT = ZERO
                           COMPUTE LNK-SDAY-SKJFTN(IDX2 KOH-IDX) =
                                   LNK-SDAY-SKJFTN(IDX2 KOH-IDX) /  2
                         END-IF
                       WHEN     2
                         IF  LNK-SDAY-SKJFTN(IDX2 KOH-IDX) NOT = ZERO
                           MOVE  ZERO  TO  LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                         END-IF
                       WHEN     3
                         IF  LNK-SDAY-SKJFTN(IDX2 KOH-IDX) NOT = ZERO
                           COMPUTE LNK-SDAY-SKJFTN(IDX2 KOH-IDX) =
                                   LNK-SDAY-SKJFTN(IDX2 1)       /  2
                         END-IF
                     END-EVALUATE
                   ELSE
                     IF  WK-NYUSKJJYOGAK  NOT =  ZERO
                       IF    LNK-SYU-SRYYMD(1:6)  >=  "200604"
                         COMPUTE   WK-NYUSKJJYOGAK2  =
                                   WK-NYUSKJJYOGAK   *
                                   WK-DAY-KAISU(IDX2)
                         IF  WK-DAY-SKJFTN(IDX2) > WK-NYUSKJJYOGAK2
                           COMPUTE LNK-SDAY-SKJFTN(IDX2 KOH-IDX) =
                                   LNK-SDAY-SKJFTN(IDX2 KOH-IDX) -
                                   WK-NYUSKJJYOGAK2
                         ELSE
                           MOVE  ZERO  TO
                                   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                         END-IF
                       ELSE
                         IF  WK-DAY-SKJFTN(IDX2) > WK-NYUSKJJYOGAK
                           COMPUTE LNK-SDAY-SKJFTN(IDX2 KOH-IDX) =
                                   LNK-SDAY-SKJFTN(IDX2 KOH-IDX) -
                                   WK-NYUSKJJYOGAK
                         ELSE
                           MOVE  ZERO  TO
                                   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                         END-IF
                       END-IF
                     END-IF
                   END-IF
      ****         IF    WK-NYUSKJRYYKBN  =  "2"
      ****           IF  LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
      ****                           > ZAN-KOHI-D(IDX2 KOH-IDX)
      ****             MOVE  ZAN-KOHI-D(IDX2 KOH-IDX)  TO
      ****                         LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
      ****           END-IF
      ****         END-IF
      *            ¼ýÇ¼¹àÌÜ
                   ADD   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                            TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                   IF    FLG-NYUSKJJYOGAK      =   1
                   AND   FLG-MIYAGI        NOT =   ZERO
                     IF  WK-DAY-SKJFTN(IDX2)  NOT = ZERO
                       COMPUTE LNK-SYU-SKJ-FTN-RECE(KOH-IDX) =
                               LNK-SYU-SKJ-FTN-RECE(KOH-IDX) +
                               (WK-DAY-SKJFTN(IDX2) / 2)
                     END-IF
                   ELSE
                     ADD WK-DAY-SKJFTN(IDX2)
                            TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                   END-IF
                 WHEN   "3"
      *            ¼ýÇ¼¹àÌÜ
                   ADD   WK-DAY-SKJFTN(IDX2)
                            TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 WHEN   "5"
                   IF  (WK-2010-IRYOKEIKBN-N(KOH-IDX)  = "3" OR "4")
                   AND (WK-2010-SKJKEIKBN(KOH-IDX) NOT = SPACE     )
                   AND (WK-TAIHI-HANTEIFLG(KOH-IDX)    =  1        )
                     MOVE  WK-DAY-SKJFTN(IDX2)
                              TO   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
      *              ¼ýÇ¼¹àÌÜ
                     ADD   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                              TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                     ADD   WK-DAY-SKJFTN(IDX2)
                              TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                     MOVE  "1"    TO   WK-NYUSKJRYYKBN
                     MOVE  SPACE  TO   WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                   ELSE
                     MOVE  WK-DAY-SKJFTNL(IDX2)
                              TO   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
      *              ¼ýÇ¼¹àÌÜ
                     ADD   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                              TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                     ADD   WK-DAY-SKJFTNS(IDX2)
                              TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                   END-IF
                 WHEN   "7"
                   IF  (WK-2010-IRYOKEIKBN-N(KOH-IDX)  = "3" OR "4")
                   AND (WK-2010-SKJKEIKBN(KOH-IDX) NOT = SPACE     )
                   AND (WK-TAIHI-HANTEIFLG(KOH-IDX)    =  1        )
                     MOVE  WK-DAY-SKJFTN(IDX2)
                              TO   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
      *              ¼ýÇ¼¹àÌÜ
                     ADD   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                              TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                     ADD   WK-DAY-SKJFTN(IDX2)
                              TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                     MOVE  "1"    TO   WK-NYUSKJRYYKBN
                     MOVE  SPACE  TO   WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                   ELSE
                     MOVE  WK-DAY-SKJFTNL(IDX2)
                              TO   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                     COMPUTE  LNK-SDAY-SKJFTN(IDX2 KOH-IDX) =
                              LNK-SDAY-SKJFTN(IDX2 KOH-IDX) +
                              (WK-DAY-SKJFTNS(IDX2)  /  2)
      *              ¼ýÇ¼¹àÌÜ
                     ADD   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                              TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                     ADD   WK-DAY-SKJFTNS(IDX2)
                              TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                   END-IF
                 WHEN   "8"
                   IF  (WK-2010-IRYOKEIKBN-N(KOH-IDX)  = "3" OR "4")
                   AND (WK-2010-SKJKEIKBN(KOH-IDX) NOT = SPACE     )
                   AND (WK-TAIHI-HANTEIFLG(KOH-IDX)    =  1        )
                     MOVE  WK-DAY-SKJFTN(IDX2)
                              TO   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
      *              ¼ýÇ¼¹àÌÜ
                     ADD   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                              TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                     ADD   WK-DAY-SKJFTN(IDX2)
                              TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                     MOVE  "1"    TO   WK-NYUSKJRYYKBN
                     MOVE  SPACE  TO   WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                   ELSE
                     MOVE  WK-DAY-SKJFTNL2(IDX2)
                              TO   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                     COMPUTE  WK-DAY-KEISAN                 =
                              WK-DAY-SKJFTN(IDX2)           -
                              WK-DAY-SKJFTNL2(IDX2)
                     COMPUTE  LNK-SDAY-SKJFTN(IDX2 KOH-IDX) =
                              LNK-SDAY-SKJFTN(IDX2 KOH-IDX) +
                              (WK-DAY-KEISAN  /  2)
      *              ¼ýÇ¼¹àÌÜ
                     ADD   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                              TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                     ADD   WK-DAY-KEISAN
                              TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                   END-IF
                 WHEN   "9"
                   IF  (WK-2010-IRYOKEIKBN-N(KOH-IDX)  = "3" OR "4")
                   AND (WK-2010-SKJKEIKBN(KOH-IDX) NOT = SPACE     )
                   AND (WK-TAIHI-HANTEIFLG(KOH-IDX)    =  1        )
                     MOVE  WK-DAY-SKJFTN(IDX2)
                              TO   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
      *              ¼ýÇ¼¹àÌÜ
                     ADD   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                              TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                     ADD   WK-DAY-SKJFTN(IDX2)
                              TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                     MOVE  "1"    TO   WK-NYUSKJRYYKBN
                     MOVE  SPACE  TO   WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                   ELSE
                     MOVE  WK-DAY-SKJFTNL2(IDX2)
                              TO   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                     COMPUTE  WK-DAY-KEISAN                 =
                              WK-DAY-SKJFTN(IDX2)           -
                              WK-DAY-SKJFTNL2(IDX2)
      *              ¼ýÇ¼¹àÌÜ
                     ADD   LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
                              TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                     ADD   WK-DAY-KEISAN
                              TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                   END-IF
               END-EVALUATE
      *
           END-PERFORM.
      *
      *    ¼ýÇ¼¹àÌÜ
      *
           MOVE     "1"             TO   LNK-SYU-DAYINFFLG.
      *
           MOVE  WK-NYUSKJRYYKBN    TO LNK-SYU-SKJ-FTNKBN(KOH-IDX).
           IF    WK-NYUSKJRYYKBN    =    "2"
             MOVE   "1"             TO LNK-SYU-SKJ-FTNKBN(KOH-IDX)
           END-IF.
           MOVE  WK-SHOKUJI-NISSU   TO LNK-SYU-SKJ-NISSU(KOH-IDX).
           MOVE  WK-SHOKUJI-RYOYOHI TO LNK-SYU-SKJ-RYOYOHI(KOH-IDX).
           IF    WK-NYUSKJRYYKBN    =    "5" OR "7"
             MOVE WK-SHOKUJI-NISSUS   TO LNK-SYU-SKJ-NISSU(KOH-IDX)
             MOVE WK-SHOKUJI-RYOYOHIS TO LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
           END-IF.
           IF    WK-NYUSKJRYYKBN    =    "8" OR "9"
             COMPUTE  LNK-SYU-SKJ-RYOYOHI(KOH-IDX)  =
                      WK-SHOKUJI-RYOYOHI            -
                      WK-SHOKUJI-RYOYOHIL2
           END-IF.
      *
           IF     WK-NYUSKJRYYKBN   =  "1"
           AND    FLG-NYUSKJJYOGAK  =   3
               COMPUTE LNK-SYU-SKJ-FTN(KOH-IDX) =
                       LNK-SYU-SKJ-FTN(1)       /  2
           END-IF.
      *
           IF      FLG-TUKIHIKAKU     NOT =    ZERO
                IF  ZAN-KOHI-T(KOH-IDX)   <
                                        LNK-SYU-KOH-COMPFTN(KOH-IDX)
                    MOVE  ZAN-KOHI-T(KOH-IDX)
                                 TO     LNK-SYU-KOH-COMPFTN(KOH-IDX)
                END-IF
                IF  ZAN-KOHI-T2(KOH-IDX)  <
                                         WK-DAY-KOH-COMPFTN(KOH-IDX)
                    MOVE  ZAN-KOHI-T2(KOH-IDX)
                                 TO      WK-DAY-KOH-COMPFTN(KOH-IDX)
                END-IF
                IF  ZAN-KOHI-T3(KOH-IDX)  <
                                 LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                    MOVE  ZAN-KOHI-T3(KOH-IDX)
                             TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                END-IF
           END-IF.
      *
           PERFORM    23072-KOHHI-HIKAKU-SEC.
           PERFORM    23074-KOHHI-HIKAKU3-SEC.
           PERFORM    23075-KOHHI-HIKAKU4-SEC.                                
      *
           IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) = ZERO
            IF    WK-2010-KAICNTKBN-N(KOH-IDX)  =  "1"
              CONTINUE
            ELSE
              PERFORM    VARYING   IDX2    FROM   1   BY   1
                          UNTIL    IDX2     >    31
                 MOVE   ZERO   TO   LNK-SDAY-SANTEIFLG(IDX2 KOH-IDX)
              END-PERFORM
            END-IF
           END-IF.
      *
           MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                    TO LNK-SYU-KOH-COMPTOTAL(KOH-IDX).
      *
       23071-DAYINF-SANTEI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        ÆüÊÌ¼ýÇ¼»»Äê¡ÊÄ¹´ü¤Î»Ä³ÛÃÖ¤­´¹¤¨¡Ë
      ******************************************************************
       230711-ZANOKIKAE-HENSYU-SEC           SECTION.
      *
           IF   LNK-SYU-KOH-HKNNUM(2) = "972" OR "974"
             MOVE     2              TO  FLG-CYOKEIKBN-N
           END-IF
           IF   LNK-SYU-KOH-HKNNUM(3) = "972" OR "974"
             MOVE     3              TO  FLG-CYOKEIKBN-N
           END-IF
           IF   LNK-SYU-KOH-HKNNUM(4) = "972" OR "974"
             MOVE     4              TO  FLG-CYOKEIKBN-N
           END-IF
      *
           INITIALIZE                    WK-CYOKI-HKNTEN-TBL
           PERFORM  VARYING  IDX19  FROM  1  BY  1
                     UNTIL  (IDX19                             >  10  )
                      OR    (LNK-S02-DAYTEN-HKNCOMBINUM(IDX19) = SPACE)
             IF    LNK-S02-DAYTEN-SRYYM(IDX19) = LNK-SYU-SRYYMD(1:6)
      *        ÊÝ¸±ÁÈ¹ç¤»¥Þ¥¹¥¿¤Î¸¡º÷
               INITIALIZE                         WRK-HKNCOMBI-REC
               MOVE    LNK-SYU-HOSPNUM    TO      WRK-COMB-HOSPNUM
               MOVE    LNK-SYU-PTID       TO      WRK-COMB-PTID
               MOVE    LNK-S02-DAYTEN-HKNCOMBINUM(IDX19)
                                          TO      WRK-COMB-HKNCOMBINUM
               MOVE    WRK-HKNCOMBI-REC   TO      MCPDATA-REC
               MOVE    "DBSELECT"         TO      MCP-FUNC
               MOVE    "tbl_hkncombi"     TO      MCP-TABLE
               MOVE    "key"              TO      MCP-PATHNAME
               CALL    "ORCDBMAIN"        USING   MCPAREA
                                                  MCPDATA-REC
                                                  SPA-AREA
               IF      MCP-RC             =       ZERO
                 MOVE     "tbl_hkncombi"  TO      MCP-TABLE
                 MOVE     "key"           TO      MCP-PATHNAME
                 PERFORM   HKNCOMBI-READ2-SEC
               END-IF
               MOVE    "tbl_hkncombi"     TO      MCP-TABLE
               MOVE    "key"              TO      MCP-PATHNAME
               PERFORM  DB-CLOSE-SEC
      *
               EVALUATE   FLG-CYOKEIKBN-N
                 WHEN          2
                   IF ((LNK-SYU-KOH2HKNNUM  =  WRK-COMB-KOH1HKNNUM) AND
                       (COMB-KOH2ID         =  WRK-COMB-KOH1ID    ))
                   OR ((LNK-SYU-KOH2HKNNUM  =  WRK-COMB-KOH2HKNNUM) AND
                       (COMB-KOH2ID         =  WRK-COMB-KOH2ID    ))
                   OR ((LNK-SYU-KOH2HKNNUM  =  WRK-COMB-KOH3HKNNUM) AND
                       (COMB-KOH2ID         =  WRK-COMB-KOH3ID    ))
                   OR ((LNK-SYU-KOH2HKNNUM  =  WRK-COMB-KOH4HKNNUM) AND
                       (COMB-KOH2ID         =  WRK-COMB-KOH4ID    ))
                     PERFORM  VARYING  IDX21  FROM  1  BY  1
                               UNTIL   IDX21    >  31
                       ADD  LNK-S02-DAYTEN-HKNTEN(IDX19 IDX21)
                                           TO WK-CYOKI-HKNTEN(IDX21)
                     END-PERFORM
                     IF    LNK-S02-CYOKI-FLG(IDX19)  =  ZERO
                       MOVE  1             TO LNK-S02-CYOKI-FLG (IDX19)
                       MOVE ZAN-KOHI-T(2)  TO LNK-S02-CYOKI-ZAN1(IDX19)
                       MOVE ZAN-KOHI-T2(2) TO LNK-S02-CYOKI-ZAN2(IDX19)
                       MOVE ZAN-KOHI-T3(2) TO LNK-S02-CYOKI-ZAN3(IDX19)
                     END-IF
                   END-IF
                 WHEN          3
                   IF ((LNK-SYU-KOH3HKNNUM  =  WRK-COMB-KOH1HKNNUM) AND
                       (COMB-KOH3ID         =  WRK-COMB-KOH1ID    ))
                   OR ((LNK-SYU-KOH3HKNNUM  =  WRK-COMB-KOH2HKNNUM) AND
                       (COMB-KOH3ID         =  WRK-COMB-KOH2ID    ))
                   OR ((LNK-SYU-KOH3HKNNUM  =  WRK-COMB-KOH3HKNNUM) AND
                       (COMB-KOH3ID         =  WRK-COMB-KOH3ID    ))
                   OR ((LNK-SYU-KOH3HKNNUM  =  WRK-COMB-KOH4HKNNUM) AND
                       (COMB-KOH3ID         =  WRK-COMB-KOH4ID    ))
                     PERFORM  VARYING  IDX21  FROM  1  BY  1
                               UNTIL   IDX21    >  31
                       ADD  LNK-S02-DAYTEN-HKNTEN(IDX19 IDX21)
                                           TO WK-CYOKI-HKNTEN(IDX21)
                     END-PERFORM
                     IF    LNK-S02-CYOKI-FLG(IDX19)  =  ZERO
                       MOVE  1             TO LNK-S02-CYOKI-FLG (IDX19)
                       MOVE ZAN-KOHI-T(3)  TO LNK-S02-CYOKI-ZAN1(IDX19)
                       MOVE ZAN-KOHI-T2(3) TO LNK-S02-CYOKI-ZAN2(IDX19)
                       MOVE ZAN-KOHI-T3(3) TO LNK-S02-CYOKI-ZAN3(IDX19)
                     END-IF
                   END-IF
                 WHEN          4
                   IF ((LNK-SYU-KOH4HKNNUM  =  WRK-COMB-KOH1HKNNUM) AND
                       (COMB-KOH4ID         =  WRK-COMB-KOH1ID    ))
                   OR ((LNK-SYU-KOH4HKNNUM  =  WRK-COMB-KOH2HKNNUM) AND
                       (COMB-KOH4ID         =  WRK-COMB-KOH2ID    ))
                   OR ((LNK-SYU-KOH4HKNNUM  =  WRK-COMB-KOH3HKNNUM) AND
                       (COMB-KOH4ID         =  WRK-COMB-KOH3ID    ))
                   OR ((LNK-SYU-KOH4HKNNUM  =  WRK-COMB-KOH4HKNNUM) AND
                       (COMB-KOH4ID         =  WRK-COMB-KOH4ID    ))
                     PERFORM  VARYING  IDX21  FROM  1  BY  1
                               UNTIL   IDX21    >  31
                       ADD  LNK-S02-DAYTEN-HKNTEN(IDX19 IDX21)
                                           TO WK-CYOKI-HKNTEN(IDX21)
                     END-PERFORM
                     IF    LNK-S02-CYOKI-FLG(IDX19)  =  ZERO
                       MOVE  1             TO LNK-S02-CYOKI-FLG (IDX19)
                       MOVE ZAN-KOHI-T(4)  TO LNK-S02-CYOKI-ZAN1(IDX19)
                       MOVE ZAN-KOHI-T2(4) TO LNK-S02-CYOKI-ZAN2(IDX19)
                       MOVE ZAN-KOHI-T3(4) TO LNK-S02-CYOKI-ZAN3(IDX19)
                     END-IF
                   END-IF
               END-EVALUATE
             END-IF
           END-PERFORM
      *
      *    Á°Æü¤Þ¤Ç¤Î¥Þ¥ëÄ¹¤Î°ìÉôÉéÃ´¶â¤Î»Ä¤ò¥»¥Ã¥È
           MOVE  LNK-S02-CYOKI-ZAN1(IDX20) TO WK-CYOKI-HIKAKU1
                                              WK-CYOKI-HIKAKU1-TAIHI
           MOVE  LNK-S02-CYOKI-ZAN2(IDX20) TO WK-CYOKI-HIKAKU2
                                              WK-CYOKI-HIKAKU2-TAIHI
           MOVE  LNK-S02-CYOKI-ZAN3(IDX20) TO WK-CYOKI-HIKAKU3
                                              WK-CYOKI-HIKAKU3-TAIHI
      *
           .
      *
       230711-ZANOKIKAE-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÆüÊÌ¼ýÇ¼»»Äê¡ÊÄ¹´ü¤Î»Ä³ÛÃÖ¤­´¹¤¨¡Ë
      ******************************************************************
       230712-ZANOKIKAE-HENSYU2-SEC           SECTION.
      *
           IF    KOHI-TBL(IDX2 KOH-IDX)  =   9
      *      Æ±Æü¤Ë¡¢Æ±°ìÃÏÊý¸øÈñ´Þ¤à°ã¤¦ÊÝ¸±ÁÈ¹ç¤»¤ÇÆþÎÏ¤¬Í­¤ë¾ì¹ç¡¢
      *      Àè¤Ë·×»»¤·¤¿ÊÝ¸±ÁÈ¹ç¤»¤ÎÆ±°ìÃÏÊý¸øÈñ¤ÎÆü¤Î°ìÉôÉéÃ´¶â¤ò
      *      Á°Æü¤Þ¤Ç¤Î¥Þ¥ëÄ¹¤Î°ìÉôÉéÃ´¶â¤Î»Ä¤«¤éº¹¤·°ú¤¯
             EVALUATE   KOH-IDX
               WHEN        1
                 IF  WK-CYOKI-HIKAKU1  >  FTN-KOHI1-D(IDX2)
                   COMPUTE  WK-CYOKI-HIKAKU1  =  WK-CYOKI-HIKAKU1
                                              -  FTN-KOHI1-D(IDX2)
                 ELSE
                   MOVE   ZERO   TO   WK-CYOKI-HIKAKU1
                 END-IF
                 IF  WK-CYOKI-HIKAKU2  >  FTN-KOHI1-D2(IDX2)
                   COMPUTE  WK-CYOKI-HIKAKU2  =  WK-CYOKI-HIKAKU2
                                              -  FTN-KOHI1-D2(IDX2)
                 ELSE
                   MOVE   ZERO   TO   WK-CYOKI-HIKAKU2
                 END-IF
                 IF  WK-CYOKI-HIKAKU3  >  FTN-KOHI1-D3(IDX2)
                   COMPUTE  WK-CYOKI-HIKAKU3  =  WK-CYOKI-HIKAKU3
                                              -  FTN-KOHI1-D3(IDX2)
                 ELSE
                   MOVE   ZERO   TO   WK-CYOKI-HIKAKU3
                 END-IF
               WHEN        2
                 IF  WK-CYOKI-HIKAKU1  >  FTN-KOHI2-D(IDX2)
                   COMPUTE  WK-CYOKI-HIKAKU1  =  WK-CYOKI-HIKAKU1
                                              -  FTN-KOHI2-D(IDX2)
                 ELSE
                   MOVE   ZERO   TO   WK-CYOKI-HIKAKU1
                 END-IF
                 IF  WK-CYOKI-HIKAKU2  >  FTN-KOHI2-D2(IDX2)
                   COMPUTE  WK-CYOKI-HIKAKU2  =  WK-CYOKI-HIKAKU2
                                              -  FTN-KOHI2-D2(IDX2)
                 ELSE
                   MOVE   ZERO   TO   WK-CYOKI-HIKAKU2
                 END-IF
                 IF  WK-CYOKI-HIKAKU3  >  FTN-KOHI2-D3(IDX2)
                   COMPUTE  WK-CYOKI-HIKAKU3  =  WK-CYOKI-HIKAKU3
                                              -  FTN-KOHI2-D3(IDX2)
                 ELSE
                   MOVE   ZERO   TO   WK-CYOKI-HIKAKU3
                 END-IF
               WHEN        3
                 IF  WK-CYOKI-HIKAKU1  >  FTN-KOHI3-D(IDX2)
                   COMPUTE  WK-CYOKI-HIKAKU1  =  WK-CYOKI-HIKAKU1
                                              -  FTN-KOHI3-D(IDX2)
                 ELSE
                   MOVE   ZERO   TO   WK-CYOKI-HIKAKU1
                 END-IF
                 IF  WK-CYOKI-HIKAKU2  >  FTN-KOHI3-D2(IDX2)
                   COMPUTE  WK-CYOKI-HIKAKU2  =  WK-CYOKI-HIKAKU2
                                              -  FTN-KOHI3-D2(IDX2)
                 ELSE
                   MOVE   ZERO   TO   WK-CYOKI-HIKAKU2
                 END-IF
                 IF  WK-CYOKI-HIKAKU3  >  FTN-KOHI3-D3(IDX2)
                   COMPUTE  WK-CYOKI-HIKAKU3  =  WK-CYOKI-HIKAKU3
                                              -  FTN-KOHI3-D3(IDX2)
                 ELSE
                   MOVE   ZERO   TO   WK-CYOKI-HIKAKU3
                 END-IF
             END-EVALUATE
      *
      *      Á°Æü¤Þ¤Ç¤Î¥Þ¥ëÄ¹¤Î°ìÉôÉéÃ´¶â¤Î»Ä¤ÈÃÏÊý¸øÈñ¤ÎÆü¤Î»Ä¤òÈæ³Ó
             IF   WK-CYOKI-HIKAKU1  <  ZAN-KOHI-D(IDX2 KOH-IDX)
               MOVE  WK-CYOKI-HIKAKU1  TO  ZAN-KOHI-D(IDX2 KOH-IDX)
             END-IF
             IF   WK-CYOKI-HIKAKU2  <  ZAN-KOHI-D2(IDX2 KOH-IDX)
               MOVE  WK-CYOKI-HIKAKU2  TO  ZAN-KOHI-D2(IDX2 KOH-IDX)
             END-IF
             IF   WK-CYOKI-HIKAKU3  <  ZAN-KOHI-D3(IDX2 KOH-IDX)
               MOVE  WK-CYOKI-HIKAKU3  TO  ZAN-KOHI-D3(IDX2 KOH-IDX)
             END-IF
           END-IF
      *
      *    ³ºÅöÆü¤Î¥Þ¥ëÄ¹¤Î°ìÉôÉéÃ´¶â¤ò·×»»
           IF   FLG-ZENKI-TOKUREI  =  1
             IF   ( WK-1001-PREFNUM      =  27      )
             OR   ((LNK-SYU-SRYYMD(1:6) >= "201508") AND
                   (WK-1001-PREFNUM      =  12     ))
               MOVE   10                   TO   WK-CYOKI-NYUKFTNRATE
             ELSE
               MOVE   20                   TO   WK-CYOKI-NYUKFTNRATE
             END-IF
           ELSE
               MOVE   WK-DAY-NYUKFTNRATE   TO   WK-CYOKI-NYUKFTNRATE
           END-IF
           COMPUTE  WK-CYOKI-KEISAN   =  WK-CYOKI-HKNTEN(IDX2)
                                      *  10
                                      *  WK-CYOKI-NYUKFTNRATE
                                      /  100
           COMPUTE  WK-CYOKI-KEISAN   =  WK-CYOKI-KEISAN   +   5
           COMPUTE  WK-CYOKI-KEISAN   =  WK-CYOKI-KEISAN   /  10
           COMPUTE  WK-CYOKI-KEISAN   =  WK-CYOKI-KEISAN   *  10
      *
           COMPUTE  WK-CYOKI-KEISAN2  =  WK-CYOKI-HKNTEN(IDX2)
                                      *  10
                                      *  WK-CYOKI-NYUKFTNRATE
                                      /  100
           COMPUTE  WK-CYOKI-KEISAN2  =  WK-CYOKI-KEISAN2  +   5
           COMPUTE  WK-CYOKI-KEISAN2  =  WK-CYOKI-KEISAN2  /  10
           COMPUTE  WK-CYOKI-KEISAN2  =  WK-CYOKI-KEISAN2  *  10
      *
           COMPUTE  WK-CYOKI-KEISAN3  =  WK-CYOKI-HKNTEN(IDX2)
                                      *  10
                                      *  WK-CYOKI-NYUKFTNRATE
                                      /  100
      *
      *    ³ºÅöÆü¤Î¥Þ¥ëÄ¹¤Î°ìÉôÉéÃ´¶â¤ò
      *    Á°Æü¤Þ¤Ç¤Î¥Þ¥ëÄ¹¤Î°ìÉôÉéÃ´¶â¤Î»Ä¤«¤éº¹¤·°ú¤¯
           IF   WK-CYOKI-HIKAKU1-TAIHI  >  WK-CYOKI-KEISAN
               COMPUTE  WK-CYOKI-HIKAKU1-TAIHI  =
                        WK-CYOKI-HIKAKU1-TAIHI  -
                        WK-CYOKI-KEISAN
           ELSE
               MOVE   ZERO    TO    WK-CYOKI-HIKAKU1-TAIHI
           END-IF
           MOVE   WK-CYOKI-HIKAKU1-TAIHI  TO  WK-CYOKI-HIKAKU1
      *
           IF   WK-CYOKI-HIKAKU2-TAIHI  >  WK-CYOKI-KEISAN2
               COMPUTE  WK-CYOKI-HIKAKU2-TAIHI  =
                        WK-CYOKI-HIKAKU2-TAIHI  -
                        WK-CYOKI-KEISAN2
           ELSE
               MOVE   ZERO    TO    WK-CYOKI-HIKAKU2-TAIHI
           END-IF
           MOVE   WK-CYOKI-HIKAKU2-TAIHI  TO  WK-CYOKI-HIKAKU2
      *
           IF   WK-CYOKI-HIKAKU3-TAIHI  >  WK-CYOKI-KEISAN3
               COMPUTE  WK-CYOKI-HIKAKU3-TAIHI  =
                        WK-CYOKI-HIKAKU3-TAIHI  -
                        WK-CYOKI-KEISAN3
           ELSE
               MOVE   ZERO    TO    WK-CYOKI-HIKAKU3-TAIHI
           END-IF
           MOVE   WK-CYOKI-HIKAKU3-TAIHI  TO  WK-CYOKI-HIKAKU3
      *
           .
      *
       230712-ZANOKIKAE-HENSYU2-EXT.
           EXIT.
      *
      ******************************************************************
      *        Ã»´üÂÚºß¥·¥¹¥Æ¥àÍ½ÌóÆþÎÏ¥Á¥§¥Ã¥¯
      ******************************************************************
       230713-TANKITAIZAI-CHECK-SEC           SECTION.
      *
      ***  IF  (WK-1001-PREFNUM       =   34                 )
      ***  AND (WK-HBTNUM(KOH-IDX)    =  "90" OR "91" OR "92")
      ***  AND (LNK-SYU-SRYYMD(1:6)  >=  "201504"            )
      *
             INITIALIZE                        SRYACT-REC
             MOVE    LNK-SYU-HOSPNUM       TO  SRY-HOSPNUM
             MOVE    LNK-SYU-NYUGAIKBN     TO  SRY-NYUGAIKBN
             MOVE    LNK-SYU-PTID          TO  SRY-PTID
             MOVE    LNK-SYU-SRYYMD(1:6)   TO  SRY-SRYYM
             MOVE    "099409908"           TO  SRY-SRYCD (1)
             MOVE    "099409908"           TO  SRY-SRYCD (2)
             MOVE    "099409908"           TO  SRY-SRYCD (3)
             MOVE    "099409908"           TO  SRY-SRYCD (4)
             MOVE    "099409908"           TO  SRY-SRYCD (5)
             MOVE    SRYACT-REC            TO  MCPDATA-REC
             MOVE    "DBSELECT"            TO  MCP-FUNC
             MOVE    "tbl_sryact"          TO  MCP-TABLE
             MOVE    "key7"                TO  MCP-PATHNAME
             CALL    "ORCDBMAIN"        USING  MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
             IF       MCP-RC               =   ZERO
               MOVE    "tbl_sryact"        TO  MCP-TABLE
               MOVE    "key7"              TO  MCP-PATHNAME
               PERFORM  SRYACT-READ-SEC
               PERFORM  UNTIL  FLG-SRYACT  =  1
                 INITIALIZE                    SRYACCT-REC
                 MOVE    SRY-HOSPNUM       TO  ACCT-HOSPNUM
                 MOVE    SRY-NYUGAIKBN     TO  ACCT-NYUGAIKBN
                 MOVE    SRY-PTID          TO  ACCT-PTID
                 MOVE    SRY-SRYKA         TO  ACCT-SRYKA
                 MOVE    SRY-SRYYM         TO  ACCT-SRYYM
                 MOVE    SRY-ZAINUM        TO  ACCT-ZAINUM
                 MOVE    SRYACCT-REC       TO  MCPDATA-REC
                 MOVE    "DBSELECT"        TO  MCP-FUNC
                 MOVE    "tbl_sryacct"     TO  MCP-TABLE
                 MOVE    "key31"           TO  MCP-PATHNAME
                 CALL    "ORCDBMAIN"    USING  MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
                 IF       MCP-RC           =   ZERO
                   MOVE     "tbl_sryacct"  TO  MCP-TABLE
                   MOVE     "key31"        TO  MCP-PATHNAME
                   PERFORM   SRYACCT-READ-SEC
                   PERFORM   UNTIL  FLG-SRYACCT  =  1
                     IF   COMB-HKNCOMBINUM  =  ACCT-HKNCOMBI
                       PERFORM  VARYING  IDX22  FROM  1  BY  1
                                 UNTIL   IDX22   >   31
                         IF  (ACCT-DAY(1 IDX22)             NOT = ZERO)
      ***                AND (LNK-S02-NYUINDAY-TANKI-KBN(IDX22) = "1" )
      ***                AND (LNK-SYU-DAY(IDX22)                = "1" )
                           ADD   ACCT-DAY(1 IDX22)
                                           TO  WK-TANKI-CYOSYU(IDX22)
                         END-IF
                       END-PERFORM
                     END-IF
                     MOVE        1         TO  FLG-SRYACCT
                   END-PERFORM
                 END-IF
                 MOVE    "tbl_sryacct"     TO  MCP-TABLE
                 MOVE    "key31"           TO  MCP-PATHNAME
                 PERFORM  DB-CLOSE-SEC
      *
                 MOVE    "tbl_sryact"      TO  MCP-TABLE
                 MOVE    "key7"            TO  MCP-PATHNAME
                 PERFORM  SRYACT-READ-SEC
               END-PERFORM
             END-IF
             MOVE        "tbl_sryact"      TO  MCP-TABLE
             MOVE        "key7"            TO  MCP-PATHNAME
             PERFORM      DB-CLOSE-SEC
      *
             INITIALIZE                        SRYACT-REC
             MOVE    LNK-SYU-HOSPNUM       TO  SRY-HOSPNUM
             MOVE    LNK-SYU-NYUGAIKBN     TO  SRY-NYUGAIKBN
             MOVE    LNK-SYU-PTID          TO  SRY-PTID
             MOVE    LNK-SYU-SRYYMD(1:6)   TO  SRY-SRYYM
             MOVE    "099409909"           TO  SRY-SRYCD (1)
             MOVE    "099409909"           TO  SRY-SRYCD (2)
             MOVE    "099409909"           TO  SRY-SRYCD (3)
             MOVE    "099409909"           TO  SRY-SRYCD (4)
             MOVE    "099409909"           TO  SRY-SRYCD (5)
             MOVE    SRYACT-REC            TO  MCPDATA-REC
             MOVE    "DBSELECT"            TO  MCP-FUNC
             MOVE    "tbl_sryact"          TO  MCP-TABLE
             MOVE    "key7"                TO  MCP-PATHNAME
             CALL    "ORCDBMAIN"        USING  MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
             IF       MCP-RC               =   ZERO
               MOVE    "tbl_sryact"        TO  MCP-TABLE
               MOVE    "key7"              TO  MCP-PATHNAME
               PERFORM  SRYACT-READ-SEC
               PERFORM  UNTIL  FLG-SRYACT  =  1
                 INITIALIZE                    SRYACCT-REC
                 MOVE    SRY-HOSPNUM       TO  ACCT-HOSPNUM
                 MOVE    SRY-NYUGAIKBN     TO  ACCT-NYUGAIKBN
                 MOVE    SRY-PTID          TO  ACCT-PTID
                 MOVE    SRY-SRYKA         TO  ACCT-SRYKA
                 MOVE    SRY-SRYYM         TO  ACCT-SRYYM
                 MOVE    SRY-ZAINUM        TO  ACCT-ZAINUM
                 MOVE    SRYACCT-REC       TO  MCPDATA-REC
                 MOVE    "DBSELECT"        TO  MCP-FUNC
                 MOVE    "tbl_sryacct"     TO  MCP-TABLE
                 MOVE    "key31"           TO  MCP-PATHNAME
                 CALL    "ORCDBMAIN"    USING  MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
                 IF       MCP-RC           =   ZERO
                   MOVE     "tbl_sryacct"  TO  MCP-TABLE
                   MOVE     "key31"        TO  MCP-PATHNAME
                   PERFORM   SRYACCT-READ-SEC
                   PERFORM   UNTIL  FLG-SRYACCT  =  1
                     IF   COMB-HKNCOMBINUM  =  ACCT-HKNCOMBI
                       PERFORM  VARYING  IDX22  FROM  1  BY  1
                                 UNTIL   IDX22   >   31
                         IF  (ACCT-DAY(1 IDX22)             NOT = ZERO)
      ***                AND (LNK-S02-NYUINDAY-TANKI-KBN(IDX22) = "1" )
                           MOVE     1      TO  WK-TANKI-MICYOSYU(IDX22)
                         END-IF
                       END-PERFORM
                     END-IF
                     MOVE        1         TO  FLG-SRYACCT
                   END-PERFORM
                 END-IF
                 MOVE    "tbl_sryacct"     TO  MCP-TABLE
                 MOVE    "key31"           TO  MCP-PATHNAME
                 PERFORM  DB-CLOSE-SEC
      *
                 MOVE    "tbl_sryact"      TO  MCP-TABLE
                 MOVE    "key7"            TO  MCP-PATHNAME
                 PERFORM  SRYACT-READ-SEC
               END-PERFORM
             END-IF
             MOVE        "tbl_sryact"      TO  MCP-TABLE
             MOVE        "key7"            TO  MCP-PATHNAME
             PERFORM      DB-CLOSE-SEC
      *
      ***  END-IF
      *
           .
      *
       230713-TANKITAIZAI-CHECK-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñÃ±°Ì¤Ç·×»»¤·¤¿´µ¼ÔÉéÃ´¶â¤òÈæ³Ó
      ******************************************************************
       23072-KOHHI-HIKAKU-SEC           SECTION.
      *
           IF   ( LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974" )
           OR   ((KOH-IDX         =   2) AND
                 (WK-RUI-TAISYO   =   1)                        )
             IF  (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974")
             AND (LNK-SYU-SRYYMD(1:6)         <  "200804"      )
             AND (LNK-SYU-KOH-HKNNUM(1)       =  "027"         )
               IF  LNK-SYU-KOH-COMPFTN(1) < LNK-SYU-KOH-COMPFTN(KOH-IDX)
                   MOVE  LNK-SYU-KOH-COMPFTN(1)
                                        TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               END-IF
             END-IF
           ELSE
             EVALUATE    KOH-IDX
               WHEN    2
                   IF   (FLG-ICHIBU-JYOSEI       =   1   )
                   AND  (LNK-SYU-KOH1HKNNUM  NOT =  SPACE)
                     IF  LNK-SYU-KOH-COMPFTN(1)
                                   >     LNK-SYU-KOH-COMPFTN(2)
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 LNK-SYU-KOH-COMPFTN(1)  +  5
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 WK-KEISAN-JYOSEI        / 10
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 WK-KEISAN-JYOSEI        * 10
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 LNK-SYU-KOH-COMPFTN(2)  +  5
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 WK-KEISAN-JYOSEI2       / 10
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 WK-KEISAN-JYOSEI2       * 10
                       COMPUTE   WK-KEISAN-JYOSEI3       =
                                 WK-KEISAN-JYOSEI        -
                                 WK-KEISAN-JYOSEI2
                       IF WK-KEISAN-JYOSEI3 < LNK-SYU-JYO-COMPFTN
                         MOVE  WK-KEISAN-JYOSEI3
                                   TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                     END-IF
                   END-IF
                   IF  LNK-SYU-KOH-COMPFTN(1) < LNK-SYU-KOH-COMPFTN(2)
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  LNK-SYU-KOH-COMPFTN(2)
                       IF   (FLG-KOUGAKUCYO-TOYAMA  =  1       )
                       AND  (FLG-IRYOHI-TOYAMA      =  21 OR 22)
                         MOVE    ZERO       TO  FLG-KOUGAKUCYO-TOYAMA
                       END-IF
                   END-IF
               WHEN    3
                   IF   (FLG-ICHIBU-JYOSEI       =   1   )
                   AND  (LNK-SYU-KOH2HKNNUM  NOT =  SPACE)
                     IF  LNK-SYU-KOH-COMPFTN(2)
                                   >     LNK-SYU-KOH-COMPFTN(3)
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 LNK-SYU-KOH-COMPFTN(2)  +  5
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 WK-KEISAN-JYOSEI        / 10
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 WK-KEISAN-JYOSEI        * 10
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 LNK-SYU-KOH-COMPFTN(3)  +  5
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 WK-KEISAN-JYOSEI2       / 10
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 WK-KEISAN-JYOSEI2       * 10
                       COMPUTE   WK-KEISAN-JYOSEI3       =
                                 WK-KEISAN-JYOSEI        -
                                 WK-KEISAN-JYOSEI2
                       IF WK-KEISAN-JYOSEI3 < LNK-SYU-JYO-COMPFTN
                         MOVE  WK-KEISAN-JYOSEI3
                                   TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                     END-IF
                   END-IF
                   IF  LNK-SYU-KOH-COMPFTN(2) < LNK-SYU-KOH-COMPFTN(3)
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  LNK-SYU-KOH-COMPFTN(3)
                   END-IF
               WHEN    4
                   IF   (FLG-ICHIBU-JYOSEI       =   1   )
                   AND  (LNK-SYU-KOH3HKNNUM  NOT =  SPACE)
                     IF  LNK-SYU-KOH-COMPFTN(3)
                                   >     LNK-SYU-KOH-COMPFTN(4)
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 LNK-SYU-KOH-COMPFTN(3)  +  5
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 WK-KEISAN-JYOSEI        / 10
                       COMPUTE   WK-KEISAN-JYOSEI        =
                                 WK-KEISAN-JYOSEI        * 10
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 LNK-SYU-KOH-COMPFTN(4)  +  5
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 WK-KEISAN-JYOSEI2       / 10
                       COMPUTE   WK-KEISAN-JYOSEI2       =
                                 WK-KEISAN-JYOSEI2       * 10
                       COMPUTE   WK-KEISAN-JYOSEI3       =
                                 WK-KEISAN-JYOSEI        -
                                 WK-KEISAN-JYOSEI2
                       IF WK-KEISAN-JYOSEI3 < LNK-SYU-JYO-COMPFTN
                         MOVE  WK-KEISAN-JYOSEI3
                                   TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-HKNFTNMONEY
                                       LNK-SYU-JYO-COMPFTN
                     END-IF
                   END-IF
                   IF  LNK-SYU-KOH-COMPFTN(3) < LNK-SYU-KOH-COMPFTN(4)
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  LNK-SYU-KOH-COMPFTN(4)
                   END-IF
             END-EVALUATE
           END-IF.
      *
           IF    WK-SYOFUKUMU-FLG(KOH-IDX)      NOT =  ZERO
           AND   WK-SYOFUKUMU-GENDOGAK(KOH-IDX) NOT =  9999999
             IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)  >
                                     WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                 MOVE  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
             END-IF
           END-IF.
      *
       23072-KOHHI-HIKAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñÃ±°Ì¤Ç·×»»¤·¤¿´µ¼ÔÉéÃ´¶â¤òÈæ³Ó
      *        ¡Ê¥ì¥»µ­ºÜ¶â³ÛÂàÈòÍÑ¥¨¥ê¥¢ÍÑ¡Ë
      ******************************************************************
       23073-KOHHI-HIKAKU2-SEC           SECTION.                             
      *
           IF   ( LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974" )
           OR   ((KOH-IDX         =   2) AND
                 (WK-RUI-TAISYO   =   1)                        )
             IF  (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974")
             AND (LNK-SYU-SRYYMD(1:6)         <  "200804"      )
             AND (LNK-SYU-KOH-HKNNUM(1)       =  "027"         )
               IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                 IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-KOH-COMPFTN(KOH-IDX)
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 ELSE
                   IF  WK-KOH-COMPFTN(1)      < WK-KOH-COMPFTN(KOH-IDX)
                       MOVE  WK-KOH-COMPFTN(1)
                                            TO  WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                 END-IF
               ELSE
                 IF  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                              < WK-KOH-COMPFTN(KOH-IDX)
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                            TO  WK-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
             END-IF
           ELSE
             EVALUATE    KOH-IDX
               WHEN    2
                 IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                   IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                     IF  LNK-SYU-KOH-COMPFTN(1) < WK-KOH-COMPFTN(2)
                     AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                         MOVE  LNK-SYU-KOH-COMPFTN(1)
                                              TO  WK-KOH-COMPFTN(2)
                     END-IF
                   ELSE
                     IF  WK-KOH-COMPFTN(1)      < WK-KOH-COMPFTN(2)
                     AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                         MOVE  WK-KOH-COMPFTN(1)
                                              TO  WK-KOH-COMPFTN(2)
                     END-IF
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                < WK-KOH-COMPFTN(2)
                   AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                         MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                              TO  WK-KOH-COMPFTN(2)
                   END-IF
                 END-IF
               WHEN    3
                 IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                   IF  WK-KOH-COMPFTN(2)  =  ALL"9"
                     IF  LNK-SYU-KOH-COMPFTN(2) < WK-KOH-COMPFTN(3)
                         MOVE  LNK-SYU-KOH-COMPFTN(2)
                                              TO  WK-KOH-COMPFTN(3)
                     END-IF
                   ELSE
                     IF  WK-KOH-COMPFTN(2)      < WK-KOH-COMPFTN(3)
                         MOVE  WK-KOH-COMPFTN(2)
                                              TO  WK-KOH-COMPFTN(3)
                     END-IF
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                                < WK-KOH-COMPFTN(3)
                         MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                              TO  WK-KOH-COMPFTN(3)
                   END-IF
                 END-IF
               WHEN    4
                 IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                   IF  WK-KOH-COMPFTN(3)  =  ALL"9"
                     IF  LNK-SYU-KOH-COMPFTN(3) < WK-KOH-COMPFTN(4)
                         MOVE  LNK-SYU-KOH-COMPFTN(3)
                                              TO  WK-KOH-COMPFTN(4)
                     END-IF
                   ELSE
                     IF  WK-KOH-COMPFTN(3)      < WK-KOH-COMPFTN(4)
                         MOVE  WK-KOH-COMPFTN(3)
                                              TO  WK-KOH-COMPFTN(4)
                     END-IF
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                                < WK-KOH-COMPFTN(4)
                         MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                              TO  WK-KOH-COMPFTN(4)
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF.
      *
           IF    WK-SYOFUKUMU-FLG(KOH-IDX)      NOT =  ZERO
           AND   WK-SYOFUKUMU-GENDOGAK(KOH-IDX) NOT =  9999999
             IF  WK-KOH-COMPFTN(KOH-IDX)       >
                                     WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                 MOVE  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                 TO  WK-KOH-COMPFTN(KOH-IDX)
             END-IF
           END-IF.
      *
       23073-KOHHI-HIKAKU2-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        ¸øÈñÃ±°Ì¤Ç·×»»¤·¤¿´µ¼ÔÉéÃ´¶â¤òÈæ³Ó
      *        ¡Ê¥ì¥»µ­ºÜ¶â³ÛÂàÈòÍÑ¥¨¥ê¥¢ÍÑ¡Ë¡ÊÆüÃ±°Ì¡Ë
      ******************************************************************
       23074-KOHHI-HIKAKU3-SEC           SECTION.
      *
           IF   (KOH-IDX        =  2)
           AND  (WK-RUI-TAISYO  =  1)
             CONTINUE
           ELSE
             EVALUATE    KOH-IDX
               WHEN    2
                 IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                   IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                    IF  WK-DAY-KOH-COMPFTN(1)  =  ALL"9"
                      IF  LNK-SYU-KOH-COMPFTN(1) < WK-DAY-KOH-COMPFTN(2)
                      AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                          MOVE  LNK-SYU-KOH-COMPFTN(1)
                                               TO  WK-DAY-KOH-COMPFTN(2)
                      END-IF
                    ELSE
                      IF  WK-DAY-KOH-COMPFTN(1)  < WK-DAY-KOH-COMPFTN(2)
                      AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                          MOVE  WK-DAY-KOH-COMPFTN(1)
                                               TO  WK-DAY-KOH-COMPFTN(2)
                      END-IF
                    END-IF
                   ELSE
                    IF  WK-DAY-KOH-COMPFTN(1)  =  ALL"9"
                      IF  WK-KOH-COMPFTN(1)      < WK-DAY-KOH-COMPFTN(2)
                      AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                          MOVE  WK-KOH-COMPFTN(1)
                                               TO  WK-DAY-KOH-COMPFTN(2)
                      END-IF
                    ELSE
                      IF  WK-DAY-KOH-COMPFTN(1)  < WK-DAY-KOH-COMPFTN(2)
                      AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                          MOVE  WK-DAY-KOH-COMPFTN(1)
                                               TO  WK-DAY-KOH-COMPFTN(2)
                      END-IF
                    END-IF
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                 < WK-DAY-KOH-COMPFTN(2)
                   AND LNK-SYU-KOH1HKNNUM      NOT =  SPACE
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                               TO  WK-DAY-KOH-COMPFTN(2)
                   END-IF
                 END-IF
               WHEN    3
                 IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                   IF  WK-KOH-COMPFTN(2)  =  ALL"9"
                    IF  WK-DAY-KOH-COMPFTN(2)  =  ALL"9"
                      IF  LNK-SYU-KOH-COMPFTN(2) < WK-DAY-KOH-COMPFTN(3)
                      AND LNK-SYU-KOH2HKNNUM   NOT =  SPACE
                          MOVE  LNK-SYU-KOH-COMPFTN(2)
                                               TO  WK-DAY-KOH-COMPFTN(3)
                      END-IF
                    ELSE
                      IF  WK-DAY-KOH-COMPFTN(2)  < WK-DAY-KOH-COMPFTN(3)
                      AND LNK-SYU-KOH2HKNNUM   NOT =  SPACE
                          MOVE  WK-DAY-KOH-COMPFTN(2)
                                               TO  WK-DAY-KOH-COMPFTN(3)
                      END-IF
                    END-IF
                   ELSE
                    IF  WK-DAY-KOH-COMPFTN(2)  =  ALL"9"
                      IF  WK-KOH-COMPFTN(2)      < WK-DAY-KOH-COMPFTN(3)
                      AND LNK-SYU-KOH2HKNNUM   NOT =  SPACE
                          MOVE  WK-KOH-COMPFTN(2)
                                               TO  WK-DAY-KOH-COMPFTN(3)
                      END-IF
                    ELSE
                      IF  WK-DAY-KOH-COMPFTN(2)  < WK-DAY-KOH-COMPFTN(3)
                      AND LNK-SYU-KOH2HKNNUM   NOT =  SPACE
                          MOVE  WK-DAY-KOH-COMPFTN(2)
                                               TO  WK-DAY-KOH-COMPFTN(3)
                      END-IF
                    END-IF
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                                 < WK-DAY-KOH-COMPFTN(3)
                   AND LNK-SYU-KOH2HKNNUM      NOT =  SPACE
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                               TO  WK-DAY-KOH-COMPFTN(3)
                   END-IF
                 END-IF
               WHEN    4
                 IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                   IF  WK-KOH-COMPFTN(3)  =  ALL"9"
                    IF  WK-DAY-KOH-COMPFTN(3)  =  ALL"9"
                      IF  LNK-SYU-KOH-COMPFTN(3) < WK-DAY-KOH-COMPFTN(4)
                      AND LNK-SYU-KOH3HKNNUM   NOT =  SPACE
                          MOVE  LNK-SYU-KOH-COMPFTN(3)
                                               TO  WK-DAY-KOH-COMPFTN(4)
                      END-IF
                    ELSE
                      IF  WK-DAY-KOH-COMPFTN(3)  < WK-DAY-KOH-COMPFTN(4)
                      AND LNK-SYU-KOH3HKNNUM   NOT =  SPACE
                          MOVE  WK-DAY-KOH-COMPFTN(3)
                                               TO  WK-DAY-KOH-COMPFTN(4)
                      END-IF
                    END-IF
                   ELSE
                    IF  WK-DAY-KOH-COMPFTN(3)  =  ALL"9"
                      IF  WK-KOH-COMPFTN(3)      < WK-DAY-KOH-COMPFTN(4)
                      AND LNK-SYU-KOH3HKNNUM   NOT =  SPACE
                          MOVE  WK-KOH-COMPFTN(3)
                                               TO  WK-DAY-KOH-COMPFTN(4)
                      END-IF
                    ELSE
                      IF  WK-DAY-KOH-COMPFTN(3)  < WK-DAY-KOH-COMPFTN(4)
                      AND LNK-SYU-KOH3HKNNUM   NOT =  SPACE
                          MOVE  WK-DAY-KOH-COMPFTN(3)
                                               TO  WK-DAY-KOH-COMPFTN(4)
                      END-IF
                    END-IF
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                                 < WK-DAY-KOH-COMPFTN(4)
                   AND LNK-SYU-KOH3HKNNUM      NOT =  SPACE
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                               TO  WK-DAY-KOH-COMPFTN(4)
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF.
      *
       23074-KOHHI-HIKAKU3-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        ¸øÈñÃ±°Ì¤Ç·×»»¤·¤¿´µ¼ÔÉéÃ´¶â¤òÈæ³Ó
      *        ¡Ê±ßÃ±°Ì¡Ë
      ******************************************************************
       23075-KOHHI-HIKAKU4-SEC           SECTION.                             
      *
           IF   ( LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974" )
           OR   ((KOH-IDX         =   2) AND
                 (WK-RUI-TAISYO   =   1)                        )
             IF  (LNK-SYU-KOH-HKNNUM(KOH-IDX) =  "972" OR "974")
             AND (LNK-SYU-SRYYMD(1:6)         <  "200804"      )
             AND (LNK-SYU-KOH-HKNNUM(1)       =  "027"         )
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                               <     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               END-IF
             END-IF
           ELSE
             EVALUATE    KOH-IDX
               WHEN    2
                   IF   (FLG-ICHIBU-JYOSEI       =   1   )
                   AND  (LNK-SYU-KOH1HKNNUM  NOT =  SPACE)
                     IF  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                   >     LNK-SYU-KOH-COMPFTN-ENTANI(2)
                       COMPUTE  WK-KEISAN-JYOSEI-EN =
                                LNK-SYU-KOH-COMPFTN-ENTANI(1) -
                                LNK-SYU-KOH-COMPFTN-ENTANI(2)
                       IF WK-KEISAN-JYOSEI-EN
                                       < LNK-SYU-JYO-COMPFTN-ENTANI
                         MOVE  WK-KEISAN-JYOSEI-EN
                                   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                     END-IF
                   END-IF
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                   <     LNK-SYU-KOH-COMPFTN-ENTANI(2)
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                   END-IF
               WHEN    3
                   IF   (FLG-ICHIBU-JYOSEI       =   1   )
                   AND  (LNK-SYU-KOH2HKNNUM  NOT =  SPACE)
                     IF  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                   >     LNK-SYU-KOH-COMPFTN-ENTANI(3)
                       COMPUTE  WK-KEISAN-JYOSEI-EN =
                                LNK-SYU-KOH-COMPFTN-ENTANI(2) -
                                LNK-SYU-KOH-COMPFTN-ENTANI(3)
                       IF WK-KEISAN-JYOSEI-EN
                                       < LNK-SYU-JYO-COMPFTN-ENTANI
                         MOVE  WK-KEISAN-JYOSEI-EN
                                   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                     END-IF
                   END-IF
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                   <     LNK-SYU-KOH-COMPFTN-ENTANI(3)
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                   END-IF
               WHEN    4
                   IF   (FLG-ICHIBU-JYOSEI       =   1   )
                   AND  (LNK-SYU-KOH3HKNNUM  NOT =  SPACE)
                     IF  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                   >     LNK-SYU-KOH-COMPFTN-ENTANI(4)
                       COMPUTE  WK-KEISAN-JYOSEI-EN =
                                LNK-SYU-KOH-COMPFTN-ENTANI(3) -
                                LNK-SYU-KOH-COMPFTN-ENTANI(4)
                       IF WK-KEISAN-JYOSEI-EN
                                       < LNK-SYU-JYO-COMPFTN-ENTANI
                         MOVE  WK-KEISAN-JYOSEI-EN
                                   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                       END-IF
                     ELSE
                       MOVE  ZERO  TO  LNK-SYU-JYO-COMPFTN-ENTANI
                     END-IF
                   END-IF
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                   <     LNK-SYU-KOH-COMPFTN-ENTANI(4)
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                   END-IF
             END-EVALUATE
           END-IF.
      *
           IF    WK-SYOFUKUMU-FLG(KOH-IDX)      NOT =  ZERO
           AND   WK-SYOFUKUMU-GENDOGAK(KOH-IDX) NOT =  9999999
             IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  >
                                     WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                 MOVE  WK-SYOFUKUMU-GENDOGAK(KOH-IDX)
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
           END-IF.
      *
       23075-KOHHI-HIKAKU4-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        ÆÃ¼ì·×»»¡Ê¸ÂÅÙ¤òÄ¶¤¨¤¿¾ì¹ç¡¢´µ¼ÔÉéÃ´È¯À¸¡ÊÁ´³Û¡Ë¡Ë
      ******************************************************************
       23076-TOKUSYU-SANTEI-SEC           SECTION.
      *
           MOVE       ZERO         TO   FLG-IRYOKEIKBN
      *
           IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
             IF  (FLG-KOUGAKUCYO3      =     1)
             OR  (FLG-KOUGAKUCYO-GEN70 =     1)
               MOVE  LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU
             ELSE
               COMPUTE WK-TOKUSYU = LNK-SYU-SYUCOMPFTN +  5
               COMPUTE WK-TOKUSYU = WK-TOKUSYU         / 10
               COMPUTE WK-TOKUSYU = WK-TOKUSYU         * 10
             END-IF
      *
             IF  ( KOH-IDX  =  1                            )
             AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
               IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI1
                   MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI2
                   MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI3
                   MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                 IF   WK-TOKUSYU    >   ZAN-KOHI4
                   MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                 END-IF
               END-IF
               IF  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1"  ) AND
                    (WK-TOKUSYU    >= ZAN-KOHI-T(KOH-IDX) ))
               OR  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"  ) AND
                    (WK-IRYOKEIKBN-HANTEITEN
                                   >= WK-IRYOKEIKBN-MAXTEN))
                 MOVE   1      TO  FLG-IRYOKEIKBN
                 MOVE   WK-TOKUSYU
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               ELSE
                 MOVE   ZERO   TO  FLG-IRYOKEIKBN
                 MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               END-IF
             ELSE
               IF  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1"  ) AND
                    (WK-TOKUSYU    >= ZAN-KOHI-T(KOH-IDX) ))
               OR  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"  ) AND
                    (WK-IRYOKEIKBN-HANTEITEN
                                   >= WK-IRYOKEIKBN-MAXTEN))
                 MOVE   1      TO  FLG-IRYOKEIKBN
                 MOVE   LNK-SYU-SYUCOMPFTN
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               ELSE
                 MOVE   ZERO   TO  FLG-IRYOKEIKBN
                 MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               END-IF
             END-IF
             PERFORM    23072-KOHHI-HIKAKU-SEC
             MOVE       LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU-COMPFTN
      *
             IF   (WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1")
             AND  (KOH-IDX                       >  1 )
               COMPUTE WK-TOKUSYU = LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
               COMPUTE WK-TOKUSYU = WK-TOKUSYU                   / 10
               COMPUTE WK-TOKUSYU = WK-TOKUSYU                   * 10
               IF  WK-TOKUSYU   >=  ZAN-KOHI-T(KOH-IDX)
                 CONTINUE
               ELSE
                 MOVE   ZERO   TO  FLG-IRYOKEIKBN
                 MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               END-IF
             END-IF
           ELSE
             IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND (LNK-SYU-KOH1HKNNUM        =   "027")
               IF   FLG-KOUGAKUCYO3     =     1
                 MOVE  LNK-SYU-KOH-COMPFTN(1)  TO  WK-TOKUSYU
               ELSE
                 COMPUTE  WK-TOKUSYU =  LNK-SYU-KOH-COMPFTN(1)  +   5
                 COMPUTE  WK-TOKUSYU =  WK-TOKUSYU              /  10
                 COMPUTE  WK-TOKUSYU =  WK-TOKUSYU              *  10
               END-IF
      *
               IF  ( KOH-IDX  =  2                            )
               AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                 IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI1
                     MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI2
                     MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI3
                     MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI4
                     MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1"  ) AND
                      (WK-TOKUSYU    >= ZAN-KOHI-T(KOH-IDX) ))
                 OR  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"  ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                     >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE   1      TO  FLG-IRYOKEIKBN
                   MOVE   WK-TOKUSYU
                                 TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 ELSE
                   MOVE   ZERO   TO  FLG-IRYOKEIKBN
                   MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
               ELSE
                 IF  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1"  ) AND
                      (WK-TOKUSYU    >= ZAN-KOHI-T(KOH-IDX) ))
                 OR  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"  ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                     >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE   1      TO  FLG-IRYOKEIKBN
                   MOVE   LNK-SYU-KOH-COMPFTN(1)
                                 TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 ELSE
                   MOVE   ZERO   TO  FLG-IRYOKEIKBN
                   MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
               PERFORM    23072-KOHHI-HIKAKU-SEC
               MOVE       LNK-SYU-KOH-COMPFTN(1)  TO  WK-TOKUSYU-COMPFTN
      *
               IF   (WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1")
               AND  (KOH-IDX                       >  2 )
                 COMPUTE WK-TOKUSYU = LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                 COMPUTE WK-TOKUSYU = WK-TOKUSYU                   / 10
                 COMPUTE WK-TOKUSYU = WK-TOKUSYU                   * 10
                 IF  WK-TOKUSYU   >=  ZAN-KOHI-T(KOH-IDX)
                   CONTINUE
                 ELSE
                   MOVE   ZERO   TO  FLG-IRYOKEIKBN
                   MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
             ELSE
               COMPUTE WK-TOKUSYU = WK-ZENGAKU +  5
               COMPUTE WK-TOKUSYU = WK-TOKUSYU / 10
               COMPUTE WK-TOKUSYU = WK-TOKUSYU * 10
      *
               IF  ( KOH-IDX  =  1                            )
               AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                 IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI1
                     MOVE   ZAN-KOHI1   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI2
                     MOVE   ZAN-KOHI2   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI3
                     MOVE   ZAN-KOHI3   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                   IF   WK-TOKUSYU    >   ZAN-KOHI4
                     MOVE   ZAN-KOHI4   TO  WK-TOKUSYU
                   END-IF
                 END-IF
                 IF  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1"  ) AND
                      (WK-TOKUSYU    >= ZAN-KOHI-T(KOH-IDX) ))
                 OR  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"  ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                     >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE   1      TO  FLG-IRYOKEIKBN
                   MOVE   WK-TOKUSYU
                                 TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 ELSE
                   MOVE   ZERO   TO  FLG-IRYOKEIKBN
                   MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
               ELSE
                 IF  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1"  ) AND
                      (WK-TOKUSYU    >= ZAN-KOHI-T(KOH-IDX) ))
                 OR  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"  ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                     >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE   1      TO  FLG-IRYOKEIKBN
                   MOVE   WK-ZENGAKU
                                 TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 ELSE
                   MOVE   ZERO   TO  FLG-IRYOKEIKBN
                   MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
               PERFORM    23072-KOHHI-HIKAKU-SEC
               MOVE       WK-ZENGAKU  TO  WK-TOKUSYU-COMPFTN
      *
               IF   (WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1")
               AND  (KOH-IDX                       >  1 )
                 COMPUTE WK-TOKUSYU = LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                 COMPUTE WK-TOKUSYU = WK-TOKUSYU                   / 10
                 COMPUTE WK-TOKUSYU = WK-TOKUSYU                   *  10
                 IF  WK-TOKUSYU   >=  ZAN-KOHI-T(KOH-IDX)
                   CONTINUE
                 ELSE
                   MOVE   ZERO   TO  FLG-IRYOKEIKBN
                   MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 END-IF
               END-IF
             END-IF
           END-IF
      *
           IF        (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND       (LNK-SYU-KOH1HKNNUM    NOT =   "027")
             IF  ( KOH-IDX  =  1                            )
             AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                  (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO  WK-TAIHI-TOKU1
               IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                 IF   WK-TAIHI-TOKU1    >   ZAN-KOHI13
                   MOVE   ZAN-KOHI13   TO  WK-TAIHI-TOKU1
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                 IF   WK-TAIHI-TOKU1    >   ZAN-KOHI23
                   MOVE   ZAN-KOHI23   TO  WK-TAIHI-TOKU1
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                 IF   WK-TAIHI-TOKU1    >   ZAN-KOHI33
                   MOVE   ZAN-KOHI33   TO  WK-TAIHI-TOKU1
                 END-IF
               END-IF
               IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                 IF   WK-TAIHI-TOKU1    >   ZAN-KOHI43
                   MOVE   ZAN-KOHI43   TO  WK-TAIHI-TOKU1
                 END-IF
               END-IF
               IF  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1"   ) AND
                    (WK-TAIHI-TOKU1 >= ZAN-KOHI-T3(KOH-IDX)))
               OR  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"   ) AND
                    (WK-IRYOKEIKBN-HANTEITEN
                                    >= WK-IRYOKEIKBN-MAXTEN))
                 MOVE   WK-TAIHI-TOKU1
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               ELSE
                 MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               END-IF
               IF   FLG-IRYOKEIKBN  =  1
                    MOVE  WK-TAIHI-TOKU1
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               ELSE
                    MOVE  ZERO TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               END-IF
             ELSE
               IF  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1"   ) AND
                    (LNK-SYU-SYUCOMPFTN-ENTANI
                                    >= ZAN-KOHI-T3(KOH-IDX)))
               OR  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"   ) AND
                    (WK-IRYOKEIKBN-HANTEITEN
                                    >= WK-IRYOKEIKBN-MAXTEN))
                 MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               ELSE
                 MOVE   ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               END-IF
               IF   FLG-IRYOKEIKBN  =  1
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               ELSE
                   MOVE   ZERO TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               END-IF
             END-IF
             PERFORM    23075-KOHHI-HIKAKU4-SEC
             MOVE       LNK-SYU-SYUCOMPFTN-ENTANI
                               TO  WK-TOKUSYU-ENTANI
           ELSE
             IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND   (LNK-SYU-KOH1HKNNUM        =   "027")
               IF  ( KOH-IDX  =  2                            )
               AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                 MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                   TO  WK-TAIHI-TOKU1
                 IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI13
                     MOVE   ZAN-KOHI13   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI23
                     MOVE   ZAN-KOHI23   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI33
                     MOVE   ZAN-KOHI33   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI43
                     MOVE   ZAN-KOHI43   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1"   ) AND
                      (WK-TAIHI-TOKU1 >= ZAN-KOHI-T3(KOH-IDX)))
                 OR  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"   ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                      >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE  WK-TAIHI-TOKU1
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE  ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                 IF   FLG-IRYOKEIKBN  =  1
                     MOVE  WK-TAIHI-TOKU1
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                     MOVE  ZERO TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
               ELSE
                 IF  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1"   ) AND
                      (LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                      >= ZAN-KOHI-T3(KOH-IDX)))
                 OR  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"   ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                      >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE  ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                 IF   FLG-IRYOKEIKBN  =  1
                     MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                     MOVE  ZERO TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
               END-IF
               PERFORM    23075-KOHHI-HIKAKU4-SEC
               MOVE       LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                TO  WK-TOKUSYU-ENTANI
             ELSE
               IF  ( KOH-IDX  =  1                            )
               AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                    (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                 MOVE   WK-ZENGAKU  TO  WK-TAIHI-TOKU1
                 IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI13
                     MOVE   ZAN-KOHI13   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI23
                     MOVE   ZAN-KOHI23   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI33
                     MOVE   ZAN-KOHI33   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                   IF   WK-TAIHI-TOKU1    >   ZAN-KOHI43
                     MOVE   ZAN-KOHI43   TO  WK-TAIHI-TOKU1
                   END-IF
                 END-IF
                 IF  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1"   ) AND
                      (WK-TAIHI-TOKU1 >= ZAN-KOHI-T3(KOH-IDX)))
                 OR  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"   ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                      >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE  WK-TAIHI-TOKU1
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE  ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                 IF   FLG-IRYOKEIKBN  =  1
                     MOVE  WK-TAIHI-TOKU1
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                     MOVE  ZERO TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
               ELSE
                 IF  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "1"   ) AND
                      (WK-ZENGAKU     >= ZAN-KOHI-T3(KOH-IDX)))
                 OR  ((WK-2010-IRYOKEIKBN-N(KOH-IDX) = "2"   ) AND
                      (WK-IRYOKEIKBN-HANTEITEN
                                      >= WK-IRYOKEIKBN-MAXTEN))
                   MOVE  WK-ZENGAKU
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                   MOVE  ZERO   TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
                 IF   FLG-IRYOKEIKBN  =  1
                     MOVE  WK-ZENGAKU
                                TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 ELSE
                     MOVE  ZERO TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 END-IF
               END-IF
               PERFORM    23075-KOHHI-HIKAKU4-SEC
               MOVE       WK-ZENGAKU
                                TO  WK-TOKUSYU-ENTANI
             END-IF
           END-IF
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
           MOVE  WK-NYUSKJRYYKBN    TO LNK-SYU-SKJ-FTNKBN(KOH-IDX)
           MOVE  WK-SHOKUJI-NISSU   TO LNK-SYU-SKJ-NISSU(KOH-IDX)
           MOVE  WK-SHOKUJI-RYOYOHI TO LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
      *
           EVALUATE   WK-NYUSKJRYYKBN
             WHEN   "1"
             WHEN   "2"
             WHEN   "4"
               MOVE  WK-SHOKUJI-FTN TO LNK-SYU-SKJ-FTN(KOH-IDX)
                                       LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
               IF ((WK-2010-SKJKEIKBN(KOH-IDX)   NOT = SPACE) AND
                   (LNK-SYU-KOH-COMPFTN(KOH-IDX)     = ZERO ) AND
                   (FLG-NYUSKJJYOGAK             NOT = ZERO ))
               OR ((WK-2010-SKJKEIKBN(KOH-IDX)       = SPACE) AND
                   (FLG-NYUSKJJYOGAK             NOT = ZERO ))
                 EVALUATE  FLG-NYUSKJJYOGAK
                   WHEN     1
                     IF   LNK-SYU-SKJ-FTN(KOH-IDX)  NOT = ZERO
                       COMPUTE LNK-SYU-SKJ-FTN(KOH-IDX) =
                               LNK-SYU-SKJ-FTN(KOH-IDX) /  2
                     END-IF
                   WHEN     2
                     IF   LNK-SYU-SKJ-FTN(KOH-IDX)  NOT = ZERO
                       MOVE  ZERO  TO  LNK-SYU-SKJ-FTN(KOH-IDX)
                     END-IF
                   WHEN     3
                     IF   LNK-SYU-SKJ-FTN(KOH-IDX)  NOT = ZERO
                       COMPUTE LNK-SYU-SKJ-FTN(KOH-IDX) =
                               LNK-SYU-SKJ-FTN(1)       /  2
                     END-IF
                 END-EVALUATE
               ELSE
                 IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                   COMPUTE WK-NYUSKJJYOGAK2 =
                           WK-NYUSKJJYOGAK  * WK-SHOKUJI-NISSU
                   IF  LNK-SYU-SKJ-FTN(KOH-IDX) > WK-NYUSKJJYOGAK2
                     COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                               LNK-SYU-SKJ-FTN(KOH-IDX) -
                               WK-NYUSKJJYOGAK2
                   ELSE
                     MOVE    ZERO  TO  LNK-SYU-SKJ-FTN(KOH-IDX)
                   END-IF
                 END-IF
               END-IF
      ****     IF   LNK-SYU-SKJ-FTNKBN(KOH-IDX)  =  "2"
      ****       IF    LNK-SYU-SKJ-FTN(KOH-IDX) > ZAN-KOHI-T(KOH-IDX)
      ****         MOVE      ZAN-KOHI-T(KOH-IDX)
      ****                           TO  LNK-SYU-SKJ-FTN(KOH-IDX)
      ****       END-IF
      ****     END-IF
               IF   LNK-SYU-SKJ-FTNKBN(KOH-IDX)  =  "2"
                 MOVE     "1"        TO  LNK-SYU-SKJ-FTNKBN(KOH-IDX)
               END-IF
             WHEN   "3"
               MOVE   WK-SHOKUJI-FTN TO  LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
             WHEN   "5"
               IF  (WK-2010-SKJKEIKBN(KOH-IDX)   NOT = SPACE)
               AND (LNK-SYU-KOH-COMPFTN(KOH-IDX) NOT = ZERO )
                 MOVE  WK-SHOKUJI-FTN
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                     LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 MOVE  "1"      TO   WK-NYUSKJRYYKBN
                 MOVE  SPACE    TO   WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                 MOVE  WK-NYUSKJRYYKBN
                                TO   LNK-SYU-SKJ-FTNKBN(KOH-IDX)
               ELSE
                 MOVE  WK-SHOKUJI-NISSUS
                                     TO  LNK-SYU-SKJ-NISSU(KOH-IDX)
                 MOVE  WK-SHOKUJI-RYOYOHIS
                                     TO  LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
                 MOVE  WK-SHOKUJI-FTNS
                                     TO  LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 MOVE  WK-SHOKUJI-FTNL
                                     TO  LNK-SYU-SKJ-FTN(KOH-IDX)
               END-IF
             WHEN   "7"
               IF  (WK-2010-SKJKEIKBN(KOH-IDX)   NOT = SPACE)
               AND (LNK-SYU-KOH-COMPFTN(KOH-IDX) NOT = ZERO )
                 MOVE  WK-SHOKUJI-FTN
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                     LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 MOVE  "1"      TO   WK-NYUSKJRYYKBN
                 MOVE  SPACE    TO   WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                 MOVE  WK-NYUSKJRYYKBN
                                TO   LNK-SYU-SKJ-FTNKBN(KOH-IDX)
               ELSE
                 MOVE  WK-SHOKUJI-NISSUS
                                     TO  LNK-SYU-SKJ-NISSU(KOH-IDX)
                 MOVE  WK-SHOKUJI-RYOYOHIS
                                     TO  LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
                 MOVE  WK-SHOKUJI-FTNS
                                     TO  LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 MOVE  WK-SHOKUJI-FTNL
                                     TO  LNK-SYU-SKJ-FTN(KOH-IDX)
                 COMPUTE  LNK-SYU-SKJ-FTN(KOH-IDX) =
                          LNK-SYU-SKJ-FTN(KOH-IDX) +
                          (WK-SHOKUJI-FTNS  /  2)
               END-IF
             WHEN   "8"
               IF  (WK-2010-SKJKEIKBN(KOH-IDX)   NOT = SPACE)
               AND (LNK-SYU-KOH-COMPFTN(KOH-IDX) NOT = ZERO )
                 MOVE  WK-SHOKUJI-FTN
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                     LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 MOVE  "1"      TO   WK-NYUSKJRYYKBN
                 MOVE  SPACE    TO   WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                 MOVE  WK-NYUSKJRYYKBN
                                TO   LNK-SYU-SKJ-FTNKBN(KOH-IDX)
               ELSE
                 MOVE  WK-SHOKUJI-NISSU
                                     TO  LNK-SYU-SKJ-NISSU(KOH-IDX)
                 COMPUTE  LNK-SYU-SKJ-RYOYOHI(KOH-IDX)  =
                          WK-SHOKUJI-RYOYOHI            -
                          WK-SHOKUJI-RYOYOHIL2
                 COMPUTE  LNK-SYU-SKJ-FTN-RECE(KOH-IDX) =
                          WK-SHOKUJI-FTN                -
                          WK-SHOKUJI-FTNL2
                 MOVE  WK-SHOKUJI-FTNL2
                                     TO  LNK-SYU-SKJ-FTN(KOH-IDX)
                 COMPUTE  LNK-SYU-SKJ-FTN(KOH-IDX) =
                          LNK-SYU-SKJ-FTN(KOH-IDX) +
                          (LNK-SYU-SKJ-FTN-RECE(KOH-IDX)  /  2)
               END-IF
             WHEN   "9"
               IF  (WK-2010-SKJKEIKBN(KOH-IDX)   NOT = SPACE)
               AND (LNK-SYU-KOH-COMPFTN(KOH-IDX) NOT = ZERO )
                 MOVE  WK-SHOKUJI-FTN
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                     LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 MOVE  "1"      TO   WK-NYUSKJRYYKBN
                 MOVE  SPACE    TO   WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                 MOVE  WK-NYUSKJRYYKBN
                                TO   LNK-SYU-SKJ-FTNKBN(KOH-IDX)
               ELSE
                 MOVE  WK-SHOKUJI-NISSU
                                     TO  LNK-SYU-SKJ-NISSU(KOH-IDX)
                 COMPUTE  LNK-SYU-SKJ-RYOYOHI(KOH-IDX)  =
                          WK-SHOKUJI-RYOYOHI            -
                          WK-SHOKUJI-RYOYOHIL2
                 COMPUTE  LNK-SYU-SKJ-FTN-RECE(KOH-IDX) =
                          WK-SHOKUJI-FTN                -
                          WK-SHOKUJI-FTNL2
                 MOVE  WK-SHOKUJI-FTNL2
                                     TO  LNK-SYU-SKJ-FTN(KOH-IDX)
               END-IF
           END-EVALUATE
      *
      *    ¸øÈñÃ±°Ì¤Ç·×»»¤·¤¿´µ¼ÔÉéÃ´¶â¤òÈæ³Ó
      *
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
           END-EVALUATE
      *
      *    ¸øÈñÃ±°Ì¤Ç·×»»¤·¤¿´µ¼ÔÉéÃ´¶â¤òÈæ³Ó
      *    ¡Ê±ßÃ±°Ì¡Ë
      *
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                   <     WK-TOKUSYU-ENTANI
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                   <     WK-TOKUSYU-ENTANI
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                   <     WK-TOKUSYU-ENTANI
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
           END-EVALUATE
      *
      ***  IF  ((LNK-S02-KOUREI-NYUIN-KBN     =      "1"  ) OR
      ***       (FLG-KOREI-TANYUIN            =       1   ))
      ***  AND ( COMB-HKNNUM            NOT   =     SPACE  )
      ***    IF   WK-2010-IRYOKEIKBN-N-XXX(KOH-IDX) = "1"
      ***      IF  (WK-1001-PREFNUM             =  11           )
      ***      AND (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "542" OR "682"
      ***                                      OR "462" OR "762")
      ***        CONTINUE
      ***      ELSE
      ***        MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
      ***                        LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
      ***                        WK-TOKUSYU-COMPFTN
      ***                        WK-TOKUSYU-ENTANI
      ***        IF    HKN-RECEFTNDSPKBN    =  "2"
      ***          MOVE  ZERO  TO  WK-KOH-COMPFTN(KOH-IDX)
      ***        END-IF
      ***        COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
      ***                  LNK-SYU-KOH-COMPFTN(KOH-IDX)
      ***      END-IF
      ***    END-IF
      ***  END-IF
      *
           .
      *
       23076-TOKUSYU-SANTEI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        ÆÃ¼ì·×»»¡Ê¸ÂÅÙ¤òÄ¶¤¨¤¿¾ì¹ç¡¢´µ¼ÔÉéÃ´È¯À¸¡ÊÄ¶¤¨¤¿³Û¡Ë¡Ë
      ******************************************************************
       23077-TOKUSYU-SANTEI2-SEC           SECTION.
      *
           IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   PERFORM    23075-KOHHI-HIKAKU4-SEC
      *
                   IF  ( KOH-IDX  =  1                            )
                   AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                             >   ZAN-KOHI-T3(KOH-IDX)
                       COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  -
                                ZAN-KOHI-T3(KOH-IDX)
                   ELSE
                       MOVE   ZERO  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                                 WK-TOKUSYU-ENTANI
           ELSE
               IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
               AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                   MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   PERFORM    23075-KOHHI-HIKAKU4-SEC
      *
                   IF  ( KOH-IDX  =  2                            )
                   AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                             >   ZAN-KOHI-T3(KOH-IDX)
                       COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  -
                                ZAN-KOHI-T3(KOH-IDX)
                   ELSE
                       MOVE   ZERO  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                   MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)  TO
                                                 WK-TOKUSYU-ENTANI
               ELSE
                   MOVE   WK-ZENGAKU  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   PERFORM    23075-KOHHI-HIKAKU4-SEC
      *
                   IF  ( KOH-IDX  =  1                            )
                   AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                                  >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                             >   ZAN-KOHI-T3(KOH-IDX)
                       COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  -
                                ZAN-KOHI-T3(KOH-IDX)
                   ELSE
                       MOVE   ZERO  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                   END-IF
                   MOVE   WK-ZENGAKU   TO   WK-TOKUSYU-ENTANI
               END-IF
           END-IF
      **
           IF    HKN-RECEFTNDSPKBN      =  "2"
              IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
              AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                   MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                         TO  WK-KOH-COMPFTN(KOH-IDX)
                   PERFORM    23073-KOHHI-HIKAKU2-SEC
      *
                   IF  ( KOH-IDX  =  1                            )
                   AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI-T2(KOH-IDX)
                       COMPUTE  WK-KOH-COMPFTN(KOH-IDX)  =
                                WK-KOH-COMPFTN(KOH-IDX)  -
                                ZAN-KOHI-T2(KOH-IDX)
                   ELSE
                       MOVE   ZERO    TO   WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                   MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                      TO   WK-TOKUSYU-COMPFTN2
              ELSE
                IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                AND (LNK-SYU-KOH1HKNNUM        =   "027")
                   MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                       TO   WK-KOH-COMPFTN(KOH-IDX)
                   PERFORM    23073-KOHHI-HIKAKU2-SEC
      *
                   IF  ( KOH-IDX  =  2                            )
                   AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI-T2(KOH-IDX)
                       COMPUTE  WK-KOH-COMPFTN(KOH-IDX)  =
                                WK-KOH-COMPFTN(KOH-IDX)  -
                                ZAN-KOHI-T2(KOH-IDX)
                   ELSE
                       MOVE   ZERO    TO   WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                   MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                       TO  WK-TOKUSYU-COMPFTN2
                ELSE
                   MOVE  WK-ZENGAKU  TO    WK-KOH-COMPFTN(KOH-IDX)
                   PERFORM    23073-KOHHI-HIKAKU2-SEC
      *
                   IF  ( KOH-IDX  =  1                            )
                   AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                        (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI13
                          MOVE   ZAN-KOHI13
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI23
                          MOVE   ZAN-KOHI23
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI33
                          MOVE   ZAN-KOHI33
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI43
                          MOVE   ZAN-KOHI43
                                     TO  WK-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
      *
                   IF    WK-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI-T2(KOH-IDX)
                       COMPUTE  WK-KOH-COMPFTN(KOH-IDX)  =
                                WK-KOH-COMPFTN(KOH-IDX)  -
                                ZAN-KOHI-T2(KOH-IDX)
                   ELSE
                       MOVE   ZERO    TO   WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
                   MOVE   WK-ZENGAKU  TO   WK-TOKUSYU-COMPFTN2
                END-IF
              END-IF
           END-IF
      **
           IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND   (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                  IF  (FLG-KOUGAKUCYO3      =     1)
                  OR  (FLG-KOUGAKUCYO-GEN70 =     1)
                    MOVE  LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU
                  ELSE
                    COMPUTE  WK-TOKUSYU =  LNK-SYU-SYUCOMPFTN  +   5
                    COMPUTE  WK-TOKUSYU =  WK-TOKUSYU          /  10
                    COMPUTE  WK-TOKUSYU =  WK-TOKUSYU          *  10
                  END-IF
      *
                  MOVE  WK-TOKUSYU  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  PERFORM    23072-KOHHI-HIKAKU-SEC
      *
                  IF  ( KOH-IDX  =  1                            )
                  AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI1
                          MOVE   ZAN-KOHI1
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI2
                          MOVE   ZAN-KOHI2
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI3
                          MOVE   ZAN-KOHI3
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI4
                          MOVE   ZAN-KOHI4
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                  END-IF
      *
                  IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)  >
                                            ZAN-KOHI-T(KOH-IDX)
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                               ZAN-KOHI-T(KOH-IDX)
                  ELSE
                      MOVE   ZERO    TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  END-IF
                  MOVE   LNK-SYU-SYUCOMPFTN  TO  WK-TOKUSYU-COMPFTN
           ELSE
              IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
              AND (LNK-SYU-KOH1HKNNUM        =   "027")
                  IF   FLG-KOUGAKUCYO3     =     1
                    MOVE  LNK-SYU-KOH-COMPFTN(1)  TO  WK-TOKUSYU
                  ELSE
                    COMPUTE  WK-TOKUSYU =  LNK-SYU-KOH-COMPFTN(1)  +   5
                    COMPUTE  WK-TOKUSYU =  WK-TOKUSYU              /  10
                    COMPUTE  WK-TOKUSYU =  WK-TOKUSYU              *  10
                  END-IF
      *
                  MOVE  WK-TOKUSYU  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  PERFORM    23072-KOHHI-HIKAKU-SEC
      *
                  IF  ( KOH-IDX  =  2                            )
                  AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI1
                          MOVE   ZAN-KOHI1
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI2
                          MOVE   ZAN-KOHI2
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI3
                          MOVE   ZAN-KOHI3
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI4
                          MOVE   ZAN-KOHI4
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                  END-IF
      *
                  IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)  >
                                            ZAN-KOHI-T(KOH-IDX)
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                               ZAN-KOHI-T(KOH-IDX)
                  ELSE
                      MOVE   ZERO    TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  END-IF
                  MOVE   LNK-SYU-KOH-COMPFTN(1)  TO  WK-TOKUSYU-COMPFTN
              ELSE
                  COMPUTE  WK-TOKUSYU =  WK-ZENGAKU  +   5
                  COMPUTE  WK-TOKUSYU =  WK-TOKUSYU  /  10
                  COMPUTE  WK-TOKUSYU =  WK-TOKUSYU  *  10
      *
                  MOVE  WK-TOKUSYU  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  PERFORM    23072-KOHHI-HIKAKU-SEC
      *
                  IF  ( KOH-IDX  =  1                            )
                  AND ((LNK-SYU-KOH-HKNNUM(1)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(2)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(3)  =  "972" OR "974") OR
                       (LNK-SYU-KOH-HKNNUM(4)  =  "972" OR "974"))
                     IF   LNK-SYU-KOH-HKNNUM(1) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI1
                          MOVE   ZAN-KOHI1
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(2) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI2
                          MOVE   ZAN-KOHI2
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(3) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI3
                          MOVE   ZAN-KOHI3
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                     IF   LNK-SYU-KOH-HKNNUM(4) =  "972" OR "974"
                       IF   LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI4
                          MOVE   ZAN-KOHI4
                                     TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                       END-IF
                     END-IF
                  END-IF
      *
                  IF    LNK-SYU-KOH-COMPFTN(KOH-IDX)  >
                                            ZAN-KOHI-T(KOH-IDX)
                      COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                               ZAN-KOHI-T(KOH-IDX)
                  ELSE
                      MOVE   ZERO    TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  END-IF
                  MOVE   WK-ZENGAKU  TO   WK-TOKUSYU-COMPFTN
              END-IF
           END-IF
      **
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
      *    ¸øÈñ¤Î¿©»öÊÔ½¸
           PERFORM   23089-KOH-SKJ-HENSYU-SEC
      *
      *    ¸øÈñÃ±°Ì¤Ç·×»»¤·¤¿´µ¼ÔÉéÃ´¶â¤òÈæ³Ó
      *
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN(1)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN
                       MOVE  LNK-SYU-KOH-COMPFTN(2)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN
                       MOVE  LNK-SYU-KOH-COMPFTN(3)
                                            TO  WK-TOKUSYU-COMPFTN
                   END-IF
           END-EVALUATE
      *
      *    ¸øÈñÃ±°Ì¤Ç·×»»¤·¤¿´µ¼ÔÉéÃ´¶â¤òÈæ³Ó
      *    ¡Ê¥ì¥»µ­ºÜ¶â³ÛÂàÈòÍÑ¥¨¥ê¥¢ÍÑ¡Ë
      *
           IF    HKN-RECEFTNDSPKBN      =  "2"
             EVALUATE    KOH-IDX
               WHEN    2
                 IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                   IF  WK-KOH-COMPFTN(1)  =  ALL"9"
                     IF  LNK-SYU-KOH-COMPFTN(1) < WK-TOKUSYU-COMPFTN2
                     AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                         MOVE  LNK-SYU-KOH-COMPFTN(1)
                                              TO  WK-TOKUSYU-COMPFTN2
                     END-IF
                   ELSE
                     IF  WK-KOH-COMPFTN(1)      < WK-TOKUSYU-COMPFTN2
                     AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                         MOVE  WK-KOH-COMPFTN(1)
                                              TO  WK-TOKUSYU-COMPFTN2
                     END-IF
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                < WK-TOKUSYU-COMPFTN2
                   AND LNK-SYU-KOH1HKNNUM     NOT =  SPACE
                         MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                              TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN    3
                 IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                   IF  WK-KOH-COMPFTN(2)  =  ALL"9"
                     IF  LNK-SYU-KOH-COMPFTN(2) < WK-TOKUSYU-COMPFTN2
                         MOVE  LNK-SYU-KOH-COMPFTN(2)
                                              TO  WK-TOKUSYU-COMPFTN2
                     END-IF
                   ELSE
                     IF  WK-KOH-COMPFTN(2)      < WK-TOKUSYU-COMPFTN2
                         MOVE  WK-KOH-COMPFTN(2)
                                              TO  WK-TOKUSYU-COMPFTN2
                     END-IF
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                                < WK-TOKUSYU-COMPFTN2
                         MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                              TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
               WHEN    4
                 IF  LNK-SYU-SRYYMD(1:6)  < "201905"
                   IF  WK-KOH-COMPFTN(3)  =  ALL"9"
                     IF  LNK-SYU-KOH-COMPFTN(3) < WK-TOKUSYU-COMPFTN2
                         MOVE  LNK-SYU-KOH-COMPFTN(3)
                                              TO  WK-TOKUSYU-COMPFTN2
                     END-IF
                   ELSE
                     IF  WK-KOH-COMPFTN(3)      < WK-TOKUSYU-COMPFTN2
                         MOVE  WK-KOH-COMPFTN(3)
                                              TO  WK-TOKUSYU-COMPFTN2
                     END-IF
                   END-IF
                 ELSE
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                                < WK-TOKUSYU-COMPFTN2
                         MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                              TO  WK-TOKUSYU-COMPFTN2
                   END-IF
                 END-IF
             END-EVALUATE
           END-IF
      *
      *    ¸øÈñÃ±°Ì¤Ç·×»»¤·¤¿´µ¼ÔÉéÃ´¶â¤òÈæ³Ó
      *    ¡Ê±ßÃ±°Ì¡Ë
      *
           EVALUATE    KOH-IDX
               WHEN    2
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(1) 
                                   <     WK-TOKUSYU-ENTANI
                   AND LNK-SYU-KOH1HKNNUM   NOT =  SPACE
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
               WHEN    3
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(2) 
                                   <     WK-TOKUSYU-ENTANI
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
               WHEN    4
                   IF  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                   <     WK-TOKUSYU-ENTANI
                       MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3) 
                                     TO  WK-TOKUSYU-ENTANI
                   END-IF
           END-EVALUATE
      *
           .
      *
       23077-TOKUSYU-SANTEI2-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        ÆÃ¼ì·×»»¡Ê£²³äËô¤Ï£³³ä¤Î³Û¤ò»»½Ð¸å¡¢È¾³Û¤ò´µ¼ÔÉéÃ´¤È¤¹¤ë¡Ë
      ******************************************************************
       23078-TOKUSYU-SANTEI3-SEC           SECTION.
      *
           IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND    (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                    COMPUTE   WK-HANGAKU-ENTANI     =
                              LNK-SYU-SYUCOMPFTN-ENTANI      *  0.5
           ELSE
             IF   (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND  (LNK-SYU-KOH1HKNNUM        =   "027")
                    COMPUTE   WK-HANGAKU-ENTANI     =
                              LNK-SYU-KOH-COMPFTN-ENTANI(1)  *  0.5
             ELSE
                    COMPUTE   WK-HANGAKU-ENTANI     =
                              WK-ZENGAKU                     *  0.5
             END-IF
           END-IF
      *
           IF    WK-HANGAKU-ENTANI  >  ZAN-KOHI-T3(KOH-IDX)
               MOVE   ZAN-KOHI-T3(KOH-IDX)
                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           ELSE
               MOVE   WK-HANGAKU-ENTANI
                     TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           PERFORM    23075-KOHHI-HIKAKU4-SEC
      *
      *
           IF     HKN-RECEFTNDSPKBN          =  "2"
      *
              IF      (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
              AND     (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                      COMPUTE   WK-HANGAKU-COMPFTN   =
                                LNK-SYU-SYUCOMPFTN-ENTANI      *  0.5
              ELSE
                IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                      COMPUTE   WK-HANGAKU-COMPFTN   =
                                LNK-SYU-KOH-COMPFTN-ENTANI(1)  *  0.5
                ELSE
                      COMPUTE   WK-HANGAKU-COMPFTN   =
                                WK-ZENGAKU                     *  0.5
                END-IF
              END-IF
      *
              IF    WK-HANGAKU-COMPFTN  >  ZAN-KOHI-T2(KOH-IDX)
                  MOVE   ZAN-KOHI-T2(KOH-IDX)
                                   TO  WK-KOH-COMPFTN(KOH-IDX)
              ELSE
                  MOVE  WK-HANGAKU-COMPFTN
                                   TO  WK-KOH-COMPFTN(KOH-IDX)
              END-IF
      *
              PERFORM    23073-KOHHI-HIKAKU2-SEC
      *
           END-IF
      *
      *
           IF      (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND     (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                   COMPUTE   WK-HANGAKU-COMPFTN   =
                             WK-TOKUTEI-COMPFTN   *  0.5
           ELSE
             IF    (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND   (LNK-SYU-KOH1HKNNUM        =   "027")
                   COMPUTE   WK-HANGAKU-COMPFTN   =
                             WK-TOKUTEI-COMPFTN3  *  0.5
             ELSE
                   COMPUTE   WK-HANGAKU-COMPFTN   =
                             WK-ZENGAKU           *  0.5
             END-IF
           END-IF
      *
           IF    WK-HANGAKU-COMPFTN  >  ZAN-KOHI-T(KOH-IDX)
               MOVE   ZAN-KOHI-T(KOH-IDX)
                             TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
           ELSE
               MOVE  WK-HANGAKU-COMPFTN
                             TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
           END-IF
      *
           PERFORM   23072-KOHHI-HIKAKU-SEC
      *
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
      *    ¸øÈñ¤Î¿©»öÊÔ½¸
           PERFORM   23089-KOH-SKJ-HENSYU-SEC
      *
           .
      *
       23078-TOKUSYU-SANTEI3-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        ÆÃ¼ì·×»»¡ÊÄ¹´ü¤Î·×»»¡Ë
      ******************************************************************
       23079-TOKUSYU-SANTEI4-SEC           SECTION.
      *
           IF    FLG-ZENKI-TOKUREI  =  1
             IF   ( WK-1001-PREFNUM      =  27      )
             OR   ((LNK-SYU-SRYYMD(1:6) >= "201508") AND
                   (WK-1001-PREFNUM      =  12     ))
               COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                     =  WK-ZENGAKU  *  0.1
               COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     =  WK-ZENGAKU  *  0.1
             ELSE
               COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                     =  WK-ZENGAKU  *  0.2
               COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     =  WK-ZENGAKU  *  0.2
             END-IF
           ELSE
             IF  COMB-HKNNUM        =  SPACE
               COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                   =  WK-ZENGAKU
               COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                   =  WK-ZENGAKU
             ELSE
               COMPUTE  WK-FUTANWARI   = WK-KOH-FTNRATE  /  100
               COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                   =  WK-ZENGAKU  *  WK-FUTANWARI
               COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                   =  WK-ZENGAKU  *  WK-FUTANWARI
             END-IF
           END-IF
      *
      *    ¸º³Û
           IF  COMB-HKNNUM  =  SPACE
             CONTINUE
           ELSE
             IF    FLG-ZENKI-TOKUREI  =  1
               MOVE    10               TO   WK-NYUKFTNRATE2
             ELSE
               MOVE    WK-KOH-FTNRATE   TO   WK-NYUKFTNRATE2
             END-IF
             MOVE      ZERO             TO   FLG-GENGAKU-HENSYU
             PERFORM   2307A-KOH-GENGAKU-HENSYU-SEC
             IF  WK-GENGAKUKBN  NOT =  ZERO
                 MOVE  WK-GENGAKU-GAK
                        TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 MOVE  WK-GENGAKU-GAK-ENTANI
                        TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
           END-IF
      *
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
           COMPUTE  WK-FTN      =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX) / 10
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                    WK-FTN   *  10
      *
           IF LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) > ZAN-KOHI-T3(KOH-IDX)
              MOVE  ZAN-KOHI-T3(KOH-IDX)  TO
                                     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           IF LNK-SYU-KOH-COMPFTN(KOH-IDX) > ZAN-KOHI-T(KOH-IDX)
              MOVE  ZAN-KOHI-T(KOH-IDX)   TO
                                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
              MOVE  ZERO                  TO ZAN-KOHI-T(KOH-IDX)
           ELSE
              COMPUTE  ZAN-KOHI-T(KOH-IDX)    =
                       ZAN-KOHI-T(KOH-IDX)    -
                       LNK-SYU-KOH-COMPFTN(KOH-IDX)
           END-IF
      *
           COMPUTE     LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                       LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
           IF    ZAN-KOHI-T(KOH-IDX)   NOT =   ZERO
               COMPUTE   ZAN-KOHI-T(KOH-IDX) =
      ***                ZAN-KOHI-T(KOH-IDX) +   5
                         ZAN-KOHI-T(KOH-IDX) +   4
               COMPUTE   WK-FTN      =
                         ZAN-KOHI-T(KOH-IDX) /  10
               COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                         WK-FTN   *  10
           END-IF
      *
           MOVE  WK-NYUSKJRYYKBN    TO LNK-SYU-SKJ-FTNKBN(KOH-IDX)
           MOVE  WK-SHOKUJI-NISSU   TO LNK-SYU-SKJ-NISSU(KOH-IDX)
           MOVE  WK-SHOKUJI-RYOYOHI TO LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
           MOVE  WK-SHOKUJI-FTN     TO LNK-SYU-SKJ-FTN(KOH-IDX)
                                       LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
      *
           .
      *
       23079-TOKUSYU-SANTEI4-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¸øÈñ°ìÉôÉéÃ´¶â¸º³Û
      ******************************************************************
       2307A-KOH-GENGAKU-HENSYU-SEC           SECTION.
      *
           EVALUATE  WK-GENGAKUKBN
             WHEN        1
               IF  WK-GENGAKUKBN-KEISAN  =  2
                 IF    WK-GENGAKU-RITU     =  ZERO
                 OR    FLG-GENGAKU-HENSYU  =   1
                     MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                 TO  WK-GENGAKU-GAK
                     MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                 TO  WK-GENGAKU-GAK-ENTANI
                 ELSE
                   IF  WK-NYUKFTNRATE2  <= WK-GENGAKU-RITU
                     MOVE  ZERO  TO  WK-GENGAKU-GAK
                     MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                   ELSE
                     COMPUTE  WK-FUTANWARI2   =
                              WK-GENGAKU-RITU / 100
                     COMPUTE  WK-GENGAKU-GAK2 =
                              WK-ZENGAKU      * WK-FUTANWARI2
                     COMPUTE  WK-GENGAKU-GAK2-ENTANI =
                              WK-ZENGAKU      * WK-FUTANWARI2
                     IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                 > WK-GENGAKU-GAK2
                       COMPUTE WK-GENGAKU-GAK               =
                               LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                               WK-GENGAKU-GAK2
                     ELSE
                       MOVE  ZERO  TO  WK-GENGAKU-GAK
                     END-IF
                     IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                 > WK-GENGAKU-GAK2-ENTANI
                       COMPUTE WK-GENGAKU-GAK-ENTANI               =
                               LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                               WK-GENGAKU-GAK2-ENTANI
                     ELSE
                       MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                     END-IF
                   END-IF
                 END-IF
               ELSE
                 IF  WK-GENGAKU-RITU = 100
                   MOVE  ZERO  TO  WK-GENGAKU-GAK
                   MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                 ELSE
                   COMPUTE  WK-GENGAKU-RITUX =
                            100 - WK-GENGAKU-RITU
                   COMPUTE  WK-GENGAKU-GAK               =
                            LNK-SYU-KOH-COMPFTN(KOH-IDX) *
                            WK-GENGAKU-RITUX             /
                            100
                   COMPUTE  WK-GENGAKU-GAK-ENTANI               =
                            LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) *
                            WK-GENGAKU-RITUX                    /
                            100
                 END-IF
               END-IF
             WHEN        2
               IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                     < WK-GENGAKU-KIN2
                 MOVE   ZERO   TO   WK-GENGAKU-GAK
               ELSE
                 COMPUTE  WK-GENGAKU-GAK                =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX)  -
                          WK-GENGAKU-KIN2
               END-IF
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     < WK-GENGAKU-KIN2-ENTANI
                 MOVE   ZERO   TO   WK-GENGAKU-GAK-ENTANI
               ELSE
                 COMPUTE  WK-GENGAKU-GAK-ENTANI               =
                          LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                          WK-GENGAKU-KIN2-ENTANI
               END-IF
             WHEN        3
             WHEN        4
                 MOVE  ZERO  TO  WK-GENGAKU-GAK
                 MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
             WHEN        5
               IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                     < WK-GENGAKU-KIN2
                 MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                             TO   WK-GENGAKU-GAK
               ELSE
                 MOVE  WK-GENGAKU-KIN2
                             TO   WK-GENGAKU-GAK
               END-IF
               IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                     < WK-GENGAKU-KIN2-ENTANI
                 MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                             TO   WK-GENGAKU-GAK-ENTANI
               ELSE
                 MOVE  WK-GENGAKU-KIN2-ENTANI
                             TO   WK-GENGAKU-GAK-ENTANI
               END-IF
           END-EVALUATE
      *
           .
       2307A-KOH-GENGAKU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñ¤Î´µ¼ÔÉéÃ´¶â³Û·×»»¡Ê¾å¸Â³Û¤Ê¤·¡Ë                  *
      ******************************************************************
       2308-KOH-KEISAN2-SEC           SECTION.
      *
      *    ÉéÃ´¶â³Û¤Î·×»»
           IF  WK-NYUKFTNRATE     NOT =    ZERO
      *
               IF   WK-DAY-NYUKFTNRATE       =  ZERO
               AND  WK-DAY-NYUKFTNRATE-FLG   =  ZERO
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE
                    MOVE      1            TO   WK-DAY-NYUKFTNRATE-FLG
               END-IF
      *
               IF   WK-DAY-NYUKFTNRATE2      =  ZERO
               AND  WK-DAY-NYUKFTNRATE-FLG2  =  ZERO
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE2
                    MOVE      1            TO   WK-DAY-NYUKFTNRATE-FLG2
               ELSE
                 IF  (WK-DAY-NYUKFTNRATE2 > WK-NYUKFTNRATE    )
                 AND (LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1)  =  "0")
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE2
                 END-IF
               END-IF
      *
               COMPUTE   WK-FUTANWARI  =
                              WK-NYUKFTNRATE  /  100
               IF    WK-KOH-FTNKBN   NOT =  SPACE
                 EVALUATE  WK-KOH-FTNKBN
                    WHEN  "1"
                      COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                                LNK-SYU-KYUFUGAI-GOKEI-TEN
                                        *  HKN-TENTNK
                                        *  WK-FUTANWARI
                      COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                                LNK-SYU-KYUFUGAI-GOKEI-TEN
                                        *  HKN-TENTNK
                                        *  WK-FUTANWARI
                    WHEN  "2"
                      MOVE    ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                      MOVE    ZERO   TO
                                   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                      MOVE    ZERO   TO   LNK-SYU-KYUFUGAI-SHOSHIN-TEN
                                          LNK-SYU-KYUFUGAI-SIDOU-TEN
                                          LNK-SYU-KYUFUGAI-OSIN1-TEN
                                          LNK-SYU-KYUFUGAI-OSIN2-TEN
                                          LNK-SYU-KYUFUGAI-OSIN3-TEN
                                          LNK-SYU-KYUFUGAI-GOKEI-TEN
                 END-EVALUATE
               ELSE
                 COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                           WK-ZENGAKU   *  WK-FUTANWARI
                 COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                           WK-ZENGAKU   *  WK-FUTANWARI
               END-IF
      *
               IF  ((LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1)  =  "0"  ) AND
                    (WK-DOTANDOKU(KOH-IDX)             =  ZERO ))
               OR  ( WK-TOKATUKAI(KOH-IDX)             =  1     )
               OR  ( WK-KOHJGNGET-TEKIYOFLG(KOH-IDX)   =  1     )
                 IF   (LNK-SYU-KOH-HKNNUM(KOH-IDX)     = "092")
                 AND  (WK-KOHJGNGET-CHECK092(KOH-IDX)  =  1   )
                    CONTINUE
                 ELSE
      *             ¸º³Û
                    MOVE      999   TO     WK-NYUKFTNRATE2
                    MOVE      1     TO     FLG-GENGAKU-HENSYU
                    PERFORM   2307A-KOH-GENGAKU-HENSYU-SEC
                    IF  WK-GENGAKUKBN  NOT =  ZERO
                        MOVE  WK-GENGAKU-GAK
                               TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                        MOVE  WK-GENGAKU-GAK-ENTANI
                               TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                    END-IF
                    IF   LNK-SYU-KOH-HKNNUM(KOH-IDX)  =  "027"
                        MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX)                 
                                            TO WK-TOKUTEI-COMPFTN3      
                    END-IF
                 END-IF
               END-IF                
               IF  (( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          ) OR
                    ( HKN-RECEFTNDSPKBN           = "2"            ) OR
                    ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                     (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016")))
               AND (  WK-NYUKFTNRATE         NOT  =  100            )
                   MOVE    "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                   IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN
                                        TO  LNK-SYU-SYUCOMPFTN
                   END-IF
                   IF    LNK-SYU-KOH-HKNNUM(1)    =    "027"
                     IF  WK-TOKUTEI-COMPFTN3  NOT =    ZERO
                       MOVE  WK-TOKUTEI-COMPFTN3
                                        TO  LNK-SYU-KOH-COMPFTN(1)
                     END-IF
                   END-IF
                   IF    LNK-SYU-SRYYMD(1:6)  < "201905"
                     CONTINUE
                   ELSE
                     MOVE    LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                        TO  WK-KOH-COMPFTN(KOH-IDX)
                   END-IF
               ELSE
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                   COMPUTE   WK-FTN      =
                             LNK-SYU-KOH-COMPFTN(KOH-IDX)  /  10
                   COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =  WK-FTN
                                                              *  10
               END-IF
           ELSE
      *
               IF   WK-DAY-NYUKFTNRATE       =  ZERO
               AND  WK-DAY-NYUKFTNRATE-FLG   =  ZERO
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE
                    MOVE      1            TO   WK-DAY-NYUKFTNRATE-FLG
               END-IF
      *
               IF   WK-DAY-NYUKFTNRATE2      =  ZERO
               AND  WK-DAY-NYUKFTNRATE-FLG2  =  ZERO
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE2
                    MOVE      1            TO   WK-DAY-NYUKFTNRATE-FLG2
               ELSE
                 IF  (WK-DAY-NYUKFTNRATE2 > WK-NYUKFTNRATE    )
                 AND (LNK-SYU-KOH-HKNNUM(KOH-IDX)(1:1)  =  "0")
                    MOVE      WK-NYUKFTNRATE   TO   WK-DAY-NYUKFTNRATE2
                 END-IF
               END-IF
      *
               IF  ((WK-1001-PREFNUM         =  43           ) AND
                    (COMB-KOHHKNNUM(KOH-IDX) = "143" OR "342") AND
                    (LNK-SYU-SRYYMD(1:6)    <= "200911"      ))
               OR  ((WK-1001-PREFNUM         =  13           ) AND
                    (COMB-KOHHKNNUM(KOH-IDX) = "588"         ) AND
                    (LNK-SYU-SRYYMD(1:6)    >= "200710"      ) AND
                    (LNK-SYU-SRYYMD(1:6)    <= "200909"      ))
               OR  ((COMB-KOHHKNNUM(KOH-IDX) = "019"         ) AND
                    (WK-NYUKFTNRATE019   NOT =  ZERO         ))
      *
                 IF (WK-1001-PREFNUM         =  43           ) AND
                    (COMB-KOHHKNNUM(KOH-IDX) = "143" OR "342") AND
                    (LNK-SYU-SRYYMD(1:6)    <= "200911"      )
                   MOVE    "1"   TO    FLG-KUMAMOTO
                   MOVE    "1"   TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
                   PERFORM   23081-KUMAMOTO-KOHI-SEC
                 END-IF
                 IF (WK-1001-PREFNUM         =  13           ) AND
                    (COMB-KOHHKNNUM(KOH-IDX) = "588"         ) AND
                    (LNK-SYU-SRYYMD(1:6)    >= "200710"      ) AND
                    (LNK-SYU-SRYYMD(1:6)    <= "200909"      )
                   PERFORM   23082-TOKYO-KOHI-SEC
                 END-IF
                 IF (COMB-KOHHKNNUM(KOH-IDX) = "019"         ) AND
                    (WK-NYUKFTNRATE019   NOT =  ZERO         )
                   PERFORM   23085-GENBAKU-KOHI-SEC
                 END-IF
      *
               END-IF
           END-IF.
      *
           IF   (WK-NYUKFTNRATE           =   ZERO )
           AND  (COMB-KOHHKNNUM(KOH-IDX)  =   "970")
           AND  (HKN-RECEFTNDSPKBN        =   "2"  )
             IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
               MOVE  WK-TOKUTEI-COMPFTN  TO  LNK-SYU-SYUCOMPFTN
             END-IF
           END-IF.
      *
           IF    FLG-ICHIBU-JYOSEI  =   1
               IF   LNK-SYU-KOH-COMPFTN(KOH-IDX)  <  580
                  COMPUTE   WK-KEISAN-JYOSEI              =
                            LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                  COMPUTE   WK-KEISAN-JYOSEI              =
                            WK-KEISAN-JYOSEI              / 10
                  COMPUTE   WK-KEISAN-JYOSEI              =
                            WK-KEISAN-JYOSEI              * 10
                  MOVE  WK-KEISAN-JYOSEI
                              TO  LNK-SYU-JYO-HKNFTNMONEY
                                  LNK-SYU-JYO-COMPFTN
                  MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               ELSE
                  MOVE  580   TO  LNK-SYU-JYO-HKNFTNMONEY
                                  LNK-SYU-JYO-COMPFTN
                  COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                           LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                           580
               END-IF
               IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <  580
                  MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                              TO  LNK-SYU-JYO-COMPFTN-ENTANI
                  MOVE  ZERO  TO
                           LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               ELSE
                  MOVE  580   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                  COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                           LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                           580
               END-IF
               IF  WK-KOH-COMPFTN(KOH-IDX)  =  ALL"9"
                 CONTINUE
               ELSE
                 IF   WK-KOH-COMPFTN(KOH-IDX)  <  580
                    MOVE  ZERO  TO
                             WK-KOH-COMPFTN(KOH-IDX)
                 ELSE
                    COMPUTE  WK-KOH-COMPFTN(KOH-IDX) =
                             WK-KOH-COMPFTN(KOH-IDX) -
                             580
                 END-IF
               END-IF
           END-IF.
      *
           IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND (LNK-SYU-KOH1HKNNUM    NOT =   "027")
             IF    FLG-ICHIBU-JYOSEI  =  1
             AND   KOH-IDX            =  1
               IF  LNK-SYU-SYUCOMPFTN
                         >   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 COMPUTE  WK-KEISAN-JYOSEI             =
                          LNK-SYU-SYUCOMPFTN           +  5
                 COMPUTE  WK-KEISAN-JYOSEI             =
                          WK-KEISAN-JYOSEI             / 10
                 COMPUTE  WK-KEISAN-JYOSEI             =
                          WK-KEISAN-JYOSEI             * 10
                 COMPUTE  WK-KEISAN-JYOSEI2            =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                 COMPUTE  WK-KEISAN-JYOSEI2            =
                          WK-KEISAN-JYOSEI2            / 10
                 COMPUTE  WK-KEISAN-JYOSEI2            =
                          WK-KEISAN-JYOSEI2            * 10
                 COMPUTE  WK-KEISAN-JYOSEI3            =
                          WK-KEISAN-JYOSEI             -
                          WK-KEISAN-JYOSEI2
                 IF WK-KEISAN-JYOSEI3 < LNK-SYU-JYO-COMPFTN
                   MOVE   WK-KEISAN-JYOSEI3
                             TO  LNK-SYU-JYO-HKNFTNMONEY
                                 LNK-SYU-JYO-COMPFTN
                 END-IF
               ELSE
                 MOVE  ZERO  TO  LNK-SYU-JYO-HKNFTNMONEY
                                 LNK-SYU-JYO-COMPFTN
               END-IF
               IF  LNK-SYU-SYUCOMPFTN-ENTANI
                         >   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 COMPUTE  WK-KEISAN-JYOSEI-EN          =
                          LNK-SYU-SYUCOMPFTN-ENTANI    -
                          LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                 IF  WK-KEISAN-JYOSEI-EN
                         <   LNK-SYU-JYO-COMPFTN-ENTANI
                   MOVE   WK-KEISAN-JYOSEI-EN
                             TO  LNK-SYU-JYO-COMPFTN-ENTANI
                 END-IF
               ELSE
                 MOVE  ZERO  TO  LNK-SYU-JYO-COMPFTN-ENTANI
               END-IF
             END-IF
             IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                 >  LNK-SYU-SYUCOMPFTN
               MOVE   LNK-SYU-SYUCOMPFTN  TO
                                LNK-SYU-KOH-COMPFTN(KOH-IDX)
             END-IF
             IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                 >  LNK-SYU-SYUCOMPFTN-ENTANI
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
             IF  WK-KOH-COMPFTN(KOH-IDX)  =  ALL"9"
               CONTINUE
             ELSE
               IF  WK-KOH-COMPFTN(KOH-IDX)
                                 >  LNK-SYU-SYUCOMPFTN-ENTANI
                 MOVE LNK-SYU-SYUCOMPFTN-ENTANI  TO
                                WK-KOH-COMPFTN(KOH-IDX)
               END-IF
             END-IF
           END-IF.
      *
           PERFORM    2308A-KOH-KEISAN2-SKJ-SEC.
      *
           IF    FLG-ICHIBU-JYOSEI  =   2
               IF   LNK-SYU-KOH-COMPFTN(KOH-IDX)  <  580
                  COMPUTE   WK-KEISAN-JYOSEI              =
                            LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
                  COMPUTE   WK-KEISAN-JYOSEI              =
                            WK-KEISAN-JYOSEI              / 10
                  COMPUTE   WK-KEISAN-JYOSEI              =
                            WK-KEISAN-JYOSEI              * 10
                  MOVE  WK-KEISAN-JYOSEI
                              TO  LNK-SYU-JYO-HKNFTNMONEY
                                  LNK-SYU-JYO-COMPFTN
                  MOVE  ZERO  TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
               ELSE
                  MOVE  580   TO  LNK-SYU-JYO-HKNFTNMONEY
                                  LNK-SYU-JYO-COMPFTN
                  COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                           LNK-SYU-KOH-COMPFTN(KOH-IDX) -
                           580
               END-IF
               IF   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  <  580
                  MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                              TO  LNK-SYU-JYO-COMPFTN-ENTANI
                  MOVE  ZERO  TO
                           LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               ELSE
                  MOVE  580   TO  LNK-SYU-JYO-COMPFTN-ENTANI
                  COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                           LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                           580
               END-IF
               IF  WK-KOH-COMPFTN(KOH-IDX)  =  ALL"9"
                 CONTINUE
               ELSE
                 IF   WK-KOH-COMPFTN(KOH-IDX)  <  580
                    MOVE  ZERO  TO
                             WK-KOH-COMPFTN(KOH-IDX)
                 ELSE
                    COMPUTE  WK-KOH-COMPFTN(KOH-IDX) =
                             WK-KOH-COMPFTN(KOH-IDX) -
                             580
                 END-IF
               END-IF
      *
               COMPUTE     LNK-SYU-KOH-COMPTOTAL(KOH-IDX) =
                           LNK-SYU-KOH-COMPFTN(KOH-IDX)
           END-IF.
      *
       2308-KOH-KEISAN2-EXT.
           EXIT.
      *
      ******************************************************************
      *        ·§ËÜ¸©ÃÏÊý¸øÈñ¡Ê£±¡¿£³¡Ë·×»»
      ******************************************************************
       23081-KUMAMOTO-KOHI-SEC           SECTION.
      *
      *    ÉéÃ´¶â³Û¤Î·×»»
      *
           IF     (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND    (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            LNK-SYU-SYUCOMPFTN            +  5
                  COMPUTE   WK-FTN  =  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                    /  10
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =  WK-FTN
                                                          *  10
           ELSE
             IF   (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
             AND  (LNK-SYU-KOH1HKNNUM        =   "027")
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            LNK-SYU-KOH-COMPFTN(1)        +  5
                  COMPUTE   WK-FTN  =  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                    /  10
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =  WK-FTN
                                                          *  10
             ELSE
                  MOVE    ZERO    TO    LNK-SYU-KOH-COMPFTN(KOH-IDX)
             END-IF
           END-IF
      *
           IF     LNK-SYU-KOH-COMPFTN(KOH-IDX)   NOT  =  ZERO
                  MOVE      LNK-SYU-KOH-COMPFTN(KOH-IDX)  TO  WK-FTN
      *
                  COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                            ( WK-FTN  /  3 ) + 0.9
      *
                  COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                            ( WK-FTN  /  3 )
           END-IF
      *
           .
      *
       23081-KUMAMOTO-KOHI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        ·§ËÜ¸©ÃÏÊý¸øÈñ¡Ê£±¡¿£³¡Ë·×»»
      ******************************************************************
       23081-KUMAMOTO-KOHI2-SEC           SECTION.
      *
           PERFORM    23081-KUMAMOTO-KOHI-SEC
      *
           IF  ((KOH-IDX           =   2) AND
                (WK-RUI-TAISYO     =   1))
           OR  ( FLG-KUMAMOTO-CYO  =   1 )
             IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                               > ZAN-KOHI-T3(KOH-IDX)
                MOVE  ZAN-KOHI-T3(KOH-IDX)
                      TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
             IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                               > ZAN-KOHI-T(KOH-IDX)
                MOVE  ZAN-KOHI-T(KOH-IDX)
                      TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
             END-IF
           END-IF
      *
           PERFORM    2308A-KOH-KEISAN2-SKJ-SEC
      *
           .
      *
       23081-KUMAMOTO-KOHI2-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        ·§ËÜ¸©ÃÏÊý¸øÈñ¡Ê£±¡¿£³¡Ë·×»»
      ******************************************************************
       23081-KUMAMOTO-KOHI3-SEC           SECTION.
      *
      *    ÉéÃ´¶â³Û¤Î·×»»
      *
           IF     LNK-SYU-SYUHKNNUM     NOT =   SPACE
             COMPUTE    WK-FUTANWARI =  WK-KOH-FTNRATE  /  100
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        WK-ZENGAKU   *  WK-FUTANWARI
             COMPUTE    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                        WK-ZENGAKU   *  WK-FUTANWARI
      *      ¸º³Û
             MOVE       WK-KOH-FTNRATE   TO   WK-NYUKFTNRATE2
             MOVE       ZERO             TO   FLG-GENGAKU-HENSYU
             PERFORM    2307A-KOH-GENGAKU-HENSYU-SEC
             IF  WK-GENGAKUKBN  NOT =  ZERO
                 MOVE   WK-GENGAKU-GAK
                         TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 MOVE   WK-GENGAKU-GAK-ENTANI
                         TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        LNK-SYU-KOH-COMPFTN(KOH-IDX) +   5
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        LNK-SYU-KOH-COMPFTN(KOH-IDX) /  10
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        LNK-SYU-KOH-COMPFTN(KOH-IDX) *  10
      *
             MOVE       LNK-SYU-KOH-COMPFTN(KOH-IDX)  TO  WK-FTN
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        (WK-FTN  /  3) +  5
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        LNK-SYU-KOH-COMPFTN(KOH-IDX) /  10
             COMPUTE    LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                        LNK-SYU-KOH-COMPFTN(KOH-IDX) *  10
             COMPUTE    LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                        (WK-FTN  /  3 )
      *
             IF  LNK-SYU-KOH-COMPFTN(KOH-IDX) >  ZAN-KOHI-T(KOH-IDX)
                 MOVE   ZAN-KOHI-T(KOH-IDX)
                              TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                 MOVE   1     TO  WK-TAIHI-FTNGAKEN(KOH-IDX)
             END-IF
             IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                              >  ZAN-KOHI-T3(KOH-IDX)
                 MOVE   ZAN-KOHI-T3(KOH-IDX)
                              TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
           ELSE
             MOVE    ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
             MOVE    ZERO   TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           PERFORM    2308A-KOH-KEISAN2-SKJ-SEC
      *
           .
      *
       23081-KUMAMOTO-KOHI3-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÅìµþÅÔÃÏÊý¸øÈñ¥Þ¥ë»Ò·×»»
      ******************************************************************
       23082-TOKYO-KOHI-SEC           SECTION.
      *
           IF      (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
           AND     (LNK-SYU-KOH1HKNNUM    NOT =   "027")
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                          WK-TOKUTEI-COMPFTN  *   2  /  3
                COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                          WK-TOKUTEI-COMPFTN  *   2  /  3
           ELSE
                MOVE   ZERO  TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                MOVE   ZERO  TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
      ***  IF   HKN-RECEFTNDSPKBN   =   "2"
      ***       MOVE   "1"   TO   WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
      ***       IF    WK-TOKUTEI-COMPFTN   NOT =    ZERO
      ***            MOVE  WK-TOKUTEI-COMPFTN
      ***                    TO   LNK-SYU-SYUCOMPFTN
      ***       END-IF
      ***  ELSE
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX) +  5
                COMPUTE   WK-FTN      =
                          LNK-SYU-KOH-COMPFTN(KOH-IDX) /  10
                COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX) =  WK-FTN
                                                       *  10
      ***  END-IF
      *
           IF (FLG-GENBUTU70     NOT =   ZERO)
           OR (FLG-TOKU75-CYO        =    3  )
           OR (FLG-CYOKI-ARI         =    2  )
             IF    FLG-MARUKO  =  2
               COMPUTE WK-MARUKO-FTN = WK-MARUKO-FTN +  5
               COMPUTE WK-MARUKO-FTN = WK-MARUKO-FTN / 10
               COMPUTE WK-MARUKO-FTN = WK-MARUKO-FTN * 10
               IF  ZAN-SYU-M  <=  WK-MARUKO-FTN
                  MOVE   ZAN-SYU-M       TO  WK-MARUKO-XX
               ELSE
                  MOVE   WK-MARUKO-FTN   TO  WK-MARUKO-XX
               END-IF
      *
               COMPUTE WK-MARUKO-COMPFTN   = WK-MARUKO-XX * 2 / 3
               COMPUTE WK-MARUKO-COMPFTN-E = WK-MARUKO-XX * 2 / 3
      *
               COMPUTE WK-MARUKO-COMPFTN = WK-MARUKO-COMPFTN +  5
               COMPUTE WK-MARUKO-COMPFTN = WK-MARUKO-COMPFTN / 10
               COMPUTE WK-MARUKO-COMPFTN = WK-MARUKO-COMPFTN * 10
      *
               IF   WK-MARUKO-COMPFTN    >  WK-MARUKO-M
                  COMPUTE  WK-MARUKO-COMPFTN   =  WK-MARUKO-COMPFTN
                                               -  WK-MARUKO-M
               ELSE
                  MOVE   ZERO  TO   WK-MARUKO-COMPFTN
               END-IF
               IF   WK-MARUKO-COMPFTN-E  >  WK-MARUKO-ME
                  COMPUTE  WK-MARUKO-COMPFTN-E =  WK-MARUKO-COMPFTN-E
                                               -  WK-MARUKO-ME
               ELSE
                  MOVE   ZERO  TO   WK-MARUKO-COMPFTN-E
               END-IF
      *
               IF  WK-MARUKO-COMPFTN  <=  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  MOVE   WK-MARUKO-COMPFTN
                                 TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                  MOVE   WK-MARUKO-COMPFTN-E
                                 TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
               END-IF
             END-IF
           END-IF
      *
           .
      *
       23082-TOKYO-KOHI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        ÆÃ¼ì·×»»¡Ê´µ¼ÔÉéÃ´¤Î£±¡¿£³¤ò½õÀ®¤¹¤ë¡Ë
      ******************************************************************
       23083-JYOSEI-KOHI-SEC           SECTION.
      *
           IF   LNK-SYU-SYUHKNNUM   NOT =  SPACE
              MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                  TO  WK-JYOSEI-KOHIKIN-EN
           ELSE
              MOVE   WK-ZENGAKU   TO  WK-JYOSEI-KOHIKIN-EN
                                      WK-JYOSEI-KOHIKIN-ZENGAKU
           END-IF
           IF   KOH-IDX  >   1
              IF   WK-JYOSEI-KOHIKIN-EN
                             > LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX - 1)
                 MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX - 1)
                                  TO  WK-JYOSEI-KOHIKIN-EN
              END-IF
           END-IF
           COMPUTE WK-JYOSEI-KOHIKIN2 = WK-JYOSEI-KOHIKIN-EN + 0.9
      *
      *    ¿ÇÎÅºÑ¤ßÊ¬¤ò¹ç»»¤·¤Æ·×»»
           COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
                                         + WK-JYOSEI-KOHIKIN-RUI
      *
           COMPUTE  WK-JYOSEI-KOHIKIN                   =
                   (WK-JYOSEI-KOHIKIN-KEI  /  3)        + 0.5
           COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                    WK-JYOSEI-KOHIKIN-KEI               -
                    WK-JYOSEI-KOHIKIN
      *
      *    ¿ÇÎÅºÑ¤ßÊ¬¤òº¹¤·°ú¤¯
           IF     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                          > WK-JYOSEI-KOHIKIN-RUI2
              COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                       LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                       WK-JYOSEI-KOHIKIN-RUI2
           ELSE
              MOVE   ZERO   TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           IF     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                          > ZAN-KOHI-T3(KOH-IDX)
              MOVE   ZAN-KOHI-T3(KOH-IDX)
                            TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
      *****
      *
           IF    HKN-RECEFTNDSPKBN      =  "2"
      *
             MOVE     "1"    TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
      *
      *      ¿ÇÎÅºÑ¤ßÊ¬¤ò¹ç»»¤·¤Æ·×»»
             COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
                                           + WK-JYOSEI-KOHIKIN-RUI
      *
             COMPUTE  WK-JYOSEI-KOHIKIN                   =
                     (WK-JYOSEI-KOHIKIN-KEI  /  3)        + 0.5
             COMPUTE  WK-KOH-COMPFTN(KOH-IDX)             =
                      WK-JYOSEI-KOHIKIN-KEI               -
                      WK-JYOSEI-KOHIKIN
      *
      *      ¿ÇÎÅºÑ¤ßÊ¬¤òº¹¤·°ú¤¯
             IF     WK-KOH-COMPFTN(KOH-IDX) > WK-JYOSEI-KOHIKIN-RUI2
                COMPUTE  WK-KOH-COMPFTN(KOH-IDX)          =
                         WK-KOH-COMPFTN(KOH-IDX)          -
                         WK-JYOSEI-KOHIKIN-RUI2
             ELSE
                MOVE   ZERO   TO   WK-KOH-COMPFTN(KOH-IDX)
             END-IF
      *
             IF     WK-KOH-COMPFTN(KOH-IDX) > ZAN-KOHI-T2(KOH-IDX)
                MOVE   ZAN-KOHI-T2(KOH-IDX)
                              TO   WK-KOH-COMPFTN(KOH-IDX)
             END-IF
      *
           END-IF
      *
      *****
      *
      *    ¿ÇÎÅºÑ¤ßÊ¬¤ò¹ç»»¤·¤Æ·×»»
      **>  COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
      **>                                + WK-JYOSEI-KOHIKIN-RUI
           COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
      *
           COMPUTE  WK-JYOSEI-KOHIKIN                   =
                   (WK-JYOSEI-KOHIKIN-KEI  /  3)        + 0.5
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    WK-JYOSEI-KOHIKIN-KEI               -
                    WK-JYOSEI-KOHIKIN
      *
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        +  5
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        / 10
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        * 10
      *
      *    ¿ÇÎÅºÑ¤ßÊ¬¤òº¹¤·°ú¤¯
      **>  IF     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      **>                                 > WK-JYOSEI-KOHIKIN-RUI3
      **>     COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)     =
      **>              LNK-SYU-KOH-COMPFTN(KOH-IDX)     -
      **>              WK-JYOSEI-KOHIKIN-RUI3
      **>  ELSE
      **>     MOVE   ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
      **>  END-IF
      *
           IF     LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                          > ZAN-KOHI-T(KOH-IDX)
              MOVE   ZAN-KOHI-T(KOH-IDX)
                            TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
           END-IF
      *
      *****
      *
           COMPUTE   ZAN-KOHI-T(KOH-IDX)  =
                     ZAN-KOHI-T(KOH-IDX)  -
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
           IF    ZAN-KOHI-T(KOH-IDX)   NOT =   ZERO
               COMPUTE   ZAN-KOHI-T(KOH-IDX) =
      ***                ZAN-KOHI-T(KOH-IDX)  +  5
                         ZAN-KOHI-T(KOH-IDX)  +  4
               COMPUTE   WK-FTN      =
                         ZAN-KOHI-T(KOH-IDX)  /  10
               COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                         WK-FTN   *  10
           END-IF
      *
      *    ¸øÈñ¤Î¿©»öÊÔ½¸
           PERFORM   23089-KOH-SKJ-HENSYU-SEC
      *
           .
      *
       23083-JYOSEI-KOHI-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        ÆÃ¼ì·×»»¡Ê´µ¼ÔÉéÃ´¤Î£²¡¿£³¤ò½õÀ®¤¹¤ë¡Ë
      ******************************************************************
       23084-JYOSEI-KOHI2-SEC           SECTION.
      *
           IF   LNK-SYU-SYUHKNNUM   NOT =  SPACE
              MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                  TO  WK-JYOSEI-KOHIKIN-EN
           ELSE
              MOVE   WK-ZENGAKU   TO  WK-JYOSEI-KOHIKIN-EN
                                      WK-JYOSEI-KOHIKIN-ZENGAKU
           END-IF
           IF   KOH-IDX  >   1
              IF   WK-JYOSEI-KOHIKIN-EN
                             > LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX - 1)
                 MOVE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX - 1)
                                  TO  WK-JYOSEI-KOHIKIN-EN
              END-IF
           END-IF
           COMPUTE WK-JYOSEI-KOHIKIN2 = WK-JYOSEI-KOHIKIN-EN + 0.9
      *
      *    ¿ÇÎÅºÑ¤ßÊ¬¤ò¹ç»»¤·¤Æ·×»»
           COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
                                         + WK-JYOSEI-KOHIKIN-RUI
      *
           COMPUTE  WK-JYOSEI-KOHIKIN                   =
                   (WK-JYOSEI-KOHIKIN-KEI  /  3)        + 0.9
           COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                    WK-JYOSEI-KOHIKIN
      *
      *    ¿ÇÎÅºÑ¤ßÊ¬¤òº¹¤·°ú¤¯
           IF     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                          > WK-JYOSEI-KOHIKIN-RUI2
              COMPUTE  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) =
                       LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX) -
                       WK-JYOSEI-KOHIKIN-RUI2
           ELSE
              MOVE   ZERO   TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
           IF     LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                          > ZAN-KOHI-T3(KOH-IDX)
              MOVE   ZAN-KOHI-T3(KOH-IDX)
                            TO   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
           END-IF
      *
      *****
      *
           IF    HKN-RECEFTNDSPKBN      =  "2"
      *
             MOVE     "1"    TO    WK-TAIHI-RECEFTNDSPKBN(KOH-IDX)
      *
      *      ¿ÇÎÅºÑ¤ßÊ¬¤ò¹ç»»¤·¤Æ·×»»
             COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
                                           + WK-JYOSEI-KOHIKIN-RUI
      *
             COMPUTE  WK-JYOSEI-KOHIKIN                   =
                     (WK-JYOSEI-KOHIKIN-KEI  /  3)        + 0.9
             COMPUTE  WK-KOH-COMPFTN(KOH-IDX)             =
                      WK-JYOSEI-KOHIKIN
      *
      *      ¿ÇÎÅºÑ¤ßÊ¬¤òº¹¤·°ú¤¯
             IF     WK-KOH-COMPFTN(KOH-IDX) > WK-JYOSEI-KOHIKIN-RUI2
                COMPUTE  WK-KOH-COMPFTN(KOH-IDX)          =
                         WK-KOH-COMPFTN(KOH-IDX)          -
                         WK-JYOSEI-KOHIKIN-RUI2
             ELSE
                MOVE   ZERO   TO   WK-KOH-COMPFTN(KOH-IDX)
             END-IF
      *
             IF     WK-KOH-COMPFTN(KOH-IDX) > ZAN-KOHI-T2(KOH-IDX)
                MOVE   ZAN-KOHI-T2(KOH-IDX)
                              TO   WK-KOH-COMPFTN(KOH-IDX)
             END-IF
      *
           END-IF
      *
      *****
      *
      *    ¿ÇÎÅºÑ¤ßÊ¬¤ò¹ç»»¤·¤Æ·×»»
      **>  COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
      **>                                + WK-JYOSEI-KOHIKIN-RUI
           COMPUTE WK-JYOSEI-KOHIKIN-KEI = WK-JYOSEI-KOHIKIN2
      *
           COMPUTE  WK-JYOSEI-KOHIKIN                   =
                   (WK-JYOSEI-KOHIKIN-KEI  /  3)        + 0.9
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    WK-JYOSEI-KOHIKIN
      *
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        +  5
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        / 10
           COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)        =
                    LNK-SYU-KOH-COMPFTN(KOH-IDX)        * 10
      *
      *    ¿ÇÎÅºÑ¤ßÊ¬¤òº¹¤·°ú¤¯
      **>  IF     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      **>                                 > WK-JYOSEI-KOHIKIN-RUI3
      **>     COMPUTE  LNK-SYU-KOH-COMPFTN(KOH-IDX)     =
      **>              LNK-SYU-KOH-COMPFTN(KOH-IDX)     -
      **>              WK-JYOSEI-KOHIKIN-RUI3
      **>  ELSE
      **>     MOVE   ZERO   TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
      **>  END-IF
      *
           IF     LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                          > ZAN-KOHI-T(KOH-IDX)
              MOVE   ZAN-KOHI-T(KOH-IDX)
                            TO   LNK-SYU-KOH-COMPFTN(KOH-IDX)
           END-IF
      *
      *****
      *
           COMPUTE   ZAN-KOHI-T(KOH-IDX)  =
                     ZAN-KOHI-T(KOH-IDX)  -
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)   =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
           IF    ZAN-KOHI-T(KOH-IDX)   NOT =   ZERO
               COMPUTE   ZAN-KOHI-T(KOH-IDX) =
      ***                ZAN-KOHI-T(KOH-IDX)  +  5
                         ZAN-KOHI-T(KOH-IDX)  +  4
               COMPUTE   WK-FTN      =
                         ZAN-KOHI-T(KOH-IDX)  /  10
               COMPUTE   ZAN-KOHI-T(KOH-IDX) =
                         WK-FTN   *  10
           END-IF
      *
      *    ¸øÈñ¤Î¿©»öÊÔ½¸
           PERFORM   23089-KOH-SKJ-HENSYU-SEC
      *
           .
      *
       23084-JYOSEI-KOHI2-EXT.
           EXIT.                                                        
      *
      ******************************************************************
      *        £±£¹¸¶Çú°ìÈÌ¤ÎÆÃ¼ì·×»»
      ******************************************************************
       23085-GENBAKU-KOHI-SEC           SECTION.
      *
           COMPUTE   WK-FUTANWARI  =  WK-NYUKFTNRATE019  /  100
           COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                     WK-ZENGAKU  *  WK-FUTANWARI
           COMPUTE   LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)  =
                     WK-ZENGAKU  *  WK-FUTANWARI
      *
           COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)  +  5
           COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)  /  10
           COMPUTE   LNK-SYU-KOH-COMPFTN(KOH-IDX)  =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)  *  10
      *
           .
      *
       23085-GENBAKU-KOHI-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñ¤Î¿©»öÊÔ½¸
      ******************************************************************
       23089-KOH-SKJ-HENSYU-SEC           SECTION.
      *
           MOVE  WK-NYUSKJRYYKBN    TO  LNK-SYU-SKJ-FTNKBN(KOH-IDX)
           MOVE  WK-SHOKUJI-NISSU   TO  LNK-SYU-SKJ-NISSU(KOH-IDX)
           MOVE  WK-SHOKUJI-RYOYOHI TO  LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
           EVALUATE   WK-NYUSKJRYYKBN
             WHEN   "1"
             WHEN   "2"
             WHEN   "4"
                 MOVE  WK-SHOKUJI-FTN
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                     LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 IF ((WK-2010-IRYOKEIKBN-N(KOH-IDX)    = "3" OR "4") AND
                     (WK-2010-SKJKEIKBN(KOH-IDX)   NOT = SPACE     ) AND
                     (WK-TAIHI-HANTEIFLG(KOH-IDX)      = ZERO      ) AND
                     (FLG-NYUSKJJYOGAK             NOT = ZERO      ))
                 OR ((WK-2010-IRYOKEIKBN-N(KOH-IDX)    = "3" OR "4") AND
                     (WK-2010-SKJKEIKBN(KOH-IDX)       = SPACE     ) AND
                     (FLG-NYUSKJJYOGAK             NOT = ZERO      ))
                 OR ((WK-2010-IRYOKEIKBN-N(KOH-IDX)    = SPACE     ) AND
                     (FLG-NYUSKJJYOGAK             NOT = ZERO      ))
                   EVALUATE  FLG-NYUSKJJYOGAK
                     WHEN     1
                       IF   LNK-SYU-SKJ-FTN(KOH-IDX)  NOT = ZERO
                         COMPUTE LNK-SYU-SKJ-FTN(KOH-IDX) =
                                 LNK-SYU-SKJ-FTN(KOH-IDX) /  2
                       END-IF
                     WHEN     2
                       IF   LNK-SYU-SKJ-FTN(KOH-IDX)  NOT = ZERO
                         MOVE  ZERO  TO  LNK-SYU-SKJ-FTN(KOH-IDX)
                       END-IF
                     WHEN     3
                       IF   LNK-SYU-SKJ-FTN(KOH-IDX)  NOT = ZERO
                         COMPUTE LNK-SYU-SKJ-FTN(KOH-IDX) =
                                 LNK-SYU-SKJ-FTN(1)       /  2
                       END-IF
                   END-EVALUATE
                   IF   FLG-MIYAGI  NOT  =   ZERO
                     IF   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)  NOT = ZERO
                       COMPUTE LNK-SYU-SKJ-FTN-RECE(KOH-IDX) =
                               LNK-SYU-SKJ-FTN-RECE(KOH-IDX) /  2
                     END-IF
                   END-IF
                 ELSE
                   IF   WK-NYUSKJJYOGAK  NOT =  ZERO
                     COMPUTE WK-NYUSKJJYOGAK2 =
                             WK-NYUSKJJYOGAK  *  WK-SHOKUJI-NISSU
                     IF   LNK-SYU-SKJ-FTN(KOH-IDX)
                                         >   WK-NYUSKJJYOGAK2
                       COMPUTE   LNK-SYU-SKJ-FTN(KOH-IDX) =
                                 LNK-SYU-SKJ-FTN(KOH-IDX) -
                                 WK-NYUSKJJYOGAK2
                     ELSE
                       MOVE    ZERO  TO  LNK-SYU-SKJ-FTN(KOH-IDX)
                     END-IF
                     IF   FLG-MIYAGI  NOT  =  ZERO
                       IF   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                                         >   WK-NYUSKJJYOGAK2
                         COMPUTE   LNK-SYU-SKJ-FTN-RECE(KOH-IDX) =
                                   LNK-SYU-SKJ-FTN-RECE(KOH-IDX) -
                                   WK-NYUSKJJYOGAK2
                       ELSE
                         MOVE  ZERO  TO  LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                       END-IF
                     END-IF
                   END-IF
                 END-IF
                 IF   LNK-SYU-SKJ-FTNKBN(KOH-IDX)  =  "2"
                   IF    LNK-SYU-SKJ-FTN(KOH-IDX)   >
                                        ZAN-KOHI-T(KOH-IDX)
                      MOVE   ZAN-KOHI-T(KOH-IDX)   TO
                                  LNK-SYU-SKJ-FTN(KOH-IDX)
      *                           LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                   END-IF
                   IF    KOH-IDX   >   1
                     EVALUATE  KOH-IDX
                       WHEN      2
                         IF  LNK-SYU-SKJ-FTN(KOH-IDX)
                                         >  LNK-SYU-SKJ-FTN(1)
                           MOVE   LNK-SYU-SKJ-FTN(1)
                                     TO  LNK-SYU-SKJ-FTN(KOH-IDX)
                         END-IF
                       WHEN      3
                         IF  LNK-SYU-SKJ-FTN(KOH-IDX)
                                         >  LNK-SYU-SKJ-FTN(1)
                           MOVE   LNK-SYU-SKJ-FTN(1)
                                     TO  LNK-SYU-SKJ-FTN(KOH-IDX)
                         END-IF
                         IF  LNK-SYU-SKJ-FTN(KOH-IDX)
                                         >  LNK-SYU-SKJ-FTN(2)
                           MOVE   LNK-SYU-SKJ-FTN(2)
                                     TO  LNK-SYU-SKJ-FTN(KOH-IDX)
                         END-IF
                       WHEN      4
                         IF  LNK-SYU-SKJ-FTN(KOH-IDX)
                                         >  LNK-SYU-SKJ-FTN(1)
                           MOVE   LNK-SYU-SKJ-FTN(1)
                                     TO  LNK-SYU-SKJ-FTN(KOH-IDX)
                         END-IF
                         IF  LNK-SYU-SKJ-FTN(KOH-IDX)
                                         >  LNK-SYU-SKJ-FTN(2)
                           MOVE   LNK-SYU-SKJ-FTN(2)
                                     TO  LNK-SYU-SKJ-FTN(KOH-IDX)
                         END-IF
                         IF  LNK-SYU-SKJ-FTN(KOH-IDX)
                                         >  LNK-SYU-SKJ-FTN(3)
                           MOVE   LNK-SYU-SKJ-FTN(3)
                                     TO  LNK-SYU-SKJ-FTN(KOH-IDX)
                         END-IF
                     END-EVALUATE
                   END-IF
                 END-IF
                 IF  (LNK-SYU-SRYYMD(1:6)  >=  "200610"      )
                 AND (LNK-SYU-KOH-HKNNUM(KOH-IDX)
                                            =  "024" OR "079")
                   IF    LNK-SYU-SKJ-FTN(KOH-IDX)   >
                                        ZAN-KOHI-SKJ(KOH-IDX)
                      MOVE   "6"  TO LNK-SYU-SKJ-FTNKBN(KOH-IDX)
                      MOVE   ZAN-KOHI-SKJ(KOH-IDX)   TO
                                  LNK-SYU-SKJ-FTN(KOH-IDX)
      *                           LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                   END-IF
                 END-IF
             WHEN   "3"
                 MOVE  WK-SHOKUJI-FTN
                                TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
             WHEN   "5"
               IF  (WK-2010-IRYOKEIKBN-N(KOH-IDX)    = "3" OR "4")
               AND (WK-2010-SKJKEIKBN(KOH-IDX)   NOT = SPACE     )
               AND (WK-TAIHI-HANTEIFLG(KOH-IDX)      =  1        )
                 MOVE  WK-SHOKUJI-FTN
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                     LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 MOVE  "1"      TO   WK-NYUSKJRYYKBN
                 MOVE  SPACE    TO   WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                 MOVE  WK-NYUSKJRYYKBN
                                TO   LNK-SYU-SKJ-FTNKBN(KOH-IDX)
               ELSE
                 MOVE  WK-SHOKUJI-NISSUS
                                TO   LNK-SYU-SKJ-NISSU(KOH-IDX)
                 MOVE  WK-SHOKUJI-RYOYOHIS
                                TO   LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
                 MOVE  WK-SHOKUJI-FTNS
                                TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 MOVE  WK-SHOKUJI-FTNL
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
               END-IF
             WHEN   "7"
               IF  (WK-2010-IRYOKEIKBN-N(KOH-IDX)    = "3" OR "4")
               AND (WK-2010-SKJKEIKBN(KOH-IDX)   NOT = SPACE     )
               AND (WK-TAIHI-HANTEIFLG(KOH-IDX)      =  1        )
                 MOVE  WK-SHOKUJI-FTN
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                     LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 MOVE  "1"      TO   WK-NYUSKJRYYKBN
                 MOVE  SPACE    TO   WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                 MOVE  WK-NYUSKJRYYKBN
                                TO   LNK-SYU-SKJ-FTNKBN(KOH-IDX)
               ELSE
                 MOVE  WK-SHOKUJI-NISSUS
                                TO   LNK-SYU-SKJ-NISSU(KOH-IDX)
                 MOVE  WK-SHOKUJI-RYOYOHIS
                                TO   LNK-SYU-SKJ-RYOYOHI(KOH-IDX)
                 MOVE  WK-SHOKUJI-FTNS
                                TO   LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 MOVE  WK-SHOKUJI-FTNL
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                 COMPUTE  LNK-SYU-SKJ-FTN(KOH-IDX) =
                          LNK-SYU-SKJ-FTN(KOH-IDX) +
                          (WK-SHOKUJI-FTNS  /  2)
               END-IF
             WHEN   "8"
               IF  (WK-2010-IRYOKEIKBN-N(KOH-IDX)    = "3" OR "4")
               AND (WK-2010-SKJKEIKBN(KOH-IDX)   NOT = SPACE     )
               AND (WK-TAIHI-HANTEIFLG(KOH-IDX)      =  1        )
                 MOVE  WK-SHOKUJI-FTN
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                     LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 MOVE  "1"      TO   WK-NYUSKJRYYKBN
                 MOVE  SPACE    TO   WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                 MOVE  WK-NYUSKJRYYKBN
                                TO   LNK-SYU-SKJ-FTNKBN(KOH-IDX)
               ELSE
                 MOVE  WK-SHOKUJI-NISSU
                                TO   LNK-SYU-SKJ-NISSU(KOH-IDX)
                 COMPUTE  LNK-SYU-SKJ-RYOYOHI(KOH-IDX)  =
                          WK-SHOKUJI-RYOYOHI            -
                          WK-SHOKUJI-RYOYOHIL2
                 COMPUTE  LNK-SYU-SKJ-FTN-RECE(KOH-IDX) =
                          WK-SHOKUJI-FTN                -
                          WK-SHOKUJI-FTNL2
                 MOVE  WK-SHOKUJI-FTNL2
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                 COMPUTE  LNK-SYU-SKJ-FTN(KOH-IDX) =
                          LNK-SYU-SKJ-FTN(KOH-IDX) +
                          (LNK-SYU-SKJ-FTN-RECE(KOH-IDX)  /  2)
               END-IF
             WHEN   "9"
               IF  (WK-2010-IRYOKEIKBN-N(KOH-IDX)    = "3" OR "4")
               AND (WK-2010-SKJKEIKBN(KOH-IDX)   NOT = SPACE     )
               AND (WK-TAIHI-HANTEIFLG(KOH-IDX)      =  1        )
                 MOVE  WK-SHOKUJI-FTN
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
                                     LNK-SYU-SKJ-FTN-RECE(KOH-IDX)
                 MOVE  "1"      TO   WK-NYUSKJRYYKBN
                 MOVE  SPACE    TO   WK-NYUSKJRYYKBN-TOKU(KOH-IDX)
                 MOVE  WK-NYUSKJRYYKBN
                                TO   LNK-SYU-SKJ-FTNKBN(KOH-IDX)
               ELSE
                 MOVE  WK-SHOKUJI-NISSU
                                TO   LNK-SYU-SKJ-NISSU(KOH-IDX)
                 COMPUTE  LNK-SYU-SKJ-RYOYOHI(KOH-IDX)  =
                          WK-SHOKUJI-RYOYOHI            -
                          WK-SHOKUJI-RYOYOHIL2
                 COMPUTE  LNK-SYU-SKJ-FTN-RECE(KOH-IDX) =
                          WK-SHOKUJI-FTN                -
                          WK-SHOKUJI-FTNL2
                 MOVE  WK-SHOKUJI-FTNL2
                                TO   LNK-SYU-SKJ-FTN(KOH-IDX)
               END-IF
           END-EVALUATE
      *
           .
      *
       23089-KOH-SKJ-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñ¤Î´µ¼ÔÉéÃ´¶â³Û·×»»¡Ê¾å¸Â³Û¤Ê¤·¡Ë¤Î¿©»öÅù
      ******************************************************************
       2308A-KOH-KEISAN2-SKJ-SEC           SECTION.
      *
           PERFORM   23075-KOHHI-HIKAKU4-SEC
           PERFORM   23072-KOHHI-HIKAKU-SEC
           IF  WK-KOH-COMPFTN(KOH-IDX)  =  ALL"9"
             CONTINUE
           ELSE
             PERFORM 23073-KOHHI-HIKAKU2-SEC
           END-IF
           COMPUTE   LNK-SYU-KOH-COMPTOTAL(KOH-IDX)  =
                     LNK-SYU-KOH-COMPFTN(KOH-IDX)
      *
      *    ¸øÈñ¤Î¿©»öÊÔ½¸
           PERFORM   23089-KOH-SKJ-HENSYU-SEC
      *
           .
      *
       2308A-KOH-KEISAN2-SKJ-EXT.
           EXIT.
      *
      ******************************************************************
      *        Îß·×¥Ù¡¼¥¹·×»»»þÍÑ
      ******************************************************************
       2308B-RUIKEIYO-HENSYU-SEC           SECTION.
      *
           IF    LNK-SYU-SYUHKNNUM     NOT =   SPACE
             IF  WK-RUI-FTN2-M3-XXX  >=  WK-RUI-COMPFTN-ENTANI
               MOVE     ZERO         TO  WK-ZAN-FTN2-M3-XXX
             ELSE
               COMPUTE  WK-ZAN-FTN2-M3-XXX
                                      =  WK-RUI-COMPFTN-ENTANI -
                                         WK-RUI-FTN2-M3-XXX
             END-IF
             IF  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
                                    > WK-ZAN-FTN2-M3-XXX
               MOVE  WK-ZAN-FTN2-M3-XXX
                           TO  LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX)
             END-IF
             IF  LNK-SYU-KOH-COMPFTN(KOH-IDX)
                                    > ZAN-KOHI-T(KOH-IDX)
               MOVE  ZAN-KOHI-T(KOH-IDX)
                           TO  LNK-SYU-KOH-COMPFTN(KOH-IDX)
             END-IF
           END-IF
      *
           PERFORM    2308A-KOH-KEISAN2-SKJ-SEC
      *
           .
      *
       2308B-RUIKEIYO-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ¸øÈñÃ±°Ì¤Ç·×»»¤·¤¿´µ¼ÔÉéÃ´¶â¤«¤éºÇ¾®¤ÎÃÍ¤òÁªÂò¥»¥Ã¥È
      ******************************************************************
       2309-FTNKIN-HIKAKU-SEC         SECTION.
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE 
               IF   LNK-SYU-KOH1HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH1COMPFTN-ENTANI  >
                                        LNK-SYU-SYUCOMPFTN-ENTANI
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH1HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI  
                                    TO  LNK-SYU-KOH1COMPFTN-ENTANI
                   IF    WK-KOH-COMPFTN(1)     =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)   < "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN-ENTANI  
                                    TO  WK-KOH-COMPFTN(1)
                   END-IF
                   IF    WK-DAY-KOH-COMPFTN(1) =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)   < "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN-ENTANI  
                                    TO  WK-DAY-KOH-COMPFTN(1)
                   END-IF
                 END-IF
               END-IF
               IF   LNK-SYU-KOH2HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH2COMPFTN-ENTANI  >
                                        LNK-SYU-SYUCOMPFTN-ENTANI
                 IF ((LNK-SYU-SRYYMD(1:6)   >= "200804"      ) AND
                     (LNK-SYU-KOH2HKNNUM     = "972" OR "974"))
                 OR ((WK-RUI-TAISYO         =  1   ) AND
                     (WK-2010-KINJYOKBN-N(1)
                                            = "1"  ) AND
                     (FLG-MARUTOARI         =  1   ))
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                    TO  LNK-SYU-KOH2COMPFTN-ENTANI
                   IF    WK-KOH-COMPFTN(2)     =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)   < "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN-ENTANI  
                                    TO  WK-KOH-COMPFTN(2)
                   END-IF
                   IF    WK-DAY-KOH-COMPFTN(2) =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)   < "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN-ENTANI  
                                    TO  WK-DAY-KOH-COMPFTN(2)
                   END-IF
                 END-IF
               END-IF
               IF   LNK-SYU-KOH3HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH3COMPFTN-ENTANI  >
                                        LNK-SYU-SYUCOMPFTN-ENTANI
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH3HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                    TO  LNK-SYU-KOH3COMPFTN-ENTANI
                   IF    WK-KOH-COMPFTN(3)     =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)   < "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN-ENTANI  
                                    TO  WK-KOH-COMPFTN(3)
                   END-IF
                   IF    WK-DAY-KOH-COMPFTN(3) =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)   < "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN-ENTANI  
                                    TO  WK-DAY-KOH-COMPFTN(3)
                   END-IF
                 END-IF
               END-IF
               IF   LNK-SYU-KOH4HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH4COMPFTN-ENTANI  >
                                        LNK-SYU-SYUCOMPFTN-ENTANI
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH4HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                    TO  LNK-SYU-KOH4COMPFTN-ENTANI
                   IF    WK-KOH-COMPFTN(4)     =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)   < "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN-ENTANI  
                                    TO  WK-KOH-COMPFTN(4)
                   END-IF
                   IF    WK-DAY-KOH-COMPFTN(4) =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)   < "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN-ENTANI  
                                    TO  WK-DAY-KOH-COMPFTN(4)
                   END-IF
                 END-IF
               END-IF
           END-IF.
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE 
               IF   LNK-SYU-KOH1HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH1COMPFTN      >     LNK-SYU-SYUCOMPFTN
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH1HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN  TO  LNK-SYU-KOH1COMPFTN
                   MOVE   LNK-SYU-KOH1COMPFTN TO  LNK-SYU-KOH1COMPTOTAL
                   IF    WK-KOH-COMPFTN(1)     =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)  >= "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN  TO  WK-KOH-COMPFTN(1)
                   END-IF
                   IF    WK-DAY-KOH-COMPFTN(1) =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)  >= "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN  TO  WK-DAY-KOH-COMPFTN(1)
                   END-IF
                 END-IF
               END-IF
               IF   LNK-SYU-KOH2HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH2COMPFTN      >     LNK-SYU-SYUCOMPFTN
                 IF ((LNK-SYU-SRYYMD(1:6)   >= "200804"      ) AND
                     (LNK-SYU-KOH2HKNNUM     = "972" OR "974"))
                 OR ((WK-RUI-TAISYO         =  1   ) AND
                     (WK-2010-KINJYOKBN-N(1)
                                            = "1"  ) AND
                     (FLG-MARUTOARI         =  1   ))
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN  TO  LNK-SYU-KOH2COMPFTN
                   MOVE   LNK-SYU-KOH2COMPFTN TO  LNK-SYU-KOH2COMPTOTAL
                   IF    WK-KOH-COMPFTN(2)     =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)  >= "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN  TO  WK-KOH-COMPFTN(2)
                   END-IF
                   IF    WK-DAY-KOH-COMPFTN(2) =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)  >= "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN  TO  WK-DAY-KOH-COMPFTN(2)
                   END-IF
                 END-IF
               END-IF
               IF   LNK-SYU-KOH3HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH3COMPFTN      >     LNK-SYU-SYUCOMPFTN
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH3HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN  TO  LNK-SYU-KOH3COMPFTN
                   MOVE   LNK-SYU-KOH3COMPFTN TO  LNK-SYU-KOH3COMPTOTAL
                   IF    WK-KOH-COMPFTN(3)     =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)  >= "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN  TO  WK-KOH-COMPFTN(3)
                   END-IF
                   IF    WK-DAY-KOH-COMPFTN(3) =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)  >= "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN  TO  WK-DAY-KOH-COMPFTN(3)
                   END-IF
                 END-IF
               END-IF
               IF   LNK-SYU-KOH4HKNNUM   NOT =  SPACE
               AND  LNK-SYU-KOH4COMPFTN      >     LNK-SYU-SYUCOMPFTN
                 IF  (LNK-SYU-SRYYMD(1:6)   >= "200804"      )
                 AND (LNK-SYU-KOH4HKNNUM     = "972" OR "974")
                   CONTINUE
                 ELSE
                   MOVE   LNK-SYU-SYUCOMPFTN  TO  LNK-SYU-KOH4COMPFTN
                   MOVE   LNK-SYU-KOH4COMPFTN TO  LNK-SYU-KOH4COMPTOTAL
                   IF    WK-KOH-COMPFTN(4)     =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)  >= "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN  TO  WK-KOH-COMPFTN(4)
                   END-IF
                   IF    WK-DAY-KOH-COMPFTN(4) =  ALL"9"
                   OR    LNK-SYU-SRYYMD(1:6)  >= "201905"
                     CONTINUE
                   ELSE
                     MOVE LNK-SYU-SYUCOMPFTN  TO  WK-DAY-KOH-COMPFTN(4)
                   END-IF
                 END-IF
               END-IF
           END-IF.
      *
           IF   FLG-GENBUTU70   NOT =   ZERO
              MOVE   LNK-SYU-KOH1COMPFTN   TO   WK-GENBUTU-KOH1COMPFTN
              MOVE   LNK-SYU-KOH2COMPFTN   TO   WK-GENBUTU-KOH2COMPFTN
              MOVE   LNK-SYU-KOH3COMPFTN   TO   WK-GENBUTU-KOH3COMPFTN
              MOVE   LNK-SYU-KOH4COMPFTN   TO   WK-GENBUTU-KOH4COMPFTN
           END-IF.
      *
           IF    WK-RUI-TAISYO  =  1
             IF (COMB-KOH1HKNNUM   = "972" OR "974")
             OR (COMB-KOH2HKNNUM   = "972" OR "974")
             OR (COMB-KOH3HKNNUM   = "972" OR "974")
             OR (COMB-KOH4HKNNUM   = "972" OR "974")
                 PERFORM   23091X-FTNKIN-HIKAKU-CYOKI-SEC
             ELSE
                 PERFORM   23092X-FTNKIN-HIKAKU-TUJYO-SEC
             END-IF
           ELSE
             IF (COMB-KOH1HKNNUM   = "972" OR "974")
             OR (COMB-KOH2HKNNUM   = "972" OR "974")
             OR (COMB-KOH3HKNNUM   = "972" OR "974")
             OR (COMB-KOH4HKNNUM   = "972" OR "974")
                 PERFORM   23091-FTNKIN-HIKAKU-CYOKI-SEC
             ELSE
                 PERFORM   23092-FTNKIN-HIKAKU-TUJYO-SEC
             END-IF
           END-IF.
      *
           IF  ((LNK-SYU-SRYYMD(1:6)   >= "200704") AND
                (COMB-KOH1HKNNUM  = "011" OR "020") AND
                (FLG-SEISINJYO    =   1           ))
           OR  ((LNK-SYU-SRYYMD(1:6)   >= "200604") AND
                (COMB-KOH1HKNNUM  = "021"         ) AND
                (FLG-SEISINJYO    =   1           ))
              MOVE     ZERO     TO    WK-KNJFTNKIN
              MOVE     ZERO     TO    WK-KNJFTNKIN-ENTANI
           END-IF.
      *
           MOVE        ZERO     TO    FLG-HANTEI-ENTANI.
           IF   ((FLG-KOUGAKUCYO-GEN70  =  1           ) OR
                 (FLG-KOUGAKUCYO3       =  1           ))
           AND  ( LNK-SYU-SYUCOMPFTN    =  WK-KNJFTNKIN )
              MOVE     1        TO    FLG-HANTEI-ENTANI
           END-IF.
      *
      *    ¼ýÇ¼¥Æ¡¼¥Ö¥ë¤ÎÀÁµá³Û¤ò¥»¥Ã¥È
           MOVE    WK-KNJFTNKIN             TO  LNK-SYU-SKYMONEY.
      *
      *    ÂçÊ¬¸©ÆýÍÄ»ùÆÃ¼ì·×»»
      *    µÜ¾ë¸©ÆýÍÄ»ùÆÃ¼ì·×»»
      *    ·²ÇÏ¸©ÃÏÊý¸øÈñÆÃ¼ì·×»»
           PERFORM   23095-OITA-TOKUSYU-KEISAN-SEC.
      *
           IF   LNK-SYU-SRYYMD(1:6)       <   "200610"
              MOVE   WK-SHOKUJI-RYOYOHI     TO  WK-SHOKUJI-RYOYOHIS
              MOVE   ZERO                   TO  WK-SHOKUJI-RYOYOHIL
              MOVE   WK-KNJFTNKIN-SKJ       TO  WK-KNJFTNKIN-SKJS
              MOVE   ZERO                   TO  WK-KNJFTNKIN-SKJL
           ELSE
              COMPUTE  WK-KNJFTNKIN-SKJ-KEISAN  =  WK-SHOKUJI-FTNS
                                                +  WK-SHOKUJI-FTNL
              IF     WK-KNJFTNKIN-SKJ  =  ZERO
                MOVE     ZERO       TO  WK-KNJFTNKIN-SKJS
                MOVE     ZERO       TO  WK-KNJFTNKIN-SKJL
              ELSE
                IF   WK-KNJFTNKIN-SKJ   =  WK-KNJFTNKIN-SKJ-KEISAN
                  MOVE   WK-SHOKUJI-FTNS  TO  WK-KNJFTNKIN-SKJS
                  MOVE   WK-SHOKUJI-FTNL  TO  WK-KNJFTNKIN-SKJL
                ELSE
                 IF ((WK-NYUSKJRYYKBN-TOKU(1) =
                                    "1" OR "2" OR "3" OR "4") AND
                     (FLG-HIKAKU-SKJ          =  1          ))
                 OR ((WK-NYUSKJRYYKBN-TOKU(2) =
                                    "1" OR "2" OR "3" OR "4") AND
                     (FLG-HIKAKU-SKJ          =  2          ))
                 OR ((WK-NYUSKJRYYKBN-TOKU(3) =
                                    "1" OR "2" OR "3" OR "4") AND
                     (FLG-HIKAKU-SKJ          =  3          ))
                 OR ((WK-NYUSKJRYYKBN-TOKU(4) =
                                    "1" OR "2" OR "3" OR "4") AND
                     (FLG-HIKAKU-SKJ          =  4          ))
                   IF  (WK-NYUSKJRYYKBN-TOKU(1)  =  "1" OR "4")
                   OR  (WK-NYUSKJRYYKBN-TOKU(2)  =  "1" OR "4")
                   OR  (WK-NYUSKJRYYKBN-TOKU(3)  =  "1" OR "4")
                   OR  (WK-NYUSKJRYYKBN-TOKU(4)  =  "1" OR "4")
                     MOVE ZERO             TO  WK-KNJFTNKIN-SKJS
                     MOVE WK-KNJFTNKIN-SKJ TO  WK-KNJFTNKIN-SKJL
                   END-IF
                   IF  (WK-NYUSKJRYYKBN-TOKU(1)  =  "2")
                   OR  (WK-NYUSKJRYYKBN-TOKU(2)  =  "2")
                   OR  (WK-NYUSKJRYYKBN-TOKU(3)  =  "2")
                   OR  (WK-NYUSKJRYYKBN-TOKU(4)  =  "2")
                     MOVE WK-SHOKUJI-FTNL  TO  WK-KNJFTNKIN-SKJL
                     COMPUTE  WK-KNJFTNKIN-SKJS =  WK-KNJFTNKIN-SKJ
                                                -  WK-SHOKUJI-FTNL
                   END-IF
                   IF  (WK-NYUSKJRYYKBN-TOKU(1)  =  "3")
                   OR  (WK-NYUSKJRYYKBN-TOKU(2)  =  "3")
                   OR  (WK-NYUSKJRYYKBN-TOKU(3)  =  "3")
                   OR  (WK-NYUSKJRYYKBN-TOKU(4)  =  "3")
                     COMPUTE  WK-KNJFTNKIN-SKJS = WK-SHOKUJI-FTNS
                                                / 2
                     COMPUTE  WK-KNJFTNKIN-SKJL =  WK-KNJFTNKIN-SKJ
                                                -  WK-KNJFTNKIN-SKJS
                   END-IF
                 ELSE
                   IF  WK-KNJFTNKIN-SKJ  <  WK-KNJFTNKIN-SKJ-KEISAN
                    EVALUATE    FLG-SEIKATU
                     WHEN   1
                       IF  (FLG-SEIKATUL      =  ZERO           )
                       OR  (WK-KNJFTNKIN-SKJ  <  WK-SHOKUJI-FTNS)
                         MOVE   WK-KNJFTNKIN-SKJ TO  WK-KNJFTNKIN-SKJS
                         MOVE   ZERO             TO  WK-KNJFTNKIN-SKJL
                       ELSE
                         MOVE   WK-SHOKUJI-FTNS  TO  WK-KNJFTNKIN-SKJS
                         COMPUTE  WK-KNJFTNKIN-SKJL =  WK-KNJFTNKIN-SKJ
                                                    -  WK-SHOKUJI-FTNS
                       END-IF
                     WHEN   2
                       IF  (FLG-SEIKATUS      =  ZERO           )
                       OR  (WK-KNJFTNKIN-SKJ  <  WK-SHOKUJI-FTNL)
                         MOVE   WK-KNJFTNKIN-SKJ TO  WK-KNJFTNKIN-SKJL
                         MOVE   ZERO             TO  WK-KNJFTNKIN-SKJS
                       ELSE
                         MOVE   WK-SHOKUJI-FTNL  TO  WK-KNJFTNKIN-SKJL
                         COMPUTE  WK-KNJFTNKIN-SKJS =  WK-KNJFTNKIN-SKJ
                                                    -  WK-SHOKUJI-FTNL
                       END-IF
                    END-EVALUATE
                   END-IF
                 END-IF
                END-IF
              END-IF
           END-IF
      *
           MOVE     ZERO      TO   WK-SKJ-ZEITAISYO.
      *    ¿©»öÎÅÍÜÈñ¡¦¿©»öÉéÃ´³Û¤ò¥»¥Ã¥È
           MOVE    WK-SHOKUJI-RYOYOHIS      TO  LNK-SYU-RYOYOHI-SKJ.
           MOVE    WK-KNJFTNKIN-SKJS        TO  LNK-SYU-SKYMONEY-SKJ.
           IF   (COMB-SYU-HKNKOHSBTKBN  =  "8" OR "9")
             IF  (LNK-SYU-SYUSKJ-FTNKBN  =  "4")
               IF  LNK-SYU-SRYYMD(1:6)   >=  "200704"
                 MOVE  WK-SKJ-ZEIKEI2   TO  LNK-SYU-SKYMONEY-SKJ-TAX
                 COMPUTE  WK-SKJ-ZEITAISYO           =
                          WK-SKJ-ZEITAISYO           +
                          LNK-SYU-SKYMONEY-SKJ       +
                          LNK-SYU-SKYMONEY-SKJ-TAX
               ELSE
                 IF    COMB-HOJOKBN       =  "1"
                   CONTINUE
                 ELSE
                   COMPUTE  LNK-SYU-SKYMONEY-SKJ-TAX   =
                          ( LNK-SYU-SKYMONEY-SKJ  *  WK-S4 ) + WK-S3
                 END-IF
               END-IF
             ELSE
               IF  LNK-SYU-SRYYMD(1:6)   >=  "200704"
                 IF    COMB-HOJOKBN           =  "1"
                 AND   LNK-SYU-SYUSKJ-FTNKBN  =  "1"
                   MOVE  WK-SKJ-ZEIKEI2   TO  LNK-SYU-SKYMONEY-SKJ-TAX
                   COMPUTE  WK-SKJ-ZEITAISYO           =
                            WK-SKJ-ZEITAISYO           +
                            LNK-SYU-SKYMONEY-SKJ       +
                            LNK-SYU-SKYMONEY-SKJ-TAX
                 END-IF
               END-IF
             END-IF
           END-IF.
           COMPUTE  LNK-SYU-SKYMONEY-SKJ-KEI = LNK-SYU-SKYMONEY-SKJ
                                             + LNK-SYU-SKYMONEY-SKJ-TAX.
      *    ¿©»öÎÅÍÜÈñ¡¦¿©»öÉéÃ´³Û¤ò¥»¥Ã¥È¡ÊÀ¸³è¡Ë
           MOVE    WK-SHOKUJI-RYOYOHIL     TO  LNK-SYU-RYOYOHI-LIFE.
           MOVE    WK-KNJFTNKIN-SKJL       TO  LNK-SYU-SKYMONEY-LIFE.
           IF   (COMB-SYU-HKNKOHSBTKBN  =  "8" OR "9")
             IF  (LNK-SYU-SYUSKJ-FTNKBN  =  "4")
               IF  LNK-SYU-SRYYMD(1:6)   >=  "200704"
                 MOVE  WK-SKJ-ZEIKEI2L  TO  LNK-SYU-SKYMONEY-LIFE-TAX
                 COMPUTE  WK-SKJ-ZEITAISYO           =
                          WK-SKJ-ZEITAISYO           +
                          LNK-SYU-SKYMONEY-LIFE      +
                          LNK-SYU-SKYMONEY-LIFE-TAX
               ELSE
                 IF    COMB-HOJOKBN       =  "1"
                   CONTINUE
                 ELSE
                   COMPUTE  LNK-SYU-SKYMONEY-LIFE-TAX   =
                          ( LNK-SYU-SKYMONEY-LIFE  *  WK-S4 ) + WK-S3
                 END-IF
               END-IF
             ELSE
               IF  LNK-SYU-SRYYMD(1:6)   >=  "200704"
                 IF    COMB-HOJOKBN           =  "1"
                 AND   LNK-SYU-SYUSKJ-FTNKBN  =  "1"
                   MOVE  WK-SKJ-ZEIKEI2L  TO  LNK-SYU-SKYMONEY-LIFE-TAX
                   COMPUTE  WK-SKJ-ZEITAISYO           =
                            WK-SKJ-ZEITAISYO           +
                            LNK-SYU-SKYMONEY-LIFE      +
                            LNK-SYU-SKYMONEY-LIFE-TAX
                 END-IF
               END-IF
             END-IF
           END-IF.
           COMPUTE  LNK-SYU-SKYMONEY-LIFE-KEI
                                    = LNK-SYU-SKYMONEY-LIFE
                                    + LNK-SYU-SKYMONEY-LIFE-TAX.
      *
      ******
           IF  (LNK-SYU-SRYYMD(1:6)  >= "201101")
           OR  ((FLG-HIKAKU           =  ZERO) AND
                (FLG-HIKAKU2          =  ZERO) AND
                (FLG-HIKAKU3          =  ZERO) AND
                (FLG-HIKAKU4          =  ZERO)  )
           OR  (LNK-S02-TEIKI-KBN     =  "X"    )
             CONTINUE
           ELSE
             IF  ((FLG-HIKAKU   =  1             ) AND
                  (LNK-SYU-KOH-HKNNUM(1)  = "051"))
             OR  ((FLG-HIKAKU2  =  2             ) AND
                  (LNK-SYU-KOH-HKNNUM(2)  = "051"))
               COMPUTE   WK-FTN   =   LNK-SYU-SKYMONEY  
                                  +   LNK-SYU-SKYMONEY-SKJ-KEI
                                  +   LNK-SYU-SKYMONEY-LIFE-KEI
               COMPUTE   WK-FTN   =   WK-FTN     +   5
               COMPUTE   WK-FTN   =   WK-FTN     /  10
               COMPUTE   WK-FTN   =   WK-FTN     *  10
               IF  ((LNK-SYU-SRYYMD(1:6)   <  "200310"   ) AND
                    (WK-FTN     >=  14000                ))
               OR  ((LNK-SYU-SRYYMD(1:6)   >= "200310"   ) AND
                    (FLG-HIKAKU  =  1                    ) AND
                    (WK-FTN     >=  WK-TAIHI-NYUJGNGAK(1)))
               OR  ((LNK-SYU-SRYYMD(1:6)   >= "200310"   ) AND
                    (FLG-HIKAKU2 =  2                    ) AND
                    (WK-FTN     >=  WK-TAIHI-NYUJGNGAK(2)))
                COMPUTE  LNK-SYU-SKYMONEY  =  LNK-SYU-SKYMONEY    
                                           +  LNK-SYU-SKYMONEY-SKJ-KEI
                                           +  LNK-SYU-SKYMONEY-LIFE-KEI
                MOVE      ZERO            TO  LNK-SYU-SKYMONEY-SKJ
                                              LNK-SYU-SKYMONEY-SKJ-TAX
                                              LNK-SYU-SKYMONEY-SKJ-KEI
                MOVE      ZERO            TO  LNK-SYU-SKYMONEY-LIFE
                                              LNK-SYU-SKYMONEY-LIFE-TAX
                                              LNK-SYU-SKYMONEY-LIFE-KEI
               END-IF
             END-IF
             IF  ((FLG-HIKAKU   =  1                     ) AND
                  (LNK-SYU-KOH-HKNNUM(1) = "015" OR "016") AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200304"      ) AND
                  (LNK-SYU-SRYYMD(1:6)  <  "200604"      ))
             OR  ((FLG-HIKAKU2  =  2                     ) AND
                  (LNK-SYU-KOH-HKNNUM(2) = "015" OR "016") AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200304"      ) AND
                  (LNK-SYU-SRYYMD(1:6)  <  "200604"      ))
             OR  ((FLG-HIKAKU   =  1                     ) AND
                  (LNK-SYU-KOH-HKNNUM(1) = "052"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200504"      ))
             OR  ((FLG-HIKAKU2  =  2                     ) AND
                  (LNK-SYU-KOH-HKNNUM(2) = "052"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200504"      ))
             OR  ((FLG-HIKAKU   =  1                     ) AND
                  (LNK-SYU-KOH-HKNNUM(1) = "151"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200310"      ) AND
                  (WK-1001-PREFNUM       =  13           ))
             OR  ((FLG-HIKAKU2  =  2                     ) AND
                  (LNK-SYU-KOH-HKNNUM(2) = "151"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200310"      ) AND
                  (WK-1001-PREFNUM       =  13           ))
             OR  ((FLG-HIKAKU3  =  3                     ) AND
                  (LNK-SYU-KOH-HKNNUM(3) = "151"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200310"      ) AND
                  (WK-1001-PREFNUM       =  13           ))
             OR  ((FLG-HIKAKU4  =  4                     ) AND
                  (LNK-SYU-KOH-HKNNUM(4) = "151"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200310"      ) AND
                  (WK-1001-PREFNUM       =  13           ))
             OR  ((FLG-HIKAKU   =  1                     ) AND
                  (LNK-SYU-KOH-HKNNUM(1) = "186"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200310"      ) AND
                  (WK-1001-PREFNUM       =  28           ))
             OR  ((FLG-HIKAKU2  =  2                     ) AND
                  (LNK-SYU-KOH-HKNNUM(2) = "186"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200310"      ) AND
                  (WK-1001-PREFNUM       =  28           ))
             OR  ((FLG-HIKAKU3  =  3                     ) AND
                  (LNK-SYU-KOH-HKNNUM(3) = "186"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200310"      ) AND
                  (WK-1001-PREFNUM       =  28           ))
             OR  ((FLG-HIKAKU4  =  4                     ) AND
                  (LNK-SYU-KOH-HKNNUM(4) = "186"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200310"      ) AND
                  (WK-1001-PREFNUM       =  28           ))
             OR  ((FLG-HIKAKU   =  1                     ) AND
                  (LNK-SYU-KOH-HKNNUM(1) = "281"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200702"      ) AND
                  (WK-1001-PREFNUM       =  07           ))
             OR  ((FLG-HIKAKU2  =  2                     ) AND
                  (LNK-SYU-KOH-HKNNUM(2) = "281"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200702"      ) AND
                  (WK-1001-PREFNUM       =  07           ))
             OR  ((FLG-HIKAKU3  =  3                     ) AND
                  (LNK-SYU-KOH-HKNNUM(3) = "281"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200702"      ) AND
                  (WK-1001-PREFNUM       =  07           ))
             OR  ((FLG-HIKAKU4  =  4                     ) AND
                  (LNK-SYU-KOH-HKNNUM(4) = "281"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200702"      ) AND
                  (WK-1001-PREFNUM       =  07           ))
             OR  ((FLG-HIKAKU   =  1                     ) AND
                  (LNK-SYU-KOH-HKNNUM(1) = "183"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200810"      ) AND
                  (WK-1001-PREFNUM       =  01           ))
             OR  ((FLG-HIKAKU2  =  2                     ) AND
                  (LNK-SYU-KOH-HKNNUM(2) = "183"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200810"      ) AND
                  (WK-1001-PREFNUM       =  01           ))
             OR  ((FLG-HIKAKU3  =  3                     ) AND
                  (LNK-SYU-KOH-HKNNUM(3) = "183"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200810"      ) AND
                  (WK-1001-PREFNUM       =  01           ))
             OR  ((FLG-HIKAKU4  =  4                     ) AND
                  (LNK-SYU-KOH-HKNNUM(4) = "183"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200810"      ) AND
                  (WK-1001-PREFNUM       =  01           ))
             OR  ((FLG-HIKAKU   =  1                     ) AND
                  (LNK-SYU-KOH-HKNNUM(1) = "191"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200910"      ) AND
                  (WK-1001-PREFNUM       =  23           ))
             OR  ((FLG-HIKAKU2  =  2                     ) AND
                  (LNK-SYU-KOH-HKNNUM(2) = "191"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200910"      ) AND
                  (WK-1001-PREFNUM       =  23           ))
             OR  ((FLG-HIKAKU3  =  3                     ) AND
                  (LNK-SYU-KOH-HKNNUM(3) = "191"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200910"      ) AND
                  (WK-1001-PREFNUM       =  23           ))
             OR  ((FLG-HIKAKU4  =  4                     ) AND
                  (LNK-SYU-KOH-HKNNUM(4) = "191"         ) AND
                  (LNK-SYU-SRYYMD(1:6)  >= "200910"      ) AND
                  (WK-1001-PREFNUM       =  23           ))
               COMPUTE   WK-FTN   =   LNK-SYU-SKYMONEY  
                                  +   LNK-SYU-SKYMONEY-SKJ-KEI
                                  +   LNK-SYU-SKYMONEY-LIFE-KEI
               COMPUTE   WK-FTN   =   WK-FTN  +   5
               COMPUTE   WK-FTN   =   WK-FTN  /  10
               COMPUTE   WK-FTN   =   WK-FTN  *  10
               IF  ((FLG-HIKAKU   =  1                    ) AND
                    (WK-FTN      >=  WK-TAIHI-NYUJGNGAK(1)))
               OR  ((FLG-HIKAKU2  =  2                    ) AND
                    (WK-FTN      >=  WK-TAIHI-NYUJGNGAK(2)))
               OR  ((FLG-HIKAKU3  =  3                    ) AND
                    (WK-FTN      >=  WK-TAIHI-NYUJGNGAK(3)))
               OR  ((FLG-HIKAKU4  =  4                    ) AND
                    (WK-FTN      >=  WK-TAIHI-NYUJGNGAK(4)))
                COMPUTE  LNK-SYU-SKYMONEY  =  LNK-SYU-SKYMONEY    
                                           +  LNK-SYU-SKYMONEY-SKJ-KEI
                                           +  LNK-SYU-SKYMONEY-LIFE-KEI
                MOVE      ZERO            TO  LNK-SYU-SKYMONEY-SKJ
                                              LNK-SYU-SKYMONEY-SKJ-TAX
                                              LNK-SYU-SKYMONEY-SKJ-KEI
                MOVE      ZERO            TO  LNK-SYU-SKYMONEY-LIFE
                                              LNK-SYU-SKYMONEY-LIFE-TAX
                                              LNK-SYU-SKYMONEY-LIFE-KEI
               END-IF
             END-IF
           END-IF.
      ******
      *
           COMPUTE  LNK-SYU-RYOYOHI-SKJ-JIHI  = WK-SHOKUJI-RYOYOHI95
                                              + WK-SHOKUJI-RYOYOHI96.
           COMPUTE  LNK-SYU-SKYMONEY-SKJ-JIHI = WK-SHOKUJI-FTN95
                                              + WK-SHOKUJI-FTN96.
           IF  LNK-SYU-SRYYMD(1:6)   >=  "200704"
             MOVE  WK-SKJ-ZEIKEI   TO  LNK-SYU-SKYMONEY-SKJ-JIHI-TAX
             IF    WK-SHOKUJI-FTN96   NOT =  ZERO
               COMPUTE  WK-SKJ-ZEITAISYO = WK-SKJ-ZEITAISYO
                                         + WK-SHOKUJI-FTN96
                                         + WK-SKJ-ZEIKEI
             END-IF
           ELSE
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" OR "9" ) AND
                 ( COMB-HOJOKBN           =  "1"        )
               CONTINUE
             ELSE
               COMPUTE  LNK-SYU-SKYMONEY-SKJ-JIHI-TAX  =
                      ( WK-SHOKUJI-FTN96  *  WK-S4 ) + WK-S3
             END-IF
           END-IF.
           COMPUTE  LNK-SYU-SKYMONEY-SKJ-JIHI-KEI
                                      = LNK-SYU-SKYMONEY-SKJ-JIHI
                                      + LNK-SYU-SKYMONEY-SKJ-JIHI-TAX.
      *
           COMPUTE  LNK-SYU-RYOYOHI-LIFE-JIHI  = WK-SHOKUJI-RYOYOHI95L
                                               + WK-SHOKUJI-RYOYOHI96L.
           COMPUTE  LNK-SYU-SKYMONEY-LIFE-JIHI = WK-SHOKUJI-FTN95L
                                               + WK-SHOKUJI-FTN96L.
           IF  LNK-SYU-SRYYMD(1:6)   >=  "200704"
             MOVE  WK-SKJ-ZEIKEIL  TO  LNK-SYU-SKYMONEY-LIFE-JIHI-TAX
             IF    WK-SHOKUJI-FTN96L  NOT =  ZERO
               COMPUTE  WK-SKJ-ZEITAISYO = WK-SKJ-ZEITAISYO
                                         + WK-SHOKUJI-FTN96L
                                         + WK-SKJ-ZEIKEIL
             END-IF
           ELSE
             IF  ( COMB-SYU-HKNKOHSBTKBN  =  "8" OR "9" ) AND
                 ( COMB-HOJOKBN           =  "1"        )
               CONTINUE
             ELSE
               COMPUTE  LNK-SYU-SKYMONEY-LIFE-JIHI-TAX  =
                      ( WK-SHOKUJI-FTN96L  *  WK-S4 ) + WK-S3
             END-IF
           END-IF.
           COMPUTE  LNK-SYU-SKYMONEY-LIFE-JIHI-KEI
                                 = LNK-SYU-SKYMONEY-LIFE-JIHI
                                 + LNK-SYU-SKYMONEY-LIFE-JIHI-TAX.
      *
      *    ¼ýÇ¼¥Æ¡¼¥Ö¥ë¤Î¸øÈñËè¤Î´µ¼ÔÉéÃ´¶â³Û¤ò¥»¥Ã¥È¤¹¤ë
           IF    COMB-KOH1HKNNUM         NOT = SPACE
            IF    COMB-KOH1-NYUJGNKBN     =     "1"
             IF  ( LNK-S02-KOUREI-NYUIN-KBN     =        "1"  )
             AND ( COMB-KOH1HKNNUM              =       "027" )
                  CONTINUE
             ELSE
               IF  (( FLG-KOUGAKUCYO2    NOT =    ZERO ) AND
                    ( FLG-IRYOHI2            =     1   ))
               OR  (( FLG-KOUGAKUCYO5    NOT =    ZERO ) AND
                    ( FLG-IRYOHI5        =   11 OR 12  ))
               OR  (  FLG-KOUGAKUCYO-JIRITU
                                         NOT =    ZERO  )
               OR  (( FLG-KOUGAKUCYO-GEN70K
                                         NOT =    ZERO ) AND
                    ( FLG-IRYOHI70K =
                      1 OR 2 OR 11 OR 12 OR 13 OR 14   ))
               OR  (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                    ( FLG-IRYOHI3X           =     11  ) AND
                    ( FLG-SYOUKAN(1)         =    "1"  ))
               OR  (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                    ( FLG-IRYOHIKG2  =   1 OR 2 OR 3   ) AND
                    ( FLG-SYOUKAN(1)         =    "1"  ))
               OR  (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                    ( FLG-IRYOHIKG2  =   4 OR 5 OR 6   ) AND
                    ( COMB-KOH1HKNNUM        =    "092") AND
                    ( WK-KOHJGNGET-CHECK092(1)  =  1   ))
               OR  (( FLG-KOUGAKUCYO-GEN70
                                         NOT =    ZERO ) AND
                    ( FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10 ) AND
                    ( FLG-SYOUKAN(1)         =    "1"  ))
               OR  (( FLG-KOUGAKUCYO-GEN70
                                         NOT =    ZERO ) AND
                    ( FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12) AND
                    ( COMB-KOH1HKNNUM        =    "092") AND
                    ( WK-KOHJGNGET-CHECK092(1)  =  1   ))
               OR  (  WK-TAIHI-FTNGAKEN(1)   =     1    )
               OR  (  FLG-HANTEI-ENTANI      =     1    )
               OR  (( FLG-KOUGAKUCYO-TOYAMA
                                         NOT =    ZERO  ) AND
                    ( FLG-IRYOHI-TOYAMA      = 11 OR 12 ))
                    MOVE     LNK-SYU-KOH1COMPFTN  TO
                                          LNK-SYU-KOH1HKNFTNMONEY
               ELSE
                    COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =                  
                                    LNK-SYU-KOH1COMPFTN     +   5        
                    COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =                  
                                    LNK-SYU-KOH1HKNFTNMONEY /  10        
                    COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =                  
                                    LNK-SYU-KOH1HKNFTNMONEY *  10        
               END-IF
             END-IF
            ELSE
             IF ((WK-1001-PREFNUM       =  43           ) AND
                 (COMB-KOH1HKNNUM       = "143" OR "342") AND
                 (LNK-SYU-SRYYMD(1:6)  <= "200911"      ))
             OR ((COMB-KOH1HKNNUM       = "970"         ) AND
                 (WK-1001-DAISANKBN     = "2"           ))
             OR ((FLG-KOUGAKUCYO        NOT =  ZERO     ) AND
                 (COMB-KOH1HKNNUM       = "970"         ) AND
                 (WK-1001-DAISANKBN     = "1"           ))
             OR ((FLG-KOUGAKUCYO-GEN70  NOT =  ZERO     ) AND
                 (COMB-KOH1HKNNUM       = "970"         ) AND
                 (WK-1001-DAISANKBN     = "1"           ))
             OR ((FLG-KOUGAKUCYO3       NOT =  ZERO     ) AND
                 (FLG-IRYOHI3X = 11                     ) AND
                 (FLG-SYOUKAN(1)        = "1"           ) AND
                 (LNK-SYU-SRYYMD(1:6)  >= "201708"      ))
             OR ((FLG-KOUGAKUCYO3       NOT =  ZERO     ) AND
                 (FLG-IRYOHIKG2   =   1 OR 2 OR 3       ) AND
                 (FLG-SYOUKAN(1)        = "1"           ))
             OR ((FLG-KOUGAKUCYO3       NOT =  ZERO     ) AND
                 (FLG-IRYOHIKG2   =   4 OR 5 OR 6       ) AND
                 (COMB-KOH1HKNNUM       = "092"         ) AND
                 (WK-KOHJGNGET-CHECK092(1)  =  1        ))
             OR ((FLG-KOUGAKUCYO-GEN70  NOT =  ZERO     ) AND
                 (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10      ) AND
                 (FLG-SYOUKAN(1)        = "1"           ) AND
                 (LNK-SYU-SRYYMD(1:6)  >= "201708"      ))
             OR ((FLG-KOUGAKUCYO-GEN70  NOT =  ZERO     ) AND
                 (FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12     ) AND
                 (COMB-KOH1HKNNUM       = "092"         ) AND
                 (WK-KOHJGNGET-CHECK092(1)  =  1        ))
             OR ( WK-TAIHI-FTNGAKEN(1)  =  1             )
             OR ( FLG-HANTEI-ENTANI     =  1             )
                    MOVE     LNK-SYU-KOH1COMPFTN  TO
                                          LNK-SYU-KOH1HKNFTNMONEY
             ELSE
                    COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =
                                    LNK-SYU-KOH1COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =
                                    LNK-SYU-KOH1HKNFTNMONEY /  10
                    COMPUTE  LNK-SYU-KOH1HKNFTNMONEY  =
                                    LNK-SYU-KOH1HKNFTNMONEY *  10
             END-IF
            END-IF
           END-IF.
           IF    COMB-KOH2HKNNUM         NOT = SPACE
            IF    COMB-KOH2-NYUJGNKBN     =     "1"
               IF  (( WK-RUI-TAISYO          =     1   ) AND
                    ( FLG-KUMAMOTO           =    "1"  ))
               OR  (( FLG-KOUGAKUCYO2    NOT =    ZERO ) AND
                    ( FLG-IRYOHI2            =     2   ))
               OR  (( FLG-KOUGAKUCYO5    NOT =    ZERO ) AND
                    ( FLG-IRYOHI5  =  21 OR 22 OR 23   ))
               OR  (( FLG-KOUGAKUCYO-JIRITU
                                         NOT =    ZERO ) AND
                    ( FLG-SYOUKAN(2)         =    "1"  ))
               OR  (( FLG-KOUGAKUCYO-GEN70K
                                         NOT =    ZERO ) AND
                    ( FLG-IRYOHI70K =  1 OR 2          ) AND
                    ( FLG-SYOUKAN(2)         =    "1"  ))
               OR  (( FLG-KOUGAKUCYO-GEN70K
                                         NOT =    ZERO ) AND
                    ( FLG-IRYOHI70K      =   21 OR 22
                                          OR 23 OR 24  ))
               OR  (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                    ( FLG-IRYOHI3X           =     21  ) AND
                    ( FLG-SYOUKAN(2)         =    "1"  ))
               OR  (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                    ( FLG-IRYOHIKG2  =   4 OR 5 OR 6   ) AND
                    ( COMB-KOH1HKNNUM        =    "092") AND
                    ( WK-KOHJGNGET-CHECK092(1)  =  1   ) AND
                    ( FLG-SYOUKAN(2)         =    "1"  ))
               OR  (( FLG-KOUGAKUCYO-GEN70
                                         NOT =    ZERO ) AND
                    ( FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12) AND
                    ( COMB-KOH1HKNNUM        =    "092") AND
                    ( WK-KOHJGNGET-CHECK092(1)  =  1   ) AND
                    ( FLG-SYOUKAN(2)         =    "1"  ))
               OR  (  WK-TAIHI-FTNGAKEN(2)   =     1    )
               OR  (  FLG-HANTEI-ENTANI      =     1    )
               OR  (( FLG-KOUGAKUCYO-TOYAMA
                                         NOT =    ZERO  ) AND
                    ( FLG-IRYOHI-TOYAMA      = 21 OR 22 ))
                    MOVE     LNK-SYU-KOH2COMPFTN  TO
                                          LNK-SYU-KOH2HKNFTNMONEY
               ELSE
                    COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =                  
                                    LNK-SYU-KOH2COMPFTN     +   5        
                    COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =                  
                                    LNK-SYU-KOH2HKNFTNMONEY /  10        
                    COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =                  
                                    LNK-SYU-KOH2HKNFTNMONEY *  10        
               END-IF
            ELSE
             IF ((WK-1001-PREFNUM       =  43           ) OR
                 (COMB-KOH2HKNNUM       = "143" OR "342") OR
                 (LNK-SYU-SRYYMD(1:6)  <= "200911"      ))
             OR ((FLG-KOUGAKUCYO-JIRITU
                                        NOT =    ZERO   ) AND
                 (FLG-SYOUKAN(2)        = "1"           ) AND
                 (LNK-SYU-SRYYMD(1:6)  >= "201708"      ))
             OR ((FLG-KOUGAKUCYO-GEN70K NOT =    ZERO   ) AND
                 (FLG-IRYOHI70K =  1 OR 2               ) AND
                 (FLG-SYOUKAN(2)        = "1"           ) AND
                 (LNK-SYU-SRYYMD(1:6)  >= "201708"      ))
             OR ((FLG-KOUGAKUCYO3       NOT =    ZERO   ) AND
                 (FLG-IRYOHI3X = 21                     ) AND
                 (FLG-SYOUKAN(2)        = "1"           ) AND
                 (LNK-SYU-SRYYMD(1:6)  >= "201708"      ))
             OR ((FLG-KOUGAKUCYO3       NOT =  ZERO     ) AND
                 (FLG-IRYOHIKG2   =   4 OR 5 OR 6       ) AND
                 (COMB-KOH1HKNNUM       = "092"         ) AND
                 (WK-KOHJGNGET-CHECK092(1)  =  1        ) AND
                 (FLG-SYOUKAN(2)        =     "1"       ))
             OR ((FLG-KOUGAKUCYO-GEN70  NOT =  ZERO     ) AND
                 (FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12     ) AND
                 (COMB-KOH1HKNNUM       = "092"         ) AND
                 (WK-KOHJGNGET-CHECK092(1)  =  1        ) AND
                 (FLG-SYOUKAN(2)        =     "1"       ))
             OR ( WK-TAIHI-FTNGAKEN(2)  =  1             )
             OR ( FLG-HANTEI-ENTANI     =  1             )
                    MOVE     LNK-SYU-KOH2COMPFTN  TO
                                          LNK-SYU-KOH2HKNFTNMONEY
             ELSE
                    COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =
                                    LNK-SYU-KOH2COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =
                                    LNK-SYU-KOH2HKNFTNMONEY /  10
                    COMPUTE  LNK-SYU-KOH2HKNFTNMONEY  =
                                    LNK-SYU-KOH2HKNFTNMONEY *  10
             END-IF
            END-IF
           END-IF.
           IF    COMB-KOH3HKNNUM         NOT = SPACE
            IF    COMB-KOH3-NYUJGNKBN     =     "1"
               IF  (WK-TAIHI-FTNGAKEN(3) = 1)
               OR  (FLG-HANTEI-ENTANI    = 1)
                    MOVE     LNK-SYU-KOH3COMPFTN  TO
                                          LNK-SYU-KOH3HKNFTNMONEY
               ELSE
                    COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =                  
                                    LNK-SYU-KOH3COMPFTN     +   5        
                    COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =                  
                                    LNK-SYU-KOH3HKNFTNMONEY /  10        
                    COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =                  
                                    LNK-SYU-KOH3HKNFTNMONEY *  10        
               END-IF
            ELSE
             IF ((WK-1001-PREFNUM       =  43           ) OR
                 (COMB-KOH3HKNNUM       = "143" OR "342") OR
                 (LNK-SYU-SRYYMD(1:6)  <= "200911"      ))
             OR ( WK-TAIHI-FTNGAKEN(3)  =  1             )
             OR ( FLG-HANTEI-ENTANI     =  1             )
                    MOVE     LNK-SYU-KOH3COMPFTN  TO
                                          LNK-SYU-KOH3HKNFTNMONEY
             ELSE
                    COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =
                                    LNK-SYU-KOH3COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =
                                    LNK-SYU-KOH3HKNFTNMONEY /  10
                    COMPUTE  LNK-SYU-KOH3HKNFTNMONEY  =
                                    LNK-SYU-KOH3HKNFTNMONEY *  10
             END-IF
            END-IF
           END-IF.
           IF    COMB-KOH4HKNNUM         NOT = SPACE
            IF    COMB-KOH4-NYUJGNKBN     =     "1"
               IF  (WK-TAIHI-FTNGAKEN(4) = 1)
               OR  (FLG-HANTEI-ENTANI    = 1)
                    MOVE     LNK-SYU-KOH4COMPFTN  TO
                                          LNK-SYU-KOH4HKNFTNMONEY
               ELSE
                    COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =                  
                                    LNK-SYU-KOH4COMPFTN     +   5        
                    COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =                  
                                    LNK-SYU-KOH4HKNFTNMONEY /  10        
                    COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =                  
                                    LNK-SYU-KOH4HKNFTNMONEY *  10        
               END-IF
            ELSE
             IF ((WK-1001-PREFNUM       =  43           ) OR
                 (COMB-KOH4HKNNUM       = "143" OR "342") OR
                 (LNK-SYU-SRYYMD(1:6)  <= "200911"      ))
             OR ( WK-TAIHI-FTNGAKEN(4)  =  1             )
             OR ( FLG-HANTEI-ENTANI     =  1             )
                    MOVE     LNK-SYU-KOH4COMPFTN  TO
                                          LNK-SYU-KOH4HKNFTNMONEY
             ELSE
                    COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =
                                    LNK-SYU-KOH4COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =
                                    LNK-SYU-KOH4HKNFTNMONEY /  10
                    COMPUTE  LNK-SYU-KOH4HKNFTNMONEY  =
                                    LNK-SYU-KOH4HKNFTNMONEY *  10
             END-IF
            END-IF
           END-IF.
      *
      *    ¥ì¥»µ­ºÜ¶â³ÛÂàÈòÍÑ¥¨¥ê¥¢¤«¤é¼ýÇ¼¹àÌÜ¤ØÊÔ½¸
      *
           IF    COMB-KOH1HKNNUM         NOT = SPACE
             IF    WK-KOH-COMPFTN(1)  =  ALL"9"                           
                IF   WK-TAIHI-RECEFTNDSPKBN(1) = SPACE
                AND  COMB-KOH1HKNNUM       NOT = "027"
                  IF (( FLG-KOUGAKUCYO2    NOT =    ZERO ) AND
                      ( FLG-IRYOHI2            =     1   ))
                  OR (( FLG-KOUGAKUCYO5    NOT =    ZERO ) AND
                      ( FLG-IRYOHI5        =   11 OR 12  ))
                  OR (  FLG-KOUGAKUCYO-JIRITU
                                           NOT =    ZERO  )
                  OR (( FLG-KOUGAKUCYO-GEN70K
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70K =
                        1 OR 2 OR 11 OR 12 OR 13 OR 14   ))
                  OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHI3X           =     11  ) AND
                      ( FLG-SYOUKAN(1)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHIKG2  =   1 OR 2 OR 3   ) AND
                      ( FLG-SYOUKAN(1)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHIKG2  =   4 OR 5 OR 6   ) AND
                      ( COMB-KOH1HKNNUM        =    "092") AND
                      ( WK-KOHJGNGET-CHECK092(1)  =  1   ))
                  OR (( FLG-KOUGAKUCYO-GEN70
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10 ) AND
                      ( FLG-SYOUKAN(1)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO-GEN70
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12) AND
                      ( COMB-KOH1HKNNUM        =    "092") AND
                      ( WK-KOHJGNGET-CHECK092(1)  =  1   ))
                  OR (( FLG-KOUGAKUCYO     NOT =    ZERO ) AND
                      ( COMB-KOH1HKNNUM        =   "970" ) AND
                      ( WK-1001-DAISANKBN      =    "1"  ))
                  OR (( FLG-KOUGAKUCYO-GEN70
                                           NOT =    ZERO ) AND
                      ( COMB-KOH1HKNNUM        =   "970" ) AND
                      ( WK-1001-DAISANKBN      =    "1"  ))
                  OR (  WK-TAIHI-FTNGAKEN(1)   =     1    )
                  OR (  FLG-HANTEI-ENTANI      =     1    )
                  OR (( FLG-KOUGAKUCYO-TOYAMA
                                           NOT =    ZERO  ) AND
                      ( FLG-IRYOHI-TOYAMA      = 11 OR 12 ))
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH1COMPTOTAL   =
                             LNK-SYU-KOH1COMPFTN
                  END-IF
                END-IF
             ELSE                                                         
                MOVE  WK-KOH-COMPFTN(1)  TO   LNK-SYU-KOH1COMPFTN       
                COMPUTE   LNK-SYU-KOH1COMPTOTAL   =
                          LNK-SYU-KOH1COMPFTN     
             END-IF                                                      
             IF    WK-DAY-KOH-COMPFTN(1)  =  ALL"9"
                IF   WK-TAIHI-RECEFTNDSPKBN(1) = SPACE
                AND  COMB-KOH1HKNNUM       NOT = "027"
                  IF (( FLG-KOUGAKUCYO2    NOT =    ZERO ) AND
                      ( FLG-IRYOHI2            =     1   ))
                  OR (( FLG-KOUGAKUCYO5    NOT =    ZERO ) AND
                      ( FLG-IRYOHI5        =   11 OR 12  ))
                  OR (  FLG-KOUGAKUCYO-JIRITU
                                           NOT =    ZERO  )
                  OR (( FLG-KOUGAKUCYO-GEN70K
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70K =
                        1 OR 2 OR 11 OR 12 OR 13 OR 14   ))
                  OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHI3X           =     11  ) AND
                      ( FLG-SYOUKAN(1)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHIKG2  =   1 OR 2 OR 3   ) AND
                      ( FLG-SYOUKAN(1)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHIKG2  =   4 OR 5 OR 6   ) AND
                      ( COMB-KOH1HKNNUM        =    "092") AND
                      ( WK-KOHJGNGET-CHECK092(1)  =  1   ))
                  OR (( FLG-KOUGAKUCYO-GEN70
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10 ) AND
                      ( FLG-SYOUKAN(1)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO-GEN70
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12) AND
                      ( COMB-KOH1HKNNUM        =    "092") AND
                      ( WK-KOHJGNGET-CHECK092(1)  =  1   ))
                  OR (( FLG-KOUGAKUCYO     NOT =    ZERO ) AND
                      ( COMB-KOH1HKNNUM        =   "970" ) AND
                      ( WK-1001-DAISANKBN      =    "1"  ))
                  OR (( FLG-KOUGAKUCYO-GEN70
                                           NOT =    ZERO ) AND
                      ( COMB-KOH1HKNNUM        =   "970" ) AND
                      ( WK-1001-DAISANKBN      =    "1"  ))
                  OR (  WK-TAIHI-FTNGAKEN(1)   =     1    )
                  OR (  FLG-HANTEI-ENTANI      =     1    )
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH1COMPTOTAL   =
                             LNK-SYU-KOH1COMPFTN
                  END-IF
                END-IF
             ELSE                                                         
                IF   WK-TAIHI-RECEFTNDSPKBN(1) = SPACE
                  IF    FLG-HANTEI-ENTANI      =  1
                    MOVE     WK-DAY-KOH-COMPFTN(1)
                                         TO   LNK-SYU-KOH1COMPFTN
                    COMPUTE  LNK-SYU-KOH1COMPTOTAL   =
                             LNK-SYU-KOH1COMPFTN
                  ELSE
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    WK-DAY-KOH-COMPFTN(1)   +   5
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH1COMPFTN  =
                                    LNK-SYU-KOH1COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH1COMPTOTAL   =
                             LNK-SYU-KOH1COMPFTN
                  END-IF
                ELSE
                    MOVE     WK-DAY-KOH-COMPFTN(1)
                                         TO   LNK-SYU-KOH1COMPFTN
                    COMPUTE  LNK-SYU-KOH1COMPTOTAL   =
                             LNK-SYU-KOH1COMPFTN
                END-IF
             END-IF
           END-IF.
      *
           IF    COMB-KOH2HKNNUM         NOT = SPACE
             IF    WK-KOH-COMPFTN(2)  =  ALL"9"                           
                IF   WK-TAIHI-RECEFTNDSPKBN(2) = SPACE
                  IF (( FLG-KOUGAKUCYO2    NOT =    ZERO ) AND
                      ( FLG-IRYOHI2            =     2   ))
                  OR (( FLG-KOUGAKUCYO5    NOT =    ZERO ) AND
                      ( FLG-IRYOHI5  =  21 OR 22 OR 23   ))
                  OR (( FLG-KOUGAKUCYO-JIRITU
                                           NOT =    ZERO ) AND
                      ( FLG-SYOUKAN(2)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO-GEN70K
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70K =  1 OR 2          ) AND
                      ( FLG-SYOUKAN(2)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO-GEN70K
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70K      =   21 OR 22
                                            OR 23 OR 24  ))
                  OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHI3X           =     21  ) AND
                      ( FLG-SYOUKAN(2)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHIKG2  =   4 OR 5 OR 6   ) AND
                      ( COMB-KOH1HKNNUM        =    "092") AND
                      ( WK-KOHJGNGET-CHECK092(1)  =  1   ) AND
                      ( FLG-SYOUKAN(2)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO-GEN70
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12) AND
                      ( COMB-KOH1HKNNUM        =    "092") AND
                      ( WK-KOHJGNGET-CHECK092(1)  =  1   ) AND
                      ( FLG-SYOUKAN(2)         =    "1"  ))
                  OR (  WK-TAIHI-FTNGAKEN(2)   =     1    )
                  OR (  FLG-HANTEI-ENTANI      =     1    )
                  OR (( FLG-KOUGAKUCYO-TOYAMA
                                           NOT =    ZERO  ) AND
                      ( FLG-IRYOHI-TOYAMA      = 21 OR 22 ))
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH2COMPTOTAL   =
                             LNK-SYU-KOH2COMPFTN
                  END-IF
                END-IF
             ELSE                                                         
                MOVE  WK-KOH-COMPFTN(2)  TO   LNK-SYU-KOH2COMPFTN       
                COMPUTE   LNK-SYU-KOH2COMPTOTAL   =
                          LNK-SYU-KOH2COMPFTN     
             END-IF                                                      
             IF    WK-DAY-KOH-COMPFTN(2)  =  ALL"9"
                IF   WK-TAIHI-RECEFTNDSPKBN(2) = SPACE
                  IF (( FLG-KOUGAKUCYO2    NOT =    ZERO ) AND
                      ( FLG-IRYOHI2            =     2   ))
                  OR (( FLG-KOUGAKUCYO5    NOT =    ZERO ) AND
                      ( FLG-IRYOHI5  =  21 OR 22 OR 23   ))
                  OR (( FLG-KOUGAKUCYO-JIRITU
                                           NOT =    ZERO ) AND
                      ( FLG-SYOUKAN(2)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO-GEN70K
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70K =  1 OR 2          ) AND
                      ( FLG-SYOUKAN(2)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO-GEN70K
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70K      =   21 OR 22
                                            OR 23 OR 24  ))
                  OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHI3X           =     21  ) AND
                      ( FLG-SYOUKAN(2)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO3    NOT =    ZERO ) AND
                      ( FLG-IRYOHIKG2  =   4 OR 5 OR 6   ) AND
                      ( COMB-KOH1HKNNUM        =    "092") AND
                      ( WK-KOHJGNGET-CHECK092(1)  =  1   ) AND
                      ( FLG-SYOUKAN(2)         =    "1"  ))
                  OR (( FLG-KOUGAKUCYO-GEN70
                                           NOT =    ZERO ) AND
                      ( FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12) AND
                      ( COMB-KOH1HKNNUM        =    "092") AND
                      ( WK-KOHJGNGET-CHECK092(1)  =  1   ) AND
                      ( FLG-SYOUKAN(2)         =    "1"  ))
                  OR (  WK-TAIHI-FTNGAKEN(2)   =     1    )
                  OR (  FLG-HANTEI-ENTANI      =     1    )
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH2COMPTOTAL   =
                             LNK-SYU-KOH2COMPFTN
                  END-IF
                END-IF
             ELSE                                                         
                IF   WK-TAIHI-RECEFTNDSPKBN(2) = SPACE
                  IF    FLG-HANTEI-ENTANI      =  1
                    MOVE     WK-DAY-KOH-COMPFTN(2)
                                         TO   LNK-SYU-KOH2COMPFTN
                    COMPUTE  LNK-SYU-KOH2COMPTOTAL   =
                             LNK-SYU-KOH2COMPFTN
                  ELSE
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    WK-DAY-KOH-COMPFTN(2)   +   5
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH2COMPFTN  =
                                    LNK-SYU-KOH2COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH2COMPTOTAL   =
                             LNK-SYU-KOH2COMPFTN
                  END-IF
                ELSE
                    MOVE     WK-DAY-KOH-COMPFTN(2)
                                         TO   LNK-SYU-KOH2COMPFTN
                    COMPUTE  LNK-SYU-KOH2COMPTOTAL   =
                             LNK-SYU-KOH2COMPFTN
                END-IF
             END-IF
           END-IF.
      *
           IF    COMB-KOH3HKNNUM         NOT = SPACE
             IF    WK-KOH-COMPFTN(3)  =  ALL"9"                           
                IF   WK-TAIHI-RECEFTNDSPKBN(3) = SPACE
                  IF (WK-TAIHI-FTNGAKEN(3) = 1)
                  OR (FLG-HANTEI-ENTANI    = 1)
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH3COMPTOTAL   =
                             LNK-SYU-KOH3COMPFTN
                  END-IF
                END-IF
             ELSE                                                         
                MOVE  WK-KOH-COMPFTN(3)  TO   LNK-SYU-KOH3COMPFTN       
                COMPUTE   LNK-SYU-KOH3COMPTOTAL   =
                          LNK-SYU-KOH3COMPFTN     
             END-IF                                                      
             IF    WK-DAY-KOH-COMPFTN(3)  =  ALL"9"
                IF   WK-TAIHI-RECEFTNDSPKBN(3) = SPACE
                  IF (WK-TAIHI-FTNGAKEN(3) = 1)
                  OR (FLG-HANTEI-ENTANI    = 1)
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH3COMPTOTAL   =
                             LNK-SYU-KOH3COMPFTN
                  END-IF
                END-IF
             ELSE                                                         
                IF   WK-TAIHI-RECEFTNDSPKBN(3) = SPACE
                  IF    FLG-HANTEI-ENTANI      =  1
                    MOVE     WK-DAY-KOH-COMPFTN(3)
                                         TO   LNK-SYU-KOH3COMPFTN
                    COMPUTE  LNK-SYU-KOH3COMPTOTAL   =
                             LNK-SYU-KOH3COMPFTN
                  ELSE
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    WK-DAY-KOH-COMPFTN(3)   +   5
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH3COMPFTN  =
                                    LNK-SYU-KOH3COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH3COMPTOTAL   =
                             LNK-SYU-KOH3COMPFTN
                  END-IF
                ELSE
                    MOVE     WK-DAY-KOH-COMPFTN(3)
                                         TO   LNK-SYU-KOH3COMPFTN
                    COMPUTE  LNK-SYU-KOH3COMPTOTAL   =
                             LNK-SYU-KOH3COMPFTN
                END-IF
             END-IF
           END-IF.
      *
           IF    COMB-KOH4HKNNUM         NOT = SPACE
             IF    WK-KOH-COMPFTN(4)  =  ALL"9"                           
                IF   WK-TAIHI-RECEFTNDSPKBN(4) = SPACE
                  IF (WK-TAIHI-FTNGAKEN(4) = 1)
                  OR (FLG-HANTEI-ENTANI    = 1)
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH4COMPTOTAL   =
                             LNK-SYU-KOH4COMPFTN
                  END-IF
                END-IF
             ELSE                                                         
                MOVE  WK-KOH-COMPFTN(4)  TO   LNK-SYU-KOH4COMPFTN       
                COMPUTE   LNK-SYU-KOH4COMPTOTAL   =
                          LNK-SYU-KOH4COMPFTN     
             END-IF                                                      
             IF    WK-DAY-KOH-COMPFTN(4)  =  ALL"9"
                IF   WK-TAIHI-RECEFTNDSPKBN(4) = SPACE
                  IF (WK-TAIHI-FTNGAKEN(4) = 1)
                  OR (FLG-HANTEI-ENTANI    = 1)
                    CONTINUE
                  ELSE
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     +   5
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH4COMPTOTAL   =
                             LNK-SYU-KOH4COMPFTN
                  END-IF
                END-IF
             ELSE                                                         
                IF   WK-TAIHI-RECEFTNDSPKBN(4) = SPACE
                  IF    FLG-HANTEI-ENTANI      =  1
                    MOVE     WK-DAY-KOH-COMPFTN(4)
                                         TO   LNK-SYU-KOH4COMPFTN
                    COMPUTE  LNK-SYU-KOH4COMPTOTAL   =
                             LNK-SYU-KOH4COMPFTN
                  ELSE
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    WK-DAY-KOH-COMPFTN(4)   +   5
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     /  10
                    COMPUTE  LNK-SYU-KOH4COMPFTN  =
                                    LNK-SYU-KOH4COMPFTN     *  10
                    COMPUTE  LNK-SYU-KOH4COMPTOTAL   =
                             LNK-SYU-KOH4COMPFTN
                  END-IF
                ELSE
                    MOVE     WK-DAY-KOH-COMPFTN(4)
                                         TO   LNK-SYU-KOH4COMPFTN
                    COMPUTE  LNK-SYU-KOH4COMPTOTAL   =
                             LNK-SYU-KOH4COMPFTN
                END-IF
             END-IF
           END-IF.
      *
      *    ÆÃ¼ì·×»»ÍÑ¶â³ÛÂàÈòÊÔ½¸
           PERFORM   23093-TOKUSYU-HENSYU-SEC.
      *
      *    ¼çÊÝ¸±¡¦Ï·¿ÍÊÝ¸±¤Î¶â³ÛÃÖ¤­´¹¤¨
           IF   COMB-HKNNUM            NOT =   SPACE
           AND  LNK-SYU-SYUCOMPFTN     NOT =    ZERO
           AND  FLG-KOUGAKUCYO         NOT =     1
           AND  FLG-KOUGAKUCYO3        NOT =     1
           AND  FLG-KOUGAKUCYO-ININ    NOT =     1
           AND  COMB-SYU-HKNKOHSBTKBN  NOT =    "8"
           AND  FLG-KOUGAKUCYO-GEN70   NOT =     1
           AND  COMB-SYU-HKNKOHSBTKBN  NOT =    "9"
      *
             IF  (COMB-KOH1HKNNUM       = "970")
             AND (WK-1001-DAISANKBN     = "2"  )
                 CONTINUE
             ELSE
                 COMPUTE   LNK-SYU-SYUCOMPFTN  =
                           LNK-SYU-SYUCOMPFTN  +  5
                 COMPUTE   WK-FTN      =
                           LNK-SYU-SYUCOMPFTN  / 10
                 COMPUTE   LNK-SYU-SYUCOMPFTN  =
                           WK-FTN   *  10
                 COMPUTE   LNK-SYU-SYUCOMPTOTAL =
                           LNK-SYU-SYUCOMPFTN
             END-IF
      *
           END-IF.
      *
           IF   COMB-KOH1HKNNUM            =   "027"
           AND  LNK-SYU-KOH1COMPFTN    NOT =    ZERO
           AND  FLG-KOUGAKUCYO         NOT =     1  
           AND  FLG-KOUGAKUCYO3        NOT =     1  
      *
                 COMPUTE   LNK-SYU-KOH1COMPFTN  =
                           LNK-SYU-KOH1COMPFTN  +  5
                 COMPUTE   WK-FTN      =
                           LNK-SYU-KOH1COMPFTN  / 10
                 COMPUTE   LNK-SYU-KOH1COMPFTN  =
                           WK-FTN   *  10
                 COMPUTE   LNK-SYU-KOH1COMPTOTAL =
                           LNK-SYU-KOH1COMPFTN
      *
           END-IF.
      *
      *    £´£±Ï·¿ÍÍÑ
           IF   FLG-KOUGAKUCYO2         =    1
              IF  ((FLG-IRYOHI2 = 1) AND (FLG-HIKAKU  = 1))
              OR  ((FLG-IRYOHI2 = 2) AND (FLG-HIKAKU2 = 2))
                  CONTINUE
              ELSE
                  MOVE    ZERO     TO    FLG-KOUGAKUCYO2
              END-IF
           END-IF.
           IF   FLG-KOUGAKUCYO-JIRITU   =    1
              IF ( FLG-HIKAKU      =    1  )
              OR ((FLG-SYOUKAN(2)  =   "1") AND
                  (FLG-HIKAKU2     =    2 ))
                  CONTINUE
              ELSE
                  MOVE     ZERO      TO    FLG-KOUGAKUCYO-JIRITU
              END-IF
           END-IF.
      *
           IF   FLG-KOUGAKUCYO3         =    1
           AND  FLG-HANTEI-ENTANI       =   ZERO
              IF ((FLG-IRYOHI3X    =   11         ) AND
                  (FLG-SYOUKAN(1)  =  "1"         ) AND
                  (FLG-HIKAKU      =   1          ))
              OR ((FLG-IRYOHI3X    =   21         ) AND
                  (FLG-SYOUKAN(2)  =  "1"         ) AND
                  (FLG-HIKAKU2     =   2          ))
              OR ((FLG-IRYOHIKG2   =   1 OR 2 OR 3) AND
                  (FLG-SYOUKAN(1)  =  "1"         ) AND
                  (FLG-HIKAKU      =   1          ))
              OR ((FLG-IRYOHIKG2   =   4 OR 5 OR 6) AND
                  (COMB-KOH1HKNNUM =  "092"       ) AND
                  (WK-KOHJGNGET-CHECK092(1)  =  1 ) AND
                  (FLG-HIKAKU      =   1          ))
              OR ((FLG-IRYOHIKG2   =   4 OR 5 OR 6) AND
                  (COMB-KOH1HKNNUM =  "092"       ) AND
                  (WK-KOHJGNGET-CHECK092(1)  =  1 ) AND
                  (FLG-SYOUKAN(2)  =  "1"         ) AND
                  (FLG-HIKAKU2     =   2          ))
                  CONTINUE
              ELSE
                  MOVE    ZERO     TO    FLG-KOUGAKUCYO3
              END-IF
           END-IF.
      *
           IF   FLG-KOUGAKUCYO5         =    1
              IF ((FLG-IRYOHI5 = 11 OR 12      ) AND (FLG-HIKAKU  = 1))
              OR ((FLG-IRYOHI5 = 21 OR 22 OR 23) AND (FLG-HIKAKU2 = 2))
                  CONTINUE
              ELSE
                  MOVE    ZERO     TO    FLG-KOUGAKUCYO5
              END-IF
           END-IF.
      *
           IF   FLG-KOUGAKUCYO-GEN70    =    1
           AND  FLG-HANTEI-ENTANI       =   ZERO
              EVALUATE  FLG-IRYOHI70
                WHEN      1
                WHEN      2
                WHEN      7
                WHEN      8
                    CONTINUE
                WHEN      3
                WHEN      4
                WHEN      9
                WHEN     10
                  IF  (FLG-SYOUKAN(1) =    "1")
                  AND (FLG-HIKAKU     =     1 )
                    CONTINUE
                  ELSE
                    MOVE    ZERO   TO    FLG-KOUGAKUCYO-GEN70
                  END-IF
                WHEN      5
                WHEN      6
                WHEN     11
                WHEN     12
                  IF  ((COMB-KOH1HKNNUM           = "092") AND
                       (WK-KOHJGNGET-CHECK092(1)  =  1   ) AND
                       (FLG-HIKAKU                =  1   ))
                  OR  ((COMB-KOH1HKNNUM           = "092") AND
                       (WK-KOHJGNGET-CHECK092(1)  =  1   ) AND
                       (FLG-SYOUKAN(2)            = "1"  ) AND
                       (FLG-HIKAKU2               =  2   ))
                    CONTINUE
                  ELSE
                    MOVE    ZERO   TO    FLG-KOUGAKUCYO-GEN70
                  END-IF
              END-EVALUATE
           END-IF.
           IF   FLG-KOUGAKUCYO-GEN70K   =    1
               IF ((FLG-IRYOHI70K   =    1 OR  2 OR 11 OR 12
                                                 OR 13 OR 14) AND
                   (FLG-HIKAKU      =    1                  ))
               OR ((FLG-IRYOHI70K   =   21 OR 22 OR 23 OR 24) AND
                   (FLG-HIKAKU2     =    2                  ))
               OR ((FLG-IRYOHI70K   =    1 OR  2            ) AND
                   (FLG-SYOUKAN(2)  =   "1"                 ) AND
                   (FLG-HIKAKU2     =    2                  ))
                    CONTINUE
               ELSE
                    MOVE    ZERO   TO    FLG-KOUGAKUCYO-GEN70K
               END-IF
           END-IF.
      *
           MOVE       ZERO         TO    FLG-FTNGAKEN.
           IF   WK-TAIHI-FTNGAKEN(1)    =    1
               IF   FLG-HIKAKU     =     1
                    MOVE    1      TO    FLG-FTNGAKEN
               END-IF
           END-IF.
           IF   WK-TAIHI-FTNGAKEN(2)    =    1
               IF   FLG-HIKAKU2    =     2
                    MOVE    1      TO    FLG-FTNGAKEN
               END-IF
           END-IF.
           IF   WK-TAIHI-FTNGAKEN(3)    =    1
               IF   FLG-HIKAKU3    =     3
                    MOVE    1      TO    FLG-FTNGAKEN
               END-IF
           END-IF.
           IF   WK-TAIHI-FTNGAKEN(4)    =    1
               IF   FLG-HIKAKU4    =     4
                    MOVE    1      TO    FLG-FTNGAKEN
               END-IF
           END-IF.
      *
           IF   LNK-SYU-KOH1HKNNUM      =   "970"
             IF   WK-1001-DAISANKBN  = "2"
                    MOVE    1      TO    FLG-FTNGAKEN
             END-IF
           END-IF.
      *
           IF   FLG-KOUGAKUCYO-TOYAMA   =    1
             IF ((FLG-IRYOHI-TOYAMA  = 11 OR 12) AND (FLG-HIKAKU  = 1))
             OR ((FLG-IRYOHI-TOYAMA  = 21 OR 22) AND (FLG-HIKAKU2 = 2))
               CONTINUE
             ELSE
               MOVE     ZERO       TO    FLG-KOUGAKUCYO-TOYAMA
             END-IF
           END-IF.
      *
      *    ÆüÊÌ¥Ç¡¼¥¿ÃÖ¤­´¹¤¨ÊÔ½¸½èÍý
           PERFORM   23094-DAYDATA-OKIKAE-HENSYU-SEC.
      *
      *    ¸½ÊªµëÉÕ¤Ë´Ø¤¹¤ëÂÐ¾Ý¥Ç¡¼¥¿¥Õ¥é¥°ÊÔ½¸
           PERFORM   23096-GENBUTU-TAISYODATA-SEC.
      *
       2309-FTNKIN-HIKAKU-EXT.
           EXIT.
      *
      ******************************************************************
      *        Ä¹´üÊ»ÍÑ»þ
      ******************************************************************
       23091-FTNKIN-HIKAKU-CYOKI-SEC         SECTION.
      *
      *    ÀÁµá³ÛÈæ³Ó
           MOVE    ZERO               TO    WK-KEISAN-ENTANI
                                            WK-KEISAN1-ENTANI
                                            WK-KEISAN2-ENTANI
                                            WK-KEISAN3-ENTANI
                                            WK-KEISAN4-ENTANI
                                            WK-KEISAN9-ENTANI
      *
           MOVE    ZERO               TO    WK-KNJFTNKIN-ENTANI
      *
      *    ¸øÈñ£±¤Î¤ß
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                            TO   WK-KEISAN9-ENTANI
                                                 WK-KNJFTNKIN-ENTANI
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN9-ENTANI
                                                 WK-KNJFTNKIN-ENTANI
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN1-ENTANI
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN2-ENTANI
               IF    WK-KEISAN1-ENTANI  <  WK-KEISAN2-ENTANI
                   MOVE    WK-KEISAN1-ENTANI  TO  WK-KEISAN9-ENTANI
                                                  WK-KNJFTNKIN-ENTANI
               ELSE
                   MOVE    WK-KEISAN2-ENTANI  TO  WK-KEISAN9-ENTANI
                                                  WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³¤È¸øÈñ£´
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN1-ENTANI
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN2-ENTANI
               MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                            TO   WK-KEISAN3-ENTANI
               IF    WK-KEISAN1-ENTANI  <  WK-KEISAN2-ENTANI
                   IF    WK-KEISAN1-ENTANI  <  WK-KEISAN3-ENTANI
                      MOVE    WK-KEISAN1-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   ELSE
                      MOVE    WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   END-IF
               ELSE
                   IF    WK-KEISAN2-ENTANI  <  WK-KEISAN3-ENTANI
                      MOVE    WK-KEISAN2-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   ELSE
                      MOVE    WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   END-IF
               END-IF
           END-IF
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE 
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                            TO   WK-KEISAN-ENTANI
               IF   WK-KEISAN-ENTANI  <  WK-KEISAN9-ENTANI
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                  TO   WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *
           IF    WK-CYOKI-ZAN-ENTANI  <  WK-KNJFTNKIN-ENTANI
               MOVE   WK-CYOKI-ZAN-ENTANI   TO   WK-KNJFTNKIN-ENTANI
           END-IF
      *
      *********************
      *
      *    ÀÁµá³ÛÈæ³Ó
           MOVE    ZERO               TO    WK-KEISAN
                                            WK-KEISAN1
                                            WK-KEISAN2
                                            WK-KEISAN3
                                            WK-KEISAN4
                                            WK-KEISAN9
           MOVE    ZERO               TO    WK-KEISAN-SKJ
                                            WK-KEISAN1-SKJ
                                            WK-KEISAN2-SKJ
                                            WK-KEISAN3-SKJ
                                            WK-KEISAN4-SKJ
                                            WK-KEISAN9-SKJ
      *
           MOVE    ZERO               TO    FLG-HIKAKU
           MOVE    ZERO               TO    FLG-HIKAKU2
           MOVE    ZERO               TO    FLG-HIKAKU3
           MOVE    ZERO               TO    FLG-HIKAKU4
           MOVE    ZERO               TO    FLG-HIKAKU-SKJ
      *
           MOVE    ZERO               TO    WK-KNJFTNKIN
                                            WK-KNJFTNKIN-SKJ
      *
      *    ¸øÈñ£±¤Î¤ß
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-SYUCOMPFTN      TO   WK-KEISAN9
                                                   WK-KNJFTNKIN
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN9-SKJ
                                                   WK-KNJFTNKIN-SKJ 
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   1                       TO   FLG-HIKAKU
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN9
                                                   WK-KNJFTNKIN
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   MOVE    1                  TO   FLG-HIKAKU-SKJ
                   MOVE    WK-KEISAN1-SKJ     TO   WK-KEISAN9-SKJ
                                                   WK-KNJFTNKIN-SKJ
               ELSE
                   MOVE    2                  TO   FLG-HIKAKU-SKJ
                   MOVE    WK-KEISAN2-SKJ     TO   WK-KEISAN9-SKJ
                                                   WK-KNJFTNKIN-SKJ
               END-IF
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
      **       MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN1
      **       MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   LNK-SYU-KOH3SKJ-FTN     TO   WK-KEISAN3-SKJ
               MOVE   1                       TO   FLG-HIKAKU
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH2COMPFTN =  WK-KNJFTNKIN
                   MOVE    2                  TO   FLG-HIKAKU2
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU
                   MOVE    2                  TO   FLG-HIKAKU2
                 END-IF
                 MOVE   LNK-SYU-KOH2COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               MOVE     WK-KNJFTNKIN          TO   WK-KEISAN9
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   IF    WK-KEISAN1-SKJ  <  WK-KEISAN3-SKJ
                      MOVE    1               TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN1-SKJ  TO  WK-KEISAN9-SKJ
                                                  WK-KNJFTNKIN-SKJ
                   ELSE
                      MOVE    3               TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN3-SKJ  TO  WK-KEISAN9-SKJ
                                                  WK-KNJFTNKIN-SKJ 
                   END-IF
               ELSE
                   IF    WK-KEISAN2-SKJ  <  WK-KEISAN3-SKJ
                      MOVE    2               TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN2-SKJ  TO  WK-KEISAN9-SKJ
                                                  WK-KNJFTNKIN-SKJ 
                   ELSE
                      MOVE    3               TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN3-SKJ  TO  WK-KEISAN9-SKJ
                                                  WK-KNJFTNKIN-SKJ 
                   END-IF
               END-IF
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³¤È¸øÈñ£´
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
      **       MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN1
      **       MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
      **       MOVE   LNK-SYU-KOH3COMPFTN     TO   WK-KEISAN3
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   LNK-SYU-KOH3SKJ-FTN     TO   WK-KEISAN3-SKJ
               MOVE   LNK-SYU-KOH4SKJ-FTN     TO   WK-KEISAN4-SKJ
               MOVE   1                       TO   FLG-HIKAKU
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH2COMPFTN =  WK-KNJFTNKIN
                   MOVE    2                  TO   FLG-HIKAKU2
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU
                   MOVE    2                  TO   FLG-HIKAKU2
                 END-IF
                 MOVE   LNK-SYU-KOH2COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH3COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH3COMPFTN =  WK-KNJFTNKIN
                   MOVE    3                  TO   FLG-HIKAKU3
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU
                   MOVE   ZERO                TO   FLG-HIKAKU2
                   MOVE    3                  TO   FLG-HIKAKU3
                 END-IF
                 MOVE   LNK-SYU-KOH3COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               MOVE     WK-KNJFTNKIN          TO   WK-KEISAN9
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   IF    WK-KEISAN1-SKJ  <  WK-KEISAN3-SKJ
                      IF    WK-KEISAN1-SKJ  <  WK-KEISAN4-SKJ
                        MOVE    1               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN1-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE    4               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-SKJ  <  WK-KEISAN4-SKJ
                        MOVE    3               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN3-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE    4               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      END-IF
                   END-IF
               ELSE
                   IF    WK-KEISAN2-SKJ  <  WK-KEISAN3-SKJ
                      IF    WK-KEISAN2-SKJ  <  WK-KEISAN4-SKJ
                        MOVE    2               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN2-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE    4               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-SKJ  <  WK-KEISAN4-SKJ
                        MOVE    3               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN3-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE    4               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ 
                      END-IF
                   END-IF
               END-IF
           END-IF
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE 
               MOVE   LNK-SYU-SYUCOMPFTN      TO   WK-KEISAN
               MOVE   LNK-SYU-SYUSKJ-FTN      TO   WK-KEISAN-SKJ
               IF   WK-KEISAN  <  WK-KEISAN9
                   MOVE    ZERO                 TO   FLG-HIKAKU
                   MOVE    ZERO                 TO   FLG-HIKAKU2
                   MOVE    ZERO                 TO   FLG-HIKAKU3
                   MOVE    LNK-SYU-SYUCOMPFTN   TO   WK-KNJFTNKIN
               END-IF
               IF   WK-KEISAN-SKJ  <  WK-KEISAN9-SKJ
                   MOVE    ZERO                 TO   FLG-HIKAKU-SKJ
                   MOVE    LNK-SYU-SYUSKJ-FTN   TO   WK-KNJFTNKIN-SKJ 
               END-IF
           END-IF
      *
           IF    WK-CYOKI-ZAN  <  WK-KNJFTNKIN
               MOVE     ZERO            TO     FLG-HIKAKU
               MOVE     ZERO            TO     FLG-HIKAKU2
               MOVE     ZERO            TO     FLG-HIKAKU3
               MOVE     WK-CYOKI-ZAN    TO     WK-KNJFTNKIN
           END-IF
      *
           .
      *
       23091-FTNKIN-HIKAKU-CYOKI-EXT.
           EXIT.
      *
      ******************************************************************
      *        Ä¹´üÊ»ÍÑ»þ°Ê³°
      ******************************************************************
       23092-FTNKIN-HIKAKU-TUJYO-SEC         SECTION.
      *
      *    ÀÁµá³ÛÈæ³Ó
           MOVE    ZERO               TO    WK-KEISAN-ENTANI
                                            WK-KEISAN1-ENTANI
                                            WK-KEISAN2-ENTANI
                                            WK-KEISAN3-ENTANI
                                            WK-KEISAN4-ENTANI
                                            WK-KEISAN9-ENTANI
      *
           MOVE    ZERO               TO    WK-KNJFTNKIN-ENTANI
      *
      *    ¼çÊÝ¸±¤Î¤ß
           IF (COMB-KOH1HKNNUM              =    SPACE)    AND
              (COMB-KOH2HKNNUM              =    SPACE)    AND
              (COMB-KOH3HKNNUM              =    SPACE)    AND
              (COMB-KOH4HKNNUM              =    SPACE)
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                            TO   WK-KEISAN9-ENTANI
                                                 WK-KNJFTNKIN-ENTANI
           END-IF
      *    ¸øÈñ£±¤Î¤ß
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN9-ENTANI
                                                 WK-KNJFTNKIN-ENTANI
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN1-ENTANI
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN2-ENTANI
               IF    WK-KEISAN1-ENTANI  <  WK-KEISAN2-ENTANI
                   MOVE    WK-KEISAN1-ENTANI  TO  WK-KEISAN9-ENTANI
                                                  WK-KNJFTNKIN-ENTANI
               ELSE
                   MOVE    WK-KEISAN2-ENTANI  TO  WK-KEISAN9-ENTANI
                                                  WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN1-ENTANI
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN2-ENTANI
               MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                            TO   WK-KEISAN3-ENTANI
               IF    WK-KEISAN1-ENTANI  <  WK-KEISAN2-ENTANI
                   IF    WK-KEISAN1-ENTANI  <  WK-KEISAN3-ENTANI
                      MOVE    WK-KEISAN1-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   ELSE
                      MOVE    WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   END-IF
               ELSE
                   IF    WK-KEISAN2-ENTANI  <  WK-KEISAN3-ENTANI
                      MOVE    WK-KEISAN2-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   ELSE
                      MOVE    WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   END-IF
               END-IF
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³¤È¸øÈñ£´
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE   LNK-SYU-KOH1COMPFTN-ENTANI
                                            TO   WK-KEISAN1-ENTANI
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN2-ENTANI
               MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                            TO   WK-KEISAN3-ENTANI
               MOVE   LNK-SYU-KOH4COMPFTN-ENTANI
                                            TO   WK-KEISAN4-ENTANI
               IF    WK-KEISAN1-ENTANI  <  WK-KEISAN2-ENTANI
                   IF    WK-KEISAN1-ENTANI  <  WK-KEISAN3-ENTANI
                      IF    WK-KEISAN1-ENTANI  <  WK-KEISAN4-ENTANI
                        MOVE  WK-KEISAN1-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      ELSE
                        MOVE  WK-KEISAN4-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-ENTANI  <  WK-KEISAN4-ENTANI
                        MOVE  WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      ELSE
                        MOVE  WK-KEISAN4-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      END-IF
                   END-IF
               ELSE
                   IF    WK-KEISAN2-ENTANI  <  WK-KEISAN3-ENTANI
                      IF    WK-KEISAN2-ENTANI  <  WK-KEISAN4-ENTANI
                        MOVE  WK-KEISAN2-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      ELSE
                        MOVE  WK-KEISAN4-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-ENTANI  <  WK-KEISAN4-ENTANI
                        MOVE  WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      ELSE
                        MOVE  WK-KEISAN4-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                      END-IF
                   END-IF
               END-IF
           END-IF
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE 
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                            TO   WK-KEISAN-ENTANI
               IF   WK-KEISAN-ENTANI  <  WK-KEISAN9-ENTANI
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                  TO   WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *
      *********************
      *
      *    ÀÁµá³ÛÈæ³Ó
           MOVE    ZERO               TO    WK-KEISAN
                                            WK-KEISAN1
                                            WK-KEISAN2
                                            WK-KEISAN3
                                            WK-KEISAN4
                                            WK-KEISAN9
           MOVE    ZERO               TO    WK-KEISAN-SKJ
                                            WK-KEISAN1-SKJ
                                            WK-KEISAN2-SKJ
                                            WK-KEISAN3-SKJ
                                            WK-KEISAN4-SKJ
                                            WK-KEISAN9-SKJ
      *
           MOVE    ZERO               TO    FLG-HIKAKU
           MOVE    ZERO               TO    FLG-HIKAKU2
           MOVE    ZERO               TO    FLG-HIKAKU3
           MOVE    ZERO               TO    FLG-HIKAKU4
           MOVE    ZERO               TO    FLG-HIKAKU-SKJ
      *
           MOVE    ZERO               TO    WK-KNJFTNKIN
                                            WK-KNJFTNKIN-SKJ
      *    ¼çÊÝ¸±¤Î¤ß
           IF (COMB-KOH1HKNNUM              =    SPACE)    AND
              (COMB-KOH2HKNNUM              =    SPACE)    AND
              (COMB-KOH3HKNNUM              =    SPACE)    AND
              (COMB-KOH4HKNNUM              =    SPACE)
               MOVE   LNK-SYU-SYUCOMPFTN      TO   WK-KEISAN9
                                                   WK-KNJFTNKIN
               MOVE   LNK-SYU-SYUSKJ-FTN      TO   WK-KEISAN9-SKJ
                                                   WK-KNJFTNKIN-SKJ 
           END-IF
      *    ¸øÈñ£±¤Î¤ß
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              =     SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   1                       TO   FLG-HIKAKU
               MOVE   1                       TO   FLG-HIKAKU-SKJ
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN9
                                                   WK-KNJFTNKIN
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN9-SKJ
                                                   WK-KNJFTNKIN-SKJ 
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
      **       MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN1
      **       MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   1                       TO   FLG-HIKAKU
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH2COMPFTN =  WK-KNJFTNKIN
                   MOVE    2                  TO   FLG-HIKAKU2
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU
                   MOVE    2                  TO   FLG-HIKAKU2
                 END-IF
                 MOVE   LNK-SYU-KOH2COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               MOVE     WK-KNJFTNKIN          TO   WK-KEISAN9
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   MOVE      1                     TO  FLG-HIKAKU-SKJ
                   MOVE    WK-KEISAN1-SKJ          TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ
               ELSE
                   MOVE      2                     TO  FLG-HIKAKU-SKJ
                   MOVE    WK-KEISAN2-SKJ          TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ
               END-IF
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
      **       MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN1
      **       MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
      **       MOVE   LNK-SYU-KOH3COMPFTN     TO   WK-KEISAN3
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   LNK-SYU-KOH3SKJ-FTN     TO   WK-KEISAN3-SKJ
               MOVE   1                       TO   FLG-HIKAKU
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH2COMPFTN =  WK-KNJFTNKIN
                   MOVE    2                  TO   FLG-HIKAKU2
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU
                   MOVE    2                  TO   FLG-HIKAKU2
                 END-IF
                 MOVE   LNK-SYU-KOH2COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH3COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH3COMPFTN =  WK-KNJFTNKIN
                   MOVE    3                  TO   FLG-HIKAKU3
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU
                   MOVE   ZERO                TO   FLG-HIKAKU2
                   MOVE    3                  TO   FLG-HIKAKU3
                 END-IF
                 MOVE   LNK-SYU-KOH3COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               MOVE     WK-KNJFTNKIN          TO   WK-KEISAN9
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   IF    WK-KEISAN1-SKJ  <  WK-KEISAN3-SKJ
                      MOVE      1                  TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN1-SKJ       TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ
                   ELSE
                      MOVE      3                  TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN3-SKJ       TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ 
                   END-IF
               ELSE
                   IF    WK-KEISAN2-SKJ  <  WK-KEISAN3-SKJ
                      MOVE      2                  TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN2-SKJ       TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ 
                   ELSE
                      MOVE      3                  TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN3-SKJ       TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ 
                   END-IF
               END-IF
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³¤È¸øÈñ£´
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
      **       MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KEISAN1
      **       MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
      **       MOVE   LNK-SYU-KOH3COMPFTN     TO   WK-KEISAN3
      **       MOVE   LNK-SYU-KOH4COMPFTN     TO   WK-KEISAN4
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   LNK-SYU-KOH3SKJ-FTN     TO   WK-KEISAN3-SKJ
               MOVE   LNK-SYU-KOH4SKJ-FTN     TO   WK-KEISAN4-SKJ
               MOVE   1                       TO   FLG-HIKAKU
               MOVE   LNK-SYU-KOH1COMPFTN     TO   WK-KNJFTNKIN
               IF  LNK-SYU-KOH2COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH2COMPFTN =  WK-KNJFTNKIN
                   MOVE    2                  TO   FLG-HIKAKU2
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU
                   MOVE    2                  TO   FLG-HIKAKU2
                 END-IF
                 MOVE   LNK-SYU-KOH2COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH3COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH3COMPFTN =  WK-KNJFTNKIN
                   MOVE    3                  TO   FLG-HIKAKU3
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU
                   MOVE   ZERO                TO   FLG-HIKAKU2
                   MOVE    3                  TO   FLG-HIKAKU3
                 END-IF
                 MOVE   LNK-SYU-KOH3COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH4COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH4COMPFTN =  WK-KNJFTNKIN
                   MOVE    4                  TO   FLG-HIKAKU4
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU
                   MOVE   ZERO                TO   FLG-HIKAKU2
                   MOVE   ZERO                TO   FLG-HIKAKU3
                   MOVE    4                  TO   FLG-HIKAKU4
                 END-IF
                 MOVE   LNK-SYU-KOH4COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               MOVE     WK-KNJFTNKIN          TO   WK-KEISAN9
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   IF    WK-KEISAN1-SKJ  <  WK-KEISAN3-SKJ
                      IF    WK-KEISAN1-SKJ  <  WK-KEISAN4-SKJ
                        MOVE      1                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN1-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-SKJ  <  WK-KEISAN4-SKJ
                        MOVE      3                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN3-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      END-IF
                   END-IF
               ELSE
                   IF    WK-KEISAN2-SKJ  <  WK-KEISAN3-SKJ
                      IF    WK-KEISAN2-SKJ  <  WK-KEISAN4-SKJ
                        MOVE      2                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN2-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-SKJ  <  WK-KEISAN4-SKJ
                        MOVE      3                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN3-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      END-IF
                   END-IF
               END-IF
           END-IF
      *
           IF   COMB-KOH1HKNNUM        NOT   =   "027" 
           AND  COMB-HKNNUM            NOT   =   SPACE 
               MOVE   LNK-SYU-SYUCOMPFTN      TO   WK-KEISAN
               MOVE   LNK-SYU-SYUSKJ-FTN      TO   WK-KEISAN-SKJ
               IF   WK-KEISAN  <  WK-KEISAN9
                   MOVE    ZERO                 TO   FLG-HIKAKU
                   MOVE    ZERO                 TO   FLG-HIKAKU2
                   MOVE    ZERO                 TO   FLG-HIKAKU3
                   MOVE    ZERO                 TO   FLG-HIKAKU4
                   MOVE    LNK-SYU-SYUCOMPFTN   TO   WK-KNJFTNKIN
               END-IF
               IF   WK-KEISAN-SKJ  <  WK-KEISAN9-SKJ
                   MOVE    ZERO                 TO   FLG-HIKAKU-SKJ
                   MOVE    LNK-SYU-SYUSKJ-FTN   TO   WK-KNJFTNKIN-SKJ 
               END-IF
           END-IF
      *
           .
      *
       23092-FTNKIN-HIKAKU-TUJYO-EXT.
           EXIT.
      *
      ******************************************************************
      *        Ä¹´üÊ»ÍÑ»þ¡ÊÎß·×¥Ù¡¼¥¹·×»»ÍÑ¡Ë
      ******************************************************************
       23091X-FTNKIN-HIKAKU-CYOKI-SEC         SECTION.
      *
      *    ÀÁµá³ÛÈæ³Ó
           MOVE    ZERO               TO    WK-KEISAN-ENTANI
                                            WK-KEISAN1-ENTANI
                                            WK-KEISAN2-ENTANI
                                            WK-KEISAN3-ENTANI
                                            WK-KEISAN4-ENTANI
                                            WK-KEISAN9-ENTANI
      *
           MOVE    ZERO               TO    WK-KNJFTNKIN-ENTANI
      *
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                          TO  WK-KEISAN9-ENTANI
                                              WK-KNJFTNKIN-ENTANI
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³¤È¸øÈñ£´
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                      TO    WK-KEISAN2-ENTANI
               MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                      TO    WK-KEISAN3-ENTANI
               IF    WK-KEISAN2-ENTANI  <  WK-KEISAN3-ENTANI
                 MOVE  WK-KEISAN2-ENTANI  TO  WK-KEISAN9-ENTANI
                                              WK-KNJFTNKIN-ENTANI
               ELSE
                 MOVE  WK-KEISAN3-ENTANI  TO  WK-KEISAN9-ENTANI
                                              WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *
           IF  (WK-2010-KINJYOKBN-N(1) = "1")
           AND (FLG-MARUTOARI          =  1 )
             CONTINUE
           ELSE
             IF   COMB-KOH1HKNNUM        NOT   =   "027"
             AND  COMB-HKNNUM            NOT   =   SPACE
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                      TO    WK-KEISAN-ENTANI
               IF   WK-KEISAN-ENTANI  <  WK-KEISAN9-ENTANI
                 MOVE  LNK-SYU-SYUCOMPFTN-ENTANI
                                          TO  WK-KNJFTNKIN-ENTANI
               END-IF
             END-IF
           END-IF
      *
           IF   WK-CYOKI-ZAN-ENTANI  <  WK-KNJFTNKIN-ENTANI
               MOVE   WK-CYOKI-ZAN-ENTANI TO  WK-KNJFTNKIN-ENTANI
           END-IF
      *
      *********************
      *
      *    ÀÁµá³ÛÈæ³Ó
           MOVE    ZERO               TO    WK-KEISAN
                                            WK-KEISAN1
                                            WK-KEISAN2
                                            WK-KEISAN3
                                            WK-KEISAN4
                                            WK-KEISAN9
           MOVE    ZERO               TO    WK-KEISAN-SKJ
                                            WK-KEISAN1-SKJ
                                            WK-KEISAN2-SKJ
                                            WK-KEISAN3-SKJ
                                            WK-KEISAN4-SKJ
                                            WK-KEISAN9-SKJ
      *
           MOVE    ZERO               TO    FLG-HIKAKU
           MOVE    ZERO               TO    FLG-HIKAKU2
           MOVE    ZERO               TO    FLG-HIKAKU3
           MOVE    ZERO               TO    FLG-HIKAKU4
           MOVE    ZERO               TO    FLG-HIKAKU-SKJ
      *
           MOVE    ZERO               TO    WK-KNJFTNKIN
                                            WK-KNJFTNKIN-SKJ
      *
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   2                       TO   FLG-HIKAKU2
               MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN9
                                                   WK-KNJFTNKIN
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   LNK-SYU-KOH3SKJ-FTN     TO   WK-KEISAN3-SKJ
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   IF    WK-KEISAN1-SKJ  <  WK-KEISAN3-SKJ
                      MOVE    1               TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN1-SKJ  TO  WK-KEISAN9-SKJ
                                                  WK-KNJFTNKIN-SKJ
                   ELSE
                      MOVE    3               TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN3-SKJ  TO  WK-KEISAN9-SKJ
                                                  WK-KNJFTNKIN-SKJ
                   END-IF
               ELSE
                   IF    WK-KEISAN2-SKJ  <  WK-KEISAN3-SKJ
                      MOVE    2               TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN2-SKJ  TO  WK-KEISAN9-SKJ
                                                  WK-KNJFTNKIN-SKJ
                   ELSE
                      MOVE    3               TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN3-SKJ  TO  WK-KEISAN9-SKJ
                                                  WK-KNJFTNKIN-SKJ
                   END-IF
               END-IF
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³¤È¸øÈñ£´
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
      **       MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
      **       MOVE   LNK-SYU-KOH3COMPFTN     TO   WK-KEISAN3
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   LNK-SYU-KOH3SKJ-FTN     TO   WK-KEISAN3-SKJ
               MOVE   LNK-SYU-KOH4SKJ-FTN     TO   WK-KEISAN4-SKJ
               MOVE   2                       TO   FLG-HIKAKU2
               MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KNJFTNKIN
               IF  LNK-SYU-KOH3COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH3COMPFTN =  WK-KNJFTNKIN
                   MOVE    3                  TO   FLG-HIKAKU3
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU2
                   MOVE    3                  TO   FLG-HIKAKU3
                 END-IF
                 MOVE   LNK-SYU-KOH3COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               MOVE     WK-KNJFTNKIN          TO   WK-KEISAN9
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   IF    WK-KEISAN1-SKJ  <  WK-KEISAN3-SKJ
                      IF    WK-KEISAN1-SKJ  <  WK-KEISAN4-SKJ
                        MOVE    1               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN1-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ
                      ELSE
                        MOVE    4               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-SKJ  <  WK-KEISAN4-SKJ
                        MOVE    3               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN3-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ
                      ELSE
                        MOVE    4               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ
                      END-IF
                   END-IF
               ELSE
                   IF    WK-KEISAN2-SKJ  <  WK-KEISAN3-SKJ
                      IF    WK-KEISAN2-SKJ  <  WK-KEISAN4-SKJ
                        MOVE    2               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN2-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ
                      ELSE
                        MOVE    4               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-SKJ  <  WK-KEISAN4-SKJ
                        MOVE    3               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN3-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ
                      ELSE
                        MOVE    4               TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ  TO  WK-KEISAN9-SKJ
                                                    WK-KNJFTNKIN-SKJ
                      END-IF
                   END-IF
               END-IF
           END-IF
      *
           IF  (WK-2010-KINJYOKBN-N(1) = "1")
           AND (FLG-MARUTOARI          =  1 )
               MOVE   LNK-SYU-SYUSKJ-FTN      TO   WK-KEISAN-SKJ
               IF   WK-KEISAN-SKJ  <  WK-KEISAN9-SKJ
                   MOVE    ZERO                 TO   FLG-HIKAKU-SKJ
                   MOVE    LNK-SYU-SYUSKJ-FTN   TO   WK-KNJFTNKIN-SKJ
               END-IF
           ELSE
             IF   COMB-KOH1HKNNUM        NOT   =   "027"
             AND  COMB-HKNNUM            NOT   =   SPACE
               MOVE   LNK-SYU-SYUCOMPFTN      TO   WK-KEISAN
               MOVE   LNK-SYU-SYUSKJ-FTN      TO   WK-KEISAN-SKJ
               IF   WK-KEISAN  <  WK-KEISAN9
                   MOVE    ZERO                 TO   FLG-HIKAKU2
                   MOVE    ZERO                 TO   FLG-HIKAKU3
                   MOVE    LNK-SYU-SYUCOMPFTN   TO   WK-KNJFTNKIN
               END-IF
               IF   WK-KEISAN-SKJ  <  WK-KEISAN9-SKJ
                   MOVE    ZERO                 TO   FLG-HIKAKU-SKJ
                   MOVE    LNK-SYU-SYUSKJ-FTN   TO   WK-KNJFTNKIN-SKJ
               END-IF
             END-IF
           END-IF
      *
           IF    WK-CYOKI-ZAN  <  WK-KNJFTNKIN
               MOVE     ZERO            TO     FLG-HIKAKU2
               MOVE     ZERO            TO     FLG-HIKAKU3
               MOVE     WK-CYOKI-ZAN    TO     WK-KNJFTNKIN
           END-IF
      *
           .
      *
       23091X-FTNKIN-HIKAKU-CYOKI-EXT.
           EXIT.
      *
      ******************************************************************
      *        Ä¹´üÊ»ÍÑ»þ°Ê³°¡ÊÎß·×¥Ù¡¼¥¹·×»»ÍÑ¡Ë
      ******************************************************************
       23092X-FTNKIN-HIKAKU-TUJYO-SEC         SECTION.
      *
      *    ÀÁµá³ÛÈæ³Ó
           MOVE    ZERO               TO    WK-KEISAN-ENTANI
                                            WK-KEISAN1-ENTANI
                                            WK-KEISAN2-ENTANI
                                            WK-KEISAN3-ENTANI
                                            WK-KEISAN4-ENTANI
                                            WK-KEISAN9-ENTANI
      *
           MOVE    ZERO               TO    WK-KNJFTNKIN-ENTANI
      *
      *    ¸øÈñ£±¤È¸øÈñ£²
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN9-ENTANI
                                                 WK-KNJFTNKIN-ENTANI
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN2-ENTANI
               MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                            TO   WK-KEISAN3-ENTANI
               IF    WK-KEISAN2-ENTANI  <  WK-KEISAN3-ENTANI
                   MOVE    WK-KEISAN2-ENTANI  TO  WK-KEISAN9-ENTANI
                                                  WK-KNJFTNKIN-ENTANI
               ELSE
                   MOVE    WK-KEISAN3-ENTANI  TO  WK-KEISAN9-ENTANI
                                                  WK-KNJFTNKIN-ENTANI
               END-IF
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³¤È¸øÈñ£´
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
               MOVE   LNK-SYU-KOH2COMPFTN-ENTANI
                                            TO   WK-KEISAN2-ENTANI
               MOVE   LNK-SYU-KOH3COMPFTN-ENTANI
                                            TO   WK-KEISAN3-ENTANI
               MOVE   LNK-SYU-KOH4COMPFTN-ENTANI
                                            TO   WK-KEISAN4-ENTANI
               IF    WK-KEISAN2-ENTANI  <  WK-KEISAN3-ENTANI
                   IF    WK-KEISAN2-ENTANI  <  WK-KEISAN4-ENTANI
                      MOVE    WK-KEISAN2-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   ELSE
                      MOVE    WK-KEISAN4-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   END-IF
               ELSE
                   IF    WK-KEISAN3-ENTANI  <  WK-KEISAN4-ENTANI
                      MOVE    WK-KEISAN3-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   ELSE
                      MOVE    WK-KEISAN4-ENTANI TO  WK-KEISAN9-ENTANI
                                                    WK-KNJFTNKIN-ENTANI
                   END-IF
               END-IF
           END-IF
      *
           IF  (WK-2010-KINJYOKBN-N(1) = "1")
           AND (FLG-MARUTOARI          =  1 )
             CONTINUE
           ELSE
             IF   COMB-KOH1HKNNUM        NOT   =   "027"
             AND  COMB-HKNNUM            NOT   =   SPACE
               MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                            TO   WK-KEISAN-ENTANI
               IF   WK-KEISAN-ENTANI  <  WK-KEISAN9-ENTANI
                   MOVE   LNK-SYU-SYUCOMPFTN-ENTANI
                                  TO   WK-KNJFTNKIN-ENTANI
               END-IF
             END-IF
           END-IF
      *
      *********************
      *
      *    ÀÁµá³ÛÈæ³Ó
           MOVE    ZERO               TO    WK-KEISAN
                                            WK-KEISAN1
                                            WK-KEISAN2
                                            WK-KEISAN3
                                            WK-KEISAN4
                                            WK-KEISAN9
           MOVE    ZERO               TO    WK-KEISAN-SKJ
                                            WK-KEISAN1-SKJ
                                            WK-KEISAN2-SKJ
                                            WK-KEISAN3-SKJ
                                            WK-KEISAN4-SKJ
                                            WK-KEISAN9-SKJ
      *
           MOVE    ZERO               TO    FLG-HIKAKU
           MOVE    ZERO               TO    FLG-HIKAKU2
           MOVE    ZERO               TO    FLG-HIKAKU3
           MOVE    ZERO               TO    FLG-HIKAKU4
           MOVE    ZERO               TO    FLG-HIKAKU-SKJ
      *
           MOVE    ZERO               TO    WK-KNJFTNKIN
                                            WK-KNJFTNKIN-SKJ
      *    ¸øÈñ£±¤È¸øÈñ£²
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              =     SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
               MOVE   2                       TO   FLG-HIKAKU2
               MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN9
                                                   WK-KNJFTNKIN
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   MOVE      1                     TO  FLG-HIKAKU-SKJ
                   MOVE    WK-KEISAN1-SKJ          TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ
               ELSE
                   MOVE      2                     TO  FLG-HIKAKU-SKJ
                   MOVE    WK-KEISAN2-SKJ          TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ
               END-IF
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              =     SPACE)
      **       MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
      **       MOVE   LNK-SYU-KOH3COMPFTN     TO   WK-KEISAN3
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   LNK-SYU-KOH3SKJ-FTN     TO   WK-KEISAN3-SKJ
               MOVE   2                       TO   FLG-HIKAKU2
               MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KNJFTNKIN
               IF  LNK-SYU-KOH3COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH3COMPFTN =  WK-KNJFTNKIN
                   MOVE    3                  TO   FLG-HIKAKU3
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU2
                   MOVE    3                  TO   FLG-HIKAKU3
                 END-IF
                 MOVE   LNK-SYU-KOH3COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               MOVE     WK-KNJFTNKIN          TO   WK-KEISAN9
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   IF    WK-KEISAN1-SKJ  <  WK-KEISAN3-SKJ
                      MOVE      1                  TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN1-SKJ       TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ
                   ELSE
                      MOVE      3                  TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN3-SKJ       TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ 
                   END-IF
               ELSE
                   IF    WK-KEISAN2-SKJ  <  WK-KEISAN3-SKJ
                      MOVE      2                  TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN2-SKJ       TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ 
                   ELSE
                      MOVE      3                  TO  FLG-HIKAKU-SKJ
                      MOVE    WK-KEISAN3-SKJ       TO  WK-KEISAN9-SKJ
                                                       WK-KNJFTNKIN-SKJ 
                   END-IF
               END-IF
           END-IF
      *    ¸øÈñ£±¤È¸øÈñ£²¤È¸øÈñ£³¤È¸øÈñ£´
           IF (COMB-KOH1HKNNUM              NOT = SPACE)   AND
              (COMB-KOH2HKNNUM              NOT = SPACE)   AND
              (COMB-KOH3HKNNUM              NOT = SPACE)   AND
              (COMB-KOH4HKNNUM              NOT = SPACE)
      **       MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KEISAN2
      **       MOVE   LNK-SYU-KOH3COMPFTN     TO   WK-KEISAN3
      **       MOVE   LNK-SYU-KOH4COMPFTN     TO   WK-KEISAN4
               MOVE   LNK-SYU-KOH1SKJ-FTN     TO   WK-KEISAN1-SKJ
               MOVE   LNK-SYU-KOH2SKJ-FTN     TO   WK-KEISAN2-SKJ
               MOVE   LNK-SYU-KOH3SKJ-FTN     TO   WK-KEISAN3-SKJ
               MOVE   LNK-SYU-KOH4SKJ-FTN     TO   WK-KEISAN4-SKJ
               MOVE   2                       TO   FLG-HIKAKU2
               MOVE   LNK-SYU-KOH2COMPFTN     TO   WK-KNJFTNKIN
               IF  LNK-SYU-KOH3COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH3COMPFTN =  WK-KNJFTNKIN
                   MOVE    3                  TO   FLG-HIKAKU3
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU2
                   MOVE    3                  TO   FLG-HIKAKU3
                 END-IF
                 MOVE   LNK-SYU-KOH3COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               IF  LNK-SYU-KOH4COMPFTN  <=  WK-KNJFTNKIN
                 IF  LNK-SYU-KOH4COMPFTN =  WK-KNJFTNKIN
                   MOVE    4                  TO   FLG-HIKAKU4
                 ELSE
                   MOVE   ZERO                TO   FLG-HIKAKU2
                   MOVE   ZERO                TO   FLG-HIKAKU3
                   MOVE    4                  TO   FLG-HIKAKU4
                 END-IF
                 MOVE   LNK-SYU-KOH4COMPFTN   TO   WK-KNJFTNKIN
               END-IF
               MOVE     WK-KNJFTNKIN          TO   WK-KEISAN9
               IF    WK-KEISAN1-SKJ  <  WK-KEISAN2-SKJ
                   IF    WK-KEISAN1-SKJ  <  WK-KEISAN3-SKJ
                      IF    WK-KEISAN1-SKJ  <  WK-KEISAN4-SKJ
                        MOVE      1                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN1-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-SKJ  <  WK-KEISAN4-SKJ
                        MOVE      3                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN3-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      END-IF
                   END-IF
               ELSE
                   IF    WK-KEISAN2-SKJ  <  WK-KEISAN3-SKJ
                      IF    WK-KEISAN2-SKJ  <  WK-KEISAN4-SKJ
                        MOVE      2                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN2-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      END-IF
                   ELSE
                      IF    WK-KEISAN3-SKJ  <  WK-KEISAN4-SKJ
                        MOVE      3                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN3-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      ELSE
                        MOVE      4                 TO  FLG-HIKAKU-SKJ
                        MOVE    WK-KEISAN4-SKJ      TO  WK-KEISAN9-SKJ
                                                        WK-KNJFTNKIN-SKJ 
                      END-IF
                   END-IF
               END-IF
           END-IF
      *
           IF  (WK-2010-KINJYOKBN-N(1) = "1")
           AND (FLG-MARUTOARI          =  1 )
               MOVE   LNK-SYU-SYUSKJ-FTN      TO   WK-KEISAN-SKJ
               IF   WK-KEISAN-SKJ  <  WK-KEISAN9-SKJ
                   MOVE    ZERO                 TO   FLG-HIKAKU-SKJ
                   MOVE    LNK-SYU-SYUSKJ-FTN   TO   WK-KNJFTNKIN-SKJ 
               END-IF
           ELSE
             IF   COMB-KOH1HKNNUM        NOT   =   "027"
             AND  COMB-HKNNUM            NOT   =   SPACE
               MOVE   LNK-SYU-SYUCOMPFTN      TO   WK-KEISAN
               MOVE   LNK-SYU-SYUSKJ-FTN      TO   WK-KEISAN-SKJ
               IF   WK-KEISAN  <  WK-KEISAN9
                   MOVE    ZERO                 TO   FLG-HIKAKU2
                   MOVE    ZERO                 TO   FLG-HIKAKU3
                   MOVE    ZERO                 TO   FLG-HIKAKU4
                   MOVE    LNK-SYU-SYUCOMPFTN   TO   WK-KNJFTNKIN
               END-IF
               IF   WK-KEISAN-SKJ  <  WK-KEISAN9-SKJ
                   MOVE    ZERO                 TO   FLG-HIKAKU-SKJ
                   MOVE    LNK-SYU-SYUSKJ-FTN   TO   WK-KNJFTNKIN-SKJ 
               END-IF
             END-IF
           END-IF
      *
           .
      *
       23092X-FTNKIN-HIKAKU-TUJYO-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÆÃ¼ì·×»»ÍÑ¶â³ÛÂàÈòÊÔ½¸
      ******************************************************************
       23093-TOKUSYU-HENSYU-SEC         SECTION.
      *
           IF ( WK-2010-IRYOKEIKBN-N(1) NOT = SPACE )
           OR ( WK-2010-IRYOKEIKBN-N(2) NOT = SPACE )
           OR ( WK-2010-IRYOKEIKBN-N(3) NOT = SPACE )
           OR ( WK-2010-IRYOKEIKBN-N(4) NOT = SPACE )
           OR ( WK-2010-KINJYOKBN-N(1)      =  "1"  )
           OR ( WK-2010-KINJYOKBN-N(2)      =  "1"  )
           OR ( WK-2010-KINJYOKBN-N(3)      =  "1"  )
           OR ( WK-2010-KINJYOKBN-N(4)      =  "1"  )
      *
                    IF ((FLG-KOUGAKUCYO3       NOT =    ZERO) AND
                        (FLG-IRYOHI3X              =     11 ) AND
                        ((WK-2010-IRYOKEIKBN-N(1)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-N(1)   =  "1"  )))
                    OR ((FLG-KOUGAKUCYO3       NOT =    ZERO) AND
                        (FLG-IRYOHI3X              =     21 ) AND
                        ((WK-2010-IRYOKEIKBN-N(2)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-N(2)   =  "1"  )))
                    OR ((FLG-KOUGAKUCYO-GEN70  NOT =    ZERO) AND
                        (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10   ) AND
                        ((WK-2010-IRYOKEIKBN-N(1)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-N(1)   =  "1"  )))
                    OR ((FLG-KOUGAKUCYO-GEN70  NOT =    ZERO) AND
                        (FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12  ) AND
                        (FLG-KOUGAKUCYO-GEN70K NOT =    ZERO) AND
                        ((WK-2010-IRYOKEIKBN-N(2)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-N(2)   =  "1"  )))
                    OR ((FLG-KOUGAKUCYO3       NOT =    ZERO) AND
                        (FLG-IRYOHIKG2  =   1 OR 2 OR 3     ) AND
                        ((WK-2010-IRYOKEIKBN-N(1)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-N(1)   =  "1"  )))
                      CONTINUE
                    ELSE
                      COMPUTE  WK-TOKUSYU-COMPFTN   =
                               WK-TOKUSYU-COMPFTN   +    5
                      COMPUTE  WK-TOKUSYU-COMPFTN   =
                               WK-TOKUSYU-COMPFTN   /   10
                      COMPUTE  WK-TOKUSYU-COMPFTN   =
                               WK-TOKUSYU-COMPFTN   *   10
                    END-IF
      *
                    IF  ( WK-2010-IRYOKEIKBN-N(1)
                                               NOT = SPACE  )
                    OR  ( WK-2010-KINJYOKBN-N(1)   =  "1"   )
                    OR  ((LNK-SYU-SYUHKNNUM    NOT =  SPACE) AND
                         (LNK-SYU-KOH1HKNNUM       =  "027") AND
                         (WK-2010-IRYOKEIKBN-N(2)
                                               NOT = SPACE ))
                    OR  ((LNK-SYU-SYUHKNNUM    NOT =  SPACE) AND
                         (LNK-SYU-KOH1HKNNUM       =  "027") AND
                         (WK-2010-KINJYOKBN-N(2)   =  "1"  ))
                     IF  LNK-SYU-KOH1HKNNUM   = "972" OR "974"
                       IF    WK-TOKUSYU-COMPFTN2  =  9999999
                         CONTINUE
                       ELSE
                         IF  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                              < WK-TOKUSYU-COMPFTN2
                            MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                           TO  WK-TOKUSYU-COMPFTN2
                         END-IF
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN(1)
                                              < WK-TOKUSYU-COMPFTN
                            MOVE  LNK-SYU-KOH-COMPFTN(1)
                                           TO  WK-TOKUSYU-COMPFTN
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(1)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                     END-IF
                     IF  LNK-SYU-KOH2HKNNUM   = "972" OR "974"
                       IF    WK-TOKUSYU-COMPFTN2  =  9999999
                         CONTINUE
                       ELSE
                         IF  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                              < WK-TOKUSYU-COMPFTN2
                            MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                           TO  WK-TOKUSYU-COMPFTN2
                         END-IF
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN(2)
                                              < WK-TOKUSYU-COMPFTN
                            MOVE  LNK-SYU-KOH-COMPFTN(2)
                                           TO  WK-TOKUSYU-COMPFTN
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(2)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                     END-IF
                     IF  LNK-SYU-KOH3HKNNUM   = "972" OR "974"
                       IF    WK-TOKUSYU-COMPFTN2  =  9999999
                         CONTINUE
                       ELSE
                         IF  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                              < WK-TOKUSYU-COMPFTN2
                            MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                           TO  WK-TOKUSYU-COMPFTN2
                         END-IF
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN(3)
                                              < WK-TOKUSYU-COMPFTN
                            MOVE  LNK-SYU-KOH-COMPFTN(3)
                                           TO  WK-TOKUSYU-COMPFTN
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(3)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                     END-IF
                     IF  LNK-SYU-KOH4HKNNUM   = "972" OR "974"
                       IF    WK-TOKUSYU-COMPFTN2  =  9999999
                         CONTINUE
                       ELSE
                         IF  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                                              < WK-TOKUSYU-COMPFTN2
                            MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                                           TO  WK-TOKUSYU-COMPFTN2
                         END-IF
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN(4)
                                              < WK-TOKUSYU-COMPFTN
                            MOVE  LNK-SYU-KOH-COMPFTN(4)
                                           TO  WK-TOKUSYU-COMPFTN
                       END-IF
                       IF  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                                                  < WK-TOKUSYU-ENTANI
                          MOVE  LNK-SYU-KOH-COMPFTN-ENTANI(4)
                                            TO  WK-TOKUSYU-ENTANI
                       END-IF
                     END-IF
                    END-IF
      *
                    IF ((FLG-KOUGAKUCYO3       NOT =    ZERO) AND
                        (FLG-IRYOHI3X              =     11 ) AND
                        ((WK-2010-IRYOKEIKBN-N(1)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-N(1)   =  "1"  )))
                    OR ((FLG-KOUGAKUCYO3       NOT =    ZERO) AND
                        (FLG-IRYOHI3X              =     21 ) AND
                        ((WK-2010-IRYOKEIKBN-N(2)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-N(2)   =  "1"  )))
                    OR ((FLG-KOUGAKUCYO-GEN70  NOT =    ZERO) AND
                        (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10   ) AND
                        ((WK-2010-IRYOKEIKBN-N(1)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-N(1)   =  "1"  )))
                    OR ((FLG-KOUGAKUCYO-GEN70  NOT =    ZERO) AND
                        (FLG-IRYOHI70 = 5 OR 6 OR 11 OR 12  ) AND
                        (FLG-KOUGAKUCYO-GEN70K NOT =    ZERO) AND
                        ((WK-2010-IRYOKEIKBN-N(2)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-N(2)   =  "1"  )))
                    OR ((FLG-KOUGAKUCYO3       NOT =    ZERO) AND
                        (FLG-IRYOHIKG2  =   1 OR 2 OR 3     ) AND
                        ((WK-2010-IRYOKEIKBN-N(1)
                                               NOT = SPACE ) OR
                         (WK-2010-KINJYOKBN-N(1)   =  "1"  )))
                      MOVE     WK-TOKUSYU-COMPFTN   TO
                                         LNK-SYU-JYO-HKNFTNMONEY
                    ELSE
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    WK-TOKUSYU-COMPFTN        +    5
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    LNK-SYU-JYO-HKNFTNMONEY   /   10
                      COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                                    LNK-SYU-JYO-HKNFTNMONEY   *   10
                    END-IF
      *
                    IF    WK-TOKUSYU-COMPFTN2  =  9999999
                         MOVE  WK-TOKUSYU-COMPFTN   TO
                                          LNK-SYU-JYO-COMPFTN
                    ELSE
                         MOVE  WK-TOKUSYU-COMPFTN2  TO
                                          LNK-SYU-JYO-COMPFTN
                    END-IF
      *
                    MOVE     WK-TOKUSYU-ENTANI    TO
                                        LNK-SYU-JYO-COMPFTN-ENTANI
      *
           END-IF
      *
           IF  (WK-1001-PREFNUM             =  43      )
           AND (LNK-SYU-SRYYMD(1:6)        >= "200912" )
           AND ((LNK-SYU-KOH1HKNNUM   = "143" OR "342") OR
                (LNK-SYU-KOH2HKNNUM   = "143" OR "342") OR
                (LNK-SYU-KOH3HKNNUM   = "143" OR "342") OR
                (LNK-SYU-KOH4HKNNUM   = "143" OR "342"))
             IF   WK-KUMAMOTO-SYUCOMPFTN  NOT = ZERO
                 MOVE  WK-KUMAMOTO-SYUCOMPFTN
                                           TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
           END-IF
      *
           IF  (WK-1001-PREFNUM             =  35 OR 34)
           AND (LNK-SYU-SRYYMD(1:6)        >= "201309" )
           AND ((LNK-SYU-KOH1HKNNUM  =  "781") OR
                (LNK-SYU-KOH2HKNNUM  =  "781") OR
                (LNK-SYU-KOH3HKNNUM  =  "781") OR
                (LNK-SYU-KOH4HKNNUM  =  "781")         )
      *
             IF   LNK-SYU-SYUHKNNUM   NOT =  SPACE
               IF  (FLG-KOUGAKUCYO3      =     1)
               OR  (FLG-KOUGAKUCYO-GEN70 =     1)
                 MOVE  LNK-SYU-SYUCOMPFTN       TO  WK-JYOSEI-KOHIKIN3
               ELSE
                 COMPUTE  WK-JYOSEI-KOHIKIN3   =
                          LNK-SYU-SYUCOMPFTN   +    5
                 COMPUTE  WK-JYOSEI-KOHIKIN3   =
                          WK-JYOSEI-KOHIKIN3   /   10
                 COMPUTE  WK-JYOSEI-KOHIKIN3   =
                          WK-JYOSEI-KOHIKIN3   *   10
               END-IF
             ELSE
                 MOVE  WK-JYOSEI-KOHIKIN-ZENGAKU
                                                TO  WK-JYOSEI-KOHIKIN3
             END-IF
      *
             IF   LNK-SYU-KOH2HKNNUM  =  "781"
               IF  WK-JYOSEI-KOHIKIN3  >
                                  LNK-SYU-KOH-HKNFTNMONEY(1)
                   MOVE  LNK-SYU-KOH-HKNFTNMONEY(1)
                                                TO  WK-JYOSEI-KOHIKIN3
               END-IF
             END-IF
             IF   LNK-SYU-KOH3HKNNUM  =  "781"
               IF  WK-JYOSEI-KOHIKIN3  >
                                  LNK-SYU-KOH-HKNFTNMONEY(2)
                   MOVE  LNK-SYU-KOH-HKNFTNMONEY(2)
                                                TO  WK-JYOSEI-KOHIKIN3
               END-IF
             END-IF
             IF   LNK-SYU-KOH4HKNNUM  =  "781"
               IF  WK-JYOSEI-KOHIKIN3  >
                                  LNK-SYU-KOH-HKNFTNMONEY(3)
                   MOVE  LNK-SYU-KOH-HKNFTNMONEY(3)
                                                TO  WK-JYOSEI-KOHIKIN3
               END-IF
             END-IF
      *
             MOVE  9999999                TO  LNK-SYU-JYO-HKNFTNMONEY
             MOVE  WK-JYOSEI-KOHIKIN3     TO  LNK-SYU-JYO-COMPFTN
             MOVE  WK-JYOSEI-KOHIKIN2     TO  LNK-SYU-JYO-COMPFTN-ENTANI
      *
           END-IF
      *
           IF  (WK-1001-PREFNUM             =  23     )
           AND (LNK-SYU-SRYYMD(1:6)        >= "201504")
           AND ((LNK-SYU-KOH1HKNNUM  = "781" OR "271") OR
                (LNK-SYU-KOH2HKNNUM  = "781" OR "271") OR
                (LNK-SYU-KOH3HKNNUM  = "781" OR "271") OR
                (LNK-SYU-KOH4HKNNUM  = "781" OR "271"))
      *
             IF   LNK-SYU-SYUHKNNUM   NOT =  SPACE
               IF  (FLG-KOUGAKUCYO3      =     1)
               OR  (FLG-KOUGAKUCYO-GEN70 =     1)
                 MOVE  LNK-SYU-SYUCOMPFTN       TO  WK-JYOSEI-KOHIKIN3
               ELSE
                 COMPUTE  WK-JYOSEI-KOHIKIN3   =
                          LNK-SYU-SYUCOMPFTN   +    5
                 COMPUTE  WK-JYOSEI-KOHIKIN3   =
                          WK-JYOSEI-KOHIKIN3   /   10
                 COMPUTE  WK-JYOSEI-KOHIKIN3   =
                          WK-JYOSEI-KOHIKIN3   *   10
               END-IF
             ELSE
                 MOVE  WK-JYOSEI-KOHIKIN-ZENGAKU
                                                TO  WK-JYOSEI-KOHIKIN3
             END-IF
      *
             IF   LNK-SYU-KOH2HKNNUM  =  "781" OR "271"
               IF  WK-JYOSEI-KOHIKIN3  >
                                  LNK-SYU-KOH-HKNFTNMONEY(1)
                   MOVE  LNK-SYU-KOH-HKNFTNMONEY(1)
                                                TO  WK-JYOSEI-KOHIKIN3
               END-IF
             END-IF
             IF   LNK-SYU-KOH3HKNNUM  =  "781" OR "271"
               IF  WK-JYOSEI-KOHIKIN3  >
                                  LNK-SYU-KOH-HKNFTNMONEY(2)
                   MOVE  LNK-SYU-KOH-HKNFTNMONEY(2)
                                                TO  WK-JYOSEI-KOHIKIN3
               END-IF
             END-IF
             IF   LNK-SYU-KOH4HKNNUM  =  "781" OR "271"
               IF  WK-JYOSEI-KOHIKIN3  >
                                  LNK-SYU-KOH-HKNFTNMONEY(3)
                   MOVE  LNK-SYU-KOH-HKNFTNMONEY(3)
                                                TO  WK-JYOSEI-KOHIKIN3
               END-IF
             END-IF
      *
             MOVE  9999999                TO  LNK-SYU-JYO-HKNFTNMONEY
             MOVE  WK-JYOSEI-KOHIKIN3     TO  LNK-SYU-JYO-COMPFTN
             MOVE  WK-JYOSEI-KOHIKIN2     TO  LNK-SYU-JYO-COMPFTN-ENTANI
      *
           END-IF
      *
      ***
      *
           IF  (WK-1001-PREFNUM       =  36                    )
           AND (COMB-HKNNUM       NOT = SPACE                  )
           AND (COMB-KOH1HKNNUM(1:1)  = "0"                    )
           AND (COMB-KOH1HKNNUM   NOT = "010"                  )
           AND (COMB-KOH2HKNNUM       = "149"                  )
           AND (COMB-KOH3HKNNUM       = SPACE OR "972" OR "974")
           AND (COMB-KOH4HKNNUM       = SPACE                  )
           AND (LNK-SYU-SRYYMD(1:6)  >= "201610"               )
      *
             MOVE    ZERO    TO   FLG-HIKAKU
             MOVE    ZERO    TO   FLG-HIKAKU2
             MOVE    ZERO    TO   FLG-HIKAKU3
             MOVE    ZERO    TO   FLG-HIKAKU4
             MOVE    ZERO    TO   WK-TAIHI-COMPFTN-149
      *
      *      ÀÁµá³Û¤Ë²Ã»»
             IF   COMB-KOH3HKNNUM  = "972" OR "974"
               IF    LNK-SYU-SYUCOMPFTN-ENTANI  <
                                           LNK-SYU-KOH1COMPFTN-ENTANI
                 IF  WK-CYOKI-ZAN-ENTANI  <  LNK-SYU-SYUCOMPFTN-ENTANI
                   ADD  WK-CYOKI-ZAN-ENTANI  TO  WK-KNJFTNKIN-ENTANI
                   MOVE WK-CYOKI-ZAN-ENTANI
                                      TO  LNK-SYU-JYO-COMPFTN-ENTANI
                 ELSE
                   ADD  LNK-SYU-SYUCOMPFTN-ENTANI
                                             TO  WK-KNJFTNKIN-ENTANI
                   MOVE LNK-SYU-SYUCOMPFTN-ENTANI
                                      TO  LNK-SYU-JYO-COMPFTN-ENTANI
                 END-IF
               ELSE
                 IF  WK-CYOKI-ZAN-ENTANI  <  LNK-SYU-KOH1COMPFTN-ENTANI
                   ADD  WK-CYOKI-ZAN-ENTANI  TO  WK-KNJFTNKIN-ENTANI
                   MOVE WK-CYOKI-ZAN-ENTANI
                                      TO  LNK-SYU-JYO-COMPFTN-ENTANI
                 ELSE
                   ADD  LNK-SYU-KOH1COMPFTN-ENTANI
                                             TO  WK-KNJFTNKIN-ENTANI
                   MOVE LNK-SYU-KOH1COMPFTN-ENTANI
                                      TO  LNK-SYU-JYO-COMPFTN-ENTANI
                 END-IF
               END-IF
               IF    LNK-SYU-SYUCOMPFTN  <  LNK-SYU-KOH1COMPFTN
                 IF  WK-CYOKI-ZAN  <  LNK-SYU-SYUCOMPFTN
                   ADD  WK-CYOKI-ZAN         TO  WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   MOVE WK-CYOKI-ZAN         TO  LNK-SYU-JYO-COMPFTN
                 ELSE
                   ADD  LNK-SYU-SYUCOMPFTN   TO  WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   MOVE LNK-SYU-SYUCOMPFTN   TO  LNK-SYU-JYO-COMPFTN
                 END-IF
               ELSE
                 IF  WK-CYOKI-ZAN  <  LNK-SYU-KOH1COMPFTN
                   ADD  WK-CYOKI-ZAN         TO  WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   MOVE WK-CYOKI-ZAN         TO  LNK-SYU-JYO-COMPFTN
                 ELSE
                   ADD  LNK-SYU-KOH1COMPFTN  TO  WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   MOVE LNK-SYU-KOH1COMPFTN  TO  LNK-SYU-JYO-COMPFTN
                 END-IF
               END-IF
      *
               MOVE    1                     TO  FLG-HIKAKU
               MOVE  LNK-SYU-KOH1COMPFTN     TO  WK-TAIHI-COMPFTN-149
               IF  LNK-SYU-SYUCOMPFTN  <  WK-TAIHI-COMPFTN-149
                   MOVE   ZERO               TO  FLG-HIKAKU
                   MOVE   LNK-SYU-SYUCOMPFTN TO  WK-TAIHI-COMPFTN-149
               END-IF
               IF  WK-CYOKI-ZAN  <  WK-TAIHI-COMPFTN-149
                   MOVE   ZERO               TO  FLG-HIKAKU
                   MOVE   WK-CYOKI-ZAN       TO  WK-TAIHI-COMPFTN-149
               END-IF
             ELSE
               IF    LNK-SYU-SYUCOMPFTN-ENTANI  <
                                           LNK-SYU-KOH1COMPFTN-ENTANI
                   ADD  LNK-SYU-SYUCOMPFTN-ENTANI
                                             TO  WK-KNJFTNKIN-ENTANI
                   MOVE LNK-SYU-SYUCOMPFTN-ENTANI
                                      TO  LNK-SYU-JYO-COMPFTN-ENTANI
               ELSE
                   ADD  LNK-SYU-KOH1COMPFTN-ENTANI
                                             TO  WK-KNJFTNKIN-ENTANI
                   MOVE LNK-SYU-KOH1COMPFTN-ENTANI
                                      TO  LNK-SYU-JYO-COMPFTN-ENTANI
               END-IF
               IF    LNK-SYU-SYUCOMPFTN  <  LNK-SYU-KOH1COMPFTN
                   ADD  LNK-SYU-SYUCOMPFTN   TO  WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   MOVE LNK-SYU-SYUCOMPFTN   TO  LNK-SYU-JYO-COMPFTN
               ELSE
                   ADD  LNK-SYU-KOH1COMPFTN  TO  WK-KNJFTNKIN
                                                 LNK-SYU-SKYMONEY
                   MOVE LNK-SYU-KOH1COMPFTN  TO  LNK-SYU-JYO-COMPFTN
               END-IF
      *
               MOVE    1                     TO  FLG-HIKAKU
               MOVE  LNK-SYU-KOH1COMPFTN     TO  WK-TAIHI-COMPFTN-149
               IF  LNK-SYU-SYUCOMPFTN  <  WK-TAIHI-COMPFTN-149
                   MOVE   ZERO               TO  FLG-HIKAKU
                   MOVE   LNK-SYU-SYUCOMPFTN TO  WK-TAIHI-COMPFTN-149
               END-IF
             END-IF
      *
           END-IF
      *
           .
      *
       23093-TOKUSYU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÆüÊÌ¥Ç¡¼¥¿ÃÖ¤­´¹¤¨ÊÔ½¸½èÍý
      ******************************************************************
       23094-DAYDATA-OKIKAE-HENSYU-SEC         SECTION.
      *
           PERFORM    VARYING   KOH-IDX2   FROM   1   BY   1
                       UNTIL    KOH-IDX2    >     4
      *
             IF  (WK-DAYINFFLG(KOH-IDX2)             =   1)
             OR  (WK-DAYINF-ZENKOH-FLG(KOH-IDX2)     =   1)
      *
               MOVE  LNK-SYU-KOH-HKNFTNMONEY(KOH-IDX2)
                                  TO   WK-DAYTAIHI-FTNMONEY
               MOVE  LNK-SYU-KOH-COMPFTN(KOH-IDX2)
                                  TO   WK-DAYTAIHI-COMPFTN
               COMPUTE  WK-DAYTAIHI-COMPFTNWK =
                        LNK-SYU-KOH-COMPFTN-ENTANI(KOH-IDX2) + 0.9
      *
               PERFORM    VARYING   KOH-IDX3   FROM   1   BY   1
                           UNTIL    KOH-IDX3    >    31
      *
                 IF  ((WK-DAYINFFLG(KOH-IDX2)            =   1 ) AND
                      (KOHI-TBL(KOH-IDX3 KOH-IDX2)       =   9 ))
                 OR  ((WK-DAYINF-ZENKOH-FLG(KOH-IDX2)    =   1 ) AND
                      (LNK-SYU-DAY(KOH-IDX3) =
                                       "1" OR "2" OR "8" OR "9") AND
                      (LNK-SDAY-HKNTEN(KOH-IDX3)     NOT = ZERO))
      *
                       IF  LNK-SDAY-FTNMONEY(KOH-IDX3 KOH-IDX2)
                                        <=    WK-DAYTAIHI-FTNMONEY
                         COMPUTE WK-DAYTAIHI-FTNMONEY  =
                                 WK-DAYTAIHI-FTNMONEY  -
                                 LNK-SDAY-FTNMONEY(KOH-IDX3 KOH-IDX2)
                       ELSE
                         MOVE    WK-DAYTAIHI-FTNMONEY  TO
                                 LNK-SDAY-FTNMONEY(KOH-IDX3 KOH-IDX2)
                         MOVE    ZERO    TO   WK-DAYTAIHI-FTNMONEY
                       END-IF
      *
                       IF  LNK-SDAY-COMPFTN(KOH-IDX3 KOH-IDX2)
                                        <=    WK-DAYTAIHI-COMPFTN
                         COMPUTE WK-DAYTAIHI-COMPFTN  =
                                 WK-DAYTAIHI-COMPFTN  -
                                 LNK-SDAY-COMPFTN(KOH-IDX3 KOH-IDX2)
                       ELSE
                         MOVE    WK-DAYTAIHI-COMPFTN   TO
                                 LNK-SDAY-COMPFTN(KOH-IDX3 KOH-IDX2)
                         MOVE    ZERO    TO   WK-DAYTAIHI-COMPFTN
                       END-IF
      *
                       IF  LNK-SDAY-COMPFTNWK(KOH-IDX3 KOH-IDX2)
                                        <=    WK-DAYTAIHI-COMPFTNWK
                         COMPUTE WK-DAYTAIHI-COMPFTNWK  =
                                 WK-DAYTAIHI-COMPFTNWK  -
                                 LNK-SDAY-COMPFTNWK(KOH-IDX3 KOH-IDX2)
                       ELSE
                         MOVE    WK-DAYTAIHI-COMPFTNWK   TO  
                                 LNK-SDAY-COMPFTNWK(KOH-IDX3 KOH-IDX2)
                         MOVE    ZERO    TO   WK-DAYTAIHI-COMPFTNWK
                       END-IF
      *
      ***              IF  (WK-DAYINFFLG(KOH-IDX2)               =  1  )
      ***              AND (LNK-SDAY-FTNMONEY(KOH-IDX3 KOH-IDX2) = ZERO)
      ***                MOVE    ZERO    TO
      ***                        LNK-SDAY-SANTEIFLG(KOH-IDX3 KOH-IDX2)
      ***              END-IF
      *
                 END-IF
      *
               END-PERFORM
      *
             END-IF
      *
           END-PERFORM.
      *
       23094-DAYDATA-OKIKAE-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÂçÊ¬¸©ÆýÍÄ»ùÆÃ¼ì·×»»
      *        µÜ¾ë¸©ÆýÍÄ»ùÆÃ¼ì·×»»
      *        ·²ÇÏ¸©ÃÏÊý¸øÈñÆÃ¼ì·×»»
      ******************************************************************
       23095-OITA-TOKUSYU-KEISAN-SEC         SECTION.
      *
           IF  ( WK-1001-PREFNUM             =  44      )
           AND ( LNK-SYU-SRYYMD(1:6)        >= "200610" )
           AND ( LNK-SYU-SRYYMD(1:6)        <  "201010" )
           AND ((LNK-SYU-KOH1HKNNUM   = "183" OR "283" ) OR
                (LNK-SYU-KOH2HKNNUM   = "183" OR "283" ) OR
                (LNK-SYU-KOH3HKNNUM   = "183" OR "283" ) OR
                (LNK-SYU-KOH4HKNNUM   = "183" OR "283" ))
      *
             IF   LNK-SYU-KOH1HKNNUM  = "183" OR "283"
               MOVE  LNK-SYU-SYUCOMPFTN     TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   LNK-SYU-KOH2HKNNUM  = "183" OR "283"
               MOVE  LNK-SYU-KOH-COMPFTN(1) TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   LNK-SYU-KOH3HKNNUM  = "183" OR "283"
               MOVE  LNK-SYU-KOH-COMPFTN(2) TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   LNK-SYU-KOH4HKNNUM  = "183" OR "283"
               MOVE  LNK-SYU-KOH-COMPFTN(3) TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
      *
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  +    5
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  /   10
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  *   10
      *
             MOVE     ZERO      TO     WK-OITA-CYOFTN-KON
      *
             IF     FLG-GENBUTU70    NOT =    ZERO
                IF  (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10    )
                AND (LNK-SYU-KOH1HKNNUM =  "183" OR "283")
                AND (FLG-SYUKEI2        =   ZERO         )
                  COMPUTE WK-FUTANWARI   = WK-KOH-FTNRATE  /  100
                  COMPUTE WK-OITA-KEISAN = WK-KOUREI-IRYOHI70
                                         * WK-FUTANWARI
                  COMPUTE  WK-OITA-KEISAN  =
                           WK-OITA-KEISAN  +    5
                  COMPUTE  WK-OITA-KEISAN  =
                           WK-OITA-KEISAN  /   10
                  COMPUTE  WK-OITA-KEISAN  =
                           WK-OITA-KEISAN  *   10
                  IF      MAX-KIN-SYU-M  > WK-OITA-KEISAN
                    MOVE   WK-OITA-KEISAN  TO  WK-OITA-KEISAN2
                  ELSE
                    MOVE   MAX-KIN-SYU-M   TO  WK-OITA-KEISAN2
                  END-IF
                  IF   WK-OITA-KEISAN2  >  80100
                    COMPUTE  WK-OITA-CYOFTN-KON  =  WK-OITA-KEISAN2
                                                 -  80100
                    IF  WK-OITA-CYOFTN-KON   >  WK-OITA-CYOFTN
                       COMPUTE WK-OITA-CYOFTN-KON  = WK-OITA-CYOFTN-KON
                                                   - WK-OITA-CYOFTN
                    ELSE
                       MOVE    ZERO    TO    WK-OITA-CYOFTN-KON
                    END-IF
                  END-IF
                END-IF
                MOVE           ZERO    TO    LNK-SYU-JYO-HKNFTNMONEY
             ELSE
                IF ((LNK-SYU-KOH1HKNNUM   = "972" OR "974" ) OR
                    (LNK-SYU-KOH2HKNNUM   = "972" OR "974" ) OR
                    (LNK-SYU-KOH3HKNNUM   = "972" OR "974" ) OR
                    (LNK-SYU-KOH4HKNNUM   = "972" OR "974" ))
                  MOVE         ZERO    TO    LNK-SYU-JYO-HKNFTNMONEY
                ELSE
                  COMPUTE  WK-OITA-HKNFTNMONEY = WK-OITA-HKNFTNMONEY
                                               + LNK-SYU-JYO-HKNFTNMONEY
                  IF       WK-OITA-HKNFTNMONEY > 80100
                    COMPUTE  WK-OITA-CYOFTN-KON  =  WK-OITA-HKNFTNMONEY
                                                 -  80100
                    IF  WK-OITA-CYOFTN-KON   >  WK-OITA-CYOFTN
                       COMPUTE WK-OITA-CYOFTN-KON  = WK-OITA-CYOFTN-KON
                                                   - WK-OITA-CYOFTN
                    ELSE
                       MOVE    ZERO    TO    WK-OITA-CYOFTN-KON
                    END-IF
                  END-IF
                END-IF
             END-IF
             PERFORM     230952-OITA-TOKUSYU-HENSYU2-SEC
      *
           END-IF
      *
           MOVE       ZERO      TO     WK-OITA-CYOFTN-KON
           IF   WK-2010-NINNASIKBN(1)  NOT =  SPACE
             IF   FLG-GENBUTU70   NOT =  ZERO
               IF  (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10)
               OR  (FLG-OITA-SYUKEI   =  1          )
      *          ¸ÂÅÙ³ÛÇ§Äê¾ÚÌµ¤·
                 IF      FLG-OITA-GENBUTU70   =    1
                    IF   FLG-OITA-SYUKEI  =  1
                      COMPUTE  WK-KOUREI-IRYOHI70  =
                               WK-KOUREI-IRYOHI70  +
                              (LNK-SYU-HKNTEN(17)  * 10)
                    END-IF
                    IF  LNK-SYU-SRYYMD(1:6)  <   "201104"
                      IF  FLG-SYUKEI2  =   ZERO
                        MOVE  ZERO  TO  WK-KOUREI-IRYOHI70-JYOGAI
                        MOVE  ZERO  TO  WK-KOUREI-IRYOHI70-JYOGAI2
                        MOVE  ZERO  TO  WK-OITA-HKNFTNMONEY
                        PERFORM  230951-OITA-TOKUSYU-HENSYU-SEC
                      END-IF
                    ELSE
                        PERFORM  230951-OITA-TOKUSYU-HENSYU-SEC
                    END-IF
                 END-IF
                 PERFORM         230952-OITA-TOKUSYU-HENSYU2-SEC
               END-IF
             END-IF
           END-IF
      *
           MOVE       ZERO      TO     WK-OITA-CYOFTN-KON
           IF   WK-2010-NINJYOKBN(1)   NOT =  SPACE
             IF   FLG-GENBUTU70   NOT =  ZERO
               IF  (FLG-IRYOHI70 = 3 OR 4 OR 9 OR 10)
               OR  (FLG-OITA-SYUKEI   =  1          )
      *          ¾å°Ì½êÆÀ¼Ô
                 IF      FLG-GENBUTU70        =    1
                 AND     FLG-OITA-GENBUTU70   =   ZERO
                   PERFORM       230953-OITA-TOKUSYU-HENSYU3-SEC
                 END-IF
                 PERFORM         230952-OITA-TOKUSYU-HENSYU2-SEC
               END-IF
             END-IF
           END-IF
      *
           MOVE       ZERO      TO     WK-OITA-CYOFTN-KON
           IF   WK-2010-NINNASIKBN-K(1)   NOT =  SPACE
             IF   LNK-S02-KOUREI-NYUIN-KBN    =  "1"
      *        ¸½ÌòÊÂ¤ß½êÆÀ¼Ô¤Ç¡¢¸ÂÅÙ³ÛÇ§Äê¾Ú¤ÎÄó¼¨¤¬¤Ê¤¤Êý
      *        ¡Ê¸½ÌòÊÂ¤ß­·¤ÎÊý¤ò´Þ¤à¡Ë
               IF  (FLG-IRYOHIKG2     =  1)
               OR  (FLG-OITA-SYUKEI   =  1)
                 PERFORM         230954-OITA-TOKUSYU-HENSYU4-SEC
                 PERFORM         230952-OITA-TOKUSYU-HENSYU2-SEC
               END-IF
             END-IF
           END-IF
      *
      ***
      *
           IF     WK-2010-NINNASIKBN(2)    NOT =  SPACE
           OR     WK-2010-NINNASIKBN(3)    NOT =  SPACE
           OR     WK-2010-NINNASIKBN(4)    NOT =  SPACE
           OR     WK-2010-NINJYOKBN(2)     NOT =  SPACE
           OR     WK-2010-NINJYOKBN(3)     NOT =  SPACE
           OR     WK-2010-NINJYOKBN(4)     NOT =  SPACE
           OR     WK-2010-NINNASIKBN-K(2)  NOT =  SPACE
           OR     WK-2010-NINNASIKBN-K(3)  NOT =  SPACE
           OR     WK-2010-NINNASIKBN-K(4)  NOT =  SPACE
      *
             IF   WK-2010-NINNASIKBN(2)    NOT =  SPACE
             OR   WK-2010-NINJYOKBN(2)     NOT =  SPACE
             OR   WK-2010-NINNASIKBN-K(2)  NOT =  SPACE
                  MOVE  LNK-SYU-KOH-COMPFTN(1)
                                    TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   WK-2010-NINNASIKBN(3)    NOT =  SPACE
             OR   WK-2010-NINJYOKBN(3)     NOT =  SPACE
             OR   WK-2010-NINNASIKBN-K(3)  NOT =  SPACE
                  MOVE  LNK-SYU-KOH-COMPFTN(2)
                                    TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   WK-2010-NINNASIKBN(4)    NOT =  SPACE
             OR   WK-2010-NINJYOKBN(4)     NOT =  SPACE
             OR   WK-2010-NINNASIKBN-K(4)  NOT =  SPACE
                  MOVE  LNK-SYU-KOH-COMPFTN(3)
                                    TO  LNK-SYU-JYO-HKNFTNMONEY
             END-IF
      *
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  +    5
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  /   10
             COMPUTE  LNK-SYU-JYO-HKNFTNMONEY  =
                      LNK-SYU-JYO-HKNFTNMONEY  *   10
      *
             IF  (LNK-SYU-KOH1HKNNUM   = "972" OR "974" )
             OR  (LNK-SYU-KOH2HKNNUM   = "972" OR "974" )
             OR  (LNK-SYU-KOH3HKNNUM   = "972" OR "974" )
             OR  (LNK-SYU-KOH4HKNNUM   = "972" OR "974" )
                MOVE      ZERO     TO    LNK-SYU-JYO-HKNFTNMONEY
             END-IF
             IF   WK-GENGAKUKBN    NOT  =   ZERO
                MOVE      ZERO     TO    LNK-SYU-JYO-HKNFTNMONEY
             END-IF
      *
           END-IF
      *
           .
      *
       23095-OITA-TOKUSYU-KEISAN-EXT.
           EXIT.
      *
      ******************************************************************
      *
      ******************************************************************
       230951-OITA-TOKUSYU-HENSYU-SEC         SECTION.
      *
           COMPUTE  WK-KOUREI-IRYOHI70         =
                    WK-KOUREI-IRYOHI70         -
                   (WK-KOUREI-IRYOHI70-JYOGAI2 +
                    WK-KOUREI-IRYOHI70-JYOGAI)
      *
           COMPUTE  WK-FUTANWARI    =  WK-KOH-FTNRATE  /  100
           COMPUTE  WK-OITA-KEISAN  =  WK-KOUREI-IRYOHI70
                                    *  WK-FUTANWARI
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  +    5
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  /   10
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  *   10
      *
           COMPUTE  WK-OITA-KEISAN  =  WK-OITA-KEISAN
                                    +  WK-OITA-HKNFTNMONEY
      *
           IF   WK-OITA-KEISAN   >  MAX-KIN-SYU-M
             COMPUTE  WK-OITA-CYOFTN-KON  =  WK-OITA-KEISAN
                                          -  MAX-KIN-SYU-M
             IF  WK-OITA-CYOFTN-KON   >  WK-OITA-CYOFTN
                COMPUTE WK-OITA-CYOFTN-KON  = WK-OITA-CYOFTN-KON
                                            - WK-OITA-CYOFTN
             ELSE
                MOVE    ZERO    TO    WK-OITA-CYOFTN-KON
             END-IF
           END-IF
      *
           .
      *
       230951-OITA-TOKUSYU-HENSYU-EXT.
           EXIT.
      *
      ******************************************************************
      *
      ******************************************************************
       230952-OITA-TOKUSYU-HENSYU2-SEC         SECTION.
      *
           IF   WK-GENGAKUKBN    NOT  =   ZERO
             MOVE    ZERO    TO    LNK-SYU-JYO-HKNFTNMONEY
             MOVE    ZERO    TO    LNK-SYU-JYO-COMPFTN
             MOVE    ZERO    TO    WK-OITA-CYOFTN-KON
           END-IF
      *
           IF      WK-OITA-CYOFTN-KON   NOT  =  ZERO
             MOVE    WK-OITA-CYOFTN-KON  TO  LNK-SYU-JYO-COMPFTN
      *      ÀÁµá³Û¤Ë²Ã»»
             COMPUTE  LNK-SYU-SKYMONEY  =
                      LNK-SYU-SKYMONEY  +    5
             COMPUTE  LNK-SYU-SKYMONEY  =
                      LNK-SYU-SKYMONEY  /   10
             COMPUTE  LNK-SYU-SKYMONEY  =
                      LNK-SYU-SKYMONEY  *   10
             ADD     WK-OITA-CYOFTN-KON  TO  LNK-SYU-SKYMONEY
                                             WK-KNJFTNKIN
                                             WK-KNJFTNKIN-ENTANI
             MOVE    1                   TO  FLG-KOUGAKUCYO-OITA
           END-IF
      *
           .
      *
       230952-OITA-TOKUSYU-HENSYU2-EXT.
           EXIT.
      *
      ******************************************************************
      *
      ******************************************************************
       230953-OITA-TOKUSYU-HENSYU3-SEC         SECTION.
      *
           IF   FLG-OITA-SYUKEI  =  1
             COMPUTE  WK-KOUREI-IRYOHI70  =
                      WK-KOUREI-IRYOHI70  +
                     (LNK-SYU-HKNTEN(17)  * 10)
           END-IF
      *
           COMPUTE    WK-KOUREI-IRYOHI70  =
                      WK-KOUREI-IRYOHI70  -
                      WK-KOUREI-IRYOHI70-JYOGAI2
      *
           IF   FLG-TOKU75  =  3
             IF   (FLG-IRYOHI70          =   ZERO)
             AND  (FLG-KOHYONKAIME       =    1  )
             AND  (WK-2010-NINJYOKBN(1)  =   "2" )
               IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                 EVALUATE  FLG-GENBUTU70-KBN
                  WHEN      11
                   MOVE   70050  TO  WK-OITA-KEISAN2
                   MOVE   22200  TO  WK-OITA-KEISAN3
                  WHEN      12
                   MOVE   46500  TO  WK-OITA-KEISAN2
                   MOVE   22200  TO  WK-OITA-KEISAN3
                 END-EVALUATE
               ELSE
                   MOVE   41700  TO  WK-OITA-KEISAN2
                   MOVE   22200  TO  WK-OITA-KEISAN3
               END-IF
             ELSE
               IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                 EVALUATE  FLG-GENBUTU70-KBN
                  WHEN      11
                   MOVE  126300  TO  WK-OITA-KEISAN2
                   MOVE   40050  TO  WK-OITA-KEISAN3
                   IF  WK-KOUREI-IRYOHI70  >  421000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 421000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN2 =
                             WK-OITA-KEISAN2 +
                             WK-KOUREI-IRYOHI70X
                   END-IF
                  WHEN      12
                   MOVE   83700  TO  WK-OITA-KEISAN2
                   MOVE   40050  TO  WK-OITA-KEISAN3
                   IF  WK-KOUREI-IRYOHI70  >  279000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 279000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN2 =
                             WK-OITA-KEISAN2 +
                             WK-KOUREI-IRYOHI70X
                   END-IF
                 END-EVALUATE
               ELSE
                   MOVE   75000  TO  WK-OITA-KEISAN2
                   MOVE   40050  TO  WK-OITA-KEISAN3
                   IF  WK-KOUREI-IRYOHI70  >  250000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 250000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN2 =
                             WK-OITA-KEISAN2 +
                             WK-KOUREI-IRYOHI70X
                   END-IF
               END-IF
               IF  WK-KOUREI-IRYOHI70  >  133500
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 133500)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN3 =
                             WK-OITA-KEISAN3 +
                             WK-KOUREI-IRYOHI70X
               END-IF
             END-IF
           ELSE
             IF   (FLG-IRYOHI70          =   ZERO)
             AND  (FLG-KOHYONKAIME       =    1  )
             AND  (WK-2010-NINJYOKBN(1)  =   "2" )
               IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                 EVALUATE  FLG-GENBUTU70-KBN
                  WHEN      11
                   MOVE  140100  TO  WK-OITA-KEISAN2
                   MOVE   44400  TO  WK-OITA-KEISAN3
                  WHEN      12
                   MOVE   93000  TO  WK-OITA-KEISAN2
                   MOVE   44400  TO  WK-OITA-KEISAN3
                 END-EVALUATE
               ELSE
                   MOVE   83400  TO  WK-OITA-KEISAN2
                   MOVE   44400  TO  WK-OITA-KEISAN3
               END-IF
             ELSE
               IF  LNK-SYU-SRYYMD(1:6) >= "201501"
                 EVALUATE  FLG-GENBUTU70-KBN
                  WHEN      11
                   MOVE  252600  TO  WK-OITA-KEISAN2
                   MOVE   80100  TO  WK-OITA-KEISAN3
                   IF  WK-KOUREI-IRYOHI70  >  842000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 842000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN2 =
                             WK-OITA-KEISAN2 +
                             WK-KOUREI-IRYOHI70X
                   END-IF
                  WHEN      12
                   MOVE  167400  TO  WK-OITA-KEISAN2
                   MOVE   80100  TO  WK-OITA-KEISAN3
                   IF  WK-KOUREI-IRYOHI70  >  558000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 558000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN2 =
                             WK-OITA-KEISAN2 +
                             WK-KOUREI-IRYOHI70X
                   END-IF
                 END-EVALUATE
               ELSE
                   MOVE  150000  TO  WK-OITA-KEISAN2
                   MOVE   80100  TO  WK-OITA-KEISAN3
                   IF  WK-KOUREI-IRYOHI70  >  500000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 500000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN2 =
                             WK-OITA-KEISAN2 +
                             WK-KOUREI-IRYOHI70X
                   END-IF
               END-IF
               IF  WK-KOUREI-IRYOHI70  >  267000
                     COMPUTE WK-KOUREI-IRYOHI70X =
                           ((WK-KOUREI-IRYOHI70  - 267000)
                                             *  0.01  ) + 0.5
                     COMPUTE WK-OITA-KEISAN3 =
                             WK-OITA-KEISAN3 +
                             WK-KOUREI-IRYOHI70X
               END-IF
             END-IF
           END-IF
      *
           COMPUTE  WK-KOUREI-IRYOHI70         =
                    WK-KOUREI-IRYOHI70         -
                    WK-KOUREI-IRYOHI70-JYOGAI
      *
           COMPUTE  WK-FUTANWARI    =  WK-KOH-FTNRATE  /  100
           COMPUTE  WK-OITA-KEISAN  =  WK-KOUREI-IRYOHI70
                                    *  WK-FUTANWARI
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  +    5
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  /   10
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  *   10
      *
           COMPUTE  WK-OITA-KEISAN       =
                    WK-OITA-KEISAN       +
                    WK-OITA-HKNFTNMONEY
      *
           IF   WK-OITA-KEISAN   <  WK-OITA-KEISAN2
               MOVE   WK-OITA-KEISAN   TO   WK-OITA-KEISAN2
           END-IF
      ***  IF   WK-OITA-KEISAN   <  WK-OITA-KEISAN3
      ***      MOVE   WK-OITA-KEISAN   TO   WK-OITA-KEISAN3
      ***  END-IF
           IF   WK-OITA-KEISAN2  >  WK-OITA-KEISAN3
             COMPUTE   WK-OITA-CYOFTN-KON = WK-OITA-KEISAN2
                                          - WK-OITA-KEISAN3
             IF   WK-OITA-CYOFTN-KON  >  WK-OITA-CYOFTN
               COMPUTE WK-OITA-CYOFTN-KON = WK-OITA-CYOFTN-KON
                                          - WK-OITA-CYOFTN
             ELSE
               MOVE    ZERO            TO   WK-OITA-CYOFTN-KON
             END-IF
           END-IF
      *
           .
      *
       230953-OITA-TOKUSYU-HENSYU3-EXT.
           EXIT.
      *
      ******************************************************************
      *
      ******************************************************************
       230954-OITA-TOKUSYU-HENSYU4-SEC         SECTION.
      *
           IF   FLG-OITA-SYUKEI  =  1
             COMPUTE  WK-KOUREI-IRYOHI  =
                      WK-KOUREI-IRYOHI  +
                     (LNK-SYU-HKNTEN(17)  * 10)
           END-IF
      *
           COMPUTE    WK-KOUREI-IRYOHI         =
                      WK-KOUREI-IRYOHI         -
                     (WK-KOUREI-IRYOHI-JYOGAI2 +
                      WK-KOUREI-IRYOHI-JYOGAI)
      *
           IF   FLG-TOKU75  =  1 OR 2
             IF   (FLG-IRYOHIKG2            =   ZERO)
             AND  (FLG-KOHYONKAIME          =    1  )
             AND  (WK-2010-NINNASIKBN-K(1)  =   "2" )
                 MOVE   70050  TO  WK-OITA-KEISAN2
                 MOVE   22200  TO  WK-OITA-KEISAN3
             ELSE
                 MOVE  126300  TO  WK-OITA-KEISAN2
                 MOVE   40050  TO  WK-OITA-KEISAN3
                 IF  WK-KOUREI-IRYOHI  >  421000
                   COMPUTE WK-KOUREI-IRYOHI2 =
                         ((WK-KOUREI-IRYOHI  - 421000)
                                             *  0.01  ) + 0.5
                   COMPUTE WK-OITA-KEISAN2 =
                           WK-OITA-KEISAN2 +
                           WK-KOUREI-IRYOHI2
                 END-IF
                 IF  WK-KOUREI-IRYOHI  >  133500
                   COMPUTE WK-KOUREI-IRYOHI2 =
                         ((WK-KOUREI-IRYOHI  - 133500)
                                             *  0.01  ) + 0.5
                   COMPUTE WK-OITA-KEISAN3 =
                           WK-OITA-KEISAN3 +
                           WK-KOUREI-IRYOHI2
                 END-IF
             END-IF
           ELSE
             IF   (FLG-IRYOHIKG2            =   ZERO)
             AND  (FLG-KOHYONKAIME          =    1  )
             AND  (WK-2010-NINNASIKBN-K(1)  =   "2" )
                 MOVE  140100  TO  WK-OITA-KEISAN2
                 MOVE   44400  TO  WK-OITA-KEISAN3
             ELSE
                 MOVE  252600  TO  WK-OITA-KEISAN2
                 MOVE   80100  TO  WK-OITA-KEISAN3
                 IF  WK-KOUREI-IRYOHI  >  842000
                   COMPUTE WK-KOUREI-IRYOHI2 =
                         ((WK-KOUREI-IRYOHI  - 842000)
                                             *  0.01  ) + 0.5
                   COMPUTE WK-OITA-KEISAN2 =
                           WK-OITA-KEISAN2 +
                           WK-KOUREI-IRYOHI2
                 END-IF
                 IF  WK-KOUREI-IRYOHI  >  267000
                   COMPUTE WK-KOUREI-IRYOHI2 =
                         ((WK-KOUREI-IRYOHI  - 267000)
                                             *  0.01  ) + 0.5
                   COMPUTE WK-OITA-KEISAN3 =
                           WK-OITA-KEISAN3 +
                           WK-KOUREI-IRYOHI2
                 END-IF
             END-IF
           END-IF
      *
           COMPUTE  WK-FUTANWARI    =  WK-KOH-FTNRATE  /  100
           COMPUTE  WK-OITA-KEISAN  =  WK-KOUREI-IRYOHI
                                    *  WK-FUTANWARI
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  +    5
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  /   10
           COMPUTE  WK-OITA-KEISAN  =
                    WK-OITA-KEISAN  *   10
      *
           COMPUTE  WK-OITA-KEISAN       =
                    WK-OITA-KEISAN       +
                    WK-OITA-HKNFTNMONEY
      *
           IF   WK-OITA-KEISAN   <  WK-OITA-KEISAN2
               MOVE   WK-OITA-KEISAN   TO   WK-OITA-KEISAN2
           END-IF
      ***  IF   WK-OITA-KEISAN   <  WK-OITA-KEISAN3
      ***      MOVE   WK-OITA-KEISAN   TO   WK-OITA-KEISAN3
      ***  END-IF
           IF   WK-OITA-KEISAN2  >  WK-OITA-KEISAN3
             COMPUTE   WK-OITA-CYOFTN-KON = WK-OITA-KEISAN2
                                          - WK-OITA-KEISAN3
             IF   WK-OITA-CYOFTN-KON  >  WK-OITA-CYOFTN
               COMPUTE WK-OITA-CYOFTN-KON = WK-OITA-CYOFTN-KON
                                          - WK-OITA-CYOFTN
             ELSE
               MOVE    ZERO            TO   WK-OITA-CYOFTN-KON
             END-IF
           END-IF
      *
           .
      *
       230954-OITA-TOKUSYU-HENSYU4-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¸½ÊªµëÉÕ¤Ë´Ø¤¹¤ëÂÐ¾Ý¥Ç¡¼¥¿¥Õ¥é¥°ÊÔ½¸
      ******************************************************************
       23096-GENBUTU-TAISYODATA-SEC         SECTION.
      *
           IF  (FLG-GENBUTU70       NOT =   ZERO)
           AND (FLG-GENBUTU-TAISYODATA  =    1  )
           AND (FLG-OITA-GENBUTU70      =   ZERO)
      *
               MOVE      ZERO            TO    FLG-GENBUTU-TAISYOOK
      *
               IF  ((COMB-KOH1HKNNUM   =  SPACE OR "970") AND
                    (COMB-KOH2HKNNUM   =  SPACE         ) AND
                    (COMB-KOH3HKNNUM   =  SPACE         ) AND
                    (COMB-KOH4HKNNUM   =  SPACE         ))
               OR  ((COMB-KOH1HKNNUM   =  "092"         ) AND
                    (WK-KOHJGNGET-CHECK092(1) = 1       ) AND
                    (COMB-KOH2HKNNUM   =  SPACE         ) AND
                    (COMB-KOH3HKNNUM   =  SPACE         ) AND
                    (COMB-KOH4HKNNUM   =  SPACE         ))
                         MOVE    1       TO    FLG-GENBUTU-TAISYOOK
               ELSE
                   IF   (COMB-KOH1HKNNUM  NOT = SPACE          )
                   AND  (COMB-KOH1HKNNUM  NOT = "972" AND "974")
                     IF   (COMB-KOH1HKNNUM    =  "092" )
                     AND  (WK-KOHJGNGET-CHECK092(1) = 1)
                      CONTINUE
                     ELSE
                      IF  WK-GENBUTU-KOH1COMPFTN  NOT = ZERO
                         MOVE    1       TO    FLG-GENBUTU-TAISYOOK
                      END-IF
                     END-IF
                   END-IF
                   IF   (COMB-KOH2HKNNUM  NOT = SPACE          )
                   AND  (COMB-KOH2HKNNUM  NOT = "972" AND "974")
                      IF  WK-GENBUTU-KOH2COMPFTN  NOT = ZERO
                         MOVE    1       TO    FLG-GENBUTU-TAISYOOK
                      END-IF
                   END-IF
                   IF   (COMB-KOH3HKNNUM  NOT = SPACE          )
                   AND  (COMB-KOH3HKNNUM  NOT = "972" AND "974")
                      IF  WK-GENBUTU-KOH3COMPFTN  NOT = ZERO
                         MOVE    1       TO    FLG-GENBUTU-TAISYOOK
                      END-IF
                   END-IF
                   IF   (COMB-KOH4HKNNUM  NOT = SPACE          )
                   AND  (COMB-KOH4HKNNUM  NOT = "972" AND "974")
                      IF  WK-GENBUTU-KOH4COMPFTN  NOT = ZERO
                         MOVE    1       TO    FLG-GENBUTU-TAISYOOK
                      END-IF
                   END-IF
               END-IF
      *
               IF   FLG-GENBUTU-TAISYOOK  =  1
                   MOVE    "9"    TO    LNK-SYU-KOHTAIYKZKBN
               END-IF
      *
           END-IF
      *
           .
      *
       23096-GENBUTU-TAISYODATA-EXT.
           EXIT.
      *
      ******************************************************************
      *        ÆüÊÌ¼ýÇ¼»»Äê¡ÊÁ´¹ñ¸øÈñ¡Ë
      ******************************************************************
       230A-DAYINF-SANTEI-ZENKOH-SEC           SECTION.
      *
           MOVE  WK-GENGAKU-KIN2
                           TO    WK-TAIHI-GENGAKU-KIN
           MOVE  WK-GENGAKU-KIN2-ENTANI
                           TO    WK-TAIHI-GENGAKU-KIN-ENTANI
      *
           MOVE     1      TO    WK-DAYINF-ZENKOH-FLG(KOH-IDX)
      *
           MOVE    "1"     TO    LNK-SDAY-DAYINFFLG
      *
           MOVE  WK-DAY-NYUKFTNRATE       TO  WK-DAY-NYUKFTNRATE9
           MOVE  WK-DAY-NYUKFTNRATE-FLG   TO  WK-DAY-NYUKFTNRATE-FLG9
           IF    WK-NYUKFTNRATE    NOT =  ZERO
             IF    WK-DAY-NYUKFTNRATE9      =  ZERO
             AND   WK-DAY-NYUKFTNRATE-FLG9  =  ZERO
                 MOVE  WK-NYUKFTNRATE     TO  WK-DAY-NYUKFTNRATE9
             ELSE
               IF  WK-DAY-NYUKFTNRATE9  > WK-NYUKFTNRATE
                 MOVE  WK-NYUKFTNRATE     TO  WK-DAY-NYUKFTNRATE9
               END-IF
             END-IF
           END-IF
      *
           COMPUTE   WK-FUTANWARI  =  WK-DAY-NYUKFTNRATE9  /  100
      *
           PERFORM    VARYING   IDX2   FROM   1   BY   1
                       UNTIL    IDX2     >   31
      *
             IF  (LNK-SYU-DAY(IDX2) = "1" OR "2" OR "8" OR "9")
             AND (LNK-SDAY-HKNTEN(IDX2)  NOT =  ZERO          )
      *
                 MOVE   99999    TO    WK-DAY-COMPFTN
      *
                 MOVE    1       TO    LNK-SDAY-SANTEIFLG(IDX2 KOH-IDX)
      *
                 MOVE   ZERO     TO    WK-TAIHI-SDAY-COMPFTN
                                       WK-TAIHI-SDAY-COMPFTNWK
                                       WK-TAIHI-SDAY-FTNMONEY
      *
                 IF     WK-DAY-NYUKFTNRATE9    NOT =    ZERO
                   COMPUTE   WK-TAIHI-SDAY-COMPFTN   =
                             LNK-SDAY-HKNTEN(IDX2)   *
                             HKN-TENTNK              *
                             WK-FUTANWARI
                   COMPUTE   WK-TAIHI-SDAY-COMPFTNWK =
                             LNK-SDAY-HKNTEN(IDX2)   *
                             HKN-TENTNK              *
                             WK-FUTANWARI
      *            ¸º³Û
                   MOVE      999   TO     WK-NYUKFTNRATE2
                   MOVE      1     TO     FLG-GENGAKU-HENSYU
                   PERFORM   230A1-KOH-GENGAKU-HENSYU-SEC
                   IF  WK-GENGAKUKBN  NOT =  ZERO
                       MOVE  WK-GENGAKU-GAK
                              TO  WK-TAIHI-SDAY-COMPFTN
                       MOVE  WK-GENGAKU-GAK-ENTANI
                              TO  WK-TAIHI-SDAY-COMPFTNWK
                   END-IF
                 ELSE
                   COMPUTE   WK-TAIHI-SDAY-COMPFTN   =
                             LNK-SDAY-HKNTEN(IDX2)   *
                             HKN-TENTNK
                   COMPUTE   WK-TAIHI-SDAY-COMPFTNWK =
                             LNK-SDAY-HKNTEN(IDX2)   *
                             HKN-TENTNK
                 END-IF
      *
                 IF  (LNK-SYU-SYUHKNNUM     NOT =   SPACE)
                 AND (LNK-SYU-SYUCOMPFTN        =   ZERO )
                   MOVE    ZERO  TO  WK-TAIHI-SDAY-COMPFTN
                                     WK-TAIHI-SDAY-COMPFTNWK
                 END-IF
      *
                 IF  WK-TAIHI-SDAY-COMPFTNWK
                                           > WK-TAIHI-ZAN-KOHI-T3
                   MOVE    WK-TAIHI-ZAN-KOHI-T3
                                 TO  WK-TAIHI-SDAY-COMPFTNWK
                   MOVE    ZERO  TO  WK-TAIHI-ZAN-KOHI-T3
                 ELSE
                   COMPUTE     WK-TAIHI-ZAN-KOHI-T3   =
                               WK-TAIHI-ZAN-KOHI-T3   -
                               WK-TAIHI-SDAY-COMPFTNWK
                 END-IF
      *
                 IF ( LNK-SYU-KOH-HKNNUM(KOH-IDX) = "051"          )
                 OR ( HKN-RECEFTNDSPKBN           = "2"            )
                 OR ((LNK-SYU-SRYYMD(1:6)        >= "200404"      ) AND
                     (LNK-SYU-KOH-HKNNUM(KOH-IDX) = "015" OR "016"))
                   IF    WK-TAIHI-SDAY-COMPFTN
                                           > WK-TAIHI-ZAN-KOHI-T2
                     MOVE  WK-TAIHI-ZAN-KOHI-T2
                                 TO  WK-DAY-COMPFTN
                     MOVE  ZERO  TO  WK-TAIHI-ZAN-KOHI-T2
                   ELSE
                     MOVE  WK-TAIHI-SDAY-COMPFTN
                                 TO  WK-DAY-COMPFTN
                     COMPUTE     WK-TAIHI-ZAN-KOHI-T2   =
                                 WK-TAIHI-ZAN-KOHI-T2   -
                                 WK-TAIHI-SDAY-COMPFTN
                   END-IF
                 END-IF
      *
                 COMPUTE   WK-TAIHI-SDAY-COMPFTN  =
                           WK-TAIHI-SDAY-COMPFTN  +   5
                 COMPUTE   WK-TAIHI-SDAY-COMPFTN  =
                           WK-TAIHI-SDAY-COMPFTN  /  10
                 COMPUTE   WK-TAIHI-SDAY-COMPFTN  =
                           WK-TAIHI-SDAY-COMPFTN  *  10
                 IF  WK-TAIHI-SDAY-COMPFTN > WK-TAIHI-ZAN-KOHI-T
                   MOVE    WK-TAIHI-ZAN-KOHI-T
                                 TO  WK-TAIHI-SDAY-COMPFTN
                   MOVE    ZERO  TO  WK-TAIHI-ZAN-KOHI-T
                   IF    WK-TAIHI-FTNGAKEN(KOH-IDX)   =   1
                     CONTINUE
                   ELSE
                     COMPUTE   WK-TAIHI-SDAY-COMPFTN  =
                               WK-TAIHI-SDAY-COMPFTN  +   5
                     COMPUTE   WK-TAIHI-SDAY-COMPFTN  =
                               WK-TAIHI-SDAY-COMPFTN  /  10
                     COMPUTE   WK-TAIHI-SDAY-COMPFTN  =
                               WK-TAIHI-SDAY-COMPFTN  *  10
                   END-IF
                 ELSE
                   COMPUTE     WK-TAIHI-ZAN-KOHI-T    =
                               WK-TAIHI-ZAN-KOHI-T    -
                               WK-TAIHI-SDAY-COMPFTN
                 END-IF
      *          ·î¾å¸Â³Û¤ËÃ£¤·¤¿Æü°Ê¹ß¡ÊÃ£¤·¤¿Æü¤ò´Þ¤à¡Ë¤Ï£²¤ò¥»¥Ã¥È
                 IF   WK-TAIHI-ZAN-KOHI-T = ZERO
                   MOVE    2     TO  LNK-SDAY-SANTEIFLG(IDX2 KOH-IDX)
                 END-IF
      *
                 MOVE  WK-TAIHI-SDAY-COMPFTN
                                 TO  WK-TAIHI-SDAY-FTNMONEY
      *
                 IF    WK-DAY-COMPFTN  =  ALL"9"
                   CONTINUE
                 ELSE
                   MOVE  WK-DAY-COMPFTN
                                 TO  WK-TAIHI-SDAY-COMPFTN
                 END-IF
      *
                 MOVE  WK-TAIHI-SDAY-COMPFTN
                                 TO  LNK-SDAY-COMPFTN(IDX2 KOH-IDX)
                 MOVE  WK-TAIHI-SDAY-FTNMONEY
                                 TO  LNK-SDAY-FTNMONEY(IDX2 KOH-IDX)
                 MOVE  WK-TAIHI-SDAY-COMPFTNWK
                                 TO  LNK-SDAY-COMPFTNWK(IDX2 KOH-IDX)
      *
             END-IF
      *
             EVALUATE   WK-NYUSKJRYYKBN
               WHEN      "1"
                 MOVE  WK-DAY-SKJFTN(IDX2)
                                 TO  LNK-SDAY-SKJFTN(IDX2 KOH-IDX)
      *
                 EVALUATE  FLG-NYUSKJJYOGAK
                   WHEN     1
                     IF  LNK-SDAY-SKJFTN(IDX2 KOH-IDX) NOT = ZERO
                       COMPUTE LNK-SDAY-SKJFTN(IDX2 KOH-IDX) =
                               LNK-SDAY-SKJFTN(IDX2 KOH-IDX) /  2
                     END-IF
                 END-EVALUATE
             END-EVALUATE
      *
           END-PERFORM
      *
      *    ¼ýÇ¼¹àÌÜ
      *
           MOVE    "1"     TO    LNK-SYU-DAYINFFLG
      *
      ***
      *
           IF    WK-TAIHI-FTNGAKEN(KOH-IDX)   =   1
             MOVE   LNK-SYU-KOH-COMPFTN(KOH-IDX)
                           TO    WK-DAYTAIHI-FTNMONEY
           ELSE
             COMPUTE  WK-DAYTAIHI-FTNMONEY          =
                      LNK-SYU-KOH-COMPFTN(KOH-IDX)  +   5
             COMPUTE  WK-DAYTAIHI-FTNMONEY          =
                      WK-DAYTAIHI-FTNMONEY          /  10
             COMPUTE  WK-DAYTAIHI-FTNMONEY          =
                      WK-DAYTAIHI-FTNMONEY          *  10
           END-IF
      *
           PERFORM    VARYING   IDX2   FROM   1   BY   1
                       UNTIL    IDX2     >   31
             IF  (WK-DAYTAIHI-FTNMONEY <
                        WK-DAYINF-ZENKOH-ZAN-T(KOH-IDX))
             AND (LNK-SDAY-SANTEIFLG(IDX2 KOH-IDX) =  2)
               MOVE   1    TO    LNK-SDAY-SANTEIFLG(IDX2 KOH-IDX)
             END-IF
           END-PERFORM
      *
           .
      *
       230A-DAYINF-SANTEI-ZENKOH-EXT.
           EXIT.
      *
      ******************************************************************
      *    ¸øÈñ°ìÉôÉéÃ´¶â¸º³Û
      ******************************************************************
       230A1-KOH-GENGAKU-HENSYU-SEC           SECTION.
      *
           EVALUATE  WK-GENGAKUKBN
             WHEN        1
               IF  WK-GENGAKUKBN-KEISAN  =  2
                 IF    WK-GENGAKU-RITU     =  ZERO
                 OR    FLG-GENGAKU-HENSYU  =   1
                     MOVE  WK-TAIHI-SDAY-COMPFTN
                                 TO  WK-GENGAKU-GAK
                     MOVE  WK-TAIHI-SDAY-COMPFTNWK
                                 TO  WK-GENGAKU-GAK-ENTANI
                 ELSE
                   IF  WK-NYUKFTNRATE2  <= WK-GENGAKU-RITU
                     MOVE  ZERO  TO  WK-GENGAKU-GAK
                     MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                   ELSE
                     COMPUTE  WK-FUTANWARI2   =
                              WK-GENGAKU-RITU / 100
                     COMPUTE  WK-GENGAKU-GAK2         =
                              LNK-SDAY-HKNTEN(IDX2)   *
                              HKN-TENTNK              *
                              WK-FUTANWARI2
                     COMPUTE  WK-GENGAKU-GAK2-ENTANI  =
                              LNK-SDAY-HKNTEN(IDX2)   *
                              HKN-TENTNK              *
                              WK-FUTANWARI2
                     IF  WK-TAIHI-SDAY-COMPFTN
                                 > WK-GENGAKU-GAK2
                       COMPUTE WK-GENGAKU-GAK         =
                               WK-TAIHI-SDAY-COMPFTN  -
                               WK-GENGAKU-GAK2
                     ELSE
                       MOVE  ZERO  TO  WK-GENGAKU-GAK
                     END-IF
                     IF  WK-TAIHI-SDAY-COMPFTNWK
                                 > WK-GENGAKU-GAK2-ENTANI
                       COMPUTE WK-GENGAKU-GAK-ENTANI    =
                               WK-TAIHI-SDAY-COMPFTNWK  -
                               WK-GENGAKU-GAK2-ENTANI
                     ELSE
                       MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                     END-IF
                   END-IF
                 END-IF
               ELSE
                 IF  WK-GENGAKU-RITU = 100
                   MOVE  ZERO  TO  WK-GENGAKU-GAK
                   MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
                 ELSE
                   COMPUTE  WK-GENGAKU-RITUX =
                            100 - WK-GENGAKU-RITU
                   COMPUTE  WK-GENGAKU-GAK               =
                            WK-TAIHI-SDAY-COMPFTN        *
                            WK-GENGAKU-RITUX             /
                            100
                   COMPUTE  WK-GENGAKU-GAK-ENTANI        =
                            WK-TAIHI-SDAY-COMPFTNWK      *
                            WK-GENGAKU-RITUX             /
                            100
                 END-IF
               END-IF
             WHEN        2
               IF  WK-TAIHI-SDAY-COMPFTN
                                     < WK-TAIHI-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-GENGAKU-GAK
                 COMPUTE  WK-TAIHI-GENGAKU-KIN          =
                          WK-TAIHI-GENGAKU-KIN          -
                          WK-TAIHI-SDAY-COMPFTN
               ELSE
                 COMPUTE  WK-GENGAKU-GAK                =
                          WK-TAIHI-SDAY-COMPFTN         -
                          WK-TAIHI-GENGAKU-KIN
                 MOVE   ZERO   TO   WK-TAIHI-GENGAKU-KIN
               END-IF
               IF  WK-TAIHI-SDAY-COMPFTNWK
                                     < WK-TAIHI-GENGAKU-KIN-ENTANI
                 MOVE   ZERO   TO   WK-GENGAKU-GAK-ENTANI
                 COMPUTE  WK-TAIHI-GENGAKU-KIN-ENTANI   =
                          WK-TAIHI-GENGAKU-KIN-ENTANI   -
                          WK-TAIHI-SDAY-COMPFTNWK
               ELSE
                 COMPUTE  WK-GENGAKU-GAK-ENTANI         =
                          WK-TAIHI-SDAY-COMPFTNWK       -
                          WK-TAIHI-GENGAKU-KIN-ENTANI
                 MOVE   ZERO   TO   WK-TAIHI-GENGAKU-KIN-ENTANI
               END-IF
             WHEN        3
             WHEN        4
                 MOVE  ZERO  TO  WK-GENGAKU-GAK
                 MOVE  ZERO  TO  WK-GENGAKU-GAK-ENTANI
             WHEN        5
               IF  WK-TAIHI-SDAY-COMPFTN
                                     < WK-TAIHI-GENGAKU-KIN
                 MOVE  WK-TAIHI-SDAY-COMPFTN
                             TO   WK-GENGAKU-GAK
                 COMPUTE  WK-TAIHI-GENGAKU-KIN          =
                          WK-TAIHI-GENGAKU-KIN          -
                          WK-TAIHI-SDAY-COMPFTN
               ELSE
                 MOVE  WK-TAIHI-GENGAKU-KIN
                             TO   WK-GENGAKU-GAK
                 MOVE   ZERO TO   WK-TAIHI-GENGAKU-KIN
               END-IF
               IF  WK-TAIHI-SDAY-COMPFTNWK
                                     < WK-TAIHI-GENGAKU-KIN-ENTANI
                 MOVE  WK-TAIHI-SDAY-COMPFTNWK
                             TO   WK-GENGAKU-GAK-ENTANI
                 COMPUTE  WK-TAIHI-GENGAKU-KIN-ENTANI   =
                          WK-TAIHI-GENGAKU-KIN-ENTANI   -
                          WK-TAIHI-SDAY-COMPFTNWK
               ELSE
                 MOVE  WK-TAIHI-GENGAKU-KIN-ENTANI
                             TO   WK-GENGAKU-GAK-ENTANI
                 MOVE   ZERO TO   WK-TAIHI-GENGAKU-KIN-ENTANI
               END-IF
           END-EVALUATE
      *
           .
       230A1-KOH-GENGAKU-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÈÖ¹æ¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       HKNNUM-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  HKNNUM-REC
               MOVE    ZERO            TO  FLG-HKNNUM
           ELSE
               INITIALIZE                  HKNNUM-REC
               MOVE    1               TO  FLG-HKNNUM
           END-IF
      *
           .
       HKNNUM-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       HKNCOMBI-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  HKNCOMBI-REC
               MOVE    ZERO            TO  FLG-HKNCOMBI
           ELSE
               INITIALIZE                  HKNCOMBI-REC
               MOVE    1               TO  FLG-HKNCOMBI
           END-IF
      *
           .
       HKNCOMBI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±ÁÈ¹ç¤»¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       HKNCOMBI-READ2-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  WRK-HKNCOMBI-REC
               MOVE    ZERO            TO  FLG-HKNCOMBI
           ELSE
               INITIALIZE                  WRK-HKNCOMBI-REC
               MOVE    1               TO  FLG-HKNCOMBI
           END-IF
      *
           .
       HKNCOMBI-READ2-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍý¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       SYSKANRI-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYS-1001-REC
                                           SYS-1026-REC
                                           SYS-1027-REC
                                           SYS-1037-REC
                                           SYS-2010-REC
                                           SYS-2012-REC
                                           SYS-4001-REC
                                           SYS-4003-REC
                                           SYS-5000-REC
               MOVE    ZERO            TO  FLG-SYSKANRI
           ELSE
               INITIALIZE                  SYS-1001-REC
                                           SYS-1026-REC
                                           SYS-1027-REC
                                           SYS-1037-REC
                                           SYS-2010-REC
                                           SYS-2012-REC
                                           SYS-4001-REC
                                           SYS-4003-REC
                                           SYS-5000-REC
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           .
       SYSKANRI-READ-EXT.
           EXIT.
      *****************************************************************
      *    ¼ýÇ¼¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       SYUNOU-READ-SEC          SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SYU-SYUNOU-REC
               MOVE    ZERO            TO  FLG-SYUNOU
           ELSE
               INITIALIZE                  SYU-SYUNOU-REC
               MOVE    1               TO  FLG-SYUNOU
           END-IF
      *
           .
      *
       SYUNOU-READ-EXT.
           EXIT.
      *****************************************************************
      *    ÆüÊÌ¼ýÇ¼¥Þ¥¹¥¿ÆÉ¹þ
      *****************************************************************
       SYUDAY-READ-SEC          SECTION.
      *
           INITIALIZE                         SYU-SYUDAY-REC
           MOVE    SYU-HOSPNUM        TO      SDAY-HOSPNUM
           MOVE    SYU-NYUGAIKBN      TO      SDAY-NYUGAIKBN
           MOVE    SYU-PTID           TO      SDAY-PTID
           MOVE    SYU-DENPNUM        TO      SDAY-DENPNUM
           MOVE    SYU-SYUDAY-REC     TO      MCPDATA-REC
           MOVE    "DBSELECT"         TO      MCP-FUNC
           MOVE    "tbl_syuday"       TO      MCP-TABLE
           MOVE    "key"              TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"        USING   MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
           IF      MCP-RC             =       ZERO
               MOVE    "DBFETCH"      TO      MCP-FUNC
               MOVE    "tbl_syuday"   TO      MCP-TABLE
               MOVE    "key"          TO      MCP-PATHNAME
               CALL    "ORCDBMAIN"    USING   MCPAREA
                                              MCPDATA-REC
                                              SPA-AREA
               IF      MCP-RC              =   ZERO
                  MOVE   MCPDATA-REC  TO  SYU-SYUDAY-REC
               ELSE
                  INITIALIZE              SYU-SYUDAY-REC
               END-IF
           ELSE
                  INITIALIZE              SYU-SYUDAY-REC
           END-IF
      *
           MOVE     "tbl_syuday"      TO      MCP-TABLE
           MOVE     "key"             TO      MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           .
      *
       SYUDAY-READ-EXT.
           EXIT.
      *****************************************************************
      *    ´µ¼Ô¾ðÊóÆÉ¹þ
      *****************************************************************
       PTINF-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTINF-REC
               MOVE    ZERO            TO  FLG-PTINF
           ELSE
               INITIALIZE                  PTINF-REC
               MOVE    1               TO  FLG-PTINF
           END-IF
      *
           .
       PTINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æþ±¡²ñ·×¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       NYUINACCT-READ-SEC         SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  NYUINACCT-REC
               MOVE    ZERO            TO  FLG-NYUINACCT
           ELSE
               INITIALIZE                  NYUINACCT-REC
               MOVE    1               TO  FLG-NYUINACCT
           END-IF
      *
           .
       NYUINACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ô¥Æ¡¼¥Ö¥ë¤Î¸¡º÷
      *****************************************************************
       TENSU-TBL-SEC               SECTION.
      *
           INITIALIZE                           TNS-TENSU-REC
           MOVE    WK-SRYCD             TO      TNS-SRYCD
           MOVE    LNK-SYU-HOSPNUM      TO      TNS-HOSPNUM
           MOVE    LNK-SYU-SRYYMD       TO      TNS-YUKOSTYMD
           MOVE    LNK-SYU-SRYYMD       TO      TNS-YUKOEDYMD
           MOVE    TNS-TENSU-REC        TO      MCPDATA-REC
           MOVE    "DBSELECT"           TO      MCP-FUNC
           MOVE    "tbl_tensu"          TO      MCP-TABLE
           MOVE    "key"                TO      MCP-PATHNAME
           CALL    "ORCDBMAIN"          USING   MCPAREA
                                                MCPDATA-REC
                                                SPA-AREA
           IF      MCP-RC               =       ZERO
               MOVE    "tbl_tensu"      TO      MCP-TABLE
               MOVE    "key"            TO      MCP-PATHNAME
               PERFORM  TENSU-READ-SEC
           ELSE
               MOVE     1               TO      FLG-TENSU
           END-IF
      *
           IF     FLG-TENSU    =    ZERO
              IF    LNK-SYU-SYUHKNNUM   =   "971" OR "973"
                EVALUATE  LNK-SYU-SYUHKNNUM
                  WHEN       "971"
                    IF   FLG-KENPOJYUNKYO  =  ZERO
                      COMPUTE   WK-KEISAN  =   TNS-TEN    *  1.2
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                    ELSE
                      MOVE   TNS-TEN   TO     WK-KEISAN
                    END-IF
                  WHEN       "973"
                    IF   FLG-KENPOJYUNKYO  =  ZERO
                      COMPUTE   WK-KEISAN  =   TNS-TEN    *  1.2
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  +   5
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  /  10
                      COMPUTE   WK-KEISAN  =   WK-KEISAN  *  10
                      IF    WK-4001-SKJKBN      =   "2"
                         COMPUTE   WK-KEISAN    =   WK-KEISAN  *  1.2
                      END-IF
                    ELSE
                      MOVE   TNS-TEN   TO     WK-KEISAN
                    END-IF
                END-EVALUATE
              ELSE
                 MOVE      TNS-TEN     TO     WK-KEISAN
              END-IF
           ELSE
                 MOVE      ZERO        TO     WK-KEISAN
           END-IF
      *
           MOVE     "tbl_tensu"            TO  MCP-TABLE
           MOVE     "key"                  TO  MCP-PATHNAME
           PERFORM   DB-CLOSE-SEC
      *
           .
       TENSU-TBL-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ôÆÉ¹þ
      *****************************************************************
       TENSU-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  TNS-TENSU-REC
               MOVE    ZERO            TO  FLG-TENSU
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1               TO  FLG-TENSU
           END-IF
      *
           .
       TENSU-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´µ¼Ô¸øÈñ¾ðÊóÆÉ¹þ
      *****************************************************************
       PTKOHINF-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTKOHINF-REC
               MOVE    ZERO            TO  FLG-PTKOHINF
           ELSE
               INITIALIZE                  PTKOHINF-REC
               MOVE    1               TO  FLG-PTKOHINF
           END-IF
      *
           .
       PTKOHINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´µ¼ÔÊÝ¸±¾ðÊóÆÉ¹þ
      *****************************************************************
       PTHKNINF-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTHKNINF-REC
               MOVE    ZERO            TO  FLG-PTHKNINF
           ELSE
               INITIALIZE                  PTHKNINF-REC
               MOVE    1               TO  FLG-PTHKNINF
           END-IF
      *
           .
       PTHKNINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ²ñ·×¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       SRYACCT-READ-SEC        SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  SRYACCT-REC
               MOVE    ZERO               TO  FLG-SRYACCT
           ELSE
               INITIALIZE                     SRYACCT-REC
               MOVE    1                  TO  FLG-SRYACCT
           END-IF
      *
           .
       SRYACCT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       SRYACT-READ-SEC        SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC        TO  SRYACT-REC
               MOVE    ZERO               TO  FLG-SRYACT
           ELSE
               INITIALIZE                     SRYACT-REC
               MOVE    1                  TO  FLG-SRYACT
           END-IF
      *
           .
       SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´µ¼ÔÆþ±¡ÍúÎòÆÉ¹þ
      *****************************************************************
       PTNYUINRRK-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTNYUINRRK-REC
               MOVE    ZERO            TO  FLG-PTNYUINRRK
           ELSE
               INITIALIZE                  PTNYUINRRK-REC
               MOVE    1               TO  FLG-PTNYUINRRK
           END-IF
      *
           .
       PTNYUINRRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´µ¼ÔÏ«ºÒÊÝ¸±¾ðÊóÆÉ¹þ
      *****************************************************************
       PTRSIINF-READ-SEC           SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  PTRSIINF-REC
               MOVE    ZERO            TO  FLG-PTRSIINF
           ELSE
               INITIALIZE                  PTRSIINF-REC
               MOVE    1               TO  FLG-PTRSIINF
           END-IF
      *
           .
       PTRSIINF-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       DB-CLOSE-SEC                 SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
           CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
      *
       DB-CLOSE-EXT.
           EXIT.
