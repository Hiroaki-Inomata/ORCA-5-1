      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION                            DIVISION.
       PROGRAM-ID.                               ORCGZ03.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ÅÀ¿ô¥Þ¥¹¥¿ÀßÄê
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ÅÀ¿ô¥Þ¥¹¥¿¿ÇÎÅ¹Ô°ÙÀßÄê²èÌÌ¡Ê£Ú£°£³¡Ë
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  00/12/01    MCC¡ÝÆ£¸¶¡¡   ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *  01.00.01    MCC-Â¿¡¹Ç¼   01/07/03  ÆüÉÕÆþÎÏ¥Á¥§¥Ã¥¯¥µ¥ÖÄÉ²Ã
      *  01.00.02    MCC-Â¿¡¹Ç¼   01/07/04  Ï·¿Í°ìÈÌ¥³¡¼¥É¿¶ÂØÄÉ²Ã
      *                                         ¡Ê£Ú£¹£°¡Ë
      *  01.01.01    MCC-Æ£¸¶     01/09/26  JOIN¤Î½¤Àµ      
      *  01.01.02    MCC-Æ£¸¶     01/10/29  ºÎ·ìÎÁ¶èÊ¬¤Î½¤Àµ      
      *  01.01.03    MCC-Â¿¡¹Ç¼   02/03/17  »ÜÀß´ð½àÉÔÅ¬¹ç¤ÎÄÉ²Ã  
      *  01.01.04    MCC-Â¿¡¹Ç¼   02/07/18  ÉþÍÑÊýË¡²èÌÌÄÉ²Ã
      *  01.01.05    NACL-Â¿¡¹Ç¼  02/10/09  ¿ÇÎÅ¼ïÊÌ¤ÎºÇÂç¿ô¤ò£±£°£°¤Ø
      *                                     È¾³Ñ¶õÇò¢ªÁ´³Ñ¶õÇòÄÉ²Ã
      *  01.01.06    NACL-Â¿¡¹Ç¼  02/12/02  ¿©»öÄÉ²Ã
      *  01.01.07    NACL-Â¿¡¹Ç¼  02/12/20  ÅÀ¿ô¼±ÊÌ£¸ ÄÉ²Ã
      *  01.01.08    NACL-Â¿¡¹Ç¼  03/01/24  Æþ±¡ÄÉ²Ã
      *  01.01.09    NACL-Â¿¡¹Ç¼  03/03/17  »ØÆ³´ÉÍýÎÁÌÀºÙÄÉ²Ã
      *  02.00.00    NACL-Â¿¡¹Ç¼  03/06/20  °ì³çÆþÎÏ¤ØÊÑ¹¹
      *  02.00.01    NACL-Â¿¡¹Ç¼  03/12/19  ÆþÎÏ£Ã£Ä¤Î¤ßÊÑ¹¹²ÄÇ½¤Ø
      *  02.00.02    NACL-Â¿¡¹Ç¼  05/12/09  ÅÐÏ¿¥³¡¼¥É¥Á¥§¥Ã¥¯ÄÉ²Ã
      *                                     MONFUNCÂÐ±þ Â¾
      *  02.00.03    NACL-Â¿¡¹Ç¼  06/03/23  £È£±£¸¡¿£´²þÀµÂÐ±þ
      *  03.04.00    NACL-Â¿¡¹Ç¼  06/12/05  ¥æ¡¼¥¶ÀßÄê ¾å¸Â²ó¿ôÄÉ²Ã
      *  03.05.00    NACL-Â¿¡¹Ç¼  07/05/07  ¥°¥ë¡¼¥×¿ÇÎÅÂÐ±þ
      *  03.05.01    NACL-Â¿¡¹Ç¼  07/07/XX  ¥æ¡¼¥¶ÀßÄê Â¾·î¾ðÊóÄÉ²Ã
      *  04.02.00    NACL-Â¿¡¹Ç¼  08/03/XX  Ê¿À®£²£°Ç¯£´·î²þÀµÂÐ±þ
      *  04.04.00    NACL-Â¿¡¹Ç¼  09/01/05  Á°²ó¸¡ººÆü¶èÊ¬ÄÉ²Ã
      *  04.05.00    NACL-Â¿¡¹Ç¼  10/03/XX  Ê¿À®£²£²Ç¯£´·î²þÀµÂÐ±þ
      *  04.05.00    NACL-Â¿¡¹Ç¼  10/04/XX  Ä¢É¼Ì¾¾ÎÄÉ²ÃÂÐ±þ
      *  04.06.00    NACL-Â¿¡¹Ç¼  10/10/19  ½ýÉÂ´ØÏ¢¶èÊ¬ÄÉ²ÃÂÐ±þ¡¢»ÜÀß´ð½à£´·åÂÐ±þÂ¾
      *  04.07.00    NACL-Â¿¡¹Ç¼  14/03/XX  Ê¿À®£²£¶Ç¯£´·î²þÀµÂÐ±þ
      *                                    ¡ÊDPC¶èÊ¬¡¢ÉûÉ¡¹ÐÅù²Ã»»Åù¡Ë
      *  04.08.00    NACL-Â¿¡¹Ç¼  16/03/XX  £È£²£¸Ç¯£´·î²þÀµÂÐ±þ
      *  05.01.00    NACL-Â¿¡¹Ç¼  17/02/XX  ¥æ¡¼¥¶¡¼ÀßÄêÂ¾GINBEEÂÐ±þ
      *  04.08.00    NACL-Â¿¡¹Ç¼  16/03/XX  £È£³£°Ç¯£´·î²þÀµÂÐ±þ
      *  05.01.00    NACL-Â¿¡¹Ç¼  19/10/30  Ï·¿Í°ìÈÌ¥³¡¼¥É¿¶ÂØÃæ»ßÂÐ±þ
      *  05.00.00    NACL-Â¿¡¹Ç¼  20/03/XX  £Ò£°£²Ç¯£´·î²þÀµÂÐ±þ
      *****************************************************************
      *
       ENVIRONMENT                               DIVISION.
       CONFIGURATION                             SECTION.
       INPUT-OUTPUT                              SECTION.
       FILE-CONTROL.
      *
      *
       DATA                                      DIVISION.
      *FILE                                      SECTION.
      *
       WORKING-STORAGE                           SECTION.
      *
      *
      *    ¥¹¥ÑÎÎ°è
           COPY    "COMMON-SPA".
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ÀßÄêÍÑ¶¦ÄÌ¥Ñ¥é¥á¥¿
           COPY    "Z01COMMON-SPA".
      *
      *
      *    Âè°ì²èÌÌ£Ó£Ð£Á¥¨¥ê¥¢
           COPY    "Z01SCR-SPA".
      *
      *    £Ó£Ð£Á¥¨¥ê¥¢
           COPY    "Z03SCR-SPA".
      *
      *    ¥æ¡¼¥¶¡¼ÀßÄê£Ó£Ð£Á¥¨¥ê¥¢
           COPY    "Z010SCR-SPA".
      *
      *    ²èÌÌ¿§Åù
           COPY    "ENUM-VALUE".
      *
      *    ¥Õ¥é¥°¥¨¥ê¥¢
       01  FLG-AREA.
           03  FLG-END                           PIC 9(01).
           03  FLG-SRYCDCHG        PIC 9(01).
           03  FLG-TENSU           PIC 9(01).
           03  FLG-TENSUPLUS       PIC 9(01).
      *
           03  FLG-OK              PIC 9(01).
           03  FLG-ERR             PIC 9(01).
           03  FLG-TOUROKU         PIC 9(01).
      *R01.10
           03  FLG-USERIN          PIC 9(01).
      *
      *    ¥«¥¦¥ó¥ÈÎÎ°è
       01  CNT-AREA.
           03  CNT-ERR                           PIC 9(06).
           03  CNT-PAGE                          PIC 9(02).
           03  CNT-ERRCHK                        PIC 9(03).
           03  CNT-STRING                        PIC 9(03).
      *
           03  CNT-CHK                           PIC 9(04).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX                               PIC 9(04).
           03  IDX-1                             PIC 9(04).
           03  IDX-2                             PIC 9(04).
           03  IDXX                              PIC 9(04).
      *
           03  IDX-T                             PIC 9(04).
      *
           03  IDX1                              PIC 9(04).
           03  IDX2                              PIC 9(04).
           03  IDX-H                             PIC 9(04).
      *
      *    ¥ï¡¼¥¯ÎÎ°è
       01  WRK-AREA.
           03  WRK-GMN-CUR                       PIC X(30).
           03  WRK-ZIDMSG                        PIC X(70).
           03  WRK-SNUM-INX                      PIC X(26).
           03  WRK-STRINGTBL.
               05  WRK-STRING                    PIC X(01)  OCCURS 200.
           03  WRK-LNKYMD                        PIC X(10).
           03  WRK-WYMD.
               05  WRK-WGO                       PIC X(01).
               05  WRK-WYY                       PIC 9(02).
               05  WRK-WMM                       PIC 9(02).
               05  WRK-WDD                       PIC 9(02).
           03  WRK-SYMD.
               05  WRK-SYY         PIC 9(04).
               05  WRK-SMM         PIC 9(02).
               05  WRK-SDD         PIC 9(02).
      *
           03  WRK-SRYKBN              PIC X(03).
      *
           03  WRK-AGEKSNKGN           PIC X(02).
           03  WRK-AGEKSNJGN           PIC X(02).
      *
           03  WRK-PAGE            PIC 9(01).
      *
           03  WRK-YMD             PIC X(08).
           03  WRK-OTYMD           PIC X(08).
      *
           03  WRK-MAE-INPUT       PIC X(400).
           03  WRK-OUT-INPUT       PIC X(400).
           03  WRK-LEN             PIC 9(04).
      *
           03  WRK-YUKOEDYMD       PIC X(08).
      *
           03  WRK-MCP-WIDGET      PIC X(64).
      *    ¹¹¿·¥Æ¡¼¥Ö¥ëÌ¾¾Î
           03  WRK-MCP-TABLE       PIC X(64).
           03  WRK-MCP-PATHNAME       PIC X(64).
      *
      *    ¿ÇÎÅ¼ïÊÌÌ¾¥Æ¡¼¥Ö¥ë
           COPY    "CPORCSSRYSYU.INC".
      *
       01  WRK-HEN-AREA.
           03  WRK-HENYMDG         PIC X(09).
           03  WRK-HENYMD.
               05  WRK-HGO         PIC X(01).
               05  WRK-HYY         PIC 9(02).
               05  FILLER          PIC X(01)   VALUE   ".".
               05  WRK-HMM         PIC 9(02).
               05  FILLER          PIC X(01)   VALUE   ".".
               05  WRK-HDD         PIC 9(02).
      *
      *  ²èÌÌ¤Î¹àÌÜ½ç¥Æ¡¼¥Ö¥ë
       01  TBL-GMN-JUN.
      *    Í­¸ú³«»ÏÇ¯·îÆü
           03  FILLER          PIC X(32)  VALUE   "0 YUKOSTYMD".
      *    Í­¸ú½ªÎ»Ç¯·îÆü
           03  FILLER          PIC X(32)  VALUE   "0 YUKOEDYMD".
      *    ¿ÇÎÅ¶èÊ¬
           03  FILLER          PIC X(32)  VALUE   "0 SRYKBN".
      *    ¿ÇÎÅ¼ïÊÌ
           03  FILLER          PIC X(32)  VALUE   "0 SRYSYUKBN".
      *    ¥Ç¡¼¥¿¶èÊ¬
           03  FILLER          PIC X(32)  VALUE   "0 DATAKBN".
      *    ¥«¥Ê»áÌ¾¥Á¥§¥Ã¥¯
           03  FILLER          PIC X(32)  VALUE   "0 KANANAME".
      *    »áÌ¾¥Á¥§¥Ã¥¯
           03  FILLER          PIC X(32)  VALUE   "0 NAME".
      *    Àµ¼°Ì¾¾Î
           03  FILLER          PIC X(32)  VALUE   "0 FORMALNAME".
      *    ½èÊýÌ¾¾Î
           03  FILLER          PIC X(32)  VALUE   "0 SHONAME".
      *    ÅÀ¿ô
           03  FILLER          PIC X(32)  VALUE   "0 TEN".
           03  FILLER          PIC X(32)  VALUE   "0 TENSIKIBETU".
           03  FILLER          PIC X(32)  VALUE   "0 OLDTEN".
           03  FILLER          PIC X(32)  VALUE   "0 OLDTENSKB".
           03  FILLER          PIC X(32)  VALUE   "0 TANICD".
     ******03  FILLER          PIC X(32)  VALUE   "0 TANINAME".
           03  FILLER          PIC X(32)  VALUE   "0 HKNTEKKBN".
           03  FILLER          PIC X(32)  VALUE   "0 BYOKANRENKBN".
           03  FILLER          PIC X(32)  VALUE   "0 SDOKNRYO".
           03  FILLER          PIC X(32)  VALUE   "0 YKZKNRKBN".
           03  FILLER          PIC X(32)  VALUE   "0 NYUGAITEKKBN".
           03  FILLER          PIC X(32)  VALUE   "0 ROUTEKKBN".
           03  FILLER          PIC X(32)  VALUE   "0 HOSPSRYKBN".
      *    °åÎÅ´Ñ»¡Ë¡
           03  FILLER          PIC X(32)  VALUE   "0 IRYOKAN".
      *    DPC¶èÊ¬
           03  FILLER          PIC X(32)  VALUE   "0 DPCKBN".
           03  FILLER          PIC X(32)  VALUE   "0 OSINKBN".
           03  FILLER          PIC X(32)  VALUE   "0 BYOSYOKBN".
           03  FILLER          PIC X(32)  VALUE   "0 SANTEIRRKKBN".
           03  FILLER          PIC X(32)  VALUE   "0 TIMEKSNKBN".
           03  FILLER          PIC X(32)  VALUE   "0 GAIKANRIKBN".
           03  FILLER          PIC X(32)  VALUE   "0 TSUSOKUAGE".
           03  FILLER          PIC X(32)  VALUE   "0 KGNAGE".
           03  FILLER          PIC X(32)  VALUE   "0 JGNAGE".
      *    Ï«ºÒ»»ÄêÉÔ²Ä
           03  FILLER          PIC X(32)  VALUE   "0 ROSAIKBN".
      *    ºÎ·ìÎÁ¶èÊ¬
           03  FILLER          PIC X(32)  VALUE   "0 SAIKETUKBN".
      *    Á°²ó¸¡ººÆü¶èÊ¬
           03  FILLER          PIC X(32)  VALUE   "0 ZENKNSKBN".
      *    ÆþÎÏ¥Á¥§¥Ã¥¯¶èÊ¬
      **** 03  FILLER          PIC X(32)  VALUE   "0 INPCHKKBN".
      *    ²ó¿ô¡¢Ç¯Îð
           03  FILLER          PIC X(32)  VALUE   "1 JITUDAY".
           03  FILLER          PIC X(32)  VALUE   "1 DAYCNT".
           03  FILLER          PIC X(32)  VALUE   "1 JGNCNT".
           03  FILLER          PIC X(32)  VALUE   "1 JGNCNT1D".
           03  FILLER          PIC X(32)  VALUE   "1 JGNCNT1W".
           03  FILLER          PIC X(32)  VALUE   "1 JGNCNTETCM".
           03  FILLER          PIC X(32)  VALUE   "1 JGNCNTETC".
           03  FILLER          PIC X(32)  VALUE   "1 JGNCNTERR".
           03  FILLER          PIC X(32)  VALUE   "1 PLUS_SANTEIRRK".
           03  FILLER          PIC X(32)  VALUE   "1 PLUS_JGNCNT".
           03  FILLER          PIC X(32)  VALUE   "1 PLUS_JGNCNT1D".
           03  FILLER          PIC X(32)  VALUE   "1 PLUS_JGNCNT1W".
           03  FILLER          PIC X(32)  VALUE   "1 PLUS_JGNCNTETCM".
           03  FILLER          PIC X(32)  VALUE   "1 PLUS_JGNCNTETC".
           03  FILLER          PIC X(32)  VALUE   "1 PLUS_JGNCNTERR".
           03  FILLER          PIC X(32)  VALUE   "1 KZMCOMPSIKIBETU".
           03  FILLER          PIC X(32)  VALUE   "1 KZMKGN".
           03  FILLER          PIC X(32)  VALUE   "1 KZMJGN".
           03  FILLER          PIC X(32)  VALUE   "1 KZM".
           03  FILLER          PIC X(32)  VALUE   "1 KZMTEN".
           03  FILLER          PIC X(32)  VALUE   "1 KZMERR".
           03  FILLER          PIC X(32)  VALUE   "1 CHUKSNCD".
           03  FILLER          PIC X(32)  VALUE   "1 CHUKSNTSUBAN".
      *        Ç¯Îð²Ã»»
           03  FILLER          PIC X(32)  VALUE   "1 AGEKSNKGN1".
           03  FILLER          PIC X(32)  VALUE   "1 AGEKSNJGN1".
           03  FILLER          PIC X(32)  VALUE   "1 AGEKSNSRYCD1".
           03  FILLER          PIC X(32)  VALUE   "1 AGEKSNKGN2".
           03  FILLER          PIC X(32)  VALUE   "1 AGEKSNJGN2".
           03  FILLER          PIC X(32)  VALUE   "1 AGEKSNSRYCD2".
           03  FILLER          PIC X(32)  VALUE   "1 AGEKSNKGN3".
           03  FILLER          PIC X(32)  VALUE   "1 AGEKSNJGN3".
           03  FILLER          PIC X(32)  VALUE   "1 AGEKSNSRYCD3".
           03  FILLER          PIC X(32)  VALUE   "1 AGEKSNKGN4".
           03  FILLER          PIC X(32)  VALUE   "1 AGEKSNJGN4".
           03  FILLER          PIC X(32)  VALUE   "1 AGEKSNSRYCD4".
      *¼ê½Ñ¡¢¸¡ºº¡¢Æþ±¡
      *    
           03  FILLER          PIC X(32)  VALUE   "2 TUSOKUGAIKBN".
           03  FILLER          PIC X(32)  VALUE   "2 LASERKSN".
           03  FILLER          PIC X(32)  VALUE   "2 CHPMESUKSN".
           03  FILLER          PIC X(32)  VALUE   "2 DONORKBN".
           03  FILLER          PIC X(32)  VALUE   "2 SEKIZUISOKUTEI".
           03  FILLER          PIC X(32)  VALUE   "2 KEIBUJYUTU".
           03  FILLER          PIC X(32)  VALUE   "2 AUTOHOUGO".
           03  FILLER          PIC X(32)  VALUE   "2 AUTOFUNGO".
           03  FILLER          PIC X(32)  VALUE   "2 CHPGYOKOSOTIKSN".
           03  FILLER          PIC X(32)  VALUE   "2 SHORTSTAYOPE".
      *    ²èÁüÅù¼ê½Ñ»Ù±ç²Ã»»
           03  FILLER          PIC X(32)  VALUE   "2 GAZOOPESUP".
      *    Ëã¿ì¼±ÊÌ¶èÊ¬
           03  FILLER          PIC X(32)  VALUE   "2 MASUISKBKBN".
      *    »ÜÀß´ð½àÉÔÅ¬¹ç¶èÊ¬
           03  FILLER          PIC X(32)  VALUE   "2 KIJUNTEIGENKBN".
      *    ´ð½àÉÔÅ¬¹çÄþ¸ºÂÐ¾Ý»ÜÀß´ð½à¥³¡¼¥É
           03  FILLER          PIC X(32)  VALUE   "2 KIJUNTEIGENCD".
      *    ÉûÉ¡¹ÐÆâ»ë¶À²Ã»»
           03  FILLER          PIC X(32)  VALUE   "2 FUKUBIKUNAIKBN".
      *    ÉûÉ¡¹ÐÀÚ½üµ¡´ï²Ã»»
           03  FILLER          PIC X(32)  VALUE   "2 FUKUBIKUKOTUKBN".
      *    Ä¹»þ´ÖËã¿ì´ÉÍý²Ã»»
           03  FILLER          PIC X(32)  VALUE   "2 TIMEMASUIKBN".
      *
           03  FILLER          PIC X(32)  VALUE   "2 KNSJISKBN".
           03  FILLER          PIC X(32)  VALUE   "2 KNSJISGRPKBN".
           03  FILLER          PIC X(32)  VALUE   "2 KENTAICOMMENT".
           03  FILLER          PIC X(32)  VALUE   "2 TEIGENKBN".
           03  FILLER          PIC X(32)  VALUE   "2 HOKATUTEIGENKBN".
           03  FILLER          PIC X(32)  VALUE   "2 HOUKNSKBN".
           03  FILLER          PIC X(32)  VALUE   "2 CHPNAISIKSN".
      *    Èó¿¯½±Åª·ì¹ÔÆ°ÂÖ¥â¥Ë¥¿¥ê¥ó¥°²Ã»»
           03  FILLER          PIC X(32)  VALUE   "2 HISINSYUMONKSN".
      *    Åà·ëÊÝÂ¸Æ±¼ïÁÈ¿¥²Ã»»
           03  FILLER          PIC X(32)  VALUE   "2 TOUKETUHOZONKSN".
      *    »Í»è²Ã»»¡ÊÏ«ºÒ¡Ë
           03  FILLER          PIC X(32)  VALUE   "2 SISIKSN".
      *H30.4
      *    °­À­¼ðáçÉÂÍýÁÈ¿¥É¸ËÜ²Ã»»
           03  FILLER          PIC X(32)  VALUE   "2 AKUSEIBYORIKSN".
      *R02.4
      *    ÁÏ³°¸ÇÄê´ï²Ã»»
           03  FILLER          PIC X(32)  VALUE   "2 SOGAIKOTEIKSN".
      *    Ä¶²»ÇÈÀÚºï´ï²Ã»»
           03  FILLER          PIC X(32)  VALUE   "2 CHPSESSAKUKSN".
      *    º¸¿´¼ªÊÄº¿½ÑÊ»»Ü¶èÊ¬
           03  FILLER          PIC X(32)  VALUE   "2 SASINJIHEISIKBN".
      *
           03  FILLER          PIC X(32)  VALUE   "2 NYUKHNKBN".
           03  FILLER          PIC X(32)  VALUE   "2 NYUKHNKSNKBN".
           03  FILLER          PIC X(32)  VALUE   "2 KANGOKSN".
           03  FILLER          PIC X(32)  VALUE   "2 CHIIKIKSN".
           03  FILLER          PIC X(32)  VALUE   "2 MICMESUKSN".
      *³ÆÈÖ¹æÅù
           03  FILLER          PIC X(32)  VALUE   "3 SSTKIJUNCD1".
           03  FILLER          PIC X(32)  VALUE   "3 SSTKIJUNCD2".
           03  FILLER          PIC X(32)  VALUE   "3 SSTKIJUNCD3".
           03  FILLER          PIC X(32)  VALUE   "3 SSTKIJUNCD4".
           03  FILLER          PIC X(32)  VALUE   "3 SSTKIJUNCD5".
           03  FILLER          PIC X(32)  VALUE   "3 SSTKIJUNCD6".
           03  FILLER          PIC X(32)  VALUE   "3 SSTKIJUNCD7".
           03  FILLER          PIC X(32)  VALUE   "3 SSTKIJUNCD8".
           03  FILLER          PIC X(32)  VALUE   "3 SSTKIJUNCD9".
           03  FILLER          PIC X(32)  VALUE   "3 SSTKIJUNCD10".
           03  FILLER          PIC X(32)  VALUE   "3 GAITENTTLKBN".
           03  FILLER          PIC X(32)  VALUE   "3 NYUTENTTLSKB".
           03  FILLER          PIC X(32)  VALUE   "3 KOUHYOJYUNNUM".
           03  FILLER          PIC X(32)  VALUE   "3 CDKBN_KBN".
           03  FILLER          PIC X(32)  VALUE   "3 CDKBN_SYO".
           03  FILLER          PIC X(32)  VALUE   "3 CDKBN_BU".
           03  FILLER          PIC X(32)  VALUE   "3 CDKBN_KBNNUM".
           03  FILLER          PIC X(32)  VALUE   "3 CDKBN_KBNNUM_EDA".
           03  FILLER          PIC X(32)  VALUE   "3 CDKBN_KOUBAN".
           03  FILLER          PIC X(32)  VALUE   "3 KOKUCHI_KBN".
           03  FILLER          PIC X(32)  VALUE   "3 KOKUCHI_SYO".
           03  FILLER          PIC X(32)  VALUE   "3 KOKUCHI_BU".
           03  FILLER          PIC X(32)  VALUE   "3 KOKUCHI_KBNNUM".
           03  FILLER          PIC X(32)  VALUE "3 KOKUCHI_KBNNUM_EDA".
      *
           03  FILLER          PIC X(32)  VALUE   "3 KOKUCHI_KOUBAN".
      *    ÅÀ¿ôÉ½¶èÊ¬ÈÖ¹æ
           03  FILLER          PIC X(32)  VALUE   "3 KUBUNBANGOU".
           03  FILLER          PIC X(32)  VALUE   "3 KOKUJISKBKBN1".
           03  FILLER          PIC X(32)  VALUE   "3 KOKUJISKBKBN2".
      *
       01  TBL-GMN-JUN-R       REDEFINES   TBL-GMN-JUN.
      *****03  TBL-GMN-OCC                 OCCURS  107
      **** 03  TBL-GMN-OCC                 OCCURS  109
      **** 03  TBL-GMN-OCC                 OCCURS  115
      **** 03  TBL-GMN-OCC                 OCCURS  118
      **** 03  TBL-GMN-OCC                 OCCURS  119
      ***  03  TBL-GMN-OCC                 OCCURS  121
      **** 03  TBL-GMN-OCC                 OCCURS  130
      **** 03  TBL-GMN-OCC                 OCCURS  129
      **** 03  TBL-GMN-OCC                 OCCURS  130
           03  TBL-GMN-OCC                 OCCURS  133
                                           INDEXED  IDX-GMN.
               05  TBL-PAGE                PIC 9(01).
               05  TBL-YOBI1               PIC X(01).
               05  TBL-WIDGET              PIC X(30).
      *
       01  TBL-GMN-MAX                     PIC 9(04)   VALUE   133.
      *
      *    Ã±°Ì¤Î¹àÌÜ½ç¥Æ¡¼¥Ö¥ë
           COPY    "CMTANICD.INC".
      *
      *    »ØÆ³´ÉÍý¥³¡¼¥É¥Æ¡¼¥Ö¥ë
       01  TBL-SDOKNRYO-AREA.
           03  FILLER              PIC X(02)   VALUE   "00".
           03  FILLER              PIC X(50)   VALUE
               "»ØÆ³´ÉÍý²Ã»»°Ê³°".
           03  FILLER              PIC X(02)   VALUE   "01".
           03  FILLER              PIC X(50)   VALUE
               "ÆÃÄê¼À´µÎÅÍÜ»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "02".
           03  FILLER              PIC X(50)   VALUE
               "¥¦¥¤¥ë¥¹¼À´µ»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "03".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð¼«¸ÊÃí¼Í»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "04".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð¼«¸ÊÊ¢ËìÞõÎ®»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "05".
           03  FILLER              PIC X(50)   VALUE
               "ÆÃÄêÌôºÞ¼£ÎÅ´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "06".
           03  FILLER              PIC X(50)   VALUE
               "¾®»ùÆÃÄê¼À´µ¥«¥¦¥ó¥»¥ê¥ó¥°ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "07".
           03  FILLER              PIC X(50)   VALUE
               "Êü¼ÍÀþ¼£ÎÅ´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "08".
           03  FILLER              PIC X(50)   VALUE
               "Ï·¿ÍËýÀ­¼À´µÀ¸³è»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "09".
           03  FILLER              PIC X(50)   VALUE
               "Âà±¡»þ»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "10".
           03  FILLER              PIC X(50)   VALUE
               "¿²¤¿¤­¤êÏ·¿ÍË¬Ìä´Ç¸î¡¦»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "11".
           03  FILLER              PIC X(50)   VALUE
               "ÅêÌôÆÃÊÌ»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "12".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð»ÀÁÇÎÅË¡»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "13".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂðÃæ¿´ÀÅÌ®±ÉÍÜË¡»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "14".
           03  FILLER              PIC X(50)   VALUE
               "ÈéÉæ²ÊÆÃÄê¼À´µ»ØÆ³´ÉÍýÎÁ¡Ê£±¡Ë".
           03  FILLER              PIC X(02)   VALUE   "15".
           03  FILLER              PIC X(50)   VALUE
               "»õ²Ê¸ýçµ±ÒÀ¸»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "16".
           03  FILLER              PIC X(50)   VALUE
               "Í­¾²µÁ»õ»ØÆ³ÎÁ¡Ê°ìÈÌ¡Ë".
           03  FILLER              PIC X(02)   VALUE   "17".
           03  FILLER              PIC X(50)   VALUE
               "»õÁåÇ¿Ï³»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "18".
           03  FILLER              PIC X(50)   VALUE
               "»õ²Ê¸ýçµ¼À´µ»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "19".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð¼«¸ÊÊ¢ËìÞõÎ®»ØÆ³´ÉÍý¡Ê½¸ÃæÅª»ØÆ³¡Ë".
           03  FILLER              PIC X(02)   VALUE   "20".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð»ÀÁÇÎÅË¡»ØÆ³´ÉÍý¡Ê¥Á¥¢¥Î¡¼¥¼·¿¡Ë".
           03  FILLER              PIC X(02)   VALUE   "21".
           03  FILLER              PIC X(50)   VALUE
               "¿²¤¿¤­¤êÏ·¿ÍË¬Ìä»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "22".
           03  FILLER              PIC X(50)   VALUE
               "»õ²Ê¶ºÀµ´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "23".
           03  FILLER              PIC X(50)   VALUE
               "Í­¾²µÁ»õ»ØÆ³ÎÁ¡ÊÏ·¿Í¡Ë".
           03  FILLER              PIC X(02)   VALUE   "24".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂðÀ®Ê¬±ÉÍÜ´ÉÍý±ÉÍÜË¡»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "25".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð¼«¸ÊÆ³Ç¢»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "26".
           03  FILLER              PIC X(50)   VALUE
               "ÃÔÊò´µ¼ÔºßÂðÎÅÍÜ»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "27".
           03  FILLER              PIC X(50)   VALUE
               "¿²¤¿¤­¤êÏ·¿ÍË¬Ìä¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥ó»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "28".
           03  FILLER              PIC X(50)   VALUE
               "°­À­¼ðáçÆÃ°ÛÊª¼£ÎÅ´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "29".
           03  FILLER              PIC X(50)   VALUE
               "¿´Â¡¥Ú¡¼¥¹¥á¡¼¥«¡¼»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "30".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð°­À­¼ðáç´µ¼Ô»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "31".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð¿Í¹©¸ÆµÛ»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "32".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð¿²¤¿¤­¤ê´µ¼Ô½èÃÖ»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "33".
           03  FILLER              PIC X(50)   VALUE
               "¿²¤¿¤­¤êÏ·¿Í´µ¼Ô½èÃÖ»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "34".
           03  FILLER              PIC X(50)   VALUE
               "¾®»ù²ÊÎÅÍÜ»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "35".
           03  FILLER              PIC X(50)   VALUE
               "ÈéÉæ²ÊÆÃÄê¼À´µ»ØÆ³´ÉÍýÎÁ¡Ê£²¡Ë".
           03  FILLER              PIC X(02)   VALUE   "36".
           03  FILLER              PIC X(50)   VALUE
               "¤Æ¤ó¤«¤ó»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "37".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð¼«¸ÊáÖÄË´ÉÍý»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "38".
           03  FILLER              PIC X(50)   VALUE
               "ÆñÉÂ³°Íè»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "39".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð»þ°å³ØÁí¹ç´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "40".
           03  FILLER              PIC X(50)   VALUE
               "Ï·¿ÍËýÀ­¼À´µ³°ÍèÁí¹ç¿ÇÎÅÎÁ".
           03  FILLER              PIC X(02)   VALUE   "41".
           03  FILLER              PIC X(50)   VALUE
               "ÈéÉæ²ÊÆÃÄê¼À´µ»ØÆ³´ÉÍýÎÁ¡Ê£³¡Ë".
           03  FILLER              PIC X(02)   VALUE   "42".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð·ì±ÕÆ©ÀÏ»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "43".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð»ýÂ³ÍÛ°µ¼°¸ÆµÛÎÅË¡»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "44".
           03  FILLER              PIC X(50)   VALUE
               "ËýÀ­¼À´µ³°Íè¶¦Æ±»ØÆ³ÎÁ".
      *
           03  FILLER              PIC X(02)   VALUE   "45".
           03  FILLER              PIC X(50)   VALUE
               "À¸³è½¬´·ÉÂ»ØÆ³´ÉÍýÎÁ¡ÊÅüÇ¢ÉÂ¤ò¼çÉÂ¡Ë".
           03  FILLER              PIC X(02)   VALUE   "46".
           03  FILLER              PIC X(50)   VALUE
               "ËýÀ­áÖÄË¼À´µ´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "47".
           03  FILLER              PIC X(50)   VALUE
               "¾®»ù°­À­¼ðáç´µ¼Ô»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "48".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂðµ¤´ÉÀÚ³«´µ¼Ô»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "49".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂðÇÙ¹â·ì°µ¾É´µ¼Ô»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "50".
           03  FILLER              PIC X(50)   VALUE
               "³«Êü·¿ÉÂ±¡¶¦Æ±»ØÆ³ÎÁ¡Ê£±¡Ë".
           03  FILLER              PIC X(02)   VALUE   "51".
           03  FILLER              PIC X(50)   VALUE
               "³«Êü·¿ÉÂ±¡¶¦Æ±»ØÆ³ÎÁ¡Ê£²¡Ë".
           03  FILLER              PIC X(02)   VALUE   "52".
           03  FILLER              PIC X(50)   VALUE
               "ÃÏ°èÏ¢ÂÓÂà±¡»þ¶¦Æ±»ØÆ³ÎÁ£±".
           03  FILLER              PIC X(02)   VALUE   "53".
           03  FILLER              PIC X(50)   VALUE
               "ÃÏ°èÏ¢ÂÓÂà±¡»þ¶¦Æ±»ØÆ³ÎÁ£²".
           03  FILLER              PIC X(02)   VALUE   "54".
           03  FILLER              PIC X(50)   VALUE
               "ÃÏ°èÏ¢·È¿ÇÎÅ·×²è´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "55".
           03  FILLER              PIC X(50)   VALUE
               "ÃÏ°èÏ¢·È¿ÇÎÅ·×²èÂà±¡»þ»ØÆ³ÎÁ¡Ê£±¡Ë".
           03  FILLER              PIC X(02)   VALUE   "56".
           03  FILLER              PIC X(50)   VALUE
               "ÌôºÞ´ÉÍý»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "57".
           03  FILLER              PIC X(50)   VALUE
               "¸å´ü¹âÎð¼ÔÂà±¡»þÌôºÞ¾ðÊóÄó¶¡ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "58".
           03  FILLER              PIC X(50)   VALUE
               "ÆÃÄê»ÜÀßÆþµï»þÅù°å³ØÁí¹ç´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "59".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð´µ¼ÔÏ¢·È»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "60".
           03  FILLER              PIC X(50)   VALUE
               "¼ªÉ¡°ö¹¢²ÊÆÃÄê¼À´µ»ØÆ³´ÉÍýÎÁ".
      *H22.4¤«¤é
           03  FILLER              PIC X(02)   VALUE   "61".
           03  FILLER              PIC X(50)   VALUE
               "ÃÏ°èÏ¢·È¿ÇÎÅ·×²èÂà±¡»þ»ØÆ³ÎÁ¡Ê£²¡Ë".
           03  FILLER              PIC X(02)   VALUE   "62".
           03  FILLER              PIC X(50)   VALUE
               "¤¬¤ó¼£ÎÅÏ¢·È·×²èºöÄêÎÁ".
           03  FILLER              PIC X(02)   VALUE   "63".
           03  FILLER              PIC X(50)   VALUE
               "¤¬¤ó¼£ÎÅÏ¢·È»ØÆ³ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "64".
           03  FILLER              PIC X(50)   VALUE
               "Ç§ÃÎ¾ÉÀìÌç¿ÇÃÇ´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "65".
           03  FILLER              PIC X(50)   VALUE
               "´Î±ê¥¤¥ó¥¿¡¼¥Õ¥§¥í¥ó¼£ÎÅ·×²èÎÁ".
           03  FILLER              PIC X(02)   VALUE   "66".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂðÆñ¼£À­ÈéÉæ¼À´µ½èÃÖ»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "67".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂð¾®»ùÄã·ìÅü¾É´µ¼Ô»ØÆ³´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "80".
           03  FILLER              PIC X(50)   VALUE
               "¾®»ù²Ê³°Íè¿ÇÎÅÎÁÅù".
           03  FILLER              PIC X(02)   VALUE   "81".
           03  FILLER              PIC X(50)   VALUE
               "À¸³è½¬´·ÉÂ´ÉÍýÎÁ".
           03  FILLER              PIC X(02)   VALUE   "82".
           03  FILLER              PIC X(50)   VALUE
               "ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ".
           03  FILLER              PIC X(02)   VALUE   "97".
           03  FILLER              PIC X(50)   VALUE
               "½èÊý¤»¤óÎÁ".
           03  FILLER              PIC X(02)   VALUE   "98".
           03  FILLER              PIC X(50)   VALUE
               "½èÊýÎÁ".
      *
       01  TBL-SDOKNRYO-AREA-R     REDEFINES   TBL-SDOKNRYO-AREA.
      *    03  TBL-SDOKNRYO-OCC        OCCURS  45      INDEXED  SDO-IDX.
      **** 03  TBL-SDOKNRYO-OCC        OCCURS  58      INDEXED  SDO-IDX.
           03  TBL-SDOKNRYO-OCC        OCCURS  73      INDEXED  SDO-IDX.
               05  TBL-SDOKNRYO        PIC X(02).
               05  TBL-SDOKNRYOMEI     PIC X(50).
      *01  SDO-MAX                     PIC 9(04)   VALUE   45.
      *01  SDO-MAX                     PIC 9(04)   VALUE   58.
       01  SDO-MAX                     PIC 9(04)   VALUE   73.
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿
           COPY    "CPTENSU.INC".
      *    ÅÀ¿ô¥Þ¥¹¥¿ÉÕ²Ã¥³¡¼¥É
        01 TENSUPLUS-REC.
           COPY    "CPTENSUPLUS.INC".
      *    ÆþÎÏ¥³¡¼¥É
        01  INPUTCD-REC.
           COPY    "CPINPUTCD.INC".
      *    Ï·¿Í°ìÈÌ¥³¡¼¥É¿¶ÂØ
        01  SRYCDCHG-REC.
            COPY    "CPSRYCDCHG.INC".
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿´ïºà¶â³Û
        01 TENSU-PRICE-REC.
           COPY    "CPTENSU-PRICE.INC".
      *
      *    ¥ï¡¼¥¯ÅÀ¿ô¥Þ¥¹¥¿
       01  WRK-TNS-TENSU-REC           PIC X(1290).
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *   ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *    ¿ô»úÊÑ´¹ÎÎ°è
           COPY    "CPORCSNUM.INC".
      *----(01.02.03) LINE ADD START ----------------------------------
      *   ²èÌÌÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSGDAY.INC".
      *----(01.02.03) LINE ADD END   ----------------------------------
      *
      *    Á´³Ñ¥Á¥§¥Ã¥¯¥Ñ¥é¥á¥¿
           COPY    "CPORCSKANACHK.INC".
      *
      *    ÅÀ¿ôÉí²Ã¾ðÊó¹¹¿·ÆâÍÆ
      **** COPY    "CPORCGZS02.INC".
      *
      *    ¥Þ¥·¥óÆüÉÕ¼èÆÀ¥µ¥Ö
           COPY    "CPORCSMCNDATE.INC".
      *
      *    £Ä£Â¸¡º÷
      *01  MCPDATA-REC                 PIC X(5000).
           COPY    "MCPDATA.INC".
      *****COPY    "CPORCMCP.INC".
      *
      *****************************************************************
      *    Ï¢ÍíÎÎ°è
      *****************************************************************
       LINKAGE                     SECTION.
      *
           COPY    "MCPAREA".
           COPY    "ORCA-SPA".
           COPY    "LINKAREA".
      *
       01  SCRAREA.
           COPY    "ORCA102SCRAREA.INC".
      *
       PROCEDURE                                 DIVISION    USING
                                                 MCPAREA
                                                 SPAAREA
                                                 LINKAREA
                                                 SCRAREA.
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                              SECTION.
      *
           INITIALIZE                            FLG-AREA
           INITIALIZE                            CNT-AREA
           INITIALIZE                            WRK-AREA
           INITIALIZE                            IDX-AREA
      *
           MOVE    SPA-COMMON                    TO  SPA-AREA.
           MOVE    SPA-WORK                      TO  SPA-Z01KYOUTU
           MOVE    SPA-FREE                      TO  SPA-Z01FREE
           MOVE    SPA-Z01SONOTA                 TO  SPA-Z03
           MOVE    SPA-Z010FREE                  TO  SPA-Z010
      *
           MOVE    SPACE                         TO  SPA-ERRCD.
           MOVE    ZERO                          TO  FLG-END.
      *
      *    ¿ÇÎÅ¼ïÊÌ¥Æ¡¼¥Ö¥ë¥»¥Ã¥È
           PERFORM 1001-SRYKBN-SET-SEC
      *
           EVALUATE    MCP-STATUS       ALSO    MCP-EVENT
               WHEN    "LINK"           ALSO    ANY
                   PERFORM 100-INIT-SEC
      *    ²èÌÌÁ«°Ü
               WHEN    "PUTG"           ALSO   "CLICKED"
                   PERFORM 200-GMNSENI-SEC
      *    ÆþÎÏ
               WHEN      OTHER
                   PERFORM 200-ENTRY-SEC
           END-EVALUATE.
      *
      *    ²èÌÌÁ«°Ü¤¬¤Ê¤¤»þ¡¢²èÌÌÉ½¼¨¤Ø
           IF      FLG-END                       =   ZERO
               PERFORM 500-SET-SCREEN-SEC
           END-IF.
      *    
      *    
           MOVE    SPA-Z01KYOUTU                 TO  SPA-WORK
           MOVE    SPA-AREA                      TO  SPA-COMMON
           MOVE    SPA-Z03                       TO  SPA-Z01SONOTA 
           MOVE    SPA-Z010                      TO  SPA-Z010FREE
           MOVE    SPA-Z01FREE                   TO  SPA-FREE
      *
           EXIT    PROGRAM.
      *
      *****************************************************************
      *    ½é´ü¡¡½èÍý
      *****************************************************************
       100-INIT-SEC                              SECTION.
      *
           INITIALIZE                            FLG-AREA.
           INITIALIZE                            CNT-AREA.
      *
      *    ¥¨¥é¡¼²èÌÌ¤è¤ê
           IF      SPA-MOTOPG          =   "ZERR"
               MOVE    SPACE               TO  SPA-MOTOPG
               PERFORM 5001-MAPCUR-SEC
           ELSE
      *        ½é´ü²èÌÌ¥»¥Ã¥È
               PERFORM 300-SCREEN-SEC
      *        ²èÌÌÊÔ½¸
               IF      FLG-END             =   ZERO
                    PERFORM 500-GMNHEN-SEC
               END-IF
           END-IF
      *
           IF      FLG-END             =   ZERO
               MOVE    SPACE               TO  LINKAREA
      *
               MOVE    SPACE               TO  MCP-PUTTYPE
               MOVE    "Z03"               TO  MCP-WINDOW
               PERFORM 900-PUT-WINDOW
      *
              MOVE    1                    TO  FLG-END
           END-IF
           .
       100-INIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¼ïÊÌ¥Æ¡¼¥Ö¥ë¥»¥Ã¥È½èÍý
      *****************************************************************
       1001-SRYKBN-SET-SEC             SECTION.
      * 
      *    ¿ÇÎÅ¼ïÊÌ¥Æ¡¼¥Ö¥ë¥»¥Ã¥È
           CALL    "ORCSSRYSYU"        USING
                                       MSYU-DATA-REC
      *
           .
       1001-SRYKBN-SET-EXT.
           EXIT.
      *
     *****************************************************************
      *    ½é´ü²èÌÌ½èÍý
      *****************************************************************
       300-SCREEN-SEC              SECTION.
      *
           EVALUATE    SPA-MOTOPG
      *    ¹¹¿·½èÍý
               WHEN    "ZID1"
                   PERFORM 330-ZID1-SET-SEC
      *           ÆþÎÏ£Ã£Ä¤è¤ê
               WHEN    "Z99"
               WHEN    "Z90"
                   MOVE    1                   TO  SPA-GMN-CUR
      *H29.01
      *        ¥æ¡¼¥¶ÀßÄê²èÌÌ
               WHEN    "Z010"
                   PERFORM 310-SPASET-SEC
                   MOVE    1                   TO  SPA-GMN-CUR
      *
               WHEN    OTHER
                   PERFORM 310-SPASET-SEC
           END-EVALUATE
      *
           .
       300-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¹¥Ñ½é´üÊÔ½¸½èÍý
      *****************************************************************
       310-SPASET-SEC              SECTION.
      *
           INITIALIZE                      SPA-GMN-AREA
           INITIALIZE                      SPA-NAI-AREA
           MOVE  0                               TO  SPA-GMN-PAGENO
           MOVE  SPA-Z01-SRYCD                   TO  SPA-GMN-SRYCDH
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿³ºÅö¥Ç¡¼¥¿ÆÉ¤ß½Ð¤·
           MOVE  SPA-Z01-YUKOSTYMD               TO  SPA-NAI-YUKOSTYMD
           IF  SPA-Z01-SYORIKBN                  =  2
               MOVE  SPA-Z01-YUKOSTYMDH          TO  SPA-GMN-YUKOSTYMDH
           END-IF
           MOVE  SPA-Z01-YUKOSTYMDH              TO  SPA-GMN-YUKOSTYMD
      *
           MOVE  SPA-Z01-YUKOEDYMD               TO  SPA-NAI-YUKOEDYMD
           IF  SPA-Z01-SYORIKBN                  =  2
                MOVE  SPA-Z01-YUKOEDYMDH         TO  SPA-GMN-YUKOEDYMDH
           END-IF
           MOVE  SPA-Z01-YUKOEDYMDH              TO  SPA-GMN-YUKOEDYMD
      *
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ÆÉ¹þ¤ß
           MOVE    SPACE               TO  TNS-TENSU-REC
           INITIALIZE                      TNS-TENSU-REC
      *
           MOVE    SPA-Z01-SRYCD       TO  TNS-SRYCD
           IF      SPA-Z01-SELNUM      =   ZERO
               MOVE    ALL "9"             TO  TNS-YUKOSTYMD
               MOVE    ALL "9"             TO  TNS-YUKOEDYMD
           ELSE
               MOVE    SPA-Z01-TYUKOSTYMD(SPA-Z01-SELNUM)
                                           TO  TNS-YUKOSTYMD
               MOVE    SPA-Z01-TYUKOEDYMD(SPA-Z01-SELNUM)
                                           TO  TNS-YUKOEDYMD
           END-IF
      *
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
      *
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 900-TENSU-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-TENSU
               INITIALIZE                      TNS-TENSU-REC
           END-IF
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBLOSEC-SEC
      *
           IF      FLG-TENSU           =   ZERO
      *        ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸
               PERFORM 3001-SPASET-SEC
           END-IF
      *    ³Æ¥ê¥¹¥È¥Ü¥Ã¥¯¥¹ÊÔ½¸
           PERFORM 30012-COB-HEN-SEC
      *
      *H29.1
           PERFORM  3003-TENSUPLUS-COMB-SEC
           MOVE    ZERO                TO  FLG-OK
      *
      *    ¹ß½ç¤Ë¸¡º÷¡¡ºÇ½ªÍúÎò¤òÉ½¼¨
           IF      FLG-TENSU           =   ZERO
      *
               MOVE    SPACE               TO  TENSUPLUS-REC
               MOVE    TNS-SRYCD           TO  TNSP-SRYCD
      *
               MOVE    SPA-HOSPNUM         TO  TNSP-HOSPNUM
               MOVE    TENSUPLUS-REC       TO  MCPDATA-REC
               MOVE    "tbl_tensuplus"     TO  MCP-TABLE
               MOVE    "key4"              TO  MCP-PATHNAME
               PERFORM 910-DBSELECT-SEC
               IF      MCP-RC               =   ZERO
                   MOVE    "tbl_tensuplus"     TO  MCP-TABLE
                   MOVE    "key4"              TO  MCP-PATHNAME
                   PERFORM 990-TENSUPLUS-READ-SEC
               ELSE
                   INITIALIZE                 TENSUPLUS-REC
                   MOVE    1                  TO  FLG-TENSUPLUS
               END-IF
               PERFORM UNTIL       FLG-TENSUPLUS  =   1
                   IF     (TNSP-YUKOSTYMD      >   TNS-YUKOEDYMD )
      *R01.10
                     OR   (TNSP-YUKOEDYMD      <   TNS-YUKOSTYMD )
                       CONTINUE
                   ELSE
                       PERFORM 3002-SPASET-TENSUPLUS-SEC
                       MOVE    1               TO  FLG-OK
                       MOVE    1               TO  FLG-TENSUPLUS
                   END-IF
                   IF      FLG-TENSUPLUS       =   ZERO
                       MOVE    "tbl_tensuplus"     TO  MCP-TABLE
                       MOVE    "key4"              TO  MCP-PATHNAME
                       PERFORM 990-TENSUPLUS-READ-SEC
                   END-IF
               END-PERFORM
               MOVE    "tbl_tensuplus"     TO  MCP-TABLE
               MOVE    "key4"              TO  MCP-PATHNAME
               PERFORM 990-DBLOSEC-SEC
           END-IF
      *
           IF      FLG-OK              =   ZERO
      *        ½é´üÉ½¼¨
               INITIALIZE                 TENSUPLUS-REC
               PERFORM  3002-SPASET-TENSUPLUS-SEC
           END-IF
      *
           MOVE    1                   TO  SPA-GMN-CUR
           .
       310-SPASET-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¾ðÊó¤ò£Ó£Ð£Á¤Ë¥»¥Ã¥È
      *****************************************************************
       3001-SPASET-SEC                     SECTION.
      *
           MOVE  MCPDATA-REC               TO  TNS-TENSU-REC
           MOVE  TNS-NAME                  TO  SPA-GMN-NAMEH
      *
           MOVE  TNS-SRYKBN                TO  SPA-GMN-SRYKBN   
           MOVE  TNS-SRYSYUKBN             TO  SPA-GMN-SRYSYUKBN
           MOVE  TNS-DATAKBN               TO  SPA-GMN-DATAKBN  
           MOVE  TNS-KANANAME              TO  SPA-GMN-KANANAME
           MOVE  TNS-NAME                  TO  SPA-GMN-NAME
           MOVE  TNS-TEN                   TO  SPA-GMN-TEN
           MOVE  TNS-TENSIKIBETU           TO  SPA-GMN-TENSIKIBETU
           MOVE  TNS-OLDTEN                TO  SPA-GMN-OLDTEN
           MOVE  TNS-OLDTENSKB             TO  SPA-GMN-OLDTENSKB
           MOVE  TNS-TANICD                TO  SPA-GMN-TANICD
           MOVE  TNS-TANINAME              TO  SPA-GMN-TANINAME
           MOVE  TNS-HKNTEKKBN             TO  SPA-GMN-HKNTEKKBN   
           MOVE  TNS-BYOKANRENKBN          TO  SPA-GMN-BYOKANRENKBN
           MOVE  TNS-SDOKNRYO              TO  SPA-GMN-SDOKNRYO    
           MOVE  TNS-YKZKNRKBN             TO  SPA-GMN-YKZKNRKBN   
           MOVE  TNS-NYUGAITEKKBN          TO  SPA-GMN-NYUGAITEKKBN
           MOVE  TNS-ROUTEKKBN             TO  SPA-GMN-ROUTEKKBN   
           MOVE  TNS-HOSPSRYKBN            TO  SPA-GMN-HOSPSRYKBN  
           MOVE  TNS-OSINKBN               TO  SPA-GMN-OSINKBN     
           MOVE  TNS-BYOSYOKBN             TO  SPA-GMN-BYOSYOKBN   
           MOVE  TNS-SANTEIRRKKBN          TO  SPA-GMN-SANTEIRRKKBN
           MOVE  TNS-TIMEKSNKBN            TO  SPA-GMN-TIMEKSNKBN  
           MOVE  TNS-GAIKANRIKBN           TO  SPA-GMN-GAIKANRIKBN 
           MOVE  TNS-TSUSOKUAGE            TO  SPA-GMN-TSUSOKUAGE  
           MOVE  TNS-KGNAGE                TO  SPA-GMN-KGNAGE      
           MOVE  TNS-JGNAGE                TO  SPA-GMN-JGNAGE      
      *                                         
           MOVE  TNS-JITUDAY               TO  SPA-GMN-JITUDAY        
           MOVE  TNS-DAYCNT                TO  SPA-GMN-DAYCNT         
           MOVE  TNS-JGNCNT                TO  SPA-GMN-JGNCNT         
           MOVE  TNS-JGNCNT1D              TO  SPA-GMN-JGNCNT1D       
           MOVE  TNS-JGNCNT1W              TO  SPA-GMN-JGNCNT1W       
           MOVE  TNS-JGNCNTETCM            TO  SPA-GMN-JGNCNTETCM     
           MOVE  TNS-JGNCNTETC             TO  SPA-GMN-JGNCNTETC      
           MOVE  TNS-JGNCNTERR             TO  SPA-GMN-JGNCNTERR      
           MOVE  TNS-KZMCOMPSIKIBETU       TO  SPA-GMN-KZMCOMPSIKIBETU
           MOVE  TNS-KZMKGN                TO  SPA-GMN-KZMKGN         
           MOVE  TNS-KZMJGN                TO  SPA-GMN-KZMJGN         
           MOVE  TNS-KZM                   TO  SPA-GMN-KZM            
           MOVE  TNS-KZMTEN                TO  SPA-GMN-KZMTEN         
           MOVE  TNS-KZMERR                TO  SPA-GMN-KZMERR         
           MOVE  TNS-CHUKSNCD              TO  SPA-GMN-CHUKSNCD       
           MOVE  TNS-CHUKSNTUBAN           TO  SPA-GMN-CHUKSNTSUBAN   
           PERFORM  VARYING  IDXX
                    FROM  1  BY  1  UNTIL  IDXX  >  4
               MOVE  TNS-AGEKSNKGN(IDXX)   TO  SPA-GMN-AGEKSNKGN(IDXX)
               MOVE  TNS-AGEKSNJGN(IDXX)   TO  SPA-GMN-AGEKSNJGN(IDXX) 
               MOVE  TNS-AGEKSNSRYCD(IDXX) TO  SPA-GMN-AGEKSNSRYCD
                                                                (IDXX) 
           END-PERFORM
      *                                          
           MOVE  TNS-TUSOKUGAIKBN          TO  SPA-GMN-TUSOKUGAIKBN    
           MOVE  TNS-LASERKBN              TO  SPA-GMN-LASERKSN        
           MOVE  TNS-CHPMESUKSN            TO  SPA-GMN-CHPMESUKSN      
           MOVE  TNS-DONORKBN              TO  SPA-GMN-DONORKBN      
           MOVE  TNS-MICMESUKSN            TO  SPA-GMN-MICMESUKSN      
           MOVE  TNS-SEKIZUISOKUTEI        TO  SPA-GMN-SEKIZUISOKUTEI  
           MOVE  TNS-KEIBUJYUTU            TO  SPA-GMN-KEIBUJYUTU      
           MOVE  TNS-AUTOHOUGO             TO  SPA-GMN-AUTOHOUGO       
           MOVE  TNS-AUTOFUNGO             TO  SPA-GMN-AUTOFUNGO       
           MOVE  TNS-CHPGYOKOSOTIKSN       TO  SPA-GMN-CHPGYOKOSOTIKSN 
           MOVE  TNS-SHORTSTAYOPE          TO  SPA-GMN-SHORTSTAYOPE    
      *    »ÜÀß´ð½àÉÔÅ¬¹ç¶èÊ¬
           MOVE  TNS-KIJUNTEIGENKBN        TO  SPA-GMN-KIJUNTEIGENKBN
      *    ´ð½àÉÔÅ¬¹çÄþ¸ºÂÐ¾Ý»ÜÀß´ð½à¥³¡¼¥É
           MOVE  TNS-KIJUNTEIGENCD         TO  SPA-GMN-KIJUNTEIGENCD
      *    ÉûÉ¡¹ÐÆâ»ë¶À²Ã»»
           MOVE  TNS-FUKUBIKUNAIKBN        TO  SPA-GMN-FUKUBIKUNAIKBN
           MOVE  TNS-FUKUBIKUKOTUKBN       TO  SPA-GMN-FUKUBIKUKOTUKBN
      *    Ä¹»þ´ÖËã¿ì´ÉÍý²Ã»»
           MOVE  TNS-TIMEMASUIKBN          TO  SPA-GMN-TIMEMASUIKBN
      *
           MOVE  TNS-KNSJISKBN             TO  SPA-GMN-KNSJISKBN       
           MOVE  TNS-KNSJISGRPKBN          TO  SPA-GMN-KNSJISGRPKBN    
           MOVE  TNS-KENTAICOMMENT         TO  SPA-GMN-KENTAICOMMENT   
           MOVE  TNS-TEIGENKBN             TO  SPA-GMN-TEIGENKBN       
           MOVE  TNS-HOUKATUTEIGENKBN      TO  SPA-GMN-HOKATUTEIGENKBN 
           MOVE  TNS-HOUKNSKBN             TO  SPA-GMN-HOUKNSKBN       
           MOVE  TNS-CHPNAISIKSN           TO  SPA-GMN-CHPNAISIKSN     
           MOVE  TNS-NYUKHNKBN             TO  SPA-GMN-NYUKHNKBN
           MOVE  TNS-NYUKHNKSNKBN          TO  SPA-GMN-NYUKHNKSNKBN
           MOVE  TNS-KANGOKSN              TO  SPA-GMN-KANGOKSN 
           MOVE  TNS-CHIIKIKSN             TO  SPA-GMN-CHIIKIKSN
      *H28.4
      *    Èó¿¯½±Åª·ì¹ÔÆ°ÂÖ¥â¥Ë¥¿¥ê¥ó¥°²Ã»»
           MOVE  TNS-HISINSYUMONITORKSN    TO  SPA-GMN-HISINSYUMONKSN
           MOVE  TNS-TOUKETUHOZONKSN       TO  SPA-GMN-TOUKETUHOZONKSN
      *    ÅÀ¿ôÉ½¶èÊ¬ÈÖ¹æ
           MOVE  TNS-KUBUNBANGOU           TO  SPA-GMN-KUBUNBANGOU
      *    Ï«ºÒ»»ÄêÉÔ²Ä
           MOVE  TNS-ROSAIKBN              TO  SPA-GMN-ROSAIKBN
      *    »Í»è²Ã»»¡ÊÏ«ºÒ¡Ë
           MOVE  TNS-SISIKSN               TO  SPA-GMN-SISIKSN
      *H30.4
      *    °­À­¼ðáçÉÂÍýÁÈ¿¥É¸ËÜ²Ã»»
           MOVE  TNS-AKUSEIBYORIKSN        TO  SPA-GMN-AKUSEIBYORIKSN
      *R02.4
      *    ÁÏ³°¸ÇÄê´ï²Ã»»
           MOVE  TNS-SOGAIKOTEIKSN         TO  SPA-GMN-SOGAIKOTEIKSN
      *    Ä¶²»ÇÈÀÚºï´ï²Ã»»
           MOVE  TNS-CHPSESSAKUKSN         TO  SPA-GMN-CHPSESSAKUKSN
      *    º¸¿´¼ªÊÄº¿½ÑÊ»»Ü¶èÊ¬
           MOVE  TNS-SASINJIHEISIKBN       TO  SPA-GMN-SASINJIHEISIKBN
      *                                          
           PERFORM  VARYING  IDXX
                    FROM  1  BY  1  UNTIL  IDXX  >  10
               MOVE  TNS-SSTKIJUNCD(IDXX)  TO  SPA-GMN-SSTKIJUNCD(IDXX)
           END-PERFORM
           MOVE  TNS-GAITENTTLKBN          TO  SPA-GMN-GAITENTTLKBN    
           MOVE  TNS-NYUTENTTLKBN          TO  SPA-GMN-NYUTENTTLSKB   
           MOVE  TNS-KOUHYOJYUNNUM         TO  SPA-GMN-KOUHYOJYUNNUM   
           MOVE  TNS-CDKBN-KBN             TO  SPA-GMN-CDKBN-KBN       
           MOVE  TNS-CDKBN-SYO             TO  SPA-GMN-CDKBN-SYO       
           MOVE  TNS-CDKBN-BU              TO  SPA-GMN-CDKBN-BU        
           MOVE  TNS-CDKBN-KBNNUM          TO  SPA-GMN-CDKBN-KBNNUM    
           MOVE  TNS-CDKBN-KBNNUM-EDA      TO  SPA-GMN-CDKBN-KBNNUM-EDA
           MOVE  TNS-CDKBN-KOUBAN          TO  SPA-GMN-CDKBN-KOUBAN    
           MOVE  TNS-KOKUCHI-KBN           TO  SPA-GMN-KOKUCHI-KBN     
           MOVE  TNS-KOKUCHI-SYO           TO  SPA-GMN-KOKUCHI-SYO     
           MOVE  TNS-KOKUCHI-BU            TO  SPA-GMN-KOKUCHI-BU      
           MOVE  TNS-KOKUCHI-KBNNUM        TO  SPA-GMN-KOKUCHI-KBNNUM  
           MOVE  TNS-KOKUCHI-KBNNUM-EDA    TO
                                           SPA-GMN-KOKUCHI-KBNNUM-EDA
           MOVE  TNS-KOKUCHI-KOUBAN        TO  SPA-GMN-KOKUCHI-KOUBAN  
           MOVE  TNS-KOKUJISKBKBN1         TO  SPA-GMN-KOKUJISKBKBN1   
           MOVE  TNS-KOKUJISKBKBN2         TO  SPA-GMN-KOKUJISKBKBN2   
      *    Àµ¼°Ì¾¾Î
           MOVE  TNS-FORMALNAME            TO  SPA-GMN-FORMALNAME
      *    °åÎÅ´Ñ»¡Ë¡
           MOVE  TNS-IRYOKANSATUKBN        TO  SPA-GMN-IRYOKAN
      *    £Ä£Ð£Ã¶èÊ¬
           MOVE  TNS-DPCKBN                TO  SPA-GMN-DPCKBN
           MOVE  TNS-GAZOOPESUP            TO  SPA-GMN-GAZOOPESUP
           MOVE  TNS-MASUISKBKBN           TO  SPA-GMN-MASUISKBKBN
      *    ³Æ¥ê¥¹¥È¥Ü¥Ã¥¯¥¹ÊÔ½¸
      *****PERFORM 30012-COB-HEN-SEC
           .
      *
       3001-SPASET-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¾ðÊó¤ò£Ó£Ð£Á¤Ë¥»¥Ã¥È¡ÊÅÀ¿ô¥Þ¥¹¥¿ÉÕ²Ã¾ðÊó¡Ë
      *****************************************************************
       3003-TENSUPLUS-COMB-SEC       SECTION.
      *
      *    ºÎ·ìÎÁ¶èÊ¬°ìÍ÷
           MOVE    "0:¡¡¡¡¡¡¡¡"        TO  SPA-GMN-SAIKETUCOMB (01)
           MOVE    "1:Ëö¾¿ºÎ·ì"        TO  SPA-GMN-SAIKETUCOMB (02)
           MOVE    "2:ÀÅÌ®ºÎ·ì"        TO  SPA-GMN-SAIKETUCOMB (03)
           MOVE    "3:Æ°Ì®ºÎ·ì"        TO  SPA-GMN-SAIKETUCOMB (04)
           MOVE    4                   TO  SPA-SAIKETUKBN-MAX
      *    Á°²ó¸¡ººÆü¶èÊ¬
           MOVE    "0 É½¼¨¤·¤Ê¤¤"      TO  SPA-GMN-ZENKNSKBN-COMB(1)
           MOVE    "1 É½¼¨¤¹¤ë¡Ê½é²ó¥³¥á¥ó¥È¡Ë"
                                       TO  SPA-GMN-ZENKNSKBN-COMB(2)
           MOVE    "2 É½¼¨¤¹¤ë¡Ê½é²ó¼Â»ÜÆü¡Ë"
                                       TO  SPA-GMN-ZENKNSKBN-COMB(3)
           MOVE    3                   TO  SPA-ZENKNSKBN-MAX
      *    ¾å¸Â²ó¿ô
           MOVE    "0 Ìµ¸ú"            TO  SPA-GMN-PLUS-SANTEICOMB(1)
           MOVE    "1 Í­¸ú¡Ê»»ÄêÍúÎòºîÀ®¡Ë"
                                       TO  SPA-GMN-PLUS-SANTEICOMB(2)
           MOVE    2                   TO  SPA-PLUS-SANTEI-MAX
           .
       3003-TENSUPLUS-COMB-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¾ðÊó¤ò£Ó£Ð£Á¤Ë¥»¥Ã¥È¡ÊÅÀ¿ô¥Þ¥¹¥¿ÉÕ²Ã¾ðÊó¡Ë
      *****************************************************************
       3002-SPASET-TENSUPLUS-SEC       SECTION.
      *
      *    ÆþÎÏ¥Á¥§¥Ã¥¯¶èÊ¬
      **** MOVE    TNSP-INPCHKKBN      TO  SPA-GMN-INPCHKKBN
      *    ½èÊýÌ¾
           MOVE    TNSP-SHONAME        TO  SPA-GMN-SHONAME
      *    ºÎ·ì¶èÊ¬
           MOVE    TNSP-SAIKETUKBN     TO  SPA-GMN-SAIKETUKBN
      *    ºÎ·ìÎÁ¶èÊ¬°ìÍ÷
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SAIKETUKBN-MAX
               IF      SPA-GMN-SAIKETUKBN  =   SPA-GMN-SAIKETUCOMB
                                                            (IDX)(1:1)
                   MOVE    SPA-GMN-SAIKETUCOMB (IDX)
                                           TO  SPA-GMN-SAIKETUKBN-G
                   MOVE    SPA-SAIKETUKBN-MAX  TO  IDX
               END-IF
           END-PERFORM
      *    Á°²ó¸¡ººÆü¶èÊ¬
           MOVE    TNSP-ZENKNSKBN      TO  SPA-GMN-ZENKNSKBN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-ZENKNSKBN-MAX
               IF      SPA-GMN-ZENKNSKBN   =   SPA-GMN-ZENKNSKBN-COMB
                                                            (IDX)(1:1)
                   MOVE    SPA-GMN-ZENKNSKBN-COMB (IDX)
                                           TO  SPA-GMN-ZENKNSKBN-G
                   MOVE    SPA-ZENKNSKBN-MAX  TO  IDX
               END-IF
           END-PERFORM
      *
      *    ¾å¸Â²ó¿ô
           MOVE    TNSP-SANTEIRRKKBN   TO  SPA-GMN-PLUS-SANTEIRRK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PLUS-SANTEI-MAX
               IF      SPA-GMN-PLUS-SANTEIRRK
                                       =   SPA-GMN-PLUS-SANTEICOMB
                                                            (IDX)(1:1)
                   MOVE    SPA-GMN-PLUS-SANTEICOMB (IDX)
                                           TO  SPA-GMN-PLUS-SANTEIRRK-G
                   MOVE    SPA-PLUS-SANTEI-MAX  TO  IDX
               END-IF
           END-PERFORM
      *    ·î¾å¸Â²ó¿ô
           MOVE    TNSP-JGNCNT         TO  SPA-GMN-PLUS-JGNCNT
      *    ·î¾å¸Â²ó¿ô
           MOVE    TNSP-JGNCNT         TO  SPA-GMN-PLUS-JGNCNT
      *    Æü¾å¸Â²ó¿ô
           MOVE    TNSP-JGNCNT1D       TO  SPA-GMN-PLUS-JGNCNT1D
      *    ½µ¾å¸Â²ó¿ô
           MOVE    TNSP-JGNCNT1W       TO  SPA-GMN-PLUS-JGNCNT1W
      *    Â¾·î¿ô
           MOVE    TNSP-JGNCNTETCM     TO  SPA-GMN-PLUS-JGNCNTETCM
      *    Â¾²ó¿ô
           MOVE    TNSP-JGNCNTETC      TO  SPA-GMN-PLUS-JGNCNTETC
      *    ¥¨¥é¡¼½èÍý
           MOVE    TNSP-JGNCNTERR      TO  SPA-GMN-PLUS-JGNCNTERR
           .
      *
       3002-SPASET-TENSUPLUS-EXT.
           EXIT.
      *
      *****************************************************************
      *   ³Æ¥ê¥¹¥È¥Ü¥Ã¥¯¥¹ÊÔ½¸½èÍý
      *****************************************************************
       30012-COB-HEN-SEC            SECTION.
      *
      *    ¿ÇÎÅ¶èÊ¬¡¦¿ÇÎÅ¼ïÊÌ
           MOVE    ZERO                TO  IDX-1
           MOVE    ZERO                TO  IDX-2
      *    MOVE    1                   TO  IDX-1
      *    MOVE    1                   TO  IDX-2
      **** MOVE    SPACE               TO  SPA-GMN-SRYKBNCOB(IDX-1)
      *    MOVE    SPACE               TO  SPA-GMN-SRYSYUKBNCOB
      *                                                      (IDX-2)
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   200  )   OR
                              (MSYU-SRYKBN (IDX)   =   SPACE )
      *        ²Ã»»¤ÏÂÐ¾Ý³°
             IF      MSYU-SRYSYUKBN (IDX)      =   "114"
                                               OR  "124"
                                               OR  "133"
               CONTINUE
             ELSE
      *
      *        ¿ÇÎÅ¶èÊ¬
               IF      (IDX-1          =   ZERO )  OR
                       (SPA-GMN-SRYKBN-L(IDX-1)(1:2)
                                   NOT =   MSYU-SRYKBN (IDX))
                   ADD     1               TO  IDX-1
                   MOVE    MSYU-SRYKBN (IDX)
                                           TO  SPA-GMN-SRYKBN-L(IDX-1)
                   EVALUATE    MSYU-SRYKBN (IDX)
                       WHEN    "11"
                       WHEN    "12"
                           MOVE    "¿Ç»¡"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "13"
                           MOVE    "»ØÆ³"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "14"
                           MOVE    "ºßÂð"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "21"
                       WHEN    "22"
                       WHEN    "23"
                       WHEN    "24"
                           MOVE    "ÌôºÞ"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "25"
                           MOVE    "½èÊý"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "26"
                           MOVE    "ËãÆÇ"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "27"
                           MOVE    "Ä´´ð"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "31"
                       WHEN    "32"
                       WHEN    "33"
                           MOVE    "Ãí¼Í"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "40"
                           MOVE    "½èÃÖ"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "50"
                           MOVE    "¼ê½Ñ"  TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "54"
                           MOVE    "Ëã¿ì"  TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "60"
                           MOVE    "¸¡ºº"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "64"
                           MOVE    "ÉÂÍý¿ÇÃÇ"  TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "70"
                           MOVE    "²èÁü¿ÇÃÇ"  TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "80"
                           MOVE    "¤½¤ÎÂ¾"    TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "93"
                           MOVE    "Ï·¿ÍÉéÃ´"  TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "95"
                           MOVE    "ÊÝ¸±³°"    TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "96"
                           MOVE    "ÊÝ¸±³°"    TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "97"
                           MOVE    "¿©»ö"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "90"
                           MOVE    "Æþ±¡"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    "92"
                           MOVE    "Æþ±¡"      TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                       WHEN    OTHER
                           MOVE    "¤½¤ÎÂ¾"    TO  SPA-GMN-SRYKBNME-L
                                                               (IDX-1)
                   END-EVALUATE
               END-IF
      *        ¿ÇÎÅ¼ïÊÌ
               ADD     1                   TO  IDX-2
               MOVE    MSYU-SRYSYUKBN (IDX)    TO  SPA-GMN-SRYSYUKBNCOB
                                                           (IDX-2)(1:3)
               MOVE    MSYU-SRYMEI    (IDX)    TO  SPA-GMN-SRYSYUKBNCOB
                                                           (IDX-2)(5:)
      *
             END-IF
           END-PERFORM
      *
           MOVE    IDX-1               TO  SPA-SRYKBN-MAX
           MOVE    IDX-2               TO  SPA-SRYSYUKBN-MAX
      *
      **** ADD     1                   TO  IDX-1
      *    MOVE    "90"                 TO  SPA-GMN-SRYKBN-L(IDX-1)
      *    MOVE    "Æþ±¡"              TO  SPA-GMN-SRYKBNME-L (IDX-1)
      *    ADD     1                   TO  IDX-2
      **** MOVE    "900 Æþ±¡"          TO  SPA-GMN-SRYSYUKBNCOB(IDX-2)
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SRYKBN-MAX
               IF      SPA-GMN-SRYKBN      =   SPA-GMN-SRYKBN-L(IDX)
                   MOVE    SPA-GMN-SRYKBNCOB (IDX) TO  SPA-GMN-SRYKBN-G
                   MOVE    SPA-SRYKBN-MAX          TO  IDX
               END-IF
           END-PERFORM
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SRYSYUKBN-MAX
               IF      SPA-GMN-SRYSYUKBN   =   SPA-GMN-SRYSYUKBNCOB
                                                         (IDX)(1:3)
                   MOVE    SPA-GMN-SRYSYUKBNCOB (IDX)
                                               TO  SPA-GMN-SRYSYUKBN-G
                   MOVE    SPA-SRYSYUKBN-MAX   TO  IDX
               END-IF
           END-PERFORM
      *
      *    ¥Ç¡¼¥¿¶èÊ¬
           MOVE    "0 ¤Ê¤·"            TO  SPA-GMN-DATAKBNCOB (1)
           MOVE    "1 ¼êµ»"            TO  SPA-GMN-DATAKBNCOB (2)
           MOVE    "2 ²Ã»»"            TO  SPA-GMN-DATAKBNCOB (3)
           MOVE    3                   TO  SPA-DATAKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-DATAKBN-MAX
               IF      SPA-GMN-DATAKBN     =   SPA-GMN-DATAKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-DATAKBNCOB (IDX)
                                               TO  SPA-GMN-DATAKBN-G
                   MOVE    SPA-DATAKBN-MAX     TO  IDX
               END-IF
           END-PERFORM
      *
      *    ¥Ç¡¼¥¿µ¬³Ê
           MOVE    ZERO            TO  IDX-1
           PERFORM VARYING IDX     FROM    1   BY  1
                   UNTIL   IDX     >       MTANI-MAX
               ADD     1               TO  IDX-1
               MOVE    MTANI-TANICD  (IDX)
                                       TO  SPA-GMN-TANICDCOB(IDX-1)(1:3)
               MOVE    MTANI-TANINAME(IDX)
                                       TO  SPA-GMN-TANICDCOB(IDX-1)(5:)
               MOVE   IDX-1            TO  SPA-TANICD-MAX
           END-PERFORM
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-TANICD-MAX
               IF      SPA-GMN-TANICD     =   SPA-GMN-TANICDCOB
                                                         (IDX)(1:3)
                   MOVE    SPA-GMN-TANICDCOB (IDX)
                                               TO  SPA-GMN-TANICD-G
                   MOVE    SPA-TANICD-MAX      TO  IDX
               END-IF
           END-PERFORM
      *
      *    ÅÀ¿ô¼±ÊÌ
           MOVE    "0     "            TO  SPA-GMN-TENSIKIBETUCOB (1)
           MOVE    "1 ¶â³Û"            TO  SPA-GMN-TENSIKIBETUCOB (2)
           MOVE    "3 ÅÀ¿ô"            TO  SPA-GMN-TENSIKIBETUCOB (3)
           MOVE    "4 ÅÔÆ»ÉÜ¸©¹ØÆþ²Á³Ê"
                                       TO  SPA-GMN-TENSIKIBETUCOB (4)
           MOVE    "5 ¡ó²Ã»»"          TO  SPA-GMN-TENSIKIBETUCOB (5)
           MOVE    "6 ¡ó¸º»»"          TO  SPA-GMN-TENSIKIBETUCOB (6)
           MOVE    "7 ¸ºÅÀ¿ÇÎÅ¹Ô°Ù"    TO  SPA-GMN-TENSIKIBETUCOB (7)
           MOVE    "8 ÅÀ¿ô¡Ê¥Þ¥¤¥Ê¥¹¡Ë"
                                       TO  SPA-GMN-TENSIKIBETUCOB (8)
           MOVE    8                   TO  SPA-TENSIKI-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-TENSIKI-MAX
               IF      SPA-GMN-TENSIKIBETU =   SPA-GMN-TENSIKIBETUCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-TENSIKIBETUCOB (IDX)
                                               TO  SPA-GMN-TENSIKIBETU-G
                   MOVE    SPA-TENSIKI-MAX     TO  IDX
               END-IF
           END-PERFORM
      *
      *    µìÅÀ¿ô¼±ÊÌ
           MOVE    "0     "            TO  SPA-GMN-OLDTENSKBCOB (1)
           MOVE    "1 ¶â³Û"            TO  SPA-GMN-OLDTENSKBCOB (2)
           MOVE    "3 ÅÀ¿ô"            TO  SPA-GMN-OLDTENSKBCOB (3)
           MOVE    "4 ÅÔÆ»ÉÜ¸©¹ØÆþ²Á³Ê"
                                       TO  SPA-GMN-OLDTENSKBCOB (4)
           MOVE    "5 ¡ó²Ã»»"          TO  SPA-GMN-OLDTENSKBCOB (5)
           MOVE    "6 ¡ó¸º»»"          TO  SPA-GMN-OLDTENSKBCOB (6)
           MOVE    "7 ¸ºÅÀ¿ÇÎÅ¹Ô°Ù"    TO  SPA-GMN-OLDTENSKBCOB (7)
           MOVE    "8 ÅÀ¿ô¡Ê¥Þ¥¤¥Ê¥¹¡Ë"
                                       TO  SPA-GMN-OLDTENSKBCOB (8)
           MOVE    8                   TO  SPA-OLDTENSKB-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-OLDTENSKB-MAX
               IF      SPA-GMN-OLDTENSKB =   SPA-GMN-OLDTENSKBCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-OLDTENSKBCOB (IDX)
                                               TO  SPA-GMN-OLDTENSKB-G
                   MOVE    SPA-OLDTENSKB-MAX   TO  IDX
               END-IF
           END-PERFORM
      *
      *    ÊÝ¸±Å¬ÍÑ
           MOVE    "0 ÊÝ¸±Å¬ÍÑ¤Ê¤·"    TO  SPA-GMN-HKNTEKKBNCOB (1)
           MOVE    "1 ÊÝ¸±Å¬ÍÑ¤¢¤ê"    TO  SPA-GMN-HKNTEKKBNCOB (2)
           MOVE    2                   TO  SPA-HKNTEKKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-HKNTEKKBN-MAX
               IF      SPA-GMN-HKNTEKKBN   =   SPA-GMN-HKNTEKKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-HKNTEKKBNCOB (IDX)
                                           TO  SPA-GMN-HKNTEKKBN-G
                   MOVE    SPA-HKNTEKKBN-MAX   TO  IDX
               END-IF
           END-PERFORM
      *
      *    Æþ³°¶èÊ¬
           MOVE    "0 Æþ±¡¡¦Æþ±¡³°"    TO  SPA-GMN-NYUGAITEKKBNCOB (1)
           MOVE    "1 Æþ±¡"            TO  SPA-GMN-NYUGAITEKKBNCOB (2)
           MOVE    "2 Æþ±¡³°"          TO  SPA-GMN-NYUGAITEKKBNCOB (3)
           MOVE    3                   TO  SPA-NYUGAITEKKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-NYUGAITEKKBN-MAX
               IF      SPA-GMN-NYUGAITEKKBN
                                           =   SPA-GMN-NYUGAITEKKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-NYUGAITEKKBNCOB (IDX)
                                           TO  SPA-GMN-NYUGAITEKKBN-G
                   MOVE    SPA-NYUGAITEKKBN-MAX    TO  IDX
               END-IF
           END-PERFORM
      *
      *    Ï·¿ÍÅ¬±þ
           MOVE    "0 ¼Ò²ñÊÝ¸±¡¦Ï·¿ÍÊÝ·ò"
                                       TO  SPA-GMN-ROUTEKKBNCOB (1)
           MOVE    "1 ¼Ò²ñÊÝ¸±¤Î¤ß"
                                       TO  SPA-GMN-ROUTEKKBNCOB (2)
           MOVE    "2 Ï·¿ÍÊÝ·ò¤Î¤ß"
                                       TO  SPA-GMN-ROUTEKKBNCOB (3)
           MOVE    3                   TO  SPA-ROUTEKKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-ROUTEKKBN-MAX
               IF      SPA-GMN-ROUTEKKBN   =   SPA-GMN-ROUTEKKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-ROUTEKKBNCOB (IDX)
                                           TO  SPA-GMN-ROUTEKKBN-G
                   MOVE    SPA-ROUTEKKBN-MAX   TO  IDX
               END-IF
           END-PERFORM
      *
      *    ÉÂ±¡Å¬±þ
           MOVE    "0 ÉÂ±¡¡¦¿ÇÎÅ½ê"
                                       TO  SPA-GMN-HOSPSRYKBNCOB (1)
           MOVE    "1 ÉÂ±¡¤Î¤ß"
                                       TO  SPA-GMN-HOSPSRYKBNCOB (2)
           MOVE    "2 ¿ÇÎÅ½ê¤Î¤ß"
                                       TO  SPA-GMN-HOSPSRYKBNCOB (3)
      *H30.4
           MOVE    "3 Ã»´üÂÚºß¼ê½ÑÅù´ðËÜÎÁ£²"
                                       TO  SPA-GMN-HOSPSRYKBNCOB (4)
           MOVE    "4 Ã»´üÂÚºß¼ê½ÑÅù´ðËÜÎÁ£³"
                                       TO  SPA-GMN-HOSPSRYKBNCOB (5)
           MOVE    5                   TO  SPA-HOSPSRYKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-HOSPSRYKBN-MAX
               IF      SPA-GMN-HOSPSRYKBN  =   SPA-GMN-HOSPSRYKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-HOSPSRYKBNCOB (IDX)
                                           TO  SPA-GMN-HOSPSRYKBN-G
                   MOVE    SPA-HOSPSRYKBN-MAX  TO  IDX
               END-IF
           END-PERFORM
      *
      *    °åÎÅ´Ñ»¡Ë¡
           MOVE    "0 Å¬ÍÑ³°"
                                       TO  SPA-GMN-IRYOKANCOB (1)
           MOVE    "1 Æþ±¡½ÐÍè¹â"
                                       TO  SPA-GMN-IRYOKANCOB (2)
           MOVE    "2 ÄÌ±¡½ÐÍè¹â"
                                       TO  SPA-GMN-IRYOKANCOB (3)
           MOVE    "3 Æþ±¡ÄÌ±¡½ÐÍè¹â"
                                       TO  SPA-GMN-IRYOKANCOB (4)
           MOVE    "4 °åÎÅ´Ñ»¡Ë¡ÀìÍÑ"
                                       TO  SPA-GMN-IRYOKANCOB (5)
           MOVE    5                   TO  SPA-IRYOKAN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-IRYOKAN-MAX
               IF      SPA-GMN-IRYOKAN     =   SPA-GMN-IRYOKANCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-IRYOKANCOB (IDX)
                                           TO  SPA-GMN-IRYOKAN-G
                   MOVE    SPA-IRYOKAN-MAX TO  IDX
               END-IF
           END-PERFORM
      *
      *    ±ý¿Ç¶èÊ¬
           MOVE    "0 ±ý¿ÇÂÐ¾Ý³°"
                                       TO  SPA-GMN-OSINKBNCOB (1)
           MOVE    "1 ±ý¿ÇÎÁ¡¢Ë¬Ìä¿ÇÎÅ"
                                       TO  SPA-GMN-OSINKBNCOB (2)
           MOVE    "2 ¿ÇÎÅ»þ´Ö²Ã»»"
                                       TO  SPA-GMN-OSINKBNCOB (3)
           MOVE    "4 Ìë´Ö²Ã»»¡¦¿¼Ìë²Ã»»"
                                       TO  SPA-GMN-OSINKBNCOB (4)
           MOVE    "5 ÆÃÊÌ±ý¿Ç²Ã»»"
                                       TO  SPA-GMN-OSINKBNCOB (5)
           MOVE    "6 ÆÃÊÌ±ý¿ÇÎÁ"
                                       TO  SPA-GMN-OSINKBNCOB (6)
           MOVE    "7 »àË´¿Ç¿Ç²Ã»»"
                                       TO  SPA-GMN-OSINKBNCOB (7)
           MOVE    "8 ¶ÛµÞ²Ã»»"
                                       TO  SPA-GMN-OSINKBNCOB (8)
           MOVE    8                   TO  SPA-OSINKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-OSINKBN-MAX
               IF      SPA-GMN-OSINKBN  =   SPA-GMN-OSINKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-OSINKBNCOB (IDX)
                                               TO  SPA-GMN-OSINKBN-G
                   MOVE    SPA-OSINKBN-MAX     TO  IDX
               END-IF
           END-PERFORM
      *
      *    »»ÄêÍúÎò
           MOVE    "0 »»ÄêÍúÎò¤Ê¤·"
                                       TO  SPA-GMN-SANTEIRRKKBNCOB (1)
           MOVE    "1 ¿ÇÎÅ²Ê¡¢Æþ³°¶èÊ¬¤Î»ØÄê¤Ê¤·"
                                       TO  SPA-GMN-SANTEIRRKKBNCOB (2)
           MOVE    "2 Æþ³°¶èÊ¬¤Î»ØÄê"
                                       TO  SPA-GMN-SANTEIRRKKBNCOB (3)
           MOVE    "3 ¿ÇÎÅ²Ê¤Î»ØÄê"
                                       TO  SPA-GMN-SANTEIRRKKBNCOB (4)
           MOVE    "4 ¿ÇÎÅ²Ê¡¢Æþ³°¶èÊ¬¤Î»ØÄê"
                                       TO  SPA-GMN-SANTEIRRKKBNCOB (5)
           MOVE    5                   TO  SPA-SANTEIRRKKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SANTEIRRKKBN-MAX
               IF      SPA-GMN-SANTEIRRKKBN  =   SPA-GMN-SANTEIRRKKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-SANTEIRRKKBNCOB (IDX)
                                           TO  SPA-GMN-SANTEIRRKKBN-G
                   MOVE    SPA-SANTEIRRKKBN-MAX    TO  IDX
               END-IF
           END-PERFORM
      *
      *    »þ´Ö³°
           MOVE    ZERO                  TO  SPA-TIMEKSNKBN-MAX
           IF      SPA-GMN-DATAKBN       =   1  OR  ZERO
               MOVE    "0 »þ´Ö³°»»ÄêÉÔ²Ä"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (1)
               MOVE    "1 »þ´Ö³°»»Äê²ÄÇ½"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (2)
               MOVE    "3 ½é¿ÇÎÁ¤ÎµÙÆü¤Ë·¸¤ë"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (3)
               MOVE    3                 TO  SPA-TIMEKSNKBN-MAX
           END-IF
           IF    ( SPA-GMN-DATAKBN        =   2  )
      *H28.9
      *        ¼êµ»ÎÁ¤Ç»þ´Ö¶èÊ¬¤¬»þ´Ö³°¶èÊ¬¤Ç¤¢¤ë»þ
           OR    ((SPA-GMN-DATAKBN        =   1   )  AND
                  (TNS-KOKUJISKBKBN2      =   "7" )  AND
                  (TNS-TIMEKSNKBN         <>  "0" )  AND
                  (TNS-SRYKBN             =   "11"
                                          OR  "12"
                                          OR  "13"
                                          OR  "14" ))
               MOVE    "0 ²¼µ­°Ê³°¤Î¿ÇÎÅ¹Ô°Ù"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (1)
               MOVE    "1 »þ´Ö³°²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (2)
               MOVE    "2 µÙÆü²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (3)
               MOVE    "3 ½é¿ÇÎÁ¤ÎµÙÆü²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (4)
               MOVE    "4 ¿¼Ìë²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (5)
               MOVE    "5 »þ´Ö³°ÆÃÄê²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (6)
               MOVE    "6 Ìë´Ö¡¦ÁáÄ«²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (7)
               MOVE    "7 Ìë´Ö²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (8)
               MOVE    "8 »þ´Ö³°Åù²Ã»»¡Ê100ÅÀ°Ê¾å¡Ë"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (9)
               MOVE    "9 µÙÆü²Ã»»¡Ê100ÅÀ°Ê¾å¡Ë"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (10)
               MOVE    10                TO  SPA-TIMEKSNKBN-MAX
           END-IF
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-TIMEKSNKBN-MAX
               IF      SPA-GMN-TIMEKSNKBN  =   SPA-GMN-TIMEKSNKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-TIMEKSNKBNCOB (IDX)
                                           TO  SPA-GMN-TIMEKSNKBN-G
                   MOVE    SPA-TIMEKSNKBN-MAX  TO  IDX
               END-IF
           END-PERFORM
      *
      *    ³°Íè´ÉÍý²Ã»»
           MOVE    "0 ³°Íè´ÉÍý²Ã»»¤¬»»Äê¤Ç¤­¤ë"
                                       TO  SPA-GMN-GAIKANRIKBNCOB (1)
           MOVE    "1 ³°Íè´ÉÍý²Ã»»¤¬»»Äê¤Ç¤­¤Ê¤¤"
                                       TO  SPA-GMN-GAIKANRIKBNCOB (2)
           MOVE    "2 ³°Íè´ÉÍý²Ã»»"
                                       TO  SPA-GMN-GAIKANRIKBNCOB (3)
           MOVE    3                   TO  SPA-GAIKANRIKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >    SPA-GAIKANRIKBN-MAX
               IF      SPA-GMN-GAIKANRIKBN  =   SPA-GMN-GAIKANRIKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-GAIKANRIKBNCOB (IDX)
                                           TO  SPA-GMN-GAIKANRIKBN-G
                   MOVE    SPA-GAIKANRIKBN-MAX TO  IDX
               END-IF
           END-PERFORM
      *
      *    ½ýÉÂÌ¾´ØÏ¢
           MOVE    "00 "
                                       TO  SPA-GMN-BYOKANRENKBNCOB (1)
           MOVE    "03 ÈéÉæ²ÊÆÃÄê¼ÀÉÂ»ØÆ³´ÉÍýÎÁ¡Ê£±¡Ë"
                                       TO  SPA-GMN-BYOKANRENKBNCOB (2)
           MOVE    "04 ÈéÉæ²ÊÆÃÄê¼ÀÉÂ»ØÆ³´ÉÍýÎÁ¡Ê£²¡Ë"
                                       TO  SPA-GMN-BYOKANRENKBNCOB (3)
           MOVE    "05 ÆÃÄê¼À´µÎÅÍÜ»ØÆ³ÎÁµÚ¤ÓÏ·¿ÍËýÀ­¼À´µÀ¸³è»ØÆ³"
                                       TO  SPA-GMN-BYOKANRENKBNCOB (4)
           MOVE    "06 ÈéÉæ²ÊÆÃÄê¼ÀÉÂ»ØÆ³´ÉÍýÎÁ¡Ê£³¡Ë"
                                       TO  SPA-GMN-BYOKANRENKBNCOB (5)
           MOVE    "07 ¤Æ¤ó¤«¤ó»ØÆ³ÎÁ"
                                       TO  SPA-GMN-BYOKANRENKBNCOB (6)
           MOVE    "09 ÆñÉÂ³°Íè»ØÆ³´ÉÍýÎÁ"
                                       TO  SPA-GMN-BYOKANRENKBNCOB (7)
           MOVE    7                   TO  SPA-BYOKANRENKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-BYOKANRENKBN-MAX
               IF      SPA-GMN-BYOKANRENKBN  =   SPA-GMN-BYOKANRENKBNCOB
                                                         (IDX)(1:2)
                   MOVE    SPA-GMN-BYOKANRENKBNCOB (IDX)
                                           TO  SPA-GMN-BYOKANRENKBN-G
                   MOVE    SPA-BYOKANRENKBN-MAX    TO  IDX
               END-IF
           END-PERFORM
      *
      *    °åÌôÉÊ´ØÏ¢
           MOVE    "0"
                                           TO  SPA-GMN-YKZKNRKBNCOB (1)
           MOVE    "1 ËãÆÇ¡¢³Ð¤»¤¤ºÞ¡¢¸þÀº¿ÀÌô²Ã»»"
                                           TO  SPA-GMN-YKZKNRKBNCOB (2)
           MOVE    "3 ¿À·Ð¥Ö¥í¥Ã¥¯"
                                           TO  SPA-GMN-YKZKNRKBNCOB (3)
           MOVE    "4 À¸Êª³ØÅªÀ½ºÞ"
                                           TO  SPA-GMN-YKZKNRKBNCOB (4)
           MOVE    4                   TO  SPA-YKZKNRKBN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-YKZKNRKBN-MAX
               IF      SPA-GMN-YKZKNRKBN   =   SPA-GMN-YKZKNRKBNCOB
                                                         (IDX)(1:2)
                   MOVE    SPA-GMN-YKZKNRKBNCOB (IDX)
                                               TO  SPA-GMN-YKZKNRKBN-G
                   MOVE    SPA-YKZKNRKBN-MAX   TO  IDX
               END-IF
           END-PERFORM
      *    »ØÆ³´ÉÍý¥³¡¼¥É
           PERFORM VARYING IDX     FROM    1   BY  1
                   UNTIL   IDX     >       SDO-MAX
               MOVE    TBL-SDOKNRYO  (IDX)
                                       TO  SPA-GMN-SDOKNRYOCOB(IDX)
                                                             (1:2)
               MOVE    TBL-SDOKNRYOMEI(IDX)
                                       TO  SPA-GMN-SDOKNRYOCOB(IDX)
                                                            (4:)
               MOVE    IDX             TO  SPA-SDOKNRYO-MAX
           END-PERFORM
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SDOKNRYO-MAX
               IF      SPA-GMN-SDOKNRYO    =   SPA-GMN-SDOKNRYOCOB
                                                         (IDX)(1:3)
                   MOVE    SPA-GMN-SDOKNRYOCOB (IDX)
                                               TO  SPA-GMN-SDOKNRYO-G
                   MOVE    SPA-SDOKNRYO-MAX    TO  IDX
               END-IF
           END-PERFORM
      *
      *
           .
      *
       30012-COB-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ³ÎÇ§²èÌÌ¡Ê£Ã£É£Ä£±¡Ë£Ï£Ë½èÍý
      *****************************************************************
       330-ZID1-SET-SEC            SECTION.
      *
           EVALUATE    SPA-ZIDCD
               WHEN    "0001"
      *            ºï½ü
                   IF      SPA-ZID1-FLG    =   "OK"
                       PERFORM  4031-DEL-SEC
                   ELSE
                       MOVE    ZERO            TO  SPA-NAI-KEIFLG1
                   END-IF
               WHEN    "0002"
      *            ÅÐÏ¿
                   IF      SPA-ZID1-FLG    =   "OK"
                       PERFORM  4121-TOUROKU-SEC
                   ELSE
                       MOVE    ZERO            TO  SPA-NAI-KEIFLG2
                   END-IF
           END-EVALUATE
      *
           IF      SPA-ERRCD       NOT =  SPACE
               PERFORM 510-ERRSET-SEC
           END-IF
           MOVE    SPACE           TO  SPA-ZID1-FLG
           MOVE    SPACE           TO  SPA-ZIDCD
           .
       330-ZID1-SET-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    ²èÌÌÁ«°Ü½èÍý
      *****************************************************************
       200-GMNSENI-SEC                           SECTION.
      *
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
      *        Ìá¤ë
               WHEN    "CLICKED"       ALSO    "B01"
                   MOVE  "CHANGE"      TO  MCP-PUTTYPE
                   PERFORM  401-BACK-SEC
      *        ºï½ü
               WHEN    "CLICKED"       ALSO    "B03"
                   PERFORM  403-DEL-SEC
      *        ÆþÎÏ¥³¡¼¥ÉÀßÄê
               WHEN    "CLICKED"       ALSO    "B05"
                   PERFORM  405-INPUTCD-SEC
      *        Ï·¿Í°ìÈÌ¥³¡¼¥É¿¶ÂØÀßÄê
               WHEN    "CLICKED"       ALSO    "B07"
                   PERFORM  407-SRYCDCHG-SEC
      *        ³ÎÄê
               WHEN    "CLICKED"       ALSO    "B12"
                   PERFORM  412-TOUROKU-SEC
      *ver.5.0
      *H29.01
      *        ¥æ¡¼¥¶¡¼¹àÌÜÅÐÏ¿
               WHEN    "CLICKED"       ALSO    "B10"
                   PERFORM  407-B10-SYORI-SEC
      *ver.4.7 ´ðËÜ¾ðÊó
      *        WHEN    "CLICKED"       ALSO    "BJ1"
      *            PERFORM 420-KIRIKAE-SEC
      *            IF      SPA-ERRCD       =   SPACE
      *                MOVE    0               TO  SPA-GMN-PAGENO
      *                MOVE    ZERO            TO  SPA-GMN-CUR
      *            END-IF
      *        ²ó¿ô¡¢Ç¯Îð
      *        WHEN    "CLICKED"       ALSO    "BJ2"
      *            PERFORM 420-KIRIKAE-SEC
      *            IF      SPA-ERRCD       =   SPACE
      *                MOVE    1               TO  SPA-GMN-PAGENO
      *                MOVE    ZERO            TO  SPA-GMN-CUR
      *            END-IF
      *        ¼ê½Ñ¡¢¸¡ºº¡¢Æþ±¡
      *        WHEN    "CLICKED"       ALSO    "BJ3"
      *            PERFORM 420-KIRIKAE-SEC
      *            IF      SPA-ERRCD       =   SPACE
      *                MOVE    2               TO  SPA-GMN-PAGENO
      *                MOVE    ZERO            TO  SPA-GMN-CUR
      *            END-IF
      *        ³Æ¼ïÈÖ¹æÅù
      *        WHEN    "CLICKED"       ALSO    "BJ4"
      *            PERFORM 420-KIRIKAE-SEC
      *            IF      SPA-ERRCD       =   SPACE
      *                MOVE    3               TO  SPA-GMN-PAGENO
      *                MOVE    ZERO            TO  SPA-GMN-CUR
      *******      END-IF
      *        ¥¿¥ÖÀÚÂØ
               WHEN    "CLICKED"       ALSO    "B08"
                   PERFORM 480-BETUGAMEN-SEC
           END-EVALUATE.
      *
       200-GMNSENI-EXT.
           EXIT.
      *****************************************************************
      *    ²ñÏÃ¡¡½èÍý
      *****************************************************************
       200-ENTRY-SEC                             SECTION.
      *
      *    ÆþÎÏ¸Ä½ê¤Î¥»¥Ã¥È
           MOVE    MCP-WIDGET          TO  WRK-MCP-WIDGET
           MOVE    ZERO                TO  SPA-GMN-CUR
      *
           MOVE    ZERO                TO  FLG-TOUROKU
      *
      *ver.4.7 
           EVALUATE    MCP-EVENT       ALSO    MCP-WIDGET
      *        ´ðËÜ¾ðÊó
               WHEN    "SWITCH"       ALSO    "not1"
                   PERFORM 420-KIRIKAE-SEC
      *
               WHEN    OTHER
      *            ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
                   PERFORM 410-INPUT-CHK-SEC
           END-EVALUATE
      *
           .
       200-ENTRY-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       410-INPUT-CHK-SEC          SECTION.
      *
      *    ²èÌÌ¤ò£Ó£Ð£Á¥»¥Ã¥È
           PERFORM 4101-GMN-SPA-SET-SEC
      *    ´ðËÜ¥Á¥§¥Ã¥¯¤ÈÊÌ²èÌÌ½èÍý
           PERFORM 4102-KIHON-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
      *        ÅÐÏ¿»þ¡¢ÆâÍÆÊÑ¹¹¤ÎÌµ¤¤¾ì¹ç¡¢¥¨¥é¡¼¤È¤·¤Ê¤¤
               IF      FLG-TOUROKU         =   1
                   PERFORM 4103-HENKOU-CHK-SEC
               END-IF
           END-IF
      *
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      410-INPUT-CHK-EXT
           END-IF
      *
      *    ÅÐÏ¿»þ¡¢É¬¿ÜÆþÎÏ¥Á¥§¥Ã¥¯
           IF      FLG-TOUROKU         =   1
               PERFORM 4109-TOUROKU-CHK-SEC
           END-IF
      *
           .
      *
       410-INPUT-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ£Ó£Ð£ÁÊÔ½¸½èÍý
      *****************************************************************
       4101-GMN-SPA-SET-SEC          SECTION.
      *
      *    ²èÌÌ¥Ú¡¼¥¸
           MOVE    Z03-PAGENO          TO  SPA-GMN-PAGENO
      *R01.10
      *    Á°²ó¸¡ººÆü¤ÎÊÑ¹¹»þ¤Î¤ß¡¢¡Ö¥æ¡¼¥¶¡¼¡×¤Ø
           IF     (Z03-ZENKNSKBN   NOT =   SPA-GMN-ZENKNSKBN-G )
      *       ¥æ¡¼¥¶¡¼¤Ø
               MOVE    1                TO  FLG-USERIN
           END-IF
      *R01.10
      *
      *H29.1
      *    ¥æ¡¼¥¶¡¼ÅÀ¿ô¼±ÊÌ¡Ê2¡§¥æ¡¼¥¶¡¼¥Þ¥¹¥¿¡Ë¤Î¤ßÈ¿±Ç
           IF     (SPA-MASTER-CLASS    =   2 )
               OR (SPA-MENTE-OK        =   1 )
               CONTINUE
           ELSE
               GO      TO      4101-GMN-SPA-SET-EXT
           END-IF
      *
           MOVE    Z03-YUKOSTYMD       TO  SPA-GMN-YUKOSTYMD
           MOVE    Z03-YUKOEDYMD       TO  SPA-GMN-YUKOEDYMD
      *    ¿ÇÎÅ¶èÊ¬
           MOVE    Z03-SRYKBN          TO  SPA-GMN-SRYKBN-G
      *    ¿ÇÎÅ¼ïÊÌ
           MOVE    Z03-SRYSYUKBN       TO  SPA-GMN-SRYSYUKBN-G
           MOVE    Z03-DATAKBN         TO  SPA-GMN-DATAKBN-G
           MOVE    Z03-KANANAME        TO  SPA-GMN-KANANAME
           MOVE    Z03-NAME            TO  SPA-GMN-NAME
           MOVE    Z03-FORMALNAME      TO  SPA-GMN-FORMALNAME
      *H29.1  ÉÕ²Ã¾ðÊóÉÔ²Ä
      **** MOVE    Z03-SHONAME         TO  SPA-GMN-SHONAME
           MOVE    Z03-TEN             TO  SPA-GMN-TEN
           MOVE    Z03-TENSIKIBETU     TO  SPA-GMN-TENSIKIBETU-G
           MOVE    Z03-OLDTEN          TO  SPA-GMN-OLDTEN
           MOVE    Z03-OLDTENSKB       TO  SPA-GMN-OLDTENSKB-G
           MOVE    Z03-TANICD          TO  SPA-GMN-TANICD-G
           MOVE    Z03-HKNTEKKBN       TO  SPA-GMN-HKNTEKKBN-G
           MOVE    Z03-BYOKANRENKBN    TO  SPA-GMN-BYOKANRENKBN-G
           MOVE    Z03-SDOKNRYO        TO  SPA-GMN-SDOKNRYO-G
           MOVE    Z03-YKZKNRKBN       TO  SPA-GMN-YKZKNRKBN-G
           MOVE    Z03-NYUGAITEKKBN    TO  SPA-GMN-NYUGAITEKKBN-G
           MOVE    Z03-ROUTEKKBN       TO  SPA-GMN-ROUTEKKBN-G
           MOVE    Z03-HOSPSRYKBN      TO  SPA-GMN-HOSPSRYKBN-G
      *    °åÎÅ´Ñ»¡Ë¡
           MOVE    Z03-IRYOKAN         TO  SPA-GMN-IRYOKAN-G
           MOVE    Z03-OSINKBN         TO  SPA-GMN-OSINKBN-G
           MOVE    Z03-BYOSYOKBN       TO  SPA-GMN-BYOSYOKBN
           MOVE    Z03-SANTEIRRKKBN    TO  SPA-GMN-SANTEIRRKKBN-G
           MOVE    Z03-TIMEKSNKBN      TO  SPA-GMN-TIMEKSNKBN-G
           MOVE    Z03-GAIKANRIKBN     TO  SPA-GMN-GAIKANRIKBN-G
           MOVE    Z03-TSUSOKUAGE      TO  SPA-GMN-TSUSOKUAGE
           MOVE    Z03-KGNAGE          TO  SPA-GMN-KGNAGE
           MOVE    Z03-JGNAGE          TO  SPA-GMN-JGNAGE
      *H29.1  ÉÕ²Ã¾ðÊóÉÔ²Ä
      *    MOVE    Z03-SAIKETUKBN      TO  SPA-GMN-SAIKETUKBN-G
      *    MOVE    Z03-ZENKNSKBN       TO  SPA-GMN-ZENKNSKBN-G
      *    MOVE    Z03-INPCHKKBN       TO  SPA-GMN-INPCHKKBN
      *
           MOVE    Z03-JITUDAY         TO  SPA-GMN-JITUDAY
           MOVE    Z03-DAYCNT          TO  SPA-GMN-DAYCNT
           MOVE    Z03-JGNCNT          TO  SPA-GMN-JGNCNT
           MOVE    Z03-JGNCNT1D        TO  SPA-GMN-JGNCNT1D
           MOVE    Z03-JGNCNT1W        TO  SPA-GMN-JGNCNT1W
           MOVE    Z03-JGNCNTETCM      TO  SPA-GMN-JGNCNTETCM
           MOVE    Z03-JGNCNTETC       TO  SPA-GMN-JGNCNTETC 
           MOVE    Z03-JGNCNTERR       TO  SPA-GMN-JGNCNTERR
      *
      *H29.1  ÉÕ²Ã¾ðÊóÉÔ²Ä
      *    MOVE    Z03-PLUS-SANTEIRRK  TO  SPA-GMN-PLUS-SANTEIRRK-G
      *    MOVE    Z03-PLUS-JGNCNT     TO  SPA-GMN-PLUS-JGNCNT
      *    MOVE    Z03-PLUS-JGNCNT1D   TO  SPA-GMN-PLUS-JGNCNT1D
      *    MOVE    Z03-PLUS-JGNCNT1W   TO  SPA-GMN-PLUS-JGNCNT1W
      *    MOVE    Z03-PLUS-JGNCNTETCM TO  SPA-GMN-PLUS-JGNCNTETCM
      *    MOVE    Z03-PLUS-JGNCNTETC  TO  SPA-GMN-PLUS-JGNCNTETC
      *    MOVE    Z03-PLUS-JGNCNTERR  TO  SPA-GMN-PLUS-JGNCNTERR
      *
           MOVE    Z03-KZMCOMPSIKIBETU TO  SPA-GMN-KZMCOMPSIKIBETU
           MOVE    Z03-KZMKGN          TO  SPA-GMN-KZMKGN
           MOVE    Z03-KZMJGN          TO  SPA-GMN-KZMJGN
           MOVE    Z03-KZM             TO  SPA-GMN-KZM    
           MOVE    Z03-KZMTEN          TO  SPA-GMN-KZMTEN
           MOVE    Z03-KZMERR          TO  SPA-GMN-KZMERR
           MOVE    Z03-CHUKSNCD        TO  SPA-GMN-CHUKSNCD
           MOVE    Z03-CHUKSNTSUBAN    TO  SPA-GMN-CHUKSNTSUBAN
           MOVE    Z03-AGEKSNKGN1      TO  SPA-GMN-AGEKSNKGN(1)
           MOVE    Z03-AGEKSNJGN1      TO  SPA-GMN-AGEKSNJGN(1)
           MOVE    Z03-AGEKSNSRYCD1    TO  SPA-GMN-AGEKSNSRYCD(1)
           MOVE    Z03-AGEKSNKGN2      TO  SPA-GMN-AGEKSNKGN(2)
           MOVE    Z03-AGEKSNJGN2      TO  SPA-GMN-AGEKSNJGN(2)
           MOVE    Z03-AGEKSNSRYCD2    TO  SPA-GMN-AGEKSNSRYCD(2)
           MOVE    Z03-AGEKSNKGN3      TO  SPA-GMN-AGEKSNKGN(3)
           MOVE    Z03-AGEKSNJGN3      TO  SPA-GMN-AGEKSNJGN(3)
           MOVE    Z03-AGEKSNSRYCD3    TO  SPA-GMN-AGEKSNSRYCD(3)
           MOVE    Z03-AGEKSNKGN4      TO  SPA-GMN-AGEKSNKGN(4)
           MOVE    Z03-AGEKSNJGN4      TO  SPA-GMN-AGEKSNJGN(4)
           MOVE    Z03-AGEKSNSRYCD4    TO  SPA-GMN-AGEKSNSRYCD(4)
      *
      *        ÄÌÂ§²Ã»»ÂÐ¾Ý³°
           MOVE    Z03-TUSOKUGAIKBN    TO  SPA-GMN-TUSOKUGAIKBN
      *        ½èÃÖÆýÍÄ»ù²Ã»»¡Ê¥ì¡¼¥¶¡¼¾È¼Í¡Ë
           MOVE    Z03-LASERKSN        TO  SPA-GMN-LASERKSN
      *        ¶ËÄã½ÐÀ¸ÂÎ½Å»ù²Ã»»¡ÊÄ¶²»ÇÈ¥á¥¹¡Ë
           MOVE    Z03-CHPMESUKSN      TO  SPA-GMN-CHPMESUKSN
      *        ¥É¥Ê¡¼Ê¬½¸·×¶èÊ¬
           MOVE    Z03-DONORKBN        TO  SPA-GMN-DONORKBN 
      *        Æþ±¡´ðËÜÎÁ¸º»»¡Ê¥Þ¥¤¥¯¥íÇÈ¥á¥¹¡Ë
           MOVE    Z03-MICMESUKSN      TO  SPA-GMN-MICMESUKSN 
      *        ÀÔ¿ñÂ¬Äê
           MOVE    Z03-SEKIZUISOKUTEI  TO  SPA-GMN-SEKIZUISOKUTEI
      *        ðôÉô½Ñ
           MOVE    Z03-KEIBUJYUTU      TO  SPA-GMN-KEIBUJYUTU
      *        ¼«Æ°Ë¥¹ç´ï
           MOVE    Z03-AUTOHOUGO       TO  SPA-GMN-AUTOHOUGO
      *        ¼«Æ°Ê­¹ç´ï
           MOVE    Z03-AUTOFUNGO       TO  SPA-GMN-AUTOFUNGO
      *        Ä¶²»ÇÈÀÐ³¥ÁõÃÖ
           MOVE    Z03-CHPGYOKOSOTIKSN TO  SPA-GMN-CHPGYOKOSOTIKSN
      *        ¼ê½Ñµ¢Âð²Ã»»
           MOVE    Z03-SHORTSTAYOPE    TO  SPA-GMN-SHORTSTAYOPE
      *        »ÜÀß´ð½àÉÔÅ¬¹ç¶èÊ¬
           MOVE    Z03-KIJUNTEIGENKBN  TO  SPA-GMN-KIJUNTEIGENKBN
      *        ´ð½àÉÔÅ¬¹çÄþ¸ºÂÐ¾Ý»ÜÀß´ð½à¥³¡¼¥É
           MOVE    Z03-KIJUNTEIGENCD   TO  SPA-GMN-KIJUNTEIGENCD
      *H26.4
      *    £Ä£Ð£Ã¶èÊ¬
           MOVE    Z03-DPCKBN          TO  SPA-GMN-DPCKBN
      *    ÉûÉ¡¹Ð¼ê½ÑÍÑÆâ»ë¶À²Ã»»
           MOVE    Z03-FUKUBIKUNAIKBN  TO  SPA-GMN-FUKUBIKUNAIKBN
      *    ÉûÉ¡¹Ð¼ê½ÑÍÑÆð¹üÉôÁÈ¿¥ÀÚ½üµ¡´ï²Ã»»
           MOVE    Z03-FUKUBIKUKOTUKBN TO  SPA-GMN-FUKUBIKUKOTUKBN
      *    Ä¹»þ´ÖËã¿ì´ÉÍý²Ã»»
           MOVE    Z03-TIMEMASUIKBN    TO  SPA-GMN-TIMEMASUIKBN
      *
      *        ¸¡ººÅù¼Â»ÜÈ½ÃÇ
           MOVE    Z03-KNSJISKBN       TO  SPA-GMN-KNSJISKBN
      *        ¸¡ººÅù¼Â»ÜÈ½ÃÇ¥°¥ë¡¼¥×
           MOVE    Z03-KNSJISGRPKBN    TO  SPA-GMN-KNSJISGRPKBN
      *        ¸¡ÂÎ¸¡ºº¥³¥á¥ó¥È
           MOVE    Z03-KENTAICOMMENT   TO  SPA-GMN-KENTAICOMMENT
      *        Äþ¸ºÂÐ¾Ý
           MOVE    Z03-TEIGENKBN       TO  SPA-GMN-TEIGENKBN
      *        Êñ³çÄþ¸º
           MOVE    Z03-HOKATUTEIGENKBN TO  SPA-GMN-HOKATUTEIGENKBN
      *        Êñ³çÂÐ¾Ý¸¡ºº
           MOVE    Z03-HOUKNSKBN       TO  SPA-GMN-HOUKNSKBN
      *        Ä¶²»ÇÈÆâ»ë¶À
           MOVE    Z03-CHPNAISIKSN     TO  SPA-GMN-CHPNAISIKSN
      *        Æþ±¡´ðËÜÎÁ¶èÊ¬
           MOVE    Z03-NYUKHNKBN       TO  SPA-GMN-NYUKHNKBN
      *        Æþ±¡´ðËÜÎÁ²Ã»»¶èÊ¬
           MOVE    Z03-NYUKHNKSNKBN    TO  SPA-GMN-NYUKHNKSNKBN
      *        ´Ç¸î²Ã»»
           MOVE    Z03-KANGOKSN        TO  SPA-GMN-KANGOKSN
      *        ÃÏ°è²Ã»»
           MOVE    Z03-CHIIKIKSN       TO  SPA-GMN-CHIIKIKSN
      *    ²èÁüÅù¼ê½Ñ»Ù±ç²Ã»»
           MOVE    Z03-GAZOOPESUP      TO  SPA-GMN-GAZOOPESUP
      *    Ëã¿ì¼±ÊÌ
           MOVE    Z03-MASUISKBKBN     TO  SPA-GMN-MASUISKBKBN
      *H28.4
      *    Èó¿¯½±Åª·ì¹ÔÆ°ÂÖ¥â¥Ë¥¿¥ê¥ó¥°²Ã»»
           MOVE    Z03-HISINSYUMONKSN      TO  SPA-GMN-HISINSYUMONKSN
           MOVE    Z03-TOUKETUHOZONKSN     TO  SPA-GMN-TOUKETUHOZONKSN
           MOVE    Z03-KUBUNBANGOU         TO  SPA-GMN-KUBUNBANGOU
      *    Ï«ºÒ»»ÄêÉÔ²Ä
           MOVE    Z03-ROSAIKBN            TO  SPA-GMN-ROSAIKBN
           MOVE    Z03-SISIKSN             TO  SPA-GMN-SISIKSN
      *H30.4
      *    °­À­¼ðáçÉÂÍýÁÈ¿¥É¸ËÜ²Ã»»
           MOVE    Z03-AKUSEIBYORIKSN      TO  SPA-GMN-AKUSEIBYORIKSN
      *R02.4
      *    ÁÏ³°¸ÇÄê´ï²Ã»»
           MOVE    Z03-SOGAIKOTEIKSN       TO  SPA-GMN-SOGAIKOTEIKSN
      *    Ä¶²»ÇÈÀÚºï´ï²Ã»»
           MOVE    Z03-CHPSESSAKUKSN       TO  SPA-GMN-CHPSESSAKUKSN
      *    º¸¿´¼ªÊÄº¿½ÑÊ»»Ü¶èÊ¬
           MOVE    Z03-SASINJIHEISIKBN     TO  SPA-GMN-SASINJIHEISIKBN
      *
      *        »ÜÀß´ð½à¥³¡¼¥É£±¡Á£±£°
           MOVE    Z03-SSTKIJUNCD1     TO  SPA-GMN-SSTKIJUNCD(1)
           MOVE    Z03-SSTKIJUNCD2     TO  SPA-GMN-SSTKIJUNCD(2)
           MOVE    Z03-SSTKIJUNCD3     TO  SPA-GMN-SSTKIJUNCD(3)
           MOVE    Z03-SSTKIJUNCD4     TO  SPA-GMN-SSTKIJUNCD(4)
           MOVE    Z03-SSTKIJUNCD5     TO  SPA-GMN-SSTKIJUNCD(5)
           MOVE    Z03-SSTKIJUNCD6     TO  SPA-GMN-SSTKIJUNCD(6)
           MOVE    Z03-SSTKIJUNCD7     TO  SPA-GMN-SSTKIJUNCD(7)
           MOVE    Z03-SSTKIJUNCD8     TO  SPA-GMN-SSTKIJUNCD(8)
           MOVE    Z03-SSTKIJUNCD9     TO  SPA-GMN-SSTKIJUNCD(9)
           MOVE    Z03-SSTKIJUNCD10    TO  SPA-GMN-SSTKIJUNCD(10)
      *        ÅÀ¿ôÍó½¸·×Àè¼±ÊÌ¡Ê³°Íè¡Ë
           MOVE    Z03-GAITENTTLKBN    TO  SPA-GMN-GAITENTTLKBN
      *        ÅÀ¿ôÍó½¸·×Àè¼±ÊÌ¡ÊÆþ±¡¡Ë
           MOVE    Z03-NYUTENTTLSKB    TO  SPA-GMN-NYUTENTTLSKB
      *        ¸øÉ½½ç½øÈÖ¹æ
           MOVE    Z03-KOUHYOJYUNNUM   TO  SPA-GMN-KOUHYOJYUNNUM
      *        ¥³¡¼¥ÉÉ½ÍÑÈÖ¹æ
           MOVE    Z03-CDKBN-KBN       TO  SPA-GMN-CDKBN-KBN
           MOVE    Z03-CDKBN-SYO       TO  SPA-GMN-CDKBN-SYO
           MOVE    Z03-CDKBN-BU        TO  SPA-GMN-CDKBN-BU
           MOVE    Z03-CDKBN-KBNNUM    TO  SPA-GMN-CDKBN-KBNNUM
           MOVE    Z03-CDKBN-KBNNUM-EDA
                                       TO  SPA-GMN-CDKBN-KBNNUM-EDA
           MOVE    Z03-CDKBN-KOUBAN    TO  SPA-GMN-CDKBN-KOUBAN
      *        ¹ð¼¨¡¦ÄÌÃÎ´ØÏ¢ÈÖ¹æ
           MOVE    Z03-KOKUCHI-KBN     TO  SPA-GMN-KOKUCHI-KBN
           MOVE    Z03-KOKUCHI-SYO     TO  SPA-GMN-KOKUCHI-SYO
           MOVE    Z03-KOKUCHI-BU      TO  SPA-GMN-KOKUCHI-BU
           MOVE    Z03-KOKUCHI-KBNNUM  TO  SPA-GMN-KOKUCHI-KBNNUM
           MOVE    Z03-KOKUCHI-KBNNUM-EDA
                                       TO   SPA-GMN-KOKUCHI-KBNNUM-EDA
           MOVE    Z03-KOKUCHI-KOUBAN  TO  SPA-GMN-KOKUCHI-KOUBAN
      *        ¹ð¼¨Åù¼±ÊÌ¶èÊ¬
           MOVE    Z03-KOKUJISKBKBN1   TO  SPA-GMN-KOKUJISKBKBN1
           MOVE    Z03-KOKUJISKBKBN2   TO  SPA-GMN-KOKUJISKBKBN2
      *
           .
      *
       4101-GMN-SPA-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ´ðËÜ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4102-KIHON-CHK-SEC          SECTION.
      *
      *    ¹àÌÜÌ¾¥Æ¡¼¥Ö¥ë½ç¤Ë¥Á¥§¥Ã¥¯¤ò¹Ô¤¦
           PERFORM VARYING     IDX-T   FROM    1   BY  1
                   UNTIL      (IDX-T   >   TBL-GMN-MAX  )  OR
                              (SPA-ERRCD   NOT =   SPACE )
               MOVE    IDX-T               TO  CNT-CHK
               PERFORM 41021-KIHON-ALL-SEC
           END-PERFORM
           IF      SPA-ERRCD       NOT =   SPACE
               MOVE    CNT-CHK         TO  SPA-GMN-CUR
           END-IF
      *
           .
      *
       4102-KIHON-CHK-EXT.
           EXIT.
      *****************************************************************
      *  ¡¡¹àÌÜÊÌ¥¨¥é¡¼¥Á¥§¥Ã¥¯
      *****************************************************************
       41021-KIHON-ALL-SEC                            SECTION.
      *
           SET     IDX-GMN             TO  CNT-CHK
      *
           EVALUATE    TBL-WIDGET (IDX-GMN)
      *        Í­¸ú³«»ÏÇ¯·îÆü¥Á¥§¥Ã¥¯
               WHEN    "YUKOSTYMD"
                   PERFORM  501-YUKOSTYMDCHK-SEC
      *        Í­¸ú½ªÎ»Ç¯·îÆü¥Á¥§¥Ã¥¯
               WHEN    "YUKOEDYMD"
                   PERFORM  502-YUKOEDYMDCHK-SEC
      *        ¿ÇÎÅ¶èÊ¬
               WHEN    "SRYKBN"
                   PERFORM 503-SRYKBN-CHK-SEC
      *        ¿ÇÎÅ¼ïÊÌ
               WHEN    "SRYSYUKBN"
                   PERFORM 504-SRYSYUKBN-CHK-SEC
      *        ¥Ç¡¼¥¿¶èÊ¬
               WHEN    "DATAKBN"
                   PERFORM 5041-DATAKBN-CHK-SEC
      *        ¥«¥Ê»áÌ¾¥Á¥§¥Ã¥¯
               WHEN    "KANANAME"
                   PERFORM 503-KANANAME-CHK-SEC
      *        »áÌ¾¥Á¥§¥Ã¥¯
               WHEN    "NAME"
                   PERFORM 504-NAME-CHK-SEC
      *        Àµ¼°Ì¾
               WHEN    "FORMALNAME"
                   PERFORM 505-FORMALNAME-CHK-SEC
      *        ½èÊýÌ¾¾Î
               WHEN    "SHONAME"
                   PERFORM 505-SHONAME-CHK-SEC
      *        ¶â³Û
               WHEN    "TEN"
                   CONTINUE
      *        ¶â³Û¼ïÊÌ
               WHEN    "TENSIKIBETU"
                   PERFORM 505-TENSIKIBETU-CHK-SEC
      *        µì¶â³Û
               WHEN    "OLDTEN"
                   CONTINUE
      *        µì¶â³Û¼ïÊÌ
               WHEN    "OLDTENSKB"
                   PERFORM 505-OLDTENSKB-CHK-SEC
      *        Ã±°Ì¥³¡¼¥É
               WHEN   "TANICD"
                   PERFORM 5012-TANICD-CHK-SEC
      *        ÊÝ¸±Å¬ÍÑ
               WHEN    "HKNTEKKBN"
                   PERFORM 505-HKNTEKKBN-CHK-SEC
      *        ½ýÉÂÌ¾´ØÏ¢
               WHEN    "BYOKANRENKBN"
                   PERFORM 505-BYOKANRENKBN-CHK-SEC
      *        »ØÆ³´ÉÍýÎÁ
               WHEN    "SDOKNRYO"
                   PERFORM 505-SDOKNRYO-CHK-SEC
      *        °åÌôÉÊ´ØÏ¢
               WHEN    "YKZKNRKBN"
                   PERFORM 505-YKZKNRKBN-CHK-SEC
      *        Æþ³°Å¬ÍÑ
               WHEN    "NYUGAITEKKBN"
                   PERFORM 505-NYUGAITEKKBN-CHK-SEC
      *        Ï·¿ÍÅ¬ÍÑ
               WHEN    "ROUTEKKBN"
                   PERFORM 505-ROUTEKKBN-CHK-SEC
      *        ÉÂ±¡¿ÇÎÅ½ê
               WHEN    "HOSPSRYKBN"
                   PERFORM 505-HOSPSRYKBN-CHK-SEC
      *        °åÎÅ´Ñ»¡Ë¡ÂÐ¾Ý
               WHEN    "IRYOKAN"
                   PERFORM 505-IRYOKAN-CHK-SEC
      *        £Ä£Ð£Ã¶èÊ¬
               WHEN    "DPCKBN"
                   CONTINUE
      *        ±ý¿Ç
               WHEN    "OSINKBN"
                   PERFORM 505-OSINKBN-CHK-SEC
      *        ÉÂ¾²¿ô
               WHEN    "BYOSYOKBN"
                   CONTINUE
      *        »»ÄêÍúÎò
               WHEN    "SANTEIRRKKBN"
                   PERFORM 505-SANTEIRRKKBN-CHK-SEC
      *        »þ´Ö²Ã»»
               WHEN    "TIMEKSNKBN"
                   PERFORM 505-TIMEKSNKBN-CHK-SEC
      *        ³°Íè´ÉÍý²Ã»»
               WHEN    "GAIKANRIKBN"
                   PERFORM 505-GAIKANRIKBN-CHK-SEC
      *        ÄÌÂ§Ç¯Îð
               WHEN    "TSUSOKUAGE"
                   PERFORM 505-TSUSOKUAGE-CHK-SEC
      *        ²¼¸ÂÇ¯Îð
               WHEN    "KGNAGE"
                   PERFORM 5026-KGNAGE-CHK-SEC
      *        ¾å¸ÂÇ¯Îð
               WHEN    "JGNAGE"
                   PERFORM 5027-JGNAGE-CHK-SEC
      *        ºÎ·ìÎÁ¶èÊ¬
               WHEN    "SAIKETUKBN"
                   PERFORM 5030-SAIKETUKBN-CHK-SEC
      *        Á°²ó¸¡ººÆü¶èÊ¬
               WHEN    "ZENKNSKBN"
                   PERFORM 5030-ZENKNSKBN-CHK-SEC
      *        ÆþÎÏ¥Á¥§¥Ã¥¯¶èÊ¬
               WHEN    "INPCHKKBN"
                   CONTINUE
      *
      *        ¼ÂÆü¿ô
               WHEN    "JITUDAY"
      *        Æü¿ô¡¦²ó¿ô
               WHEN    "DAYCNT"
      *        ¾å¸Â²ó¿ô·î
               WHEN    "JGNCNT"
      *        ¾å¸Â²ó¿ôÆü
               WHEN    "JGNCNT1D"
      *        ¾å¸Â²ó¿ô½µ
               WHEN    "JGNCNT1W"
      *        Â¾·î¿ô
               WHEN    "JGNCNTETCM"
      *        Â¾
               WHEN    "JGNCNTETC"
      *        ¾å¸Â¥¨¥é¡¼½èÍý
               WHEN    "JGNCNTERR"
                   CONTINUE
      *        ¥æ¡¼¥¶ÀßÄê»»ÄêÍúÎò
               WHEN    "PLUS_SANTEIRRK"
                   PERFORM 5030-PLUS-SANTEIRRK-SEC
      *        ¥æ¡¼¥¶ÀßÄê ¾å¸Â²ó¿ô
               WHEN    "PLUS_JGNCNT"
               WHEN    "PLUS_JGNCNT1D"
               WHEN    "PLUS_JGNCNT1W"
               WHEN    "PLUS_JGNCNTETCM"
               WHEN    "PLUS_JGNCNTETC"
                   CONTINUE
      *        ¥æ¡¼¥¶ÀßÄê¥¨¥é¡¼½èÍý
               WHEN    "PLUS_JGNCNTERR"
                   PERFORM 5030-JGNCNTERR-CHK-SEC
      *        ¤­¤¶¤ßÃÍ¼±ÊÌ
               WHEN    "KZMCOMPSIKIBETU"
      *        ¤­¤¶¤ßÃÍ²¼¸ÂÃÍ
               WHEN    "KZMKGN"
      *        ¤­¤¶¤ßÃÍ¾å¸ÂÃÍ
               WHEN    "KZMJGN"
      *        ¤­¤¶¤ßÃÍ
               WHEN    "KZM"
      *        ¤­¤¶¤ßÃÍ¤­¤¶¤ßÅÀ¿ô
               WHEN    "KZMTEN"
      *        ¤­¤¶¤ßÃÍ¥¨¥é¡¼½èÍý
               WHEN    "KZMERR"
                   CONTINUE
      *        Ãí²Ã»»¥³¡¼¥É
               WHEN    "CHUKSNCD"
                   PERFORM 5042-CHUKSNCD-CHK-SEC
      *        Ãí²Ã»»ÄÌÈÖ
               WHEN    "CHUKSNTSUBAN"
                   IF    SPA-GMN-CHUKSNTSUBAN  =   SPACE
                       MOVE    ZERO            TO  SPA-GMN-CHUKSNTSUBAN
                   END-IF
                   IF  (SPA-GMN-CHUKSNTSUBAN   >= "0" AND <= "9")  OR
                       (SPA-GMN-CHUKSNTSUBAN   >= "A" AND <= "Z")
                       CONTINUE
                   ELSE
                       MOVE    "0003"                TO  SPA-ERRCD
                   END-IF
      *        Ç¯Îð²Ã»»
               WHEN    "AGEKSNKGN1"
                   MOVE    SPA-GMN-AGEKSNKGN(1)  TO  WRK-AGEKSNKGN
                   PERFORM 5044-AGEKSNKGN-CHK-SEC
                   MOVE    WRK-AGEKSNKGN     TO  SPA-GMN-AGEKSNKGN(1)
               WHEN    "AGEKSNJGN1"
                   MOVE    SPA-GMN-AGEKSNJGN(1)  TO  WRK-AGEKSNJGN
                   PERFORM 5045-AGEKSNJGN-CHK-SEC
                   MOVE    WRK-AGEKSNJGN     TO  SPA-GMN-AGEKSNJGN(1)
               WHEN    "AGEKSNSRYCD1"
                   CONTINUE
               WHEN    "AGEKSNKGN2"
                   MOVE    SPA-GMN-AGEKSNKGN(2)  TO  WRK-AGEKSNKGN
                   PERFORM 5044-AGEKSNKGN-CHK-SEC
                   MOVE    WRK-AGEKSNKGN     TO  SPA-GMN-AGEKSNKGN(2)
               WHEN    "AGEKSNJGN2"
                   MOVE    SPA-GMN-AGEKSNJGN(2)  TO  WRK-AGEKSNJGN
                   PERFORM 5045-AGEKSNJGN-CHK-SEC
                   MOVE    WRK-AGEKSNJGN     TO  SPA-GMN-AGEKSNJGN(2)
               WHEN    "AGEKSNSRYCD2"
                   CONTINUE
               WHEN    "AGEKSNKGN3"
                   MOVE    SPA-GMN-AGEKSNKGN(3)  TO  WRK-AGEKSNKGN
                   PERFORM 5044-AGEKSNKGN-CHK-SEC
                   MOVE    WRK-AGEKSNKGN     TO  SPA-GMN-AGEKSNKGN(3)
               WHEN    "AGEKSNJGN3"
                   MOVE    SPA-GMN-AGEKSNJGN(3)  TO  WRK-AGEKSNJGN
                   PERFORM 5045-AGEKSNJGN-CHK-SEC
                   MOVE    WRK-AGEKSNJGN     TO  SPA-GMN-AGEKSNJGN(3)
               WHEN    "AGEKSNSRYCD3"
                   CONTINUE
               WHEN    "AGEKSNKGN4"
                   MOVE    SPA-GMN-AGEKSNKGN(4)  TO  WRK-AGEKSNKGN
                   PERFORM 5044-AGEKSNKGN-CHK-SEC
                   MOVE    WRK-AGEKSNKGN     TO  SPA-GMN-AGEKSNKGN(4)
               WHEN    "AGEKSNJGN4"
                   MOVE    SPA-GMN-AGEKSNJGN(4)  TO  WRK-AGEKSNJGN
                   PERFORM 5045-AGEKSNJGN-CHK-SEC
                   MOVE    WRK-AGEKSNJGN     TO  SPA-GMN-AGEKSNJGN(4)
               WHEN    "AGEKSNSRYCD4"
                   CONTINUE
      *
      *        ÄÌÂ§²Ã»»ÂÐ¾Ý³°
               WHEN    "TUSOKUGAIKBN"
      *        ¥ì¡¼¥¶¡¼¾È¼Í
               WHEN    "LASERKSN"
      *        Ä¶²»ÇÈ¥á¥¹
               WHEN    "CHPMESUKSN"
      *        ¥É¥Ê¡¼Ê¬½¸·×¶èÊ¬
               WHEN    "MICMESUKSN"
      *        ¥Þ¥¤¥¯¥íÇÈ¥á¥¹
               WHEN    "DONORKBN"
      *        ÀÔ¿ñÂ¬Äê
               WHEN    "SEKIZUISOKUTEI"
      *        ðôÉô½Ñ
               WHEN    "KEIBUJYUTU6"
      *        ¼«Æ°Ë¥¹ç´ï
               WHEN    "AUTOHOUGO"
      *        ¼«Æ°Ê­¹ç´ï
               WHEN    "AUTOFUNGO"
      *        Ä¶²»ÇÈÀÐ³¥ÁõÃÖ
               WHEN    "CHPGYOKOSOTIKSN"
      *        ¼ê½Ñµ¢Âð²Ã»»
               WHEN    "SHORTSTAYOPE"
      *        »ÜÀß´ð½àÉÔÅ¬¹ç¶èÊ¬
               WHEN    "KIJUNTEIGENKBN"
      *        ´ð½àÉÔÅ¬¹çÄþ¸ºÂÐ¾Ý»ÜÀß´ð½à¥³¡¼¥É
               WHEN    "KIJUNTEIGENCD"
      *        ÉûÉ¡¹Ð¼ê½ÑÍÑÆâ»ë¶À²Ã»»
               WHEN    "FUKUBIKUNAIKBN"
      *        ÉûÉ¡¹Ð¼ê½ÑÍÑÀÚ½üµ¡´ï²Ã»»
               WHEN    "FUKUBIKUKOTUKBN"
      *        Ä¹»þ´ÖËã¿ì´ÉÍý²Ã»»
               WHEN    "TIMEMASUIKBN"
      *        ¸¡ººÅù¼Â»ÜÈ½ÃÇ
               WHEN    "KNSJISKBN"
      *        ¸¡ººÅù¼Â»ÜÈ½ÃÇ¥°¥ë¡¼¥×
               WHEN    "KNSJISGRPKBN"
      *        ¸¡ÂÎ¸¡ºº¥³¥á¥ó¥È
               WHEN    "KENTAICOMMENT"
      *        Äþ¸ºÂÐ¾Ý
               WHEN    "TEIGENKBN"
      *        Êñ³çÄþ¸º
               WHEN    "HOKATUTEIGENKBN"
      *        Êñ³çÂÐ¾Ý¸¡ºº
               WHEN    "HOUKNSKBN"
      *        Ä¶²»ÇÈÆâ»ë¶À
               WHEN    "CHPNAISIKSN"
      *        Æþ±¡´ðËÜÎÁ¶èÊ¬
               WHEN    "NYUKHNKBN"
      *        Æþ±¡´ðËÜÎÁ²Ã»»¶èÊ¬
               WHEN    "NYUKHNKSNKBN"
      *        ´Ç¸î²Ã»»
               WHEN    "KANGOKSN"
      *        ÃÏ°è²Ã»»
               WHEN    "CHIIKIKSN"
      *        ²èÁüÅù¼ê½Ñ»Ù±ç²Ã»»
               WHEN    "GAZOOPESUP"
      *        Ëã¿ì¼±ÊÌ¶èÊ¬
               WHEN    "MASUISKBKBN"
      *
      *        »ÜÀß´ð½à¥³¡¼¥É£±¡Á£±£°
               WHEN    "SSTKIJUNCD1"
               WHEN    "SSTKIJUNCD2"
               WHEN    "SSTKIJUNCD3"
               WHEN    "SSTKIJUNCD4"
               WHEN    "SSTKIJUNCD5"
               WHEN    "SSTKIJUNCD6"
               WHEN    "SSTKIJUNCD7"
               WHEN    "SSTKIJUNCD6"
               WHEN    "SSTKIJUNCD9"
               WHEN    "SSTKIJUNCD10"
      *        ÅÀ¿ôÍó½¸·×Àè¼±ÊÌ¡Ê³°Íè¡Ë
               WHEN    "GAITENTTLKBN"
      *        ÅÀ¿ôÍó½¸·×Àè¼±ÊÌ¡ÊÆþ±¡¡Ë
               WHEN    "NYUTENTTLSKB"
      *        ¸øÉ½½ç½øÈÖ¹æ
               WHEN    "KOUHYOJYUNNUM"
      *        ¥³¡¼¥ÉÉ½ÍÑÈÖ¹æ
               WHEN    "CDKBN-KBN"
               WHEN    "CDKBN-SYO"
               WHEN    "CDKBN-BU"
               WHEN    "CDKBN-KBNNUM"
               WHEN    "CDKBN-KBNNUM-EDA"
               WHEN    "CDKBN-KOUBAN"
      *        ¹ð¼¨¡¦ÄÌÃÎ´ØÏ¢ÈÖ¹æ
               WHEN    "KOKUCHI-KBN "
               WHEN    "KOKUCHI-SYO"
               WHEN    "KOKUCHI-BU"
               WHEN    "KOKUCHI-KBNNUM"
               WHEN    "KOKUCHI-KBNNUM-EDA"
               WHEN    "KOKUCHI-KOUBAN"
      *        ¹ð¼¨Åù¼±ÊÌ¶èÊ¬
               WHEN    "KOKUJISKBKBN1"
               WHEN    "KOKUJISKBKBN2"
                   CONTINUE
           END-EVALUATE.
      *
           .    
      *
       41021-KIHON-ALL-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡Í­¸ú³«»ÏÇ¯·îÆü¥Á¥§¥Ã¥¯
      *****************************************************************
       501-YUKOSTYMDCHK-SEC            SECTION.
      *
           IF      SPA-GMN-YUKOSTYMD   =   SPACE
               MOVE    "0000000"           TO  SPA-GMN-YUKOSTYMD
           END-IF
      *
           MOVE    SPA-GMN-YUKOSTYMD   TO  WRK-LNKYMD
           PERFORM 831-YMDCONV12-SEC
           IF      FLG-ERR             =   ZERO
               MOVE    WRK-SYMD            TO  SPA-NAI-YUKOSTYMD
               MOVE    WRK-LNKYMD          TO  SPA-GMN-YUKOSTYMD
           ELSE
               MOVE    "0001"              TO  SPA-ERRCD
               GO      TO      501-YUKOSTYMDCHK-EXT
           END-IF
      *
           .
      *
       501-YUKOSTYMDCHK-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡Í­¸ú½ªÎ»Ç¯·îÆü¥Á¥§¥Ã¥¯
      *****************************************************************
       502-YUKOEDYMDCHK-SEC                      SECTION.
      *
           IF      SPA-GMN-YUKOEDYMD   =   SPACE
               MOVE    "9999999"           TO  SPA-GMN-YUKOEDYMD
           END-IF
      *
           MOVE    SPA-GMN-YUKOEDYMD   TO  WRK-LNKYMD
           PERFORM 831-YMDCONV12-SEC
           IF      FLG-ERR             =   ZERO
               MOVE    WRK-SYMD            TO  SPA-NAI-YUKOEDYMD
               MOVE    WRK-LNKYMD          TO  SPA-GMN-YUKOEDYMD
           ELSE
               MOVE    "0002"              TO  SPA-ERRCD
               GO      TO      502-YUKOEDYMDCHK-EXT
           END-IF
      *
           .
      *
       502-YUKOEDYMDCHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥«¥ÊÌ¾¾Î¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       503-KANANAME-CHK-SEC          SECTION.
      *
           MOVE    SPA-GMN-KANANAME    TO  WRK-MAE-INPUT
           MOVE    100                 TO  WRK-LEN
           PERFORM 400-ZENCHK-SEC
           MOVE    WRK-OUT-INPUT       TO  SPA-GMN-KANANAME
           IF      FLG-ERR             =   ZERO
               MOVE    WRK-OUT-INPUT       TO  SPA-GMN-KANANAME
           ELSE
               MOVE    "0003"              TO  SPA-ERRCD
           END-IF
           .
      *
       503-KANANAME-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ´Á»úÌ¾¾Î¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       504-NAME-CHK-SEC          SECTION.
      *
           MOVE    SPA-GMN-NAME        TO  WRK-MAE-INPUT
           MOVE    100                 TO  WRK-LEN
           PERFORM 400-ZENCHK-SEC
           MOVE    WRK-OUT-INPUT       TO  SPA-GMN-NAME
           IF      FLG-ERR             =   ZERO
               MOVE    WRK-OUT-INPUT       TO  SPA-GMN-NAME
           ELSE
               MOVE    "0004"              TO  SPA-ERRCD
           END-IF
           .
      *
       504-NAME-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÄÌ¾ÎÌ¾¾Î¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       505-FORMALNAME-CHK-SEC          SECTION.
      *
           MOVE    SPA-GMN-FORMALNAME  TO  WRK-MAE-INPUT
           MOVE    200                 TO  WRK-LEN
           PERFORM 400-ZENCHK-SEC
           MOVE    WRK-OUT-INPUT       TO  SPA-GMN-FORMALNAME
           IF      FLG-ERR             =   ZERO
               MOVE    WRK-OUT-INPUT       TO  SPA-GMN-FORMALNAME
           ELSE
               MOVE    "0005"              TO  SPA-ERRCD
           END-IF
           .
      *
       505-FORMALNAME-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½èÊýÌ¾¾Î¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       505-SHONAME-CHK-SEC          SECTION.
      *
           MOVE    SPA-GMN-SHONAME     TO  WRK-MAE-INPUT
           MOVE    100                 TO  WRK-LEN
           PERFORM 410-ZENCHK-HEN-SEC
           MOVE    WRK-OUT-INPUT       TO  SPA-GMN-SHONAME
           IF      FLG-ERR             =   ZERO
               MOVE    WRK-OUT-INPUT       TO  SPA-GMN-SHONAME
           ELSE
               MOVE    "0010"              TO  SPA-ERRCD
           END-IF
           .
      *
       505-SHONAME-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    È¾³Ñ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       400-ZENCHK-SEC             SECTION.
      *
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "1"                 TO  KANACHK-SYORI
           MOVE    WRK-MAE-INPUT       TO  KANACHK-MAE-INPUT
           MOVE    WRK-LEN             TO  KANACHK-MAX-CNT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           IF     (KANACHK-RC      NOT =   ZERO  )  OR
                  (KANACHK-SYUBETU     =   1     )
      *        Á´³ÑÈ¾³Ñº®ºß¥¨¥é¡¼
               MOVE    KANACHK-MAE-INPUT   TO  WRK-OUT-INPUT 
               MOVE    1                   TO  FLG-ERR
           ELSE
               MOVE    KANACHK-OUT-INPUT   TO  WRK-OUT-INPUT 
               MOVE    ZERO                TO  FLG-ERR
           END-IF
           .
      *
       400-ZENCHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    È¾³ÑÊÑ´¹¡Ê¥Á¥§¥Ã¥¯¡Ë½èÍý
      *****************************************************************
       410-ZENCHK-HEN-SEC             SECTION.
      *
           INITIALIZE                  ORCSKANACHKAREA
           MOVE    "2"                 TO  KANACHK-SYORI
           MOVE    WRK-MAE-INPUT       TO  KANACHK-MAE-INPUT
           MOVE    WRK-LEN             TO  KANACHK-MAX-CNT
           CALL    "ORCSKANACHK"       USING
                                       ORCSKANACHKAREA
           IF     (KANACHK-RC      NOT =   ZERO  )
               MOVE    1                   TO  FLG-ERR
               MOVE    KANACHK-MAE-INPUT   TO  WRK-OUT-INPUT 
           ELSE
               MOVE    ZERO                TO  FLG-ERR
               MOVE    KANACHK-OUT-INPUT   TO  WRK-OUT-INPUT 
           END-IF
           .
       410-ZENCHK-HEN-EXT.
           EXIT.
      *****************************************************************
      *  ¡¡¿ÇÎÅ¶èÊ¬¥Á¥§¥Ã¥¯
      *****************************************************************
       503-SRYKBN-CHK-SEC                      SECTION.
      *
           IF     (SPA-Z01-SRYCD (1:1) NOT =   "1" )  AND
                  (SPA-GMN-SRYKBN          =   SPACE)
               GO      TO  503-SRYKBN-CHK-EXT
           END-IF
      *
           SET     MSYU-IDX            TO  1
           SEARCH      MSYU-TBL-OCC    VARYING   MSYU-IDX
                   AT  END
                       MOVE    1               TO  FLG-ERR
                   WHEN    SPA-GMN-SRYKBN      =   MSYU-SRYKBN
                                                           (MSYU-IDX)
                       MOVE    ZERO            TO  FLG-ERR
           END-SEARCH
      *
      *    Æþ±¡¤Î¥Á¥§¥Ã¥¯
           IF      SPA-GMN-SRYKBN      =   "90"
               MOVE    ZERO            TO  FLG-ERR
           END-IF
      *
           IF      FLG-ERR             =   1
               MOVE    "0011"          TO  SPA-ERRCD
            END-IF
      *
           .
      *
       503-SRYKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡¿ÇÎÅ¼ïÊÌ¥Á¥§¥Ã¥¯
      *****************************************************************
       504-SRYSYUKBN-CHK-SEC                      SECTION.
      *
      *
           IF     (SPA-Z01-SRYCD (1:1) NOT =   "1" )  AND
                  (SPA-GMN-SRYSYUKBN       =   SPACE)
               GO      TO  504-SRYSYUKBN-CHK-EXT
           END-IF
      *
           SET     MSYU-IDX            TO  1
           SEARCH      MSYU-TBL-OCC    VARYING   MSYU-IDX
                   AT  END
                       MOVE    "0012"              TO  SPA-ERRCD
                       MOVE    SPACE               TO  WRK-SRYKBN
                   WHEN    SPA-GMN-SRYSYUKBN   =   MSYU-SRYSYUKBN 
                                                           (MSYU-IDX)
                       MOVE    MSYU-SRYKBN (MSYU-IDX)    TO  WRK-SRYKBN
           END-SEARCH
      *
      *    Æþ±¡¤Î¥Á¥§¥Ã¥¯
           IF      WRK-SRYKBN          =   SPACE
               IF      SPA-GMN-SRYSYUKBN   =   "900"
                   MOVE    "90"                TO  WRK-SRYKBN
                   MOVE    SPACE               TO  SPA-ERRCD
               END-IF
           END-IF
      *
           IF      WRK-SRYKBN      NOT =   SPACE
               IF      WRK-SRYKBN      NOT =   SPA-GMN-SRYKBN
                   MOVE    WRK-SRYKBN          TO  SPA-GMN-SRYKBN
                   PERFORM VARYING     IDX     FROM    1   BY  1
                           UNTIL       IDX     >   SPA-SRYKBN-MAX
                       IF      SPA-GMN-SRYKBN  =   SPA-GMN-SRYKBN-L(IDX)
                           MOVE    SPA-GMN-SRYKBNCOB (IDX)
                                                   TO  SPA-GMN-SRYKBN-G
                           MOVE    SPA-SRYKBN-MAX  TO  IDX
                       END-IF
                   END-PERFORM
               END-IF
           END-IF
           .
      *
       504-SRYSYUKBN-CHK-EXT.
           EXIT.
      *        
      *****************************************************************
      *  ¡¡¥Ç¡¼¥¿¶èÊ¬¥Á¥§¥Ã¥¯
      *****************************************************************
       5041-DATAKBN-CHK-SEC            SECTION.
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-DATAKBN-MAX
               IF      SPA-GMN-DATAKBN     =   SPA-GMN-DATAKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-DATAKBNCOB (IDX)
                                               TO  SPA-GMN-DATAKBN-G
                   MOVE    SPA-DATAKBN-MAX     TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
               GO      TO      5041-DATAKBN-CHK-EXT
           END-IF
      *
      *    »þ´Ö³°
           MOVE    SPACE               TO  SPA-GMN-TIMEKSNKBNCOB-G
           MOVE    ZERO                TO  SPA-TIMEKSNKBN-MAX
           IF      SPA-GMN-DATAKBN     =   1  OR  ZERO
               MOVE    "0 »þ´Ö³°»»ÄêÉÔ²Ä"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (1)
               MOVE    "1 »þ´Ö³°»»Äê²ÄÇ½"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (2)
      ****     MOVE    "2 ½é¿ÇÎÁ¤ÎµÙÆü¤Ë·¸¤ë"
               MOVE    "3 ½é¿ÇÎÁ¤ÎµÙÆü¤Ë·¸¤ë"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (3)
               MOVE    3                 TO  SPA-TIMEKSNKBN-MAX
           END-IF
           IF     (SPA-GMN-DATAKBN        =   2  )
      *H29.5
      *        ¼êµ»ÎÁ¤Ç»þ´Ö¶èÊ¬¤¬»þ´Ö³°¶èÊ¬¤Ç¤¢¤ë»þ
           OR    ((SPA-GMN-DATAKBN        =   1   )  AND
                  (SPA-GMN-KOKUJISKBKBN2  =   "7" )  AND
                  (SPA-GMN-TIMEKSNKBN     <>  "0" )  AND
                  (SPA-GMN-SRYKBN         =   "11"
                                          OR  "12"
                                          OR  "13"
                                          OR  "14" ))
               MOVE    "0 ²¼µ­°Ê³°¤Î¿ÇÎÅ¹Ô°Ù"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (1)
               MOVE    "1 »þ´Ö³°²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (2)
               MOVE    "2 µÙÆü²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (3)
               MOVE    "3 ½é¿ÇÎÁ¤ÎµÙÆü²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (4)
               MOVE    "4 ¿¼Ìë²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (5)
               MOVE    "5 »þ´Ö³°ÆÃÄê²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (6)
               MOVE    "6 Ìë´Ö¡¦ÁáÄ«²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (7)
               MOVE    "7 Ìë´Ö²Ã»»"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (8)
               MOVE    "8 »þ´Ö³°Åù²Ã»»¡Ê100ÅÀ°Ê¾å¡Ë"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (9)
               MOVE    "9 µÙÆü²Ã»»¡Ê100ÅÀ°Ê¾å¡Ë"
                                         TO  SPA-GMN-TIMEKSNKBNCOB (10)
               MOVE    10                TO  SPA-TIMEKSNKBN-MAX
           END-IF
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-TIMEKSNKBN-MAX
               IF      SPA-GMN-TIMEKSNKBN  =   SPA-GMN-TIMEKSNKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-TIMEKSNKBNCOB (IDX)
                                           TO  SPA-GMN-TIMEKSNKBN-G
                   MOVE    SPA-TIMEKSNKBN-MAX  TO  IDX
               END-IF
           END-PERFORM
           .
      *
       5041-DATAKBN-CHK-EXT.
           EXIT.
      *        
      *****************************************************************
      *  ¡¡¶â³Û¼ïÊÌ¥Á¥§¥Ã¥¯
      *****************************************************************
       505-TENSIKIBETU-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-TENSIKI-MAX
               IF      SPA-GMN-TENSIKIBETU =   SPA-GMN-TENSIKIBETUCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-TENSIKIBETUCOB (IDX)
                                               TO  SPA-GMN-TENSIKIBETU-G
                   MOVE    1                   TO  FLG-OK
                   MOVE    SPA-TENSIKI-MAX     TO  IDX
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
               GO      TO      505-TENSIKIBETU-CHK-EXT
           END-IF
           .
      *
       505-TENSIKIBETU-CHK-EXT.
           EXIT.
      *        
      *****************************************************************
      *  ¡¡µì¶â³Û¼ïÊÌ¥Á¥§¥Ã¥¯
      *****************************************************************
       505-OLDTENSKB-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-OLDTENSKB-MAX
               IF      SPA-GMN-OLDTENSKB =   SPA-GMN-OLDTENSKBCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-OLDTENSKBCOB (IDX)
                                               TO  SPA-GMN-OLDTENSKB-G
                   MOVE    SPA-OLDTENSKB-MAX   TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
               GO      TO      505-OLDTENSKB-CHK-EXT
           END-IF
           .
      *
       505-OLDTENSKB-CHK-EXT.
           EXIT.
      *        
      *****************************************************************
      *  ¡¡Ã±°Ì¥³¡¼¥É¥Á¥§¥Ã¥¯
      *****************************************************************
       5012-TANICD-CHK-SEC             SECTION.
      *
      *
           IF      SPA-GMN-TANICD      =   SPACE
               MOVE    ZERO            TO  SPA-GMN-TANICD
           END-IF
      *
           INITIALIZE                      ORCSNUMAREA
           MOVE    SPA-GMN-TANICD      TO  SNUM-INX
           CALL    "ORCSNUM"           USING
                                       ORCSNUMAREA
           IF     (SNUM-RC         NOT =   ZERO  )   OR
                  (SNUM-MINKBN     NOT =   SPACE )   OR
                  (SNUM-SYOKBN     NOT =   SPACE )
               MOVE    "0007"                  TO  SPA-ERRCD
           ELSE
               MOVE    SNUM-OUTEDT(13:3)       TO  SPA-GMN-TANICD
           END-IF
      *
           IF      SPA-GMN-TANICD      =   ZERO
               MOVE    SPACE               TO  SPA-GMN-TANINAME
               GO      TO              5012-TANICD-CHK-EXT
           END-IF
      *
           SET     MTANI-IDX           TO  1
           SEARCH      MTANI-TBL-OCC    VARYING   MTANI-IDX
                   AT  END
                       MOVE    "0013"              TO  SPA-ERRCD
                       MOVE    SPACE               TO  SPA-GMN-TANINAME
                   WHEN    SPA-GMN-TANICD      =   MTANI-TANICD 
                                                           (MTANI-IDX)
                       MOVE    MTANI-TANINAME (MTANI-IDX)
                                               TO  SPA-GMN-TANINAME
           END-SEARCH
           .
      *
       5012-TANICD-CHK-EXT.
           EXIT.
      *        
      *****************************************************************
      *  ¡¡ÊÝ¸±Å¬ÍÑ¥Á¥§¥Ã¥¯
      *****************************************************************
       505-HKNTEKKBN-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-HKNTEKKBN-MAX
               IF      SPA-GMN-HKNTEKKBN   =   SPA-GMN-HKNTEKKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-HKNTEKKBNCOB (IDX)
                                               TO  SPA-GMN-HKNTEKKBN-G
                   MOVE    1                   TO  FLG-OK
                   MOVE    SPA-HKNTEKKBN-MAX   TO  IDX
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
           .
       505-HKNTEKKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡½ýÉÂÌ¾´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       505-BYOKANRENKBN-CHK-SEC         SECTION.
      *
      *ver.4.7
      *    Í½Ìó¥³¡¼¥É¤Î¤ß½é´üÉ½¼¨
           IF      SPA-Z01-SRYCD(1:3)  =   "099"
               IF      SPA-GMN-BYOKANRENKBN    =   SPACE
                   MOVE    "00"            TO  SPA-GMN-BYOKANRENKBN
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-BYOKANRENKBN-MAX
               IF      SPA-GMN-BYOKANRENKBN  =   SPA-GMN-BYOKANRENKBNCOB
                                                         (IDX)(1:2)
                   MOVE    SPA-GMN-BYOKANRENKBNCOB (IDX)
                                           TO  SPA-GMN-BYOKANRENKBN-G
                   MOVE    1                       TO  FLG-OK
                   MOVE    SPA-BYOKANRENKBN-MAX    TO  IDX
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
           .
      *
       505-BYOKANRENKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡»ØÆ³´ÉÍýÎÁ´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       505-SDOKNRYO-CHK-SEC         SECTION.
      *ver.4.7
      *    Í½Ìó¥³¡¼¥É¤Î¤ß½é´üÉ½¼¨
           IF      SPA-Z01-SRYCD(1:3)  =   "099"
               IF      SPA-GMN-SDOKNRYO    =   SPACE
                   MOVE    ZERO            TO  SPA-GMN-SDOKNRYO
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SDOKNRYO-MAX
               IF      SPA-GMN-SDOKNRYO    =   SPA-GMN-SDOKNRYOCOB
                                                         (IDX)(1:3)
                   MOVE    SPA-GMN-SDOKNRYOCOB (IDX)
                                               TO  SPA-GMN-SDOKNRYO-G
                   MOVE    SPA-SDOKNRYO-MAX    TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
           .
      *
       505-SDOKNRYO-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡°åÌôÉÊ´ØÏ¢¥Á¥§¥Ã¥¯
      *****************************************************************
       505-YKZKNRKBN-CHK-SEC         SECTION.
      *
      *ver.4.7
      *    Í½Ìó¥³¡¼¥É¤Î¤ß½é´üÉ½¼¨
           IF      SPA-Z01-SRYCD(1:3)  =   "099"
               IF      SPA-GMN-YKZKNRKBN   =   SPACE
                   MOVE    "0"             TO  SPA-GMN-YKZKNRKBN
               END-IF
           END-IF
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-YKZKNRKBN-MAX
               IF      SPA-GMN-YKZKNRKBN   =   SPA-GMN-YKZKNRKBNCOB
                                                         (IDX)(1:2)
                   MOVE    SPA-GMN-YKZKNRKBNCOB (IDX)
                                               TO  SPA-GMN-YKZKNRKBN-G
                   MOVE    SPA-YKZKNRKBN-MAX   TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
           .
      *
       505-YKZKNRKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡Æþ³°Å¬ÍÑ¥Á¥§¥Ã¥¯
      *****************************************************************
       505-NYUGAITEKKBN-CHK-SEC         SECTION.
      *ver.4.7
      *    Í½Ìó¥³¡¼¥É¤Î¤ß½é´üÉ½¼¨
           IF      SPA-Z01-SRYCD(1:3)  =   "099"
               IF      SPA-GMN-NYUGAITEKKBN    =   SPACE
                   MOVE    "0"             TO  SPA-GMN-NYUGAITEKKBN
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-NYUGAITEKKBN-MAX
               IF      SPA-GMN-NYUGAITEKKBN
                                           =   SPA-GMN-NYUGAITEKKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-NYUGAITEKKBNCOB (IDX)
                                           TO  SPA-GMN-NYUGAITEKKBN-G
                   MOVE    SPA-NYUGAITEKKBN-MAX    TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
           .
      *
       505-NYUGAITEKKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡Ï·¿ÍÅ¬ÍÑ¥Á¥§¥Ã¥¯
      *****************************************************************
       505-ROUTEKKBN-CHK-SEC         SECTION.
      *
      *ver.4.7
      *    Í½Ìó¥³¡¼¥É¤Î¤ß½é´üÉ½¼¨
           IF      SPA-Z01-SRYCD(1:3)  =   "099"
               IF      SPA-GMN-ROUTEKKBN   =   SPACE
                   MOVE    "0"             TO  SPA-GMN-ROUTEKKBN
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-ROUTEKKBN-MAX
               IF      SPA-GMN-ROUTEKKBN   =   SPA-GMN-ROUTEKKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-ROUTEKKBNCOB (IDX)
                                               TO  SPA-GMN-ROUTEKKBN-G
                   MOVE    SPA-ROUTEKKBN-MAX   TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
           .
      *
       505-ROUTEKKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡ÉÂ±¡¿ÇÎÅ½ê¥Á¥§¥Ã¥¯
      *****************************************************************
       505-HOSPSRYKBN-CHK-SEC         SECTION.
      *ver.4.7
      *    Í½Ìó¥³¡¼¥É¤Î¤ß½é´üÉ½¼¨
           IF      SPA-Z01-SRYCD(1:3)  =   "099"
               IF      SPA-GMN-HOSPSRYKBN  =   SPACE
                   MOVE    "0"             TO  SPA-GMN-HOSPSRYKBN
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-HOSPSRYKBN-MAX
               IF      SPA-GMN-HOSPSRYKBN  =   SPA-GMN-HOSPSRYKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-HOSPSRYKBNCOB (IDX)
                                           TO  SPA-GMN-HOSPSRYKBN-G
                   MOVE    SPA-HOSPSRYKBN-MAX  TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
           .
      *
       505-HOSPSRYKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *  ¡¡°åÎÅ´Ñ»¡Ë¡ÂÐ¾Ý¥Á¥§¥Ã¥¯
      *****************************************************************
       505-IRYOKAN-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-IRYOKAN-MAX
               IF      SPA-GMN-IRYOKAN     =   SPA-GMN-IRYOKANCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-IRYOKANCOB (IDX)
                                               TO  SPA-GMN-IRYOKAN-G
                   MOVE    SPA-IRYOKAN-MAX     TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
           .
      *
       505-IRYOKAN-CHK-EXT.
           EXIT.
      *****************************************************************
      *  ¡¡±ý¿Ç¥Á¥§¥Ã¥¯
      *****************************************************************
       505-OSINKBN-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-OSINKBN-MAX
               IF      SPA-GMN-OSINKBN  =   SPA-GMN-OSINKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-OSINKBNCOB (IDX)
                                               TO  SPA-GMN-OSINKBN-G
                   MOVE    SPA-OSINKBN-MAX     TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
           .
       505-OSINKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *  ¡¡»»ÄêÍúÎò¥Á¥§¥Ã¥¯
      *****************************************************************
       505-SANTEIRRKKBN-CHK-SEC         SECTION.
      *
      *ver.4.7
      *    Í½Ìó¥³¡¼¥É¤Î¤ß½é´üÉ½¼¨
           IF      SPA-Z01-SRYCD(1:3)  =   "099"
               IF      SPA-GMN-SANTEIRRKKBN    =   SPACE
                   MOVE    "0"             TO  SPA-GMN-SANTEIRRKKBN
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SANTEIRRKKBN-MAX
               IF      SPA-GMN-SANTEIRRKKBN  =   SPA-GMN-SANTEIRRKKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-SANTEIRRKKBNCOB (IDX)
                                           TO  SPA-GMN-SANTEIRRKKBN-G
                   MOVE    SPA-SANTEIRRKKBN-MAX    TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
           .
      *
       505-SANTEIRRKKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *  ¡¡»þ´Ö²Ã»»¥Á¥§¥Ã¥¯
      *****************************************************************
       505-TIMEKSNKBN-CHK-SEC         SECTION.
      *
      *ver.4.7
      *    Í½Ìó¥³¡¼¥É¤Î¤ß½é´üÉ½¼¨
           IF      SPA-Z01-SRYCD(1:3)  =   "099"
               IF      SPA-GMN-TIMEKSNKBN  =   SPACE
                   MOVE    "0"             TO  SPA-GMN-TIMEKSNKBN
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-TIMEKSNKBN-MAX
               IF      SPA-GMN-TIMEKSNKBN  =   SPA-GMN-TIMEKSNKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-TIMEKSNKBNCOB (IDX)
                                               TO  SPA-GMN-TIMEKSNKBN-G
                   MOVE    SPA-TIMEKSNKBN-MAX  TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
           .
      *
       505-TIMEKSNKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡³°Íè´ÉÍý²Ã»»¥Á¥§¥Ã¥¯
      *****************************************************************
       505-GAIKANRIKBN-CHK-SEC         SECTION.
      *
      *ver.4.7
      *    Í½Ìó¥³¡¼¥É¤Î¤ß½é´üÉ½¼¨
           IF      SPA-Z01-SRYCD(1:3)  =   "099"
               IF      SPA-GMN-GAIKANRIKBN =   SPACE
                   MOVE    "0"             TO  SPA-GMN-GAIKANRIKBN
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >    SPA-GAIKANRIKBN-MAX
               IF      SPA-GMN-GAIKANRIKBN  =   SPA-GMN-GAIKANRIKBNCOB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-GAIKANRIKBNCOB (IDX)
                                           TO  SPA-GMN-GAIKANRIKBN-G
                   MOVE    SPA-GAIKANRIKBN-MAX TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
           .
      *
       505-GAIKANRIKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *  ¥æ¡¼¥¶ÀßÄê¡¡»»ÄêÍúÎò¥Á¥§¥Ã¥¯
      *****************************************************************
       5030-PLUS-SANTEIRRK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PLUS-SANTEI-MAX
               IF      SPA-GMN-PLUS-SANTEIRRK
                                       =   SPA-GMN-PLUS-SANTEICOMB
                                                         (IDX)(1:1)
                   MOVE    SPA-GMN-PLUS-SANTEICOMB (IDX)
                                           TO  SPA-GMN-PLUS-SANTEIRRK-G
                   MOVE    SPA-PLUS-SANTEI-MAX TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           ELSE
      *        ¥·¥¹¥Æ¥àÍ½Ìó¤Ï»ØÄêÉí²Ã
               IF      SPA-GMN-PLUS-SANTEIRRK  =   1
                   IF      SPA-Z01-SRYCD(1:1)  NOT =   "1"
                       MOVE    "0019"              TO  SPA-ERRCD
                   END-IF
               END-IF
           END-IF
           .
      *
       5030-PLUS-SANTEIRRK-EXT.
           EXIT.
      *****************************************************************
      *  ¥æ¡¼¥¶ÀßÄê¡¡¥¨¥é¡¼½èÍý¥Á¥§¥Ã¥¯
      *****************************************************************
       5030-JGNCNTERR-CHK-SEC         SECTION.
      *
           EVALUATE    SPA-GMN-PLUS-JGNCNTERR
               WHEN    ZERO
                   CONTINUE
               WHEN    9
                   IF       SPA-GMN-PLUS-SANTEIRRK =   ZERO
                       MOVE    "0016"              TO  SPA-ERRCD
                   ELSE
                       IF   (SPA-GMN-PLUS-JGNCNT   =   ZERO )  AND
                            (SPA-GMN-PLUS-JGNCNT1D =   ZERO )  AND
                            (SPA-GMN-PLUS-JGNCNT1W =   ZERO )  AND
                            (SPA-GMN-PLUS-JGNCNTETCM   =   ZERO ) AND
                            (SPA-GMN-PLUS-JGNCNTETC    =   ZERO )
                           MOVE    "0017"              TO  SPA-ERRCD
                       END-IF
                   END-IF
               WHEN    OTHER
                   MOVE    "0015"              TO  SPA-ERRCD
           END-EVALUATE
           .
      *
       5030-JGNCNTERR-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡ÄÌÂ§Ç¯Îð»»¥Á¥§¥Ã¥¯
      *****************************************************************
       505-TSUSOKUAGE-CHK-SEC         SECTION.
      *
           IF    SPA-GMN-TSUSOKUAGE    =   0  OR  1
               CONTINUE
           ELSE
               MOVE    "0025"          TO  SPA-ERRCD
           END-IF
           .
      *
       505-TSUSOKUAGE-CHK-EXT.
           EXIT.
      *        
      *****************************************************************
      *  ¡¡²¼¸ÂÇ¯Îð¥Á¥§¥Ã¥¯
      *****************************************************************
       5026-KGNAGE-CHK-SEC                      SECTION.
      *
           IF      SPA-GMN-KGNAGE      =   SPACE
               MOVE    ZERO            TO  SPA-GMN-KGNAGE
           END-IF
      *
           IF      SPA-GMN-KGNAGE      =   "AA"
                                       OR  "B3"
                                       OR  "BF"
                                       OR  "BK"
                                       OR  "AE"
      *R02.4
                                       OR  "B6"
                                       OR  "MG"
               CONTINUE
           ELSE
      *
               INITIALIZE                      ORCSNUMAREA
               MOVE    SPA-GMN-KGNAGE      TO  SNUM-INX
               CALL    "ORCSNUM"           USING
                                           ORCSNUMAREA
               IF     (SNUM-RC         NOT =   ZERO  )   OR
                      (SNUM-MINKBN     NOT =   SPACE )   OR
                      (SNUM-SYOKBN     NOT =   SPACE )
                   MOVE    "0007"              TO  SPA-ERRCD
               ELSE
                   MOVE    SNUM-OUTEDT(14:2)       TO  SPA-GMN-KGNAGE
               END-IF
           END-IF
      *
           .
      *
       5026-KGNAGE-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡¾å¸ÂÇ¯Îð¥Á¥§¥Ã¥¯
      *****************************************************************
       5027-JGNAGE-CHK-SEC                      SECTION.
      *
           IF      SPA-GMN-JGNAGE      =   SPACE
               MOVE    ZERO            TO  SPA-GMN-JGNAGE
           END-IF
      *
           IF      SPA-GMN-JGNAGE      =   "AA"
                                       OR  "B3"
                                       OR  "BF"
                                       OR  "BK"
                                       OR  "AE"
      *R02.4
                                       OR  "B6"
                                       OR  "MG"
               CONTINUE
           ELSE
               MOVE    SPA-GMN-JGNAGE      TO  WRK-SNUM-INX
      *
               INITIALIZE                      ORCSNUMAREA
               MOVE    SPA-GMN-JGNAGE      TO  SNUM-INX
               CALL    "ORCSNUM"           USING
                                           ORCSNUMAREA
               IF     (SNUM-RC         NOT =   ZERO  )   OR
                      (SNUM-MINKBN     NOT =   SPACE )   OR
                      (SNUM-SYOKBN     NOT =   SPACE )
                   MOVE    "0007"              TO  SPA-ERRCD
               ELSE
                   MOVE    SNUM-OUTEDT(14:2)       TO  SPA-GMN-JGNAGE
               END-IF
           END-IF
           .    
      *
       5027-JGNAGE-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *  ¡¡Ãí²Ã»»¥³¡¼¥É¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       5042-CHUKSNCD-CHK-SEC                            SECTION.
      *
           IF      SPA-GMN-CHUKSNCD    =   SPACE
               MOVE    ZERO                TO  SPA-GMN-CHUKSNCD
            END-IF
      *
      *H26.2 Ï«ºÒÂÐ±þ¤Ç¥Á¥§¥Ã¥¯ºï½ü
      *    INITIALIZE                      ORCSNUMAREA
      *    MOVE    SPA-GMN-CHUKSNCD    TO  SNUM-INX
      *    CALL    "ORCSNUM"           USING
      *                                ORCSNUMAREA
      *    IF     (SNUM-RC         NOT =   ZERO  )   OR
      *           (SNUM-MINKBN     NOT =   SPACE )   OR
      *           (SNUM-SYOKBN     NOT =   SPACE )
      *        MOVE    "0007"              TO  SPA-ERRCD
      *    ELSE
      *        MOVE    SNUM-OUTEDT(12:4)       TO  SPA-GMN-CHUKSNCD
      *****END-IF
           .    
      *
       5042-CHUKSNCD-CHK-EXT.
      *
      *****************************************************************
      *  ¡¡¾å¸ÂÇ¯Îð¥Á¥§¥Ã¥¯
      *****************************************************************
       5044-AGEKSNKGN-CHK-SEC                      SECTION.
      *
           IF      WRK-AGEKSNKGN       =   SPACE
               MOVE    ZERO            TO  WRK-AGEKSNKGN
           END-IF
      *
           IF      WRK-AGEKSNKGN       =   "AA"
                                       OR  "B3"
                                       OR  "BF"
                                       OR  "BK"
                                       OR  "AE"
      *R02.4
                                       OR  "B6"
                                       OR  "MG"
               CONTINUE
           ELSE
               INITIALIZE                      ORCSNUMAREA
               MOVE    WRK-AGEKSNKGN       TO  SNUM-INX
               CALL    "ORCSNUM"           USING
                                           ORCSNUMAREA
               IF     (SNUM-RC         NOT =   ZERO  )   OR
                      (SNUM-MINKBN     NOT =   SPACE )   OR
                      (SNUM-SYOKBN     NOT =   SPACE )
                   MOVE    "0007"              TO  SPA-ERRCD
               ELSE
                   MOVE    SNUM-OUTEDT(14:2)       TO  WRK-AGEKSNKGN
               END-IF
           END-IF
           .    
      *
       5044-AGEKSNKGN-CHK-EXT.
           EXIT.
      *****************************************************************
      *  ¡¡¾å¸ÂÇ¯Îð¥Á¥§¥Ã¥¯
      *****************************************************************
       5045-AGEKSNJGN-CHK-SEC                      SECTION.
      *
           IF      WRK-AGEKSNJGN       =   SPACE
               MOVE    ZERO            TO  WRK-AGEKSNJGN
           END-IF
      *
           IF      WRK-AGEKSNJGN       =   "AA"
                                       OR  "B3"
                                       OR  "BF"
                                       OR  "BK"
                                       OR  "AE"
      *R02.4
                                       OR  "B6"
                                       OR  "MG"
               CONTINUE
           ELSE
               INITIALIZE                      ORCSNUMAREA
               MOVE    WRK-AGEKSNJGN       TO  SNUM-INX
               CALL    "ORCSNUM"           USING
                                           ORCSNUMAREA
               IF     (SNUM-RC         NOT =   ZERO  )   OR
                      (SNUM-MINKBN     NOT =   SPACE )   OR
                      (SNUM-SYOKBN     NOT =   SPACE )
                   MOVE    "0007"              TO  SPA-ERRCD
               ELSE
                   MOVE    SNUM-OUTEDT(14:2)       TO  WRK-AGEKSNJGN
               END-IF
           END-IF
           .    
      *
       5045-AGEKSNJGN-CHK-EXT.
           EXIT.
      *****************************************************************
      *  ºÎ·ìÎÁ¶èÊ¬  ¥Á¥§¥Ã¥¯
      *****************************************************************
       5030-SAIKETUKBN-CHK-SEC        SECTION.
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SAIKETUKBN-MAX
               IF      SPA-GMN-SAIKETUKBN  =   SPA-GMN-SAIKETUCOMB
                                                            (IDX)(1:1)
                   MOVE    SPA-GMN-SAIKETUCOMB (IDX)
                                           TO  SPA-GMN-SAIKETUKBN-G
                   MOVE    SPA-SAIKETUKBN-MAX  TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
      *
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
      *    ºÎ·ìÎÁ¶èÊ¬¤Ï¡¢¸¡ºº¤Î»þ¤Î¤ßÆþÎÏ²ÄÇ½
           IF      SPA-GMN-SAIKETUKBN  NOT =   "0"
               IF      SPA-GMN-SRYKBN      =   "60"
                   CONTINUE
               ELSE
                   IF      SPA-ERRCD           =   SPACE
                       MOVE    "0014"              TO  SPA-ERRCD
                   END-IF
               END-IF
           END-IF
           .    
       5030-SAIKETUKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *  ºÎ·ìÎÁ¶èÊ¬  ¥Á¥§¥Ã¥¯
      *****************************************************************
       5030-ZENKNSKBN-CHK-SEC        SECTION.
      *
           MOVE    ZERO                TO  FLG-OK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-ZENKNSKBN-MAX
               IF      SPA-GMN-ZENKNSKBN   =   SPA-GMN-ZENKNSKBN-COMB
                                                            (IDX)(1:1)
                   MOVE    SPA-GMN-ZENKNSKBN-COMB (IDX)
                                           TO  SPA-GMN-ZENKNSKBN-G
                   MOVE    SPA-ZENKNSKBN-MAX   TO  IDX
                   MOVE    1                   TO  FLG-OK
               END-IF
           END-PERFORM
      *
           IF      FLG-OK              =   ZERO
               MOVE    "0006"              TO  SPA-ERRCD
           END-IF
      *    ºÎ·ìÎÁ¶èÊ¬¤Ï¡¢¸¡ºº¤Î»þ¤Î¤ßÆþÎÏ²ÄÇ½
           IF      SPA-GMN-ZENKNSKBN   NOT =   "0"
               IF      SPA-GMN-SRYKBN      =   "60"
                   CONTINUE
               ELSE
                   MOVE    SPA-GMN-ZENKNSKBN-COMB (1)
                                               TO  SPA-GMN-ZENKNSKBN-G
               END-IF
           END-IF
           .
       5030-ZENKNSKBN-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÀÚÂØ¤¨½èÍý
      *****************************************************************
       420-KIRIKAE-SEC                              SECTION.
      *
           MOVE    SPACE               TO  WRK-MCP-WIDGET
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    ZERO                TO  FLG-TOUROKU
      *
      *    ²èÌÌ¤ò£Ó£Ð£Á¥»¥Ã¥È
           PERFORM 4101-GMN-SPA-SET-SEC
      *****ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      *****PERFORM 410-INPUT-CHK-SEC
      *
      *
           .
       420-KIRIKAE-EXT.
           EXIT.
      *****************************************************************
      *    ¥¿¥°ÀÚÂØ½èÍý
      *****************************************************************
       480-BETUGAMEN-SEC              SECTION.
      *
           MOVE    SPACE               TO  WRK-MCP-WIDGET
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    ZERO                TO  FLG-TOUROKU
      *    ²èÌÌ¤ò£Ó£Ð£Á¥»¥Ã¥È
           PERFORM 4101-GMN-SPA-SET-SEC
      *
           IF      SPA-ERRCD           =   SPACE
               EVALUATE    SPA-GMN-PAGENO
                   WHEN    0
                       MOVE    1               TO  SPA-GMN-PAGENO
                       MOVE    ZERO            TO  SPA-GMN-CUR
                   WHEN    1
                       MOVE    2               TO  SPA-GMN-PAGENO
                       MOVE    ZERO            TO  SPA-GMN-CUR
                   WHEN    2
                       MOVE    3               TO  SPA-GMN-PAGENO
                       MOVE    ZERO            TO  SPA-GMN-CUR
                   WHEN    3
                       MOVE    0               TO  SPA-GMN-PAGENO
                       MOVE    ZERO            TO  SPA-GMN-CUR
               END-EVALUATE
           END-IF
           .
       480-BETUGAMEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ìá¤ë¡¡½èÍý
      *****************************************************************
       401-BACK-SEC                              SECTION.
      *
           MOVE  "Z01"                           TO  SPA-SAKIPG.
      *
           MOVE  "Z03"                           TO  SPA-MOTOPG.
      *
      ***  MOVE  "CHANGE"                        TO  MCP-PUTTYPE.
           MOVE  SPA-SAKIPG                      TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                             TO  FLG-END.
       401-BACK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºï½ü³ÎÇ§²èÌÌÉ½¼¨½èÍý
      *****************************************************************
       403-DEL-SEC                               SECTION.
      *
      *H30.9
      *    ¿·µ¬¡¦²þÀµ½èÍý¤Ï¤Ê¤·
           IF      SPA-Z01-SYORIKBN    =   1
                                       OR  3
               GO      TO     403-DEL-EXT
           END-IF
      *
           IF      SPA-NAI-KEIFLG1     =   ZERO
               IF      SPA-Z01-SRYCD(1:1)  =   "1"
                   MOVE    "K003"          TO  SPA-ERRCD
               END-IF
               MOVE    1               TO  SPA-NAI-KEIFLG1
           END-IF
           IF      SPA-ERRCD           =   SPACE
               MOVE    "0001"              TO  SPA-ZIDCD
           END-IF
      *
           .    
       403-DEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºï½ü½èÍý
      *****************************************************************
       4031-DEL-SEC                              SECTION.
      *
           IF      SPA-MASTER-CLASS    =   2
      *        ¥æ¡¼¥¶ÅÀ¿ôÀßÄêÊ¬
               PERFORM 40311-TENSU-USER-DEL-SEC
           ELSE
      *        ÅÀ¿ô¥Þ¥¹¥¿ºï½ü
               PERFORM 40312-TENSU-MAST-DEL-SEC
           END-IF
      *
           IF      SPA-ERRCD          =   SPACE
               MOVE  "JOIN"               TO  MCP-PUTTYPE
               PERFORM  401-BACK-SEC
           END-IF
      *
           .
       4031-DEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥æ¡¼¥¶ÅÀ¿ôÀßÄêÊ¬ºï½ü½èÍý
      *****************************************************************
       40311-TENSU-USER-DEL-SEC        SECTION.
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ºï½ü
           MOVE    SPA-Z01-SRYCD       TO  TNS-SRYCD
           MOVE    SPA-Z01-TYUKOSTYMD(SPA-Z01-SELNUM)
                                       TO  TNS-YUKOSTYMD
           MOVE    SPA-Z01-TYUKOEDYMD(SPA-Z01-SELNUM)
                                       TO  TNS-YUKOEDYMD
      *
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "DBDELETE"          TO  MCP-FUNC
           MOVE    "tbl_tensu_user"    TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC          NOT =   ZERO
               DISPLAY "Z03 TENSU DEL ERR!!"   MCP-RC
                       ",KEY:"   TNS-KEY
               MOVE    "9001"                TO  SPA-ERRCD
           END-IF
      *
           .
       40311-TENSU-USER-DEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿ºï½ü½èÍý
      *****************************************************************
       40312-TENSU-MAST-DEL-SEC        SECTION.
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ºï½ü
           MOVE    SPA-Z01-SRYCD       TO  TNS-SRYCD
           MOVE    SPA-Z01-TYUKOSTYMD(SPA-Z01-SELNUM)
                                       TO  TNS-YUKOSTYMD
           MOVE    SPA-Z01-TYUKOEDYMD(SPA-Z01-SELNUM)
                                       TO  TNS-YUKOEDYMD
      *
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "DBDELETE"          TO  MCP-FUNC
           MOVE    "tbl_tensu_master"  TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC          NOT =   ZERO
               DISPLAY "Z03 TENSU DEL ERR!!"   MCP-RC
                       ",KEY:"   TNS-KEY
               MOVE    "9001"                TO  SPA-ERRCD
           END-IF
      *
      *    ÆþÎÏ¥³¡¼¥Éºï½ü
           IF     (SPA-Z01-SELNUM      =   1    )  AND
                  (SPA-Z01-MAX         =   1    )
               INITIALIZE                  INPUTCD-REC
               MOVE    SPA-HOSPNUM         TO  ICD-HOSPNUM
               MOVE    SPA-Z01-SRYCD       TO  ICD-SRYCD
               MOVE    INPUTCD-REC         TO  MCPDATA-REC
      *
               MOVE    "DBDELETE"          TO  MCP-FUNC
               MOVE    "tbl_inputcd"       TO  MCP-TABLE
               MOVE    "del22"             TO  MCP-PATHNAME
grpsys         CALL    "ORCDBMAIN"         USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
      *
      *        ÅÀ¿ôÉÕ²Ã¾ðÊóºï½ü
               INITIALIZE                  TENSUPLUS-REC
               MOVE    SPA-Z01-SRYCD       TO  TNSP-SRYCD
               MOVE    SPA-HOSPNUM         TO  TNSP-HOSPNUM
               MOVE    TENSUPLUS-REC       TO  MCPDATA-REC
               MOVE    "DBDELETE"          TO  MCP-FUNC
               MOVE    "tbl_tensuplus"     TO  MCP-TABLE
               MOVE    "del1"              TO  MCP-PATHNAME
grpsys         CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
      *        °ìÈÌÏ·¿Í¥³¡¼¥Éºï½ü
               PERFORM VARYING     IDX     FROM    1   BY  1
                       UNTIL      (IDX     >   5  )    OR
                                  (SPA-Z90-IPNSRYCD (IDX)  =   SPACE )
                   MOVE    SPA-Z90-IPNSRYCD (IDX)  TO  CHG-IPNSRYCD
                   MOVE    SPA-Z90-RJNSRYCD (IDX)  TO  CHG-RJNSRYCD
      *
                   MOVE    SPA-HOSPNUM         TO  CHG-HOSPNUM
                   MOVE    SRYCDCHG-REC        TO  MCPDATA-REC
                   MOVE    "DBDELETE"          TO  MCP-FUNC
      **********   MOVE    "tbl_srycdchg"      TO  MCP-TABLE
                   MOVE    "tbl_srycdchg_master"   TO  MCP-TABLE
                   MOVE    "key"               TO  MCP-PATHNAME
grpsys             CALL    "ORCDBMAIN"         USING   MCPAREA
                                                       MCPDATA-REC
                                                       SPA-AREA
               END-PERFORM
           END-IF
           .
       40312-TENSU-MAST-DEL-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆþÎÏ¥³¡¼¥É¡¡ÀßÄê½èÍý
      *****************************************************************
       405-INPUTCD-SEC                 SECTION.
      *
           MOVE    SPACE               TO  WRK-MCP-WIDGET
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    ZERO                TO  FLG-TOUROKU
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
      *    ÊÑ¹¹¤Ï¥¨¥é¡¼¤Ç¤âÁ«°Ü¤¹¤ë
           IF      SPA-Z01-SYORIKBN    =   2
               MOVE    SPACE               TO  SPA-ERRCD
           END-IF
      *
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      405-INPUTCD-EXT
           END-IF
      *
           MOVE    SPA-Z01KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
           MOVE    SPA-Z03             TO  SPA-Z01SONOTA
           MOVE    SPA-Z01FREE         TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGZ99"           USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON          TO  SPA-AREA
           MOVE    SPA-WORK            TO  SPA-Z01KYOUTU
           MOVE    SPA-FREE            TO  SPA-Z01FREE
           MOVE    SPA-Z01SONOTA       TO  SPA-Z03
      *
      *    ½é´ü¥«¡¼¥½¥ë
           MOVE    "INPUTCD01"         TO  MCP-WIDGET
      *
           MOVE    "Z99"               TO  SPA-SAKIPG.
           MOVE    "Z03"               TO  SPA-MOTOPG.
      *
           MOVE    SPA-MOTOPG          TO  SPA-Z99GMN-MOTOPG
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE.
           MOVE    SPA-SAKIPG          TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
      *
           MOVE    1                             TO  FLG-END.
      *
       405-INPUTCD-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï·¿Í°ìÈÌ¥³¡¼¥É¿¶ÂØÀßÄê½èÍý
      *****************************************************************
       407-SRYCDCHG-SEC                SECTION.
      *
           MOVE    SPACE               TO  WRK-MCP-WIDGET
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    ZERO                TO  FLG-TOUROKU
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
      *    ÊÑ¹¹¤Ï¥¨¥é¡¼¤Ç¤âÁ«°Ü¤¹¤ë
           IF      SPA-Z01-SYORIKBN    =   2
               MOVE    SPACE               TO  SPA-ERRCD
           END-IF
      *
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      407-SRYCDCHG-EXT
           END-IF
      *
           EVALUATE    SPA-GMN-ROUTEKKBN
               WHEN    1
               WHEN    2
                   CONTINUE
               WHEN    OTHER
                   MOVE    "0021"              TO  SPA-ERRCD
                   GO      TO      407-SRYCDCHG-EXT
           END-EVALUATE
      *
      *R01.10
      *    Äó¶¡ÂÐ¾Ý¤Ï¤Ê¤¤¤Î¤Ç³ÎÇ§¤Î¤ß
           IF      SPA-Z90-SRYCDCHG (1)    =   SPACE
               MOVE    "0022"              TO  SPA-ERRCD
               GO      TO      407-SRYCDCHG-EXT
           END-IF
      *
      *    £Ú£¹£°½é´ü²èÌÌÊÔ½¸
           MOVE    SPACE               TO  SPA-Z90GMN-AREA.
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   5
               MOVE    SPA-Z90-SRYCDCHG (IDX)
                               TO  SPA-Z90GMN-SRYCDCHG (IDX)
               MOVE    SPA-Z90-SRYNAME  (IDX)
                               TO  SPA-Z90GMN-SRYNAME (IDX)
           END-PERFORM
           MOVE    1                   TO  SPA-Z90GMN-CUR
      *
      *    ²èÌÌÊÔ½¸
           MOVE    SPACE               TO  Z90
           INITIALIZE                      Z90
           MOVE    SPA-Z01-SRYCD       TO  Z90-SRYCD
           MOVE    SPA-Z01-NAMEH       TO  Z90-SRYNAME
           PERFORM VARYING  IDX    FROM  1  BY  1  
                   UNTIL    IDX        >  5
               MOVE    SPA-Z90GMN-SRYCDCHG (IDX) TO  Z90-SRYCDCHG (IDX)
               MOVE    SPA-Z90GMN-SRYNAME  (IDX) TO  Z90-SRYCDNAME(IDX)
           END-PERFORM
      *
      *    ½é´ü¥«¡¼¥½¥ë
           MOVE    "SRYCDCHG1"         TO  MCP-WIDGET
      *
           MOVE    "Z90"               TO  SPA-SAKIPG
      *
           MOVE    "Z03"               TO  SPA-MOTOPG
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE
           MOVE    SPA-SAKIPG          TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                             TO  FLG-END.
      *
       407-SRYCDCHG-EXT.
           EXIT.
      *ver.5.0
      *****************************************************************
      *    ¥æ¡¼¥¶¡¼¹àÌÜÅÐÏ¿½èÍý
      *****************************************************************
       407-B10-SYORI-SEC                SECTION.
      *
           MOVE    SPACE               TO  WRK-MCP-WIDGET
           MOVE    ZERO                TO  SPA-GMN-CUR
           MOVE    ZERO                TO  FLG-TOUROKU
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
      *    ÊÑ¹¹¤Ï¥¨¥é¡¼¤Ç¤âÁ«°Ü¤¹¤ë
           IF      SPA-Z01-SYORIKBN    =   2
               MOVE    SPACE               TO  SPA-ERRCD
           END-IF
      *
           IF      SPA-Z01-SRYCD(1:1)  NOT =   "1"
               MOVE    "0050"              TO  SPA-ERRCD
           END-IF
      *    ÊÑ¹¹°Ê³°¤Ï¥¨¥é¡¼
           IF      SPA-Z01-SYORIKBN    NOT =   2
               MOVE    "0050"              TO  SPA-ERRCD
           END-IF
      *
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      407-B10-SYORI-EXT
           END-IF
      *
           MOVE    "Z010"              TO  SPA-SAKIPG
           MOVE    "Z03"               TO  SPA-MOTOPG
      *
           MOVE    SPA-Z01KYOUTU       TO  SPA-WORK
           MOVE    SPA-AREA            TO  SPA-COMMON
      *****MOVE    SPA-Z03             TO  SPA-Z01SONOTA
           MOVE    SPA-Z01FREE         TO  SPA-FREE
      *
           MOVE    "LINK"              TO  MCP-STATUS
           MOVE    SPACE               TO  MCP-EVENT
      *
           CALL    "ORCGZ010"          USING
                                       MCPAREA
                                       SPAAREA
                                       LINKAREA
                                       SCRAREA
      *
           MOVE    SPA-COMMON          TO  SPA-AREA
           MOVE    SPA-WORK            TO  SPA-Z01KYOUTU
           MOVE    SPA-FREE            TO  SPA-Z01FREE
           MOVE    SPA-Z01SONOTA       TO  SPA-Z03
           MOVE    SPA-Z010FREE        TO  SPA-Z010
      *    ²èÌÌ¾ðÊóÊÔ½¸
           MOVE    SPA-GMN-SRYKBN      TO  SPA-Z010-SRYKBN
           MOVE    SPA-GMN-DATAKBN     TO  SPA-Z010-DATAKBN
           MOVE    SPA-GMN-JGNCNT      TO  SPA-Z010-JGNCNT
           MOVE    SPA-GMN-JGNCNT1D    TO  SPA-Z010-JGNCNT1D
           MOVE    SPA-GMN-SANTEIRRKKBN    TO  SPA-Z010-SANTEIRRKKBN
      *
      *    ½é´ü¥«¡¼¥½¥ë
           IF      SPA-Z010-RRKMAX     =   ZERO
               MOVE    "YUKOSTYMD"         TO  MCP-WIDGET
           ELSE
               MOVE    "SELNUM"            TO  MCP-WIDGET
           END-IF
      *
           MOVE    "Z010"              TO  SPA-SAKIPG
           MOVE    "Z03"               TO  SPA-MOTOPG
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE
           MOVE    SPA-SAKIPG          TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                             TO  FLG-END
           .
      *
       407-B10-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    ÅÐÏ¿½èÍý
      *****************************************************************
       412-TOUROKU-SEC                           SECTION.
      *
           MOVE    SPACE               TO  WRK-MCP-WIDGET
           MOVE    ZERO                TO  SPA-GMN-CUR
      *
           MOVE    1                   TO  FLG-TOUROKU
      *    ÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
           PERFORM 410-INPUT-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      412-TOUROKU-EXT
           END-IF
      *
           IF      SPA-Z01-SYORIKBN    =   1
      *        ¿·µ¬½èÍý
               IF      SPA-NAI-KEIFLG2     =   ZERO
                   IF      SPA-Z01-SRYCD(1:1)  =   "0"
                       MOVE    "K002"          TO  SPA-ERRCD
                    ELSE
                       MOVE    "K001"          TO  SPA-ERRCD
                   END-IF
                   MOVE    1               TO  SPA-NAI-KEIFLG2
               END-IF
           END-IF
           IF      SPA-ERRCD           =   SPACE
               MOVE    "0002"              TO  SPA-ZIDCD
           END-IF
           .
       412-TOUROKU-EXT.
           EXIT.
      *
      ****************************************************************
      *    ÅÐÏ¿Á°¡¢ÆâÍÆÊÑ¹¹¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       4103-HENKOU-CHK-SEC      SECTION.
      *
           IF      SPA-Z01-SYORIKBN    =   2
      *        ¹¹¿·½èÍý¤Î»þ¤Î¤ß
               CONTINUE
           ELSE
               GO      TO      4103-HENKOU-CHK-EXT
           END-IF
      *
           IF      SPA-MASTER-CLASS    =   2
      *        ¥æ¡¼¥¶ÅÀ¿ôÀßÅÐÏ¿
               MOVE    "tbl_tensu_user"    TO  WRK-MCP-TABLE
           ELSE
               MOVE    "tbl_tensu_master"  TO  WRK-MCP-TABLE
           END-IF
      *
           INITIALIZE                      TNS-TENSU-REC
      *
           MOVE    SPA-Z01-SRYCD       TO  TNS-SRYCD
           MOVE    SPA-Z01-TYUKOSTYMD(SPA-Z01-SELNUM)
                                       TO  TNS-YUKOSTYMD
           MOVE    SPA-Z01-TYUKOEDYMD(SPA-Z01-SELNUM)
                                       TO  TNS-YUKOEDYMD
      *
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
      **** MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
      ****     MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 900-TENSU-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-TENSU
               INITIALIZE                      TNS-TENSU-REC
           END-IF
      **** MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBLOSEC-SEC
      *
           IF      FLG-TENSU           =   ZERO
               MOVE    TNS-TENSU-REC(1:1290)   TO  WRK-TNS-TENSU-REC
      *        ¹¹¿·¹àÌÜÊÔ½¸
               PERFORM 4121-KOUMOKUISO-SEC
      *
               IF      TNS-TENSU-REC(1:1290)   =   WRK-TNS-TENSU-REC
                   MOVE    SPACE           TO  SPA-ERRCD
      *H29.1   ¥Á¥§¥Ã¥¯¤Ê¤·
      *            ÆþÎÏ¥Á¥§¥Ã¥¯¶èÊ¬¤Ï¥¨¥é¡¼¤È¤¹¤ë
      *            ºÎ·ìÎÁ¶èÊ¬¡¦Á°²ó¸¡ººÆü¥Á¥§¥Ã¥¯¤Ï¹Ô¤¦
      *            PERFORM 5030-SAIKETUKBN-CHK-SEC
      *            IF      SPA-ERRCD           =   SPACE
      *                PERFORM 5030-ZENKNSKBN-CHK-SEC
      *                IF      SPA-ERRCD       NOT =   SPACE
      *                    MOVE    "ZENKNSKBN"     TO  WRK-MCP-WIDGET
      *                END-IF
      *            ELSE
      *                MOVE    "SAIKETUKBN"        TO  WRK-MCP-WIDGET
      *            END-IF
      *            IF      SPA-ERRCD       NOT =   SPACE
      *            ¥¨¥é¡¼¤Î¼¡¤Î¥«¡¼¥½¥ëÀßÄê
      *                SET     IDX-GMN             TO  1
      *                SEARCH      TBL-GMN-OCC     VARYING   IDX-GMN
      *                AT  END
      *                    MOVE    ZERO            TO  SPA-GMN-CUR
      *                WHEN    WRK-MCP-WIDGET  =   TBL-WIDGET (IDX-GMN)
      *                    MOVE    IDX-GMN         TO  SPA-GMN-CUR
      *                END-SEARCH 
      ****         END-IF
               END-IF
           END-IF
      *
      *
           .    
       4103-HENKOU-CHK-EXT.
           EXIT.
      *
      ****************************************************************
      *    ÅÐÏ¿Á°¡¢É¬¿ÜÆþÎÏ¥Á¥§¥Ã¥¯½èÍý
      ****************************************************************
       4109-TOUROKU-CHK-SEC      SECTION.
      *
      *    ÅÐÏ¿»þ¡¢É¬¿ÜÆþÎÏ¥Á¥§¥Ã¥¯
           IF      SPA-GMN-YUKOSTYMD   =   SPACE
               MOVE    "0001"              TO  SPA-ERRCD
               MOVE    1                   TO  SPA-GMN-CUR
           END-IF
           IF      SPA-ERRCD           =   SPACE
               IF      SPA-GMN-YUKOEDYMD   =   SPACE
                   MOVE    "0002"              TO  SPA-ERRCD
                   MOVE    2                   TO  SPA-GMN-CUR
               END-IF
           END-IF
      *
           IF      SPA-ERRCD           =   SPACE
               IF      SPA-NAI-YUKOSTYMD   >=  SPA-NAI-YUKOEDYMD
                   MOVE    "1010"              TO  SPA-ERRCD
                   MOVE    2                   TO  SPA-GMN-CUR
               END-IF
           END-IF
      *
      *    Í­¸ú´ü¸ÂÈÏ°Ï¥Á¥§¥Ã¥¯
           IF      SPA-ERRCD           =   SPACE
               EVALUATE    SPA-Z01-SYORIKBN
      *            ¹¹¿·¥Á¥§¥Ã¥¯
                   WHEN    2
                       PERFORM 41091-YUKOKIKAN-CHK2-SEC
                   WHEN    3
      *            ²þÀµ¥Á¥§¥Ã¥¯
                       PERFORM 41092-YUKOKIKAN-CHK3-SEC
               END-EVALUATE
           END-IF
      *H24.8
      *    ´ü´ÖÊÑ¹¹¥Á¥§¥Ã¥¯
           IF      SPA-Z01-SELNUM      >=  1
               IF      (SPA-Z01-TYUKOSTYMD(SPA-Z01-SELNUM)
                                       NOT =   SPA-NAI-YUKOSTYMD)
               OR      (SPA-Z01-TYUKOEDYMD(SPA-Z01-SELNUM)
                                       NOT =   SPA-NAI-YUKOEDYMD)
                   IF     (SPA-NAI-KEIFLGK     =   ZERO  )
                     AND  (SPA-ERRCD           =   SPACE )
                       MOVE    "K004"          TO  SPA-ERRCD
                       MOVE    1               TO  SPA-NAI-KEIFLGK
                       MOVE    1               TO  SPA-GMN-CUR
      *H29.1
      *               ¹¹¿·ÉÔ²Ä
                       IF      (SPA-MASTER-CLASS   =   2  )
                          OR   (SPA-MENTE-OK       =   1  )
                           CONTINUE
                       ELSE
                           MOVE    "0051"      TO  SPA-ERRCD
                           MOVE    ZERO        TO  SPA-NAI-KEIFLGK
                       END-IF
                   END-IF
               END-IF
           END-IF
      *
      *
           IF      SPA-ERRCD           =   SPACE
               IF      SPA-GMN-NAME        =   SPACE
                   MOVE    "1014"              TO  SPA-ERRCD
                   MOVE    7                   TO  SPA-GMN-CUR
               END-IF
           END-IF
      *
      *H29.1
      *    ÅÀ¿ôÉÕ²Ã¾ðÊó¤Ï¥Á¥§¥Ã¥¯¤Ê¤·
           GO      TO      4109-TOUROKU-CHK-EXT
      *
      *    Á°²ó¸¡ººÆü¤È»»ÄêÍúÎòºîÀ®Í­ÌµÈ½Äê
           IF      SPA-GMN-ZENKNSKBN   NOT =   ZERO
               IF      (SPA-ERRCD          =   SPACE )
                   AND (SPA-NAI-KEIFLG3    =   ZERO  )
                   IF     (SPA-GMN-SANTEIRRKKBN    =   ZERO )
                     AND  (SPA-GMN-PLUS-SANTEIRRK  =   ZERO )
                       MOVE    "K100"              TO  SPA-ERRCD
                       MOVE    1                   TO  SPA-NAI-KEIFLG3
                       MOVE    "PLUS_SANTEIRRK"    TO  WRK-MCP-WIDGET
                   END-IF
               END-IF
           END-IF
      *    ¥æ¡¼¥¶ÀßÄê¤Î¾å¸Â²ó¿ô
           IF       SPA-GMN-PLUS-SANTEIRRK NOT =   ZERO
               IF     (SPA-GMN-JGNCNT   =   ZERO )  AND
                      (SPA-GMN-JGNCNT1D =   ZERO )
                   CONTINUE
               ELSE
                   IF    (SPA-GMN-JGNCNT   NOT =   ZERO )  AND
                         (SPA-GMN-PLUS-JGNCNT  =   ZERO )
                     AND (SPA-GMN-PLUS-JGNCNTETC    =   ZERO )
                     AND (SPA-GMN-PLUS-JGNCNT1W     =   ZERO )
                     AND (SPA-ERRCD                 =   SPACE )
                       MOVE    "0018"              TO  SPA-ERRCD
                       MOVE    "PLUS_JGNCNT"       TO  WRK-MCP-WIDGET
                   END-IF
                   IF    (SPA-GMN-JGNCNT1D     NOT =   ZERO )  AND
                         (SPA-GMN-PLUS-JGNCNT1D    =   ZERO )
                     AND (SPA-ERRCD                =   SPACE )
                       MOVE    "0018"              TO  SPA-ERRCD
                       MOVE    "PLUS_JGNCNT1D"     TO  WRK-MCP-WIDGET
                   END-IF
               END-IF
           END-IF
           .
      *
       4109-TOUROKU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¹¹¿·Í­¸ú´ü¸ÂÈÏ°Ï¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       41091-YUKOKIKAN-CHK2-SEC        SECTION.
      *
      *    Á°¥Á¥§¥Ã¥¯
           IF      SPA-Z01-SELNUM      >   1
               MOVE    SPA-Z01-TYUKOEDYMD(SPA-Z01-SELNUM - 1)
                                           TO  WRK-YMD
      *        ÂÐ¾ÝÆü¡Ü£±Æü
               PERFORM 800-DAYSET-SEC
               IF      SPA-NAI-YUKOSTYMD       <   WRK-OTYMD
                   MOVE    "1011"              TO  SPA-ERRCD
                   MOVE    1                   TO  SPA-GMN-CUR
               END-IF
           END-IF
      *    ¸å¥Á¥§¥Ã¥¯
           IF      SPA-Z01-SELNUM      <   SPA-Z01-MAX
               MOVE    SPA-NAI-YUKOEDYMD   TO  WRK-YMD
      *        ÂÐ¾ÝÆü¡Ü£±Æü
               PERFORM 800-DAYSET-SEC
      *****    IF      SPA-Z01-TYUKOSTYMD(SPA-Z01-SELNUM + 1)
      *****                                NOT =   WRK-OTYMD
               IF      SPA-Z01-TYUKOSTYMD(SPA-Z01-SELNUM + 1)
                                               <   WRK-OTYMD
                   IF      SPA-ERRCD           =   SPACE
                       MOVE    "1011"              TO  SPA-ERRCD
                       MOVE    2                   TO  SPA-GMN-CUR
                   END-IF
               END-IF
           END-IF
           .
      *
       41091-YUKOKIKAN-CHK2-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²þÀµÍ­¸ú´ü¸ÂÈÏ°Ï¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       41092-YUKOKIKAN-CHK3-SEC        SECTION.
      *
           IF      SPA-Z01-TYUKOSTYMD(SPA-Z01-SELNUM)
                                           >=  SPA-NAI-YUKOSTYMD
               MOVE    "1012"              TO  SPA-ERRCD
               MOVE    1                   TO  SPA-GMN-CUR
           END-IF
      *
           IF      SPA-NAI-YUKOEDYMD   NOT =  ALL "9"
               IF      SPA-ERRCD           =   SPACE
                   MOVE    "1013"              TO  SPA-ERRCD
                   MOVE    1                   TO  SPA-GMN-CUR
               END-IF
           END-IF
      *H24.8
           IF      SPA-ERRCD           =   SPACE
               IF      SPA-NAI-KEIFLGK     =   ZERO
                   MOVE    "K005"          TO  SPA-ERRCD
                   MOVE    1               TO  SPA-NAI-KEIFLGK
                   MOVE    1               TO  SPA-GMN-CUR
               END-IF
           END-IF
           .
      *
       41092-YUKOKIKAN-CHK3-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÐÏ¿½èÍý
      *****************************************************************
       4121-TOUROKU-SEC                          SECTION.
      *
      *    ¹¹¿·Æü¼èÆÀ
           INITIALIZE                  ORCSMCNDATEAREA
           CALL    "ORCSMCNDATE"       USING
                                       ORCSMCNDATEAREA
      *
           IF      SPA-MASTER-CLASS    =   2
      *        ¥æ¡¼¥¶ÅÀ¿ôÀßÅÐÏ¿
               PERFORM 41211-TENSU-USER-UPD-SEC
           ELSE
      *        ÅÀ¿ô¥Þ¥¹¥¿ÅÐÏ¿
               PERFORM 41212-TENSU-MAST-UPD-SEC
           END-IF
      *
      *    Á°²èÌÌ¤ËÌá¤ë
           IF      SPA-ERRCD           =   SPACE
               MOVE     "JOIN"            TO  MCP-PUTTYPE
               PERFORM  401-BACK-SEC
           END-IF
      *
           .
       4121-TOUROKU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÐÏ¿½èÍý
      *****************************************************************
       41211-TENSU-USER-UPD-SEC        SECTION.
      *
           MOVE    "tbl_tensu_user"    TO  WRK-MCP-TABLE
           MOVE    "key"               TO  WRK-MCP-PATHNAME
           EVALUATE    SPA-Z01-SYORIKBN
      *        ²þÀµ»þ½èÍý
               WHEN    3
                   PERFORM 41211-KAISEI-SYORI-SEC
      *¡¡          ¿·µ¬½èÍý
                   PERFORM 41213-INSERT-SYORI-SEC
      *¡¡      ¹¹¿·½èÍý
               WHEN    2
                   PERFORM 41212-UPDATE-SYORI-SEC
      *¡¡      ¿·µ¬½èÍý
               WHEN    1
                   PERFORM 41213-INSERT-SYORI-SEC
           END-EVALUATE
      *
      *H29.1
      *    ÅÀ¿ô¥Þ¥¹¥¿ÉÕ²Ã¾ðÊó¹¹¿·
      *    IF      SPA-ERRCD           =   SPACE
      *        PERFORM 4129-TENSUPLUS-UPD-SEC
      *    END-IF
      *
      *    ÆþÎÏ¥³¡¼¥É¹¹¿·
           IF      SPA-ERRCD           =   SPACE
               CALL    "ORCGZS01"          USING
                                           MCPAREA
                                           SPAAREA
           END-IF
      *
      *R01.10  ºï½ü
      *    Ï·¿Í°ìÈÌ¥³¡¼¥ÉÊÑ´¹¥Þ¥¹¥¿¹¹¿·
      *    IF      SPA-ERRCD           =   SPACE
      *        PERFORM 41212-SRYCDCHG-UPD-SEC
      *****END-IF
      *
           .
       41211-TENSU-USER-UPD-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÐÏ¿½èÍý
      *****************************************************************
       41212-TENSU-MAST-UPD-SEC        SECTION.
      *
           IF     (SPA-MENTE-OK        =   1 )
      *    ¥á¥ó¥Æ¥Ê¥ó¥¹¥â¡¼¥É¤Î¤ß¡¢¥Þ¥¹¥¿¹¹¿·
      *
           MOVE    "tbl_tensu_master"  TO  WRK-MCP-TABLE
           MOVE    "key"               TO  WRK-MCP-PATHNAME
           EVALUATE    SPA-Z01-SYORIKBN
      *        ²þÀµ»þ½èÍý
               WHEN    3
                   PERFORM 41211-KAISEI-SYORI-SEC
      *¡¡          ¿·µ¬½èÍý
                   PERFORM 41213-INSERT-SYORI-SEC
      *¡¡      ¹¹¿·½èÍý
               WHEN    2
                   PERFORM 41212-UPDATE-SYORI-SEC
      *¡¡      ¿·µ¬½èÍý
               WHEN    1
                   PERFORM 41213-INSERT-SYORI-SEC
           END-EVALUATE
      *
           END-IF
      *H29.1
      *    ÅÀ¿ô¥Þ¥¹¥¿ÉÕ²Ã¾ðÊó¹¹¿·
      *    IF      SPA-ERRCD           =   SPACE
      *        PERFORM 4129-TENSUPLUS-UPD-SEC
      *    END-IF
      *
      *    ÆþÎÏ¥³¡¼¥É¹¹¿·
           IF      SPA-ERRCD           =   SPACE
               CALL    "ORCGZS01"          USING
                                           MCPAREA
                                           SPAAREA
           END-IF
      *
      *R01.10  ºï½ü
      *    Ï·¿Í°ìÈÌ¥³¡¼¥ÉÊÑ´¹¥Þ¥¹¥¿¹¹¿·
      *    IF      SPA-ERRCD           =   SPACE
      *        PERFORM 41212-SRYCDCHG-UPD-SEC
      ***  END-IF
      *
           .
       41212-TENSU-MAST-UPD-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²þÀµ»þ½èÍý
      *****************************************************************
       41211-KAISEI-SYORI-SEC          SECTION.
      *
      *    Í­¸ú½ªÎ»Æü¤ò·èÄê¤¹¤ë
      *    º£²ó¤ÎÍ­¸ú³«»ÏÆü¤ÎÁ°Æü¤È¤¹¤ë
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY6-AREA
           MOVE    "61"                TO  LNK-DAY6-IRAI
           MOVE    SPA-NAI-YUKOSTYMD   TO  LNK-DAY6-KIJUN
           MOVE    "1"                 TO  LNK-DAY6-ZOGENPTN
           MOVE    -1                  TO  LNK-DAY6-ZOGEN
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY6-AREA
           IF      STS-DAY-RC1         =   ZERO
               MOVE    LNK-DAY6-KEISAN     TO  WRK-YUKOEDYMD
           ELSE
               MOVE    1                   TO  SPA-GMN-CUR
               MOVE    "0001"              TO  SPA-ERRCD
               GO      TO      41211-KAISEI-SYORI-EXT
           END-IF
      *
      *    Í­¸úÇ¯·îÆü¤ò¹¹¿·¤¹¤ë
           INITIALIZE                      TNS-TENSU-REC
      *
           MOVE    SPA-Z01-SRYCD       TO  TNS-SRYCD
           MOVE    SPA-Z01-TYUKOSTYMD(SPA-Z01-SELNUM)
                                       TO  TNS-YUKOSTYMD
           MOVE    SPA-Z01-TYUKOEDYMD(SPA-Z01-SELNUM)
                                       TO  TNS-YUKOEDYMD
      *
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
      **** MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
      *****    MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 900-TENSU-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-TENSU
               INITIALIZE                      TNS-TENSU-REC
           END-IF
      *
      **** MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBLOSEC-SEC
      *
           IF      FLG-TENSU           =   ZERO
      *        ¹¹¿·
               MOVE    WRK-YUKOEDYMD       TO  TNS-YUKOEDYMD
      *
               MOVE    SPA-Z01-SRYCD       TO  TNSUP-SRYCD
               MOVE    SPA-Z01-TYUKOSTYMD(SPA-Z01-SELNUM)
                                           TO  TNSUP-YUKOSTYMD
               MOVE    SPA-Z01-TYUKOEDYMD(SPA-Z01-SELNUM)
                                           TO  TNSUP-YUKOEDYMD
               MOVE    SPA-HOSPNUM         TO  TNSUP-HOSPNUM
      *
               MOVE    SPA-OPID            TO  TNS-OPID
               MOVE    SMCNDATE-YMD        TO  TNS-UPYMD
               MOVE    SMCNDATE-HMS        TO  TNS-UPHMS
      *
               MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
               MOVE    "DBUPDATE"          TO  MCP-FUNC
      *****    MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
               MOVE    "upd1"              TO  MCP-PATHNAME
grpsys         CALL    "ORCDBMAIN"         USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
               IF      MCP-RC              NOT =   ZERO
                   DISPLAY "Z02 TENSU UPD ERR:" MCP-RC
                           ",KEY:" TNSUP-KEY
                   MOVE    1                     TO  SPA-GMN-CUR
                   MOVE    "9002"                TO  SPA-ERRCD
               END-IF
           END-IF
      *
           .
       41211-KAISEI-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¹¹¿·½èÍý
      *****************************************************************
       41212-UPDATE-SYORI-SEC                       SECTION.
      *
      *
           INITIALIZE                      TNS-TENSU-REC
      *
           MOVE    SPA-Z01-SRYCD       TO  TNS-SRYCD
           MOVE    SPA-Z01-TYUKOSTYMD(SPA-Z01-SELNUM)
                                       TO  TNS-YUKOSTYMD
           MOVE    SPA-Z01-TYUKOEDYMD(SPA-Z01-SELNUM)
                                       TO  TNS-YUKOEDYMD
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
      *
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
      **** MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
      *****    MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 900-TENSU-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-TENSU
               INITIALIZE                      TNS-TENSU-REC
           END-IF
      *
      **** MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBLOSEC-SEC
      *
           IF      FLG-TENSU           =   ZERO
      *        ¹¹¿·¹àÌÜÊÔ½¸
               MOVE    SPA-Z01-SRYCD       TO  TNS-SRYCD
               MOVE    SPA-NAI-YUKOSTYMD   TO  TNS-YUKOSTYMD
               MOVE    SPA-NAI-YUKOEDYMD   TO  TNS-YUKOEDYMD
               MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
               PERFORM 4121-KOUMOKUISO-SEC
      *
               MOVE    SPA-Z01-SRYCD       TO  TNSUP-SRYCD
               MOVE    SPA-Z01-TYUKOSTYMD(SPA-Z01-SELNUM)
                                           TO  TNSUP-YUKOSTYMD
               MOVE    SPA-Z01-TYUKOEDYMD(SPA-Z01-SELNUM)
                                           TO  TNSUP-YUKOEDYMD
               MOVE    SPA-HOSPNUM         TO  TNSUP-HOSPNUM
      *
               MOVE    SPA-OPID            TO  TNS-OPID
               MOVE    SMCNDATE-YMD        TO  TNS-UPYMD
               MOVE    SMCNDATE-HMS        TO  TNS-UPHMS
      *
               MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
               MOVE    "DBUPDATE"          TO  MCP-FUNC
      ******   MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
               MOVE    "upd1"              TO  MCP-PATHNAME
grpsys         CALL    "ORCDBMAIN"         USING   MCPAREA
                                                   MCPDATA-REC
                                                   SPA-AREA
               IF      MCP-RC              NOT =   ZERO
                   DISPLAY "Z02 TENSU UPD ERR:" MCP-RC
                           ",KEY:" TNS-KEY
                   MOVE    1                     TO  SPA-GMN-CUR
                   MOVE    "9002"                TO  SPA-ERRCD
               END-IF
           END-IF
      *
           .
       41212-UPDATE-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¹¹¿·½èÍý
      *****************************************************************
       41213-INSERT-SYORI-SEC          SECTION.
      *
      *    ¥Ç¡¼¥¿£É£Î£Ó£Å£Ò£Ô
           MOVE    SPACE               TO  TNS-TENSU-REC
           INITIALIZE                      TNS-TENSU-REC
           MOVE    SPA-Z01-SRYCD       TO  TNS-SRYCD
           MOVE    SPA-NAI-YUKOSTYMD   TO  TNS-YUKOSTYMD
           MOVE    SPA-NAI-YUKOEDYMD   TO  TNS-YUKOEDYMD
           PERFORM 4121-KOUMOKUISO-SEC
      *
           MOVE    SPA-OPID            TO  TNS-OPID
           MOVE    SMCNDATE-YMD        TO  TNS-CREYMD
           MOVE    SMCNDATE-YMD        TO  TNS-UPYMD
           MOVE    SMCNDATE-HMS        TO  TNS-UPHMS
      *
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "DBINSERT"          TO  MCP-FUNC
      **** MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    WRK-MCP-TABLE       TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           IF      MCP-RC          NOT =   ZERO
               MOVE    1                   TO  SPA-GMN-CUR
               MOVE    "9003"              TO  SPA-ERRCD
               DISPLAY "Z02 TENSU INS ERR:" MCP-RC
                       ",KEY:" TNS-KEY
           END-IF
      *
           .
       41213-INSERT-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÐÏ¿½èÍý
      *****************************************************************
       4121-KOUMOKUISO-SEC                       SECTION.
      *
           MOVE  SPA-GMN-SRYKBN          TO  TNS-SRYKBN         
           MOVE  SPA-GMN-SRYSYUKBN       TO  TNS-SRYSYUKBN      
           MOVE  SPA-GMN-DATAKBN         TO  TNS-DATAKBN        
      *
           MOVE  SPA-GMN-KANANAME        TO  TNS-KANANAME       
                                                     WRK-STRINGTBL
           MOVE  100                     TO  CNT-STRING
           PERFORM 891-STRCOUNT-SEC
           MOVE  CNT-STRING              TO  TNS-KANAYUKOKETA
           MOVE  SPA-GMN-NAME            TO  TNS-NAME           
                                                    WRK-STRINGTBL
           MOVE  100                     TO  CNT-STRING
           PERFORM  891-STRCOUNT-SEC
           MOVE  CNT-STRING              TO  TNS-YUKOKETA
      *    Àµ¼°Ì¾¾Î
           MOVE  SPA-GMN-FORMALNAME      TO  TNS-FORMALNAME           
                                                    WRK-STRINGTBL
           MOVE  200                     TO  CNT-STRING
           PERFORM  891-STRCOUNT-SEC
           MOVE  CNT-STRING              TO  TNS-FORMALYUKOKETA
      *
           MOVE  SPA-GMN-TEN             TO  TNS-TEN
      *
           MOVE  SPA-GMN-TENSIKIBETU     TO  TNS-TENSIKIBETU
           MOVE  SPA-GMN-OLDTEN          TO  TNS-OLDTEN
           MOVE  SPA-GMN-OLDTENSKB       TO  TNS-OLDTENSKB
           MOVE  SPA-GMN-TANICD          TO  TNS-TANICD
           MOVE  SPA-GMN-TANINAME        TO  TNS-TANINAME
           MOVE  SPA-GMN-HKNTEKKBN       TO  TNS-HKNTEKKBN
           MOVE  SPA-GMN-BYOKANRENKBN    TO  TNS-BYOKANRENKBN
      *
           MOVE  SPA-GMN-SDOKNRYO        TO  TNS-SDOKNRYO
           MOVE  SPA-GMN-YKZKNRKBN       TO  TNS-YKZKNRKBN
           MOVE  SPA-GMN-NYUGAITEKKBN    TO  TNS-NYUGAITEKKBN
           MOVE  SPA-GMN-ROUTEKKBN       TO  TNS-ROUTEKKBN
           MOVE  SPA-GMN-HOSPSRYKBN      TO  TNS-HOSPSRYKBN
           MOVE  SPA-GMN-OSINKBN         TO  TNS-OSINKBN
      *
           MOVE  SPA-GMN-BYOSYOKBN       TO  TNS-BYOSYOKBN
      *
           MOVE  SPA-GMN-SANTEIRRKKBN    TO  TNS-SANTEIRRKKBN
      *
           MOVE  SPA-GMN-SANTEIRRKKBN    TO  TNS-SANTEIRRKKBN
      *
           MOVE  SPA-GMN-TIMEKSNKBN      TO  TNS-TIMEKSNKBN
      *
           MOVE  SPA-GMN-GAIKANRIKBN     TO  TNS-GAIKANRIKBN
      *
           MOVE  SPA-GMN-TSUSOKUAGE      TO  TNS-TSUSOKUAGE
      *
           IF    SPA-GMN-KGNAGE            =   SPACE
               MOVE    ZERO              TO  SPA-GMN-KGNAGE
           END-IF
           MOVE  SPA-GMN-KGNAGE          TO  TNS-KGNAGE         
           IF    SPA-GMN-JGNAGE            =   SPACE
               MOVE    ZERO              TO  SPA-GMN-JGNAGE
           END-IF
           MOVE  SPA-GMN-JGNAGE          TO  TNS-JGNAGE         
           MOVE  SPA-GMN-JITUDAY         TO  TNS-JITUDAY
           MOVE  SPA-GMN-DAYCNT          TO  TNS-DAYCNT         
           MOVE  SPA-GMN-JGNCNT          TO  TNS-JGNCNT         
           MOVE  SPA-GMN-JGNCNT1D        TO  TNS-JGNCNT1D       
           MOVE  SPA-GMN-JGNCNT1W        TO  TNS-JGNCNT1W       
           MOVE  SPA-GMN-JGNCNTETCM      TO  TNS-JGNCNTETCM     
           MOVE  SPA-GMN-JGNCNTETC       TO  TNS-JGNCNTETC      
      *
           MOVE  SPA-GMN-JGNCNTERR       TO  TNS-JGNCNTERR      
           MOVE  SPA-GMN-KZMCOMPSIKIBETU TO  TNS-KZMCOMPSIKIBETU
      *
           MOVE  SPA-GMN-KZMKGN          TO  TNS-KZMKGN         
           MOVE  SPA-GMN-KZMJGN          TO  TNS-KZMJGN         
           MOVE  SPA-GMN-KZM             TO  TNS-KZM            
           MOVE  SPA-GMN-KZMTEN          TO  TNS-KZMTEN         
      *
           MOVE  SPA-GMN-KZMERR          TO  TNS-KZMERR         
      *
           MOVE  SPA-GMN-CHUKSNCD        TO  TNS-CHUKSNCD       
           MOVE  SPA-GMN-CHUKSNTSUBAN    TO  TNS-CHUKSNTUBAN    
      *
           PERFORM  VARYING  IDXX
                    FROM  1  BY  1  UNTIL  IDXX  >  4
               MOVE  SPA-GMN-AGEKSNKGN(IDXX)   TO  TNS-AGEKSNKGN(IDXX)
               MOVE  SPA-GMN-AGEKSNJGN(IDXX)   TO  TNS-AGEKSNJGN(IDXX)
               MOVE  SPA-GMN-AGEKSNSRYCD(IDXX) TO
                                               TNS-AGEKSNSRYCD(IDXX)
           END-PERFORM
      *                                          
           MOVE  SPA-GMN-TUSOKUGAIKBN          TO  TNS-TUSOKUGAIKBN
      *
           MOVE  SPA-GMN-LASERKSN              TO  TNS-LASERKBN
      *
           MOVE  SPA-GMN-CHPMESUKSN            TO  TNS-CHPMESUKSN      
      *
           MOVE  SPA-GMN-MICMESUKSN            TO  TNS-MICMESUKSN      
      *
           MOVE  SPA-GMN-DONORKBN              TO  TNS-DONORKBN      
      *
           MOVE  SPA-GMN-SEKIZUISOKUTEI        TO  TNS-SEKIZUISOKUTEI  
      *
           MOVE  SPA-GMN-KEIBUJYUTU            TO  TNS-KEIBUJYUTU      
      *
           MOVE  SPA-GMN-AUTOHOUGO             TO  TNS-AUTOHOUGO       
      *
           MOVE  SPA-GMN-AUTOFUNGO             TO  TNS-AUTOFUNGO       
      *
           MOVE  SPA-GMN-CHPGYOKOSOTIKSN       TO  TNS-CHPGYOKOSOTIKSN 
      *
           MOVE  SPA-GMN-SHORTSTAYOPE          TO  TNS-SHORTSTAYOPE    
      *    »ÜÀß´ð½àÉÔÅ¬¹ç¶èÊ¬
           MOVE  SPA-GMN-KIJUNTEIGENKBN        TO  TNS-KIJUNTEIGENKBN
      *     ´ð½àÉÔÅ¬¹çÄþ¸ºÂÐ¾Ý»ÜÀß´ð½à¥³¡¼¥É
           MOVE  SPA-GMN-KIJUNTEIGENCD         TO  TNS-KIJUNTEIGENCD
      *
           MOVE  SPA-GMN-KNSJISKBN             TO  TNS-KNSJISKBN       
      *
           MOVE  SPA-GMN-KNSJISGRPKBN          TO  TNS-KNSJISGRPKBN    
      *
           MOVE  SPA-GMN-KENTAICOMMENT         TO  TNS-KENTAICOMMENT   
      *
           MOVE  SPA-GMN-TEIGENKBN             TO  TNS-TEIGENKBN       
      *
           MOVE  SPA-GMN-HOKATUTEIGENKBN       TO  TNS-HOUKATUTEIGENKBN
      *
           MOVE  SPA-GMN-HOUKNSKBN             TO  TNS-HOUKNSKBN       
      *
           MOVE  SPA-GMN-CHPNAISIKSN           TO  TNS-CHPNAISIKSN     
      *
           MOVE  SPA-GMN-NYUKHNKBN             TO  TNS-NYUKHNKBN
      *
           MOVE  SPA-GMN-NYUKHNKSNKBN          TO  TNS-NYUKHNKSNKBN
      *
           MOVE  SPA-GMN-KANGOKSN              TO  TNS-KANGOKSN 
      *
           MOVE  SPA-GMN-CHIIKIKSN             TO  TNS-CHIIKIKSN 
      *H28.4
      *    Èó¿¯½±Åª·ì¹ÔÆ°ÂÖ¥â¥Ë¥¿¥ê¥ó¥°²Ã»»
           MOVE  SPA-GMN-HISINSYUMONKSN    TO  TNS-HISINSYUMONITORKSN
           MOVE  SPA-GMN-TOUKETUHOZONKSN   TO  TNS-TOUKETUHOZONKSN
      *    ÅÀ¿ôÉ½¶èÊ¬ÈÖ¹æ
           MOVE  SPA-GMN-KUBUNBANGOU       TO  TNS-KUBUNBANGOU
      *    Ï«ºÒ»»ÄêÉÔ²Ä
           MOVE  SPA-GMN-ROSAIKBN          TO  TNS-ROSAIKBN
           MOVE  SPA-GMN-SISIKSN           TO  TNS-SISIKSN
      *    °­À­¼ðáçÉÂÍýÁÈ¿¥É¸ËÜ²Ã»»
           MOVE  SPA-GMN-AKUSEIBYORIKSN    TO  TNS-AKUSEIBYORIKSN
      *R02.4
      *    ÁÏ³°¸ÇÄê´ï²Ã»»
           MOVE  SPA-GMN-SOGAIKOTEIKSN     TO  TNS-SOGAIKOTEIKSN
      *    Ä¶²»ÇÈÀÚºï´ï²Ã»»
           MOVE  SPA-GMN-CHPSESSAKUKSN     TO  TNS-CHPSESSAKUKSN
      *    º¸¿´¼ªÊÄº¿½ÑÊ»»Ü¶èÊ¬
           MOVE  SPA-GMN-SASINJIHEISIKBN   TO  TNS-SASINJIHEISIKBN
      *
           PERFORM  VARYING  IDXX
                    FROM  1  BY  1  UNTIL  IDXX  >  10
               MOVE  SPA-GMN-SSTKIJUNCD(IDXX)  TO  TNS-SSTKIJUNCD
                                                           (IDXX)
           END-PERFORM
      *
           MOVE  SPA-GMN-GAITENTTLKBN          TO  TNS-GAITENTTLKBN
           MOVE  SPA-GMN-NYUTENTTLSKB          TO  TNS-NYUTENTTLKBN
           MOVE  SPA-GMN-KOUHYOJYUNNUM         TO  TNS-KOUHYOJYUNNUM
           MOVE  SPA-GMN-CDKBN-KBN             TO  TNS-CDKBN-KBN
           MOVE  SPA-GMN-CDKBN-SYO             TO  TNS-CDKBN-SYO
           MOVE  SPA-GMN-CDKBN-BU              TO  TNS-CDKBN-BU
           MOVE  SPA-GMN-CDKBN-KBNNUM          TO  TNS-CDKBN-KBNNUM
           MOVE  SPA-GMN-CDKBN-KBNNUM-EDA      TO  TNS-CDKBN-KBNNUM-EDA
           MOVE  SPA-GMN-CDKBN-KOUBAN          TO  TNS-CDKBN-KOUBAN
      *
           MOVE  SPA-GMN-KOKUCHI-KBN           TO  TNS-KOKUCHI-KBN
           MOVE  SPA-GMN-KOKUCHI-SYO           TO  TNS-KOKUCHI-SYO
           MOVE  SPA-GMN-KOKUCHI-BU            TO  TNS-KOKUCHI-BU
           MOVE  SPA-GMN-KOKUCHI-KBNNUM        TO  TNS-KOKUCHI-KBNNUM
           MOVE  SPA-GMN-KOKUCHI-KBNNUM-EDA  TO  TNS-KOKUCHI-KBNNUM-EDA
           MOVE  SPA-GMN-KOKUCHI-KOUBAN        TO  TNS-KOKUCHI-KOUBAN
      *
           MOVE  SPA-GMN-KOKUJISKBKBN1         TO  TNS-KOKUJISKBKBN1
           MOVE  SPA-GMN-KOKUJISKBKBN2         TO  TNS-KOKUJISKBKBN2 
      *£È£²£°¡¥£´¤«¤é
      *    °åÎÅ´Ñ»¡Ë¡
           MOVE  SPA-GMN-IRYOKAN           TO  TNS-IRYOKANSATUKBN 
           MOVE  SPA-GMN-GAZOOPESUP        TO  TNS-GAZOOPESUP 
           MOVE  SPA-GMN-MASUISKBKBN       TO  TNS-MASUISKBKBN 
      *H26.4¡¡¤«¤é
      *    £Ä£Ð£Ã¶èÊ¬
           MOVE  SPA-GMN-DPCKBN            TO  TNS-DPCKBN
      *    ÉûÉ¡¹ÐÆâ»ë¶À²Ã»»
           MOVE  SPA-GMN-FUKUBIKUNAIKBN    TO  TNS-FUKUBIKUNAIKBN
      *    ÉûÉ¡¹Ð¼ê½ÑÍÑÀÚ½üµ¡´ï²Ã»»
           MOVE  SPA-GMN-FUKUBIKUKOTUKBN   TO  TNS-FUKUBIKUKOTUKBN
      *    Ä¹»þ´ÖËã¿ì´ÉÍý²Ã»»
           MOVE  SPA-GMN-TIMEMASUIKBN      TO  TNS-TIMEMASUIKBN
      *
           .
      *
       4121-KOUMOKUISO-EXT.
           EXIT.
      *
      *****************************************************************
      *     ÅÀ¿ô¥Þ¥¹¥¿ÉÕ²Ã¾ðÊó¹¹¿·½èÍý
      *****************************************************************
      *4129-TENSUPLUS-UPD-SEC                       SECTION.
      *
      *    INITIALIZE                  ORCGZS02AREA
      *    MOVE    SPA-NAI-YUKOSTYMD   TO  ZS02-NAI-YUKOSTYMD
      *    MOVE    SPA-NAI-YUKOEDYMD   TO  ZS02-NAI-YUKOEDYMD
      *    MOVE    WRK-YUKOEDYMD       TO  ZS02-YUKOEDYMD
      *    ºÎ·ìÎÁ¶èÊ¬
      *    INITIALIZE                  TENSUPLUS-REC
      *    MOVE    SPA-GMN-SAIKETUKBN  TO  TNSP-SAIKETUKBN
      *    MOVE    SPA-GMN-ZENKNSKBN   TO  TNSP-ZENKNSKBN
      *    MOVE    SPA-GMN-INPCHKKBN   TO  TNSP-INPCHKKBN
      *    MOVE    SPA-GMN-PLUS-SANTEIRRK
      *                                TO  TNSP-SANTEIRRKKBN
      *    MOVE    SPA-GMN-PLUS-JGNCNT
      *                                TO  TNSP-JGNCNT
      *    MOVE    SPA-GMN-PLUS-JGNCNT1D
      *                                TO  TNSP-JGNCNT1D
      *    MOVE    SPA-GMN-PLUS-JGNCNT1W
      *                                TO  TNSP-JGNCNT1W
      *    MOVE    SPA-GMN-PLUS-JGNCNTETCM
      *                                TO  TNSP-JGNCNTETCM
      *    MOVE    SPA-GMN-PLUS-JGNCNTETC
      *                                TO  TNSP-JGNCNTETC
      *    MOVE    SPA-GMN-PLUS-JGNCNTERR
      *                                TO  TNSP-JGNCNTERR
      *    Â¾·î¿ô
      *    MOVE    SPA-GMN-PLUS-JGNCNTETCM
      *                                TO  TNSP-JGNCNTETCM
      *    Â¾²ó¿ô
      *    MOVE    SPA-GMN-PLUS-JGNCNTETC
      *                                TO  TNSP-JGNCNTETC
      *    ½èÊýÌ¾¾Î
      *    MOVE    SPA-GMN-SHONAME     TO  TNSP-SHONAME
      *                                    WRK-STRINGTBL
      *    MOVE    100                 TO  CNT-STRING
      *    PERFORM 891-STRCOUNT-SEC
      *    MOVE    CNT-STRING          TO  TNSP-SHOYUKOKETA
      *
      *    ÆþÎÏ¥³¡¼¥É¹¹¿·
      *    CALL    "ORCGZS02"          USING
      *                                MCPAREA
      *                                SPAAREA
      *                                ORCGZS02AREA
      *                                TENSUPLUS-REC
      *
      *    .
      *4129-TENSUPLUS-UPD-EXT.
      **** EXIT.
      *
      *R01.10  ºï½ü¡Ê¸½ºßÂÐ¾Ý¤Ê¤·¤Î°Ù¡Ë
      *****************************************************************
      *  Ï·¿Í°ìÈÌ¥³¡¼¥ÉÊÑ´¹¥Þ¥¹¥¿¹¹¿·
      *****************************************************************
      *41212-SRYCDCHG-UPD-SEC          SECTION.
      *
      *    ¥³¡¼¥Éºï½ü
      *    PERFORM VARYING     IDX     FROM    1   BY  1
      *            UNTIL      (IDX     >   5  )    OR
      *                       (SPA-Z90-IPNSRYCD (IDX)  =   SPACE )
      *        MOVE    SPA-Z90-IPNSRYCD (IDX)  TO  CHG-IPNSRYCD
      *        MOVE    SPA-Z90-RJNSRYCD (IDX)  TO  CHG-RJNSRYCD
      *
      *        MOVE    SPA-HOSPNUM         TO  CHG-HOSPNUM
      *        MOVE    SRYCDCHG-REC        TO  MCPDATA-REC
      *        MOVE    "DBDELETE"          TO  MCP-FUNC
      *        MOVE    "tbl_srycdchg"      TO  MCP-TABLE
      *        MOVE    "key"               TO  MCP-PATHNAME
grpsys*        CALL    "ORCDBMAIN"         USING   MCPAREA
      *                                            MCPDATA-REC
      *                                            SPA-AREA
      *    END-PERFORM
      *
      *    ¥ì¥³¡¼¥ÉÄÉ²Ã
      *    PERFORM VARYING     IDX     FROM    1   BY  1
      *            UNTIL      (IDX     >   5  )    OR
      *                       (SPA-Z90-SRYCDCHG (IDX)  =   SPACE )  OR
      *                       (SPA-ERRCD           NOT =   SPACE )
      *        INITIALIZE                  SRYCDCHG-REC 
      *        EVALUATE    SPA-GMN-ROUTEKKBN
      *            WHEN    1
      *                MOVE    SPA-Z01-SRYCD           TO  CHG-IPNSRYCD
      *                MOVE    SPA-Z90-SRYCDCHG (IDX)  TO  CHG-RJNSRYCD
      *            WHEN    2
      *                MOVE    SPA-Z90-SRYCDCHG (IDX)  TO  CHG-IPNSRYCD
      *                MOVE    SPA-Z01-SRYCD           TO  CHG-RJNSRYCD
      *        END-EVALUATE
      *
      *        IF      CHG-IPNSRYCD        NOT =   SPACE
      *
      *            MOVE    SPA-OPID            TO  CHG-OPID
      *            MOVE    SMCNDATE-YMD        TO  CHG-CREYMD
      *            MOVE    SMCNDATE-YMD        TO  CHG-UPYMD
      *            MOVE    SMCNDATE-HMS        TO  CHG-UPHMS
      *
      *            MOVE    SPA-HOSPNUM         TO  CHG-HOSPNUM
      *            MOVE    SRYCDCHG-REC        TO  MCPDATA-REC
      *            MOVE    "DBINSERT"          TO  MCP-FUNC
      *            MOVE    "tbl_srycdchg"      TO  MCP-TABLE
      *            MOVE    "key"               TO  MCP-PATHNAME
grpsys*            CALL    "ORCDBMAIN"         USING   MCPAREA
      *                                                MCPDATA-REC
      *                                                SPA-AREA
      *            IF      MCP-RC          NOT =   ZERO
      *                MOVE    "9005"              TO  SPA-ERRCD
      *                DISPLAY "Z03 SRYCDCHG INS ERR:"  MCP-RC
      *                        ",KEYU:" CHG-KEY
      *            END-IF
      *        END-IF
      *    END-PERFORM
      *    .    
      *
      *41212-SRYCDCHG-UPD-EXT.
      *    EXIT.
      *
      *****************************************************************
      *    ¼«²èÌÌÊÔ½¸½èÍý
      *****************************************************************
       500-SET-SCREEN-SEC             SECTION.
      *
           PERFORM 500-GMNHEN-SEC
      *
           IF      SPA-ERRCD       NOT =   SPACE
               PERFORM 510-ERRSET-SEC
               GO  TO  500-SET-SCREEN-EXT
           END-IF
      *
           IF      SPA-ZIDCD       NOT =   SPACE
               PERFORM 520-ZIDSET-SEC
               GO  TO  500-SET-SCREEN-EXT
           END-IF
      *
      ***     MOVE  SPA-GMN-CUR           TO  MCP-WIDGET
      *
           MOVE    SPACE               TO  LINKAREA
      *
           MOVE    "CURRENT"           TO  MCP-PUTTYPE.
           MOVE    "Z03    "           TO  MCP-WINDOW.
      *
           PERFORM 900-PUT-WINDOW.
           .
       500-SET-SCREEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½é´ü²èÌÌ¥»¥Ã¥È½èÍý
      *****************************************************************
       500-GMNHEN-SEC                            SECTION.
      *
      *     ²èÌÌ¥ï¡¼¥¯¥¨¥ê¥¢¤Ë¥»¥Ã¥È
           INITIALIZE                            Z03.
      *
           MOVE  SPA-GMN-SRYCDH                TO  Z03-SRYCDH
           MOVE  SPA-GMN-NAMEH                 TO  Z03-NAMEH
           MOVE  SPA-GMN-YUKOSTYMDH            TO  Z03-YUKOSTYMDH
           MOVE  SPA-GMN-YUKOEDYMDH            TO  Z03-YUKOEDYMDH
      *                                         
           MOVE  SPA-GMN-YUKOSTYMD             TO  Z03-YUKOSTYMD
           MOVE  SPA-GMN-YUKOEDYMD             TO  Z03-YUKOEDYMD
           MOVE  SPA-GMN-SRYKBN-G              TO  Z03-SRYKBN   
           MOVE  SPA-GMN-SRYSYUKBN-G           TO  Z03-SRYSYUKBN
           MOVE  SPA-GMN-DATAKBN-G             TO  Z03-DATAKBN  
           MOVE  SPA-GMN-KANANAME              TO  Z03-KANANAME
           MOVE  SPA-GMN-NAME                  TO  Z03-NAME
           MOVE  SPA-GMN-TEN                   TO  Z03-TEN
           MOVE  SPA-GMN-TENSIKIBETU-G         TO  Z03-TENSIKIBETU
           MOVE  SPA-GMN-OLDTEN                TO  Z03-OLDTEN
           MOVE  SPA-GMN-OLDTENSKB-G           TO  Z03-OLDTENSKB
           MOVE  SPA-GMN-TANICD-G              TO  Z03-TANICD
      *****MOVE  SPA-GMN-TANINAME              TO  Z03-TANINAME
           MOVE  SPA-GMN-HKNTEKKBN-G           TO  Z03-HKNTEKKBN   
           MOVE  SPA-GMN-BYOKANRENKBN-G        TO  Z03-BYOKANRENKBN
           MOVE  SPA-GMN-SDOKNRYO-G            TO  Z03-SDOKNRYO    
           MOVE  SPA-GMN-YKZKNRKBN-G           TO  Z03-YKZKNRKBN   
           MOVE  SPA-GMN-NYUGAITEKKBN-G        TO  Z03-NYUGAITEKKBN
           MOVE  SPA-GMN-ROUTEKKBN-G           TO  Z03-ROUTEKKBN   
           MOVE  SPA-GMN-HOSPSRYKBN-G          TO  Z03-HOSPSRYKBN  
           MOVE  SPA-GMN-OSINKBN-G             TO  Z03-OSINKBN     
           MOVE  SPA-GMN-BYOSYOKBN             TO  Z03-BYOSYOKBN   
           MOVE  SPA-GMN-SANTEIRRKKBN-G        TO  Z03-SANTEIRRKKBN
           MOVE  SPA-GMN-TIMEKSNKBN-G          TO  Z03-TIMEKSNKBN  
           MOVE  SPA-GMN-GAIKANRIKBN-G         TO  Z03-GAIKANRIKBN 
           MOVE  SPA-GMN-TSUSOKUAGE            TO  Z03-TSUSOKUAGE  
           MOVE  SPA-GMN-KGNAGE                TO  Z03-KGNAGE      
           MOVE  SPA-GMN-JGNAGE                TO  Z03-JGNAGE      
      *
           MOVE  SPA-GMN-FORMALNAME            TO  Z03-FORMALNAME
           MOVE  SPA-GMN-SHONAME               TO  Z03-SHONAME
      *****MOVE  SPA-GMN-INPCHKKBN             TO  Z03-INPCHKKBN
      *    ºÎ·ìÎÁ¶èÊ¬
           MOVE  SPA-GMN-SAIKETUKBN-G          TO  Z03-SAIKETUKBN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SAIKETUKBN-MAX
               MOVE    SPA-GMN-SAIKETUCOMB (IDX)
                                          TO  Z03-SAIKETUKBN-ITEM(IDX)
           END-PERFORM
           MOVE    SPA-SAIKETUKBN-MAX  TO  Z03-SAIKETUKBN-COUNT
      *    Á°²ó¸¡ººÆü¶èÊ¬
           MOVE  SPA-GMN-ZENKNSKBN-G   TO  Z03-ZENKNSKBN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-ZENKNSKBN-MAX
               MOVE    SPA-GMN-ZENKNSKBN-COMB (IDX)
                                          TO  Z03-ZENKNSKBN-ITEM(IDX)
           END-PERFORM
           MOVE    SPA-ZENKNSKBN-MAX   TO  Z03-ZENKNSKBN-COUNT
      *    ¿ÇÎÅ¶èÊ¬
           MOVE    ZERO                TO  IDX-1
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SRYKBN-MAX
               MOVE    SPA-GMN-SRYKBNCOB (IDX)
                                           TO  Z03-SRYKBN-ITEM(IDX)
           END-PERFORM
           MOVE    SPA-SRYKBN-MAX      TO  Z03-SRYKBN-COUNT
      *
           MOVE    ZERO                TO  IDX-1
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SRYSYUKBN-MAX
               MOVE    SPA-GMN-SRYSYUKBNCOB (IDX)
                                           TO  Z03-SRYSYUKBN-ITEM(IDX)
           END-PERFORM
           MOVE    SPA-SRYSYUKBN-MAX   TO  Z03-SRYSYUKBN-COUNT
      *    ¥Ç¡¼¥¿¶èÊ¬
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-DATAKBN-MAX
               MOVE    SPA-GMN-DATAKBNCOB (IDX)
                                           TO  Z03-DATAKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-DATAKBN-MAX     TO  Z03-DATAKBN-COUNT
      *    ¥Ç¡¼¥¿µ¬³Ê
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-TANICD-MAX
               MOVE    SPA-GMN-TANICDCOB (IDX)
                                            TO  Z03-TANICD-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-TANICD-MAX           TO  Z03-TANICD-COUNT
      *    ÅÀ¿ô¼±ÊÌ
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-TENSIKI-MAX
               MOVE    SPA-GMN-TENSIKIBETUCOB (IDX)
                                       TO  Z03-TENSIKIBETU-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-TENSIKI-MAX     TO  Z03-TENSIKIBETU-COUNT
      *    µìÅÀ¿ô¼±ÊÌ
           MOVE    ZERO                TO  Z03-OLDTENSKB-COUNT
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-OLDTENSKB-MAX
               MOVE    SPA-GMN-OLDTENSKBCOB (IDX)
                                           TO  Z03-OLDTENSKB-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-OLDTENSKB-MAX  TO  Z03-OLDTENSKB-COUNT
      *
      *    ÊÝ¸±Å¬ÍÑ
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-HKNTEKKBN-MAX
               MOVE    SPA-GMN-HKNTEKKBNCOB (IDX)
                                           TO  Z03-HKNTEKKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-HKNTEKKBN-MAX   TO  Z03-HKNTEKKBN-COUNT
      *    ½ýÉÂÌ¾
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-BYOKANRENKBN-MAX
               MOVE    SPA-GMN-BYOKANRENKBNCOB (IDX)
                                           TO  Z03-BYOKANRENKBN-ITEM
                                                             (IDX)
           END-PERFORM
           MOVE    SPA-BYOKANRENKBN-MAX    TO  Z03-BYOKANRENKBN-COUNT
      *    »ØÆ³´ÉÍý
           MOVE    ZERO                TO  IDX-1
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SDOKNRYO-MAX
               IF      SPA-GMN-SDOKNRYOCOB (IDX)   NOT =   SPACE
                   ADD     1               TO  IDX-1
                   MOVE    SPA-GMN-SDOKNRYOCOB (IDX)
                                           TO  Z03-SDOKNRYO-ITEM
                                                         (IDX-1)
               END-IF
           END-PERFORM
           MOVE    SPA-SDOKNRYO-MAX    TO  Z03-SDOKNRYO-COUNT
      *    °åÌôÉÊ´ØÏ¢
           MOVE    ZERO                TO  IDX-1
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-YKZKNRKBN-MAX
               MOVE    SPA-GMN-YKZKNRKBNCOB (IDX)
                                           TO  Z03-YKZKNRKBN-ITEM
                                                         (IDX)
           END-PERFORM
           MOVE    SPA-YKZKNRKBN-MAX   TO  Z03-YKZKNRKBN-COUNT
      *
      *    Æþ³°¶èÊ¬
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-NYUGAITEKKBN-MAX
               MOVE    SPA-GMN-NYUGAITEKKBNCOB (IDX)
                                       TO  Z03-NYUGAITEKKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-NYUGAITEKKBN-MAX    TO  Z03-NYUGAITEKKBN-COUNT
      *    Ï·¿ÍÅ¬±þ
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-ROUTEKKBN-MAX
               MOVE    SPA-GMN-ROUTEKKBNCOB (IDX)
                                           TO  Z03-ROUTEKKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-ROUTEKKBN-MAX       TO  Z03-ROUTEKKBN-COUNT
      *
      *    ÉÂ±¡Å¬±þ
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-HOSPSRYKBN-MAX
               MOVE    SPA-GMN-HOSPSRYKBNCOB (IDX)
                                           TO  Z03-HOSPSRYKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-HOSPSRYKBN-MAX  TO  Z03-HOSPSRYKBN-COUNT
      *
      *    °åÎÅ´Ñ»¡Ë¡
           MOVE    SPA-GMN-IRYOKAN-G   TO  Z03-IRYOKAN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-IRYOKAN-MAX
               MOVE    SPA-GMN-IRYOKANCOB (IDX)
                                           TO  Z03-IRYOKAN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-IRYOKAN-MAX     TO  Z03-IRYOKAN-COUNT
      *    ±ý¿Ç¶èÊ¬
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-OSINKBN-MAX
               MOVE    SPA-GMN-OSINKBNCOB (IDX)
                                           TO  Z03-OSINKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-OSINKBN-MAX     TO  Z03-OSINKBN-COUNT
      *    »»ÄêÍúÎò
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-SANTEIRRKKBN-MAX
               MOVE    SPA-GMN-SANTEIRRKKBNCOB (IDX)
                                       TO  Z03-SANTEIRRKKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-SANTEIRRKKBN-MAX    TO  Z03-SANTEIRRKKBN-COUNT
      *    »þ´Ö³°
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-TIMEKSNKBN-MAX
               MOVE    SPA-GMN-TIMEKSNKBNCOB (IDX)
                                           TO  Z03-TIMEKSNKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-TIMEKSNKBN-MAX      TO  Z03-TIMEKSNKBN-COUNT
      *    ³°Íè´ÉÍý²Ã»»
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-GAIKANRIKBN-MAX
               MOVE    SPA-GMN-GAIKANRIKBNCOB (IDX)
                                       TO  Z03-GAIKANRIKBN-ITEM (IDX)
           END-PERFORM
           MOVE    SPA-GAIKANRIKBN-MAX     TO  Z03-GAIKANRIKBN-COUNT
      *
      *
           MOVE  SPA-GMN-JITUDAY               TO  Z03-JITUDAY        
           MOVE  SPA-GMN-DAYCNT                TO  Z03-DAYCNT         
           MOVE  SPA-GMN-JGNCNT                TO  Z03-JGNCNT         
           MOVE  SPA-GMN-JGNCNT1D              TO  Z03-JGNCNT1D       
           MOVE  SPA-GMN-JGNCNT1W              TO  Z03-JGNCNT1W       
           MOVE  SPA-GMN-JGNCNTETCM            TO  Z03-JGNCNTETCM     
           MOVE  SPA-GMN-JGNCNTETC             TO  Z03-JGNCNTETC      
           MOVE  SPA-GMN-JGNCNTERR             TO  Z03-JGNCNTERR      
      *    ¥æ¡¼¥¶ÀßÄê¾å¸Â²ó¿ô
           MOVE  SPA-GMN-PLUS-SANTEIRRK-G      TO  Z03-PLUS-SANTEIRRK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-PLUS-SANTEI-MAX
               MOVE    SPA-GMN-PLUS-SANTEICOMB (IDX)
                                       TO  Z03-PLUS-SANTEI-ITEM (IDX)
           END-PERFORM
           MOVE  SPA-PLUS-SANTEI-MAX       TO  Z03-PLUS-SANTEI-COUNT
           MOVE  SPA-GMN-PLUS-JGNCNT           TO  Z03-PLUS-JGNCNT
           MOVE  SPA-GMN-PLUS-JGNCNT1D         TO  Z03-PLUS-JGNCNT1D
           MOVE  SPA-GMN-PLUS-JGNCNT1W         TO  Z03-PLUS-JGNCNT1W
           MOVE  SPA-GMN-PLUS-JGNCNTETCM       TO  Z03-PLUS-JGNCNTETCM
           MOVE  SPA-GMN-PLUS-JGNCNTETC        TO  Z03-PLUS-JGNCNTETC
           MOVE  SPA-GMN-PLUS-JGNCNTERR        TO  Z03-PLUS-JGNCNTERR 
      *
           MOVE  SPA-GMN-KZMCOMPSIKIBETU       TO  Z03-KZMCOMPSIKIBETU
           MOVE  SPA-GMN-KZMKGN                TO  Z03-KZMKGN         
           MOVE  SPA-GMN-KZMJGN                TO  Z03-KZMJGN         
           MOVE  SPA-GMN-KZM                   TO  Z03-KZM            
           MOVE  SPA-GMN-KZMTEN                TO  Z03-KZMTEN         
           MOVE  SPA-GMN-KZMERR                TO  Z03-KZMERR         
           MOVE  SPA-GMN-CHUKSNCD              TO  Z03-CHUKSNCD       
           MOVE  SPA-GMN-CHUKSNTSUBAN          TO  Z03-CHUKSNTSUBAN   
           MOVE  SPA-GMN-AGEKSNKGN(1)          TO  Z03-AGEKSNKGN1
           MOVE  SPA-GMN-AGEKSNJGN(1)          TO  Z03-AGEKSNJGN1
           MOVE  SPA-GMN-AGEKSNSRYCD(1)        TO  Z03-AGEKSNSRYCD1
           MOVE  SPA-GMN-AGEKSNKGN(2)          TO  Z03-AGEKSNKGN2
           MOVE  SPA-GMN-AGEKSNJGN(2)          TO  Z03-AGEKSNJGN2
           MOVE  SPA-GMN-AGEKSNSRYCD(2)        TO  Z03-AGEKSNSRYCD2
           MOVE  SPA-GMN-AGEKSNKGN(3)          TO  Z03-AGEKSNKGN3
           MOVE  SPA-GMN-AGEKSNJGN(3)          TO  Z03-AGEKSNJGN3
           MOVE  SPA-GMN-AGEKSNSRYCD(3)        TO  Z03-AGEKSNSRYCD3
           MOVE  SPA-GMN-AGEKSNKGN(4)          TO  Z03-AGEKSNKGN4
           MOVE  SPA-GMN-AGEKSNJGN(4)          TO  Z03-AGEKSNJGN4
           MOVE  SPA-GMN-AGEKSNSRYCD(4)        TO  Z03-AGEKSNSRYCD4
      *                                          
           MOVE  SPA-GMN-TUSOKUGAIKBN          TO  Z03-TUSOKUGAIKBN    
           MOVE  SPA-GMN-LASERKSN              TO  Z03-LASERKSN        
           MOVE  SPA-GMN-CHPMESUKSN            TO  Z03-CHPMESUKSN      
           MOVE  SPA-GMN-MICMESUKSN            TO  Z03-MICMESUKSN      
           MOVE  SPA-GMN-DONORKBN              TO  Z03-DONORKBN      
           MOVE  SPA-GMN-SEKIZUISOKUTEI        TO  Z03-SEKIZUISOKUTEI  
           MOVE  SPA-GMN-KEIBUJYUTU            TO  Z03-KEIBUJYUTU      
           MOVE  SPA-GMN-AUTOHOUGO             TO  Z03-AUTOHOUGO       
           MOVE  SPA-GMN-AUTOFUNGO             TO  Z03-AUTOFUNGO       
           MOVE  SPA-GMN-CHPGYOKOSOTIKSN       TO  Z03-CHPGYOKOSOTIKSN 
           MOVE  SPA-GMN-SHORTSTAYOPE          TO  Z03-SHORTSTAYOPE    
      *    ²èÁüÅù¼ê½Ñ»Ù±ç²Ã»»
           MOVE    SPA-GMN-GAZOOPESUP      TO  Z03-GAZOOPESUP
           MOVE    SPA-GMN-MASUISKBKBN     TO  Z03-MASUISKBKBN
      *    »ÜÀß´ð½àÉÔÅ¬¹ç¶èÊ¬
           MOVE  SPA-GMN-KIJUNTEIGENKBN    TO  Z03-KIJUNTEIGENKBN
      *     ´ð½àÉÔÅ¬¹çÄþ¸ºÂÐ¾Ý»ÜÀß´ð½à¥³¡¼¥É
           MOVE  SPA-GMN-KIJUNTEIGENCD     TO  Z03-KIJUNTEIGENCD    
           MOVE  SPA-GMN-KNSJISKBN             TO  Z03-KNSJISKBN       
           MOVE  SPA-GMN-KNSJISGRPKBN          TO  Z03-KNSJISGRPKBN    
           MOVE  SPA-GMN-KENTAICOMMENT         TO  Z03-KENTAICOMMENT   
           MOVE  SPA-GMN-TEIGENKBN             TO  Z03-TEIGENKBN       
           MOVE  SPA-GMN-HOKATUTEIGENKBN       TO  Z03-HOKATUTEIGENKBN 
           MOVE  SPA-GMN-HOUKNSKBN             TO  Z03-HOUKNSKBN       
           MOVE  SPA-GMN-CHPNAISIKSN           TO  Z03-CHPNAISIKSN     
           MOVE  SPA-GMN-NYUKHNKBN             TO  Z03-NYUKHNKBN
           MOVE  SPA-GMN-NYUKHNKSNKBN          TO  Z03-NYUKHNKSNKBN
           MOVE  SPA-GMN-KANGOKSN              TO  Z03-KANGOKSN 
           MOVE  SPA-GMN-CHIIKIKSN             TO  Z03-CHIIKIKSN       
      *    Èó¿¯½±Åª·ì¹ÔÆ°ÂÖ¥â¥Ë¥¿¥ê¥ó¥°²Ã»»                                      
           MOVE  SPA-GMN-HISINSYUMONKSN        TO  Z03-HISINSYUMONKSN       
           MOVE  SPA-GMN-TOUKETUHOZONKSN       TO  Z03-TOUKETUHOZONKSN       
           MOVE  SPA-GMN-KUBUNBANGOU           TO  Z03-KUBUNBANGOU       
      *    Ï«ºÒ»»ÄêÉÔ²Ä
           MOVE  SPA-GMN-ROSAIKBN              TO  Z03-ROSAIKBN
           MOVE  SPA-GMN-SISIKSN               TO  Z03-SISIKSN
      *H30.4
      *    °­À­¼ðáçÉÂÍýÁÈ¿¥É¸ËÜ²Ã»»
           MOVE  SPA-GMN-AKUSEIBYORIKSN        TO  Z03-AKUSEIBYORIKSN
      *R02.4
      *    ÁÏ³°¸ÇÄê´ï²Ã»»
           MOVE  SPA-GMN-SOGAIKOTEIKSN         TO  Z03-SOGAIKOTEIKSN
      *    Ä¶²»ÇÈÀÚºï´ï²Ã»»
           MOVE  SPA-GMN-CHPSESSAKUKSN         TO  Z03-CHPSESSAKUKSN
      *    º¸¿´¼ªÊÄº¿½ÑÊ»»Ü¶èÊ¬
           MOVE  SPA-GMN-SASINJIHEISIKBN       TO  Z03-SASINJIHEISIKBN
      *                                          
           MOVE  SPA-GMN-SSTKIJUNCD(1)         TO  Z03-SSTKIJUNCD1     
           MOVE  SPA-GMN-SSTKIJUNCD(2)         TO  Z03-SSTKIJUNCD2     
           MOVE  SPA-GMN-SSTKIJUNCD(3)         TO  Z03-SSTKIJUNCD3     
           MOVE  SPA-GMN-SSTKIJUNCD(4)         TO  Z03-SSTKIJUNCD4     
           MOVE  SPA-GMN-SSTKIJUNCD(5)         TO  Z03-SSTKIJUNCD5     
           MOVE  SPA-GMN-SSTKIJUNCD(6)         TO  Z03-SSTKIJUNCD6     
           MOVE  SPA-GMN-SSTKIJUNCD(7)         TO  Z03-SSTKIJUNCD7     
           MOVE  SPA-GMN-SSTKIJUNCD(8)         TO  Z03-SSTKIJUNCD8     
           MOVE  SPA-GMN-SSTKIJUNCD(9)         TO  Z03-SSTKIJUNCD9     
           MOVE  SPA-GMN-SSTKIJUNCD(10)        TO  Z03-SSTKIJUNCD10    
           MOVE  SPA-GMN-GAITENTTLKBN          TO  Z03-GAITENTTLKBN    
           MOVE  SPA-GMN-NYUTENTTLSKB          TO  Z03-NYUTENTTLSKB
           MOVE  SPA-GMN-KOUHYOJYUNNUM         TO  Z03-KOUHYOJYUNNUM   
           MOVE  SPA-GMN-CDKBN-KBN             TO  Z03-CDKBN-KBN       
           MOVE  SPA-GMN-CDKBN-SYO             TO  Z03-CDKBN-SYO       
           MOVE  SPA-GMN-CDKBN-BU              TO  Z03-CDKBN-BU        
           MOVE  SPA-GMN-CDKBN-KBNNUM          TO  Z03-CDKBN-KBNNUM    
           MOVE  SPA-GMN-CDKBN-KBNNUM-EDA      TO  Z03-CDKBN-KBNNUM-EDA
           MOVE  SPA-GMN-CDKBN-KOUBAN          TO  Z03-CDKBN-KOUBAN    
           MOVE  SPA-GMN-KOKUCHI-KBN           TO  Z03-KOKUCHI-KBN     
           MOVE  SPA-GMN-KOKUCHI-SYO           TO  Z03-KOKUCHI-SYO     
           MOVE  SPA-GMN-KOKUCHI-BU            TO  Z03-KOKUCHI-BU      
           MOVE  SPA-GMN-KOKUCHI-KBNNUM        TO  Z03-KOKUCHI-KBNNUM  
           MOVE  SPA-GMN-KOKUCHI-KBNNUM-EDA    TO
                                               Z03-KOKUCHI-KBNNUM-EDA
           MOVE  SPA-GMN-KOKUCHI-KOUBAN        TO  Z03-KOKUCHI-KOUBAN  
           MOVE  SPA-GMN-KOKUJISKBKBN1         TO  Z03-KOKUJISKBKBN1   
           MOVE  SPA-GMN-KOKUJISKBKBN2         TO  Z03-KOKUJISKBKBN2   
      *H26.4
      *    £Ä£Ð£Ã¶èÊ¬
           MOVE    SPA-GMN-DPCKBN          TO  Z03-DPCKBN
      *    ÉûÉ¡¹Ð¼ê½ÑÍÑÆâ»ë¶À²Ã»»
           MOVE    SPA-GMN-FUKUBIKUNAIKBN  TO  Z03-FUKUBIKUNAIKBN
      *    ÉûÉ¡¹Ð¼ê½ÑÍÑÆð¹üÉôÁÈ¿¥ÀÚ½üµ¡´ï²Ã»»
           MOVE    SPA-GMN-FUKUBIKUKOTUKBN TO  Z03-FUKUBIKUKOTUKBN
      *    Ä¹»þ´ÖËã¿ì´ÉÍý²Ã»»
           MOVE    SPA-GMN-TIMEMASUIKBN    TO  Z03-TIMEMASUIKBN
      *H29.1
      *    ¥æ¡¼¥¶¡¼
           IF      SPA-MASTER-CLASS    =   2
               MOVE    "¡Ú¥æ¡¼¥¶¡¼´ÉÍý¡Û"  TO  Z03-MIDASHI-DATA
               MOVE    "red"               TO  Z03-MIDASHI-STYLE
           END-IF
      *
           PERFORM 5001-MAPCUR-SEC
      *H29.1
      *    ¥æ¡¼¥¶¡¼ÅÀ¿ô¼±ÊÌ¡Ê¥æ¡¼¥¶¡¼¥Þ¥¹¥¿¡Ë¤Î¤ß¹¹¿·
           IF     (SPA-MASTER-CLASS    =   2 )
               OR (SPA-MENTE-OK        =   1 )
               MOVE    WIDGET-NORMAL           TO  Z03-B12-STATE
               MOVE    WIDGET-NORMAL           TO  Z03-B03-STATE
           ELSE
      ****     MOVE    WIDGET-INSENSITIVE      TO  Z03-B12-STATE
               MOVE    WIDGET-NORMAL           TO  Z03-B12-STATE
               MOVE    WIDGET-INSENSITIVE      TO  Z03-B03-STATE
           END-IF
      *H30.9
      *    ¿·µ¬¡¦²þÀµ½èÍý¤Ïºï½ü¤Ê¤·
           IF      SPA-Z01-SYORIKBN    =   1
                                       OR  3
               MOVE    WIDGET-INSENSITIVE      TO  Z03-B03-STATE
           END-IF
      *
           MOVE  SPA-GMN-PAGENO                TO  Z03-PAGENO
      *
           .
       500-GMNHEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ¥«¡¼¥½¥ë¥»¥Ã¥È½èÍý
      *****************************************************************
       5001-MAPCUR-SEC             SECTION.
      *
      *R01.10
      *    Á°²ó¸¡ººÆü¤ÎÊÑ¹¹»þ¤Î¤ß¡¢¡Ö¥æ¡¼¥¶¡¼¡×¤Ø
           IF     (FLG-USERIN          =   1     )
            AND   (SPA-ERRCD           =   SPACE )
               MOVE    "B10"               TO  MCP-WIDGET
               GO      TO  5001-MAPCUR-EXT
           END-IF
      *
      *    ¥¨¥é¡¼°ÌÃÖ·èÄê
           IF      SPA-GMN-CUR         >   ZERO
               CONTINUE
           ELSE
               IF     (SPA-GMN-CUR         =   ZERO )  AND
                      (WRK-MCP-WIDGET      =   SPACE )
      *            ³Æ¥¿¥°¤Î½é´ü°ÌÃÖ
                   SET     IDX-GMN             TO  1
                   SEARCH      TBL-GMN-OCC     VARYING   IDX-GMN
                       AT  END
                           MOVE    ZERO            TO  SPA-GMN-CUR
                       WHEN    SPA-GMN-PAGENO  =   TBL-PAGE  (IDX-GMN)
                           MOVE    IDX-GMN         TO  SPA-GMN-CUR
                   END-SEARCH 
               ELSE
      *            º£²óÆþÎÏ°ÌÃÖ¤è¤ê¼¡¤Î¥«¡¼¥½¥ëÀßÄê
                   SET     IDX-GMN             TO  1
                   SEARCH      TBL-GMN-OCC     VARYING   IDX-GMN
                       AT  END
                           MOVE    ZERO            TO  SPA-GMN-CUR
                       WHEN    WRK-MCP-WIDGET  =   TBL-WIDGET (IDX-GMN)
                           MOVE    IDX-GMN         TO  SPA-GMN-CUR
                   END-SEARCH
      *            ¥¨¥é¡¼°Ê³°
                   IF      SPA-ERRCD           =   SPACE
                     ADD     1                   TO  SPA-GMN-CUR
      *              ºÎ·ìÎÁ¶èÊ¬¤Ï¡¢¸¡ºº¤Î»þ¤Î¤ß¥«¡¼¥½¥ë°ÜÆ°¤È¤¹¤ë
                     IF     (SPA-GMN-CUR             <=  TBL-GMN-MAX )
                       AND  (TBL-WIDGET(SPA-GMN-CUR) =   "SAIKETUKBN" )
                       AND  (SPA-GMN-SRYKBN      NOT =   "60"  )
                       ADD     1                   TO  SPA-GMN-CUR
                     END-IF
                   END-IF
               END-IF
           END-IF
      *
           IF      SPA-GMN-CUR         >   TBL-GMN-MAX
               MOVE    "B12"               TO  MCP-WIDGET
           ELSE
               SET     IDX-GMN                 TO  SPA-GMN-CUR
               MOVE    TBL-WIDGET (IDX-GMN)    TO  MCP-WIDGET
               MOVE    TBL-PAGE   (IDX-GMN)    TO  SPA-GMN-PAGENO
           END-IF
      *
           .
       5001-MAPCUR-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¨¥é¡¼¥á¥Ã¥»¡¼¥¸É½¼¨½èÍý
      *****************************************************************
       510-ERRSET-SEC                            SECTION.
      *
           MOVE    SPACE               TO  SPA-ERRMSG
      *
           EVALUATE    SPA-ERRCD
               WHEN    "0001"
                   MOVE    "Í­¸ú³«»ÏÇ¯·îÆü¤¬°ã¤¤¤Þ¤¹"
                                                 TO  SPA-ERRMSG
               WHEN    "0002"
                   MOVE    "Í­¸ú½ªÎ»Ç¯·îÆü¤¬°ã¤¤¤Þ¤¹"
                                                 TO  SPA-ERRMSG
               WHEN    "0003"
                   MOVE    "¥«¥ÊÌ¾¾Î¤ÏÁ´³Ñ¤ÇÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                                 TO  SPA-ERRMSG
               WHEN    "0004"
                   MOVE    "´Á»úÌ¾¾Î¤ÏÁ´³Ñ¤ÇÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                                 TO  SPA-ERRMSG
               WHEN    "0005"
                   MOVE    "Àµ¼°Ì¾¾Î¤ÏÁ´³Ñ¤ÇÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                                 TO  SPA-ERRMSG
               WHEN    "0010"
                   MOVE    "½ÐÎÏÌ¾¾Î¤ÏÁ´³Ñ¤ÇÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                                 TO  SPA-ERRMSG
      *
               WHEN    "0006"
                   MOVE    "ÁªÂò¼ïÊÌ¤¬¤¢¤ê¤Þ¤»¤ó"
                                                 TO  SPA-ERRMSG
               WHEN    "0007"
                   MOVE    "¿ô»ú¤Î¤ßÆþÎÏ²ÄÇ½¤Ç¤¹"
                                                 TO  SPA-ERRMSG
               WHEN    "0011"
                   MOVE    "¿ÇÎÅ¶èÊ¬¤¬ÅÐÏ¿¤µ¤ì¤Æ¤¤¤Þ¤»¤ó"
                                                 TO  SPA-ERRMSG
               WHEN    "0012"
                   MOVE    "¿ÇÎÅ¼ïÊÌ¤¬ÅÐÏ¿¤µ¤ì¤Æ¤¤¤Þ¤»¤ó"
                                                 TO  SPA-ERRMSG
               WHEN    "0013"
                   MOVE    "Ã±°Ì¤¬¤¢¤ê¤Þ¤»¤ó"
                                                 TO  SPA-ERRMSG
               WHEN    "0014"
                   MOVE    "ºÎ·ìÎÁ¶èÊ¬¤Ï¸¡ºº¤Î¤ß¤ÎÆþÎÏ¤Ç¤¹¡£"
                                                 TO  SPA-ERRMSG
               WHEN    "0020"
                   MOVE    "Ï·¿Í°ìÈÌ¥³¡¼¥ÉÊÑ´¹¹¹¿·¥¨¥é¡¼"
                                                 TO  SPA-ERRMSG
               WHEN    "0021"
                   MOVE    "Ï·¿Í°ìÈÌ¥³¡¼¥ÉÊÑ´¹¤Ï¤Ç¤­¤Þ¤»¤ó"
                                                 TO  SPA-ERRMSG
      *R01.10 
               WHEN    "0022"
                   MOVE    "Ï·¿Í°ìÈÌ¥³¡¼¥ÉÊÑ´¹¤Ï¤¢¤ê¤Þ¤»¤ó¡£"
                                                 TO  SPA-ERRMSG
      *
               WHEN    "0025"
                   MOVE    "ÄÌÂ§Ç¯Îð¤Ï£°¡¢£±¤Î¤ßÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                                 TO  SPA-ERRMSG
               WHEN    "0015"
                   MOVE    "¥¨¥é¡¼½èÍý¤Ï¡¢£°¡¢£¹¤Î¤ßÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                                 TO  SPA-ERRMSG
               WHEN    "0016"
                   STRING  "¥æ¡¼¥¶¡¼ÀßÄê¤¬Í­¸ú¤Ë¤Ê¤Ã¤Æ¤¤¤Þ¤»¤ó¡£"
                           "Í­¸ú¤Ë¤·¤Æ²¼¤µ¤¤¡£"
                                                 DELIMITED  BY  SIZE
                                                 INTO  SPA-ERRMSG
                   END-STRING
               WHEN    "0017"
                   STRING  "¥æ¡¼¥¶¡¼ÀßÄê¤Î¾å¸Â²ó¿ô¤¬ÀßÄê¤µ¤ì¤Æ¤¤¤Þ¤»¤ó"
                           "¡£ÀßÄê¤·¤Æ²¼¤µ¤¤¡£"
                                                 DELIMITED  BY  SIZE
                                                 INTO  SPA-ERRMSG
                   END-STRING
               WHEN    "0018"
                   STRING  "¾å¸Â²ó¿ô¤¬¥¼¥í¤Ç¤Ï¤¢¤ê¤Þ¤»¤ó¡£"
                           "¥æ¡¼¥¶ÀßÄê¤Î¾å¸Â²ó¿ô¤Ï¥¼¥í¤Ë¤Ç¤­¤Þ¤»¤ó¡£"
                                                 DELIMITED  BY  SIZE
                                                 INTO  SPA-ERRMSG
                   END-STRING
               WHEN    "0019"
                   STRING  "¥·¥¹¥Æ¥àÍ½Ìó¥³¡¼¥É¤Ï¥æ¡¼¥¶ÀßÄê¤Ç¤­¤Þ¤»¤ó¡£"
                                                 DELIMITED  BY  SIZE
                                                 INTO  SPA-ERRMSG
                   END-STRING
      *
               WHEN    "K100"
                   STRING   "·Ù¹ð¡ª»»ÄêÍúÎòºîÀ®¤ÎÀßÄê¤¬¤¢¤ê¤Þ¤»¤ó¡£"
                            "Á°²ó¤ÎÈ½Äê¤¬¤Ç¤­¤Þ¤»¤ó¡£"
                                                   DELIMITED BY  SIZE
                                                 INTO    SPA-ERRMSG
                   END-STRING
      *H29.1
               WHEN    "0050"
                   STRING   "¥æ¡¼¥¶¡¼ÀßÄê¤Ï¤Ç¤­¤Þ¤»¤ó¡£"
                                                   DELIMITED BY  SIZE
                                                 INTO    SPA-ERRMSG
                   END-STRING
               WHEN    "0051"
                   STRING    "¸üÀ¸Ï«Æ¯¾Ê¤«¤éÄó¶¡¤µ¤ì¤ëÈÏ°Ï¤Î¥³¡¼¥É¤Ç¤¹"
                             "¡£Í­¸úÇ¯·îÆü¤ÎÊÑ¹¹¤Ï¤·¤Ê¤¤¤Ç²¼¤µ¤¤¡£"
                                                   DELIMITED BY  SIZE
                                                 INTO    SPA-ERRMSG
                   END-STRING
      *
      *        °Ê²¼¶¦ÄÌ
               WHEN    "1010"
                   MOVE
                   "Í­¸ú³«»ÏÇ¯·îÆü¡æÍ­¸ú½ªÎ»Ç¯·îÆü¤ÇÆþÎÏ¤·¤Æ²¼¤µ¤¤"
                                                 TO  SPA-ERRMSG
               WHEN    "1011"
                   MOVE    "Í­¸úÇ¯·îÆü¤ÎÈÏ°Ï¤¬°ã¤¤¤Þ¤¹"
                                                 TO  SPA-ERRMSG
               WHEN    "1012"
                   MOVE    "Í­¸úÇ¯·îÆü¤¬½ÅÊ£¤·¤Æ¤¤¤Þ¤¹"
                                                 TO  SPA-ERRMSG
               WHEN    "1013"
                   MOVE    "²þÀµ¤Î½ªÎ»Ç¯·îÆü¤Ï£Á£Ì£Ì£¹¤Î¤ßÆþÎÏ¤Ç¤­¤Þ¤¹"
                                                 TO  SPA-ERRMSG
               WHEN    "1014"
                   MOVE    "´Á»úÌ¾¾Î¤òÆþÎÏ¤·¤Æ¤¯¤À¤µ¤¤"
                                                 TO  SPA-ERRMSG
              WHEN    "1001"
                   MOVE    "ÆþÎÏ¥³¡¼¥É¹¹¿·¥¨¥é¡¼"
                                                 TO  SPA-ERRMSG
               WHEN    "9001"
                   MOVE    "ºï½ü½èÍý¤¬¼ºÇÔ¤·¤Þ¤·¤¿"
                                                 TO  SPA-ERRMSG
               WHEN    "9002"
                   MOVE    "¹¹¿·½èÍý¤¬¼ºÇÔ¤·¤Þ¤·¤¿"
                                                 TO  SPA-ERRMSG
               WHEN    "9003"
                   MOVE    "ÄÉ²Ã½èÍý¤¬¼ºÇÔ¤·¤Þ¤·¤¿"
                                                 TO  SPA-ERRMSG
               WHEN    "9004"
                   MOVE    "ÅÀ¿ô¥Þ¥¹¥¿ÉÕ²Ã¾ðÊó¤¬¹¹¿·¤Ç¤­¤Þ¤»¤ó"
                                                 TO  SPA-ERRMSG
               WHEN    "9005"
                   MOVE    "Ï·¿Í°ìÈÌÃÖ´¹¾ðÊó¤¬¹¹¿·¤Ç¤­¤Þ¤»¤ó"
                                                 TO  SPA-ERRMSG
               WHEN    "K001"
                   STRING    "·Ù¹ð¡ª¸üÀ¸Ï«Æ¯¾Ê¤«¤éÄó¶¡¤µ¤ì¤ë"
                             "¥³¡¼¥É¤ÎÈÏ°Ï¤Ç¤¹¡£"
                             "¿·µ¬ÅÐÏ¿¤Ï¤·¤Ê¤¤¤Ç²¼¤µ¤¤¡£"
                                                   DELIMITED BY  SIZE
                                                 INTO    SPA-ERRMSG
                   END-STRING
               WHEN    "K002"
                   STRING    "·Ù¹ð¡ª¥æ¡¼¥¶ÅÐÏ¿¤Ç¤­¤ëÈÏ°Ï¤Î¥³¡¼¥É"
                             "¤Ç¤Ï¤¢¤ê¤Þ¤»¤ó¡£"
                             "¿·µ¬ÅÐÏ¿¤Ï¤·¤Ê¤¤¤Ç²¼¤µ¤¤¡£"
                                                   DELIMITED BY  SIZE
                                                 INTO    SPA-ERRMSG
                   END-STRING
               WHEN    "K003"
                   STRING   "·Ù¹ð¡ª¸üÀ¸Ï«Æ¯¾Ê¤«¤éÄó¶¡¤µ¤ì¤¿¥Ç¡¼¥¿¤Ç¤¹¡£"
                            "ºï½ü¤·¤Ê¤¤¤Ç²¼¤µ¤¤¡£"
                                                   DELIMITED BY  SIZE
                                                 INTO    SPA-ERRMSG
                   END-STRING
      *H24.8
               WHEN    "K004"
                   STRING    "·Ù¹ð¡ª"
                             "¸üÀ¸Ï«Æ¯¾Ê¤«¤éÄó¶¡¤µ¤ì¤ëÈÏ°Ï¤Î¥³¡¼¥É¤Ç¤¹"
                             "¡£Í­¸úÇ¯·îÆü¤ÎÊÑ¹¹¤Ï¤·¤Ê¤¤¤Ç²¼¤µ¤¤¡£"
                                                   DELIMITED BY  SIZE
                                                 INTO    SPA-ERRMSG
                   END-STRING
               WHEN    "K005"
                   STRING    "·Ù¹ð¡ª"
                             "¸üÀ¸Ï«Æ¯¾Ê¤«¤éÄó¶¡¤µ¤ì¤ëÈÏ°Ï¤Î¥³¡¼¥É¤Ç¤¹"
                             "¡£²þÀµ½èÍý¤Ï¤·¤Ê¤¤¤Ç²¼¤µ¤¤¡£"
                                                   DELIMITED BY  SIZE
                                                 INTO    SPA-ERRMSG
                   END-STRING
           END-EVALUATE.
      *
           MOVE    SPACE               TO  ZERR
           MOVE    SPA-ERRCD           TO  ZERR-ERRCODE
           MOVE    SPA-ERRMSG          TO  ZERR-ERRMSG
      *
           MOVE    "Z03"               TO  SPA-MOTOPG
           MOVE    "ZERR"              TO  SPA-SAKIPG
      *
           MOVE    "NEW"               TO  MCP-PUTTYPE
           MOVE    "ZERR"              TO  MCP-WINDOW
           MOVE    "B01"               TO  MCP-WIDGET
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                   TO  FLG-END
           .
       510-ERRSET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³ÎÇ§¥á¥Ã¥»¡¼¥¸É½¼¨Íý
      *****************************************************************
       520-ZIDSET-SEC              SECTION.
      *
           MOVE    SPACE               TO  WRK-ZIDMSG
      *
           EVALUATE    SPA-ZIDCD
               WHEN    "0001"
                   MOVE    "ºï½ü¤·¤Þ¤¹¡£¤è¤í¤·¤¤¤Ç¤¹¤«¡©"
                                                       TO  WRK-ZIDMSG
               WHEN    "0002"
                   MOVE    "¹¹¿·¤·¤Þ¤¹¡£¤è¤í¤·¤¤¤Ç¤¹¤«¡©"
                                                       TO  WRK-ZIDMSG
           END-EVALUATE
      *
           MOVE    SPACE                TO  ZID1
           INITIALIZE                       ZID1
           MOVE    SPA-ZIDCD            TO  ZID1-ID1CODE
           MOVE    WRK-ZIDMSG           TO  ZID1-ID1MSG
           MOVE    "B12"                TO  MCP-WIDGET
      *
           MOVE    "Z03"                TO  SPA-MOTOPG
           MOVE    "ZID1"               TO  SPA-SAKIPG
      *
           MOVE    "NEW"                TO  MCP-PUTTYPE
           MOVE    "ZID1"               TO  MCP-WINDOW
      *
           PERFORM 900-PUT-WINDOW
      *
           MOVE    1                    TO  FLG-END              
      *
           .
       520-ZIDSET-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    £Ä£Â¡¡½èÍý
      *****************************************************************
      *
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿ÆÉ¹þ½èÍý
      *****************************************************************
       900-TENSU-READ-SEC              SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  TNS-TENSU-REC
               MOVE    ZERO            TO  FLG-TENSU
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1               TO  FLG-TENSU
           END-IF
           .
      *
       900-TENSU-READ-EXT.
           EXIT.
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿ÉÕ²Ã¾ðÊóÆÉ¹þ
      *****************************************************************
       990-TENSUPLUS-READ-SEC          SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  TENSUPLUS-REC
               MOVE    ZERO            TO  FLG-TENSUPLUS
           ELSE
               INITIALIZE                  TENSUPLUS-REC
               MOVE    1               TO  FLG-TENSUPLUS
           END-IF
           .    
      *
       990-TENSUPLUS-READ-EXT.
           EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¸¡º÷½èÍý
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"      TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£ÂÆÉ¤ß¹þ¤ß½èÍý
      *****************************************************************
       920-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
      *
       920-DBFETCH-EXT.
           EXIT.
      *****************************************************************
      *   £Ä£Â¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       990-DBLOSEC-SEC                 SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
       990-DBLOSEC-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆüÉÕÊÑ´¹¡¡½èÍý
      *****************************************************************
      *****************************************************************
      *     ÂÐ¾ÝÆü¡Ü£±Æü·×»»½èÍý
      *****************************************************************
       800-DAYSET-SEC                  SECTION.
      *
           INITIALIZE                      STS-AREA-DAY
           EVALUATE    WRK-YMD
               WHEN    ZERO
                   MOVE    ZERO            TO  WRK-OTYMD
               WHEN    "99999999"
                   MOVE    ALL "9"         TO  WRK-OTYMD
               WHEN    OTHER
                   INITIALIZE                  STS-AREA-DAY
                   INITIALIZE                  LNK-DAY6-AREA
                   MOVE    "61"                TO  LNK-DAY6-IRAI
                   MOVE    WRK-YMD             TO  LNK-DAY6-KIJUN
                   MOVE    "1"                 TO  LNK-DAY6-ZOGENPTN
                   MOVE    1                   TO  LNK-DAY6-ZOGEN
                   CALL  "ORCSDAY"             USING   STS-AREA-DAY
                                                       LNK-DAY6-AREA
                  MOVE    LNK-DAY6-KEISAN      TO  WRK-OTYMD
           END-EVALUATE
      *
           .
       800-DAYSET-EXT.
           EXIT.
      *
      *****************************************************************
      *   ÏÂÎñÇ¯·îÆü¢ªÀ¾ÎñÇ¯·îÆü¡Êµ¡Ç½£±£²¡Ë
      *****************************************************************
       831-YMDCONV12-SEC                         SECTION.
      *
           MOVE    ZERO                TO  FLG-ERR
           INITIALIZE                            STS-AREA-DAY
           EVALUATE  WRK-LNKYMD(1:7)
               WHEN  ZERO
                   MOVE  ZERO                    TO  WRK-SYMD
               WHEN  "9999999"
                   MOVE  ALL "9"                 TO  WRK-SYMD
               WHEN  OTHER
      *
      *************IF  WRK-LNKYMD(1:7)           NOT NUMERIC
      *                MOVE    WRK-LNKYMD(1:1)   TO  WRK-WGO
      *                MOVE    WRK-LNKYMD(2:2)   TO  WRK-WYY
      *                MOVE    WRK-LNKYMD(5:2)   TO  WRK-WMM
      *                MOVE    WRK-LNKYMD(8:2)   TO  WRK-WDD
      *                INSPECT  WRK-WYMD  REPLACING   ALL " " BY  "0"
      *            ELSE
      *                MOVE    WRK-LNKYMD(1:7)   TO  WRK-WYMD
      *            END-IF
      *            INITIALIZE                    LNK-DAY1-AREA
      *            MOVE  "12"                    TO  LNK-DAY1-IRAI
      *            MOVE  ZERO                    TO  LNK-DAY1-YMD
      *            MOVE  WRK-WYMD                TO  LNK-DAY1-YMD(2:7)
      *            CALL  "ORCSDAY"               USING   STS-AREA-DAY
      *                                          LNK-DAY1-AREA
      *            IF      STS-DAY-RC1           =   ZERO
      *                MOVE    LNK-DAY1-YMD        TO  WRK-SYMD
      *************END-IF
      *----(01.00.01) LINE ADD START --------------------------------
      *            ÆüÉÕ²èÌÌ¥Á¥§¥Ã¥¯¥µ¥Ö
                   INITIALIZE                      ORCSGDAYAREA
                   MOVE    WRK-LNKYMD          TO  SGDAY-INDAY
                   CALL    "ORCSGDAY"          USING
                                               ORCSGDAYAREA
                   IF      SGDAY-RC            =   ZERO
                       MOVE    ZERO                TO  FLG-ERR
                       MOVE    SGDAY-OTDAY         TO  WRK-LNKYMD
                       MOVE    SGDAY-SDAY          TO  WRK-SYMD
                   ELSE
                       MOVE    1                   TO  FLG-ERR
                   END-IF
      *----(01.00.01) LINE ADD END   --------------------------------
           END-EVALUATE
           .    
      *
       831-YMDCONV12-EXT.
           EXIT.
      *
      *****************************************************************
      *   Ê¸»ú¿ô¥«¥¦¥ó¥È½èÍý¡ÊÁ´³Ñ¤Î¤ß¡Ë
      *****************************************************************
       891-STRCOUNT-SEC                         SECTION.
      *
           PERFORM  UNTIL  WRK-STRING(CNT-STRING)  NOT  =  SPACE
                    OR  CNT-STRING  =  1
               COMPUTE  CNT-STRING  =  CNT-STRING  -  1
           END-PERFORM
      *
           IF  CNT-STRING                        =  1
               MOVE  ZERO                        TO  CNT-STRING
           ELSE
               COMPUTE  CNT-STRING               =  CNT-STRING  /  2
           END-IF
           .    
       891-STRCOUNT-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ð£Õ£Ô¡¡½èÍý
      *****************************************************************
       900-PUT-WINDOW                            SECTION.
      *
           MOVE   "PUTWINDOW"                    TO  MCP-FUNC.
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
           .
       900-PUT-WINDOW-EXT.
           EXIT.
      *
