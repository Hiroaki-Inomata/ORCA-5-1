      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this licence along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION              DIVISION.
       PROGRAM-ID.                 ORCSC10S200404.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ¿ÇÎÅ¹Ô°ÙÆþÎÏ
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ¿ÇÎÅ¹Ô°Ù¿Ç»¡ÎÁ¼«Æ°È¯À¸ÊÔ½¸½èÍý
      *                      ¡Ê£Ë£°£²¤Î¤ß¶¦ÄÌ»ÈÍÑ¡Ë
      *                      £È£±£¶Ç¯£´·î²þÀµÂÐ±þ
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  03/05/23    NACL¡ÝÂ¿¡¹Ç¼  ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      * 01.00.01     MCC-Â¿¡¹Ç¼   02/04/19  À¸³è½¬´·ÉÂ»ØÆ³»»Äê»þ¤ÎÄÉ²Ã
      * 01.00.02     MCC-Â¿¡¹Ç¼   02/04/22  ½é¿Ç¡¦ºÆ¿ÇÎÁ¤ÎÈ½Äê½¤Àµ
      * 01.00.03     MCC-Â¿¡¹Ç¼   02/04/**  Ï«ºÒÍÑÄÉ²Ã
      * 01.00.04     NACL-Â¿¡¹Ç¼  02/08/06  ¥¢¥Õ¥¿¡¼¥±¥¢¤Î»þ¼«Æ°»»ÄêÊÑ¹¹
      * 01.00.05     NACL-Â¿¡¹Ç¼  02/11/11  £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁÄÉ²Ã
      * 01.00.06     NACL-Â¿¡¹Ç¼  02/11/28  ÃæÅÓ½ªÎ»ºÆÉ½¼¨½¤Àµ
      * 01.00.07     NACL-Â¿¡¹Ç¼  02/12/02  À¸³è½¬´·ÉÂ¤Î¥³¡¼¥É¥¨¥é¡¼½¤Àµ
      * 01.00.08     NACL-Â¿¡¹Ç¼  02/12/06  ËýÀ­áÖÄË¤Î»»Äê¥Á¥§¥Ã¥¯½¤Àµ
      * 01.00.09     NACL-Â¿¡¹Ç¼  03/02/19  ÎÅÍÜÃ´Åö¼êÅöÄÉ²Ã
      * 01.00.10     NACL-Â¿¡¹Ç¼  03/03/28  ¼«ÇåÀÕ¤ÎÄþ¸º¤ò£¶¥ö·î°Ê¹ß¤È¤¹¤ë
      * 01.00.11     NACL-Â¿¡¹Ç¼  03/04/07  Æþ±¡Æü¤Î¥Á¥§¥Ã¥¯ÄÉ²Ã
      * 02.00.00     NACL-Â¿¡¹Ç¼  03/07/01  Ï«ºÒ¡¦¼«ÇåÀÕ°Ê³°¿Ç»¡²ó¿ô¤ò¤ä¤á¤ë
      * 02.00.01     NACL-Â¿¡¹Ç¼  03/08/29  £È£±£µ¡¥£¹¤«¤é
      *                                     Ï«ºÒ¡¦¼«ÇåÀÕÄþ¸ºÀ©¤ÎÇÑ»ß
      *                                     ¡Ê¥ì¥»ÅÅ¥³¡¼¥É¤ÎÊÑ¹¹¤Ê¤·¡Ë
      * 02.00.02     NACL-Â¿¡¹Ç¼  03/10/27  °é»ù±ÉÍÜ²Ã»»¼«Æ°»»ÄêÄÉ²Ã
      * 02.00.02     NACL-Â¿¡¹Ç¼  04/03/11  ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¥Á¥§¥Ã¥¯½¤Àµ
      * 02.00.03     NACL-Â¿¡¹Ç¼  05/09/28  ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¤È
      *                                     ºßÂðÎÅÍÜ»ØÆ³´ÉÍýÎÁ¤Î»»Äê½¤Àµ
      * 02.00.04     NACL-Â¿¡¹Ç¼  05/10/24  ¾Ã±êÄÃÄËÅù½èÃÖÈ½Äê½¤Àµ
      * 02.00.05     NACL-Â¿¡¹Ç¼  05/11/18  MONFUNC ÂÐ±þ Â¾
      * 02.00.06     NACL-Â¿¡¹Ç¼  05/11/21  ³«Êü·¿ÉÂ±¡¶¦Æ±»ØÆ³ÎÁ¥Á¥§¥Ã¥¯ÄÉ²Ã
      * 02.00.07     NACL-Â¿¡¹Ç¼  05/12/14  .213 ¼«Æ°ÊÑ´¹ÂÐ±þ
      *  03.05.00    NACL-Â¿¡¹Ç¼  07/04/XX  ¥°¥ë¡¼¥×¿ÇÎÅÂÐ±þ
      * 04.00.00     NACL-Â¿¡¹Ç¼  07/09/XX  ¥Æ¡¼¥Ö¥ë£´£°£°ÂÐ±þ
      *****************************************************************
      *
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
       DATA                    DIVISION.
       FILE                        SECTION.
      *
      *
       WORKING-STORAGE             SECTION.
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-PARA            PIC 9(01).
           03  FLG-END             PIC 9(01).
           03  FLG-SANTEI          PIC 9(01).
           03  FLG-TENSU           PIC 9(01).
           03  FLG-JYURRK          PIC 9(01).
           03  FLG-SRYACT          PIC 9(01).
           03  FLG-HKNCOMBI        PIC 9(01).
           03  FLG-SYSKANRI        PIC 9(01).
      *
           03  FLG-KBN             PIC 9(01).
      *
           03  FLG-OK              PIC 9(01).
           03  FLG-ADD             PIC 9(01).
      *
           03  FLG-CHK             PIC 9(01).
           03  FLG-ARI             PIC 9(01).
      *
           03  FLG-ARI2            PIC 9(01).
           03  FLG-ARI3            PIC 9(01).
      *
           03  FLG-SYOSIN          PIC 9(01).
           03  FLG-SYOSIN2         PIC 9(01).
      *
           03  FLG-ROUMANSEI       PIC 9(01).
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê»»Äê
           03  FLG-SYONIKA         PIC 9(01).
           03  FLG-SYONIKA-ARI     PIC 9(01).
           03  FLG-SYONIKA-TEI     PIC 9(01).
      *    ¿²¤¿¤­¤êÏ·¿Í»»Äê
           03  FLG-TOUG-SANTEI         PIC 9(03).
           03  FLG-JYURR-ARI           PIC 9(01).
      *
      *    ÆÃÄê¼À´µ¼«Æ°»»Äê¥Á¥§¥Ã¥¯ÍÑ
           03  FLG-KYUJITU         PIC 9(01).
      *    »ØÆ³¥Á¥§¥Ã¥¯ÍÑ
           03  FLG-SIDOU           PIC 9(01).
      *    ¿Ç»¡ÎÁ
           03  FLG-SINSATU         PIC 9(01).
           03  FLG-SINSATU2        PIC 9(01).
           03  FLG-CHK2            PIC 9(01).
      *    ¿Ç»¡ÎÁ
           03  FLG-SAISIN-CHK      PIC 9(01).
      *    £±£µºÐÌ¤ËþºÆ¿ÇÎÁ¤¢¤ê
           03  FLG-15MIMAN         PIC 9(01).
      *    ¥ï¡¼¥¯¿ÇÎÅ¹Ô°Ù¿Ç»¡ÎÁ¤¢¤ê
           03  FLG-SINSATU-ARI     PIC 9(01).
      *    ¥ï¡¼¥¯¿ÇÎÅ¹Ô°Ù¿Ç»¡ÎÁ¤¢¤ê
           03  FLG-SINSATU-OK      PIC 9(01).
      *    »þ´Ö³°¥Õ¥é¥°
           03  FLG-JIKAN           PIC 9(01).
      *    ÄûÀµ»þ³°Íè´ÉÍý²Ã»»¤¢¤ê
           03  FLG-GAI             PIC 9(01).
      *    Æ±ÆüºÆ¿Ç
           03  FLG-DOUJITU         PIC 9(01).
      *    Æ±ÆüºÆ¿ÇÍ­Ìµ
           03  FLG-DOUJITU-ARI     PIC 9(01).
      *    £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁ
           03  FLG-DUMMY           PIC 9(01).
      *    ÅÅÏÃºÆ¿Ç¤¢¤ê
           03  FLG-TEL-ARI         PIC 9(01).
      *
           03  FLG-CHK-ALL         PIC 9(01).
      *
           03  FLG-JIKANKBN        PIC 9(01).
      *
           03  FLG-SYONIKA-CHK     PIC 9(01).
      *
           03  FLG-TAIIN           PIC 9(01).
           03  FLG-FUKU            PIC 9(01).
      *
           03  FLG-CHK3             PIC 9(01).
           03  FLG-HKN-ARI          PIC 9(01).
           03  FLG-KA-ARI           PIC 9(01).
           03  FLG-SRYKBN           PIC 9(01).
           03  FLG-TOKUTEI          PIC 9(02).
      *
           03  FLG-FUKU-ARI         PIC 9(01).
      *
           03  FLG-SANTEI-OK        PIC 9(01).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX                 PIC 9(04).
           03  IDY                 PIC 9(04).
           03  IDX2                PIC 9(04).
           03  IDX3                PIC 9(04).
           03  IDX4                PIC 9(04).
           03  IDXS                PIC 9(04).
           03  IDX-S               PIC 9(04).
           03  IDX-Y2              PIC 9(02).
           03  IDX-Y3              PIC 9(02).
      *
           03  IDX-SIN             PIC 9(04).
           03  IDX-GAI             PIC 9(04).
           03  IDX-WK              PIC 9(04).
      *
           03  IDX-T               PIC 9(04).
      *
           03  IDX-A               PIC 9(04).
           03  IDX-KA              PIC 9(04).
           03  IDX-HKN             PIC 9(04).
           03  IDX-A-HZN           PIC 9(04).
      *
           03  IDX-INT-MAX          PIC 9(04).
      *
           03  IDX-STR              PIC 9(02).
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
      *
           03  WRK-SRYCD               PIC X(09).
      *
           03  WRK-IDX-IN              PIC 9(04).
           03  WRK-IDX-FT              PIC 9(04).
      *    »»Äê²ó¿ô
           03  WRK-SANTEI-CNT          PIC 9(04).
      *    Ç¯ÎðÈ½ÄêÍÑ
           03  WRK-BIRTHDAY.
               05  WRK-BIRTH-YY    PIC 9(04).
               05  WRK-BIRTH-MM    PIC 9(02).
               05  WRK-BIRTH-DD    PIC 9(02).
           03  WRK-NYUYOJI         PIC 9(04).
           03  WRK-DAYCNT          PIC 9(04).
           03  WRK-DAYCNT-SUM      PIC 9(04).
      *    ÄûÀµÆü¤Î²ó¿ô
           03  WRK-TEI-KAISU       PIC 9(04).
      *
           03  WRK-SYOYMD          PIC X(08).
           03  WRK-KEIYMD          PIC X(08).
           03  WRK-KEIYMDZEN       PIC X(08).
      *
      *    »»ÄêÇ¯·îÆü
           03  WRK-SANTEI-YMD          PIC X(08).
      *    ½é¿ÇÇ¯·îÆü
           03  WRK-SYOSIN-YMD          PIC X(08).
           03  WRK-YMD.
               05  WRK-YY              PIC 9(04).
               05  WRK-MM              PIC 9(02).
               05  WRK-DD              PIC 9(02).
      *
           03  WRK-KAISU               PIC 9(01).
           03  WRK-HOSPSBT             PIC 9(01).
           03  WRK-SRYKBN              PIC X(02).
           03  WRK-KBN                 PIC X(01).
           03  WRK-KBN2                PIC X(01).
           03  WRK-KBN3                PIC X(01).
      *
      *    »»ÄêÇ¯·î
           03  WRK-SANTEI-YM           PIC X(06).
           03  WRK-SANTEI-ARI          PIC X(06).
           03  WRK-SANTEI-NASI         PIC X(06).
      *
      *    Ï·¿ÍËýÀ­¼ÀÉÂ¿Ç»¡ÎÁ²ó¿ô
           03  WRK-ROUMANSEI           PIC 9(04).
           03  WRK-ROUMANSEI2          PIC 9(04).
           03  WRK-ROUMANSEI-CNT       PIC 9(04).
           03  WRK-GAIRAI-IDX          PIC 9(04).
           03  WRK-SEIKATU-CNT         PIC 9(04).
      *
      *    ¿²¤¿¤­¤ê²ó¿ô
           03  WRK-NETAKIRI-CNT        PIC 9(04).
      *
      *    ºßÂð¼«¸ÊÃí¼Í
           03  WRK-ZAITAKU             PIC 9(01).
           03  WRK-ZAITAKU-IDX         PIC 9(04).
      *
      *    È¯À¸Ç¯·îÆü
           03  WRK-HASSYOYMD.
               05  WRK-HAS-YY          PIC 9(04).
               05  WRK-HAS-MM          PIC 9(02).
               05  WRK-HAS-DD          PIC 9(02).
      *
      *    ½é²ó»»ÄêÆü
           03  WRK-FSANTEIYMD          PIC X(08).
      *
      *    ¥Ñ¥¹Ì¾
           03  WRK-PATH                PIC X(64).
      *
      *    ¼õ¿Ç²ó¿ô¡Ê³°Áí¿Ç  ´Ý¤áÍÑ¡Ë
           03  WRK-SINSATU-ROU         PIC 9(04).
      *    ¼õ¿Ç²ó¿ô
           03  WRK-SINSATU-CNT         PIC 9(04).
      *
      *    ¾Ã±ê½èÃÖ²ó¿ô
           03  WRK-SYOEN-CNT           PIC 9(03).
      *
      *    ÆþÎÏ
           03  WRK-INPUTCD             PIC X(22).
      *    ÅöÆü¼õ¿Ç²ó¿ô
           03  WRK-DAY-SINSATUCNT      PIC 9(04).
      *
      *    £²£´»þ´ÖÏ¢ÂÓ²Ã»»
           03  WRK-24KSAN-SRYCD        PIC X(09).
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¥Á¥§¥Ã¥¯
           03  WRK-SYONIKA-KBN        PIC X(01).
      *
      *    È¯À¸ÆüÊÔ½¸
           03  WRK-HENSYU-AREA.
               05  WRK-KYUSEI-YMD      PIC X(09).
               05  WRK-KYUSEI-90       PIC X(09).
               05  WRK-KYUSEI-180      PIC X(09).
               05  WRK-HENSYU          PIC X(80).
      *
      *    Ê£¿ô²Ê
           03  WRK-SEL-HKNNUM          PIC X(03).
           03  WRK-HKNCOMBI            PIC X(04).
           03  WRK-SRYKA               PIC X(02).
           03  WRK-DRCD.
               05  WRK-DRCD1               PIC X(01).
               05  WRK-DRCD2               PIC X(04).
           03  WRK-DRCD-MEI                PIC X(80).
           03  WRK-HEN-SRYKA               PIC X(02).
      *    ºßÂðÎÅÍÜ»ØÆ³ÎÁ»»Äê
           03  WRK-ZAITAKU-CNT         PIC 9(04).
      *
      *    ¿Ç»¡ÎÁ¥Æ¡¼¥Ö¥ë
       01  TBL-SINSATU-AREA.
      *    ½é¿ÇÎÁ¡Ê°ìÈÌ ÉÂ±¡¡Ë
           03  FILLER              PIC X(14)   VALUE   "101F 111000110".
      *    ½é¿ÇÎÁ¡ÊÏ·¿Í ÉÂ±¡¡Ë
           03  FILLER              PIC X(14)   VALUE   "111F 111700110".
      *    ½é¿ÇÎÁ¡Ê°ìÈÌ ¿ÇÎÅ½ê¡Ë
           03  FILLER              PIC X(14)   VALUE   "102F 111003610".
      *    ½é¿ÇÎÁ¡ÊÏ·¿Í ¿ÇÎÅ½ê¡Ë
           03  FILLER              PIC X(14)   VALUE   "112F 111700210".
      *
      *    ºÆ¿ÇÎÁ¡Ê°ìÈÌ ÉÂ±¡¡Ë
           03  FILLER              PIC X(14)   VALUE   "101  112007410".
      *    ÅÅÏÃºÆ¿ÇÎÁ¡Ê°ìÈÌ ÉÂ±¡¡Ë
           03  FILLER              PIC X(14)   VALUE   "101T 112007950".
      *    Æ±ÆüºÆ¿Ç¡Ê°ìÈÌ ÉÂ±¡¡Ë
           03  FILLER              PIC X(14)   VALUE   "101D 112008350".
      *    ÅÅÏÃÆ±ÆüºÆ¿Ç¡Ê°ìÈÌ ÉÂ±¡¡Ë
           03  FILLER              PIC X(14)   VALUE   "101S 112008850".
      *
      *    ºÆ¿ÇÎÁ¡Ê°ìÈÌ ¿ÇÎÅ½ê¡Ë
           03  FILLER              PIC X(14)   VALUE   "102  112009210".
      *    ÅÅÏÃºÆ¿Ç¡Ê°ìÈÌ ¿ÇÎÅ½ê¡Ë
           03  FILLER              PIC X(14)   VALUE   "102T 112009750".
      *    Æ±ÆüºÆ¿Ç¡Ê°ìÈÌ ¿ÇÎÅ½ê¡Ë
           03  FILLER              PIC X(14)   VALUE   "102D 112010150".
      *    ÅÅÏÃÆ±ÆüºÆ¿Ç¡Ê°ìÈÌ ¿ÇÎÅ½ê¡Ë
           03  FILLER              PIC X(14)   VALUE   "102S 112010650".
      *
      *    ºÆ¿ÇÎÁ¡ÊÏ·¿Í ÉÂ±¡¡Ë
           03  FILLER              PIC X(14)   VALUE   "111  112702310".
      *    ÅÅÏÃºÆ¿Ç¡ÊÏ·¿Í ÉÂ±¡¡Ë
           03  FILLER              PIC X(14)   VALUE   "111T 112702750".
      *    Æ±ÆüºÆ¿Ç¡ÊÏ·¿Í ÉÂ±¡¡Ë
           03  FILLER              PIC X(14)   VALUE   "111D 112703050".
      *    Æ±ÆüÅÅÏÃºÆ¿Ç¡ÊÏ·¿Í ÉÂ±¡¡Ë
           03  FILLER              PIC X(14)   VALUE   "111S 112703450".
      *
      *    ºÆ¿ÇÎÁ¡ÊÏ·¿Í ¿ÇÎÅ½ê¡Ë
           03  FILLER              PIC X(14)   VALUE   "112  112703710".
      *    ÅÅÏÃºÆ¿Ç¡ÊÏ·¿Í ¿ÇÎÅ½ê¡Ë
           03  FILLER              PIC X(14)   VALUE   "112T 112704150".
      *    Æ±ÆüºÆ¿Ç¡ÊÏ·¿Í ¿ÇÎÅ½ê¡Ë
           03  FILLER              PIC X(14)   VALUE   "112D 112704450".
      *    Æ±ÆüÅÅÏÃºÆ¿Ç¡ÊÏ·¿Í ¿ÇÎÅ½ê¡Ë
           03  FILLER              PIC X(14)   VALUE   "112S 112704850".
      *
      *
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ(±¡³°½èÊý ½é¿Ç)
           03  FILLER              PIC X(14)   VALUE   "200FG113003510".
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ(±¡Æâ½èÊý ½é¿Ç)
           03  FILLER              PIC X(14)   VALUE   "200FN113003710".
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ(±¡³°½èÊý ºÆ¿Ç)
           03  FILLER              PIC X(14)   VALUE   "200 G113003610".
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ(±¡Æâ½èÊý ºÆ¿Ç)
           03  FILLER              PIC X(14)   VALUE   "200 N113003810".
      *
      *
      *    ³°Íè¿ÇÎÅÎÁ
           03  FILLER              PIC X(14)   VALUE   "301  112011310".
      *    Æ±Æü³°Íè¿ÇÎÅÎÁ
           03  FILLER              PIC X(14)   VALUE   "301D 112011710".
      *    ³°Íè¿ÇÎÅÎÁ¡ÊÏ·¿Í¡Ë
           03  FILLER              PIC X(14)   VALUE   "311  112705510".
      *    Æ±Æü³°Íè¿ÇÎÅÎÁ¡ÊÏ·¿Í¡Ë
           03  FILLER              PIC X(14)   VALUE   "311D 112705850".
      *
      *
       01  TBL-SINSATU-AREAR       REDEFINES   TBL-SINSATU-AREA.
           03  TBL-SINSATU-OCC         OCCURS  28    INDEXED  TBL-IDX.
      *        £±¡§°ìÈÌ¡¢£²¡§¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¡¢£³¡§³°Íè¿ÇÎÅÎÁ
               05  TBL-KAISU           PIC 9(01).
      *        Ï·¿Í°ìÈÌ¶èÊ¬¡Ê£°¡§°ìÈÌ¡¢£±¡§Ï·¿Í¡Ë
               05  TBL-ROUJIN          PIC 9(01).
      *        ÉÂ±¡¼ïÊÌ¡Ê£±¡§ÉÂ±¡¡¢£²¡§¿ÇÎÅ½ê¡Ë
               05  TBL-HOSPSBT         PIC 9(01).
      *        D:Æ±ÆüºÆ¿Ç¡¢T¡§ÅÅÏÃºÆ¿Ç¡¢S:Æ±ÆüÅÅÏÃºÆ¿Ç¡¢F:½é¿Ç
               05  TBL-KBN             PIC X(01).
      *        G:±¡³°¡¢N:±¡Æâ¡Ê¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¡Ë
               05  TBL-KBN2            PIC X(01).
      *        ¿ÇÎÅ¥³¡¼¥É
               05  TBL-SRYCD           PIC X(09).
      *
       01  TBL-SIN-MAX                 PIC 9(04)   VALUE   28.
      *
      *
      *    ³°Íè´ÉÍý²Ã»»¥Æ¡¼¥Ö¥ë
       01  TBL-GAIRAI-AREA.
      *    °ìÈÌ
           03  FILLER              PIC X(13)   VALUE    "100 112011010".
      *    Ï·¿Í ÉÂ±¡
           03  FILLER              PIC X(13)   VALUE    "111 112705110".
      *    Ï·¿Í ¿ÇÎÅ½ê
           03  FILLER              PIC X(13)   VALUE    "112 112705310".
      *
      *
       01  TBL-GAIRAI-AREAR       REDEFINES   TBL-GAIRAI-AREA.
           03  TBL-GAIRAI-OCC          OCCURS  3   INDEXED  TBLG-IDX.
      *        ²ó¿ô
               05  TBLG-KAISU           PIC 9(01).
      *        Ï·¿Í°ìÈÌ¶èÊ¬¡Ê£°¡§°ìÈÌ¡¢£±¡§Ï·¿Í¡Ë
               05  TBLG-ROUJIN          PIC 9(01).
      *        ÉÂ±¡¼ïÊÌ¡Ê£±¡§ÉÂ±¡¡¢£²¡§¿ÇÎÅ½ê¡Ë
               05  TBLG-HOSPSBT         PIC 9(01).
      *
               05  TBLG-KBN2            PIC X(01).
      *        ¿ÇÎÅ¥³¡¼¥É
               05  TBLG-SRYCD           PIC X(09).
      *
      *    Ï«ºÒ¿Ç»¡ÎÁ¥Æ¡¼¥Ö¥ë
       01  TBL-RSI-SINSATU-AREA.
      *    ½é¿ÇÎÁ
           03  FILLER              PIC X(13)   VALUE   "0 F 101110010".
      *    ºÆ¿ÇÎÁ
           03  FILLER              PIC X(13)   VALUE   "0 S 101120040".
      *    ³°Íè´ÉÍý²Ã»»
           03  FILLER              PIC X(13)   VALUE   "0 G 101120070".
      *
       01  TBL-RSI-SINSATU-AREAR   REDEFINES   TBL-RSI-SINSATU-AREA.
           03  TBL-RSI-SINSATU-OCC     OCCURS  3    INDEXED  TBL-RSI.
      *        ²ó¿ô
               05  TBLR-KAISU           PIC 9(01).
               05  FILLER               PIC X(01).
      *        F:½é¿Ç¡¢S:ºÆ¿Ç¡¢G:³°Íè´ÉÍý²Ã»»
               05  TBLR-KBN             PIC X(01).
               05  FILLER               PIC X(01).
      *        ¿ÇÎÅ¥³¡¼¥É
               05  TBLR-SRYCD           PIC X(09).
      *
      *    ÊÝ¸±ÊÌ»»ÄêÍúÎò¥Æ¡¼¥Ö¥ë
           COPY   "CMSANTEITBL.INC".
      *
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¥Æ¡¼¥Ö¥ë
           COPY   "CMSYONIKATBL.INC".
      *
      *    ²èÌÌ£Ó£Ð£ÁÎÎ°è¥ï¡¼¥¯
       01  HZN-SCR-REC.
           COPY    "CPK02SPASCR.INC"  REPLACING
                                       //SPA-// BY //HZN-//.
      *
      *    ²èÌÌ£Ó£Ð£ÁÎÎ°è¥ï¡¼¥¯
       01  WRK-SCR-REC.
           COPY    "CPK02SPASCR.INC"  REPLACING
                                       //SPA-// BY //WRK-//.
      *
      *    ²èÌÌ£Ó£Ð£ÁÎÎ°è¥ï¡¼¥¯
       01  WRK-SCR-REC2.
           COPY    "CPK02SPASCR.INC"  REPLACING
                                       //SPA-// BY //WRK2-//.
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿¡Ý
      *01  TENSU-REC.
           COPY    "CPTENSU.INC".
      *
      *    »»ÄêÍúÎò
       01  SANTEI-REC.
           COPY    "CPSANTEI.INC".
      *
      *    ¼õ¿ÇÍúÎò
       01  JYURRK-REC.
           COPY    "CPJYURRK.INC".
      *
      *    ¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¡Ý
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *    ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *    ¥ï¡¼¥¯¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¡Ý
       01  WKSRYACT-REC.
           COPY    "CPWKSRYACT.INC".
      *
      *    ¿¦°÷¾ðÊó
           COPY    "CPSK1010.INC".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *   ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *
      *    ²èÌÌÆüÉÕÊÑ´¹¥µ¥Ö
      *    COPY    "CPORCSGDAY.INC".
      *
      *    ¿ô»úÊÑ´¹ÎÎ°è
      *    COPY    "CPORCSNUM.INC".
      *    ´µ¼ÔÈÖ¹æÊÑ´¹¥µ¥Ö
      *    COPY    "CPORCSPTID.INC".
      *
      *    ÉéÃ´¶â³Û·×»»ÍÑ¥Ñ¥é¥á¥¿
      *    COPY    "CPORCS01.INC".
      *
      *    ¿ÇÎÅ¹Ô°Ù»»ÄêÍÑ¶¦ÄÌ¥Ñ¥é¥á¥¿
      *    COPY    "CPORCSC00.INC".
      *
      *    »»ÄêÍúÎò¥Á¥§¥Ã¥¯¥Ñ¥é¥á¥¿
      *    COPY    "CPORCSC91.INC".
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¥Ñ¥é¥á¥¿
           COPY    "CPORCSC92.INC".
      *
      *    ºÞÊ¬Î¥¥Ñ¥é¥á¥¿
      *    COPY    "CPORCSC93.INC".
      *
      *    ²èÌÌºÆÊÔ½¸¥Ñ¥é¥á¥¿
           COPY    "CPORCSC94.INC".
      *
      *    ½é´ü£Ó£Ð£Á²èÌÌÊÔ½¸¥Ñ¥é¥á¥¿
      *    COPY    "CPORCSC95.INC".
      *
      *    ¥¨¥é¡¼¥á¥Ã¥»¡¼¥¸ÊÔ½¸¥Ñ¥é¥á¥¿
      *    COPY    "CPORCSC96.INC".
      *
      *    ¥¨¥é¡¼¥á¥Ã¥»¡¼¥¸ÊÔ½¸¥Ñ¥é¥á¥¿
      *    COPY    "CPORCSC97.INC".
      *
      *    ÊÝ¸±Ç¯Îð¡¦ÉéÃ´³ä¹ç»»Äê¥µ¥Ö
           COPY    "CPORCSAGECHK.INC".
      *
      *    ¿ÇÎÅ¼ïÊÌÌ¾¥Æ¡¼¥Ö¥ë
           COPY    "CPORCSSRYSYU.INC".
      *
      *    £Ä£Â¸¡º÷
      *01  MCPDATA-REC                 PIC X(5000).
           COPY    "MCPDATA.INC".
      *****COPY    "CPORCMCP.INC".
      *
           COPY    "MCPAREA".
      *
      *    ¿ÇÎÅ¹Ô°ÙÍÑ¶¦ÄÌ¥Ñ¥é¥á¥¿
           COPY    "K01COMMON-SPA".
      *
      *****************************************************************
      *    Ï¢Íí¡¡ÎÎ°è
      *****************************************************************
        LINKAGE                     SECTION.
      *
      *    ¥¹¥ÑÎÎ°è
           COPY    "COMMON-SPA".
      *    ¥Ñ¥é¥á¥¿
           COPY    "CPORCSC10S.INC".
      *
      *    £Ó£Ð£Á¥Ñ¥é¥á¥¿
       01  SPA-SCR-REC.
           COPY    "CPK02SPASCR.INC".
      *
      *    ²èÌÌ¥¹¥ÑÎÎ°è
           COPY    "K02SCR-SPA".
      *
       PROCEDURE                   DIVISION    USING
           ORCSC10SAREA
           SPA-AREA
           SPA-SCR-REC
           SPA-K02
           .
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  IDX-AREA
           INITIALIZE                  WRK-AREA
      *
           MOVE    SPACE               TO  SPA-ERRMSG
           MOVE    SPA-WORK            TO  SPA-K01KYOUTU
      *
           EVALUATE    LNK-SC10S-SYORI
      *        ½é´ü¼«Æ°È¯À¸ÊÔ½¸
               WHEN    "1"
                   PERFORM 100-SANTEI-CHK-SEC
                   PERFORM 200-SYOSIN-SET-SEC
      *        Æ±»þºÆ¿Ç»»Äê¡Ê¼«Æ°¡Ë
               WHEN    "2"
                   PERFORM 300-DOUSAISIN-SET-SEC
      *        »»Äê²ó¿ô¥Á¥§¥Ã¥¯
               WHEN    "3"
                   PERFORM 100-SANTEI-CHK-SEC
      *        ±¡Æâ±¡³°ÊÑ¹¹
               WHEN    "4"
                   PERFORM 400-INGAI-HEN-SEC
      *        Æ±»þºÆ¿Ç»»Äê¡ÊÆþÎÏÊ¬¡Ë
               WHEN    "5"
                   PERFORM 500-INDOUSAISIN-SET-SEC
      *        ºÞÊ¬Î¥Á°¤ÎÆÃÄê»»Äê²ó¿ô¥Á¥§¥Ã¥¯
               WHEN    "6"
                   PERFORM 600-SANTEI-CNT-SEC
      *        ºÞÊ¬Î¥¸å¤ÎÆÃÄê»»Äê¥Á¥§¥Ã¥¯
               WHEN    "7"
                   PERFORM 700-SANTEI-CHK-SEC
      *        ºÆ¿ÇÎÁ¤Î£´²óÌÜ°Ê¹ß¤Î¿¶ÂØ¤¨½èÍý
               WHEN    "8"
                   PERFORM 800-SAISIN-HEN-SEC
      *        ºÆ¿ÇÎÁ¢ª½é¿ÇÎÁ¤Î¿¶ÂØ»þ¥Á¥§¥Ã¥¯½èÍý
               WHEN    "9"
                   PERFORM 900-SYOSIN-CHK-SEC
      *
      *        ÃæÅÓ½ªÎ»ÁªÂò»þ¥Á¥§¥Ã¥¯½èÍý
               WHEN    "W"
      *******      PERFORM 1000-WKSRYACT-HEN-SEC
                   PERFORM 1010-SINSATU-HEN-SEC
      *        ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý
               WHEN    "S"
                   PERFORM 1010-SINSATU-HEN-SEC
      *        ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý¡ÊÂ¾ÊÝ¸±¼õ¿Ç¤¢¤ê¡Ë
               WHEN    "H"
                   PERFORM 1012-TAHOKEN-HEN-SEC
      *        ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý¡ÊÂ¾ÊÝ¸±¼õ¿Ç¤¢¤ê¤ÇÆ±ÆüºÆ¿Ç¤Ø¡Ë
               WHEN    "J"
                   PERFORM 1010-SINSATU-HEN-SEC
      *        ½é¿ÇÎÁ¤ò»»ÄêÃæ¤«¤ÎÈ½Äê
               WHEN    "C"
                   PERFORM 1011-SYOSIN-CHK-SEC
      *        ¿Ç»¡ÎÁ»»Äê¸å¡¢¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý
               WHEN    "K"
                   PERFORM 1014-SINSATU-HENKAN-SEC
      *        Ê£¿ôÎÁ¡Ê¡ð¡Ë¡¢ÊÝ¸±ÁÈ¹ç¤»¡Ê¡ô¡ËÂÐ±þ
               WHEN    "A"
               WHEN    "B"
      *        »ØÆ³ÎÁÈ¯À¸¤Ê¤·
               WHEN    "D"
                   PERFORM 1015-FUKU-SYORI-SEC
           END-EVALUATE
      *
           MOVE    SPA-K01KYOUTU       TO  SPA-WORK
           MOVE    IDX2                TO  LNK-SC10S-IDX2
           .
       000-PROC-EXT.
      *
           EXIT    PROGRAM
           .
      *
      *****************************************************************
      *    ½é¿ÇÎÁ¤ò»»ÄêÃæ¤«¤ÎÈ½Äê½èÍý
      *****************************************************************
       1011-SYOSIN-CHK-SEC                  SECTION.
      *
           MOVE    ZERO               TO  SPA-SYOSIN
      *
      *    ÄûÀµ¤Î»þ¡¢½é¿ÇÎÁ¤ò»»ÄêÃæ¤«¤ÎÈ½Äê
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE    )  OR
                              (SPA-COM-INPUTCD(IDX) =   SPACE  AND
                               SPA-GMN-INPUTCD(IDX) =   SPACE )
               EVALUATE    SPA-COM-INPUTCD (IDX)
                   WHEN    "111700110"
                   WHEN    "111700210"
                   WHEN    "111000110"
                   WHEN    "111003610"
                   WHEN    "113003510"
                   WHEN    "113003710"
                       MOVE    1              TO  SPA-SYOSIN
      *                Ï«ºÒÊ¬
                   WHEN    "101110010"
                       MOVE    1              TO  SPA-SYOSIN
               END-EVALUATE
           END-PERFORM
      *
           .
       1011-SYOSIN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³Æ¿Ç»¡»»Äê²ó¿ô½èÍý
      *****************************************************************
       100-SANTEI-CHK-SEC                  SECTION.
      *
           IF      SPA-HKNKBN          =   1
      *        Ï«ºÒ¤Î»þ¤Î½èÍý
               PERFORM 1000-SANTEI-RSI-SEC
               GO      TO      100-SANTEI-CHK-EXT
           END-IF
      *
      *    ¼õ¿ÇÍúÎò¤è¤ê¿Ç»¡²ó¿ô¤òµá¤á¤ë
           PERFORM 1000-SINSATU-KAISU-SEC
      *
      *    Åö·î»»Äê²ó¿ô¤òµá¤á¤ë
           PERFORM 1001-TOUGETU-KAISU-SEC
      *
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê
           IF     (SPA-SYONIKA         =   1   )  AND
                  (SPA-NYUGAIKBN       =   "2" )
             AND  (WRK-ZAITAKU-CNT     =   ZERO)
               PERFORM 1001-SYONIKA-CHK-SEC
           ELSE
               MOVE    ZERO                TO  SPA-SYONIKA-ARI3
               MOVE    ZERO                TO  SPA-SYONIKA-ARI2
               MOVE    ZERO                TO  SPA-SYONIKA-ARI
           END-IF
      *
      *    ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê»»Äê½èÍý
           IF     (SPA-NAI-ROUJIN      =   1   )  AND
                  (SPA-NYUGAIKBN       =   "2" )  AND
                  (SPA-NETAKIRI-ARI2   =   ZERO)
               PERFORM 1002-NETAKIRI-CHK-SEC
           END-IF
      *
      *    ËýÀ­áÖÄË¼ÀÉÂ´ÉÍýÎÁ»»Äê¥Á¥§¥Ã¥¯
           PERFORM 1004-TOUTUU-CHK-SEC
      *
           .
       100-SANTEI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼õ¿ÇÍúÎò¤è¤ê¿Ç»¡²ó¿ô¤òµá¤á¤ë½èÍý
      *****************************************************************
       1000-SINSATU-KAISU-SEC          SECTION.
      *
           MOVE    ZERO                TO  SPA-SINSATU-CNT
           MOVE    ZERO                TO  FLG-15MIMAN
           MOVE    ZERO                TO  SPA-15MIMAN-ARI
      *    ÅöÆü»»Äê²ó¿ô
           MOVE    ZERO                TO  WRK-DAY-SINSATUCNT
      *    ÅöÆü¿Ç»¡ÎÁ»»ÄêÍ­Ìµ
           MOVE    ZERO                TO  SPA-DOUJITU
      *    ¿·µ¬¤Î»þ¡¢¼õ¿Ç¤Ê¤·
           IF      SPA-SYOYMD          =   SPACE
               GO      TO      1000-SINSATU-KAISU-EXT
           END-IF
      *test
      *    Ê¿À®£±£µÇ¯£¹·î£±Æü¤«¤éÄþ¸ºÇÑ»ß¤Î°Ù¡¢ÅöÆü¤Ë¿ÇÎÅ¤¬¤¢¤ë»þ¤Î¤ß
           IF      SPA-SRYYMD          >=  "20030901"
               MOVE    ZERO                TO  FLG-DOUJITU-ARI
               PERFORM VARYING     IDX2    FROM    1   BY  1
                       UNTIL       IDX2    >   SPA-GMN-MAX1
                   IF      SPA-NAI-RRKYMD(IDX2)    =   SPA-SRYYMD
                       MOVE    1               TO  FLG-DOUJITU-ARI
                       MOVE    SPA-GMN-MAX1    TO  IDX2
                   ELSE
                       IF      SPA-NAI-RRKYMD(IDX2)    <   SPA-SRYYMD
                           MOVE    SPA-GMN-MAX1    TO  IDX2
                       END-IF
                   END-IF
               END-PERFORM
               IF      FLG-DOUJITU-ARI     =   ZERO
                   GO      TO      1000-SINSATU-KAISU-EXT
               END-IF
           END-IF
      *
      *    £±£µºÐ¤Ë¤Ê¤ëÇ¯·îÆü¤ò·×»»
           MOVE    SPA-BIRTHDAY        TO  WRK-BIRTHDAY
           COMPUTE WRK-BIRTH-YY        =   WRK-BIRTH-YY    +  15
      *
      *!!  Ï«ºÒ¤Î¿Ç»¡ÎÁÄþ¸º¤¬¤Ê¤¯¤Ê¤Ã¤¿¤é¡¢ÅöÆüÊ¬¤Î¤ß¤Î»»Äê¤È¤¹¤ë
      *!!!
      *    ¼õ¿ÇÍúÎò¤è¤ê¼õ¿Ç²ó¿ô¤òµá¤á¤ë
      *    ¼õ¿ÇÎò¤ò¸¡º÷¤¹¤ë¡Ê¿ÇÎÅ·î£±Æü¤«¤é¿ÇÎÅÆü¤Þ¤Ç¤ÎÈÏ°Ï¡Ë
           MOVE    SPACE               TO  JYURRK-REC
           INITIALIZE                  JYURRK-KEY
           MOVE    SPA-HOSPNUM         TO  JYURRK-HOSPNUM
           MOVE    SPA-NYUGAIKBN       TO  JYURRK-NYUGAIKBN
           MOVE    SPA-PTID            TO  JYURRK-PTID
           IF      SPA-HKNKBN          =   1
      *        Ï«ºÒ¡¦¼«ÇåÀÕ¤Î»þ¡¢¿ÇÎÅ·î£±Æü¤«¤é¿ÇÎÅÆü¤Þ¤Ç¤ÎÈÏ°Ï
               MOVE    SPA-SRYYMD          TO  JYURRK-SRYYMD
               MOVE    "01"                TO  JYURRK-SRYYMD(7:2)
      *!
      *        Ê¿À®£±£µÇ¯£¹·î£±Æü¤«¤éÄþ¸ºÇÑ»ß¤È¤¹¤ë
               IF      SPA-SRYYMD          >=  "20030901"
                   MOVE    SPA-SRYYMD          TO  JYURRK-SRYYMD
               END-IF
           ELSE
      *        °Ê³°¤Î»þ¡¢¿ÇÎÅÆü¤Î¤ß
               MOVE    SPA-SRYYMD          TO  JYURRK-SRYYMD
           END-IF
      *
           MOVE    SPA-SRYYMD          TO  JYURRK-UPSRYYMD
      *
           MOVE    JYURRK-REC          TO  MCPDATA-REC
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
           MOVE    "key14"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key14"             TO  MCP-PATHNAME
               PERFORM 970-JYURRK-READ-SEC
           ELSE
               MOVE    SPACE               TO  JYURRK-REC
               INITIALIZE                  JYURRK-REC
               MOVE    1               TO  FLG-JYURRK
           END-IF
           PERFORM
                   UNTIL    FLG-JYURRK     =   1
               IF      JYURRK-RENNUM       =   1
                   MOVE    ZERO            TO  FLG-SYONIKA
               END-IF
               MOVE    ZERO                TO  FLG-CHK
               MOVE    ZERO                TO  FLG-CHK2
      *        ÊÝ¸±¤Ë¤è¤êÂÐ¾Ý¤ò·èÄê¤¹¤ë
               PERFORM 10000-HKNKBN-CHK-SEC
      *********MOVE    ZERO                TO  FLG-CHK
               IF     (FLG-CHK             =   ZERO  )
      *            ÅöÆü¤Î»þ¤Ï¡¢Á´Éô
                  OR  (SPA-SRYYMD          =   JYURRK-SRYYMD)
      *            ¼õ¿ÇÍúÎò¤ËÆ±ÆüÂ¾²Ê»»Äê¤¬¤Ê¤¤¤³¤È
                   PERFORM 10001-DOUJI-CHK-SEC
               END-IF
      *
               IF     (JYURRK-EDANUM       =   1   )  AND
                      (JYURRK-DOUJI-RENNUM =   1  OR  ZERO )
                   CONTINUE
               ELSE
                   MOVE    1               TO  FLG-CHK
               END-IF
      *        ÄûÀµ¤Î»þ¡¢ÄûÀµÊ¬¤Ï¥«¥¦¥ó¥È¤·¤Ê¤¤
               IF      SPA-SYORIFLG        =   1
                   IF      (SPA-SRYYMD         =   JYURRK-SRYYMD) AND
                           (SPA-SRYKA          =   JYURRK-SRYKA ) AND
                           (SPA-RENNUM         =   JYURRK-RENNUM) AND
                           (SPA-DOUJI-RENNUM   =   JYURRK-DOUJI-RENNUM)
                       MOVE    1               TO  FLG-CHK
                       MOVE    1               TO  FLG-CHK2
                   END-IF
      *            ÄûÀµ¤Î»þ¡¢ÄûÀµÊ¬¤Ï°Ê¹ß¥«¥¦¥ó¥È¤·¤Ê¤¤
                   IF      (SPA-SRYYMD         =   JYURRK-SRYYMD) AND
                           (SPA-SRYKA          =   JYURRK-SRYKA ) AND
                           (SPA-RENNUM         <   JYURRK-RENNUM)
                       MOVE    1               TO  FLG-CHK
                       MOVE    1               TO  FLG-CHK2
                   END-IF
               END-IF
      *
      *        ¼õ¿Ç²ó¿ô
               IF      FLG-CHK         =   ZERO
                   ADD     1               TO  SPA-SINSATU-CNT
               END-IF
      *        ÅöÆü»»Äê²ó¿ô
               IF     (FLG-CHK2        =   ZERO )  AND
                      (FLG-SINSATU2    =   1    )
                   ADD     1                   TO  WRK-DAY-SINSATUCNT
      *            ÅöÆü¿Ç»¡ÎÁ»»ÄêÍ­Ìµ
                   ADD     1                   TO  SPA-DOUJITU
               END-IF
      *
               MOVE    "key14"             TO  MCP-PATHNAME
               PERFORM 970-JYURRK-READ-SEC
           END-PERFORM
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
           MOVE    "key14"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *    £±£µºÐÌ¤ËþºÆ¿Ç²Ê»»ÄêÍ­¤ê
           IF     (SPA-NENREI-YY       =   15              )  AND
                  (WRK-BIRTHDAY(1:6)   =   SPA-SRYYMD (1:6))
               IF      FLG-15MIMAN         =   1
                   MOVE    1               TO  SPA-15MIMAN-ARI
               END-IF
           END-IF
           .
       1000-SINSATU-KAISU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÂÐ¾ÝÊÝ¸±·èÄê½èÍý
      *****************************************************************
       10000-HKNKBN-CHK-SEC            SECTION.
      *
           MOVE    ZERO                TO  FLG-CHK
           EVALUATE    SPA-HKNKBN
              WHEN     ZERO
                  IF      JYURRK-HKNKBN        =   ZERO  OR  SPACE
                       CONTINUE
                  ELSE
                       MOVE    1               TO  FLG-CHK
                  END-IF
              WHEN     1
      *           ¼«ÇåÀÕ
                  IF      SPA-RSI-HKNKBN       =   "4"
                      IF      JYURRK-HKNKBN    NOT =   2
                           MOVE    1               TO  FLG-CHK
                      END-IF
                  ELSE
      *           Ï«ºÒ
                      IF      JYURRK-HKNKBN    NOT =   1
                           MOVE    1               TO  FLG-CHK
                      END-IF
                  END-IF
           END-EVALUATE
      *
           .
       10000-HKNKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼õ¿ÇÍúÎò¤ËÆ±ÆüÂ¾²Ê»»Äê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       10001-DOUJI-CHK-SEC                  SECTION.
      *
           IF      JYURRK-SRYKBN (01)      =   "01"
               CONTINUE
           ELSE
               MOVE    1                   TO  FLG-CHK
               GO      TO      10001-DOUJI-CHK-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-SINSATU
           MOVE    ZERO                TO  FLG-SINSATU2
           MOVE    ZERO                TO  FLG-SYOSIN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   15  )  OR
                              (FLG-SINSATU         =   1     )  OR
                              (JYURRK-ZAINUM (IDX) =   ZERO  )
      *
               MOVE    SPACE               TO  SRYACT-REC
               INITIALIZE                  SRYACT-REC
               MOVE    SPA-HOSPNUM         TO  SRY-HOSPNUM
               MOVE    SPA-NYUGAIKBN       TO  SRY-NYUGAIKBN
               MOVE    JYURRK-PTID         TO  SRY-PTID
               MOVE    JYURRK-SRYKA        TO  SRY-SRYKA
               MOVE    JYURRK-SRYYMD(1:6)  TO  SRY-SRYYM
               MOVE    JYURRK-ZAINUM (IDX)
                                           TO  SRY-ZAINUM
      *
               MOVE    SRYACT-REC          TO  MCPDATA-REC
               MOVE    "tbl_sryact"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 910-DBSELECT-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    "key2"              TO  MCP-PATHNAME
                   PERFORM 930-SRYACT-READ-SEC
                ELSE
                   INITIALIZE                  SRYACT-REC
                   MOVE    1               TO  FLG-SRYACT
               END-IF
      *
               PERFORM
                       UNTIL  (FLG-SRYACT      =   1     )  OR
                              (FLG-SINSATU     =   1     )
                   PERFORM VARYING     IDY     FROM    1   BY  1
                           UNTIL   (IDY        >   5   )  OR
                                   (FLG-SINSATU          =   1     )  OR
                                   (SRY-SRYCD (IDY)      =   SPACE )
      **************** IF      SPA-HKNKBN          =   ZERO
                       IF      JYURRK-HKNKBN       =   ZERO
      *                    °ìÈÌ
                           PERFORM 100011-IPN-DOUJI-CHK-SEC
                       ELSE
      *                    Ï«ºÒÅù
                           PERFORM 100011-RSI-DOUJI-CHK-SEC
                       END-IF
                   END-PERFORM
      *
                   MOVE    "key2"              TO  MCP-PATHNAME
                   PERFORM 930-SRYACT-READ-SEC
               END-PERFORM
               MOVE    "tbl_sryact"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 990-DBCLOSE-SEC
      *
           END-PERFORM
      *
           IF    ((FLG-SINSATU         =   1   )  OR
                  (FLG-SYONIKA         =   1   ))  AND
                  (FLG-SYOSIN          =   ZERO )
               MOVE    ZERO            TO  FLG-CHK
           ELSE
               MOVE    1               TO  FLG-CHK
           END-IF
      *
      *    ½é¿ÇÎÁ»»Äê»þ¡¢²ó¿ô¤ò¥¯¥ê¥¢¤¹¤ë
           IF      FLG-SYOSIN          =   1
               MOVE    ZERO            TO  SPA-SINSATU-CNT
           END-IF
      *
           .
       10001-DOUJI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    °ìÈÌÆ±ÆüÂ¾²Ê»»Äê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       100011-IPN-DOUJI-CHK-SEC        SECTION.
      *
      *    ¿Ç»¡ÎÁ¸¡º÷
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
               AT   END
                   MOVE    ZERO               TO  FLG-ARI
                   MOVE    SPACE              TO  WRK-KBN
                   MOVE    SPACE              TO  WRK-KBN2
               WHEN   SRY-SRYCD (IDY)     =   TBL-SRYCD (TBL-IDX)
                   MOVE    1                  TO  FLG-ARI
                   MOVE    TBL-KBN  (TBL-IDX) TO  WRK-KBN
                   MOVE    TBL-KBN2 (TBL-IDX) TO  WRK-KBN2
           END-SEARCH
      *
           IF      FLG-ARI         =   1
               MOVE    1               TO  FLG-SINSATU
      *        ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¤¢¤ê
               IF      SRY-SRYCD(IDY)(1:3)     =   "113"
                   MOVE    1           TO  FLG-SYONIKA
               END-IF
      *        £±£µºÐÌ¤Ëþ¤Î¼õ¿Ç¤¢¤ê
               IF      JYURRK-SRYYMD       <   WRK-BIRTHDAY
                   MOVE    1               TO  FLG-15MIMAN
               END-IF
           ELSE
               EVALUATE    SRY-SRYCD (IDY)
      *            ºßÂð´µ¼ÔË¬Ìä¿Ç»¡ÎÁ
                   WHEN    "114001110"
      *            ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ
                   WHEN    "114007610"
                   WHEN    "114007710"
                       MOVE    1               TO  FLG-SINSATU
      *            £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁ
                   WHEN    "099110001"
                   WHEN    "099120001"
                       MOVE    1               TO  FLG-SINSATU
               END-EVALUATE
      *        °Ê³°¤ÎÈ½Äê
               IF     (SRY-SRYCD (IDY)(1:1)    =   "1" )  OR
                      (FLG-SINSATU             =   ZERO )
                   PERFORM 1000112-SIDOU-CHK-SEC
               END-IF
           END-IF
      *    ½é¿ÇÎÁ¤Ï»»Äê³°¤È¤¹¤ë
           IF     (SRY-SRYKBN          =   "11" )  OR
                  (SRY-SRYCD(IDY)      =   "113003510"  OR
                                           "113003710" )
               MOVE    1               TO  FLG-SYOSIN
           END-IF
      *
           IF      FLG-SINSATU         =   1
               MOVE    1               TO  FLG-SINSATU2
           END-IF
      *
           .
       100011-IPN-DOUJI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒÅùÆ±ÆüÂ¾²Ê»»Äê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       100011-RSI-DOUJI-CHK-SEC                  SECTION.
      *
      *    ¿Ç»¡ÎÁ¸¡º÷
           SET     TBL-RSI              TO  1
           SEARCH  TBL-RSI-SINSATU-OCC  VARYING   TBL-RSI
              AT   END
                   MOVE    ZERO               TO  FLG-ARI
                   MOVE    ZERO               TO  WRK-KAISU
                   MOVE    SPACE              TO  WRK-KBN
               WHEN    SRY-SRYCD (IDY)    =   TBLR-SRYCD (TBL-RSI)
                   MOVE    1                  TO  FLG-ARI
                   MOVE    TBLR-KAISU (TBL-RSI)   TO  WRK-KAISU
                   MOVE    TBLR-KBN   (TBL-RSI)   TO  WRK-KBN
           END-SEARCH
           IF      WRK-KBN             =   "S"  OR  "F"
               MOVE    1              TO  FLG-ARI
           ELSE
               MOVE    ZERO           TO  FLG-ARI
           END-IF
      *
           IF      FLG-ARI             =   1
               MOVE    1               TO  FLG-SINSATU
           ELSE
      *
      *        °ìÈÌ¤Î¿Ç»¡ÎÁ¤ò¸¡º÷¤¹¤ë¡ÊÅÅÏÃºÆ¿ÇÅù¡Ë
               SET     TBL-IDX             TO  1
               SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                   AT   END
                       MOVE    ZERO           TO  FLG-ARI
                   WHEN   SRY-SRYCD (IDY)     =   TBL-SRYCD (TBL-IDX)
      **************   IF      TBL-KBN (TBL-IDX)  =   "T" OR
      *************                                   "S"
                           MOVE    1               TO  FLG-ARI
                           MOVE    1               TO  FLG-SINSATU
      ***************  ELSE
      *                    MOVE    ZERO            TO  FLG-ARI
      ***************  END-IF
               END-SEARCH
      *
               EVALUATE    SRY-SRYCD (IDY)
      *            £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁ
                   WHEN    "099110001"
                   WHEN    "099120001"
                       MOVE    1               TO  FLG-SINSATU
               END-EVALUATE
      *        °Ê³°¤ÎÈ½Äê
               IF     (SRY-SRYCD (IDY)(1:1)    =   "1" )  OR
                      (FLG-SINSATU             =   ZERO )
                   PERFORM 1000112-SIDOU-CHK-SEC
               END-IF
           END-IF
      *
           IF      FLG-SINSATU         =   1
               MOVE    1               TO  FLG-SINSATU2
           END-IF
      *
      *    ½é¿ÇÎÁ¤Ï»»Äê³°¤È¤¹¤ë
           IF     (SRY-SRYKBN          =   "11" )  AND
                  (FLG-SINSATU         =   1    )
               MOVE    1               TO  FLG-SYOSIN
           END-IF
      *
      *    È¯¾ÉÆü¤«¤é£³·î°ÊÆâ¤ÏÂÐ¾Ý³°¤È¤¹¤ë
           IF      JYURRK-SRYYMD       <   WRK-HASSYOYMD
               MOVE    1               TO  FLG-CHK
               MOVE    ZERO            TO  FLG-SINSATU
           END-IF
           .
       100011-RSI-DOUJI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿Ç»¡ÎÁÊñ³ç¤ÎÈ½Äê½èÍý
      *****************************************************************
       1000112-SIDOU-CHK-SEC          SECTION.
      *
           MOVE    SRY-SRYCD (IDY)     TO  TNS-SRYCD
           PERFORM 910-TENSU-READ-SEC
           IF      FLG-TENSU           =   1
               GO      TO      1000112-SIDOU-CHK-EXT
           END-IF
      *    ¼ÂÆü¿ô¡¢Æü¿ô¡¦²ó¿ôÈ½Äê
           IF     (TNS-JITUDAY         =   2  )  AND
                  (TNS-DAYCNT          =   2  )
               MOVE    1               TO  FLG-SINSATU
           END-IF
      *
           .
       1000112-SIDOU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Åö·î»»Äê²ó¿ô¤òµá¤á¤ë½èÍý
      *****************************************************************
       1001-TOUGETU-KAISU-SEC          SECTION.
      *
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ²ó¿ô¥Á¥§¥Ã¥¯
           MOVE    ZERO                TO  WRK-NYUYOJI
           MOVE    ZERO                TO  WRK-DAYCNT-SUM
      *    ºßÂðÎÅÍÜ»ØÆ³ÎÁ»»Äê
           MOVE    ZERO                TO  WRK-ZAITAKU-CNT
      *    ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê
           MOVE    ZERO                TO  SPA-NETAKIRI-ARI
           MOVE    ZERO                TO  SPA-NETAKIRI-ARI2
      *    ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ
           MOVE    ZERO                TO  SPA-ZAIMATU-ARI
           MOVE    ZERO                TO  SPA-ZAIMATU-ARI2
      *    À¸³è½¬´·ÉÂ
           MOVE    ZERO                TO  SPA-SEIKATU-ARI
           MOVE    ZERO                TO  SPA-SEIKATU-ARI2
      *    ËýÀ­áÖÄË¼ÀÉÂ´ÉÍýÎÁ
           MOVE    ZERO                TO  SPA-TOKUTEI-KNJ2
      *    ÃÔÊò´µ¼ÔºßÂð»ØÆ³´ÉÍýÎÁ¡Ê³°Íè²Ã»»ÉÕ²Ã»»ÄêÉÕ²Ã¡Ë
           MOVE    ZERO                TO  SPA-GAIRAI-NASI
      *    ¾Ã±êÄÃÄËÅù½èÃÖ
           MOVE    ZERO                TO  SPA-SYOEN-CNT
      *
      *    Êñ³ç¤Þ¤È¤áÆþÎÏÂÐ¾Ý³°
           IF      SPA-HKNCOMBINUM     =   "9999"
               GO      TO      1001-TOUGETU-KAISU-EXT
           END-IF
      *    ÄûÀµ¤Ç¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¤ò»»ÄêºÑ¤ß¤Î¾ì¹ç
           MOVE    ZERO                TO  FLG-SYONIKA-TEI
           IF      SPA-SYORIFLG        =   1
               PERFORM VARYING    IDX-T    FROM    1   BY  1
                       UNTIL     (IDX-T    >   SPA-MAX-LINE )  OR
                                 (SPA-K02-TEI-SRYCD(IDX-T) =   SPACE)
                   EVALUATE    SPA-K02-TEI-SRYCD(IDX-T)
      *        ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê
                       WHEN    "113003510"
                       WHEN    "113003610"
                       WHEN    "113003710"
                       WHEN    "113003810"
                           MOVE    1           TO  FLG-SYONIKA-TEI
                           MOVE    SPA-MAX-LINE    TO  IDX-T
                   END-EVALUATE
               END-PERFORM
           END-IF
      *
      *    µÞÀ­È¯À¸Æü·èÄê
           PERFORM 10019-KYUSEI-CHK-SEC
      *
      *    »»ÄêÍúÎò¸¡º÷
           MOVE    SPACE               TO  SANTEI-REC
           INITIALIZE                  SANTEI-REC
           MOVE    SPA-HOSPNUM         TO  SANTEI-HOSPNUM
           MOVE    SPA-PTID            TO  SANTEI-PTID
           MOVE    SPA-SRYYMD (1:6)    TO  SANTEI-SRYYM
      *
           MOVE    SANTEI-REC          TO  MCPDATA-REC
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SANTEI
           END-IF
      *
           PERFORM
               UNTIL       FLG-SANTEI      =   1
      *
               IF      SANTEI-MSANTEICNT   >   ZERO
      *            Åö·î»»ÄêÊ¬
                   PERFORM 10011-TOUGETU-CHK-SEC
               END-IF
      *
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           END-PERFORM
      *
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       1001-TOUGETU-KAISU-EXT.
           EXIT.
      *
      *****************************************************************
      *    Åö·î»»ÄêÊ¬½èÍý
      *****************************************************************
       10011-TOUGETU-CHK-SEC                  SECTION.
      *
      *    ÊÝ¸±Ëè¤Î¥³¡¼¥É¤ÎÈ½Äê
           MOVE    SANTEI-SRYCD        TO  WRK-SRYCD
           PERFORM 1000-SANTEI-CHK-SEC
           IF      FLG-HKNSAN          =   1
      *        °ìÈÌ¤ÎÊÝ¸±¤Çº£²ó¤¬Ï«ºÒ¤Î»þÂÐ¾Ý³°
               IF      (SANTEI-HKNCOMBINUM     =   ZERO )  AND
                       (SPA-HKNKBN             =   1     )
                   GO      TO      10011-TOUGETU-CHK-EXT
               END-IF
      *        Ï«ºÒ¤ÎÊÝ¸±¤Çº£²ó¤¬°ìÈÌ
               IF      (SANTEI-HKNCOMBINUM NOT =   ZERO )  AND
                       (SPA-HKNKBN             =   ZERO )
                   GO      TO      10011-TOUGETU-CHK-EXT
               END-IF
      *        Ï«ºÒ¤ÎÊÝ¸±¤Çº£²ó¤¬Ï«ºÒ¤Î»þÈ½Äê
               IF      (SANTEI-HKNCOMBINUM NOT =   ZERO )  AND
                       (SPA-HKNKBN             =   1    )  AND
                       (SANTEI-HKNCOMBINUM NOT =   SPA-HKNCOMBINUM)
                   GO      TO      10011-TOUGETU-CHK-EXT
               END-IF
           END-IF
      *
      *    ¾å¸Â£±Æü
           MOVE    ZERO                TO  WRK-DAYCNT
           IF     (SPA-SRYYMD(7:2)     NUMERIC   )  AND
                  (SPA-SRYYMD(7:2)     >   ZERO  )
               MOVE    SPA-SRYYMD(7:2)     TO  IDX-Y2
               MOVE    SANTEI-DAY (IDX-Y2) TO  WRK-DAYCNT
           END-IF
      *
      *    ÄûÀµ¤Î»þ¡¢ÄûÀµÊ¬¤Ï¥«¥¦¥ó¥È¤·¤Ê¤¤
           IF      SPA-SYORIFLG        =   1
      *        ÄûÀµ¤Î»þ¡¢»»Äê¤·¤Æ¤¤¤¿¿ÇÎÅ¥³¡¼¥É¤«¤Î¥Á¥§¥Ã¥¯
               MOVE    ZERO                TO  WRK-TEI-KAISU
               PERFORM VARYING     IDX-T   FROM    1   BY  1
                       UNTIL      (IDX-T       >   SPA-MAX-LINE )  OR
                                  (SPA-K02-TEI-SRYCD(IDX-T)  =   SPACE)
                   IF      SPA-K02-TEI-SRYCD(IDX-T)    =   SANTEI-SRYCD
                       MOVE    SPA-K02-TEI-KAISU (IDX-T)
                                                   TO  WRK-TEI-KAISU
                       MOVE    SPA-MAX-LINE            TO  IDX-T
                   END-IF
               END-PERFORM
               MOVE    SPA-SRYYMD(7:2)     TO  IDX-Y2
               IF     (SANTEI-DAY (IDX-Y2) >   ZERO )  AND
                      (SANTEI-MSANTEICNT   >   ZERO )
                   IF      WRK-TEI-KAISU   =   ZERO
                       CONTINUE
                   ELSE
                       COMPUTE SANTEI-MSANTEICNT
                                           =   SANTEI-MSANTEICNT
                                           -   WRK-TEI-KAISU
                       MOVE    ZERO                TO  WRK-DAYCNT
                   END-IF
               END-IF
           END-IF
      *
      *    ¾Ã±êÄÃÄË½èÃÖ¤Î»þ¡¢ÄûÀµÆü¤Þ¤Ç¤Î²ó¿ô¤È¤¹¤ë
           MOVE    ZERO                TO  WRK-SYOEN-CNT
      *    µÞÀ­È¯À¸Æü°ÊÁ°¤ÏÂÐ¾Ý³°
           IF     (SPA-KYUSEI-YMD  NOT =   SPACE )  AND
                  (SPA-KYUSEI-YMD(1:6) =   SPA-SRYYMD(1:6))
               MOVE    SPA-KYUSEI-YMD(7:2)     TO  IDX-STR
           ELSE
               MOVE    1                       TO  IDX-STR
           END-IF
      *
           IF      SPA-SYORIFLG        =   1
               MOVE    SPA-SRYYMD(7:2)     TO  IDX-Y2
           ELSE
               MOVE    32                  TO  IDX-Y2
           END-IF
           PERFORM VARYING     IDX-Y3  FROM  IDX-STR  BY  1
                   UNTIL       IDX-Y3  >=    IDX-Y2
               ADD     SANTEI-DAY (IDX-Y3)
                                           TO  WRK-SYOEN-CNT
           END-PERFORM
      *
           EVALUATE    SANTEI-SRYCD
      *        ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê
               WHEN    "113003510"
               WHEN    "113003610"
               WHEN    "113003710"
               WHEN    "113003810"
                   ADD     SANTEI-MSANTEICNT   TO  WRK-NYUYOJI
                   ADD     WRK-DAYCNT          TO  WRK-DAYCNT-SUM
      *!           IF     (FLG-SYONIKA-TEI     =   ZERO) AND
      *!                  (SANTEI-DAY (IDX-Y2) >   ZERO)
      *!               ADD    SANTEI-DAY (IDX-Y2)  TO  WRK-DAYCNT-SUM
      *!           END-IF
      *        ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê¡Ê±¡³°¡Ë
               WHEN    "114701210"
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    1                   TO  SPA-NETAKIRI-ARI2
                   END-IF
      *        ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê¡Ê±¡Æâ¡Ë
               WHEN    "114701710"
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    2                   TO  SPA-NETAKIRI-ARI2
                   END-IF
      *        ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ¡Ê±¡³°½èÊý¡Ë
               WHEN    "114007610"
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    1                   TO  SPA-ZAIMATU-ARI2
                   END-IF
      *        ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ¡Ê±¡Æâ½èÊý¡Ë
               WHEN    "114007710"
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    2                   TO  SPA-ZAIMATU-ARI2
                   END-IF
      *
      *        ¹â·ì°µ¾É
               WHEN    "113003910"
               WHEN    "113004010"
      *        ¹â»é·ì¾É
               WHEN    "113005810"
               WHEN    "113006010"
      *        ÅüÇ¢ÉÂ
               WHEN    "113005910"
               WHEN    "113006110"
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    1                   TO  SPA-SEIKATU-ARI
                       MOVE    1                   TO  SPA-SEIKATU-ARI2
                   END-IF
      *        ÃÔÊò´µ¼ÔºßÂð»ØÆ³´ÉÍýÎÁ
               WHEN    "113700310"
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    1               TO  SPA-GAIRAI-NASI
                   END-IF
      *        ´ï¶ñÅù¤Ë¤è¤ëÎÅË¡
               WHEN    "140040310"
      *        ¼¾ÉÛ½èÃÖ£±
               WHEN    "140002210"
      *        ¼¾ÉÛ½èÃÖ£²
               WHEN    "140002310"
                   ADD     WRK-SYOEN-CNT       TO  SPA-SYOEN-CNT
      *        ²ðÃ£¸£°ú
               WHEN    "140048010"
                   ADD     WRK-SYOEN-CNT       TO  SPA-SYOEN-CNT
      *        ºßÂðÎÅÍÜ»ØÆ³ÎÁ¤ÎÈ½Äê
               WHEN    OTHER
                   IF      SANTEI-SRYCD(1:3)   =   "114"
                       MOVE    SANTEI-SRYCD        TO  TNS-SRYCD
                       PERFORM 9101-TENSU-READ2-SEC
                       IF      (FLG-TENSU          =   ZERO ) AND
                               (TNS-CDKBN-KBN      =   "C"  ) AND
                               (TNS-CDKBN-KBNNUM   >=  "100" AND
                                                   <=  "112")
                           ADD     SANTEI-MSANTEICNT
                                               TO  WRK-ZAITAKU-CNT
                       END-IF
                   END-IF
           END-EVALUATE
      *
           .
       10011-TOUGETU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    µÞÀ­È¯À¸Æü·èÄê½èÍý
      *****************************************************************
       10019-KYUSEI-CHK-SEC            SECTION.
      *
           MOVE    ZERO                TO  SPA-KYUSEI-FLG
           MOVE    SPACE               TO  SPA-KYUSEI-180
           MOVE    SPACE               TO  SPA-KYUSEI-90
           MOVE    SPACE               TO  SPA-KYUSEI-YMD
           MOVE    SPACE               TO  SPA-GMN-KYUSEI
      *    µÞÀ­È¯À¸Æü
           MOVE    "099800101"         TO  WRK-SRYCD
           PERFORM 100191-KYUSEI-SANTEI-SEC
           MOVE    WRK-YMD             TO  SPA-KYUSEI-YMD
      *
      *    µÞÀ­È¯À¸½ªÎ»Æü
           MOVE    "099800102"         TO  WRK-SRYCD
           PERFORM 100191-KYUSEI-SANTEI-SEC
      *    ÄûÀµ¤Î»þÅöÆü¤Ê¤é¡¢ÂÐ¾Ý³°
           IF      SPA-SYORIFLG        =   1
               IF      WRK-YMD         =   SPA-SRYYMD
                   MOVE    SPACE           TO  WRK-YMD
               END-IF
           END-IF
           IF     (WRK-YMD         NOT =   SPACE ) AND
                  (WRK-YMD             <=  SPA-SRYYMD    )  AND
                  (WRK-YMD             >   SPA-KYUSEI-YMD)
               MOVE    WRK-YMD             TO  SPA-KYUSEI-END
           ELSE
               MOVE    SPACE               TO  SPA-KYUSEI-END
           END-IF
      *
           IF     (SPA-KYUSEI-YMD  NOT =   SPACE )  AND
                 ((SPA-KYUSEI-YMD      >   SPA-KYUSEI-END)  OR
                  (SPA-KYUSEI-END      =   SPA-SRYYMD    ))
               PERFORM 100192-KYUSEI-HENSYU-SEC
           END-IF
      *
      *    µÞÀ­È¯À¸Æü¤¬½ýÉÂÆü¤è¤ê¸å¤Î¾ì¹ç¡¢µÞÀ­È¯À¸Æü¤«¤é£¶¥ö·î¸å¤È¤¹¤ë
           IF     (SPA-HKNKBN          =   1        )  AND
                  (SPA-RSI-SHOBYOYMD   NOT =   SPACE ) AND
                  (SPA-RSI-SHOBYOYMD   <   SPA-KYUSEI-YMD )
               MOVE    SPA-KYUSEI-YMD      TO  WRK-HASSYOYMD
               COMPUTE WRK-HAS-MM          =   WRK-HAS-MM
                                           +   6
               IF      WRK-HAS-MM          >   12
                   COMPUTE WRK-HAS-MM      =   WRK-HAS-MM    -   12
                   COMPUTE WRK-HAS-YY      =   WRK-HAS-YY    +   1
               END-IF
               MOVE    WRK-HASSYOYMD       TO  SPA-RSI-SHOBYOYMD3
           END-IF
      *
           .
       10019-KYUSEI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    µÞÀ­È¯À¸Æü»»ÄêÆü½èÍý
      *****************************************************************
       100192-KYUSEI-HENSYU-SEC                  SECTION.
      *
      *    180Æü¸å·×»»
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY6-AREA
           MOVE    "61"                TO  LNK-DAY6-IRAI
           MOVE    SPA-KYUSEI-YMD      TO  LNK-DAY6-KIJUN
           MOVE    "1"                 TO  LNK-DAY6-ZOGENPTN
           MOVE    180                 TO  LNK-DAY6-ZOGEN
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY6-AREA
           MOVE    LNK-DAY6-KEISAN     TO  SPA-KYUSEI-180
      *
      *    90Æü¸å
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY6-AREA
           MOVE    "61"                TO  LNK-DAY6-IRAI
           MOVE    SPA-KYUSEI-YMD      TO  LNK-DAY6-KIJUN
           MOVE    "1"                 TO  LNK-DAY6-ZOGENPTN
           MOVE    90                  TO  LNK-DAY6-ZOGEN
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY6-AREA
           MOVE    LNK-DAY6-KEISAN     TO  SPA-KYUSEI-90
      *
      *    ²èÌÌÉ½¼¨ÍÑ
           MOVE    SPACE               TO  WRK-HENSYU-AREA
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY2-AREA
           MOVE    "21"                TO  LNK-DAY2-IRAI
           MOVE    SPA-KYUSEI-YMD      TO  LNK-DAY2-YMD
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY2-AREA
           MOVE    LNK-DAY2-EDTYMD1    TO  WRK-KYUSEI-YMD
      *
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY2-AREA
           MOVE    "21"                TO  LNK-DAY2-IRAI
           MOVE    SPA-KYUSEI-90       TO  LNK-DAY2-YMD
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY2-AREA
           MOVE    LNK-DAY2-EDTYMD1    TO  WRK-KYUSEI-90
      *
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY2-AREA
           MOVE    "21"                TO  LNK-DAY2-IRAI
           MOVE    SPA-KYUSEI-180      TO  LNK-DAY2-YMD
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY2-AREA
           MOVE    LNK-DAY2-EDTYMD1    TO  WRK-KYUSEI-180
      *
           STRING   "µÞÀ­È¯¾ÉÆü¡§"     DELIMITED  BY  SIZE
                   WRK-KYUSEI-YMD      DELIMITED  BY  SIZE
                   "¡¡£¹£°Ä¶¡§"        DELIMITED  BY  SIZE
                   WRK-KYUSEI-90       DELIMITED  BY  SIZE
                   "¡¡£±£¸£°Ä¶¡§"      DELIMITED  BY  SIZE
                   WRK-KYUSEI-180      DELIMITED  BY  SIZE
                   INTO                SPA-GMN-KYUSEI
           END-STRING
      *
           .
       100192-KYUSEI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    µÞÀ­È¯À¸Æü»»ÄêÆü½èÍý
      *****************************************************************
       100191-KYUSEI-SANTEI-SEC                  SECTION.
      *
           MOVE    WRK-SRYCD           TO  TNS-SRYCD
      *    »»ÄêÍúÎò¸¡º÷
           MOVE    SPACE               TO  SANTEI-REC
           INITIALIZE                  SANTEI-REC
           MOVE    SPA-HOSPNUM         TO  SANTEI-HOSPNUM
           MOVE    SPA-PTID            TO  SANTEI-PTID
           MOVE    WRK-SRYCD           TO  SANTEI-SRYCD
           MOVE    ZERO                TO  SANTEI-NYUGAIKBN
           MOVE    ZERO                TO  SANTEI-SRYKA
      *
      *    Ï«ºÒËè¤È¤¹¤ë
           IF      SPA-HKNKBN          =   1
               MOVE    SPA-HKNCOMBINUM     TO  SANTEI-HKNCOMBINUM
           ELSE
               MOVE    ZERO                TO  SANTEI-HKNCOMBINUM
           END-IF
      *
           MOVE    SANTEI-REC          TO  MCPDATA-REC
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key3"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key3"              TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SANTEI
           END-IF
      *
           MOVE    SPACE               TO  WRK-YMD
           PERFORM
               UNTIL       FLG-SANTEI      =   1
      *
               IF     (SANTEI-MSANTEICNT   >   ZERO )  AND
                      (SANTEI-SRYYM        <=  SPA-SRYYMD(1:6))
      *            ºÇ¸å¤ÎÈ¯À¸Æü¡¢ÅöÆü°Ê¹ß¤ÏÂÐ¾Ý³°
                   IF      SANTEI-SRYYM        =   SPA-SRYYMD(1:6)
                       MOVE    SPA-SRYYMD(7:2)     TO  IDX-Y3
                   ELSE
                       MOVE    31                  TO  IDX-Y3
                   END-IF
                   MOVE    ZERO                TO  WRK-DD
                   PERFORM VARYING     IDX-Y2  FROM    IDX-Y3  BY  -1
                           UNTIL       IDX-Y2  <   1
                       IF      SANTEI-DAY (IDX-Y2) >   ZERO
                           MOVE    IDX-Y2          TO  WRK-DD
                           MOVE    1               TO  IDX-Y2
                       END-IF
                   END-PERFORM
                   IF      WRK-DD              >   ZERO
                       MOVE    SANTEI-SRYYM    TO  WRK-YMD(1:6)
                       MOVE    1               TO  FLG-SANTEI
                   END-IF
               END-IF
      *
               IF     FLG-SANTEI           =   ZERO
                   MOVE    "tbl_santei"        TO  MCP-TABLE
                   MOVE    "key3"              TO  MCP-PATHNAME
                   PERFORM 920-SANTEI-READ-SEC
               END-IF
           END-PERFORM
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key3"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           IF      WRK-YMD(1:6)        =   SPACE
               MOVE    SPACE           TO  WRK-YMD
           END-IF
      *
           .
       100191-KYUSEI-SANTEI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê²ó¿ô½èÍý
      *****************************************************************
       1001-SYONIKA-CHK-SEC                  SECTION.
      *
           MOVE    ZERO                TO  FLG-SYONIKA-ARI
           MOVE    ZERO                TO  SPA-SYONIKA-ARI3
      *
      *    Êñ³ç¤Þ¤È¤áÆþÎÏÂÐ¾Ý³°
           IF      SPA-HKNCOMBINUM     =   "9999"
               GO      TO      1001-SYONIKA-CHK-EXT
           END-IF
      *
      *    £³ºÐ¤Ë¤Ê¤ëÇ¯·îÆü¤ò·×»»
           MOVE    SPA-BIRTHDAY        TO  WRK-BIRTHDAY
           COMPUTE WRK-BIRTH-YY        =   WRK-BIRTH-YY    +  3
      *    3ºÐÌ¤Ëþ¤ËÅ¬ÍÑ
           IF      WRK-BIRTHDAY(1:6)   <   SPA-SRYYMD (1:6)
               GO      TO      1001-SYONIKA-CHK-EXT
           END-IF
      *
      *    £³ºÐ¤ÎÅö·î»þ¡¢Åö·î»»Äê¤¬¤Ê¤±¤ì¤ÐÂÐ¾Ý³°
           IF     (SPA-NENREI-YY   =   3               )  AND
                  (WRK-BIRTHDAY(1:6)   =   SPA-SRYYMD (1:6))
               IF      WRK-NYUYOJI         =   ZERO
                   GO      TO      1001-SYONIKA-CHK-EXT
               END-IF
           END-IF
      *
      *    ÅöÆü»»Äê¤¬¤¢¤ì¤Ð¥Õ¥é¥°¤òÎ©¤Æ¤ë
           IF      WRK-DAYCNT-SUM      >   ZERO
               MOVE    1                   TO  SPA-SYONIKA-ARI2
           ELSE
               MOVE    ZERO                TO  SPA-SYONIKA-ARI2
           END-IF
      *    ¾®»ù²ÊÂÐ¾Ý
           MOVE    1                   TO  FLG-SYONIKA-ARI
           MOVE    1                   TO  SPA-SYONIKA-ARI3
      *
           .
       1001-SYONIKA-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê¼«Æ°»»Äê½èÍý
      *****************************************************************
       1002-NETAKIRI-CHK-SEC          SECTION.
      *
      *
      *    Êñ³ç¤Þ¤È¤áÆþÎÏÂÐ¾Ý³°
           IF      SPA-HKNCOMBINUM     =   "9999"
               GO      TO      1002-NETAKIRI-CHK-EXT
           END-IF
      *
      **** MOVE    ZERO                TO  FLG-TOUG-SANTEI
      **** MOVE    ZERO                TO  SPA-NETAKIRI-ARI
           MOVE    ZERO                TO  SPA-NETAKIRI-ARI4
      *    ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê»»Äê½ªÎ»
           MOVE    "099140001"         TO  WRK-SRYCD
           PERFORM 100191-KYUSEI-SANTEI-SEC
      *
           MOVE    ZERO                TO  WRK-SANTEI-CNT
      *    ±¡³°½èÊý¤¢¤ê
           MOVE    "114701210"         TO  WRK-SRYCD
           PERFORM 33051-JYURRK-MAECHK-SEC
      *    Åö·î»»Äê¤¢¤ê
           IF      FLG-TOUG-SANTEI     >=  1
               MOVE    1                   TO  SPA-NETAKIRI-ARI2
           ELSE
               MOVE    WRK-SANTEI-YM       TO  WRK-SANTEI-ARI
               IF      WRK-SANTEI-YM   NOT =   SPACE
                   MOVE    1               TO  SPA-NETAKIRI-ARI4
               END-IF
      *        ±¡³°½èÊý¤Ê¤·
               MOVE    "114701710"         TO  WRK-SRYCD
               PERFORM 33051-JYURRK-MAECHK-SEC
      *        Åö·î»»Äê¤¢¤ê
               IF      FLG-TOUG-SANTEI     >=  1
                   MOVE    2                   TO  SPA-NETAKIRI-ARI2
               END-IF
               IF      WRK-SANTEI-YM   NOT =   SPACE
                   MOVE    1               TO  SPA-NETAKIRI-ARI4
               END-IF
               MOVE    WRK-SANTEI-YM       TO  WRK-SANTEI-NASI
           END-IF
      *    Åö·î»»Äê²ó¿ô
           MOVE    WRK-SANTEI-CNT      TO  WRK-NETAKIRI-CNT
      *
      *    ½ªÎ»Æü¤Ë¤è¤ê¼«Æ°È¯À¸ÊÑ¹¹
           IF      WRK-YMD         NOT =   SPACE
               IF     (WRK-SANTEI-NASI NOT =   SPACE )  AND
                      (WRK-YMD(1:6)        >=  WRK-SANTEI-NASI)
                   MOVE    SPACE           TO  WRK-SANTEI-NASI
               END-IF
               IF     (WRK-SANTEI-ARI  NOT =   SPACE )  AND
                      (WRK-YMD(1:6)        >=  WRK-SANTEI-ARI)
                   MOVE    SPACE           TO  WRK-SANTEI-ARI
               END-IF
           END-IF
      *
      *    £²£´»þ´ÖÏ¢ÂÓ²Ã»»
           MOVE    SPACE               TO  WRK-24KSAN-SRYCD
           IF     (WRK-SANTEI-NASI     NOT =   SPACE )  OR
                  (WRK-SANTEI-ARI      NOT =   SPACE )
               PERFORM 10021-24KASAN-SET-SEC
           ELSE
               MOVE    ZERO            TO  SPA-NETAKIRI-ARI4
               MOVE    ZERO            TO  WRK-NETAKIRI-CNT
           END-IF
      *
           .
       1002-NETAKIRI-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Ï·¿ÍËýÀ­¼À´µ³°ÍèÁí¹ç¿ÇÎÅ²Ê»»Äê²ó¿ô½èÍý
      *****************************************************************
       10021-24KASAN-SET-SEC          SECTION.
      *
      *    »»ÄêÍúÎò¸¡º÷
           MOVE    SPACE               TO  SANTEI-REC
           INITIALIZE                  SANTEI-REC
           MOVE    SPA-HOSPNUM         TO  SANTEI-HOSPNUM
           MOVE    SPA-PTID            TO  SANTEI-PTID
      *
           IF     (WRK-SANTEI-NASI     NOT =   SPACE )  AND
                  (WRK-SANTEI-NASI         >   WRK-SANTEI-ARI)
               MOVE    WRK-SANTEI-NASI     TO  SANTEI-SRYYM
           ELSE
               MOVE    WRK-SANTEI-ARI      TO  SANTEI-SRYYM
           END-IF
      **** MOVE    WRK-SANTEI-NASI     TO  SANTEI-SRYYM
      *
           MOVE    SANTEI-REC          TO  MCPDATA-REC
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SANTEI
           END-IF
      *
           PERFORM
               UNTIL       FLG-SANTEI      =   1
      *
               IF      SANTEI-MSANTEICNT   >   ZERO
      *            Åö·î»»ÄêÊ¬
                   EVALUATE    SANTEI-SRYCD
                       WHEN    "114701870"
                       WHEN    "114703970"
                       WHEN    "114703770"
                           MOVE     SANTEI-SRYCD   TO  WRK-24KSAN-SRYCD
                           MOVE    1               TO  FLG-SANTEI
                   END-EVALUATE
               END-IF
      *
               IF      FLG-SANTEI          =   ZERO
                   MOVE    "key2"              TO  MCP-PATHNAME
                   PERFORM 920-SANTEI-READ-SEC
               END-IF
           END-PERFORM
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           .
       10021-24KASAN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ËýÀ­áÖÄË¼ÀÉÂ´ÉÍýÎÁ»»Äê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       1004-TOUTUU-CHK-SEC              SECTION.
      *
      *    Êñ³ç¤Þ¤È¤áÆþÎÏÂÐ¾Ý³°
           IF      SPA-HKNCOMBINUM     =   "9999"
               MOVE    ZERO            TO  SPA-TOKUTEI-KNJ2
               GO      TO      1004-TOUTUU-CHK-EXT
           END-IF
      *
      *    ËýÀ­áÖÄË¼ÀÉÂ´ÉÍýÎÁ
           MOVE    "113006510"         TO  WRK-SRYCD
           PERFORM 33051-JYURRK-MAECHK-SEC
      *    Åö·î»»Äê¤¢¤ê
      *    ³°Íè´ÉÍý²Ã»»¤ò»»Äê¤·¤Ê¤¤
      *    ¸üÀ¸¾Ê¤¬Äê¤á¤ë´µ¼Ô¤Ç¤¢¤ë
           IF      FLG-TOUG-SANTEI     >   ZERO
               MOVE    1               TO  SPA-TOKUTEI-KNJ2
           ELSE
               MOVE    ZERO            TO  SPA-TOKUTEI-KNJ2
           END-IF
      *
           .
       1004-TOUTUU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒ¤Î»þ¤Î½èÍý
      *****************************************************************
       1000-SANTEI-RSI-SEC              SECTION.
      *
      *    È¯À¸Æü¤òµá¤á¤ë
      *    µßµÞ°åÎÅ´ÉÍý²Ã»»¤Î¥Á¥§¥Ã¥¯
           MOVE    SPACE               TO  WRK-HASSYOYMD
           MOVE    "101110030"         TO  WRK-SRYCD
           PERFORM 10001-RSI-JYURRK-CHK-SEC
           IF      WRK-HASSYOYMD       =   SPACE
               MOVE    SPA-RSI-SHOBYOYMD   TO  SPA-RSI-HASSYOYMD
           ELSE
               MOVE    WRK-HASSYOYMD       TO  SPA-RSI-HASSYOYMD
           END-IF
      *
      *    È¯À¸Æü¤«¤é£³¥ö·î¤Î·×»»¡Ê¸½ºß»ÈÍÑ¤Ê¤·¡Ë
           MOVE    SPA-RSI-HASSYOYMD   TO  WRK-HASSYOYMD
           COMPUTE WRK-HAS-MM          =   WRK-HAS-MM
                                       +   3
           IF      WRK-HAS-MM          >   12
               COMPUTE WRK-HAS-MM      =   WRK-HAS-MM    -   12
               COMPUTE WRK-HAS-YY      =   WRK-HAS-YY    +   1
           END-IF
           MOVE    WRK-HASSYOYMD       TO  SPA-RSI-HASSYOYMD3
      *
      *    ½ýÉÂÆü¤«¤é£¶¥ö·î¤Î·×»»
           MOVE    SPA-RSI-SHOBYOYMD   TO  WRK-HASSYOYMD
           COMPUTE WRK-HAS-MM          =   WRK-HAS-MM
                                       +   6
           IF      WRK-HAS-MM          >   12
               COMPUTE WRK-HAS-MM      =   WRK-HAS-MM    -   12
               COMPUTE WRK-HAS-YY      =   WRK-HAS-YY    +   1
           END-IF
           MOVE    WRK-HASSYOYMD       TO  SPA-RSI-SHOBYOYMD3
      *
      *    µÞÀ­È¯À¸Æü¤¬½ýÉÂÆü¤è¤ê¸å¤Î¾ì¹ç¡¢µÞÀ­È¯À¸Æü¤«¤é£¶¥ö·î¸å¤È¤¹¤ë
           IF     (SPA-HKNKBN          =   1        )  AND
                  (SPA-RSI-SHOBYOYMD   <   SPA-KYUSEI-YMD )
               MOVE    SPA-KYUSEI-YMD      TO  WRK-HASSYOYMD
               COMPUTE WRK-HAS-MM          =   WRK-HAS-MM
                                           +   6
               IF      WRK-HAS-MM          >   12
                   COMPUTE WRK-HAS-MM      =   WRK-HAS-MM    -   12
                   COMPUTE WRK-HAS-YY      =   WRK-HAS-YY    +   1
               END-IF
               MOVE    WRK-HASSYOYMD       TO  SPA-RSI-SHOBYOYMD3
           END-IF
      *
      *    ¼õ¿ÇÍúÎò¤è¤ê¿Ç»¡²ó¿ô¤òµá¤á¤ë
           PERFORM 1000-SINSATU-KAISU-SEC
      *
      *    Åö·î»»Äê²ó¿ô¤òµá¤á¤ë
           PERFORM 1001-TOUGETU-KAISU-SEC
      *
      *    ËýÀ­áÖÄË¼ÀÉÂ´ÉÍýÎÁ»»Äê¥Á¥§¥Ã¥¯
           PERFORM 1004-TOUTUU-CHK-SEC
      *
           MOVE    ZERO                TO  SPA-SYONIKA-ARI3
           MOVE    ZERO                TO  SPA-SYONIKA-ARI2
           MOVE    ZERO                TO  SPA-SYONIKA-ARI
      *
           .
       1000-SANTEI-RSI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±Ëè¤Î¥³¡¼¥É¤ÎÈ½Äê½èÍý
      *****************************************************************
       1000-SANTEI-CHK-SEC      SECTION.
      *
           SET     TBL-SAN             TO  1
           SEARCH  TBL-SANTEI-OCC      VARYING   TBL-SAN
               AT  END
                   MOVE    ZERO            TO  FLG-HKNSAN
               WHEN    WRK-SRYCD       =   TBL-SANTEI-SRYCD
                                                          (TBL-SAN)
                   MOVE    1               TO  FLG-HKNSAN
           END-SEARCH
      *
           .
       1000-SANTEI-CHK-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    »»ÄêÍúÎò¥Á¥§¥Ã¥¯½èÍý¡ÊÏ«ºÒ¡Ë
      *****************************************************************
       10001-RSI-JYURRK-CHK-SEC            SECTION.
      *
           MOVE    ZERO                TO  FLG-TOUG-SANTEI
           MOVE    SPACE               TO  WRK-SANTEI-YMD
           MOVE    SPACE               TO  WRK-HASSYOYMD
      *
           MOVE    WRK-SRYCD           TO  TNS-SRYCD
           PERFORM 910-TENSU-READ-SEC
           IF      FLG-TENSU           =   1
               GO      TO      10001-RSI-JYURRK-CHK-EXT
           END-IF
      *
      *    ÊÝ¸±Ëè¤Î¥³¡¼¥É¤ÎÈ½Äê
           PERFORM 1000-SANTEI-CHK-SEC
      *
      *    »»ÄêÍúÎò¸¡º÷
           MOVE    SPACE               TO  SANTEI-REC
           INITIALIZE                  SANTEI-REC
           MOVE    SPA-HOSPNUM         TO  SANTEI-HOSPNUM
           MOVE    SPA-PTID            TO  SANTEI-PTID
           MOVE    WRK-SRYCD           TO  SANTEI-SRYCD
           EVALUATE    TNS-SANTEIRRKKBN
               WHEN    1
                   MOVE    ZERO                TO  SANTEI-NYUGAIKBN
                   MOVE    ZERO                TO  SANTEI-SRYKA
               WHEN    2
                   MOVE    SPA-NYUGAIKBN       TO  SANTEI-NYUGAIKBN
                   MOVE    ZERO                TO  SANTEI-SRYKA
               WHEN    3
                   MOVE    ZERO                TO  SANTEI-NYUGAIKBN
                   MOVE    SPA-SRYKA           TO  SANTEI-SRYKA
               WHEN    4
                   MOVE    SPA-NYUGAIKBN       TO  SANTEI-NYUGAIKBN
                   MOVE    SPA-SRYKA           TO  SANTEI-SRYKA
           END-EVALUATE
      *
           IF     (FLG-HKNSAN          =   1   )  AND
                  (SPA-HKNKBN      NOT =   ZERO)
               MOVE    SPA-HKNCOMBINUM     TO  SANTEI-HKNCOMBINUM
           ELSE
               MOVE    ZERO                TO  SANTEI-HKNCOMBINUM
           END-IF
      *
           MOVE    SANTEI-REC          TO  MCPDATA-REC
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key3"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key3"              TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SANTEI
           END-IF
      *
           PERFORM
               UNTIL       FLG-SANTEI      =   1
      *
               IF      SANTEI-MSANTEICNT   >   ZERO
      *            ½é²ó»»ÄêÆü
                   MOVE    SANTEI-FSANTEIYMD   TO  WRK-HASSYOYMD
                   ADD     1                   TO  WRK-SANTEI-CNT
               END-IF
      *
               IF     FLG-SANTEI           =   ZERO
                  MOVE    "key3"              TO  MCP-PATHNAME
                  PERFORM 920-SANTEI-READ-SEC
               END-IF
           END-PERFORM
      *
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key3"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       10001-RSI-JYURRK-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ½é¿ÇÎÁ¼«Æ°È¯À¸½èÍý
      *****************************************************************
       200-SYOSIN-SET-SEC              SECTION.
      *
           MOVE    ZERO                TO  IDX2
           MOVE    ZERO                TO  SPA-GMN-IDX
           MOVE    ZERO                TO  SPA-GAIRAISIN
           MOVE    ZERO                TO  SPA-SYONIKA-ARI
      *
           MOVE    SPACE               TO  WRK-SRYCD
      *
      *    Êñ³ç¤Þ¤È¤áÆþÎÏÂÐ¾Ý³°
           IF      SPA-HKNCOMBINUM     =   "9999"
               GO      TO      200-SYOSIN-SET-EXT
           END-IF
      *
      *    Æþ±¡Æü¤Î»þ¡¢½é¿ÇÎÁ¤Î¤ß»»Äê¤¹¤ë
           IF      SPA-K02N-NYUINYMD(1:6)  =   SPA-NAI-SRYYMD(1:6)
               IF      SPA-SYOSIN          =   1
                   CONTINUE
               ELSE
                   GO      TO      200-SYOSIN-SET-EXT
               END-IF
           END-IF
      *
      *    Ï«ºÒ¤Î½é¿ÇÎÁ»»Äê
           IF      SPA-HKNKBN          =   1
      *      £²£°£°¾²°Ê¾å¤ÇºÆ¿Ç¤Î¾ì¹ç¡¢³°Íè¿Ç»¡ÎÁ¤È¤¹¤ë
      *      ½é¿ÇÎÁ»»Äê
             IF     (SPA-SYOSIN      NOT =   1  )  AND
                    (SPA-BEDSUIPN        >=  200 )  AND
                    (SPA-HOSPSBT         =   1   )
                 CONTINUE
             ELSE
                 MOVE    SPACE               TO  WRK-KBN
                 PERFORM 2009-RSIHKN-SET-SEC
                 IF      SPA-GMN-IDX         >   ZERO
      *            ÎÅÍÜÃ´Åö¼êÅöÈ¯À¸
                   PERFORM 330123-RYOYOU-TEATE-SEC
                 END-IF
                 GO      TO      200-SYOSIN-SET-EXT
             END-IF
           END-IF
      *
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê
           IF     (SPA-SYONIKA         =   1   )  AND
                  (SPA-NYUGAIKBN       =   "2" )  AND
                  (FLG-SYONIKA-ARI     =   1   )
               PERFORM 3303-SYONIKA-SET-SEC
               IF      FLG-SYONIKA         =   1
                   GO      TO      200-SYOSIN-SET-EXT
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  WRK-KAISU
      *
      *    ½é¿ÇÎÁ»»Äê
           IF      SPA-SYOSIN          =   1
               MOVE    "11"                TO  WRK-SRYKBN
               MOVE    "F"                 TO  WRK-KBN
      *        ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
               PERFORM 2001-SRYCD-TBL-SEC
           ELSE
      *        Æ±ÆüºÆ¿ÇÎÁ»»Äê
               MOVE    ZERO                TO  FLG-DOUJITU
               IF     ( SPA-SYORIFLG        =   ZERO     ) AND
                      ( SPA-RRK-LSTYMD      =   SPA-SRYYMD )
      *??             ((SPA-LSTYMD          =   SPA-SRYYMD ) OR
      *??              (SPA-RRK-LSTYMD      =   SPA-SRYYMD ))
                   IF      SPA-DOUJITU     NOT =   ZERO
                       MOVE    1                   TO  FLG-DOUJITU
                   END-IF
               END-IF
               IF      (SPA-SYORIFLG        =   1       )   AND
                       (WRK-DAY-SINSATUCNT  >   ZERO    )
                   MOVE    1                   TO  FLG-DOUJITU
               END-IF
               IF      FLG-DOUJITU         =   1
                   IF     (SPA-TAKA-SRYKA-R    =   SPACE ) OR
                          (LNK-SC10S-SYORI     =   "J"   )
                       MOVE    "12"                TO  WRK-SRYKBN
                       MOVE    "D"                 TO  WRK-KBN
      *                ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
                       PERFORM 2001-SRYCD-TBL-SEC
                   ELSE
                       PERFORM 3301-DOUSAISIN-SEC
                   END-IF
               ELSE
      *        ºÆ¿ÇÎÁ»»Äê
                   MOVE    "12"                TO  WRK-SRYKBN
                   MOVE    SPACE               TO  WRK-KBN
      *            ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
                   PERFORM 2001-SRYCD-TBL-SEC
               END-IF
           END-IF
      *
      *    ½é¿ÇÎÁ¼«Æ°ÄÉ²Ã½èÍý
           PERFORM 3301-SYOSIN-SYORI-SEC
      *
           IF      WRK-SRYCD(1:2)      =   "83"
               MOVE    "0109"              TO  SPA-KIDCD
           END-IF
      *    Æþ±¡Æü¤Î»þ¡¢½é¿ÇÎÁ¤Î¤ß»»Äê¤¹¤ë
           IF      SPA-K02N-NYUINYMD   =   SPA-NAI-SRYYMD
               MOVE    SPACE               TO  SPA-KIDCD
           END-IF
      *
      *    »ØÆ³ÎÁ¤Î¼«Æ°È¯À¸
           PERFORM 33012-SIDOU-SYORI-SEC
      *
           .
       200-SYOSIN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿Ç»¡ÎÁ¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê½èÍý
      *****************************************************************
       2001-SRYCD-TBL-SEC              SECTION.
      *
           MOVE    1                   TO  WRK-KAISU
           IF      WRK-SRYKBN          =   "12"
      *        °ìÈÌÉÂ¾²¿ô
               IF     (SPA-BEDSUIPN        >=  200 )  AND
                      (SPA-HOSPSBT         =   1   )
      *            200¾É°Ê¾å
                   MOVE    3               TO  WRK-KAISU
               END-IF
           END-IF
      *
      *    ¿Ç»¡ÎÁ¥»¥Ã¥È
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                   AT   END
                       MOVE    SPACE           TO  WRK-SRYCD
                   WHEN   (SPA-NAI-ROUJIN      =   TBL-ROUJIN(TBL-IDX))
                     AND  (SPA-HOSPSBT         =   TBL-HOSPSBT(TBL-IDX))
                     AND  (WRK-KAISU           =   TBL-KAISU  (TBL-IDX))
                     AND  (WRK-KBN             =   TBL-KBN    (TBL-IDX))
                     AND  (WRK-SRYKBN          =   TBL-SRYCD(TBL-IDX)
                                                                (2:2))
                       MOVE    TBL-SRYCD (TBL-IDX)
                                               TO  WRK-SRYCD
           END-SEARCH
      *
           .
       2001-SRYCD-TBL-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³°Íè´ÉÍý²Ã»»¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê½èÍý
      *****************************************************************
       2002-SRYCD-TBLG-SEC                  SECTION.
      *
      *    °ìÈÌ¤Î»þ¡¢ÉÂ±¡¡¦¿ÇÎÅ½ê¤ÏÆ±¤¸
           IF      SPA-NAI-ROUJIN      =   ZERO
               MOVE    ZERO            TO  WRK-HOSPSBT
           ELSE
               MOVE    SPA-HOSPSBT     TO  WRK-HOSPSBT
           END-IF
      *
           MOVE    SPACE               TO  WRK-KBN2
      *
      *    ¿Ç»¡ÎÁ¥»¥Ã¥È
           SET     TBLG-IDX             TO  1
           SEARCH  TBL-GAIRAI-OCC       VARYING   TBLG-IDX
                   AT   END
                       MOVE    SPACE           TO  WRK-SRYCD
                   WHEN   (SPA-NAI-ROUJIN      =   TBLG-ROUJIN
                                                             (TBLG-IDX))
                     AND  (WRK-HOSPSBT         =   TBLG-HOSPSBT
                                                             (TBLG-IDX))
                       MOVE    TBLG-SRYCD (TBLG-IDX)
                                               TO  WRK-SRYCD
           END-SEARCH
      *
           .
       2002-SRYCD-TBLG-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½é¿ÇÎÁ¼«Æ°È¯À¸½èÍý
      *****************************************************************
       3301-SYOSIN-SYORI-SEC                  SECTION.
      *
      *    ½é¿ÇÎÁ¼«Æ°ÄÉ²Ã
           PERFORM 3301-SYOSIN-HEN-SEC
      *    °Ê¹ß¤Î¼«Æ°»»Äê¤Ê¤·
           IF      FLG-ADD             =   ZERO
               GO      TO      3301-SYOSIN-SYORI-EXT
           END-IF
           ADD     1                   TO  IDX2
           IF      WRK-SRYCD(1:2)      =   "83"
               GO      TO      3301-SYOSIN-SYORI-EXT
           END-IF
      *
      *    ³°Íè¤Ç¿Ç»¡ÎÁ¤Î»þ¡¢»þ´Ö³°¶èÊ¬¤òÉÕ¤±¤ë
           IF     (SPA-SYORIFLG        =   ZERO )  AND
                  (SPA-NYUGAIKBN       =   "2"  )  AND
                  (WRK-SRYCD(1:1)      =   "1"  )  AND
                  (SPA-SRYYMD          =   SPA-SYSYMD) AND
                  (SPA-GAI-JIKANKBN    NOT =   ZERO )  AND
      *           ¿Ç»¡ÎÁºÆ»»Äê»þ¤ÏÉÕ¤±¤Ê¤¤
                  (FLG-JIKANKBN        =   ZERO )
               MOVE    SPA-GMN-INPUTCD (SPA-GMN-IDX)
                                           TO  WRK-INPUTCD
               MOVE    SPACE               TO  SPA-GMN-INPUTCD
                                                         (SPA-GMN-IDX)
               MOVE    SPA-GAI-JIKANKBN    TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(1:1)
               MOVE    WRK-INPUTCD         TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(3:)
               MOVE    SPA-GAI-JIKANKBN    TO  SPA-COM-TIMEFLG
                                                     (SPA-GMN-IDX)
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
      *
      *    °Ê¹ß¡¢ºÆ¿Ç»þ¤Î¤ß
           IF      SPA-SYOSIN          =   1
      *        °é»ù±ÉÍÜ²Ã»»¼«Æ°È¯À¸
               PERFORM 3302-IKUJIEIYO-SET-SEC
               GO      TO      3301-SYOSIN-SYORI-EXT
           END-IF
      *
      *
      *    ³°Íè¿Ç»¡ÎÁ¤Î»þ¡¢°Ê¹ß¤Ê¤·
           MOVE    ZERO                TO  SPA-GAIRAISIN
           IF      WRK-KAISU           =   3
               MOVE    1               TO  SPA-GAIRAISIN
      *
      *        ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê»»Äê½èÍý
               IF     (SPA-NAI-ROUJIN      =   1   )  AND
                      (SPA-NYUGAIKBN       =   "2" )
                   MOVE    ZERO            TO  WRK-IDX-IN
                   PERFORM 3305-NETAKIRI-SET-SEC
               END-IF
               GO      TO      3301-SYOSIN-SYORI-EXT
           END-IF
      *
      *    ºÆ¿ÇÎÁ»»Äê¡ÊÆýÍÄ»ù²Ã»»¡Ë
           MOVE    "112000970"         TO  WRK-SRYCD
      *
      *    ½é¿ÇÎÁ¼«Æ°ÄÉ²Ã
           PERFORM 3301-SYOSIN-HEN-SEC
      *    ¼«Æ°»»Äê¤¢¤ê
           IF      FLG-ADD             =   1
               ADD     1               TO  IDX2
      *        ¼«Æ°ÄÉ²ÃÊ¬
               MOVE    "1"             TO  SPA-COM-AUTOKBN(SPA-GMN-IDX)
           END-IF
      *
      *    ºÆ¿ÇÎÁ»»Äê¡ÊÍÄ»ù²Ã»»¡Ë
           MOVE    "112001070"         TO  WRK-SRYCD
      *
      *    ½é¿ÇÎÁ¼«Æ°ÄÉ²Ã
           PERFORM 3301-SYOSIN-HEN-SEC
      *    ¼«Æ°»»Äê¤¢¤ê
           IF      FLG-ADD             =   1
               ADD     1               TO  IDX2
      *        ¼«Æ°ÄÉ²ÃÊ¬
               MOVE    "1"             TO  SPA-COM-AUTOKBN(SPA-GMN-IDX)
           END-IF
      *
      *    ³°Íè´ÉÍý²Ã»»¥³¡¼¥ÉÄÉ²Ã
           IF     (SPA-SYORIFLG        =   ZERO ) OR
                  (FLG-GAI             =   1   AND
                   SPA-SYORIFLG        =   1    )
               PERFORM 2002-SRYCD-TBLG-SEC
           END-IF
      *
           PERFORM 3301-SYOSIN-HEN-SEC
           MOVE    ZERO                TO  WRK-GAIRAI-IDX
      *    ¼«Æ°»»Äê¤¢¤ê
           IF      FLG-ADD             =   1
               ADD     1               TO  IDX2
      *        ¼«Æ°ÄÉ²ÃÊ¬
      *********MOVE    "1"             TO  SPA-COM-AUTOKBN(SPA-GMN-IDX)
               MOVE    SPA-GMN-IDX     TO  WRK-GAIRAI-IDX
           END-IF
      *
      *
      *    ·ÑÂ³´ÉÍý²Ã»»ÄÉ²Ã
      *    ¡¡½é¿ÇÎÁ»»Äê·î¤ÎÈ½Äê
           IF      SPA-SYOYMD(1:6)     =   SPA-SRYYMD(1:6)
               IF      SPA-SYOYMD      <=  SPA-SRYYMD
                   CONTINUE
               ELSE
      *            ·ÑÂ³´ÉÍý²Ã»»ÄÉ²Ã½èÍý
                   PERFORM 3302-KEIZOKU-HEN-SEC
               END-IF
           ELSE
      *        ·ÑÂ³´ÉÍý²Ã»»ÄÉ²Ã½èÍý
               PERFORM 3302-KEIZOKU-HEN-SEC
           END-IF
      *
      *    ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê»»Äê½èÍý
           IF     (SPA-NAI-ROUJIN      =   1   )  AND
                  (SPA-NYUGAIKBN       =   "2" )
               MOVE    ZERO            TO  WRK-IDX-IN
               PERFORM 3305-NETAKIRI-SET-SEC
               IF     (SPA-NETAKIRI-ARI    NOT =   ZERO )  OR
                      (SPA-NETAKIRI-ARI2   NOT =   ZERO )
      *        ¿²¤¿¤­¤êÏ·¿Í¤¬Åö·î»»ÄêºÑ¤ß¤Î»þ¡¢Ï·¿ÍËýÀ­¼À´µ¤ò»»Äê¤·¤Ê¤¤
                   GO      TO      3301-SYOSIN-SYORI-EXT
               END-IF
           END-IF
      *
           .
       3301-SYOSIN-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÆ¿ÇÎÁ¼«Æ°È¯À¸½èÍý
      *****************************************************************
       3301-DOUSAISIN-SEC                  SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYCD
      *
           IF      SPA-SYOYMD          =   SPA-SRYYMD
               MOVE    "830000020"         TO  WRK-SRYCD
           ELSE
               MOVE    "830000021"         TO  WRK-SRYCD
           END-IF
      *
           MOVE    "0109"              TO  SPA-KIDCD
      *    Æþ±¡Æü¤Î»þ¡¢½é¿ÇÎÁ¤Î¤ß»»Äê¤¹¤ë
           IF      SPA-K02N-NYUINYMD   =   SPA-NAI-SRYYMD
               MOVE    SPACE               TO  SPA-KIDCD
           END-IF
      *
           .
       3301-DOUSAISIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½é¿ÇÎÁ¼«Æ°»»Äê½èÍý
      *****************************************************************
       3301-SYOSIN-HEN-SEC                SECTION.
      *
           IF     (WRK-SRYCD(1:2)      =   "83"  )   AND
                  (SPA-GMN-IDX         =   ZERO  )
               ADD     1                   TO  IDX2
               ADD     1                   TO  SPA-GMN-IDX
      *        ¿ÇÎÅ¶èÊ¬ÊÔ½¸
               IF      WRK-SRYCD           =   "830000020"
                   MOVE    ".110"          TO  SPA-GMN-INPUTCD
                                                         (SPA-GMN-IDX)
                   MOVE    "110"           TO  SPA-COM-SRYSYUKBN
                                                         (SPA-GMN-IDX)
                   MOVE    "11"            TO  SPA-COM-SRYKBN
                                                         (SPA-GMN-IDX)
               ELSE
                   MOVE    ".120"          TO  SPA-GMN-INPUTCD
                                                         (SPA-GMN-IDX)
                   MOVE    "120"           TO  SPA-COM-SRYSYUKBN
                                                         (SPA-GMN-IDX)
                   MOVE    "12"            TO  SPA-COM-SRYKBN
                                                         (SPA-GMN-IDX)
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  FLG-ADD
      *
           ADD     1                   TO  SPA-GMN-IDX
           IF      WRK-SRYCD(1:2)      =   "83"
               MOVE    SPA-TAKA-SRYKA(1)   TO  SPA-COM-ATAI1
                                                         (SPA-GMN-IDX)
               MOVE    1                   TO  SPA-FUKU-SRYKA
           END-IF
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           MOVE    "1"                 TO  LNK-SC92-KBN
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE           TO  SPA-ERRCD
               INITIALIZE              SPA-GMN-TBLREC (SPA-GMN-IDX)
               INITIALIZE              SPA-COM-TBLREC (SPA-GMN-IDX)
               COMPUTE SPA-GMN-IDX     =   SPA-GMN-IDX
                                       -   1
               GO      TO      3301-SYOSIN-HEN-EXT
           END-IF
      *    ¿ÇÎÅ¶èÊ¬¤ÎÀßÄê
           IF      SPA-COM-SRYKBN(SPA-GMN-IDX) =   SPACE
               MOVE    SPA-COM-SRYSYUKBN(SPA-GMN-IDX)
                                           TO  SPA-COM-SRYKBN
                                                         (SPA-GMN-IDX)
           END-IF
      *
           IF      WRK-SRYCD(1:2)      =   "83"
      *        ºÆÊÔ½¸½èÍý
               MOVE    SPA-GMN-IDX         TO  IDX
               PERFORM 3101-INPUTCD-HEN-SEC
           END-IF
      *
           MOVE    1                   TO  FLG-ADD
           .
       3301-SYOSIN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *   °é»ù±ÉÍÜ²Ã»»¼«Æ°È¯À¸½èÍý
      *****************************************************************
       3302-IKUJIEIYO-SET-SEC                  SECTION.
      *
      *    °é»ù±ÉÍÜ²Ã»»¼«Æ°»»Äê
           IF      SPA-IKUJIEIYO-FLG   NOT =   "1"
               GO      TO      3302-IKUJIEIYO-SET-EXT
           END-IF
      *    £³ºÐ¤Ë¤Ê¤ëÇ¯·îÆü¤ò·×»»
           MOVE    SPA-BIRTHDAY        TO  WRK-BIRTHDAY
           COMPUTE WRK-BIRTH-YY        =   WRK-BIRTH-YY    +  3
      *    £³ºÐÌ¤Ëþ¤ËÅ¬ÍÑ
           IF      WRK-BIRTHDAY(1:6)   <   SPA-SRYYMD (1:6)
               GO      TO      3302-IKUJIEIYO-SET-EXT
           END-IF
      *
      *    °é»ù±ÉÍÜ²Ã»»¼«Æ°»»Äê²Ê
           IF     (SPA-IKUJIEIYO-SRYKA =   ZERO      )  OR
                  (SPA-IKUJIEIYO-SRYKA =   SPA-SRYKA )
               CONTINUE
           ELSE
               GO      TO      3302-IKUJIEIYO-SET-EXT
           END-IF
      *
      *    ½é¿Ç¡Ê°é»ù±ÉÍÜ»ØÆ³¡Ë²Ã»»
           MOVE    "111000470"         TO  WRK-SRYCD
      *    ÄÉ²Ã¶¦ÄÌ½èÍý
           MOVE    ZERO                TO  WRK-IDX-IN
           PERFORM 33041-SRYCD-ADD-SEC
      *
           .
       3302-IKUJIEIYO-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *   ÆþÎÏ¥³¡¼¥É¤Î²èÌÌÍÑºÆÊÔ½¸½èÍý
      *****************************************************************
       3101-INPUTCD-HEN-SEC                  SECTION.
      *
      *    ²èÌÌºÆÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC94AREA
           MOVE    "1"                 TO  LNK-SC94-KBN
           MOVE    "K02"               TO  LNK-SC94-PG
           MOVE    IDX                 TO  LNK-SC94-IDX
           CALL    "ORCSC94"           USING
                                       ORCSC94AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *
           IF      SPA-GMN-IDX         >   1
               MOVE    SPA-COM-SRYSYUKBN (SPA-GMN-IDX - 1)
                                           TO  SPA-COM-SRYSYUKBN
                                                         (SPA-GMN-IDX)
               MOVE    SPA-COM-SRYKBN (SPA-GMN-IDX - 1)
                                           TO  SPA-COM-SRYKBN
                                                         (SPA-GMN-IDX)
           END-IF
     *
           .
       3101-INPUTCD-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ·ÑÂ³´ÉÍý²Ã»»ÄÉ²Ã½èÍý
      *****************************************************************
       3302-KEIZOKU-HEN-SEC                SECTION.
      *
           IF      SPA-NAI-ROUJIN      =   ZERO
      *        °ìÈÌ
               MOVE    "112007170"         TO  WRK-SRYCD
           ELSE
      *        Ï·¿Í
               MOVE    "112702270"         TO  WRK-SRYCD
           END-IF
      *
      *    ½é¿ÇÎÁ¼«Æ°ÄÉ²Ã
           PERFORM 3301-SYOSIN-HEN-SEC
      *    ¼«Æ°»»Äê¤¢¤ê
           IF      FLG-ADD             =   1
               ADD     1               TO  IDX2
      *        ¼«Æ°ÄÉ²ÃÊ¬
      *********MOVE    "1"             TO  SPA-COM-AUTOKBN(SPA-GMN-IDX)
           END-IF
      *
           .
       3302-KEIZOKU-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê¼«Æ°È¯À¸½èÍý
      *****************************************************************
       3303-SYONIKA-SET-SEC            SECTION.
      *
           MOVE    ZERO                TO  FLG-SYONIKA
      *
           MOVE    SPACE               TO  WRK-SRYCD
      *    ±¡³°½èÊý
           IF      SPA-INGAIKBN        =   "1"
               IF      SPA-SYOSIN          =   1
      *            ½é¿Ç
                   MOVE    "113003510"         TO  WRK-SRYCD
               ELSE
      *            ºÆ¿Ç
                   MOVE    "113003610"         TO  WRK-SRYCD
               END-IF
           ELSE
      *        ±¡Æâ½èÊý
               IF      SPA-SYOSIN          =   1
      *            ½é¿Ç
                   MOVE    "113003710"         TO  WRK-SRYCD
               ELSE
      *            ºÆ¿Ç
                   MOVE    "113003810"         TO  WRK-SRYCD
               END-IF
           END-IF
      *
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê»»Äê
      *
           MOVE    ZERO                TO  FLG-ADD
      *
           IF      WRK-IDX-IN          =   ZERO
               ADD     1                   TO  IDX2
               ADD     1                   TO  SPA-GMN-IDX
           ELSE
               MOVE    WRK-IDX-IN          TO  IDX2
               MOVE    WRK-IDX-IN          TO  SPA-GMN-IDX
           END-IF
      *
           MOVE    SPA-SCR-REC         TO  WRK-SCR-REC
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           IF      WRK-IDX-IN          =   ZERO
      *        ½é´ü»»Äê
               MOVE    "1"                 TO  LNK-SC92-KBN
               MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
               MOVE    ZERO                TO  FLG-JIKAN
           ELSE
      *        ±¡³°±¡ÆâÊÑ¹¹
               MOVE    SPACE               TO  LNK-SC92-KBN
               MOVE    WRK-IDX-IN          TO  LNK-SC92-GMN-IDX
               MOVE    SPA-COM-TIMEFLG(WRK-IDX-IN)
                                           TO  FLG-JIKAN
               INITIALIZE                      SPA-COM-TBLREC
                                                        (WRK-IDX-IN)
               MOVE    WRK-SRYCD           TO  SPA-COM-INPUTCD
                                                        (WRK-IDX-IN)
               MOVE    FLG-JIKAN           TO  SPA-COM-TIMEFLG
                                                        (WRK-IDX-IN)
           END-IF
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *
      *    Ç¯Îð¥¨¥é¡¼¤Î»þ¡¢¥¨¥é¡¼¤ò¤Ï¤º¤¹¡ÊÅö·î¤Ï£Ï£Ë¡Ë
           IF      LNK-SC92-ERRCD5 NOT =   SPACE
      *        Åö·î»»ÄêºÑ¤ß
               IF     (SPA-SYONIKA-ARI3    =   ZERO )
                   CONTINUE
               ELSE
                   MOVE    SPACE               TO  LNK-SC92-ERRCD5
               END-IF
           END-IF
      *
      *    Æ±ÆüºÆ¿Ç»þ¡¢Ê»ÍÑ»»Äê¥¨¥é¡¼
           IF      LNK-SC92-ERRCD3 NOT =   SPACE
               MOVE    SPACE               TO  SPA-ERRCD
               MOVE    WRK-SCR-REC         TO  SPA-SCR-REC
               MOVE    ZERO                TO  SPA-GMN-IDX
               MOVE    ZERO                TO  IDX2
               MOVE    1                   TO  FLG-SYONIKA
               MOVE    2                   TO  SPA-SYONIKA-ARI
               MOVE    1                   TO  SPA-SYONIKA-ARI2
               GO      TO      3303-SYONIKA-SET-EXT
           END-IF
      *
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE           TO  SPA-ERRCD
               MOVE    WRK-SCR-REC     TO  SPA-SCR-REC
               MOVE    ZERO            TO  SPA-GMN-IDX
               MOVE    ZERO            TO  IDX2
               GO      TO      3303-SYONIKA-SET-EXT
           END-IF
      *
      *    »»Äê¤¬¤¢¤ê¡¢´û¤ËÅöÆüÂ¾¤Î¿Ç»¡ÎÁ¤ò»»Äê¤·¤Æ¤¤¤ë»þ¡¢¥¨¥é¡¼
           IF     (SPA-SYOSIN          =   ZERO  )  AND
      ********** ((SPA-LSTYMD          =   SPA-SRYYMD) OR
                 ((SPA-LSTYMD          =   SPA-SRYYMD) AND
                  (WRK-DAY-SINSATUCNT  >   ZERO    )) AND
                  (SPA-SYORIFLG        =   ZERO   )
               MOVE    WRK-SCR-REC         TO  SPA-SCR-REC
               MOVE    1                   TO  FLG-SYONIKA
               MOVE    ZERO                TO  SPA-GMN-IDX
               MOVE    ZERO                TO  IDX2
               MOVE    "K005"              TO  SPA-ERRCD
               GO      TO      3303-SYONIKA-SET-EXT
           END-IF
      *
      *    ÆþÎÏ¹àÌÜÊÔ½¸½èÍý
      *    INITIALIZE                  WRK-MOJI-AREA
      *    PERFORM 800-KOMOKU-HENSYU-SEC
      *
      *    ºÆÊÔ½¸½èÍý
           MOVE    SPA-GMN-IDX         TO  IDX
           PERFORM 3101-INPUTCD-HEN-SEC
      *
      *    ³°Íè¤Ç¿Ç»¡ÎÁ¤Î»þ¡¢»þ´Ö³°¶èÊ¬¤òÉÕ¤±¤ë
           IF     (SPA-SYORIFLG        =   ZERO )  AND
                  (SPA-NYUGAIKBN       =   "2"  )  AND
                  (SPA-SRYYMD          =   SPA-SYSYMD) AND
                  (SPA-GAI-JIKANKBN    NOT =   ZERO )  AND
      *           ¿Ç»¡ÎÁºÆ»»Äê»þ¤ÏÉÕ¤±¤Ê¤¤
                  (FLG-JIKANKBN        =   ZERO )
      *           »þ´Ö³°»ØÄê¤¬Ìµ¤¤»þ
             AND  (SPA-COM-TIMEFLG (SPA-GMN-IDX) =   ZERO )
               MOVE    SPA-GMN-INPUTCD (SPA-GMN-IDX)
                                           TO  WRK-INPUTCD
               MOVE    SPACE               TO  SPA-GMN-INPUTCD
                                                         (SPA-GMN-IDX)
               MOVE    SPA-GAI-JIKANKBN    TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(1:1)
               MOVE    WRK-INPUTCD         TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(3:)
               MOVE    SPA-GAI-JIKANKBN    TO  SPA-COM-TIMEFLG
                                                     (SPA-GMN-IDX)
           END-IF
      *
           MOVE    1                   TO  FLG-SYONIKA
           MOVE    1                   TO  SPA-SYONIKA-ARI
      *
           IF      SPA-GMN-IDX         >   ZERO
      *        ÎÅÍÜÃ´Åö¼êÅö¡ÊËÌ³¤Æ»¡Ë
               PERFORM 330123-RYOYOU-TEATE-SEC
           END-IF
           .
       3303-SYONIKA-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÄÉ²Ã¶¦ÄÌ½èÍý½èÍý
      *****************************************************************
       33041-SRYCD-ADD-SEC          SECTION.
      *
           MOVE    ZERO                TO  FLG-ADD
      *
           IF      WRK-IDX-IN          =   ZERO
               ADD     1                   TO  IDX2
               ADD     1                   TO  SPA-GMN-IDX
           ELSE
               MOVE    WRK-IDX-IN          TO  IDX2
               MOVE    WRK-IDX-IN          TO  SPA-GMN-IDX
           END-IF
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           IF      WRK-IDX-IN          =   ZERO
               MOVE    "1"                 TO  LNK-SC92-KBN
               MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
           ELSE
               MOVE    SPACE               TO  LNK-SC92-KBN
               MOVE    WRK-IDX-IN          TO  LNK-SC92-GMN-IDX
               MOVE    SPA-COM-TIMEFLG(WRK-IDX-IN)
                                           TO  FLG-JIKAN
               INITIALIZE                      SPA-COM-TBLREC
                                                        (WRK-IDX-IN)
               MOVE    WRK-SRYCD           TO  SPA-COM-INPUTCD
                                                        (WRK-IDX-IN)
               IF      FLG-JIKAN           >   ZERO
                   MOVE    FLG-JIKAN           TO  SPA-GMN-INPUTCD
                                                    (WRK-IDX-IN)(1:1)
                   MOVE    WRK-SRYCD           TO  SPA-GMN-INPUTCD
                                                    (WRK-IDX-IN)(3:)
               ELSE
                   MOVE    WRK-SRYCD           TO  SPA-GMN-INPUTCD
                                                        (WRK-IDX-IN)
               END-IF
               MOVE    FLG-JIKAN           TO  SPA-COM-TIMEFLG
                                                        (WRK-IDX-IN)
           END-IF
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE           TO  SPA-ERRCD
               INITIALIZE              SPA-GMN-TBLREC (SPA-GMN-IDX)
               INITIALIZE              SPA-COM-TBLREC (SPA-GMN-IDX)
               COMPUTE SPA-GMN-IDX     =   SPA-GMN-IDX     -   1
               COMPUTE IDX2            =   IDX2            -   1
               GO      TO      33041-SRYCD-ADD-EXT
           END-IF
      *
           MOVE    1                  TO  FLG-ADD
      *
           .
       33041-SRYCD-ADD-EXT.
           EXIT.
      *****************************************************************
      *    ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê¼«Æ°»»Äê½èÍý
      *****************************************************************
       3305-NETAKIRI-SET-SEC          SECTION.
      *
      *    Åö·î»»ÄêºÑ¤ß ¼«Æ°ºîÀ®¤Ê¤·
           IF    ((SPA-NETAKIRI-ARI2   NOT =   ZERO )  OR
                  (WRK-NETAKIRI-CNT        =   ZERO ))  AND
                  (WRK-IDX-IN              =   ZERO )
               GO      TO      3305-NETAKIRI-SET-EXT
           END-IF
      *
      *    ¼«Æ°»»Äê
           IF    ( WRK-SANTEI-ARI      >   WRK-SANTEI-NASI )  OR
                 ( SPA-INGAIKBN        =   "1"             )
      *        ±¡³°½èÊý¤¢¤ê
               MOVE    "114701210"         TO  WRK-SRYCD
               MOVE    1                   TO  SPA-NETAKIRI-ARI
           ELSE
      *        ±¡³°½èÊý¤Ê¤·
               MOVE    "114701710"         TO  WRK-SRYCD
               MOVE    2                   TO  SPA-NETAKIRI-ARI
           END-IF
      *
      *    ÄÉ²Ã¶¦ÄÌ½èÍý
           PERFORM 33041-SRYCD-ADD-SEC
      *    ÄÉ²Ã¤Ê¤·
           IF      FLG-ADD             =   ZERO
               GO      TO      3305-NETAKIRI-SET-EXT
           END-IF
      *
           MOVE    1                   TO  SPA-NETAKIRI-ARI3
      *    £²£´»þ´ÖÏ¢ÂÓ²Ã»»
           IF      WRK-24KSAN-SRYCD    NOT =   SPACE
               MOVE    ZERO                TO  WRK-IDX-IN
               MOVE    WRK-24KSAN-SRYCD    TO  WRK-SRYCD
      *        ÄÉ²Ã¶¦ÄÌ½èÍý
               PERFORM 33041-SRYCD-ADD-SEC
           END-IF
      *
           .
       3305-NETAKIRI-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    »»ÄêÍúÎò¥Á¥§¥Ã¥¯½èÍý¡ÊÁ°ÍúÎò¡Ë
      *****************************************************************
       33051-JYURRK-MAECHK-SEC            SECTION.
      *
           MOVE    ZERO                TO  FLG-TOUG-SANTEI
           MOVE    SPACE               TO  WRK-SANTEI-YM
      *
      *!   MOVE    WRK-SRYCD           TO  TNS-SRYCD
      *    PERFORM 910-TENSU-READ-SEC
      *    IF      FLG-TENSU           =   1
      *        GO      TO      33051-JYURRK-MAECHK-EXT
      *!   END-IF
      *
      *    ÊÝ¸±Ëè¤Î¥³¡¼¥É¤ÎÈ½Äê
           PERFORM 1000-SANTEI-CHK-SEC
      *
      *    »»ÄêÍúÎò¸¡º÷
           MOVE    SPACE               TO  SANTEI-REC
           INITIALIZE                  SANTEI-REC
           MOVE    SPA-HOSPNUM         TO  SANTEI-HOSPNUM
           MOVE    SPA-PTID            TO  SANTEI-PTID
           MOVE    WRK-SRYCD           TO  SANTEI-SRYCD
      *!!  EVALUATE    TNS-SANTEIRRKKBN
      *        WHEN    1
      *            MOVE    ZERO                TO  SANTEI-NYUGAIKBN
      *            MOVE    ZERO                TO  SANTEI-SRYKA
      *        WHEN    2
      *            MOVE    SPA-NYUGAIKBN       TO  SANTEI-NYUGAIKBN
      *            MOVE    ZERO                TO  SANTEI-SRYKA
      *        WHEN    3
      *            MOVE    ZERO                TO  SANTEI-NYUGAIKBN
      *            MOVE    SPA-SRYKA           TO  SANTEI-SRYKA
      *        WHEN    4
      *            MOVE    SPA-NYUGAIKBN       TO  SANTEI-NYUGAIKBN
      *            MOVE    SPA-SRYKA           TO  SANTEI-SRYKA
      *!!  END-EVALUATE
      *
           IF     (FLG-HKNSAN          =   1   )  AND
                  (SPA-HKNKBN      NOT =   ZERO)
               MOVE    SPA-HKNCOMBINUM     TO  SANTEI-HKNCOMBINUM
           ELSE
               MOVE    ZERO                TO  SANTEI-HKNCOMBINUM
           END-IF
           MOVE    SPA-SRYYMD(1:6)     TO  SANTEI-SRYYM
      *
           MOVE    SANTEI-REC          TO  MCPDATA-REC
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key8"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key8"              TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SANTEI
           END-IF
      *
           MOVE    SPACE               TO  WRK-FSANTEIYMD
           PERFORM
               UNTIL       FLG-SANTEI      =   1
      *
               PERFORM 200511-SANTEI-CHK-SEC
      *
               IF     (SANTEI-MSANTEICNT   >   ZERO )  AND
                      (SANTEI-SRYYM        <=  SPA-SRYYMD(1:6))
                 AND  (FLG-SANTEI-OK       =   1    )
                   ADD     1                   TO  WRK-SANTEI-CNT
      *            Åö·î»»ÄêºÑ¤ß
                   IF      SANTEI-SRYYM        =   SPA-SRYYMD(1:6)
                       MOVE    SANTEI-SRYYM        TO  WRK-SANTEI-YM
                       MOVE    SANTEI-MSANTEICNT   TO  FLG-TOUG-SANTEI
      *                ËýÀ­áÖÄË¤Î»þ¡¢¿ÇÎÅÆü¤è¤ê¸å¤Î»þ¤Ê¤·¤È¤¹¤ë
                       IF     (WRK-SRYCD       =   "113006510" ) AND
                              (SANTEI-FSANTEIYMD(1:6)
                                               =   SANTEI-SRYYM ) AND
                              (SPA-SRYYMD(7:2) <   SANTEI-MSANTEID) AND
                              (WRK-FSANTEIYMD  NOT =
                                                   SANTEI-FSANTEIYMD)
                           MOVE    ZERO        TO  FLG-TOUG-SANTEI
                       END-IF
                   END-IF
                   IF      SANTEI-SRYYM        <   SPA-SRYYMD(1:6)
                       MOVE    SANTEI-SRYYM        TO  WRK-SANTEI-YM
                       MOVE    1                   TO  FLG-SANTEI
                   END-IF
                   MOVE    SANTEI-FSANTEIYMD   TO  WRK-FSANTEIYMD
      *
      *            ÄûÀµ¤Î»þ¡¢ÄûÀµÊ¬¤Ï¥«¥¦¥ó¥È¤·¤Ê¤¤
                   IF     (SPA-SYORIFLG        =   1     )  AND
                          (SANTEI-SRYYM        =   SPA-SRYYMD(1:6))
                       MOVE    SPA-SRYYMD(7:2)     TO  IDX-Y2
                       IF     (SANTEI-DAY (IDX-Y2) >   ZERO )  AND
                              (FLG-TOUG-SANTEI     >   ZERO )
                           COMPUTE FLG-TOUG-SANTEI
                                           =   FLG-TOUG-SANTEI
                                           -   SANTEI-DAY (IDX-Y2)
                       END-IF
                   END-IF
               END-IF
      *
               IF     FLG-SANTEI           =   ZERO
                  MOVE    "key8"              TO  MCP-PATHNAME
                  PERFORM 920-SANTEI-READ-SEC
               END-IF
           END-PERFORM
      *
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key8"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       33051-JYURRK-MAECHK-EXT.
           EXIT.
      *----(01.00.02) LINE ADD END   ----------------------------------
      *
      *****************************************************************
      *    ÂÐ¾Ý¤Î»»ÄêÍúÎòÈ½Äê½èÍý
      *****************************************************************
       200511-SANTEI-CHK-SEC                SECTION.
      *
           MOVE    ZERO                TO  FLG-SANTEI-OK
      *
           EVALUATE    TRUE
      *        »»ÄêÍúÎò¶èÊ¬¡á£±
               WHEN   (SANTEI-NYUGAIKBN    =   ZERO )  AND
                      (SANTEI-SRYKA        =   ZERO )
                   MOVE    1                   TO  FLG-SANTEI-OK
      *        »»ÄêÍúÎò¶èÊ¬¡á£²
               WHEN   (SANTEI-NYUGAIKBN    =   SPA-NYUGAIKBN) AND
                      (SANTEI-SRYKA        =   ZERO )
                   MOVE    1                   TO  FLG-SANTEI-OK
      *
      *        »»ÄêÍúÎò¶èÊ¬¡á£³
               WHEN   (SANTEI-NYUGAIKBN    =   ZERO )  AND
                      (SANTEI-SRYKA        =   SPA-SRYKA )
                   MOVE    1                   TO  FLG-SANTEI-OK
      *
      *        »»ÄêÍúÎò¶èÊ¬¡á£´
               WHEN   (SANTEI-NYUGAIKBN    =   SPA-NYUGAIKBN) AND
                      (SANTEI-SRYKA        =   SPA-SRYKA )
                   MOVE    1                   TO  FLG-SANTEI-OK
           END-EVALUATE
      *
           .
       200511-SANTEI-CHK-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    »ØÆ³ÎÁ¤Î¼«Æ°È¯À¸½èÍý
      *****************************************************************
       33012-SIDOU-SYORI-SEC      SECTION.
      *
      *    ÆÃÄêËýÀ­¼À´µ»ØÆ³ÎÁ
           IF      SPA-TOKUTEI     NOT =   ZERO
               PERFORM 330121-TOKUTEI-SIDOU-SEC
           END-IF
      *
      *    ÈéÉæ²ÊÆÃÄê¼À´µ
           IF      SPA-TOKUTEI-F   NOT =   ZERO
               MOVE    SPA-TOKUTEI-F       TO  FLG-TOKUTEI
               PERFORM 330122-HIFUKA-SIDOU-SEC
           END-IF
      *
      *    ÎÅÍÜÃ´Åö¼êÅö¡ÊËÌ³¤Æ»¡Ë
           PERFORM 330123-RYOYOU-TEATE-SEC
      *
           .
       33012-SIDOU-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    »ØÆ³ÎÁ¤Î¼«Æ°È¯À¸½èÍý
      *****************************************************************
       330121-TOKUTEI-SIDOU-SEC      SECTION.
      *
      *    »ØÆ³ÎÁ¤Î¼«Æ°È¯À¸
           EVALUATE    SPA-NAI-ROUJIN  ALSO  SPA-HOSPSBT
      *        Ï·¿Í¡¡ÉÂ±¡
               WHEN    1        ALSO         1
                   IF      SPA-BEDSU           <   100
                       MOVE    "113700710"         TO  WRK-SRYCD
                   ELSE
                       MOVE    "113700810"         TO  WRK-SRYCD
                   END-IF
      *        Ï·¿Í¡¢¿ÇÎÅ½ê
               WHEN    1        ALSO         2
                   MOVE    "113700610"         TO  WRK-SRYCD
      *        °ìÈÌ¡¡ÉÂ±¡
               WHEN    ZERO     ALSO         1
                   IF      SPA-BEDSU           <   100
                       MOVE    "113001910"         TO  WRK-SRYCD
                   ELSE
                       MOVE    "113002010"         TO  WRK-SRYCD
                   END-IF
      *        °ìÈÌ¡¢¿ÇÎÅ½ê
               WHEN    ZERO     ALSO         2
                   MOVE    "113001810"         TO  WRK-SRYCD
           END-EVALUATE
      *
      *    »ØÆ³ÎÁÄÉ²Ã¡¢¥Á¥§¥Ã¥¯½èÍý
           MOVE    ZERO                TO  FLG-SIDOU
           PERFORM 3301211-SIDOU-ADD-SEC
           .
       330121-TOKUTEI-SIDOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    »ØÆ³ÎÁÊÔ½¸¡¦¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       3301211-SIDOU-ADD-SEC           SECTION.
      *
           EVALUATE    LNK-SC10S-SYORI
      *        ÃæÅÓ½ªÎ»Å¸³«
               WHEN    "W"
      *        ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý
               WHEN    "S"
      *        ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý¡ÊÂ¾ÊÝ¸±¼õ¿Ç¤¢¤ê¤ÇÆ±ÆüºÆ¿Ç¤Ø¡Ë
               WHEN    "J"
      *        ¿Ç»¡ÎÁ»»Äê¸å¡¢¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý
               WHEN    "K"
                   PERFORM 33012111-SIDOU-CHUTO-SEC
               WHEN    "A"
      *            Ê£¿ô²ÊÆþÎÏ
                   PERFORM 33012112-SIDOU-FUKU-SEC
               WHEN    "D"
      *            ÃæÅÓ½ªÎ»Å¸³«»þ¼«Æ°»»Äê¤Ê¤·
                   CONTINUE
               WHEN    OTHER
                   PERFORM 33012113-SIDOU-INS-SEC
           END-EVALUATE
      *
           .
       3301211-SIDOU-ADD-EXT.
           EXIT.
      *
      *****************************************************************
      *    »ØÆ³ÎÁÊÔ½¸¡¦¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       33012113-SIDOU-INS-SEC               SECTION.
      *
           MOVE    SPA-SCR-REC         TO  WRK-SCR-REC2
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           COMPUTE SPA-GMN-IDX         =   SPA-GMN-IDX   +   1
           INITIALIZE                  ORCSC92AREA
           MOVE    "1"                 TO  LNK-SC92-KBN
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (LNK-SC92-ERRAREA    =   SPACE )
               PERFORM 330122-JYUFUKU-CHK-SEC
           END-IF
      *
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (LNK-SC92-ERRAREA    =   SPACE )
      *        »ØÆ³ÎÁ½é¿ÇÆü¥Á¥§¥Ã¥¯¡ÊORCSC10 ¤ÈÆ±ÍÍ¤Î¥Á¥§¥Ã¥¯¡Ë
               PERFORM 330121-SIDOU-CHK-SEC
           END-IF
      *
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE               TO  SPA-ERRCD
               MOVE    WRK-SCR-REC2        TO  SPA-SCR-REC 
           ELSE
      *        ºÆÊÔ½¸½èÍý
               MOVE    SPA-GMN-IDX         TO  IDX
               PERFORM 3101-INPUTCD-HEN-SEC
           END-IF
           MOVE    SPA-GMN-IDX         TO  IDX2
      *
           .
       33012113-SIDOU-INS-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÃæÅÓ½ªÎ»Å¸³«»ØÆ³ÎÁÊÔ½¸¡¦¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       33012111-SIDOU-CHUTO-SEC        SECTION.
      *
           MOVE    HZN-SCR-REC         TO  WRK-SCR-REC
      *    Å¸³«»þ¤ÎÆâÍÆ¤ÇÈ½ÃÇ¤¹¤ë
           COMPUTE WRK-GMN-MAX         =   WRK-GMN-MAX   +   1
           IF      WRK-GMN-MAX         >   SPA-MAX-LINE
               MOVE    SPA-MAX-LINE            TO  WRK-GMN-MAX
           END-IF
           INITIALIZE                      WRK-GMN-TBL (WRK-GMN-MAX)
           MOVE    WRK-SRYCD           TO  WRK-COM-INPUTCD(WRK-GMN-MAX)
      *
           INITIALIZE                  ORCSC92AREA
           MOVE    "3"                 TO  LNK-SC92-KBN
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    WRK-GMN-MAX         TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       WRK-SCR-REC
                                       SPA-AREA
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE           )  OR
                              (SPA-ERRCD       NOT  =   SPACE )  OR
                             ((HZN-COM-INPUTCD(IDX) =   SPACE ) AND
                              (HZN-GMN-INPUTCD(IDX) =   SPACE ))
               IF      HZN-COM-INPUTCD (IDX)   =   WRK-SRYCD
                   MOVE    "0134"              TO  SPA-ERRCD
               END-IF
           END-PERFORM
      *
           MOVE    SPACE               TO  WRK-SCR-REC
           INITIALIZE                  WRK-SCR-REC
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (LNK-SC92-ERRAREA    =   SPACE )
      *        ¥¨¥é¡¼¤¬¤Ê¤¤»þ¡¢¼«Æ°È¯À¸¤¹¤ë
               PERFORM 33012113-SIDOU-INS-SEC
           ELSE
               MOVE    SPACE           TO  SPA-ERRCD
           END-IF
      *
           .
       33012111-SIDOU-CHUTO-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ²ÊÆþÎÏ»þ»ØÆ³ÎÁÊÔ½¸¡¦¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       33012112-SIDOU-FUKU-SEC        SECTION.
      *
      *    ´û¤ËÆþÎÏºÑ¤ß¤«¤É¤¦¤«¤ÎÈ½ÃÇ
           PERFORM 330122-JYUFUKU-CHK-SEC
           IF      SPA-ERRCD           =   SPACE
               MOVE    SPA-SCR-REC         TO  WRK-SCR-REC
      *        ¥¨¥é¡¼¤¬¤Ê¤¤»þ¡¢¼«Æ°È¯À¸¤¹¤ë
               PERFORM 33012113-SIDOU-INS-SEC
           ELSE
               MOVE    SPACE               TO  SPA-ERRCD
           END-IF
      *
           .
       33012112-SIDOU-FUKU-EXT.
           EXIT.
      *
      *****************************************************************
      *    »ØÆ³ÎÁ½é¿ÇÆü¥Á¥§¥Ã¥¯½èÍý¡ÊORCSC10 ¤ÈÆ±ÍÍ¤Î¥Á¥§¥Ã¥¯¡Ë
      *****************************************************************
       330121-SIDOU-CHK-SEC               SECTION.
      *
      *    ºÇ½ªÂà±¡Æü¤¬¤¢¤ë»þ¡¢Âà±¡Æü
           IF     (SPA-K02N-TAIINYMD   =   SPACE )  OR
                  (SPA-K02N-TAIINYMD   <=  SPA-SYOYMD)
               MOVE    ZERO                TO  FLG-TAIIN
               MOVE    SPA-SYOYMD          TO  WRK-SYOYMD
           ELSE
               MOVE    SPA-K02N-TAIINYMD   TO  WRK-SYOYMD
               MOVE    1                   TO  FLG-TAIIN
           END-IF
      *
           MOVE    ZERO                TO  FLG-KYUJITU
           IF      WRK-SYOYMD          =   SPACE
               MOVE    SPA-SRYYMD          TO  WRK-KEIYMD
               MOVE    SPA-SRYYMD          TO  WRK-KEIYMDZEN
           ELSE
      *        ½é¿ÇÎÁ»»ÄêÆü¡Ü£±·î¸å
               INITIALIZE                      STS-AREA-DAY
               INITIALIZE                      LNK-DAY6-AREA
               MOVE    "61"                TO  LNK-DAY6-IRAI
               MOVE    WRK-SYOYMD          TO  LNK-DAY6-KIJUN
               MOVE    "2"                 TO  LNK-DAY6-ZOGENPTN
               MOVE    1                   TO  LNK-DAY6-ZOGEN
               CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
               MOVE    LNK-DAY6-KEISAN     TO  WRK-KEIYMD
               MOVE    LNK-DAY6-KEISANZEN  TO  WRK-KEIYMDZEN
               IF      LNK-DAY6-KEISAN NOT =   LNK-DAY6-KEISANZEN
                   MOVE    1                   TO  FLG-KYUJITU
               END-IF
           END-IF
      *
           EVALUATE    TRUE
               WHEN    WRK-KEIYMD          <   SPA-SRYYMD
                   CONTINUE
               WHEN    WRK-KEIYMD          >   SPA-SRYYMD
      *            £±·î¸å¤ÎÁ°±Ä¶ÈÆü¤ÈÆ±¤¸»þ¡¢£Ï£Ë
                   IF      FLG-SIDOU       =   1
                       IF      FLG-TAIIN       =   1
                           MOVE    "0120"         TO  SPA-ERRCD
                       ELSE
                           MOVE    "0034"          TO  SPA-ERRCD
                       END-IF
                   ELSE
      *****************IF      WRK-KEIYMDZEN   =   SPA-SRYYMD
      *                ELSE
                           IF      FLG-TAIIN       =   1
                               MOVE    "0120"          TO  SPA-ERRCD
                           ELSE
                               MOVE    "0034"          TO  SPA-ERRCD
                           END-IF
      *****************END-IF
                   END-IF
               WHEN    WRK-KEIYMD          =   SPA-SRYYMD
                   CONTINUE
           END-EVALUATE
           .
       330121-SIDOU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆÃÄê¼À´µ¼«Æ°»»Äê½èÍý
      *****************************************************************
       330122-JYUFUKU-CHK-SEC         SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE           )  OR
                              (SPA-ERRCD       NOT  =   SPACE )  OR
                             ((SPA-COM-INPUTCD(IDX) =   SPACE ) AND
                              (SPA-GMN-INPUTCD(IDX) =   SPACE ))
               IF     (SPA-GMN-IDX         NOT =   IDX   )  AND
                      (SPA-COM-INPUTCD (IDX)   =   WRK-SRYCD)
                   MOVE    "0134"              TO  SPA-ERRCD
               END-IF
           END-PERFORM
           .
       330122-JYUFUKU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÈéÉæ²ÊÆÃÄê¼À´µ¼«Æ°»»Äê½èÍý
      *****************************************************************
       330122-HIFUKA-SIDOU-SEC         SECTION.
      *
           EVALUATE    FLG-TOKUTEI
      *           ¡Ê£±¡Ë
               WHEN    03
                   MOVE    "113000910"     TO  WRK-SRYCD
      *           ¡Ê£²¡Ë
               WHEN    04
                   MOVE    "113002310"     TO  WRK-SRYCD
           END-EVALUATE
      *
      *    »ØÆ³ÎÁÄÉ²Ã¡¢¥Á¥§¥Ã¥¯½èÍý
           MOVE    1                   TO  FLG-SIDOU
           PERFORM 3301211-SIDOU-ADD-SEC
      *
           .
       330122-HIFUKA-SIDOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÎÅÍÜÃ´Åö¼êÅö¡ÊËÌ³¤Æ»¡Ë½èÍý
      *****************************************************************
       330123-RYOYOU-TEATE-SEC         SECTION.
      *
           IF    ( SPA-RYOYOU-FLG      =   "1"     )  AND
                 ((SPA-SRYYMD(5:4)     >=  "1101"  AND
                                       <=  "1231")  OR
                  (SPA-SRYYMD(5:4)     >=  "0101"  AND
                                       <=  "0430") )
               CONTINUE
           ELSE
               GO      TO      330123-RYOYOU-TEATE-EXT
           END-IF
      *
           MOVE    "199000610"         TO  WRK-SRYCD
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           COMPUTE SPA-GMN-IDX         =   SPA-GMN-IDX   +   1
           INITIALIZE                  ORCSC92AREA
           MOVE    "1"                 TO  LNK-SC92-KBN
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE           TO  SPA-ERRCD
               INITIALIZE              SPA-GMN-TBLREC (SPA-GMN-IDX)
               INITIALIZE              SPA-COM-TBLREC (SPA-GMN-IDX)
               COMPUTE SPA-GMN-IDX     =   SPA-GMN-IDX
                                       -   1
           ELSE
               MOVE    "1"                 TO  SPA-COM-KAIFLG
                                                      (SPA-GMN-IDX)
      *        ºÆÊÔ½¸½èÍý
               MOVE    SPA-GMN-IDX         TO  IDX
               PERFORM 3101-INPUTCD-HEN-SEC
           END-IF
           MOVE    SPA-GMN-IDX         TO  IDX2
      *
           .
       330123-RYOYOU-TEATE-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒ¤Î½é¿ÇÎÁ»»Äê»»Äê½èÍý
      *****************************************************************
       2009-RSIHKN-SET-SEC         SECTION.
      *
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¤Ï»»Äê¤Ê¤·¤È¤¹¤ë
           MOVE    ZERO                TO  SPA-SYONIKA-ARI
           MOVE    ZERO                TO  SPA-SYONIKA-ARI2
           MOVE    ZERO                TO  SPA-SYONIKA-ARI3
      *
      *    ½é¿ÇÎÁ»»Äê
           IF      SPA-SYOSIN          =   1
               MOVE    ZERO                TO  WRK-KAISU
               MOVE    "F"                 TO  WRK-KBN
               PERFORM 20091-RSI-SINSATU-SEC
           ELSE
      *        ºÆ¿ÇÎÁ
               IF     (SPA-LSTYMD          =   SPA-SRYYMD  ) AND
                      (SPA-TAKA-SRYKA-R    NOT =   SPACE   )
               AND    (WRK-KBN             =   SPACE   )
               AND    (LNK-SC10S-SYORI     NOT =   "J"   )
      *            Æ±ÆüºÆ¿Ç¡¦Â¾²Ê¼õ¿Ç¤¢¤ê
                   PERFORM 3301-DOUSAISIN-SEC
               ELSE
      *            Ê¿À®£±£µÇ¯£¹·î£±Æü¤«¤éÄþ¸ºÇÑ»ß¤È¤¹¤ë
                   MOVE    ZERO                TO  WRK-KAISU
                   MOVE    "S"                 TO  WRK-KBN
      *
                   PERFORM 20091-RSI-SINSATU-SEC
               END-IF
           END-IF
      *    ½é¿ÇÎÁ¼«Æ°ÄÉ²Ã½èÍý
           PERFORM 3301-SYOSIN-HEN-SEC
           IF      FLG-ADD             =   1
               ADD     1               TO  IDX2
           END-IF
      *
      *    Æþ±¡Æü¤Î»þ¡¢½é¿ÇÎÁ¤Î¤ß»»Äê¤¹¤ë
           IF      SPA-NYUGAIKBN       =   "1" 
               GO      TO      2009-RSIHKN-SET-EXT
           END-IF
           IF      WRK-SRYCD(1:2)      =   "83"
               MOVE    "0109"              TO  SPA-KIDCD
               GO      TO      2009-RSIHKN-SET-EXT
           END-IF
      *
      *    ³°Íè¤Ç¿Ç»¡ÎÁ¤Î»þ¡¢»þ´Ö³°¶èÊ¬¤òÉÕ¤±¤ë
           IF     (SPA-SYORIFLG        =   ZERO )  AND
                  (FLG-ADD             =   1    )  AND
                  (SPA-NYUGAIKBN       =   "2"  )  AND
                  (WRK-SRYCD(1:1)      =   "1"  )  AND
                  (SPA-SRYYMD          =   SPA-SYSYMD) AND
                  (SPA-GAI-JIKANKBN    NOT =   ZERO )  AND
      *           ¿Ç»¡ÎÁºÆ»»Äê»þ¤ÏÉÕ¤±¤Ê¤¤
                  (FLG-JIKANKBN        =   ZERO )
               MOVE    SPA-GMN-INPUTCD (SPA-GMN-IDX)
                                           TO  WRK-INPUTCD
               MOVE    SPACE               TO  SPA-GMN-INPUTCD
                                                         (SPA-GMN-IDX)
               MOVE    SPA-GAI-JIKANKBN    TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(1:1)
               MOVE    WRK-INPUTCD         TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(3:)
               MOVE    SPA-GAI-JIKANKBN    TO  SPA-COM-TIMEFLG
                                                     (SPA-GMN-IDX)
           END-IF
      *
      *    °Ê¹ß¡¢ºÆ¿Ç»þ¤Î¤ß
           IF      SPA-SYOSIN          =   1
               GO      TO      2009-RSIHKN-SET-EXT
           END-IF
      *
      *    ¥¢¥Õ¥¿¡¼¥±¥¢¤Î»þ¡¢°Ê²¼»»Äê¤Ê¤·
           IF      SPA-RSI-HKNKBN      =   "3"
               GO      TO      2009-RSIHKN-SET-EXT
           END-IF
      *
      *    ³°Íè´ÉÍý²Ã»»¥³¡¼¥ÉÄÉ²Ã
           IF     (SPA-SYORIFLG        =   ZERO ) OR
                  (FLG-GAI             =   1   AND
                   SPA-SYORIFLG        =   1    )
               PERFORM 20092-RSIGAIRA-SEC
           END-IF
      *
      *    ·ÑÂ³´ÉÍý²Ã»»ÄÉ²Ã
      *    ¡¡½é¿ÇÎÁ»»Äê·î¤ÎÈ½Äê
           IF      SPA-SYOYMD(1:6)     =   SPA-SRYYMD(1:6)
               IF      SPA-SYOYMD      <=  SPA-SRYYMD
                   CONTINUE
               ELSE
      *            ·ÑÂ³´ÉÍý²Ã»»ÄÉ²Ã½èÍý
                   PERFORM 3302-KEIZOKU-HEN-SEC
               END-IF
           ELSE
      *        ·ÑÂ³´ÉÍý²Ã»»ÄÉ²Ã½èÍý
               PERFORM 3302-KEIZOKU-HEN-SEC
           END-IF
      *
           .
       2009-RSIHKN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒ¤Î¿Ç»¡ÎÁ¸¡º÷½èÍý
      *****************************************************************
       20091-RSI-SINSATU-SEC         SECTION.
      *
      *    ¿Ç»¡ÎÁ¸¡º÷
           SET     TBL-RSI              TO  1
           SEARCH  TBL-RSI-SINSATU-OCC  VARYING   TBL-RSI
              AT   END
                   MOVE    ZERO               TO  FLG-ARI
                   MOVE    SPACE              TO  WRK-SRYCD
               WHEN   (WRK-KAISU       =   TBLR-KAISU (TBL-RSI)) AND
                      (WRK-KBN         =   TBLR-KBN   (TBL-RSI))
                   MOVE    1                  TO  FLG-ARI
                   MOVE    TBLR-SRYCD (TBL-RSI)
                                              TO  WRK-SRYCD
           END-SEARCH
           .
       20091-RSI-SINSATU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³°Íè´ÉÍý²Ã»»¥³¡¼¥ÉÄÉ²Ã½èÍý¡ÊÏ«ºÒ¡Ë
      *****************************************************************
       20092-RSIGAIRA-SEC         SECTION.
      *
      *    ³°Íè´ÉÍý²Ã»»¥³¡¼¥ÉÄÉ²Ã
           IF      SPA-SRYYMD      <   SPA-RSI-HASSYOYMD3
      *        £³·î°ÊÆâ
               MOVE    ZERO                TO  WRK-KAISU
               MOVE    "G"                 TO  WRK-KBN
           ELSE
               IF      SPA-SINSATU-CNT     >=  5
      *        £³·î°Ê¹ß¤ÎÆ±·î£µ²óÌÜ°Ê¹ß
                   MOVE    5                   TO  WRK-KAISU
                   MOVE    "G"                 TO  WRK-KBN
               ELSE
                   MOVE    1                   TO  WRK-KAISU
                   MOVE    "G"                 TO  WRK-KBN
               END-IF
           END-IF
      *
      *    Ê¿À®£±£µÇ¯£¹·î£±Æü¤«¤éÄþ¸ºÇÑ»ß¤È¤¹¤ë
           IF      SPA-SRYYMD          >=  "20030901"
               MOVE    ZERO                TO  WRK-KAISU
               MOVE    "G"                 TO  WRK-KBN
           END-IF
      *
      *    ¥Æ¡¼¥Ö¥ë¸¡º÷
           PERFORM 20091-RSI-SINSATU-SEC
           PERFORM 3301-SYOSIN-HEN-SEC
           MOVE    ZERO                TO  WRK-GAIRAI-IDX
      *    ¼«Æ°»»Äê¤¢¤ê
           IF      FLG-ADD             =   1
               ADD     1               TO  IDX2
               MOVE    SPA-GMN-IDX     TO  WRK-GAIRAI-IDX
           END-IF
      *
           .
       20092-RSIGAIRA-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æ±»þºÆ¿Ç»»Äê½èÍý¡Ê³ÎÇ§¸å¡Ë
      *****************************************************************
       300-DOUSAISIN-SET-SEC         SECTION.
      *
      *    ÅÅÏÃºÆ¿Ç¤«¤Î¥Á¥§¥Ã¥¯
      *****IF      SPA-GMN-IDX         >   ZERO
      ******** AND SPA-GMN-IDX         <=  200
               PERFORM 3001-TELSAISIN-CHK-SEC
               IF      FLG-TEL-ARI         =   1
                   GO      TO      300-DOUSAISIN-SET-EXT
               END-IF
      *****END-IF
      *
           MOVE    SPA-SCR-REC         TO  HZN-SCR-REC
      *
           MOVE    SPACE               TO  SPA-SCR-REC
           INITIALIZE                  SPA-SCR-REC
           MOVE    ZERO                TO  SPA-GMN-MAX
           MOVE    ZERO                TO  IDX2
           MOVE    ZERO                TO  SPA-GMN-IDX
           MOVE    ZERO                TO  SPA-FUKU-SRYKA
      *
           IF      SPA-HKNKBN          =   1
      *        Ï«ºÒ¤ÎÆ±ÆüºÆ¿ÇÎÁ»»Äê
               MOVE    "D"                 TO  WRK-KBN
               PERFORM 2009-RSIHKN-SET-SEC
           ELSE
      *        Æ±ÆüºÆ¿ÇÎÁ¤ØÃÖ´¹¤¨
               MOVE    "12"                TO  WRK-SRYKBN
               MOVE    "D"                 TO  WRK-KBN
               MOVE    ZERO                TO  FLG-SAISIN-CHK
      *        ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
               PERFORM 2001-SRYCD-TBL-SEC
      *        ½é¿ÇÎÁ¼«Æ°ÄÉ²Ã
               PERFORM 3301-SYOSIN-SYORI-SEC
           END-IF
      *    ¿ÇÎÅ¹Ô°ÙÆâÍÆ¤ÎÊÔ½¸
           PERFORM 10102-SINSATU-CHENGE-SEC
           .
       300-DOUSAISIN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÅÏÃºÆ¿Ç»»Äê¥Á¥§¥Ã¥¯½èÍý¡ÊÆþÎÏÊ¬¡Ë
      *****************************************************************
       3001-TELSAISIN-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-TEL-ARI
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE    )  OR
                             ((SPA-GMN-INPUTCD(IDX)    =   SPACE) AND
                              (SPA-COM-INPUTCD(IDX)    =   SPACE)) OR
                              (FLG-TEL-ARI     =   1   )
      *        ÅÅÏÃºÆ¿Ç¤«¤Î¥Á¥§¥Ã¥¯
               MOVE    SPA-COM-INPUTCD (IDX)   TO  WRK-SRYCD
               SET     TBL-IDX             TO  1
               SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                  AT   END
                       MOVE    SPACE           TO  WRK-KBN
                       MOVE    SPACE           TO  WRK-KBN2
                       MOVE    ZERO            TO  WRK-KAISU
                   WHEN   (TBL-SRYCD (TBL-IDX) =   WRK-SRYCD) 
                       MOVE    TBL-KBN   (TBL-IDX)     TO  WRK-KBN
                       MOVE    TBL-KBN2  (TBL-IDX)     TO  WRK-KBN2
                       MOVE    ZERO            TO  WRK-KAISU
               END-SEARCH
      *
      *        Æ±ÆüºÆ¿ÇÎÁ¤ØÃÖ´¹¤¨
               IF      WRK-KBN             =   "T"
                   MOVE    "12"                TO  WRK-SRYKBN
                   MOVE    "S"                 TO  WRK-KBN
      *            ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
                   PERFORM 2001-SRYCD-TBL-SEC
      *            ÅÅÏÃºÆ¿Ç¤Î»þ¡¢Æ±ÆüÅÅÏÃºÆ¿Ç¤Ø¿¶¤êÂØ¤¨
                   MOVE    IDX                 TO  SPA-GMN-IDX
                   MOVE    SPA-GMN-IDX         TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
                   MOVE    1                   TO  FLG-TEL-ARI
               END-IF
           END-PERFORM
           .
       3001-TELSAISIN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ±¡Æâ±¡³°ÊÑ¹¹½èÍý
      *****************************************************************
       400-INGAI-HEN-SEC         SECTION.
      *
           MOVE    ZERO                TO  WRK-IDX-IN
           MOVE    ZERO                TO  WRK-ZAITAKU
           MOVE    ZERO                TO  WRK-ZAITAKU-IDX
           MOVE    ZERO                TO  WRK-GAIRAI-IDX
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE )  OR
                              (SPA-COM-INPUTCD (IDX)  =   SPACE AND
                               SPA-GMN-INPUTCD (IDX)  =   SPACE )
               EVALUATE    SPA-COM-INPUTCD (IDX)
      *            ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ
                   WHEN    "113003510" 
                   WHEN    "113003610" 
                   WHEN    "113003710" 
                   WHEN    "113003810" 
                       MOVE    IDX                 TO  WRK-IDX-IN
      *            ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê
                   WHEN    "114701210"
                   WHEN    "114701710"
                       MOVE    IDX                 TO  WRK-IDX-IN
      *
      *            ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ
                   WHEN    "114007610"
                   WHEN    "114007710"
                       MOVE    IDX                 TO  WRK-IDX-IN
      *
      *            À¸³è½¬´·ÉÂ»ØÆ³´ÉÍýÎÁ
                   WHEN    "113003910"
                   WHEN    "113005810"
                   WHEN    "113005910"
                   WHEN    "113004010"
                   WHEN    "113006010"
                   WHEN    "113006110"
                       MOVE    IDX                 TO  WRK-IDX-IN
               END-EVALUATE
           END-PERFORM
      *
           IF     (WRK-IDX-IN          =   ZERO ) AND
                  (WRK-ZAITAKU-IDX     =   ZERO )
               GO     TO      400-INGAI-HEN-EXT
           END-IF
      *
           IF      SPA-SYONIKA-ARI     NOT =   ZERO
      *        ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê¼«Æ°È¯À¸½èÍý
               PERFORM 3303-SYONIKA-SET-SEC
           END-IF
      *    ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê¼«Æ°»»Äê½èÍý
           IF      SPA-NETAKIRI-ARI    NOT =   ZERO
      *        Åö·î»»ÄêºÑ¤ß ¼«Æ°ºîÀ®¤Ê¤·
               MOVE    1                   TO  WRK-NETAKIRI-CNT
               MOVE    SPACE               TO  WRK-SANTEI-ARI
               MOVE    SPACE               TO  WRK-SANTEI-NASI
               PERFORM 3305-NETAKIRI-SET-SEC
           END-IF
      *
           IF      SPA-SEIKATU-ARI     NOT =   ZERO
      *        À¸³è½¬´·ÉÂ»ØÆ³²Ê¿¶ÂØ¤¨½èÍý
               PERFORM 3306-SEIKATU-SET-SEC
           END-IF
      *
           IF      SPA-ZAIMATU-ARI     NOT =   ZERO
      *        ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ
               PERFORM 3307-ZAIMATU-SET-SEC
           END-IF
      *
           .
       400-INGAI-HEN-EXT.
           EXIT.
      *****************************************************************
      *    À¸³è½¬´·ÉÂ»ØÆ³²Ê¼«Æ°½èÍý
      *****************************************************************
       3306-SEIKATU-SET-SEC            SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYCD
           IF      SPA-INGAIKBN        =   "1"
      *        ±¡³°¤Ø
               EVALUATE    SPA-COM-INPUTCD (WRK-IDX-IN)
      *            ¹â·ì°µ¾É¡Ê±¡³°½èÊý¡Ë
                   WHEN    "113004010"
                       MOVE    "113003910"         TO  WRK-SRYCD
      *            ¹â»é·ì¾É¡Ê±¡³°½èÊý¡Ë
                   WHEN    "113006010"
                       MOVE    "113005810"         TO  WRK-SRYCD
      *            ¹â»é·ì¾É¡Ê±¡³°½èÊý¡Ë
                   WHEN    "113006110"
                       MOVE    "113005910"         TO  WRK-SRYCD
               END-EVALUATE
           ELSE
      *        ±¡Æâ¤Ø
               EVALUATE    SPA-COM-INPUTCD (WRK-IDX-IN)
      *            ¹â·ì°µ¾É¡Ê±¡³°½èÊý¡Ë
                   WHEN    "113003910"
                       MOVE    "113004010"         TO  WRK-SRYCD
      *            ¹â»é·ì¾É¡Ê±¡³°½èÊý¡Ë
                   WHEN    "113005810"
                       MOVE    "113006010"         TO  WRK-SRYCD
      *            ¹â»é·ì¾É¡Ê±¡³°½èÊý¡Ë
                   WHEN    "113005910"
                       MOVE    "113006110"         TO  WRK-SRYCD
               END-EVALUATE
           END-IF
           IF      WRK-SRYCD           =   SPACE
               GO      TO      3306-SEIKATU-SET-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-ADD
      *
      *    ÄÉ²Ã¶¦ÄÌ½èÍý
           PERFORM 33041-SRYCD-ADD-SEC
      *
           .
       3306-SEIKATU-SET-EXT.
           EXIT.
      *****************************************************************
      *    ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ¼«Æ°½èÍý
      *****************************************************************
       3307-ZAIMATU-SET-SEC            SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYCD
           IF      SPA-INGAIKBN        =   "1"
      *        ±¡³°½èÊý
               MOVE    "114007610"         TO  WRK-SRYCD
               MOVE    1                   TO  SPA-ZAIMATU-ARI
           ELSE
      *        ±¡Æâ½èÊý
               MOVE    "114007710"         TO  WRK-SRYCD
               MOVE    2                   TO  SPA-ZAIMATU-ARI
           END-IF
           MOVE    ZERO                TO  FLG-ADD
      *
      *    ÄÉ²Ã¶¦ÄÌ½èÍý
           PERFORM 33041-SRYCD-ADD-SEC
      *
           .
       3307-ZAIMATU-SET-EXT.
           EXIT.
      *****************************************************************
      *    ºßÂð¼«¸ÊÃí¼Í½èÍý
      *****************************************************************
       4001-ZAITAKU-CHU-SEC            SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYCD
           IF      SPA-INGAIKBN        =   "1"
      *        ±¡³° 
               IF      WRK-ZAITAKU           =   0
      *            ºßÂð¼«¸ÊÃí¼Í¡Ê±¡³°¡Ë¤Ø
                   MOVE    "114009210"         TO  WRK-SRYCD
               END-IF
           ELSE
               IF      WRK-ZAITAKU           =   1
      *            ºßÂð¼«¸ÊÃí¼Í¡Ê±¡Æâ¡Ë¤Ø
                   MOVE    "114003210"         TO  WRK-SRYCD
               END-IF
           END-IF
           IF      WRK-SRYCD           =   SPACE
               GO      TO      4001-ZAITAKU-CHU-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-ADD
      *
      *    ÄÉ²Ã¶¦ÄÌ½èÍý
           MOVE    WRK-ZAITAKU-IDX     TO  WRK-IDX-IN
           PERFORM 33041-SRYCD-ADD-SEC
      *
           .
       4001-ZAITAKU-CHU-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æ±»þºÆ¿Ç»»Äê½èÍý¡ÊÆþÎÏÊ¬¡Ë
      *****************************************************************
       500-INDOUSAISIN-SET-SEC         SECTION.
      *
      *    ÅÅÏÃºÆ¿Ç¤«¤Î¥Á¥§¥Ã¥¯
           MOVE    SPA-COM-INPUTCD (SPA-GMN-IDX)   TO  WRK-SRYCD
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                   AT   END
                       MOVE    SPACE           TO  WRK-KBN
                       MOVE    SPACE           TO  WRK-KBN2
                       MOVE    ZERO            TO  WRK-KAISU
                   WHEN   (TBL-SRYCD (TBL-IDX) =   WRK-SRYCD) 
                       MOVE    TBL-KBN   (TBL-IDX)     TO  WRK-KBN
                       MOVE    TBL-KBN2  (TBL-IDX)     TO  WRK-KBN2
                       MOVE    ZERO            TO  WRK-KAISU
           END-SEARCH
      *
      *    Æ±ÆüºÆ¿ÇÎÁ¤ØÃÖ´¹¤¨
           IF      WRK-KBN             =   "T"
               MOVE    "12"                TO  WRK-SRYKBN
               MOVE    "S"                 TO  WRK-KBN
      *        ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
               PERFORM 2001-SRYCD-TBL-SEC
      *        ÅÅÏÃºÆ¿Ç¤Î»þ¡¢Æ±ÆüÅÅÏÃºÆ¿Ç¤Ø¿¶¤êÂØ¤¨
               MOVE    SPA-GMN-IDX         TO  WRK-IDX-IN
               PERFORM 33041-SRYCD-ADD-SEC
               GO      TO      500-TELDOUSAISIN-SET-EXT
           END-IF
      *
      *    ÅÅÏÃºÆ¿Ç°Ê³°¤Î»þ¡¢ºÆÅÙ¿Ç»¡ÎÁ»»Äê¤Ø
           MOVE    SPACE               TO  SPA-SCR-REC
           INITIALIZE                  SPA-SCR-REC
           MOVE    ZERO                TO  SPA-GMN-MAX
           MOVE    ZERO                TO  IDX2
           MOVE    ZERO                TO  SPA-GMN-IDX
           MOVE    ZERO                TO  SPA-FUKU-SRYKA
           MOVE    ZERO                TO  SPA-SYOSIN
           PERFORM 100-SANTEI-CHK-SEC
           PERFORM 200-SYOSIN-SET-SEC
      *
           .
       500-TELDOUSAISIN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *     ºÞÊ¬Î¥Á°¤ÎÆÃÄê»»Äê²ó¿ô¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       600-SANTEI-CNT-SEC              SECTION.
      *
      *    ÆÃÄê¤Î¿ÇÎÅ¹Ô°Ù¤ÎÍ­Ìµ
           MOVE    ZERO                TO  SPA-NETAKIRI-ARI
           MOVE    ZERO                TO  SPA-ROUMANSEI-ARI
           MOVE    ZERO                TO  SPA-HOUMON-ARI
           MOVE    ZERO                TO  SPA-SYONIKA-ARI
           MOVE    ZERO                TO  SPA-TELSAI-ARI
           MOVE    ZERO                TO  SPA-FUKU-SRYKA
           MOVE    ZERO                TO  SPA-ZAIMATU-ARI
           MOVE    ZERO                TO  SPA-KAIHOU1-ARI
           MOVE    ZERO                TO  SPA-KAIHOU2-ARI
      *
           MOVE    ZERO                TO  SPA-SEIKATU-ARI
           MOVE    ZERO                TO  SPA-KYUSEI-FLG
      *    ºßÂðÎÅÍÜ»ØÆ³ÎÁ»»Äê
           MOVE    ZERO                TO  WRK-ZAITAKU-CNT
      *
      *    Êñ³ç¤Þ¤È¤áÆþÎÏÂÐ¾Ý³°
           IF      SPA-HKNCOMBINUM     =   "9999"
               GO      TO      600-SANTEI-CNT-EXT
           END-IF
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE          )  OR
                              (SPA-COM-INPUTCD(IDX) =   SPACE  AND
                               SPA-GMN-INPUTCD(IDX) =   SPACE )
      *
      *        ÆÃÄê¤Î¿ÇÎÅ¹Ô°ÙÈ½Äê
               EVALUATE    SPA-COM-INPUTCD (IDX)
      *            ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê¡Ê±¡³°½èÊýäµ¤¢¤ê¡Ë
                   WHEN    "114701210"
                       MOVE    1               TO  SPA-NETAKIRI-ARI
      *                ±¡³°
                       MOVE    "1"             TO  SPA-INGAIKBN
      *            ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê¡Ê±¡³°½èÊýäµ¤Ê¤·¡Ë
                   WHEN    "114701710"
                       MOVE    2               TO  SPA-NETAKIRI-ARI
      *                ±¡Æâ
                       MOVE    "0"             TO  SPA-INGAIKBN
      *H14.3.31¤Þ¤Ç
      *            ¿²¤¿¤­¤êÏ·¿ÍË¬Ìä¿Ç»¡ÎÁ
      *            WHEN    "114700110"
      *            WHEN    "114701110"
      ***              MOVE    1               TO  SPA-HOUMON-ARI
      *
      *            ºßÂð´µ¼ÔË¬Ìä¿Ç»¡ÎÁ
                   WHEN    "114001110"
                       MOVE    1               TO  SPA-HOUMON-ARI
      *
      *            ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ
                   WHEN    "114007610"
      *                ±¡³°
                       MOVE    1               TO  SPA-ZAIMATU-ARI
                       MOVE    "1"             TO  SPA-INGAIKBN
                   WHEN    "114007710"
      *                ±¡Æâ
                       MOVE    "0"             TO  SPA-INGAIKBN
                       MOVE    2               TO  SPA-ZAIMATU-ARI
      *
      *            ³«Êü·¿ÉÂ±¡¶¦Æ±»ØÆ³ÎÁ¡Ê£±¡Ë
                   WHEN    "180010510"
      *            ºßÂð´µ¼ÔÆþ±¡¶¦Æ±»ØÆ³ÎÁ¡Ê£±¡Ë
                   WHEN    "180015910"
                       MOVE    1               TO  SPA-KAIHOU1-ARI
      *            ¿²¤¿¤­¤êÏ·¿ÍÂà±¡»þ¶¦Æ±»ØÆ³ÎÁ¡Ê£±¡Ë
                   WHEN    "190766710"
                       MOVE    1               TO  SPA-KAIHOU2-ARI
      *
      *            À¸³è½¬´·ÉÂ»ØÆ³´ÉÍýÎÁ
                   WHEN    "113003910"
                   WHEN    "113005810"
                   WHEN    "113005910"
      *                ±¡³°
                       MOVE    "1"             TO  SPA-INGAIKBN
                       MOVE    1               TO  SPA-SEIKATU-ARI
                   WHEN    "113004010"
                   WHEN    "113006010"
                   WHEN    "113006110"
      *                ±¡Æâ
                       MOVE    "0"             TO  SPA-INGAIKBN
                       MOVE    1               TO  SPA-SEIKATU-ARI
      *
      *            ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê»»Äê
                   WHEN    "113003510"
                   WHEN    "113003610"
      *                ±¡³°
                       MOVE    "1"             TO  SPA-INGAIKBN
                   WHEN    "113003710"
                   WHEN    "113003810"
      *                ±¡Æâ
                       MOVE    "0"             TO  SPA-INGAIKBN
      *
      *                Æ±ÆüÂ¾²Ê¼õ¿Ç
                   WHEN    "830000020"
                   WHEN    "830000021"
                       MOVE    1               TO  SPA-FUKU-SRYKA
      *            ËýÀ­áÖÄË¼À´µ´ÉÍýÎÁ
                   WHEN    "113006510"
                       MOVE    1               TO  SPA-TOKUTEI-KNJ
      *            µÞÀ­È¯À¸
                   WHEN    "099800101"
                       MOVE    1               TO  SPA-KYUSEI-FLG
               END-EVALUATE
      *        ºßÂðÎÅÍÜ»ØÆ³ÎÁ¤ÎÈ½Äê
               IF     (SPA-COM-INPUTCD (IDX)(1:3)  =   "114") AND
                      (SPA-COM-DATAKBN (IDX)       =   "1"  )
                   IF     (SPA-COM-CDKBN-KBN(IDX)  =   "C"  ) AND
                          (SPA-COM-CDKBN-KBNNUM (IDX)
                                                   >=  "100" AND
                                                   <=  "112")
                       MOVE    1               TO  WRK-ZAITAKU-CNT
                   END-IF
               END-IF
      *
      *        ¿Ç»¡ÎÁ¸¡º÷
               SET     TBL-IDX             TO  1
               SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                   AT   END
                        MOVE    ZERO           TO  FLG-ARI
                    WHEN   SPA-COM-INPUTCD (IDX)
                                              =   TBL-SRYCD (TBL-IDX)
                        MOVE    1                  TO  FLG-ARI
                        MOVE    TBL-KBN (TBL-IDX)  TO  WRK-KBN
               END-SEARCH
               IF      FLG-ARI             =   1
                   EVALUATE    WRK-KBN
      *                ÅÅÏÃºÆ¿Ç¡¢Æ±ÆüÅÅÏÃºÆ¿Ç
                       WHEN    "T"
                       WHEN    "S"
                           MOVE    1               TO  SPA-TELSAI-ARI
      **************** WHEN    SPACE
                       WHEN    OTHER
      *                ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê»»Äê
                           IF      SPA-COM-INPUTCD (IDX)(1:3)
                                                       =   "113"
                               MOVE    1           TO  SPA-SYONIKA-ARI
                           END-IF
                   END-EVALUATE
               END-IF
           END-PERFORM
           IF      SPA-SYONIKA-ARI     =   ZERO
               MOVE    SPA-SYONIKA-ARI2    TO  SPA-SYONIKA-ARI
           END-IF
           IF      SPA-SYONIKA-ARI     =   ZERO
               IF      WRK-ZAITAKU-CNT     =   ZERO
                   MOVE    SPA-SYONIKA-ARI3    TO  SPA-SYONIKA-ARI
               END-IF
           END-IF
      *    ¿²¤¿¤­¤ê¤¬ºï½ü¤µ¤ì¤¿»þ¡¢£²£´»þ´Ö²Ã»»¤Î¼«Æ°È¯À¸¤ò¤¹¤ë
           IF      SPA-NETAKIRI-ARI    =   ZERO
               MOVE    ZERO                TO  SPA-NETAKIRI-ARI3
           END-IF
           .
       600-SANTEI-CNT-EXT.
           EXIT.
      *
      *****************************************************************
      *     ºÞÊ¬Î¥¸å¤ÎÆÃÄê»»Äê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       700-SANTEI-CHK-SEC              SECTION.
      *
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ¥Á¥§¥Ã¥¯
           PERFORM 5019-SYONIKA-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      700-SANTEI-CHK-EXT
           END-IF
      *
      *    ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê¥Á¥§¥Ã¥¯
           IF     (SPA-NETAKIRI-ARI    NOT =   ZERO )  OR
                  (SPA-NETAKIRI-ARI2   NOT =   ZERO )
               PERFORM 5021-NETAKIRI-CHK-SEC
               IF      SPA-ERRCD       NOT =   SPACE
                   GO      TO      700-SANTEI-CHK-EXT
               END-IF
           END-IF
      *
      *    À¸³è½¬´·ÉÂ»ØÆ³´ÉÍý²Ê¥Á¥§¥Ã¥¯
           IF     (SPA-SEIKATU-ARI     NOT =   ZERO )  OR
                  (SPA-SEIKATU-ARI2    NOT =   ZERO )
               PERFORM 5022-SEIKATU-CHK-SEC
               IF      SPA-ERRCD       NOT =   SPACE
                   GO      TO      700-SANTEI-CHK-EXT
               END-IF
           END-IF
      *
      *    ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ¥Á¥§¥Ã¥¯
           IF     (SPA-ZAIMATU-ARI     NOT =   ZERO )  OR
                  (SPA-ZAIMATU-ARI2    NOT =   ZERO )
               PERFORM 5022-ZAIMATU-CHK-SEC
           END-IF
      *
           .
       700-SANTEI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       5019-SYONIKA-CHK-SEC                SECTION.
      *
           MOVE    ZERO                TO  FLG-KBN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE    )   OR
                              (SPA-ERRCD           NOT =   SPACE )  OR
                              (SPA-GMN-INPUTCD (IDX)   =   SPACE )
      *      ¼«Èñ¤ÏÂÐ¾Ý³°
             IF     (SPA-COM-SRYKBN(IDX)     =   "95" OR
                                                 "96" OR
                                                 "98" OR
                                                 "99"  )  OR
      *!             Ê£¿ô²Ê¡¦ÊÝ¸±¹Ô
                    (SPA-GMN-INPUTCD(IDX)(1:1)   =   "#"  OR
                                                     "$" )
      *              ¥³¥á¥ó¥È
                 OR (SPA-COM-INPUTCD(IDX)(1:1)   =   "8" )
                 OR (SPA-COM-INPUTCD(IDX)(1:3)   =   "008" )
                 CONTINUE
             ELSE
      *        ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê¤Î»þ¡¢¾®»ù²Ê³°Íè¿ÇÎÅ²Ê¤Î¤ß¤Ç¤¢¤ë¤³¤È
               IF      SPA-SYONIKA-ARI     NOT =   ZERO
                   EVALUATE    SPA-COM-SRYKBN  (IDX)
                       WHEN    "11"
                       WHEN    "12"
                           MOVE    ZERO            TO  FLG-OK
      *                    ¿Ç»¡ÎÁ¸¡º÷
                           PERFORM 50191-SRYCD-CHK-SEC
      *                    ÅÅÏÃºÆ¿Ç¤Ç¡¢ÅöÆü¿Ç»¡¤¬¤Ê¤¤¤³¤È
                           IF     (SPA-SYONIKA-ARI NOT =   2 )
                             AND  (SPA-SYONIKA-ARI2    =   ZERO)
                             AND  (WRK-KBN             =   "T"
                                                       OR  "S"  )
                               MOVE    1           TO  FLG-KBN
                               MOVE    1           TO  FLG-OK
                           END-IF
      *                    ÅÅÏÃºÆ¿Ç¤Î²Ã»»¤Ï£Ï£Ë
                           IF     (FLG-KBN             =   1  ) AND
                                  (SPA-COM-SRYKBN(IDX) =   "12") AND
                                  (SPA-COM-DATAKBN(IDX)
                                                       =   "2" )
                               MOVE    1           TO  FLG-OK
                           END-IF
                           IF      FLG-OK          =   1
                               CONTINUE
                           ELSE
                               MOVE    "0044"      TO  SPA-ERRCD
                               MOVE    "1"         TO  SPA-COM-CUR
                                                                (IDX)
                           END-IF
      *
                       WHEN    "13"
      *                    ¼ïÊÌ¤Î¤ß¤Ï£Ï£Ë
                           IF      SPA-GMN-INPUTCD(IDX)(1:4) =   ".130"
                               CONTINUE
                           ELSE
      *                        ¿Ç»¡ÎÁ¸¡º÷
                               PERFORM 50191-SRYCD-CHK-SEC
                               IF      WRK-KAISU       =   2
      *                        Æ±ÆüºÆ¿Ç¤Î»þ¡¢¿Ç»¡ÎÁ¤Ï»»Äê¤Ç¤­¤Ê¤¤
                                   IF      SPA-SYONIKA-ARI     =   2
                                       MOVE    "0046"  TO  SPA-ERRCD
                                       MOVE    "1"     TO  SPA-COM-CUR
                                                              (IDX)
                                   END-IF
                               END-IF
      *                        ÆÃÄê¤Î¿ÇÎÅ¹Ô°Ù¤Ç¤¢¤ë¤³¤È
                               PERFORM 50192-SYONIKASRYCD-CHK-SEC
                               IF      FLG-SYONIKA-CHK     =   ZERO
                                   MOVE    "0044"      TO  SPA-ERRCD
                                   MOVE    "1"         TO  SPA-COM-CUR
                                                                (IDX)
                               END-IF
                           END-IF
      *
      *                ±ý¿ÇÎÁ¤Ç¤¢¤ë¤³¤È
                       WHEN    "14"
                           CONTINUE
      *
                       WHEN    "21"
                       WHEN    "22"
                       WHEN    "23"
      *                    ±¡Æâ»þ¤Î¿ÇÎÅ¼ïÊÌÊÑ¹¹
                           PERFORM 50192-SRYSYUKBN-CHK-SEC
      *
      *                    ÌôºÞ¤Î»þ¡¢±¡³°½èÊý¤Ç¤¢¤ë¤³¤È
                           IF    ((SPA-INGAIKBN        =   "1"  ) AND
                                  (SPA-COM-SRYSYUKBN(IDX)
                                                       =   "210" OR
                                                           "212" OR
                                                           "220" OR
                                                           "222" OR
                                                           "230" OR
                                                           "232" OR
                                                           "290" OR
                                                           "292" OR
                                                           SPACE )) OR
                                 ( SPA-COM-SRYSYUKBN(IDX)
                                                       =   "212" OR
                                                           "222" OR
                                                           "232" )
                               CONTINUE
                           ELSE
      *                      ½èÊý¤Î¤ß¤Ï£Ï£Ë
                             IF      SPA-COM-SRYSYUKBN(IDX)(3:1)
                                                   NOT =   "3" 
                               MOVE    "0044"          TO  SPA-ERRCD
                               MOVE    "1"             TO  SPA-COM-CUR
                                                                (IDX)
                             END-IF
                           END-IF
                       WHEN    OTHER
                            MOVE    "0044"      TO  SPA-ERRCD
                            MOVE    "1"         TO  SPA-COM-CUR
                                                          (IDX)
      *                    ³«Êü·¿ÉÂ±¡¶¦Æ±»ØÆ³ÎÁ¡Ê£±¡Ë¤Ç¤¢¤ë¤³¤È
                           PERFORM 50192-SYONIKASRYCD-CHK-SEC
                           IF      FLG-SYONIKA-CHK     =   1
                               MOVE    SPACE       TO  SPA-ERRCD
                               MOVE    SPACE       TO  SPA-COM-CUR
                                                                (IDX)
                           END-IF
      *                    ¤½¤ÎÂ¾¤Î¿ÇÎÅ¼ïÊÌ
                           IF      SPA-GMN-INPUTCD(IDX)(1:4)  =   ".800"
                                                              OR  ".850"
                               MOVE    SPACE       TO  SPA-ERRCD
                               MOVE    SPACE       TO  SPA-COM-CUR
                                                                (IDX)
                           END-IF
                   END-EVALUATE
               ELSE
      *        ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê°Ê³°¤Î»þ¡¢¾®»ù²Ê³°Íè¿ÇÎÅ²Ê¤Ç¤Ê¤¤¤³¤È
      *            ÆÃÄê¤Î¿ÇÎÅ¹Ô°Ù¤Ç¤¢¤ë¤³¤È
                   PERFORM 50192-SYONIKASRYCD-CHK-SEC
                   IF     (FLG-SYONIKA-CHK         =   ZERO)  OR
      *                   ³«Êü·¿ÉÂ±¡¶¦Æ±»ØÆ³ÎÁ¡¢ÃÏ°èÏ¢ÂÓ²Ã»»
                          (WRK-SYONIKA-KBN         =   "9" )
                       CONTINUE
                   ELSE
                       MOVE    "0045"          TO  SPA-ERRCD
                       MOVE    "1"             TO  SPA-COM-CUR (IDX)
                   END-IF
               END-IF
             END-IF
      *
             IF      SPA-COM-ZAIEND (IDX)  =   "1"
                  MOVE    ZERO             TO  FLG-KBN
             END-IF
           END-PERFORM
           .
       5019-SYONIKA-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅêÌô¼ïÊÌÊÑ¹¹½èÍý
      *****************************************************************
       50192-SRYSYUKBN-CHK-SEC                SECTION.
      *
           IF      SPA-COM-SRYSYUKBN(IDX)  =   SPACE
      *        ±¡³°
               IF      SPA-INGAIKBN        =   "1"
                   CONTINUE
               ELSE
                   MOVE    SPA-COM-SRYKBN(IDX)
                                           TO  SPA-COM-SRYSYUKBN(IDX)
                                                               (1:2)
                   MOVE    "3"             TO  SPA-COM-SRYSYUKBN(IDX)
                                                               (3:1)
               END-IF
           END-IF
           IF      SPA-COM-SRYSYUKBN(IDX)  =   "210"
                                           OR  "220"
                                           OR  "230"
      *        ±¡³°
               IF      SPA-INGAIKBN        =   "1"
                   CONTINUE
               ELSE
                   MOVE    "3"             TO  SPA-COM-SRYSYUKBN(IDX)
                                                               (3:1)
                   IF      SPA-GMN-INPUTCD(IDX)(1:1)   =   "."
                       MOVE    "3"         TO  SPA-GMN-INPUTCD(IDX)
                                                               (4:1)
                       PERFORM 501921-SRYSYUMEI-HEN-SEC
                   END-IF
               END-IF
           END-IF
      **** ½èÊý¤Î¤ß
      *    IF      SPA-COM-SRYSYUKBN(IDX)(3:1) =   "3"
      *        ±¡³°
      *        IF      SPA-INGAIKBN        =   "1"
      *            MOVE    "0"             TO  SPA-COM-SRYSYUKBN(IDX)
      *                                                        (3:1)
      *            IF      SPA-GMN-INPUTCD(IDX)(1:1)   =   "."
      *                MOVE    "0"         TO  SPA-GMN-INPUTCD(IDX)
      *                                                        (4:1)
      *                PERFORM 501921-SRYSYUMEI-HEN-SEC
      *            END-IF
      *        END-IF
      *****END-IF
           .
       50192-SRYSYUKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¼ïÊÌÌ¾ÊÔ½¸½èÍý
      *****************************************************************
       501921-SRYSYUMEI-HEN-SEC             SECTION.
      *
      *    ¿ÇÎÅ¼ïÊÌ¥Æ¡¼¥Ö¥ë¥»¥Ã¥È
           CALL    "ORCSSRYSYU"        USING
                                       MSYU-DATA-REC
      *
           SET     MSYU-IDX            TO  1
           SEARCH      MSYU-TBL-OCC    VARYING   MSYU-IDX
                   AT   END
                       MOVE    SPACE       TO  SPA-GMN-MEISYO (IDX)
                   WHEN    SPA-COM-SRYSYUKBN(IDX)
                                           =   MSYU-SRYSYUKBN 
                                                           (MSYU-IDX)
                       MOVE    MSYU-SRYMEI (MSYU-IDX)
                                           TO  SPA-GMN-MEISYO (IDX)
           END-SEARCH 
      *
           .
       501921-SRYSYUMEI-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¿Ç»¡ÎÁ¸¡º÷½èÍý
      *****************************************************************
       50191-SRYCD-CHK-SEC                SECTION.
      *    ¿Ç»¡ÎÁ¸¡º÷
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
               AT   END
                    MOVE    ZERO           TO  FLG-ARI
                    MOVE    SPACE          TO  WRK-KBN
                    MOVE    ZERO           TO  WRK-KAISU
                WHEN   SPA-COM-INPUTCD (IDX)
                                          =   TBL-SRYCD (TBL-IDX)
                    MOVE    1                  TO  FLG-ARI
                    MOVE    TBL-KBN (TBL-IDX)  TO  WRK-KBN
                    MOVE    TBL-KAISU (TBL-IDX)    TO  WRK-KAISU
           END-SEARCH
           .
       50191-SRYCD-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ²Ê¥Á¥§¥Ã¥¯¥¯½èÍý
      *****************************************************************
       50192-SYONIKASRYCD-CHK-SEC                SECTION.
      *
      *    ¿Ç»¡ÎÁ¸¡º÷
           SET     TBL-SYO             TO  1
           SEARCH  TBL-SYONIKA-OCC     VARYING   TBL-SYO
               AT   END
                    MOVE    ZERO           TO  FLG-SYONIKA-CHK
                    MOVE   SPACE           TO  WRK-SYONIKA-KBN
                WHEN   SPA-COM-INPUTCD (IDX)
                                           =   TBL-SYONIKA-SRYCD
                                                      (TBL-SYO)
                    MOVE    TBL-SYONIKA-KBN (TBL-SYO)
                                           TO  WRK-SYONIKA-KBN
                    MOVE    1              TO  FLG-SYONIKA-CHK
           END-SEARCH
           .
       50192-SYONIKASRYCD-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï·¿ÍËýÀ­¼ÀÉÂ³°ÍèÁí¹ç¿ÇÎÅ²Ê¥Á¥§¥Ã¥¯¥¯½èÍý
      *****************************************************************
       5020-ROUMANSEI-CHK-SEC                SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE    )   OR
                              (SPA-ERRCD           NOT =   SPACE )  OR
                              (SPA-GMN-INPUTCD (IDX)   =   SPACE )
      *        À¸³è»ØÆ³¡¢¸¡ºº¡¢Ãí¼Í¡¢ºßÂðÎÁ°Ê³°¤Ç¤¢¤ë¤³¤È
               EVALUATE    SPA-COM-SRYKBN(IDX)
                   WHEN    "31"
                   WHEN    "32"
                   WHEN    "33"
                   WHEN    "60"
                       MOVE    "0052"          TO  SPA-ERRCD
                       MOVE    "1"             TO  SPA-COM-CUR (IDX)
                   WHEN    "21"
                   WHEN    "22"
                   WHEN    "23"
      *                ±¡Æâ»þ¤Î¿ÇÎÅ¼ïÊÌÊÑ¹¹
                       PERFORM 50192-SRYSYUKBN-CHK-SEC
      *                ÌôºÞ¤Î»þ¡¢±¡³°½èÊý¤Ç¤¢¤ë¤³¤È
                       IF    ((SPA-INGAIKBN        =   "1"  ) AND
                              (SPA-COM-SRYSYUKBN(IDX)
                                                   =   "210" OR
                                                       "212" OR
                                                       "220" OR
                                                       "222" OR
                                                       "230" OR
                                                       "232" OR
                                                       "290" OR
                                                       "292" OR
                                                       SPACE  ))  OR
                             ( SPA-COM-SRYSYUKBN(IDX)
                                                   =   "212" OR
                                                       "222" OR
                                                       "232"  )
      *!!                  ±¡³°½èÊýäµ¤ò¸òÉÕ¤·¤Ê¤¤¾ì¹ç¤Î»þ¡¢¥¨¥é¡¼
      *                    IF      SPA-ROUMANSEI-ARI   =   2
      *                      ½èÊý¤Î¤ß¤Ï£Ï£Ë
      *                      IF      SPA-COM-SRYSYUKBN(IDX)(3:1)
      *                                            NOT =   "3" 
      *                        MOVE    "0052"          TO  SPA-ERRCD
      *                        MOVE    "1"             TO  SPA-COM-CUR
      *                                                        (IDX)
      *                      END-IF
      *!!                  END-IF
                           CONTINUE
                       ELSE
      *                    ½èÊý¤Î¤ß¤Ï£Ï£Ë
                           IF      SPA-COM-SRYSYUKBN(IDX)(3:1)
                                                   NOT =   "3" 
                               MOVE    "0052"          TO  SPA-ERRCD
                               MOVE    "1"             TO  SPA-COM-CUR
                                                               (IDX)
                           END-IF
                       END-IF
               END-EVALUATE
           END-PERFORM
           .
       5020-ROUMANSEI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       5021-NETAKIRI-CHK-SEC                SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE    )   OR
                              (SPA-ERRCD           NOT =   SPACE )  OR
                              (SPA-GMN-INPUTCD (IDX)   =   SPACE )
      *        ¸¡ºº¡¢ÅêÌô¤Ï»»Äê¤Ç¤­¤Ê¤¤
               EVALUATE    SPA-COM-SRYKBN(IDX)
                   WHEN    "60"
                       MOVE    "0054"          TO  SPA-ERRCD
                       MOVE    "1"             TO  SPA-COM-CUR (IDX)
                   WHEN    "21"
                   WHEN    "22"
                   WHEN    "23"
      *                ±¡Æâ»þ¤Î¿ÇÎÅ¼ïÊÌÊÑ¹¹
                       PERFORM 50192-SRYSYUKBN-CHK-SEC
      *                ÌôºÞ¤Î»þ¡¢±¡³°½èÊý¤Ç¤¢¤ë¤³¤È
                       IF    ((SPA-INGAIKBN        =   "1"  ) AND
                              (SPA-COM-SRYSYUKBN(IDX)
                                                   =   "210" OR
                                                       "212" OR
                                                       "220" OR
                                                       "222" OR
                                                       "230" OR
                                                       "232" OR
                                                       "290" OR
                                                       "292" OR
                                                       SPACE  ))  OR
                             ( SPA-COM-SRYSYUKBN(IDX)
                                                   =   "212" OR
                                                       "222" OR
                                                       "232"  )
      *!!                  ±¡³°½èÊýäµ¤ò¸òÉÕ¤·¤Ê¤¤¾ì¹ç¤Î»þ¡¢¥¨¥é¡¼
      *                    IF     (SPA-NETAKIRI-ARI   =   2 )  OR
      *                           (SPA-NETAKIRI-ARI2  =   2 )
      *                      ½èÊý¤Î¤ß¤Ï£Ï£Ë
      *                      IF      SPA-COM-SRYSYUKBN(IDX)(3:1)
      *                                            NOT =   "3" 
      *                        MOVE    "0054"          TO  SPA-ERRCD
      *                        MOVE    "1"             TO  SPA-COM-CUR
      *                                                         (IDX)
      *                      END-IF
      *!!                  END-IF
                           CONTINUE
                       ELSE
      *                    ½èÊý¤Î¤ß¤Ï£Ï£Ë
                           IF      SPA-COM-SRYSYUKBN(IDX)(3:1)
                                                   NOT =   "3" 
                               MOVE    "0054"          TO  SPA-ERRCD
                               MOVE    "1"             TO  SPA-COM-CUR
                                                             (IDX)
                           END-IF
                       END-IF
               END-EVALUATE
           END-PERFORM
           .
       5021-NETAKIRI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    À¸³è½¬´·ÉÂ»ØÆ³´ÉÍý²Ê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       5022-SEIKATU-CHK-SEC                SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE    )   OR
                              (SPA-ERRCD           NOT =   SPACE )  OR
                              (SPA-GMN-INPUTCD (IDX)   =   SPACE )
      *        ¸¡ºº¡¢ÅêÌô¡¢Ãí¼Í¤Ï»»Äê¤Ç¤­¤Ê¤¤
               EVALUATE    SPA-COM-SRYKBN(IDX)
                   WHEN    "60"
                   WHEN    "31"
                   WHEN    "32"
                   WHEN    "33"
                       MOVE    "0068"          TO  SPA-ERRCD
                       MOVE    "1"             TO  SPA-COM-CUR (IDX)
                   WHEN    "21"
                   WHEN    "22"
                   WHEN    "23"
      *                ±¡Æâ»þ¤Î¿ÇÎÅ¼ïÊÌÊÑ¹¹
                       PERFORM 50192-SRYSYUKBN-CHK-SEC
      *                ÌôºÞ¤Î»þ¡¢±¡³°½èÊý¤Ç¤¢¤ë¤³¤È
                       IF    ((SPA-INGAIKBN        =   "1"  ) AND
                              (SPA-COM-SRYSYUKBN(IDX)
                                                   =   "210" OR
                                                       "212" OR
                                                       "220" OR
                                                       "222" OR
                                                       "230" OR
                                                       "232" OR
                                                       "290" OR
                                                       "292" OR
                                                       SPACE  ))  OR
                             ( SPA-COM-SRYSYUKBN(IDX)
                                                   =   "212" OR
                                                       "222" OR
                                                       "232"  )
      *!!                  ±¡³°½èÊýäµ¤ò¸òÉÕ¤·¤Ê¤¤¾ì¹ç¤Î»þ¡¢¥¨¥é¡¼
      *                    IF     (SPA-SEIKATU-ARI     =   2 )  OR
      *                           (SPA-SEIKATU-ARI2    =   2 )
      *                      ½èÊý¤Î¤ß¤Ï£Ï£Ë
      *                      IF      SPA-COM-SRYSYUKBN(IDX)(3:1)
      *                                            NOT =   "3" 
      *                        MOVE    "0068"          TO  SPA-ERRCD
      *                        MOVE    "1"             TO  SPA-COM-CUR
      *                                                         (IDX)
      *                      END-IF
      *!!                  END-IF
                           CONTINUE
                       ELSE
      *                    ½èÊý¤Î¤ß¤Ï£Ï£Ë
                           IF      SPA-COM-SRYSYUKBN(IDX)(3:1)
                                                   NOT =   "3" 
                               MOVE    "0068"          TO  SPA-ERRCD
                               MOVE    "1"             TO  SPA-COM-CUR
                                                             (IDX)
                           END-IF
                       END-IF
               END-EVALUATE
           END-PERFORM
           .
       5022-SEIKATU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       5022-ZAIMATU-CHK-SEC                SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE    )   OR
                              (SPA-ERRCD           NOT =   SPACE )  OR
                              (SPA-GMN-INPUTCD (IDX)   =   SPACE )
      *        º£²óÆþÎÏ
               IF      SPA-ZAIMATU-ARI    NOT  =   ZERO
      *            ºßÂðÎÁ°Ê³°¤Ï»»Äê¤Ç¤­¤Ê¤¤
                   EVALUATE    SPA-COM-SRYKBN(IDX)
                   WHEN    "14"
                   WHEN    "95"
                   WHEN    "96"
                   WHEN    "98"
                   WHEN    "99"
                       CONTINUE
                   WHEN    "21"
                   WHEN    "22"
                   WHEN    "23"
      *                ±¡Æâ»þ¤Î¿ÇÎÅ¼ïÊÌÊÑ¹¹
                       PERFORM 50192-SRYSYUKBN-CHK-SEC
      *                ÌôºÞ¤Î»þ¡¢±¡³°½èÊý¤Ç¤¢¤ë¤³¤È
                       IF    ((SPA-INGAIKBN        =   "1"  ) AND
                              (SPA-COM-SRYSYUKBN(IDX)
                                                   =   "210" OR
                                                       "212" OR
                                                       "220" OR
                                                       "222" OR
                                                       "230" OR
                                                       "232" OR
                                                       "290" OR
                                                       "292" OR
                                                       SPACE  ))  OR
                             ( SPA-COM-SRYSYUKBN(IDX)
                                                   =   "212" OR
                                                       "222" OR
                                                       "232"  )
                           CONTINUE
                       ELSE
      *                    ½èÊý¤Î¤ß¤Ï£Ï£Ë
                           IF      SPA-COM-SRYSYUKBN(IDX)(3:1)
                                                   NOT =   "3" 
                               MOVE    "1401"          TO  SPA-ERRCD
                               MOVE    "1"             TO  SPA-COM-CUR
                                                             (IDX)
                           END-IF
                       END-IF
                       WHEN    "11"
                       WHEN    "12"
                           CONTINUE
                       WHEN    OTHER
      *                    »»Äê¥¨¥é¡¼
                           MOVE    "1401"          TO  SPA-ERRCD
                           MOVE    "1"             TO  SPA-COM-CUR (IDX)
                   END-EVALUATE
               END-IF
           END-PERFORM
           .
       5022-ZAIMATU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÆ¿ÇÎÁ¤Î£´²óÌÜ°Ê¹ß¤Î¿¶ÂØ¤¨½èÍý
      *****************************************************************
       800-SAISIN-HEN-SEC             SECTION.
      *
           MOVE    ZERO                TO  IDX-SIN
           MOVE    ZERO                TO  IDX-GAI
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE          )  OR
                              (SPA-COM-INPUTCD(IDX) =   SPACE  AND
                               SPA-GMN-INPUTCD(IDX) =   SPACE )
      *
      *        ¿Ç»¡ÎÁ¸¡º÷
      *        Ï«ºÒ¤Î»þ¡¢Ï«ºÒ¤Î¥³¡¼¥É¤ò¿¶¤êÂØ¤¨¤ë
               IF     (SPA-HKNKBN          =   1   )  AND
                      (IDX-SIN             =   ZERO)
                   SET     TBL-RSI             TO  1
                   SEARCH  TBL-RSI-SINSATU-OCC     VARYING   TBL-RSI
                       AT  END
                           MOVE    ZERO            TO  IDX-SIN
                       WHEN   SPA-COM-INPUTCD (IDX)
                                                =  TBLR-SRYCD (TBL-RSI)
                           MOVE    IDX             TO  IDX-SIN
                   END-SEARCH
                END-IF
           END-PERFORM
      *
      *    Ï«ºÒ¤Î»þ¡¢Ï«ºÒ¤Î¥³¡¼¥É¤ò¿¶¤êÂØ¤¨¤ë
           IF     (SPA-HKNKBN          =   1   )  AND
                  (IDX-SIN             >   ZERO)
               MOVE    TBLR-SRYCD (3)      TO  WRK-SRYCD
               MOVE    IDX-SIN             TO  WRK-IDX-IN
      *        ÄÉ²Ã¶¦ÄÌ½èÍý
               PERFORM 33041-SRYCD-ADD-SEC
               GO      TO      800-SAISIN-HEN-EXT
            END-IF
      *
           IF      IDX-SIN             >   ZERO
      *        ºÆ¿ÇÎÁÊÑ¹¹
               MOVE    "12"                TO  WRK-SRYKBN
               MOVE    1                   TO  FLG-SAISIN-CHK
      *        ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
               PERFORM 2001-SRYCD-TBL-SEC
               IF     (WRK-SRYCD       NOT =   SPACE )  AND
                      (WRK-SRYCD       NOT =   SPA-COM-INPUTCD(IDX-SIN))
                   MOVE    IDX-SIN         TO  WRK-IDX-IN
      *            ÄÉ²Ã¶¦ÄÌ½èÍý
                   PERFORM 33041-SRYCD-ADD-SEC
                END-IF
            END-IF
      *
      *
           IF      IDX-GAI             >   ZERO
      *        ³°Íè´ÉÍý²Ã»»¥³¡¼¥ÉÊÑ¹¹²Ã
               MOVE    1                   TO  FLG-SAISIN-CHK
               PERFORM 2002-SRYCD-TBLG-SEC
               IF     (WRK-SRYCD       NOT =   SPACE )  AND
                      (WRK-SRYCD       NOT =   SPA-COM-INPUTCD(IDX-GAI))
                   MOVE    IDX-GAI         TO  WRK-IDX-IN
      *            ÄÉ²Ã¶¦ÄÌ½èÍý
                   PERFORM 33041-SRYCD-ADD-SEC
               END-IF
           END-IF
      *
           .
       800-SAISIN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÆ¿ÇÎÁ¢ª½é¿ÇÎÁ¤Î¿¶ÂØ»þ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       900-SYOSIN-CHK-SEC             SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYCD
      *
           IF      SPA-COM-INPUTCD(1)(1:3) =   "113"
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ
      *        ±¡³°½èÊý
               IF      SPA-INGAIKBN        =   "1"
                   MOVE    "113003510"         TO  WRK-SRYCD
               ELSE
      *        ±¡Æâ½èÊý
                   MOVE    "113003710"         TO  WRK-SRYCD
               END-IF
           ELSE
               IF      SPA-HKNKBN          =   1
      *            Ï«ºÒ¤Î½é¿ÇÎÁ»»Äê
                   MOVE    ZERO                TO  WRK-KAISU
                   MOVE    "F"                 TO  WRK-KBN
                   PERFORM 20091-RSI-SINSATU-SEC
               ELSE
      *            ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ°Ê³°
                   MOVE    "11"                TO  WRK-SRYKBN
                   MOVE    "F"                 TO  WRK-KBN
      *            ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
                   PERFORM 2001-SRYCD-TBL-SEC
               END-IF
           END-IF
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           IF      SPA-COM-INPUTCD(1)(1:3) =   "113"
               MOVE    "2"                 TO  LNK-SC92-KBN
           ELSE
               MOVE    "1"                 TO  LNK-SC92-KBN
           END-IF
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    1                   TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *
      *    ¥¨¥é¡¼»þ¡¢ºÇ½é¤Î¥¨¥é¡¼¥³¡¼¥É¤ò¥»¥Ã¥È
           IF      SPA-ERRCD           NOT =   SPACE
               GO      TO      900-SYOSIN-CHK-EXT
           END-IF
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¤ÇÇ¯Îð¥¨¥é¡¼¤Ï£Ï£Ë¤È¤¹¤ë
           IF     (SPA-SYONIKA-ARI     NOT =   ZERO )  AND
                  (LNK-SC92-ERRCD5     NOT =   SPACE)
               MOVE    SPACE               TO  LNK-SC92-ERRCD5
           END-IF
      *
           IF      LNK-SC92-ERRAREA    NOT =   SPACE
               IF      LNK-SC92-ERRCD3     NOT =   SPACE
                   MOVE    LNK-SC92-ERRCD3         TO  SPA-ERRCD
               ELSE
                   MOVE    "0001"                  TO  SPA-ERRCD
               END-IF
           END-IF
      *
           .
       900-SYOSIN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý
      *****************************************************************
       1010-SINSATU-HEN-SEC              SECTION.
      *
           MOVE    ZERO                TO  FLG-SYOSIN2
           MOVE    ZERO                TO  FLG-GAI
           MOVE    ZERO                TO  FLG-DUMMY
           MOVE    ZERO                TO  FLG-SINSATU-ARI
           MOVE    SPACE               TO  WRK-KBN3
      *    »þ´Ö³°¤Ê¤·
           MOVE    ZERO                TO  FLG-JIKANKBN
      *    ÄûÀµ¤Î»þ¡¢½é¿ÇÎÁ¤ò»»ÄêÃæ¤«¤ÎÈ½Äê
           IF     (SPA-SYORIFLG        =   1    )  OR
                  (LNK-SC10S-SYORI     =   "W"  )
      *        »þ´Ö³°¤Ê¤·
               MOVE    1                   TO  FLG-JIKANKBN
      *
               PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE  )  OR
                              (SPA-COM-INPUTCD(IDX) =   SPACE  AND
                               SPA-GMN-INPUTCD(IDX) =   SPACE )
      *            ¿Ç»¡ÎÁ¸¡º÷
                   SET     TBL-IDX             TO  1
                   SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                       AT   END
                           MOVE    ZERO                TO  FLG-ARI
                           MOVE    SPACE               TO  WRK-KBN
                       WHEN   SPA-COM-INPUTCD (IDX) =
                                             TBL-SRYCD (TBL-IDX)
                           MOVE    1                   TO  FLG-ARI
                           MOVE    TBL-KBN  (TBL-IDX)  TO  WRK-KBN
                           MOVE    1               TO  FLG-SINSATU-ARI
                           MOVE    TBL-KBN  (TBL-IDX)  TO  WRK-KBN3
                   END-SEARCH
      *
                   IF      FLG-ARI         =   ZERO
      *            Ï«ºÒ¥³¡¼¥É¥Á¥§¥Ã¥¯¡Ê½é¿Ç¡Ë
                       SET     TBL-RSI              TO  1
                       SEARCH  TBL-RSI-SINSATU-OCC  VARYING   TBL-RSI
                           AT  END
                               MOVE    ZERO               TO  FLG-ARI
                               MOVE    SPACE              TO  WRK-KBN
                           WHEN    SPA-COM-INPUTCD (IDX)
                                              =   TBLR-SRYCD (TBL-RSI)
                               MOVE    1                  TO  FLG-ARI
                               MOVE    TBLR-KBN (TBL-RSI) TO  WRK-KBN
                               IF      WRK-KBN     NOT =   "G"
                                   MOVE    1           TO
                                                       FLG-SINSATU-ARI
                                   MOVE    TBLR-KBN (TBL-RSI)
                                                       TO  WRK-KBN2
                               END-IF
                       END-SEARCH
                   END-IF
                   IF      FLG-ARI             =   1
      *                ½é¿Ç
                       IF      WRK-KBN             =   "F"
      ******************   MOVE    1               TO  SPA-SYOSIN
                           MOVE    1               TO  FLG-SYOSIN2
                       END-IF
      *                ³°Íè´ÉÍý²Ã»»
                       IF      WRK-KBN             =   "G"
                           MOVE    1            TO  FLG-GAI
                       END-IF
                   END-IF
                   EVALUATE    SPA-COM-INPUTCD (IDX)
      *                    £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁ
                       WHEN    "099110001"
                       WHEN    "099120001"
                           MOVE    1              TO  FLG-DUMMY
                   END-EVALUATE
      *            ³°Íè´ÉÍý²Ã»»
                   SET     TBLG-IDX             TO  1
                   SEARCH  TBL-GAIRAI-OCC       VARYING   TBLG-IDX
                       AT  END
                           MOVE    ZERO          TO  FLG-ARI
                       WHEN   SPA-COM-INPUTCD (IDX)
                                            =   TBLG-SRYCD (TBLG-IDX)
                           MOVE    1            TO  FLG-GAI
                   END-SEARCH
               END-PERFORM
           END-IF
      *    ÃæÅÓ½ªÎ»¤Ç¿Ç»¡ÎÁ¤¬¤Ê¤¤»þ
           IF      LNK-SC10S-SYORI     =   "W"
               PERFORM 100-SANTEI-CHK-SEC
               PERFORM 600-SANTEI-CNT-SEC
           END-IF
      *    Æ±»þÂ¾²Ê¼õ¿Ç¤¬¤¢¤Ã¤¿»þ¤Ï¡¢¿Ç»¡ÎÁ¤ÎÊÑ¹¹¤ò¤ª¤³¤Ê¤ï¤Ê¤¤
      *    ¡ÊÃæÅÓ½ªÎ»»þ°Ê³°¡Ë
           IF    ( LNK-SC10S-SYORI NOT =   "W"  AND "K"
                                                AND "J" )  AND
                 ((SPA-LSTYMD          =   SPA-SRYYMD) OR
                  (SPA-RRK-LSTYMD      =   SPA-SRYYMD))
               IF      SPA-TAKA-SRYKA-R    NOT =   SPACE
                   GO      TO      1010-SINSATU-HEN-EXT
               END-IF
           END-IF
      *    £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁ¤ÎÊÑ¹¹¤ò¤ª¤³¤Ê¤ï¤Ê¤¤
           IF      FLG-DUMMY           =   1
               GO      TO      1010-SINSATU-HEN-EXT
           END-IF
      *    ÃæÅÓ½ªÎ»¤Ç¿Ç»¡ÎÁ¤¬¤Ê¤¤»þ
           IF     (LNK-SC10S-SYORI     =   "W"  )  AND
                  (FLG-SINSATU-ARI     =   ZERO )
               GO      TO      1010-SINSATU-HEN-EXT
           END-IF
      *    ÃæÅÓ½ªÎ»¤ÇÆ±ÆüºÆ¿Ç¤Ç¤¹¤Ç¤Ë¿Ç»¡¤¬¤¢¤ë»þ
           IF     (LNK-SC10S-SYORI     =   "W"  )  AND
                  (WRK-KBN3            =   "D"  )  AND
                 ((SPA-LSTYMD          =   SPA-SRYYMD) OR
                  (SPA-RRK-LSTYMD      =   SPA-SRYYMD))
               GO      TO      1010-SINSATU-HEN-EXT
           END-IF
      *    ½é¿ÇÎÁ»»Äê¤Ç¡¢´û¤ËÅöÆü¼õ¿Ç¤¬¤¢¤ë»þ¤ÏÂÐ¾Ý
           IF     (LNK-SC10S-SYORI     =   "W"  )  AND
                  (FLG-SYOSIN2         =   1    )
      *        ½é¿ÇÎÁ°Ê³°¤Î»þ¡¢¼«Æ°È¯À¸¤¢¤ê
               IF      SPA-SRYYMD      NOT =   SPA-LSTYMD
                   MOVE    FLG-SYOSIN2         TO  SPA-SYOSIN
                   GO      TO      1010-SINSATU-HEN-EXT
               ELSE
                   MOVE    ZERO            TO  SPA-SYOSIN
               END-IF
           END-IF
      *    ÃæÅÓ½ªÎ»¤ÇÅÅÏÃºÆ¿Ç¤Î»þ
           IF     (LNK-SC10S-SYORI     =   "W"  )  AND
                  (WRK-KBN3            =   "T"  OR  "S" )
               GO      TO      1010-SINSATU-HEN-EXT
           END-IF
      *    ÃæÅÓ½ªÎ»¤Ç»»Äê¤·¤Ê¤¤»þ
           IF     (LNK-SC10S-SYORI     =   "W"  )  AND
                  (SPA-CHUTOTENKAI-FLG =   "0"  )  AND
                  (SPA-WKSRY-KARTE-FLG     =   1   )
               GO      TO      1010-SINSATU-HEN-EXT
           END-IF
      *
           MOVE    SPACE               TO  SPA-ERRCD
           MOVE    SPA-SCR-REC         TO  HZN-SCR-REC
           MOVE    SPACE               TO  SPA-SCR-REC
           INITIALIZE                  SPA-SCR-REC
           MOVE    ZERO                TO  SPA-GMN-MAX
           MOVE    ZERO                TO  IDX2
           MOVE    ZERO                TO  SPA-GMN-IDX
           MOVE    ZERO                TO  SPA-FUKU-SRYKA
           PERFORM 100-SANTEI-CHK-SEC
      *
      *    ¿Ç»¡ÎÁÊÔ½¸
           PERFORM 200-SYOSIN-SET-SEC
      *    ¿ÇÎÅ¹Ô°ÙÆâÍÆ¤ÎÊÔ½¸
           PERFORM 10102-SINSATU-CHENGE-SEC
      *
           .
       1010-SINSATU-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¿Ç»¡ÎÁ¥Á¥§¥Ã¥¯ÊÑ´¹½èÍý
      *****************************************************************
       10102-SINSATU-CHENGE-SEC              SECTION.
      *
      *    ¿ÇÎÅ¹Ô°ÙÆâÍÆ¤ÎÊÔ½¸
           MOVE    ZERO                TO  FLG-JIKAN
           MOVE    ZERO                TO  FLG-CHK
           MOVE    SPACE               TO  WRK-SCR-REC
           INITIALIZE                  WRK-SCR-REC
           MOVE    ZERO                TO  IDX3
           MOVE    ZERO                TO  FLG-CHK-ALL
           MOVE    ZERO                TO  FLG-ARI2
           MOVE    ZERO                TO  FLG-FUKU
           MOVE    IDX2                TO  IDX-INT-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE  )  OR
                             ((HZN-COM-INPUTCD (IDX)   =   SPACE ) AND
                              (HZN-GMN-INPUTCD (IDX)   =   SPACE ))
      *
               MOVE    ZERO                    TO  FLG-ARI
               IF      FLG-FUKU                =   ZERO
                 IF     (HZN-COM-SRYKBN(IDX)     =   "11"  OR  "12"
                                                 OR  "13"  OR  "14" ) OR
      *                ÎÅÍÜÃ´Åö¼êÅö
                     ( HZN-COM-INPUTCD(IDX)     =   "199000610" )
                   MOVE    HZN-COM-INPUTCD(IDX) TO  WRK-SRYCD
                   IF      HZN-COM-INPUTCD(IDX) NOT =   SPACE
                       PERFORM 10101-SINSATU-CHK-SEC
                   END-IF
      *
                   IF      FLG-ARI             =   1
                       IF     (HZN-GMN-INPUTCD(IDX)(1:1) NUMERIC  )  AND
                              (HZN-GMN-INPUTCD(IDX)(2:1) =   SPACE)
                           MOVE    HZN-GMN-INPUTCD(IDX)(1:1)
                                                  TO  FLG-JIKAN
                       END-IF
                       MOVE    1               TO  FLG-CHK
                   END-IF
                 END-IF
               END-IF
               IF      HZN-GMN-INPUTCD(IDX)(1:1)   =   "$"
                   MOVE    1                   TO  FLG-FUKU
               END-IF
               IF      FLG-ARI                 =   ZERO
                   IF      FLG-CHK             =   ZERO
                       ADD     1                   TO  IDX3
                       MOVE    HZN-GMN-TBL (IDX)   TO  WRK-GMN-TBL(IDX3)
                   END-IF
               END-IF
      *
      *        ºÞËè¤ËÂÐ¾Ý¤òÊÔ½¸¤¹¤ë
               IF     (HZN-COM-ZAIEND (IDX)    =   "1" )  OR
                     ((IDX                     <   SPA-MAX-LINE )  AND
                      (WRK-GMN-INPUTCD(IDX + 1)(1:1)  =  "."))
                   IF     (IDX3                =   1  )  AND
                          (WRK-GMN-INPUTCD(IDX3)(1:1)  =  "." )
                       MOVE    ZERO                TO  IDX3
                   END-IF
                   PERFORM VARYING     IDX4    FROM   1   BY  1
                           UNTIL       IDX4    >   IDX3
                       ADD     1                   TO  IDX2
                       ADD     1                   TO  SPA-GMN-IDX
                       MOVE    WRK-GMN-TBL(IDX4)   TO  SPA-GMN-TBL
                                                                (IDX2)
                       MOVE    SPACE               TO  SPA-MAE-INPUTCD
                                                                (IDX2)
                       MOVE    SPACE               TO  SPA-COM-CHKFLG
                                                                (IDX2)
                   END-PERFORM
                   INITIALIZE                  WRK-SCR-REC
                   MOVE    ZERO                TO  IDX3
                   MOVE    ZERO                TO  FLG-CHK-ALL
                   MOVE    ZERO                TO  FLG-CHK
               END-IF
           END-PERFORM
      *
      *    ¿Ç»¡ÎÁ¤ËÊÑ¹¹¤¬Ìµ¤¤»þ¡¢¤½¤Î¤Þ¤Þ
      *!** IF      FLG-ARI2            =   1
      *        MOVE    HZN-SCR-REC         TO  SPA-SCR-REC
      *        GO      TO      10102-SINSATU-CHENGE-EXT
      *!   END-IF
      *
      *    ºÞËè¤ËÂÐ¾Ý¤òÊÔ½¸¤¹¤ë
           IF      IDX3                >   ZERO
               IF     (IDX3                =   1  )  AND
                      (WRK-GMN-INPUTCD(IDX3)(1:1)  =  "." )
                   MOVE    ZERO                TO  IDX3
               END-IF
               PERFORM VARYING     IDX4    FROM   1   BY  1
                       UNTIL       IDX4    >   IDX3
                   ADD     1                   TO  IDX2
                   ADD     1                   TO  SPA-GMN-IDX
                   MOVE    WRK-GMN-TBL(IDX4)   TO  SPA-GMN-TBL
                                                            (IDX2)
                   MOVE    SPACE               TO  SPA-MAE-INPUTCD(IDX2)
                   MOVE    SPACE               TO  SPA-COM-CHKFLG
                                                                (IDX2)
               END-PERFORM
           END-IF
      *    »þ´Ö³°ÆþÎÏ¤¢¤ê
           IF      FLG-JIKAN       NOT =   ZERO
               IF      SPA-COM-INPUTCD(01)(1:1)    =   "1"
                  MOVE    SPA-GMN-INPUTCD(01) TO  WRK-INPUTCD
      *           ´û¤Ë»þ´Ö³°¤¬¤¢¤ë¾ì¹ç¡¢Á°¤Î»þ´Ö³°¤Ø
                  IF     (SPA-GMN-INPUTCD(01)(1:1) NUMERIC  )  AND
                         (SPA-GMN-INPUTCD(01)(2:1) =   SPACE)
                       MOVE    SPA-GMN-INPUTCD(01)(3:)
                                               TO  WRK-INPUTCD
                   END-IF
                   MOVE    SPACE               TO  SPA-GMN-INPUTCD(01)
                   MOVE    FLG-JIKAN           TO  SPA-GMN-INPUTCD(01)
                                                                (1:1)
                   MOVE    WRK-INPUTCD         TO  SPA-GMN-INPUTCD(01)
                                                                (3:)
                   MOVE    FLG-JIKAN           TO  SPA-COM-TIMEFLG(01)
               END-IF
           END-IF
           .
       10102-SINSATU-CHENGE-EXT.
           EXIT.
      *****************************************************************
      *    ¿Ç»¡ÎÁ¥Á¥§¥Ã¥¯ÊÑ´¹½èÍý
      *****************************************************************
       10101-SINSATU-CHK-SEC              SECTION.
      *
      *    ¿Ç»¡ÎÁ¸¡º÷
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
               AT  END
                   MOVE    ZERO                TO  FLG-ARI
                   MOVE    ZERO                TO  FLG-ARI3
               WHEN   WRK-SRYCD            =   TBL-SRYCD (TBL-IDX)
                   MOVE    1                   TO  FLG-ARI
                   MOVE    1                   TO  FLG-ARI3
           END-SEARCH
      *
           IF      FLG-ARI         =   ZERO
      *    ³°Íè´ÉÍý²Ã»»
               SET     TBLG-IDX             TO  1
               SEARCH  TBL-GAIRAI-OCC       VARYING   TBLG-IDX
                   AT  END
                       MOVE    ZERO         TO  FLG-ARI
                   WHEN   WRK-SRYCD         =   TBLG-SRYCD (TBLG-IDX)
                       MOVE    1            TO  FLG-ARI
               END-SEARCH
           END-IF
      *
           IF      FLG-ARI         =   ZERO
      *        Ï«ºÒ¥³¡¼¥É¥Á¥§¥Ã¥¯
               SET     TBL-RSI              TO  1
               SEARCH  TBL-RSI-SINSATU-OCC  VARYING   TBL-RSI
                   AT  END
                       MOVE    ZERO                TO  FLG-ARI
                   WHEN    WRK-SRYCD       =   TBLR-SRYCD (TBL-RSI)
                       MOVE    1                   TO  FLG-ARI
                       IF      TBLR-KBN (TBL-RSI)  =   "F"   OR "S"
                           MOVE    1                   TO  FLG-ARI3
                       END-IF
               END-SEARCH
           END-IF
      *    ¿Ç»¡ÎÁ¤ÇÆ±¤¸¥³¡¼¥É¤¬¤¢¤ë»þ
           IF      FLG-ARI3            =   1
               PERFORM VARYING     IDXS    FROM    1   BY  1
                       UNTIL      (IDXS    >   SPA-GMN-IDX )  OR
                                  (FLG-ARI2    =   1           )
                   IF     (WRK-SRYCD(1:1)          =   "1"  )  AND
                          (WRK-SRYCD               =   SPA-COM-INPUTCD
                                                            (IDXS))
                       MOVE    1               TO  FLG-ARI2
                   END-IF
               END-PERFORM
           END-IF
      *
      *    ¤½¤ÎÂ¾¤Î¼«Æ°È¯À¸Ê¬
           IF     WRK-SRYCD            =   "830000020"   OR
                                           "830000021"
               MOVE    1               TO  FLG-ARI
           END-IF
      *    ·ÑÂ³´ÉÍý²Ã»»¼«Æ°È¯À¸Ê¬
           IF     WRK-SRYCD            =   "112007170"   OR
                                           "112702270"
               MOVE    1               TO  FLG-ARI
           END-IF
      *
      *    ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê
           IF     WRK-SRYCD            =   "114701210"   OR
                                           "114701710"
               PERFORM VARYING     IDXS    FROM    1   BY  1
                       UNTIL      (IDXS    >   SPA-GMN-IDX )  OR
                                  (FLG-ARI =   1           )
                   IF      SPA-COM-INPUTCD (IDXS)  =   "114701210" 
                                                   OR  "114701710"
                       MOVE    1               TO  FLG-ARI
                   END-IF
               END-PERFORM
           END-IF
      *    ÆÃÄêËýÀ­¼À´µ»ØÆ³ÎÁ
           IF     WRK-SRYCD            =   "113700710"   OR
                                           "113700810"   OR
                                           "113700610"   OR
                                           "113001910"   OR
                                           "113002010"   OR
                                           "113001810"
      *            ÈéÉæ²ÊÀ­¼À´µ»ØÆ³ÎÁ
                                       OR  "113000910"
                                       OR  "113002310"
               PERFORM VARYING     IDXS    FROM    1   BY  1
                       UNTIL      (IDXS    >   SPA-GMN-IDX )  OR
                                  (FLG-ARI =   1           )
                   IF      SPA-COM-INPUTCD (IDXS)  =   "113700710"
                                                   OR  "113700810"
                                                   OR  "113700610"
                                                   OR  "113001910"
                                                   OR  "113002010"
                                                   OR  "113001810"
      *            ÈéÉæ²ÊÀ­¼À´µ»ØÆ³ÎÁ
                                                   OR  "113000910"
                                                   OR  "113002310"
                       MOVE    1               TO  FLG-ARI
                   END-IF
               END-PERFORM
           END-IF
      *
      *    ¤½¤ÎÂ¾Æ±¤¸¥³¡¼¥É¤¬¤¢¤ë»þ
           PERFORM VARYING     IDXS    FROM    1   BY  1
                   UNTIL      (IDXS    >   IDX-INT-MAX )  OR
                              (FLG-ARI =   1           )
               IF     (WRK-SRYCD(1:1)          =   "1"   ) AND
                      (WRK-SRYCD               =   SPA-COM-INPUTCD
                                                            (IDXS))
                   MOVE    1                   TO  FLG-ARI
               END-IF
           END-PERFORM
      *
           .
       10101-SINSATU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý¡ÊÂ¾ÊÝ¸±¼õ¿Ç¤¢¤ê¡Ë
      *****************************************************************
       1012-TAHOKEN-HEN-SEC              SECTION.
      *
      *    »»Äê²ó¿ô·×»»ÊÔ½¸
           PERFORM 100-SANTEI-CHK-SEC
      *
           MOVE    SPA-SCR-REC         TO  HZN-SCR-REC
           MOVE    SPACE               TO  SPA-SCR-REC
           INITIALIZE                  SPA-SCR-REC
           MOVE    ZERO                TO  SPA-GMN-MAX
           MOVE    ZERO                TO  IDX2
           MOVE    ZERO                TO  SPA-GMN-IDX
           COMPUTE SPA-GMN-IDX         =   SPA-GMN-IDX   +   1
           MOVE    "099999902"         TO  WRK-SRYCD
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           MOVE    "1"                 TO  LNK-SC92-KBN
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE           TO  SPA-ERRCD
               INITIALIZE              SPA-GMN-TBLREC (SPA-GMN-IDX)
               INITIALIZE              SPA-COM-TBLREC (SPA-GMN-IDX)
               COMPUTE SPA-GMN-IDX     =   SPA-GMN-IDX
                                       -   1
               GO      TO      1012-TAHOKEN-HEN-EXT
           END-IF
           MOVE    SPA-GMN-IDX         TO  IDX2
      *    ¿ÇÎÅ¹Ô°ÙÆâÍÆ¤ÎÊÔ½¸
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE  )  OR
                              (HZN-COM-INPUTCD (IDX)   =   SPACE   AND
                               HZN-GMN-INPUTCD (IDX)   =   SPACE )
               IF     (HZN-COM-SRYKBN(IDX)     =   "11"  OR  "12"
                                               OR  "13"  OR  "14" ) AND
                      (HZN-COM-INPUTCD(IDX)(1:1)   =   "1"   )
                   MOVE    HZN-COM-INPUTCD(IDX) TO  WRK-SRYCD
                   PERFORM 10101-SINSATU-CHK-SEC
                   IF      FLG-ARI             =   1
                       MOVE    1               TO  FLG-CHK
                   END-IF
               END-IF
               IF      HZN-COM-INPUTCD(IDX)    =   "099999902"
                   MOVE    1               TO  FLG-CHK
               END-IF
      *
               IF      FLG-CHK         =   ZERO
                   ADD     1                   TO  IDX2
                   ADD     1                   TO  SPA-GMN-IDX
                   MOVE    HZN-GMN-TBL(IDX)    TO  SPA-GMN-TBL (IDX2)
               END-IF
               IF      HZN-COM-ZAIEND (IDX)    =   "1"
                   MOVE     ZERO               TO  FLG-CHK
               END-IF
           END-PERFORM
           .
       1012-TAHOKEN-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¿Ç»¡ÎÁ»»Äê¸å¡¢¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý
      *****************************************************************
       1014-SINSATU-HENKAN-SEC              SECTION.
      *
      *    Ê£¿ô²Ê¤¬¤¢¤ë»þ¡¢ºÆÊÔ½¸
           MOVE    ZERO                TO  FLG-FUKU-ARI
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE    )  OR
                             ((SPA-COM-INPUTCD(IDX) =   SPACE ) AND
                              (SPA-GMN-INPUTCD(IDX) =   SPACE ))
               IF      SPA-GMN-INPUTCD(IDX)(1:1)   =   "$"
                   MOVE    SPACE           TO  SPA-MAE-INPUTCD(IDX)
                   MOVE    1               TO  FLG-FUKU-ARI
               END-IF
           END-PERFORM
      *
           PERFORM 1010-SINSATU-HEN-SEC
      *
           IF      FLG-FUKU-ARI        =   1
      *        Ê£¿ôÎÁ¡Ê¡ð¡Ë¡¢ÊÝ¸±ÁÈ¹ç¤»¡Ê¡ô¡ËÂÐ±þ
               PERFORM 1015-FUKU-SYORI-SEC
           END-IF
           .
       1014-SINSATU-HENKAN-EXT.
           EXIT.
      *****************************************************************
      *    Ê£¿ôÎÁ¡Ê¡ð¡Ë¡¢ÊÝ¸±ÁÈ¹ç¤»¡Ê¡ô¡ËÂÐ±þ½èÍý
      *****************************************************************
       1015-FUKU-SYORI-SEC              SECTION.
      *
           IF      LNK-SC10S-STRIDX    =   ZERO
               MOVE    1               TO  LNK-SC10S-STRIDX
           END-IF
      *
           PERFORM VARYING     IDX-A   FROM    LNK-SC10S-STRIDX   BY  1
                   UNTIL      (IDX-A   >   SPA-MAX-LINE  )  OR
                             ((SPA-COM-INPUTCD (IDX-A) =   SPACE ) AND
                              (SPA-GMN-INPUTCD (IDX-A) =   SPACE )) OR
                              (SPA-ERRCD           NOT =   SPACE )
      *
             IF      SPA-GMN-INPUTCD(IDX-A)  NOT =
                                             SPA-MAE-INPUTCD(IDX-A)
      *        ¿ÇÎÅ²Ê
               IF     (SPA-GMN-INPUTCD(IDX-A)(1:1) =   "$" ) AND
                      (SPA-GMN-INPUTCD(IDX-A)(2:2) NUMERIC ) AND
                      (SPA-GMN-INPUTCD(IDX-A)(4:1) =   SPACE)
                   PERFORM 10151-SRYKA-SYORI-SEC
               END-IF
      *        ÊÝ¸±ÁÈ¹ç¤»
               IF     (SPA-GMN-INPUTCD(IDX-A)(1:1) =   "#" ) AND
                      (SPA-GMN-INPUTCD(IDX-A)(2:4) NUMERIC )
                   PERFORM 10152-HKNCOMBI-SYORI-SEC
               END-IF
             END-IF
           END-PERFORM
      *
           .
       1015-FUKU-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    Ê£¿ô²ÊÌÀºÙÄÉ²Ã½èÍý
      *****************************************************************
       10151-SRYKA-SYORI-SEC              SECTION.
      *
      *    ¿ÇÎÅ²Ê
           MOVE    SPA-GMN-INPUTCD(IDX-A)(2:2)
                                       TO  WRK-SRYKA
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX2    FROM    1   BY  1
                   UNTIL      (IDX2    >   SPA-SRYKA-MAX )  OR
                              (FLG-CHK     =    1   ) 
               IF      WRK-SRYKA           =   SPA-GMN-SRYKAL (IDX2)
                   MOVE    IDX2              TO  IDY
                   MOVE    1                 TO  FLG-CHK
               END-IF
           END-PERFORM
           IF       FLG-CHK            =   ZERO
               MOVE    "1053"          TO  SPA-ERRCD
               MOVE    SPACE           TO  SPA-MAE-INPUTCD(IDX-A)
               MOVE    "1"             TO  SPA-COM-CUR    (IDX-A)
           END-IF
      *
           IF      SPA-ERRCD           =   SPACE
               MOVE    SPA-GMN-INPUTCD(IDX-A)(5:4)
                                           TO  WRK-DRCD2
               INITIALIZE                  SPA-GMN-TBLREC (IDX-A)
               INITIALIZE                  SPA-COM-TBLREC (IDX-A)
               STRING  "$"                 DELIMITED   BY  SIZE
                       WRK-SRYKA           DELIMITED   BY  SIZE
                       " "                 DELIMITED   BY  SIZE
                       WRK-DRCD2           DELIMITED   BY  SPACE
                               INTO    SPA-GMN-INPUTCD (IDX-A)
               END-STRING
      *        ¥É¥¯¥¿¡¼¤ÎÊÔ½¸
               PERFORM 101513-DRCD-SYORI-SEC
           END-IF
      *
           IF      SPA-ERRCD           =   SPACE
               MOVE    SPA-GMN-INPUTCD(IDX-A)
                                           TO  SPA-MAE-INPUTCD(IDX-A)
               MOVE    WRK-SRYKA           TO  SPA-COM-SRYKA   (IDX-A)
               MOVE    WRK-DRCD            TO  SPA-COM-DRCD    (IDX-A)
           END-IF
      *
           IF     (FLG-OK              =   ZERO )  AND
                  (SPA-ERRCD           =   SPACE)  AND
                  (LNK-SC10S-SYORI     =   "A"
                                       OR  "D"   )
               PERFORM 101511-SRYKA-INS-SEC
           END-IF
      *
           .
       10151-SRYKA-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    Â¾²Ê¤Ë¤Æ»»ÄêºÑ¤ß½èÍý
      *****************************************************************
       101511-SRYKA-INS-SEC         SECTION.
      *
      *    Â¾²Ê¤Ë¤Æ»»ÄêºÑ¤ß
           MOVE    ZERO                TO  FLG-CHK
           MOVE    ZERO                TO  FLG-SRYKBN
           MOVE    SPACE               TO  WRK-HEN-SRYKA
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >=  IDX-A    )  OR
                              (FLG-CHK     =   1   )
               IF     (IDX-A                   NOT =   IDX )  AND
                      (SPA-COM-SRYKA    (IDX)  NOT =   SPACE )  AND
                      (SPA-COM-SRYKA    (IDX)  =   WRK-SRYKA )
                   MOVE    1               TO  FLG-CHK
               END-IF
               IF      SPA-SRYKA           =   WRK-SRYKA
                   MOVE    1               TO  FLG-CHK
               END-IF
               IF     (SPA-COM-SRYKBN  (IDX)   =   "11" ) AND
                     ((SPA-COM-INPUTCD (IDX)(1:1)  =   "1" )  OR
                      (SPA-COM-INPUTCD (IDX)(1:3)  =   "099"))
                   MOVE    1               TO  FLG-SRYKBN
               END-IF
               IF     (SPA-COM-SRYKBN  (IDX)   =   "12" ) AND
                     ((SPA-COM-INPUTCD (IDX)(1:1)  =   "1" )  OR
                      (SPA-COM-INPUTCD (IDX)(1:3)  =   "099"))
                   MOVE    2               TO  FLG-SRYKBN
               END-IF
      *
               IF     (SPA-COM-SRYKA   (IDX)   =   SPA-SRYKA ) AND
                      (SPA-COM-SRYKBN  (IDX)   =   "11"      ) AND
                      (SPA-COM-INPUTCD (IDX)   =   "830000020")
                   MOVE    1                   TO  FLG-SRYKBN
                   MOVE    SPA-COM-ATAI1(IDX)  TO  WRK-HEN-SRYKA
               END-IF
               IF     (SPA-COM-SRYKA   (IDX)   =   SPA-SRYKA ) AND
                      (SPA-COM-SRYKBN  (IDX)   =   "12"      ) AND
                      (SPA-COM-INPUTCD (IDX)   =   "830000021")
                   MOVE    2                   TO  FLG-SRYKBN
                   MOVE    SPA-COM-ATAI1(IDX)  TO  WRK-HEN-SRYKA
               END-IF
           END-PERFORM
      *
           IF      FLG-CHK             =   ZERO
               PERFORM 101513-HKNCOMBI-GYOU-SEC
           END-IF
           IF     (FLG-CHK             =   ZERO )  AND
                  (FLG-SRYKBN      NOT =   ZERO )  AND
                  (IDX-A               <   199  )
               IF      FLG-HKN-ARI         =   1
                   MOVE    IDX-A           TO  IDX-A-HZN
                   ADD     1               TO  IDX-A
               END-IF
               PERFORM 1015112-TAKA-HEN-SEC
           END-IF
      *    ÊÝ¸±ÁÈ¹ç¤»
           IF      FLG-HKN-ARI         =   1
               MOVE    IDX-A-HZN           TO  IDX-A
               ADD     1                   TO  IDX-A
               IF      SPA-GMN-INPUTCD(IDX-A)(1:1)     =   "#"
                   PERFORM 10152-HKNCOMBI-SYORI-SEC
               END-IF
           END-IF
      *
           .
       101511-SRYKA-INS-EXT.
           EXIT.
      *****************************************************************
      *    ¥É¥¯¥¿¡¼Ì¾¼èÆÀ½èÍý
      *****************************************************************
       101513-DRCD-SYORI-SEC         SECTION.
      *    ¥É¥¯¥¿¡¼¤ÎÍ­Ìµ
           IF      WRK-DRCD2           =   SPACE
                                       OR  ZERO
               MOVE    SPACE               TO  WRK-DRCD-MEI
           ELSE
               MOVE    "1"                 TO  WRK-DRCD1
               MOVE    SPACE               TO  WRK-DRCD-MEI
               PERFORM 1015131-DRCDMEI-HEN-SEC
               IF      WRK-DRCD-MEI       =   SPACE
                   IF      SPA-ERRCD      =   SPACE
                       MOVE    "1054"          TO  SPA-ERRCD
                   END-IF
                   MOVE    SPACE           TO  SPA-MAE-INPUTCD(IDX-A)
                   MOVE    "1"             TO  SPA-COM-CUR    (IDX-A)
               END-IF
           END-IF
           IF      SPA-ERRCD           =   SPACE
             IF      WRK-DRCD-MEI        =   SPACE
               STRING  "¡ã¡ã"              DELIMITED  BY  SIZE
                       SPA-GMN-SRYKAMEIL(IDY)
                                           DELIMITED  BY  SPACE
                        "¡ä¡ä"             DELIMITED  BY  SIZE
                   INTO                SPA-GMN-MEISYO-G (IDX-A)
               END-STRING
             ELSE
               STRING  "¡ã¡ã"              DELIMITED  BY  SIZE
                       SPA-GMN-SRYKAMEIL(IDY)
                                           DELIMITED  BY  SPACE
                       "¡¡¥É¥¯¥¿¡¼¡§"      DELIMITED  BY  SIZE
                       WRK-DRCD-MEI        DELIMITED  BY  SPACE
                        "¡ä¡ä"             DELIMITED  BY  SIZE
                   INTO                SPA-GMN-MEISYO-G (IDX-A)
               END-STRING
             END-IF
           END-IF
      *
           .
       101513-DRCD-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    ¥É¥¯¥¿¡¼Ì¾¼èÆÀ½èÍý
      *****************************************************************
       1015131-DRCDMEI-HEN-SEC         SECTION.
      *
           INITIALIZE                  SYS-1010-REC
           MOVE    "1010"              TO  SYS-1010-KANRICD
           MOVE    WRK-DRCD            TO  SYS-1010-KBNCD
           MOVE    SPA-SRYYMD          TO  SYS-1010-STYUKYMD
           MOVE    SPA-SRYYMD          TO  SYS-1010-EDYUKYMD
      *    ¥·¥¹¥Æ¥à´ÉÍý¸¡º÷
           MOVE    SPA-HOSPNUM         TO  SYS-1010-HOSPNUM
           MOVE    SYS-1010-REC        TO  MCPDATA-REC
           PERFORM 960-SYSKANRI-READ-SEC
      *
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1010-REC
               IF      SYS-1010-KBNCD      =   WRK-DRCD
                   MOVE    SYS-1010-NAME       TO  WRK-DRCD-MEI
               END-IF
           END-IF
      *
           .
       1015131-DRCDMEI-HEN-EXT.
           EXIT.
      *****************************************************************
      *    Â¾²Ê¤Ë¤Æ¼õ¿ÇºÑ¤ß¼«Æ°ÊÔ½¸½èÍý
      *****************************************************************
       1015112-TAKA-HEN-SEC         SECTION.
      *
           IF      FLG-SRYKBN          =   1
               MOVE    ".110"              TO  WRK-SRYCD
           ELSE
               MOVE    ".120"              TO  WRK-SRYCD
           END-IF
           IF      IDX-KA              =   ZERO
               ADD     1               TO  IDX-A
               PERFORM 1015119-GYOINSN-SEC
           ELSE
               COMPUTE IDX-A           =   IDX-KA   -  1
           END-IF
           IF      SPA-ERRCD           =   SPACE
               INITIALIZE                  SPA-GMN-TBLREC  (IDX-A)
               INITIALIZE                  SPA-COM-TBLREC  (IDX-A)
               MOVE    WRK-SRYCD       TO  SPA-GMN-INPUTCD (IDX-A)
               MOVE    WRK-SRYCD       TO  SPA-MAE-INPUTCD (IDX-A)
               MOVE    WRK-SRYKA       TO  SPA-COM-SRYKA   (IDX-A)
               MOVE    1               TO  FLG-FUKU
           END-IF
      *
           IF      FLG-SRYKBN          =   1
               MOVE    "830000020"         TO  WRK-SRYCD
           ELSE
               MOVE    "830000021"         TO  WRK-SRYCD
           END-IF
           IF      IDX-A               <   SPA-MAX-LINE
               IF      SPA-COM-INPUTCD(IDX-A + 1)
                                           =   "830000020"  OR
                                               "830000021"
                   ADD     1               TO  IDX-A
               ELSE
                   ADD     1               TO  IDX-A
                   PERFORM 1015119-GYOINSN-SEC
               END-IF
           ELSE
               MOVE    "0007"              TO  SPA-ERRCD
           END-IF
           IF      WRK-HEN-SRYKA       =   SPACE
               MOVE    SPA-SRYKA       TO  WRK-HEN-SRYKA
           END-IF
           IF      SPA-ERRCD       =   SPACE
               INITIALIZE                  SPA-GMN-TBLREC  (IDX-A)
               INITIALIZE                  SPA-COM-TBLREC  (IDX-A)
               MOVE    WRK-SRYCD       TO  SPA-GMN-INPUTCD (IDX-A)
               MOVE    WRK-HEN-SRYKA   TO  SPA-GMN-INPUTCD (IDX-A)
                                                           (11:2)
               MOVE    WRK-SRYCD       TO  SPA-COM-INPUTCD (IDX-A)
               MOVE    WRK-HEN-SRYKA   TO  SPA-COM-ATAI1   (IDX-A)
               PERFORM 10151121-INPUCD-HENSYU-SEC
               MOVE    WRK-SRYKA       TO  SPA-COM-SRYKA   (IDX-A)
           END-IF
           IF      SPA-ERRCD       =   SPACE
      *        ÆÃÄê¼À´µÎÅÍÜ»ØÆ³ÎÁ¤ÎÈ¯À¸
               PERFORM 10151122-TOKUTEI-HENSYU-SEC
           END-IF
           .
       1015112-TAKA-HEN-EXT.
           EXIT.
      *****************************************************************
      *    Ê£¿ôÊÝ¸±¥³¥á¥ó¥ÈÊÔ½¸½èÍý
      *****************************************************************
       10151121-INPUCD-HENSYU-SEC       SECTION.
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           MOVE    "2"                 TO  LNK-SC92-KBN
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    IDX-A               TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
           .
       10151121-INPUCD-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆÃÄê¼À´µÎÅÍÜ»ØÆ³ÎÁ¤ÎÈ¯À¸½èÍý
      *****************************************************************
       10151122-TOKUTEI-HENSYU-SEC       SECTION.
      *
      *    ÆÃÄê¼À´µ²Ê
           MOVE    ZERO                TO  FLG-TOKUTEI
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   10  )  OR
                              (SPA-TOKU-SRYKA(IDX) =   SPACE ) OR
                              (FLG-TOKUTEI     NOT =   ZERO )
               IF      SPA-TOKU-SRYKA (IDX)    =   WRK-SRYKA
                   MOVE    SPA-TOKU-FLG (IDX)  TO  FLG-TOKUTEI
               END-IF
           END-PERFORM
      *    ÆÃÄêËýÀ­¼À´µ»ØÆ³ÎÁ
           IF      FLG-TOKUTEI         =   05
               IF      IDX-HKN         >   IDX-A
                   MOVE    IDX-HKN         TO  SPA-GMN-IDX
               ELSE
                   MOVE    IDX-A           TO  SPA-GMN-IDX
               END-IF
               PERFORM 330121-TOKUTEI-SIDOU-SEC
           END-IF
      *
      *    ÈéÉæ²ÊÆÃÄê¼À´µ
           IF      FLG-TOKUTEI         =   03  OR  04
               IF      IDX-HKN         >   IDX-A
                   MOVE    IDX-HKN         TO  SPA-GMN-IDX
               ELSE
                   MOVE    IDX-A           TO  SPA-GMN-IDX
               END-IF
               PERFORM 330122-HIFUKA-SIDOU-SEC
           END-IF
      *
           .
       10151122-TOKUTEI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ê£¿ôÊÝ¸±¥³¥á¥ó¥ÈÊÔ½¸½èÍý
      *****************************************************************
       101513-HKNCOMBI-GYOU-SEC       SECTION.
      *
           MOVE    ZERO                TO  IDX-HKN
           MOVE    ZERO                TO  IDX-KA
           MOVE    ZERO                TO  FLG-CHK3
           MOVE    ZERO                TO  FLG-HKN-ARI
           MOVE    ZERO                TO  FLG-KA-ARI
           COMPUTE IDX4                =   IDX-A   +  1
           PERFORM VARYING     IDX     FROM    IDX4    BY  1
                   UNTIL     ( IDX         >   SPA-MAX-LINE     )  OR
                             ((SPA-GMN-INPUTCD(IDX)    =   SPACE ) AND
                              (SPA-COM-INPUTCD(IDX)    =   SPACE )) OR
                             ( FLG-CHK3    =   1       )
               IF      SPA-COM-INPUTCD (IDX)  =   "099409901"
                                              OR  "099999902"
                   MOVE    IDX                TO  IDX-HKN
               END-IF
               IF      SPA-COM-INPUTCD (IDX)  =   "830000020"
                                              OR  "830000021"
                   MOVE    IDX                TO  IDX-KA
               END-IF
               IF     (SPA-COM-INPUTCD (IDX)  =   "099409901"
                                              OR  "099999902"
                                              OR  "830000020"
                                              OR  "830000021") OR
                      (SPA-GMN-INPUTCD (IDX)(1:1)  =   "." 
                                              OR  "#" 
                                              OR  "$"   )
                   CONTINUE
               ELSE
                   MOVE    1               TO  FLG-CHK3
               END-IF
               IF      SPA-GMN-INPUTCD (IDX)(1:1)  =   "#"
                   MOVE    1               TO  FLG-HKN-ARI
               END-IF
               IF      SPA-GMN-INPUTCD (IDX)(1:1)  =   "$"
                   MOVE    1               TO  FLG-KA-ARI
               END-IF
           END-PERFORM
           .
       101513-HKNCOMBI-GYOU-EXT.
           EXIT.
      *****************************************************************
      *    Ê£¿ôÊÝ¸±ÌÀºÙÄÉ²Ã½èÍý
      *****************************************************************
       10152-HKNCOMBI-SYORI-SEC              SECTION.
      *
           MOVE    SPA-GMN-INPUTCD(IDX-A)(2:4)
                                       TO  WRK-HKNCOMBI
      *
           MOVE    ZERO                TO  FLG-CHK
           MOVE    SPACE               TO  WRK-SEL-HKNNUM
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-HKN-MAX )  OR
                              (FLG-CHK     =    1   ) 
               IF      WRK-HKNCOMBI        =   SPA-GMN-THKNCOMBINUM
                                                             (IDX)
                   MOVE    SPA-NAI-HKNNUM (IDX)  TO  WRK-SEL-HKNNUM
                   MOVE    IDX               TO  IDY
                   MOVE    1                 TO  FLG-CHK
               END-IF
           END-PERFORM
      *
           IF       FLG-CHK            =   ZERO
               MOVE    "1051"          TO  SPA-ERRCD
               MOVE    SPACE           TO  SPA-MAE-INPUTCD(IDX-A)
               MOVE    "1"             TO  SPA-COM-CUR (IDX-A)
           ELSE
      *        ÊÝ¸±Ì¾¾Î¤òÌ¾¾Î¤Ø
               STRING  "¡Ô"                DELIMITED  BY  SIZE
                   SPA-GMN-THKNCOMBIMEI(IDY)
                                       DELIMITED  BY  "  "
                   "¡Õ"                DELIMITED  BY  SIZE
                   INTO                SPA-GMN-MEISYO-G (IDX-A)
               END-STRING
               MOVE    SPA-GMN-INPUTCD(IDX-A)
                                       TO  SPA-MAE-INPUTCD(IDX-A)
           END-IF
      *    Ï«ºÒ¤Ï¥¨¥é¡¼
           IF     (SPA-ERRCD           =   SPACE  )  AND
                  (SPA-NAI-RSI-HKNKBN (IDY)   NOT =  SPACE)
               MOVE    "1050"          TO  SPA-ERRCD
               MOVE    SPACE           TO  SPA-MAE-INPUTCD(IDX-A)
               MOVE    "1"             TO  SPA-COM-CUR    (IDX-A)
           END-IF
      *
      *    Ï·¿Í¡¦°ìÈÌÈ½Äê
      *    £¶£µºÐ°Ê¾å¤ÇÏ·¿Í¸øÈñ¤Î¤¢¤ë¾ì¹ç¡¢
           IF     (SPA-ERRCD           =   SPACE  )  AND
                   SPA-NAI-ROUJIN2     =   1
               INITIALIZE                  ORCSAGECHKAREA
               MOVE    SPA-HOSPNUM         TO  AGECHK-HOSPNUM
               MOVE    SPA-PTID            TO  AGECHK-PTID
               MOVE    SPA-SRYYMD          TO  AGECHK-SRYYMD
               MOVE    SPA-BIRTHDAY        TO  AGECHK-BIRTHDAY
               MOVE    SPA-NYUGAIKBN       TO  AGECHK-NYUGAIKBN
               MOVE    WRK-HKNCOMBI        TO  AGECHK-HKNCOMBINUM
               CALL    "ORCSAGECHK"        USING
                                           ORCSAGECHKAREA
                                           SPA-AREA
               IF      SPA-NAI-ROUJIN  NOT =   AGECHK-ROUJIN
                   MOVE    "1052"          TO  SPA-ERRCD
                   MOVE    SPACE           TO  SPA-MAE-INPUTCD
                                                          (IDX-A)
                   MOVE    "1"             TO  SPA-COM-CUR(IDX-A)
               END-IF
           END-IF
           IF      SPA-ERRCD           =   SPACE
               MOVE    WRK-HKNCOMBI        TO  SPA-COM-HKNCOMBI(IDX-A)
           END-IF
      *
           IF     (FLG-OK              =   ZERO )  AND
                  (SPA-ERRCD           =   SPACE)  AND
                  (LNK-SC10S-SYORI     =   "A"
                                       OR  "D"   )
               PERFORM 101521-HKNCOMBI-HEN-SEC
           END-IF
      *
           .
       10152-HKNCOMBI-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    Ê£¿ôÊÝ¸±¥³¥á¥ó¥ÈÄÉ²ÃÊÔ½¸½èÍý
      *****************************************************************
       101521-HKNCOMBI-HEN-SEC       SECTION.
      *
      *    Â¾ÊÝ¸±¤Ë¤Æ»»ÄêºÑ¤ß
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >=  IDX-A   )  OR
                              (FLG-CHK     =    1  ) 
               IF     (IDX-A                   NOT =   IDX )  AND
                      (SPA-COM-HKNCOMBI (IDX)  NOT =   SPACE )  AND
                      (SPA-COM-HKNCOMBI (IDX)  =   WRK-HKNCOMBI )
                   MOVE    1               TO  FLG-CHK
               END-IF
               IF      SPA-HKNCOMBINUM     =   WRK-HKNCOMBI
                   MOVE    1               TO  FLG-CHK
               END-IF
           END-PERFORM
           MOVE    ZERO                TO  IDX-HKN
           IF      FLG-CHK             =   ZERO
               PERFORM 101513-HKNCOMBI-GYOU-SEC
           END-IF
           IF     (FLG-CHK             =   ZERO )  AND
                  (IDX-HKN             =   ZERO )
               IF      IDX-KA          NOT =   ZERO
                   MOVE    IDX-KA          TO  IDX-A
               END-IF
               IF      WRK-SEL-HKNNUM      =   SPA-HKNNUM
                   MOVE    "099409901"     TO  WRK-SRYCD
               ELSE
                   MOVE    "099999902"     TO  WRK-SRYCD
               END-IF
               IF      IDX-A           <   SPA-MAX-LINE
                   ADD     1               TO  IDX-A
                   PERFORM 1015119-GYOINSN-SEC
                   IF      SPA-ERRCD       =   SPACE
                       INITIALIZE                  SPA-GMN-TBLREC
                                                        (IDX-A)
                       INITIALIZE                  SPA-COM-TBLREC
                                                        (IDX-A)
                       MOVE    WRK-SRYCD       TO  SPA-GMN-INPUTCD
                                                       (IDX-A)
                       MOVE    WRK-SRYCD       TO  SPA-COM-INPUTCD
                                                       (IDX-A)
                       PERFORM 10151121-INPUCD-HENSYU-SEC
                       MOVE    WRK-HKNCOMBI    TO  SPA-COM-HKNCOMBI
                                                       (IDX-A)
                   END-IF
               END-IF
           END-IF
      *
           .
       101521-HKNCOMBI-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¹ÔÁÞÆþ½èÍý
      *****************************************************************
       1015119-GYOINSN-SEC              SECTION.
      *
           IF      IDX-A               >=  SPA-MAX-LINE
               MOVE    "0007"              TO  SPA-ERRCD
               GO      TO      1015119-GYOINSN-EXT
           END-IF
      *
           MOVE    SPA-SCR-REC         TO  HZN-SCR-REC
           INITIALIZE                      SPA-GMN-REC
           MOVE    ZERO                TO  IDX2
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-MAX-LINE
               IF      IDX             =   IDX-A
                   CONTINUE
               ELSE
                   ADD     1               TO  IDX2
                   MOVE    HZN-COM-TBLREC (IDX2) 
                                           TO  SPA-COM-TBLREC(IDX)
                   MOVE    HZN-GMN-TBLREC (IDX2) 
                                           TO  SPA-GMN-TBLREC(IDX)
               END-IF
               IF     (SPA-GMN-INPUTCD (IDX)   NOT =   SPACE ) OR
                      (SPA-COM-INPUTCD (IDX)   NOT =   SPACE )
                   MOVE    IDX                 TO  SPA-GMN-MAX
               END-IF
           END-PERFORM
      *
           .
       1015119-GYOINSN-EXT.
           EXIT.
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       910-TENSU-READ-SEC              SECTION.
      *
      *    »»ÄêÍúÎò¤Ë´Ø¤¹¤ë¹àÌÜ¤Î¤ß
           MOVE    SPA-SRYYMD          TO  TNS-YUKOSTYMD
           MOVE    SPA-SRYYMD          TO  TNS-YUKOEDYMD
      *
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key22"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key22"             TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  TNS-TENSU-REC
                   MOVE    ZERO                TO  FLG-TENSU
               ELSE
                   INITIALIZE                  TNS-TENSU-REC
                   MOVE    1                   TO  FLG-TENSU
               END-IF
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1                   TO  FLG-TENSU
           END-IF
      *
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key22"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       910-TENSU-READ-EXT.
           EXIT.
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       9101-TENSU-READ2-SEC              SECTION.
      *
           MOVE    SPA-SRYYMD          TO  TNS-YUKOSTYMD
           MOVE    SPA-SRYYMD          TO  TNS-YUKOEDYMD
      *
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  TNS-TENSU-REC
                   MOVE    ZERO                TO  FLG-TENSU
               ELSE
                   INITIALIZE                  TNS-TENSU-REC
                   MOVE    1                   TO  FLG-TENSU
               END-IF
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1                   TO  FLG-TENSU
           END-IF
      *
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       9101-TENSU-READ2-EXT.
           EXIT.
      *
      *****************************************************************
      *    »»ÄêÎò¥Þ¥¹¥¿ÆÉ¤ß¹þ¤ß
      *****************************************************************
       920-SANTEI-READ-SEC         SECTION.
      *
           MOVE    "tbl_santei"        TO  MCP-TABLE
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  SANTEI-REC
               MOVE    ZERO                TO  FLG-SANTEI
           ELSE
               INITIALIZE                      SANTEI-REC
               MOVE    1                   TO  FLG-SANTEI
           END-IF
      *
           .
       920-SANTEI-READ-EXT.
           EXIT.
      ******************************************************************
      *    ¼õ¿ÇÍúÎò¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       970-JYURRK-READ-SEC         SECTION.
      *
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  JYURRK-REC
               MOVE    ZERO            TO  FLG-JYURRK
           ELSE
               INITIALIZE                  JYURRK-REC
               MOVE    1               TO  FLG-JYURRK
           END-IF
      *
           .
       970-JYURRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       930-SRYACT-READ-SEC         SECTION.
      *
           MOVE    "tbl_sryact"        TO  MCP-TABLE
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACT-REC
               MOVE    ZERO            TO  FLG-SRYACT
           ELSE
               INITIALIZE                  SRYACT-REC
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           .
       930-SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍýÆÉ¹þ
      *****************************************************************
       960-SYSKANRI-READ-SEC         SECTION.
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key10"             TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO            TO  FLG-SYSKANRI
               ELSE
                   MOVE    1               TO  FLG-SYSKANRI
               END-IF
           ELSE
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       960-SYSKANRI-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Ñ¥é¥á¥¿¥Ç¡¼¥¿½çÆÉ¤ß
      *****************************************************************
      *980-PARA-READ-SEC         SECTION.
      *
      *    READ    PARA-FILE 
      *        AT  END
      *            MOVE    1           TO  FLG-PARA
      *        NOT AT  END
      *            MOVE    ZERO        TO  FLG-PARA
      *    END-READ
      *
      *    .
      *980-PARA-READ-EXT.
      *    EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¸¡º÷½èÍý
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"      TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£ÂÆÉ¤ß¹þ¤ß½èÍý
      *****************************************************************
       920-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
      *
       920-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¥¯¥í¡¼¥¹½èÍý
      *****************************************************************
       990-DBCLOSE-SEC           SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       990-DBCLOSE-EXT.
           EXIT.
      *
