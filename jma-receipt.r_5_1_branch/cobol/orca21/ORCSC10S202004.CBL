      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this licence along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION              DIVISION.
       PROGRAM-ID.                 ORCSC10S202004.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ¿ÇÎÅ¹Ô°ÙÆþÎÏ
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ¿ÇÎÅ¹Ô°Ù¿Ç»¡ÎÁ¼«Æ°È¯À¸ÊÔ½¸½èÍý
      *                      ¡Ê£Ë£°£²¤Î¤ß¶¦ÄÌ»ÈÍÑ¡Ë
      *                      £Ò£°£²Ç¯£´·î¡¡²þÀµÂÐ±þ
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  12/03/01    NACL¡ÝÂ¿¡¹Ç¼  ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      * 01.00.01     MCC-Â¿¡¹Ç¼   02/04/19  À¸³è½¬´·ÉÂ»ØÆ³»»Äê»þ¤ÎÄÉ²Ã
      * 01.00.02     MCC-Â¿¡¹Ç¼   02/04/22  ½é¿Ç¡¦ºÆ¿ÇÎÁ¤ÎÈ½Äê½¤Àµ
      * 01.00.03     MCC-Â¿¡¹Ç¼   02/04/**  Ï«ºÒÍÑÄÉ²Ã
      * 01.00.04     NACL-Â¿¡¹Ç¼  02/08/06  ¥¢¥Õ¥¿¡¼¥±¥¢¤Î»þ¼«Æ°»»ÄêÊÑ¹¹
      * 01.00.05     NACL-Â¿¡¹Ç¼  02/11/11  £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁÄÉ²Ã
      * 01.00.06     NACL-Â¿¡¹Ç¼  02/11/28  ÃæÅÓ½ªÎ»ºÆÉ½¼¨½¤Àµ
      * 01.00.07     NACL-Â¿¡¹Ç¼  02/12/02  À¸³è½¬´·ÉÂ¤Î¥³¡¼¥É¥¨¥é¡¼½¤Àµ
      * 01.00.08     NACL-Â¿¡¹Ç¼  02/12/06  ËýÀ­áÖÄË¤Î»»Äê¥Á¥§¥Ã¥¯½¤Àµ
      * 01.00.09     NACL-Â¿¡¹Ç¼  03/02/19  ÎÅÍÜÃ´Åö¼êÅöÄÉ²Ã
      * 01.00.10     NACL-Â¿¡¹Ç¼  03/03/28  ¼«ÇåÀÕ¤ÎÄþ¸º¤ò£¶¥ö·î°Ê¹ß¤È¤¹¤ë
      * 01.00.11     NACL-Â¿¡¹Ç¼  03/04/07  Æþ±¡Æü¤Î¥Á¥§¥Ã¥¯ÄÉ²Ã
      * 02.00.00     NACL-Â¿¡¹Ç¼  03/07/01  Ï«ºÒ¡¦¼«ÇåÀÕ°Ê³°¿Ç»¡²ó¿ô¤ò¤ä¤á¤ë
      * 02.00.01     NACL-Â¿¡¹Ç¼  03/08/29  £È£±£µ¡¥£¹¤«¤é
      *                                     Ï«ºÒ¡¦¼«ÇåÀÕÄþ¸ºÀ©¤ÎÇÑ»ß
      *                                     ¡Ê¥ì¥»ÅÅ¥³¡¼¥É¤ÎÊÑ¹¹¤Ê¤·¡Ë
      * 02.00.02     NACL-Â¿¡¹Ç¼  03/10/27  °é»ù±ÉÍÜ²Ã»»¼«Æ°»»ÄêÄÉ²Ã
      * 02.00.02     NACL-Â¿¡¹Ç¼  04/03/11  ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¥Á¥§¥Ã¥¯½¤Àµ
      * 02.00.03     NACL-Â¿¡¹Ç¼  05/09/28  ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¤È
      *                                     ºßÂðÎÅÍÜ»ØÆ³´ÉÍýÎÁ¤Î»»Äê½¤Àµ
      * 02.00.04     NACL-Â¿¡¹Ç¼  05/10/24  ¾Ã±êÄÃÄËÅù½èÃÖÈ½Äê½¤Àµ
      * 02.00.05     NACL-Â¿¡¹Ç¼  05/11/18  MONFUNC ÂÐ±þ Â¾
      * 02.00.06     NACL-Â¿¡¹Ç¼  05/11/21  ³«Êü·¿ÉÂ±¡¶¦Æ±»ØÆ³ÎÁ¥Á¥§¥Ã¥¯ÄÉ²Ã
      * 02.00.07     NACL-Â¿¡¹Ç¼  05/12/14  .213 ¼«Æ°ÊÑ´¹ÂÐ±þ
      * 03.03.00     NACL-Â¿¡¹Ç¼  06/10/20  ¶ºÀµ¸ÇÄêÅùÄÉ²Ã
      * 03.04.00     NACL-Â¿¡¹Ç¼  06/12/01  ¼«ÇåÀÕ·òÊÝ½àµòÄÉ²Ã
      * 03.04.01     NACL-Â¿¡¹Ç¼  07/04/XX  H19.4²þÀµ
      * 03.05.00     NACL-Â¿¡¹Ç¼  07/04/XX  ¥°¥ë¡¼¥×¿ÇÎÅÂÐ±þ
      * 03.05.01     NACL-Â¿¡¹Ç¼  07/07/XX  Æ±ÆüºÆ¿Ç¤ÈÄûÀµ¤ÎÁªÂòÂÐ±þÂ¾
      * 04.00.00     NACL-Â¿¡¹Ç¼  07/09/XX  ¥Æ¡¼¥Ö¥ë£´£°£°ÂÐ±þ
      * 04.01.00     NACL-Â¿¡¹Ç¼  07/12/XX  .213 ¼«Æ°ÊÑ´¹¥·¥¹¥Æ¥àÀßÄêÂÐ±þ
      *                                     ¥¢¥È¥Ô¡¼À­ÈéÉæ±ê¤ÎÇ¯ÎðÂÐ±þ
      * 04.02.00     NACL-Â¿¡¹Ç¼  08/03/XX  Ê¿À®£²£°Ç¯£´·î²þÀµÂÐ±þ
      * 04.03.00     NACL=Â¿¡¹Ç¼  08/08/07  Ï«ºÒ½é¿ÇÎÁ£È£²£°Ç¯£´·î²þÀµÂÐ±þÂ¾
      * 04.05.00     NACL=Â¿¡¹Ç¼  09/07/28  ¥ê¥Ï¥Ó¥êÈ¯¾ÉÆüÉ½¼¨ÂÐ±þ
      * 04.05.00     NACL-Â¿¡¹Ç¼  09/09/XX  ¾®»ù²Ê³°Íè¿Ç»¡ÎÁÅùÊñ³ç¿ÇÎÅÂÐ±þ
      * 04.05.00     NACL-Â¿¡¹Ç¼  09/10/20  ½é¿ÇºÆ¿Ç¼«Æ°È¯À¸¤Ê¤·ÂÐ±þ
      * 04.05.00     NACL-Â¿¡¹Ç¼  10/02/XX  ¥¢¥Õ¥¿¡¼¥±¥¢ÂÐ¾Ý³°ÂÐ±þ
      * 04.05.00     NACL-Â¿¡¹Ç¼  10/03/XX  Ê¿À®£²£²Ç¯£´·î²þÀµÂÐ±þ
      * 04.07.00     NACL-Â¿¡¹Ç¼  11/08/XX  ¥ê¥Ï¥Ó¥ê³«»ÏÆü¤Î½ªÎ»ÆüÂÐ±þ
      * 04.07.00     NACL-Â¿¡¹Ç¼  11/09/08  ¥¢¥È¥Ô¡¼À­ÈéÉæ±ê¤ÈÂ¾ÉÂÌ¾ÂÐ±þ
      * 04.07.00     NACL-Â¿¡¹Ç¼  11/11/08  Ìë´ÖÁáÄ«²Ã»»¤Î¾®»ù²ÊÆÃÎãÂÐ±þ
      * 04.07.00     NACL-Â¿¡¹Ç¼  12/03/XX  Ê¿À®£²£´Ç¯£´·î²þÀµÂÐ±þ
      * 04.07.00     NACL-Â¿¡¹Ç¼  12/05/01  ³°Íè¥ê¥Ï¥Ó¥ê¿Ç»¡ÎÁÅùÂÐ±þ
      * 04.07.00     NACL-Â¿¡¹Ç¼  12/08/08  ¿Ç»¡ÎÁ¤Ê¤·Æ±Æü½é¿ÇÎÁÈ¯À¸ÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  12/12/XX  ÅÅÏÃºÆ¿Ç¤Î²Ã»»»»ÄêÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  13/03/XX  Ê¿À®£²£µÇ¯£´·î²þÀµÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  13/02/XX  Ï«ºÒ¥³¡¼¥É¥ì¥»ÅÅÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  13/09/XX  Ï«ºÒÆ±ÆüºÆ¿Ç¥³¡¼¥ÉÄÉ²ÃÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  14/03/XX  Ê¿À®£²£¶Ç¯£´·î²þÀµÂÐ±þ
      * 04.07.00     NACL-Â¿¡¹Ç¼  14/09/XX  ³°ÍÑÎ×»þÅêÌôÂÐ±þ
      * 04.07.00     NACL-Â¿¡¹Ç¼  14/10/02  ÆÜÉþ¡ÊÎ×»þÅêÌô¡ËÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  14/12/XX  £È£²£·Ç¯£±·î²þÀµÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  15/07/28  APIV3ÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  16/03/XX  Ê¿À®£²£¸Ç¯£´·î²þÀµÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  16/08/XX  ¼«ÇåÀÕ¾®»ù²Ê³°Íè¿ÇÎÅÎÁÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  16/09/XX  Ê¿À®£²£¸Ç¯£±£°·î²þÀµÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  16/10/06  ¾®»ùÆÃÎãµÙÆüÅùÊÑ´¹ÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  16/12/XX  »ØÆ³ÎÁÅù¼«Æ°»»ÄêÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  17/02/XX  ºßÂð¼ÂÀÓ²Ã»»£²ºï½üÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  17/03/XX  Ê¿À®£²£¹Ç¯£´·î²þÀµÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  17/10/17  ¾®»ù²Ê³°Íè¿ÇÎÅÎÁÆ±Æü»þ´Ö³°²Ã»»ÂÐ±þ
      * 04.08.00     NACL-Â¿¡¹Ç¼  18/03/XX  Ê¿À®£³£°Ç¯£´·î²þÀµÂÐ±þ
      * 05.00.00     NACL-Â¿¡¹Ç¼  20/03/XX  ÎáÏÂ£°£²Ç¯£´·î²þÀµÂÐ±þ
      *****************************************************************
      *
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
       DATA                    DIVISION.
       FILE                        SECTION.
      *
      *
       WORKING-STORAGE             SECTION.
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  STS-AREA.
           03  STS-PARA            PIC X(02).
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-PARA            PIC 9(01).
           03  FLG-END             PIC 9(01).
           03  FLG-SANTEI          PIC 9(01).
           03  FLG-TENSU           PIC 9(01).
           03  FLG-JYURRK          PIC 9(01).
           03  FLG-SRYACT          PIC 9(01).
           03  FLG-HKNCOMBI        PIC 9(01).
           03  FLG-SYSKANRI        PIC 9(01).
           03  FLG-SANTEIPLUS      PIC 9(01).
      *
           03  FLG-KBN             PIC 9(01).
      *
           03  FLG-ERR             PIC 9(01).
           03  FLG-OK              PIC 9(01).
           03  FLG-ADD             PIC 9(01).
      *
           03  FLG-CHK             PIC 9(01).
           03  FLG-ARI             PIC 9(01).
      *
           03  FLG-ARI2            PIC 9(01).
           03  FLG-ARI3            PIC 9(01).
      *
           03  FLG-SYOSIN          PIC 9(01).
           03  FLG-SYOSIN2         PIC 9(01).
      *
           03  FLG-ROUMANSEI       PIC 9(01).
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê»»Äê
           03  FLG-SYONIKA         PIC 9(01).
           03  FLG-SYONIKA-ARI     PIC 9(01).
           03  FLG-SYONIKA-TEI     PIC 9(01).
      *    ¿²¤¿¤­¤êÏ·¿Í»»Äê
           03  FLG-TOUG-SANTEI         PIC 9(03).
           03  FLG-JYURR-ARI           PIC 9(01).
      *
      *    ÆÃÄê¼À´µ¼«Æ°»»Äê¥Á¥§¥Ã¥¯ÍÑ
           03  FLG-KYUJITU         PIC 9(01).
      *    »ØÆ³¥Á¥§¥Ã¥¯ÍÑ
           03  FLG-SIDOU           PIC 9(01).
      *    ¿Ç»¡ÎÁ
           03  FLG-SINSATU         PIC 9(01).
           03  FLG-SINSATU2        PIC 9(01).
           03  FLG-CHK2            PIC 9(01).
      *    ¿Ç»¡ÎÁ
           03  FLG-SAISIN-CHK      PIC 9(01).
      *    £±£µºÐÌ¤ËþºÆ¿ÇÎÁ¤¢¤ê
           03  FLG-15MIMAN         PIC 9(01).
      *    ¥ï¡¼¥¯¿ÇÎÅ¹Ô°Ù¿Ç»¡ÎÁ¤¢¤ê
           03  FLG-SINSATU-ARI     PIC 9(01).
      *    ¥ï¡¼¥¯¿ÇÎÅ¹Ô°Ù¿Ç»¡ÎÁ¤¢¤ê
           03  FLG-SINSATU-OK      PIC 9(01).
      *    »þ´Ö³°¥Õ¥é¥°
           03  FLG-JIKAN           PIC 9(01).
      *    ÄûÀµ»þ³°Íè´ÉÍý²Ã»»¤¢¤ê
           03  FLG-GAI             PIC 9(01).
      *    Æ±ÆüºÆ¿Ç
           03  FLG-DOUJITU         PIC 9(01).
      *    Æ±ÆüºÆ¿ÇÍ­Ìµ
           03  FLG-DOUJITU-ARI     PIC 9(01).
      *    £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁ
           03  FLG-DUMMY           PIC 9(01).
      *    ÅÅÏÃºÆ¿Ç¤¢¤ê
           03  FLG-TEL-ARI         PIC 9(01).
      *
           03  FLG-CHK-ALL         PIC 9(01).
      *
           03  FLG-JIKANKBN        PIC 9(01).
      *
           03  FLG-SYONIKA-CHK     PIC 9(01).
      *
           03  FLG-TAIIN           PIC 9(01).
           03  FLG-FUKU            PIC 9(01).
      *
           03  FLG-CHK3             PIC 9(01).
           03  FLG-HKN-ARI          PIC 9(01).
           03  FLG-KA-ARI           PIC 9(01).
           03  FLG-SRYKBN           PIC 9(01).
           03  FLG-TOKUTEI          PIC 9(02).
           03  FLG-TOKUTEI05        PIC 9(02).
           03  FLG-ATOPII           PIC 9(01).
           03  FLG-ADD2             PIC 9(01).
      *
           03  FLG-FUKU-ARI         PIC 9(01).
      *
           03  FLG-SANTEI-OK        PIC 9(01).
      *
           03  FLG-SYOSIN-ARI       PIC 9(01).
           03  FLG-DOUSYOSIN        PIC 9(01).
      *
           03  FLG-HENKAN           PIC 9(01).
           03  FLG-DOUJI-HEN        PIC 9(01).
           03  FLG-TAKA             PIC 9(01).
           03  FLG-SYOHEN           PIC 9(01).
           03  FLG-DOUJI-HEN2       PIC 9(01).
      *
           03  FLG-CHK-END          PIC 9(01).
      *H24.4
      *    £³ºÐÌ¤ËþºÆ¿ÇÎÁ¤¢¤ê
           03  FLG-03MIMAN         PIC 9(01).
      *H25.4
           03  FLG-SYOKAINASI      PIC 9(01).
           03  FLG-SYONIKA-NAI     PIC 9(01).
      *H27.3
      *    ³°Íè´ÉÍý²Ã»»ºï½ü¤¢¤ê
           03  FLG-GAIDEL          PIC 9(01).
           03  FLG-ARI1            PIC 9(01).
           03  FLG-ARIRS           PIC 9(01).
      *H27.12
           03  FLG-JIHI-ARI        PIC 9(01).
      *H28.4
           03  FLG-SYONIKKR         PIC 9(01).
           03  FLG-SYONIKKR-NAI     PIC 9(01).
           03  FLG-SYONIKKR-ARI     PIC 9(01).
      *
           03  FLG-TEISEI           PIC 9(01).
      *H30.4
           03  FLG-NINPU-IN         PIC 9(01).
           03  FLG-CHKT             PIC 9(01).
           03  FLG-ONLINE           PIC 9(01).
           03  FLG-SYOSIN-AUTO      PIC 9(01).
           03  FLG-SYUKSN           PIC 9(01).
           03  FLG-SYUARI           PIC 9(01).
           03  FLG-SYOSIN-ETC       PIC 9(01).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDX                 PIC 9(04).
           03  IDY                 PIC 9(04).
           03  IDX2                PIC 9(04).
           03  IDX3                PIC 9(04).
           03  IDX4                PIC 9(04).
           03  IDXS                PIC 9(04).
           03  IDX-S               PIC 9(04).
           03  IDX-Y2              PIC 9(02).
           03  IDX-Y3              PIC 9(02).
      *
           03  IDX-SIN             PIC 9(04).
           03  IDX-GAI             PIC 9(04).
           03  IDX-WK              PIC 9(04).
      *
           03  IDX-T               PIC 9(04).
      *
           03  IDX-A               PIC 9(04).
           03  IDX-KA              PIC 9(04).
           03  IDX-HKN             PIC 9(04).
           03  IDX-A-HZN           PIC 9(04).
      *
           03  IDX-INT-MAX          PIC 9(04).
      *
           03  IDX-HZN              PIC 9(04).
      *
           03  IDX-STR              PIC 9(02).
           03  IDX-R                PIC 9(02).
      *
           03  IDX-TEL                 PIC 9(04).
           03  IDX-SYU                 PIC 9(04).
      *H30.5
           03  IDX-SYUKSN              PIC 9(04).
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
      *
           03  WRK-SRYCD               PIC X(09).
      *
           03  WRK-IDX-IN              PIC 9(04).
           03  WRK-IDX-IN2             PIC 9(04).
           03  WRK-IDX-FT              PIC 9(04).
      *    »»Äê²ó¿ô
           03  WRK-SANTEI-CNT          PIC 9(04).
      *    Ç¯ÎðÈ½ÄêÍÑ
           03  WRK-BIRTHDAY.
               05  WRK-BIRTH-YY    PIC 9(04).
               05  WRK-BIRTH-MM    PIC 9(02).
               05  WRK-BIRTH-DD    PIC 9(02).
           03  WRK-NYUYOJI         PIC 9(04).
           03  WRK-DAYCNT          PIC 9(04).
           03  WRK-DAYCNT-SUM      PIC 9(04).
      *    ÄûÀµÆü¤Î²ó¿ô
           03  WRK-TEI-KAISU       PIC 9(04).
      *H24.4
      *    Ç¯ÎðÈ½ÄêÍÑ
           03  WRK-BIRTHDAY03.
               05  WRK-BIRTH-YY03  PIC 9(04).
               05  WRK-BIRTH-MM03  PIC 9(02).
               05  WRK-BIRTH-DD03  PIC 9(02).
      *
           03  WRK-SYOYMD          PIC X(08).
           03  WRK-SYOYMD-K        PIC X(08).
           03  WRK-KEIYMD          PIC X(08).
           03  WRK-KEIYMDZEN       PIC X(08).
      *
      *    »»ÄêÇ¯·îÆü
           03  WRK-SANTEI-YMD          PIC X(08).
      *    ½é¿ÇÇ¯·îÆü
           03  WRK-SYOSIN-YMD          PIC X(08).
           03  WRK-YMD.
               05  WRK-YYMM.
                   07  WRK-YY              PIC 9(04).
                   07  WRK-MM              PIC 9(02).
               05  WRK-DD              PIC 9(02).
      *
           03  WRK-KAISU               PIC 9(01).
           03  WRK-HOSPSBT             PIC 9(01).
           03  WRK-SRYKBN              PIC X(02).
           03  WRK-KBN                 PIC X(01).
           03  WRK-KBN2                PIC X(01).
           03  WRK-KBN3                PIC X(01).
           03  WRK-KBN4                PIC X(01).
           03  WRK-KBN5                PIC X(01).
      *    ¾Ò²ð¡¦ÂÅ·ëÎ¨£µ³ä
           03  WRK-ETCKBN              PIC X(01).
      *
           03  WRK-ZOKKBN              PIC 9(01).
      *
           03  WRK-IN-KAISU            PIC 9(03).
      *    »»ÄêÇ¯·î
           03  WRK-SANTEI-YM           PIC X(06).
           03  WRK-SANTEI-ARI          PIC X(06).
           03  WRK-SANTEI-NASI         PIC X(06).
      *
      *    Ï·¿ÍËýÀ­¼ÀÉÂ¿Ç»¡ÎÁ²ó¿ô
           03  WRK-ROUMANSEI           PIC 9(04).
           03  WRK-ROUMANSEI2          PIC 9(04).
           03  WRK-ROUMANSEI-CNT       PIC 9(04).
      **** 03  WRK-GAIRAI-IDX          PIC 9(04).
           03  WRK-SEIKATU-CNT         PIC 9(04).
      *
      *    ¿²¤¿¤­¤ê²ó¿ô
           03  WRK-NETAKIRI-CNT        PIC 9(04).
      *
      *    ºßÂð¼«¸ÊÃí¼Í
           03  WRK-ZAITAKU             PIC 9(01).
           03  WRK-ZAITAKU-IDX         PIC 9(04).
      *
      *    È¯À¸Ç¯·îÆü
           03  WRK-HASSYOYMD.
               05  WRK-HAS-YY          PIC 9(04).
               05  WRK-HAS-MM          PIC 9(02).
               05  WRK-HAS-DD          PIC 9(02).
      *
      *    ½é²ó»»ÄêÆü
           03  WRK-FSANTEIYMD          PIC X(08).
      *
      *    ¥Ñ¥¹Ì¾
           03  WRK-PATH                PIC X(64).
      *
      *    ¼õ¿Ç²ó¿ô¡Ê³°Áí¿Ç  ´Ý¤áÍÑ¡Ë
           03  WRK-SINSATU-ROU         PIC 9(04).
      *    ¼õ¿Ç²ó¿ô
           03  WRK-SINSATU-CNT         PIC 9(04).
      *
      *    ¾Ã±ê½èÃÖ²ó¿ô
           03  WRK-SYOEN-CNT           PIC 9(03).
      *
      *    ÆþÎÏ
           03  WRK-INPUTCD             PIC X(22).
      *    ÅöÆü¼õ¿Ç²ó¿ô
           03  WRK-DAY-SINSATUCNT      PIC 9(04).
      *
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¥Á¥§¥Ã¥¯
           03  WRK-SYONIKA-KBN        PIC X(01).
      *
      *    È¯À¸ÆüÊÔ½¸
           03  WRK-HENSYU-AREA.
               05  WRK-KYUSEI-YMD      PIC X(09).
               05  WRK-KYUSEI-90       PIC X(09).
               05  WRK-KYUSEI-180      PIC X(09).
               05  WRK-HENSYU          PIC X(80).
      *
      *    Ê£¿ô²Ê
           03  WRK-SEL-HKNNUM          PIC X(03).
           03  WRK-HKNCOMBI            PIC X(04).
           03  WRK-SRYKA               PIC X(02).
           03  WRK-DRCD.
               05  WRK-DRCD1               PIC X(01).
               05  WRK-DRCD2               PIC X(04).
           03  WRK-DRCD-MEI                PIC X(80).
           03  WRK-HEN-SRYKA               PIC X(02).
      *    ºßÂðÎÅÍÜ»ØÆ³ÎÁ»»Äê
           03  WRK-ZAITAKU-CNT         PIC 9(04).
      *    ¥ê¥Ï¥Ó¥ê°å³Ø´ÉÍýÎÁ
           03  WRK-RIHA-KBN            PIC X(01).
           03  WRK-RIHA-SYUKBN         PIC X(01).
      *
           03  WRK-RIHA-KAN-G.
               05  WRK-RIHA-KAN        OCCURS   4.
                   07  WRK-RIHA-DD     PIC 9(02).
                   07  WRK-RIHA-STDD   PIC 9(02).
                   07  WRK-RIHA-EDDD   PIC 9(02).
           03  WRK-RDD                 PIC 9(02).
      *   ¥ê¥Ï¥Ó¥êÈ¯¾ÉÆüÉ½¼¨
           03  WRK-RIHABIR-AREA.
               05  WRK-RIHABIR-OCC     OCCURS   10.
                   07  WRK-RIHA-STR        PIC X(08).
                   07  WRK-RIHA-END        PIC X(08).
      *
           03  WRK-RIHABIR-AREA2.
               05  WRK-RIHABIR-OCC2    OCCURS   10.
                   07  WRK-RIHA-STR2       PIC X(08).
           03  WRK-RIHA-YMD                PIC X(08).
           03  WRK-RIHA-GMN                PIC X(09).
           03  WRK-RIHAMEI                 PIC X(60).
           03  WRK-ZOGEN-MEI               PIC X(12).
           03  WRK-ZOGEN                   PIC S9(03).
           03  WRK-ENDYMD                  PIC X(08).
      *    ³°Íè»þ´Ö³°¶èÊ¬ÀßÄê
           03  WRK-HZN-JIKANKBN            PIC 9(01).
      *H24.4
      *    ³°Íè¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥ó¿Ç»¡ÎÁ
           03  WRK-LAST-DAY1                PIC X(08).
           03  WRK-LAST-DAY2                PIC X(08).
           03  WRK-LAST-DAY3                PIC X(08).
      *    ºÇ½ª»»ÄêÆü
           03  WRK-LAST-DAY.
               05  WRK-LAST-YM                  PIC X(06).
               05  WRK-LAST-DD                  PIC X(02).
           03  WRK-KIKAN-DAY               PIC X(08).
           03  WRK-KIKAN                   PIC 9(02).
           03  FLG-KIKAN                   PIC 9(01).
      *
      *H26.4
      *    ºß°åÁí´ÉÈ½Äê
           03  WRK-ZS-GRP                  PIC X(02).
           03  WRK-ZS-KBN                  PIC X(01).
           03  WRK-ZS-KBN2                 PIC X(01).
           03  WRK-KEY-KBN                 PIC X(01).
      *H28.4
           03  WRK-SYOUNI              PIC 9(04).
           03  WRK-SYOUNI-SUM          PIC 9(04).
      *H29.2
      *    ºß¼ÂÀÓ²Ã»»ÂÐ±þ
           03  WRK-IDX-IN3             PIC 9(04).
           03  WRK-IDX-IN4             PIC 9(04).
           03  FLG-CHKEND              PIC 9(01).
           03  IDKS                    PIC 9(04).
           03  WRK-ZKS-GRP             PIC X(02).
           03  WRK-ZKS-KBN             PIC X(01).
      *H30.4
      *    Ç¥ÉØ²Ã»»
           03  WRK-TIME-KBN1           PIC X(01).
           03  WRK-TIME-KBN2           PIC X(02).
           03  WRK-TIME-KBN3           PIC X(01).
           03  WRK-TIME-TIMKBN         PIC X(01).
      *
           03  WRK-IDX-INS             PIC 9(04).
      *
           03  WRK-SYO-SRYCD           PIC X(09).
           03  WRK-SAI-SRYCD           PIC X(09).
      *
      *    ¿Ç»¡ÎÁ¥Æ¡¼¥Ö¥ë
       01  TBL-SINSATU-AREA.
      *    ½é¿ÇÎÁ
           03  FILLER              PIC X(14)   VALUE   "100F 111000110".
      *    Æ±Æü½é¿Ç
           03  FILLER              PIC X(14)   VALUE   "100FD111011810".
      *
      *    ºÆ¿ÇÎÁ
           03  FILLER              PIC X(14)   VALUE   "100  112007410".
      *    ÅÅÏÃºÆ¿ÇÎÁ
           03  FILLER              PIC X(14)   VALUE   "100T 112007950".
      *    Æ±ÆüºÆ¿Ç
           03  FILLER              PIC X(14)   VALUE   "100D 112008350".
      *    ÅÅÏÃÆ±ÆüºÆ¿Ç
           03  FILLER              PIC X(14)   VALUE   "100S 112008850".
      *
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ(±¡³°½èÊý ½é¿Ç)
           03  FILLER              PIC X(14)   VALUE   "200FG113003510".
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ(±¡Æâ½èÊý ½é¿Ç)
           03  FILLER              PIC X(14)   VALUE   "200FN113003710".
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ(±¡³°½èÊý ºÆ¿Ç)
           03  FILLER              PIC X(14)   VALUE   "200 G113003610".
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ(±¡Æâ½èÊý ºÆ¿Ç)
           03  FILLER              PIC X(14)   VALUE   "200 N113003810".
      *
      *    ³°Íè¿ÇÎÅÎÁ
           03  FILLER              PIC X(14)   VALUE   "301  112011310".
      *    Æ±Æü³°Íè¿ÇÎÅÎÁ
           03  FILLER              PIC X(14)   VALUE   "301D 112011710".
      *
      *H24.4
      *    ºÆ¿ÇÎÁ¡ÊÆ±°ìÆü£²²ÊÌÜ¡Ë
           03  FILLER              PIC X(14)   VALUE   "100KD112015810".
      *    ÅÅÏÃºÆ¿Ç¡ÊÆ±°ìÆü£²²ÊÌÜ¡Ë
           03  FILLER              PIC X(14)   VALUE   "100JD112015950".
      *    ³°Íè¿ÇÎÅÎÁ¡ÊÆ±°ìÆü£²²ÊÌÜ¡Ë
           03  FILLER              PIC X(14)   VALUE   "300KD112016210".
      *H24.4
      *H25.4 ¤«¤é
      *    ½é¿ÇÎÁ¡Ê¾Ò²ð¾õ¤Ê¤·¡Ë
           03  FILLER              PIC X(14)   VALUE   "110F 111012510".
      *    Æ±Æü½é¿Ç¡ÊÆ±°ìÆü£²²ÊÌÜ¡¦¸ºÅÀµ¬³Ê³ºÅö¡Ë¡Ê¶¦ÄÌ¡Ë
           03  FILLER              PIC X(14)   VALUE   "110FD111012610".
      *    ³°Íè¿ÇÎÅÎÁ¡ÊÂ¾°åÎÅµ¡´Ø¤Ø¾Ò²ð¡Ë
           03  FILLER              PIC X(14)   VALUE   "311  112016310".
      *    ³°Íè¿ÇÎÅÎÁ¡ÊÆ±°ìÆü£²²ÊÌÜ¡¦¸ºÅÀµ¬³Ê³ºÅö¡Ë¡Ê¶¦ÄÌ¡Ë
           03  FILLER              PIC X(14)   VALUE   "310KD112016410".
      *    Æ±Æü³°Íè¿ÇÎÅÎÁ¡ÊÂ¾°åÎÅµ¡´Ø¤Ø¾Ò²ð¡Ë
           03  FILLER              PIC X(14)   VALUE   "311D 112016550".
      *
      *H27.1 ¤«¤é
      *    ½é¿Ç¡ÊÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  FILLER              PIC X(14)   VALUE   "120F 111012710".
      *    ºÆ¿ÇÎÁ¡ÊÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  FILLER              PIC X(14)   VALUE   "120  112016610".
      *    ÅÅÏÃÅùºÆ¿Ç¡ÊÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  FILLER              PIC X(14)   VALUE   "120T 112016750".
      *    Æ±ÆüºÆ¿Ç¡ÊÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  FILLER              PIC X(14)   VALUE   "120D 112016850".
      *    Æ±ÆüÅÅÏÃÅùºÆ¿Ç¡ÊÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  FILLER              PIC X(14)   VALUE   "120S 112016950".
      *    ºÆ¿ÇÎÁ¡ÊÆ±°ìÆü£²²ÊÌÜ¡¦ÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  FILLER              PIC X(14)   VALUE   "120KD112017010".
      *    ÅÅÏÃÅùºÆ¿Ç¡ÊÆ±°ìÆü£²²ÊÌÜ¡¦ÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  FILLER              PIC X(14)   VALUE   "120JD112017150".
      *    ³°Íè¿ÇÎÅÎÁ¡ÊÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  FILLER              PIC X(14)   VALUE   "321  112017310".
      *    Æ±Æü³°Íè¿ÇÎÅÎÁ¡ÊÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  FILLER              PIC X(14)   VALUE   "321D 112017450".
      *?
      *    Æ±Æü½é¿Ç¡ÊÆ±°ìÆü£²²ÊÌÜ¡¦¸ºÅÀµ¬³Ê³ºÅö¡Ë¡Ê¶¦ÄÌ¡Ë
      *    03  FILLER              PIC X(14)   VALUE   "120FD111012610".
      *    ³°Íè¿ÇÎÅÎÁ¡ÊÆ±°ìÆü£²²ÊÌÜ¡¦¸ºÅÀµ¬³Ê³ºÅö¡Ë¡Ê¶¦ÄÌ¡Ë
      *    03  FILLER              PIC X(14)   VALUE   "321KD112016410".
      *
      *H28.4
      *    Æ±Æü½é¿Ç¡ÊÆ±°ìÆü£²²ÊÌÜ¡¦ÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  FILLER              PIC X(14)   VALUE   "120FD111012810".
      *    ³°Íè¿ÇÎÅÎÁ¡ÊÆ±°ìÆü£²²ÊÌÜ¡¦ÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  FILLER              PIC X(14)   VALUE   "320KD112017610".
      *
      *    ¾®»ù²Ê¤«¤«¤ê¤Ä¤±¿Ç»¡ÎÁ(±¡³°½èÊý ½é¿Ç)
           03  FILLER              PIC X(14)   VALUE   "400FG113019910".
      *    ¾®»ù²Ê¤«¤«¤ê¤Ä¤±¿Ç»¡ÎÁ(±¡Æâ½èÊý ½é¿Ç)
           03  FILLER              PIC X(14)   VALUE   "400FN113019710".
      *    ¾®»ù²Ê¤«¤«¤ê¤Ä¤±¿Ç»¡ÎÁ(±¡³°½èÊý ºÆ¿Ç)
           03  FILLER              PIC X(14)   VALUE   "400 G113020010".
      *    ¾®»ù²Ê¤«¤«¤ê¤Ä¤±¿Ç»¡ÎÁ(±¡Æâ½èÊý ºÆ¿Ç)
           03  FILLER              PIC X(14)   VALUE   "400 N113019810".
      *
      *H30.4
      *    ÅÅÏÃºÆ¿ÇÎÁ¡Ê°ìÈÌ ÉÂ±¡¡Ë¡Ê£³£°Ç¯£³·î°ÊÁ°·ÑÂ³¡Ë
           03  FILLER              PIC X(14)   VALUE   "103T 112023350".
      *    Æ±ÆüÅÅÏÃºÆ¿Ç¡Ê°ìÈÌ ÉÂ±¡¡Ë¡Ê£³£°Ç¯£³·î°ÊÁ°·ÑÂ³¡Ë
           03  FILLER              PIC X(14)   VALUE   "103S 112023450".
      *    ÅÅÏÃºÆ¿Ç¡ÊÆ±°ìÆü£²²ÊÌÜ¡Ë¡Ê£³£°Ç¯£³·î°ÊÁ°·ÑÂ³¡Ë
           03  FILLER              PIC X(14)   VALUE   "103JD112023550".
      *    ÅÅÏÃÅùºÆ¿Ç¡ÊÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë¡Ê£³£°Ç¯£³·î°ÊÁ°·ÑÂ³
           03  FILLER              PIC X(14)   VALUE   "123T 112023650".
      *    Æ±ÆüÅÅÏÃÅùºÆ¿Ç¡ÊÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë¡Ê£³£°Ç¯£³·î°ÊÁ°·ÑÂ³
           03  FILLER              PIC X(14)   VALUE   "123S 112023750".
      *    ÅÅÏÃÅùºÆ¿Ç¡ÊÆ±°ìÆü£²²ÊÌÜ¡¦¸ºÅÀµ¬Äê³ºÅö¤Î¾ì¹ç¡Ë
           03  FILLER              PIC X(14)   VALUE   "123JD112023850".
      *R02.4.10 ¤«¤é
      *    ½é¿ÇÎÁ¡Ê¿··¿¥³¥í¥Ê¥¦¥¤¥ë¥¹´¶À÷¾É¡¦Î×»þ¡Ë
           03  FILLER              PIC X(14)   VALUE   "130F 111013850".
      *
      *
       01  TBL-SINSATU-AREAR       REDEFINES   TBL-SINSATU-AREA.
      **** 03  TBL-SINSATU-OCC         OCCURS  20    INDEXED  TBL-IDX.
      *?   03  TBL-SINSATU-OCC         OCCURS  29    INDEXED  TBL-IDX.
      **** 03  TBL-SINSATU-OCC         OCCURS  35    INDEXED  TBL-IDX.
      **   03  TBL-SINSATU-OCC         OCCURS  41    INDEXED  TBL-IDX.
           03  TBL-SINSATU-OCC         OCCURS  42    INDEXED  TBL-IDX.
      *        £±¡§°ìÈÌ¡¢£²¡§¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡¢£³¡§³°Íè¿ÇÎÅÎÁ
      *        £´¡§¾®»ù¤«¤«¤ê¤Ä¤±
               05  TBL-KAISU           PIC 9(01).
      *        £±:¾Ò²ð¤Ê¤·¡¢£²¡§ÂÅ·ëÎ¨£µ³ä°Ê²¼¡¢£³¡§¿··¿¥³¥í¥Ê
               05  TBL-ETCKBN          PIC 9(01).
      ****     ÉÂ±¡¼ïÊÌ¡Ê£±¡§ÉÂ±¡¡¢£²¡§¿ÇÎÅ½ê¡Ë
      *        ÉÂ±¡¼ïÊÌ¡Ê£³¡§£³£°Ç¯£³·î·ÑÂ³Ê¬¡Ë
               05  TBL-HOSPSBT         PIC 9(01).
      *        D:Æ±ÆüºÆ¿Ç¡¢T¡§ÅÅÏÃºÆ¿Ç¡¢S:Æ±ÆüÅÅÏÃºÆ¿Ç¡¢F:½é¿Ç
               05  TBL-KBN             PIC X(01).
      *        G:±¡³°¡¢N:±¡Æâ¡Ê¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¡Ë
      *        D:Æ±Æü½é¿Ç¡ÊÆ±°ìÆü£²²ÊÌÜ¡Ë
               05  TBL-KBN2            PIC X(01).
      *        ¿ÇÎÅ¥³¡¼¥É
               05  TBL-SRYCD           PIC X(09).
      *
      *    ºÆ¿Ç²Ã»»¥Æ¡¼¥Ö¥ë
       01  TBL-GAIRAI-AREA.
      *    ³°Íè´ÉÍý²Ã»»
           03  TBLG-SRYCD          PIC X(09)   VALUE   "112011010".
      *    ÌÀºÙ½ñÈ¯¹ÔÂÎÀ©Åù²Ã»»
           03  TBL-MEISRYCD        PIC X(09)   VALUE   "112015770".
      *H24.4
      *    »þ´Ö³°ÂÐ±þ²Ã»»£²¡ÊÃÏ°è°åÎÅ¹×¸¥²Ã»»£²¡Ë
           03  TBL-CHISRYCD2       PIC X(09)   VALUE   "112015670".
      *    »þ´Ö³°ÂÐ±þ²Ã»»£±
           03  TBL-CHISRYCD1       PIC X(09)   VALUE   "112016070".
      *    »þ´Ö³°ÂÐ±þ²Ã»»£³
           03  TBL-CHISRYCD3       PIC X(09)   VALUE   "112016170".
      *H30.4
      *    ÃÏ°èÊñ³ç¿ÇÎÅ²Ã»»£±
           03  TBL-CHKCARKSN1      PIC X(09)   VALUE   "112021770".
      *    ÃÏ°èÊñ³ç¿ÇÎÅ²Ã»»£²
           03  TBL-CHKCARKSN2      PIC X(09)   VALUE   "112017270".
      *H30.4
      *    Ç§ÃÎ¾ÉÃÏ°èÊñ³ç¿ÇÎÅ²Ã»»£±
           03  CONS-NNCHIKSN1      PIC X(09)   VALUE   "112021870".
      *    Ç§ÃÎ¾ÉÃÏ°èÊñ³ç¿ÇÎÅ²Ã»»£²
           03  CONS-NNCHIKSN2      PIC X(09)   VALUE   "112017570".
      *
      *    ½èÊýäµÌµ¸òÉÕ²Ã»»¡Êºß°åÁí´É¡¦»Ü°åÁí´É¡Ë¡ÊC002-00)
           03  CONS-C0020-KSN      PIC X(09)   VALUE   "114034370".
      *H30.4 ÇÑ»ß
      *    ½èÊý¤»¤óÌµ¸òÉÕ²Ã»»¡Ê»Ü°åÁí´É¡Ë¡ÊC002-00)
      *****03  CONS-C0022-KSN      PIC X(09)   VALUE   "114039170".
      *
      *    ¥ª¥ó¥é¥¤¥ó¿ÇÎÅÎÁ¡ÊA001-00)
           03  CONS-ONLINE01       PIC X(09)   VALUE   "112023210".
      *
      *    Ï«ºÒ¿Ç»¡ÎÁ¥Æ¡¼¥Ö¥ë
       01  TBL-RSI-SINSATU-AREA.
      *    ½é¿ÇÎÁ
           03  FILLER              PIC X(13)   VALUE   "0 F 101110010".
      *    Æ±Æü½é¿Ç
           03  FILLER              PIC X(13)   VALUE   "0 FD101110040".
      *    ºÆ¿ÇÎÁ
           03  FILLER              PIC X(13)   VALUE   "0   101120010".
      *    ºÆ¿ÇÎÁ¡ÊÆ±Æü£²²ÊÌÜ¡Ë
           03  FILLER              PIC X(13)   VALUE   "0 KD101120040".
      *H25.9 ÄÉ²Ã
      *    ÅÅÏÃºÆ¿ÇÎÁ
           03  FILLER              PIC X(13)   VALUE   "0 T 101120050".
      *    Æ±ÆüºÆ¿ÇÎÁ
           03  FILLER              PIC X(13)   VALUE   "0 D 101120060".
      *    Æ±ÆüÅÅÏÃºÆ¿ÇÎÁ
           03  FILLER              PIC X(13)   VALUE   "0 S 101120070".
      *    ÅÅÏÃºÆ¿Ç¡ÊÆ±°ìÆü£²²ÊÌÜ¡Ë
           03  FILLER              PIC X(13)   VALUE   "0 JD101120080".
      *
       01  TBL-RSI-SINSATU-AREAR   REDEFINES   TBL-RSI-SINSATU-AREA.
           03  TBL-RSI-SINSATU-OCC     OCCURS  8    INDEXED  TBL-RSI.
      *        ²ó¿ô
               05  TBLR-KAISU           PIC 9(01).
      *******  05  FILLER               PIC X(01).
      *        £²¡§ÂÅ·ëÎ¨£µ³ä°Ê²¼
               05  TBLR-ETCKBN          PIC X(01).
      *********F:½é¿Ç¡¢S:ºÆ¿Ç¡¢G:³°Íè´ÉÍý²Ã»»
      *        F:½é¿Ç¡¢ :ºÆ¿Ç
      *        D:Æ±ÆüºÆ¿Ç¡¢T:ÅÅÏÃºÆ¿Ç,S:Æ±ÆüÅÅÏÃºÆ¿Ç,J:ÅÅÏÃ£²²ÊÌÜ
               05  TBLR-KBN             PIC X(01).
      *        D:Æ±Æü½é¿Ç
               05  TBLR-KBN2            PIC X(01).
      *        ¿ÇÎÅ¥³¡¼¥É
               05  TBLR-SRYCD           PIC X(09).
      *H25.7
      *    Ï«ºÒ³°Íè´ÉÍý²Ã»»Åù²Ã»»¥Æ¡¼¥Ö¥ë
       01  TBLR-GAIRAI-AREA.
      *    ³°Íè´ÉÍý²Ã»»
           03  TBLRG-SRYCD         PIC X(09)   VALUE   "101120020".
      *
      *H30.4
      *    ÃÏ°èÊñ³ç¿ÇÎÅÎÁ
       01  CONS-CHIKIHKT2          PIC X(09)  VALUE   "113015810".
       01  CONS-CHIKIHKT1          PIC X(09)  VALUE   "113024810".
      *    Ç§ÃÎ¾ÉÃÏ°èÊñ³ç¿ÇÎÅÎÁ
       01  CONS-NNCHIHKT2          PIC X(09)  VALUE   "113018410".
       01  CONS-NNCHIHKT1          PIC X(09)  VALUE   "113025710".
      *
      *H30.4
      *    µ¡Ç½¶¯²½²Ã»»¡Ê½é¿Ç¡Ë¡Ê¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ë
       01  CONS-SYOUNICD1          PIC X(09)  VALUE   "113028870".
      *    ¾®»ù¹³¶ÝÅ¬ÀµÌô»ÈÍÑ²Ã»»¡Ê¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ë
       01  CONS-SYOUNICD2          PIC X(09)  VALUE   "113024670".
      *
      *    ¾®»ù¹³¶ÝÅ¬ÀµÌô»ÈÍÑ²Ã»»¡Ê¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅÎÁ¡Ë
       01  CONS-SYOKAKCD2          PIC X(09)  VALUE   "113027870".
      *    ÌôºÞÅ¬Àµ»ÈÍÑÏ¢·È²Ã»»¡ÊºÆ¿Ç¡Ë
       01  CONS-YKZTEKICD          PIC X(09)   VALUE    "112021970".
      *
      *    ÊÝ¸±ÊÌ»»ÄêÍúÎò¥Æ¡¼¥Ö¥ë
           COPY   "CMSANTEITBL.INC".
      *
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¥Æ¡¼¥Ö¥ë
           COPY   "CMSYONIKATBL.INC".
      *
      *H28.4
      *    ºßÂð»þ°åÎÅÁí¹ç´ÉÍýÎÁ¥³¡¼¥É¥Æ¡¼¥Ö¥ë¡ÊH28.4¡Ë
           COPY     "CMZISOTBL2016.INC".
      *
      *H30.4
      *    »þ´Ö³°²Ã»»¥Æ¡¼¥Ö¥ë(H30.4Ê¬¡Ë¡ÊÇ¥ÉØ²Ã»»´Þ¡Ë
           COPY     "CMTIMEKSN2018.INC".
      *
      *    ²èÌÌ£Ó£Ð£ÁÎÎ°è¥ï¡¼¥¯
       01  HZN-SCR-REC.
           COPY    "CPK02SPASCR.INC"  REPLACING
                                       //SPA-// BY //HZN-//.
      *
      *    ²èÌÌ£Ó£Ð£ÁÎÎ°è¥ï¡¼¥¯
       01  WRK-SCR-REC.
           COPY    "CPK02SPASCR.INC"  REPLACING
                                       //SPA-// BY //WRK-//.
      *
      *    ²èÌÌ£Ó£Ð£ÁÎÎ°è¥ï¡¼¥¯
       01  WRK-SCR-REC2.
           COPY    "CPK02SPASCR.INC"  REPLACING
                                       //SPA-// BY //WRK2-//.
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿¡Ý
      *01  TENSU-REC.
           COPY    "CPTENSU.INC".
      *
      *    »»ÄêÍúÎò
       01  SANTEI-REC.
           COPY    "CPSANTEI.INC".
      *
      *    »»ÄêÍúÎòÉÕ²Ã
       01  SANTEIPLUS-REC.
           COPY    "CPSANTEIPLUS.INC".
      *
      *    ¼õ¿ÇÍúÎò
       01  JYURRK-REC.
           COPY    "CPJYURRK.INC".
      *
      *    ¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¡Ý
       01  SRYACT-REC.
           COPY    "CPSRYACT.INC".
      *
      *    ÊÝ¸±ÁÈ¤ß¹ç¤ï¤»
       01  HKNCOMBI-REC.
           COPY    "CPHKNCOMBI.INC".
      *
      *    ¥ï¡¼¥¯¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¡Ý
       01  WKSRYACT-REC.
           COPY    "CPWKSRYACT.INC".
      *
      *    ¿¦°÷¾ðÊó
           COPY    "CPSK1010.INC".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑ¡¡ÎÎ°è
      *****************************************************************
      *
      *   ÆüÉÕÊÑ´¹¥µ¥Ö
           COPY    "CPORCSDAY.INC".
           COPY    "CPORCSLNK.INC".
      *
      *    ²èÌÌÆüÉÕÊÑ´¹¥µ¥Ö
      *    COPY    "CPORCSGDAY.INC".
      *
      *    ¿ô»úÊÑ´¹ÎÎ°è
      *    COPY    "CPORCSNUM.INC".
      *    ´µ¼ÔÈÖ¹æÊÑ´¹¥µ¥Ö
      *    COPY    "CPORCSPTID.INC".
      *
      *    ÉéÃ´¶â³Û·×»»ÍÑ¥Ñ¥é¥á¥¿
      *    COPY    "CPORCS01.INC".
      *
      *    ¿ÇÎÅ¹Ô°Ù»»ÄêÍÑ¶¦ÄÌ¥Ñ¥é¥á¥¿
      *    COPY    "CPORCSC00.INC".
      *
      *    »»ÄêÍúÎò¥Á¥§¥Ã¥¯¥Ñ¥é¥á¥¿
      *    COPY    "CPORCSC91.INC".
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¥Ñ¥é¥á¥¿
           COPY    "CPORCSC92.INC".
      *
      *    ºÞÊ¬Î¥¥Ñ¥é¥á¥¿
      *    COPY    "CPORCSC93.INC".
      *
      *    ²èÌÌºÆÊÔ½¸¥Ñ¥é¥á¥¿
           COPY    "CPORCSC94.INC".
      *
      *    ½é´ü£Ó£Ð£Á²èÌÌÊÔ½¸¥Ñ¥é¥á¥¿
      *    COPY    "CPORCSC95.INC".
      *
      *    ¥¨¥é¡¼¥á¥Ã¥»¡¼¥¸ÊÔ½¸¥Ñ¥é¥á¥¿
      *    COPY    "CPORCSC96.INC".
      *
      *    ¥¨¥é¡¼¥á¥Ã¥»¡¼¥¸ÊÔ½¸¥Ñ¥é¥á¥¿
      *    COPY    "CPORCSC97.INC".
      *
      *    ÊÝ¸±Ç¯Îð¡¦ÉéÃ´³ä¹ç»»Äê¥µ¥Ö
           COPY    "CPORCSAGECHK.INC".
      *
      *    ¿ÇÎÅ¼ïÊÌÌ¾¥Æ¡¼¥Ö¥ë
           COPY    "CPORCSSRYSYU.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPDATA.INC".
      *
           COPY    "MCPAREA".
      *
      *    ¿ÇÎÅ¹Ô°ÙÍÑ¶¦ÄÌ¥Ñ¥é¥á¥¿
           COPY    "K01COMMON-SPA".
      *
      *
      *****************************************************************
      *    Ï¢Íí¡¡ÎÎ°è
      *****************************************************************
        LINKAGE                     SECTION.
      *
      *    ¥¹¥ÑÎÎ°è
           COPY    "COMMON-SPA".
      *    ¥Ñ¥é¥á¥¿
           COPY    "CPORCSC10S.INC".
      *
      *    £Ó£Ð£Á¥Ñ¥é¥á¥¿
       01  SPA-SCR-REC.
           COPY    "CPK02SPASCR.INC".
      *
      *    ²èÌÌ¥¹¥ÑÎÎ°è
           COPY    "K02SCR-SPA".
      *
       PROCEDURE                   DIVISION    USING
           ORCSC10SAREA
           SPA-AREA
           SPA-SCR-REC
           SPA-K02
           .
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           INITIALIZE                  FLG-AREA
           INITIALIZE                  IDX-AREA
           INITIALIZE                  WRK-AREA
      *
           MOVE    SPACE               TO  SPA-ERRMSG
           MOVE    SPA-WORK            TO  SPA-K01KYOUTU
      *
           EVALUATE    LNK-SC10S-SYORI
      *        ½é´ü¼«Æ°È¯À¸ÊÔ½¸
               WHEN    "1"
                   PERFORM 100-SANTEI-CHK-SEC
                   PERFORM 200-SINSATU-SET-SEC
      *        Æ±»þºÆ¿Ç»»Äê¡Ê¼«Æ°¡Ë
               WHEN    "G"
                   PERFORM 200-SYOSIN-SET-SEC
      *        Æ±»þºÆ¿Ç»»Äê¡Ê¼«Æ°¡Ë
               WHEN    "2"
                   PERFORM 300-DOUSAISIN-SET-SEC
      *        »»Äê²ó¿ô¥Á¥§¥Ã¥¯
               WHEN    "3"
                   PERFORM 100-SANTEI-CHK-SEC
      *        ±¡Æâ±¡³°ÊÑ¹¹
               WHEN    "4"
                   PERFORM 400-INGAI-HEN-SEC
      *        Æ±»þºÆ¿Ç»»Äê¡ÊÆþÎÏÊ¬¡Ë
               WHEN    "5"
                   PERFORM 500-INDOUSAISIN-SET-SEC
      *        ºÞÊ¬Î¥Á°¤ÎÆÃÄê»»Äê²ó¿ô¥Á¥§¥Ã¥¯
               WHEN    "6"
                   PERFORM 600-SANTEI-CNT-SEC
      *        ºÞÊ¬Î¥¸å¤ÎÆÃÄê»»Äê¥Á¥§¥Ã¥¯
               WHEN    "7"
                   PERFORM 700-SANTEI-CHK-SEC
      *        ºÆ¿ÇÎÁ¢ª½é¿ÇÎÁ¤Î¿¶ÂØ»þ¥Á¥§¥Ã¥¯½èÍý
               WHEN    "9"
                   PERFORM 900-SYOSIN-CHK-SEC
      *
      *        ÃæÅÓ½ªÎ»ÁªÂò»þ¥Á¥§¥Ã¥¯½èÍý
               WHEN    "W"
                   PERFORM 1000-WKSRYACT-SYORI-SEC
      *        ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý
               WHEN    "S"
                   PERFORM 1010-SINSATU-HEN-SEC
      *        ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý¡ÊÂ¾ÊÝ¸±¼õ¿Ç¤¢¤ê¡Ë
               WHEN    "H"
                   PERFORM 1012-TAHOKEN-HEN-SEC
      *        ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý¡ÊÂ¾ÊÝ¸±¼õ¿Ç¤¢¤ê¤ÇÆ±ÆüºÆ¿Ç¤Ø¡Ë
               WHEN    "J"
                   PERFORM 1010-SINSATU-HEN-SEC
      *        ½é¿ÇÎÁ¤ò»»ÄêÃæ¤«¤ÎÈ½Äê
               WHEN    "C"
                   PERFORM 1011-SYOSIN-CHK-SEC
      *        ¿Ç»¡ÎÁ»»Äê¸å¡¢¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý
               WHEN    "K"
                   PERFORM 1014-SINSATU-HENKAN-SEC
      *        Ê£¿ôÎÁ¡Ê¡ð¡Ë¡¢ÊÝ¸±ÁÈ¹ç¤»¡Ê¡ô¡ËÂÐ±þ
               WHEN    "A"
               WHEN    "B"
      *        »ØÆ³ÎÁÈ¯À¸¤Ê¤·
               WHEN    "D"
                   PERFORM 1015-FUKU-SYORI-SEC
      *        ½é¿ÇÎÁ¤òºÆ¿ÇÎÁ¤ØÊÑ¹¹
               WHEN    "E"
                   PERFORM 1010-SINSATU-HEN-SEC
      *H27.07
      *        APIV3 ¼«Æ°È¯À¸
               WHEN    "@"
                   PERFORM 1019-API-SYORI-SEC
      *H27.01
           END-EVALUATE
      *
           MOVE    SPA-K01KYOUTU       TO  SPA-WORK
           MOVE    IDX2                TO  LNK-SC10S-IDX2
           .
       000-PROC-EXT.
      *
           EXIT    PROGRAM
           .
      *
      *****************************************************************
      *    ½é¿ÇÎÁ¤ò»»ÄêÃæ¤«¤ÎÈ½Äê½èÍý
      *****************************************************************
       1011-SYOSIN-CHK-SEC                  SECTION.
      *
           MOVE    ZERO               TO  SPA-SYOSIN
      *
      *    ÄûÀµ¤Î»þ¡¢½é¿ÇÎÁ¤ò»»ÄêÃæ¤«¤ÎÈ½Äê
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE )  OR
                              (SPA-COM-INPUTCD(IDX) =   SPACE  AND
                               SPA-GMN-INPUTCD(IDX) =   SPACE )
               EVALUATE    SPA-COM-INPUTCD (IDX)
                   WHEN    "111000110"
                   WHEN    "113003510"
                   WHEN    "113003710"
                       MOVE    1              TO  SPA-SYOSIN
      *                Ï«ºÒÊ¬
                   WHEN    "101110010"
                       MOVE    1              TO  SPA-SYOSIN
      *H25.4           ¾Ò²ð¤Ê¤·
                   WHEN    "111012510"
                       MOVE    1              TO  SPA-SYOSIN
      *H27.1           ÂÅ·ëÎ¨£µ³ä°Ê²¼
                   WHEN    "111012710"
                       MOVE    1              TO  SPA-SYOSIN
      *H28.4
      *                ¾®»ù¤«¤«¤ê¤Ä¤±
                   WHEN    "113019710"
                   WHEN    "113019910"
                       MOVE    1              TO  SPA-SYOSIN
      *R02.4           ¿··¿¥³¥í¥Ê¥¦¥¤¥ë¥¹´¶À÷¾É
                   WHEN    "111013850"
                       MOVE    1              TO  SPA-SYOSIN
               END-EVALUATE
           END-PERFORM
      *
           .
       1011-SYOSIN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³Æ¿Ç»¡»»Äê²ó¿ô½èÍý
      *****************************************************************
       100-SANTEI-CHK-SEC              SECTION.
      *
           IF      SPA-HKNKBN          =   1
      *        Ï«ºÒ¤Î»þ¤Î½èÍý
               PERFORM 1000-SANTEI-RSI-SEC
               GO      TO      100-SANTEI-CHK-EXT
           END-IF
      *
      *    ¼õ¿ÇÍúÎò¤è¤ê¿Ç»¡²ó¿ô¤òµá¤á¤ë
           PERFORM 1000-SINSATU-KAISU-SEC
      *
      *    Åö·î»»Äê²ó¿ô¤òµá¤á¤ë
           PERFORM 1001-TOUGETU-KAISU-SEC
      *
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡¦¾®»ù¤«¤«¤ê¤Ä¤±¤òºÆ¿Ç¤ØÀÚÂØ¤¨
           IF     (SPA-SYONIKA-ARI     =   9   )
              OR  (SPA-SYONIKKR-ARI    =   9   )
      *       Æþ±¡¡¦½¢³Ø¸åÂÐ¾Ý³°
              OR  (SPA-NYUGAIKBN       =   "1" )
              OR  (SPA-SYUGAKUKBN      =   ZERO)
               MOVE    ZERO                TO  SPA-SYONIKA-ARI3
               MOVE    ZERO                TO  SPA-SYONIKA-ARI2
               MOVE    ZERO                TO  SPA-SYONIKA-ARI
               MOVE    ZERO                TO  SPA-SYONIKKR-ARI3
               MOVE    ZERO                TO  SPA-SYONIKKR-ARI2
               MOVE    ZERO                TO  SPA-SYONIKKR-ARI
               GO      TO      100-SANTEI-CHK-EXT
           END-IF
      *    Êñ³ç¤Þ¤È¤á¡¦¼£¸³¡¡¼«Æ°ÂÐ¾Ý³°
           IF      (SPA-HKNCOMBINUM     =   "9999")
               OR  (SPA-CHIKENKBN       =   "1"   )
               MOVE    ZERO                TO  SPA-SYONIKA-ARI3
               MOVE    ZERO                TO  SPA-SYONIKKR-ARI3
               GO      TO      100-SANTEI-CHK-EXT
           END-IF
      *
      *    ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅÈ½Äê¡¡½¢³ØÁ°¤Î¤ß
           IF     (SPA-SYUGAKUKBN      =   1   )
              AND (FLG-SYONIKKR-NAI    =   ZERO )
               PERFORM 1001-SYONIKKR-CHK-SEC
           END-IF
      *
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê
           IF     (SPA-SYONIKA         =   1    )
             AND  (WRK-ZAITAKU-CNT     =   ZERO )
             AND  (FLG-SYONIKA-NAI     =   ZERO )
             AND  (SPA-SYONIKKR-ARI3   =   ZERO )
               PERFORM 1001-SYONIKA-CHK-SEC
           ELSE
               MOVE    ZERO                TO  SPA-SYONIKA-ARI2
               MOVE    ZERO                TO  SPA-SYONIKA-ARI
           END-IF
      *
           .
       100-SANTEI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼õ¿ÇÍúÎò¤è¤ê¿Ç»¡²ó¿ô¤òµá¤á¤ë½èÍý
      *****************************************************************
       1000-SINSATU-KAISU-SEC          SECTION.
      *
           MOVE    ZERO                TO  SPA-SINSATU-CNT
           MOVE    ZERO                TO  FLG-15MIMAN
           MOVE    ZERO                TO  SPA-15MIMAN-ARI
      *    ÅöÆü»»Äê²ó¿ô
           MOVE    ZERO                TO  WRK-DAY-SINSATUCNT
      *    ÅöÆü¿Ç»¡ÎÁ»»ÄêÍ­Ìµ
           MOVE    ZERO                TO  SPA-DOUJITU
      *    ¿·µ¬¤Î»þ¡¢¼õ¿Ç¤Ê¤·
           IF      SPA-SYOYMD          =   SPACE
           AND    (SPA-SYOSIN          =   1     )
               GO      TO      1000-SINSATU-KAISU-EXT
           END-IF
      *H24.4
      *    £±£µºÐ¤Ë¤Ê¤ëÇ¯·îÆü¤ò·×»»
           MOVE    SPA-BIRTHDAY        TO  WRK-BIRTHDAY
           COMPUTE WRK-BIRTH-YY        =   WRK-BIRTH-YY    +  15
           MOVE    SPA-BIRTHDAY        TO  WRK-BIRTHDAY03
           COMPUTE WRK-BIRTH-YY03      =   WRK-BIRTH-YY03  +  3 
      *
      *    ÅöÆü¤Ë¿ÇÎÅ¤¬¤¢¤ë»þ¤Î¤ß
           MOVE    ZERO                TO  FLG-DOUJITU-ARI
           PERFORM VARYING     IDX2    FROM    1   BY  1
                   UNTIL       IDX2    >   SPA-GMN-MAX1
      *        £±£µºÐÅþÃ£·î¤Ë£±£µºÐ¤Þ¤Ç¤Î¼õ¿Ç¤¢¤ê
               IF     (SPA-SRYYMD(1:6)     =   WRK-BIRTHDAY(1:6))
                  AND (SPA-NAI-RRKYMD(IDX2)(1:6)
                                           =   WRK-BIRTHDAY(1:6))
                  IF      (SPA-NAI-RRKYMD(IDX2)    <   WRK-BIRTHDAY)
                    AND   (FLG-15MIMAN             =   ZERO    )
                       MOVE    1               TO  SPA-15MIMAN-ARI
                       MOVE    1               TO  FLG-15MIMAN
                  END-IF
               END-IF
      *        £³ºÐÅþÃ£·î¤Ë£³ºÐ¤Þ¤Ç¤Î¼õ¿Ç¤¢¤ê
               IF     (SPA-SRYYMD(1:6)     =   WRK-BIRTHDAY03(1:6))
                  AND (SPA-NAI-RRKYMD(IDX2)(1:6)
                                           =   WRK-BIRTHDAY03(1:6))
                  IF      (SPA-NAI-RRKYMD(IDX2)    <   WRK-BIRTHDAY03)
                    AND   (FLG-15MIMAN             =   ZERO    )
                       MOVE    2               TO  SPA-15MIMAN-ARI
                       MOVE    1               TO  FLG-15MIMAN
                  END-IF
               END-IF
      *        ÅöÆü¼õ¿Ç¤¢¤ê
               IF      SPA-NAI-RRKYMD(IDX2)    =   SPA-SRYYMD
                   MOVE    1                   TO  FLG-DOUJITU-ARI
               ELSE
                   IF      SPA-NAI-RRKYMD(IDX2)(1:6)
                                               <   SPA-SRYYMD(1:6)
      *                Åö·îÊ¬°Ê³°¤Ï½ªÎ»
                       MOVE    SPA-GMN-MAX1    TO  IDX2
                   END-IF
               END-IF
           END-PERFORM
           IF      FLG-DOUJITU-ARI     =   ZERO
               GO      TO      1000-SINSATU-KAISU-EXT
           END-IF
      *H24.4
      *!
      *
      *    ¼õ¿ÇÍúÎò¤è¤êÅöÆü¤Î¼õ¿Ç²ó¿ô¤òµá¤á¤ë
           MOVE    SPACE               TO  JYURRK-REC
           INITIALIZE                  JYURRK-KEY
           MOVE    SPA-HOSPNUM         TO  JYURRK-HOSPNUM
           MOVE    SPA-NYUGAIKBN       TO  JYURRK-NYUGAIKBN
           MOVE    SPA-PTID            TO  JYURRK-PTID
      *    ¿ÇÎÅÆü¤Î¤ß
           MOVE    SPA-SRYYMD          TO  JYURRK-SRYYMD
           MOVE    SPA-SRYYMD          TO  JYURRK-UPSRYYMD
      *
           MOVE    JYURRK-REC          TO  MCPDATA-REC
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
           MOVE    "key14"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key14"             TO  MCP-PATHNAME
               PERFORM 970-JYURRK-READ-SEC
           ELSE
               MOVE    SPACE               TO  JYURRK-REC
               INITIALIZE                  JYURRK-REC
               MOVE    1               TO  FLG-JYURRK
           END-IF
           PERFORM
                   UNTIL    FLG-JYURRK     =   1
               IF      JYURRK-RENNUM       =   1
                   MOVE    ZERO            TO  FLG-SYONIKA
               END-IF
               MOVE    ZERO                TO  FLG-CHK
               MOVE    ZERO                TO  FLG-CHK2
      *        ÊÝ¸±¤Ë¤è¤êÂÐ¾Ý¤ò·èÄê¤¹¤ë
               PERFORM 10000-HKNKBN-CHK-SEC
      *********MOVE    ZERO                TO  FLG-CHK
               IF     (FLG-CHK             =   ZERO  )
      *            ÅöÆü¤Î»þ¤Ï¡¢Á´Éô
                  OR  (SPA-SRYYMD          =   JYURRK-SRYYMD)
      *            ¼õ¿ÇÍúÎò¤ËÆ±ÆüÂ¾²Ê»»Äê¤¬¤Ê¤¤¤³¤È
                   PERFORM 10001-DOUJI-CHK-SEC
               END-IF
      *
               IF     (JYURRK-EDANUM       =   1   )  AND
                      (JYURRK-DOUJI-RENNUM =   1  OR  ZERO )
                   CONTINUE
               ELSE
                   MOVE    1               TO  FLG-CHK
               END-IF
      *        ÄûÀµ¤Î»þ¡¢ÄûÀµÊ¬¤Ï¥«¥¦¥ó¥È¤·¤Ê¤¤
               IF      SPA-SYORIFLG        =   1
                   IF      (SPA-SRYYMD         =   JYURRK-SRYYMD) AND
                           (SPA-SRYKA          =   JYURRK-SRYKA ) AND
                           (SPA-RENNUM         =   JYURRK-RENNUM) AND
                           (SPA-DOUJI-RENNUM   =   JYURRK-DOUJI-RENNUM)
                       MOVE    1               TO  FLG-CHK
                       MOVE    1               TO  FLG-CHK2
                   END-IF
      *            ÄûÀµ¤Î»þ¡¢ÄûÀµÊ¬¤Ï°Ê¹ß¥«¥¦¥ó¥È¤·¤Ê¤¤
                   IF      (SPA-SRYYMD         =   JYURRK-SRYYMD) AND
                           (SPA-SRYKA          =   JYURRK-SRYKA ) AND
                           (SPA-RENNUM         <   JYURRK-RENNUM)
                       MOVE    1               TO  FLG-CHK
                       MOVE    1               TO  FLG-CHK2
                   END-IF
               END-IF
      *
      *        ¼õ¿Ç²ó¿ô
               IF      FLG-CHK         =   ZERO
                   ADD     1               TO  SPA-SINSATU-CNT
               END-IF
      *        ÅöÆü»»Äê²ó¿ô
               IF     (FLG-CHK2        =   ZERO )  AND
                      (FLG-SINSATU2    =   1    )
                   ADD     1                   TO  WRK-DAY-SINSATUCNT
      *            ÅöÆü¿Ç»¡ÎÁ»»ÄêÍ­Ìµ
                   ADD     1                   TO  SPA-DOUJITU
               END-IF
               MOVE    "key14"             TO  MCP-PATHNAME
               PERFORM 970-JYURRK-READ-SEC
           END-PERFORM
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
           MOVE    "key14"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *!!!!!
      *    ½é¿Ç»»ÄêÆü¤¬¤Ê¤¯¡¢ÅöÆü¤Î¼õ¿Ç¤¬¤Ê¤¤»þ¡¢½é¿ÇÎÁ»»Äê¤Ø
           IF     (SPA-SYORIFLG        =   ZERO  )
           AND    (SPA-SYOYMD          =   SPACE )
           AND    (SPA-SYOSIN          =   ZERO  )
               IF     (SPA-DOUJITU     =   ZERO  )
                   MOVE    1               TO  SPA-SYOSIN
               END-IF
           END-IF
           .
       1000-SINSATU-KAISU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÂÐ¾ÝÊÝ¸±·èÄê½èÍý
      *****************************************************************
       10000-HKNKBN-CHK-SEC            SECTION.
      *
           MOVE    ZERO                TO  FLG-CHK
           EVALUATE    SPA-HKNKBN
              WHEN     ZERO
                  IF      JYURRK-HKNKBN        =   ZERO  OR  SPACE
                       CONTINUE
                  ELSE
                       MOVE    1               TO  FLG-CHK
                  END-IF
              WHEN     2
      *           ¸ø³²
                  IF      JYURRK-HKNKBN        =   "6"
                       CONTINUE
                  ELSE
                       MOVE    1               TO  FLG-CHK
                  END-IF
              WHEN     1
      *           ¼«ÇåÀÕ
                  IF      SPA-RSI-HKNKBN       =   "4"
      *D                                       OR  "5"
                      IF      JYURRK-HKNKBN        =   "2"
                                                   OR  "4"
                           CONTINUE
                      ELSE
                           MOVE    1               TO  FLG-CHK
                      END-IF
                  ELSE
      *           Ï«ºÒ
                      IF      JYURRK-HKNKBN        =   "1"
                                                   OR  "5"
                           CONTINUE
                      ELSE
                           MOVE    1               TO  FLG-CHK
                      END-IF
                  END-IF
           END-EVALUATE
      *
           .
       10000-HKNKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼õ¿ÇÍúÎò¤ËÆ±ÆüÂ¾²Ê»»Äê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       10001-DOUJI-CHK-SEC                  SECTION.
      *
           IF      JYURRK-SRYKBN (01)      =   "01"
               CONTINUE
           ELSE
               MOVE    1                   TO  FLG-CHK
               GO      TO      10001-DOUJI-CHK-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-SINSATU
           MOVE    ZERO                TO  FLG-SINSATU2
           MOVE    ZERO                TO  FLG-SYOSIN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   15  )  OR
                              (FLG-SINSATU         =   1     )  OR
                              (JYURRK-ZAINUM (IDX) =   ZERO  )
      *
               MOVE    SPACE               TO  SRYACT-REC
               INITIALIZE                  SRYACT-REC
               MOVE    SPA-HOSPNUM         TO  SRY-HOSPNUM
               MOVE    SPA-NYUGAIKBN       TO  SRY-NYUGAIKBN
               MOVE    JYURRK-PTID         TO  SRY-PTID
               MOVE    JYURRK-SRYKA        TO  SRY-SRYKA
               MOVE    JYURRK-SRYYMD(1:6)  TO  SRY-SRYYM
               MOVE    JYURRK-ZAINUM (IDX)
                                           TO  SRY-ZAINUM
      *
               MOVE    SRYACT-REC          TO  MCPDATA-REC
               MOVE    "tbl_sryact"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 910-DBSELECT-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    "key2"              TO  MCP-PATHNAME
                   PERFORM 930-SRYACT-READ-SEC
                ELSE
                   INITIALIZE                  SRYACT-REC
                   MOVE    1               TO  FLG-SRYACT
               END-IF
      *
      *        ¼«Èñ¤ÏÂÐ¾Ý³°¤È¤¹¤ë
               IF      SRY-SRYKBN          =   "95"
                                           OR  "96"
                   MOVE    1                   TO  FLG-SRYACT
               END-IF
      *
               PERFORM
                       UNTIL  (FLG-SRYACT      =   1     )  OR
                              (FLG-SINSATU     =   1     )
                   PERFORM VARYING     IDY     FROM    1   BY  1
                           UNTIL   (IDY        >   5   )  OR
                                   (FLG-SINSATU          =   1     )  OR
                                   (SRY-SRYCD (IDY)      =   SPACE )
      **************** IF      SPA-HKNKBN          =   ZERO
                       IF      JYURRK-HKNKBN       =   ZERO
      *                    ·òÊÝ½àµòÊ¬
                                                   OR  "4"
                                                   OR  "5"
      *                    ¸ø³²
                                                   OR  "6"
      *ver.4.7             Âè»°¼Ô¹Ô°Ù
                                                   OR  "7"
      *                    °ìÈÌ
                           PERFORM 100011-IPN-DOUJI-CHK-SEC
                       ELSE
      *                    Ï«ºÒÅù
                           PERFORM 100011-RSI-DOUJI-CHK-SEC
                       END-IF
                   END-PERFORM
      *
                   MOVE    "key2"              TO  MCP-PATHNAME
                   PERFORM 930-SRYACT-READ-SEC
               END-PERFORM
               MOVE    "tbl_sryact"        TO  MCP-TABLE
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 990-DBCLOSE-SEC
      *
           END-PERFORM
      *
           IF    ((FLG-SINSATU         =   1   )  OR
                  (FLG-SYONIKA         =   1   ))  AND
                  (FLG-SYOSIN          =   ZERO )
               MOVE    ZERO            TO  FLG-CHK
           ELSE
               MOVE    1               TO  FLG-CHK
           END-IF
      *
      *    ½é¿ÇÎÁ»»Äê»þ¡¢²ó¿ô¤ò¥¯¥ê¥¢¤¹¤ë
           IF      FLG-SYOSIN          =   1
               MOVE    ZERO            TO  SPA-SINSATU-CNT
           END-IF
      *
           .
       10001-DOUJI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    °ìÈÌÆ±ÆüÂ¾²Ê»»Äê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       100011-IPN-DOUJI-CHK-SEC        SECTION.
      *
      *    ¿Ç»¡ÎÁ¸¡º÷
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
               AT   END
                   MOVE    ZERO               TO  FLG-ARI
                   MOVE    SPACE              TO  WRK-KBN
                   MOVE    SPACE              TO  WRK-KBN2
                   MOVE    ZERO               TO  WRK-KAISU
               WHEN   SRY-SRYCD (IDY)     =   TBL-SRYCD (TBL-IDX)
                   MOVE    1                  TO  FLG-ARI
                   MOVE    TBL-KBN  (TBL-IDX) TO  WRK-KBN
                   MOVE    TBL-KBN2 (TBL-IDX) TO  WRK-KBN2
                   MOVE    TBL-KAISU(TBL-IDX) TO  WRK-KAISU
           END-SEARCH
      *
           IF      FLG-ARI         =   1
               MOVE    1               TO  FLG-SINSATU
      *        ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¤¢¤ê
               IF      WRK-KAISU       =   2
                   MOVE    1           TO  FLG-SYONIKA
               END-IF
      *        ¾®»ù¤«¤«¤ê¤Ä¤±
               IF      WRK-KAISU       =   4
                   MOVE    1           TO  FLG-SYONIKKR
               END-IF
           ELSE
               EVALUATE    SRY-SRYCD (IDY)
      *            ºßÂð´µ¼ÔË¬Ìä¿Ç»¡ÎÁ
                   WHEN    "114001110"
      *            ºßÂð´µ¼ÔË¬Ìä¿Ç»¡ÎÁ¡Ê½»µï·Ï»ÜÀßÆþµï¼Ô¡Ë
                   WHEN    "114012910"
      *H24.4
      *            ºßÂð´µ¼ÔË¬Ìä¿Ç»¡ÎÁ¡ÊÆ±°ì·úÊª¡Ë¡ÊÆÃÄê»ÜÀßÆþµï¡Ë
                   WHEN    "114018010"
      *H28.4
      *            ºßÂð´µ¼ÔË¬Ìä¿ÇÎÅÎÁ¡ÊÆ±°ì·úÊª½»µï¼Ô¡Ë
                   WHEN    "114030310"
      *            ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ
                   WHEN    "114007610"
                   WHEN    "114007710"
      *H24.4
      *            ºßÂð¤¬¤ó°åÁí¹ç
                   WHEN    "114019510"
                   WHEN    "114019710"
                   WHEN    "114019610"
                   WHEN    "114019810"
      *H30.4
      *            ÃÏ°èÊñ³ç¿ÇÎÅÎÁ
                   WHEN    CONS-CHIKIHKT1
                   WHEN    CONS-CHIKIHKT2
      *H30.4
      *            Ç§ÃÎ¾ÉÃÏ°èÊñ³ç¿ÇÎÅÎÁ
                   WHEN    CONS-NNCHIHKT1
                   WHEN    CONS-NNCHIHKT2
                       MOVE    1               TO  FLG-SINSATU
      *            £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁ
                   WHEN    "099110001"
                   WHEN    "099120001"
                       MOVE    1               TO  FLG-SINSATU
               END-EVALUATE
      *        °Ê³°¤ÎÈ½Äê
               IF     (SRY-SRYCD (IDY)(1:1)    =   "1" )  OR
                      (FLG-SINSATU             =   ZERO )
                   PERFORM 1000112-SIDOU-CHK-SEC
               END-IF
           END-IF
      *    ½é¿ÇÎÁ¤Ï»»Äê³°¤È¤¹¤ë
           IF     (SRY-SRYKBN          =   "11" )  OR
                  (SRY-SRYCD(IDY)      =   "113003510"  OR
                                           "113003710" )
              OR  (SRY-SRYCD(IDY)      =   "113019710" 
                                       OR  "113019910" )
               MOVE    1               TO  FLG-SYOSIN
           END-IF
      *
           IF      FLG-SINSATU         =   1
               MOVE    1               TO  FLG-SINSATU2
           END-IF
      *
           .
       100011-IPN-DOUJI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒÅùÆ±ÆüÂ¾²Ê»»Äê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       100011-RSI-DOUJI-CHK-SEC                  SECTION.
      *
      *    ¿Ç»¡ÎÁ¸¡º÷
           SET     TBL-RSI              TO  1
           SEARCH  TBL-RSI-SINSATU-OCC  VARYING   TBL-RSI
              AT   END
                   MOVE    ZERO               TO  FLG-ARI
                   MOVE    ZERO               TO  WRK-KAISU
                   MOVE    SPACE              TO  WRK-KBN
               WHEN    SRY-SRYCD (IDY)    =   TBLR-SRYCD (TBL-RSI)
                   MOVE    1                  TO  FLG-ARI
                   MOVE    TBLR-KAISU (TBL-RSI)   TO  WRK-KAISU
                   MOVE    TBLR-KBN   (TBL-RSI)   TO  WRK-KBN
           END-SEARCH
      ***  IF      WRK-KBN             =   "S"  OR  "F"
      *        MOVE    1              TO  FLG-ARI
      *    ELSE
      *        MOVE    ZERO           TO  FLG-ARI
      **** END-IF
      *
           IF      FLG-ARI             =   1
               MOVE    1               TO  FLG-SINSATU
           ELSE
      *
      *        °ìÈÌ¤Î¿Ç»¡ÎÁ¤ò¸¡º÷¤¹¤ë¡ÊÅÅÏÃºÆ¿ÇÅù¡Ë
               SET     TBL-IDX             TO  1
               SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                   AT   END
                       MOVE    ZERO           TO  FLG-ARI
                   WHEN   SRY-SRYCD (IDY)     =   TBL-SRYCD (TBL-IDX)
      **************   IF      TBL-KBN (TBL-IDX)  =   "T" OR
      *************                                   "S"
                           MOVE    1               TO  FLG-ARI
                           MOVE    1               TO  FLG-SINSATU
      ***************  ELSE
      *                    MOVE    ZERO            TO  FLG-ARI
      ***************  END-IF
               END-SEARCH
      *
               EVALUATE    SRY-SRYCD (IDY)
      *            £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁ
                   WHEN    "099110001"
                   WHEN    "099120001"
                       MOVE    1               TO  FLG-SINSATU
               END-EVALUATE
      *        °Ê³°¤ÎÈ½Äê
               IF     (SRY-SRYCD (IDY)(1:1)    =   "1" )  OR
                      (FLG-SINSATU             =   ZERO )
                   PERFORM 1000112-SIDOU-CHK-SEC
               END-IF
           END-IF
      *
           IF      FLG-SINSATU         =   1
               MOVE    1               TO  FLG-SINSATU2
           END-IF
      *
      *    ½é¿ÇÎÁ¤Ï»»Äê³°¤È¤¹¤ë
           IF     (SRY-SRYKBN          =   "11" )  AND
                  (FLG-SINSATU         =   1    )
               MOVE    1               TO  FLG-SYOSIN
           END-IF
      *
      *    È¯¾ÉÆü¤«¤é£³·î°ÊÆâ¤ÏÂÐ¾Ý³°¤È¤¹¤ë
           IF      JYURRK-SRYYMD       <   WRK-HASSYOYMD
               MOVE    1               TO  FLG-CHK
               MOVE    ZERO            TO  FLG-SINSATU
           END-IF
           .
       100011-RSI-DOUJI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿Ç»¡ÎÁÊñ³ç¤ÎÈ½Äê½èÍý
      *****************************************************************
       1000112-SIDOU-CHK-SEC          SECTION.
      *
           MOVE    SRY-SRYCD (IDY)     TO  TNS-SRYCD
           PERFORM 910-TENSU-READ-SEC
           IF      FLG-TENSU           =   ZERO
      *    ¼ÂÆü¿ô¡¢Æü¿ô¡¦²ó¿ôÈ½Äê
               IF     (TNS-JITUDAY         =   2  )  AND
                      (TNS-DAYCNT          =   2  )
                   MOVE    1               TO  FLG-SINSATU
               END-IF
           END-IF
      *
           .
       1000112-SIDOU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Åö·î»»Äê²ó¿ô¤òµá¤á¤ë½èÍý
      *****************************************************************
       1001-TOUGETU-KAISU-SEC          SECTION.
      *
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁ²ó¿ô¥Á¥§¥Ã¥¯
           MOVE    ZERO                TO  WRK-NYUYOJI
           MOVE    ZERO                TO  WRK-DAYCNT-SUM
      *H28.5
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁÅö·î»»Äê¥Á¥§¥Ã¥¯
           MOVE    ZERO                TO  SPA-15MIMAN-ARI
      *H28.4
      *    ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅÎÁ²ó¿ô¥Á¥§¥Ã¥¯
           MOVE    ZERO                TO  WRK-SYOUNI
           MOVE    ZERO                TO  WRK-SYOUNI-SUM
      *    ºßÂðÎÅÍÜ»ØÆ³ÎÁ»»Äê
           MOVE    ZERO                TO  WRK-ZAITAKU-CNT
      *    ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê
           MOVE    ZERO                TO  SPA-NETAKIRI-ARI
           MOVE    ZERO                TO  SPA-NETAKIRI-ARI2
      *    ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ
           MOVE    ZERO                TO  SPA-ZAIMATU-ARI
           MOVE    ZERO                TO  SPA-ZAIMATU-ARI2
      *    À¸³è½¬´·ÉÂ
           MOVE    ZERO                TO  SPA-SEIKATU-ARI
           MOVE    ZERO                TO  SPA-SEIKATU-ARI2
           MOVE    ZERO                TO  SPA-SEIKATU-CHK
      *    ËýÀ­áÖÄË¼ÀÉÂ´ÉÍýÎÁ
           MOVE    ZERO                TO  SPA-TOKUTEI-KNJ2
      *    ÃÔÊò´µ¼ÔºßÂð»ØÆ³´ÉÍýÎÁ¡Ê³°Íè²Ã»»ÉÕ²Ã»»ÄêÉÕ²Ã¡Ë
           MOVE    ZERO                TO  SPA-GAIRAI-NASI
      *    ¾Ã±êÄÃÄËÅù½èÃÖ
           MOVE    ZERO                TO  SPA-SYOEN-CNT
           MOVE    ZERO                TO  SPA-TOKUTEI-CNT
      *    ºßÂð»þ°å³ØÁí¹ç´ÉÍýÎÁ
           MOVE    ZERO                TO  SPA-ZAIKANRI-ARI
           MOVE    ZERO                TO  SPA-ZAIKANRI-ARI2
      *
      *    ¸å´ü¹âÎð¼Ô¿ÇÎÅÎÁ
      *H24.4 ¤«¤é³°Íè¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥ó¿Ç»¡ÎÁ¤ËÎ®ÍÑ
      *    £±¡§³°Íè¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥ó¿Ç»¡ÎÁ£±
      *    £²¡§³°Íè¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥ó¿Ç»¡ÎÁ£²
      *    £³¡§³°ÍèÊü¼ÍÀþ¾È¼Í¿Ç»¡ÎÁ¡¡¡¡¡ÊÊ»ÍÑ»»Äê¤Ç¤­¤Ê¤¤¤³¤È¤¬Á°Äó¡Ë
           MOVE    ZERO                TO  SPA-KOURESRY-ARI
           MOVE    ZERO                TO  SPA-KOURESRY-ARI2
           MOVE    SPACE               TO  WRK-LAST-DAY1
           MOVE    SPACE               TO  WRK-LAST-DAY2
           MOVE    SPACE               TO  WRK-LAST-DAY3
      *
           MOVE    ZERO                TO  SPA-IGAKUKAN-ARI
           MOVE    ZERO                TO  SPA-IGAKUKAN-ARI2
      *H26.4
      *    ÃÏ°èÊñ³ç¿ÇÎÅÎÁ¤Î»»Äê¶èÊ¬
           MOVE    ZERO                TO  SPA-CHKHKT-ARI
           MOVE    ZERO                TO  SPA-CHKHKT-ARI2
      *    Ç§ÃÎ¾ÉÃÏ°èÊñ³ç¿ÇÎÅÎÁ¤Î»»Äê¶èÊ¬
           MOVE    ZERO                TO  SPA-NNCHKT-ARI
           MOVE    ZERO                TO  SPA-NNCHKT-ARI2
      *    ¥ª¥ó¥é¥¤¥ó¿ÇÎÅÎÁ
           MOVE    ZERO                TO  SPA-ONLINE-ARI
           MOVE    ZERO                TO  SPA-ONLINE-ARI2
      *
      *    Êñ³ç¤Þ¤È¤áÆþÎÏÂÐ¾Ý³°
           IF      SPA-HKNCOMBINUM     =   "9999"
      *       ¼£¸³
              OR  (SPA-CHIKENKBN       =   "1"  )
               GO      TO      1001-TOUGETU-KAISU-EXT
           END-IF
      *
      *    µÞÀ­È¯À¸Æü·èÄê
           PERFORM 10019-KYUSEI-CHK-SEC
           INITIALIZE                  WRK-RIHA-KAN-G
      *
      *    »»ÄêÍúÎò¸¡º÷
           MOVE    SPACE               TO  SANTEI-REC
           INITIALIZE                  SANTEI-REC
           MOVE    SPA-HOSPNUM         TO  SANTEI-HOSPNUM
           MOVE    SPA-PTID            TO  SANTEI-PTID
           MOVE    SPA-SRYYMD (1:6)    TO  SANTEI-SRYYM
      *
           MOVE    SANTEI-REC          TO  MCPDATA-REC
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SANTEI
           END-IF
      *
           PERFORM
               UNTIL       FLG-SANTEI      =   1
      *
               IF      SANTEI-MSANTEICNT   >   ZERO
      *            Åö·î»»ÄêÊ¬
                   PERFORM 10011-TOUGETU-CHK-SEC
               END-IF
      *
               MOVE    "key2"              TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           END-PERFORM
      *
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key2"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *H24.4 ²þÀµ
      *    ³°Íè¥ê¥Ï¥Ó¥ê¿Ç»¡ÎÁÅù»»ÄêÈ½Äê
           PERFORM 10019-GAIRAIRIHA-CHK-SEC
      *
      *H28.9 ²þÀµ
      *    ÌÜÉ¸ÀßÄêÅù»Ù±ç´ÉÍýÎÁÈ½Äê
           PERFORM 100110-MOKUHYO-CHK-SEC
           .
       1001-TOUGETU-KAISU-EXT.
           EXIT.
      *
      *****************************************************************
      *    Åö·î»»ÄêÊ¬½èÍý
      *****************************************************************
       10011-TOUGETU-CHK-SEC                  SECTION.
      *
      *    ÊÝ¸±Ëè¤Î¥³¡¼¥É¤ÎÈ½Äê
           MOVE    SANTEI-SRYCD        TO  WRK-SRYCD
           PERFORM 1000-SANTEI-CHK-SEC
           IF      FLG-HKNSAN          =   1
      *        °ìÈÌ¤ÎÊÝ¸±¤Çº£²ó¤¬Ï«ºÒ¤Î»þÂÐ¾Ý³°
               IF      (SANTEI-HKNCOMBINUM     =   ZERO )  AND
                       (SPA-HKNKBN             =   1
                                               OR  2     )
                   GO      TO      10011-TOUGETU-CHK-EXT
               END-IF
      *        Ï«ºÒ¤ÎÊÝ¸±¤Çº£²ó¤¬°ìÈÌ
               IF      (SANTEI-HKNCOMBINUM NOT =   ZERO )  AND
                       (SPA-HKNKBN             =   ZERO )
                   GO      TO      10011-TOUGETU-CHK-EXT
               END-IF
      *        Ï«ºÒ¤ÎÊÝ¸±¤Çº£²ó¤¬Ï«ºÒ¤Î»þÈ½Äê
               IF      (SANTEI-HKNCOMBINUM NOT =   ZERO )  AND
                       (SPA-HKNKBN             =   1
                                               OR  2    )  AND
                       (SANTEI-HKNCOMBINUM NOT =   SPA-HKNCOMBINUM)
                   GO      TO      10011-TOUGETU-CHK-EXT
               END-IF
           END-IF
      *!!!!
      *    ¥¢¥Õ¥¿¡¼¥±¥¢¤ÏÂÐ¾Ý³°
           IF      SPA-RSI-HKNKBN      =   "3"
               GO      TO      10011-TOUGETU-CHK-EXT
           END-IF
      *!!!!
      *
      *    ¾å¸Â£±Æü
           MOVE    ZERO                TO  WRK-DAYCNT
           IF     (SPA-SRYYMD(7:2)     NUMERIC   )  AND
                  (SPA-SRYYMD(7:2)     >   ZERO  )
               MOVE    SPA-SRYYMD(7:2)     TO  IDX-Y2
               MOVE    SANTEI-DAY (IDX-Y2) TO  WRK-DAYCNT
           END-IF
      *
      *    ÄûÀµ¤Î»þ¡¢ÄûÀµÊ¬¤Ï¥«¥¦¥ó¥È¤·¤Ê¤¤
           IF      SPA-SYORIFLG        =   1
      *        ÄûÀµ¤Î»þ¡¢»»Äê¤·¤Æ¤¤¤¿¿ÇÎÅ¥³¡¼¥É¤«¤Î¥Á¥§¥Ã¥¯
               MOVE    ZERO                TO  WRK-TEI-KAISU
               PERFORM VARYING     IDX-T   FROM    1   BY  1
                       UNTIL      (IDX-T       >   SPA-MAX-LINE  )  OR
                                  (SPA-K02-TEI-SRYCD(IDX-T)  =   SPACE)
                   IF      SPA-K02-TEI-SRYCD(IDX-T)    =   SANTEI-SRYCD
                       MOVE    SPA-K02-TEI-KAISU (IDX-T)
                                                   TO  WRK-TEI-KAISU
                       MOVE    SPA-MAX-LINE            TO  IDX-T
                   END-IF
               END-PERFORM
               MOVE    SPA-SRYYMD(7:2)     TO  IDX-Y2
               IF     (SANTEI-DAY (IDX-Y2) >   ZERO )  AND
                      (SANTEI-MSANTEICNT   >   ZERO )
                   IF      WRK-TEI-KAISU   =   ZERO
                       CONTINUE
                   ELSE
                       COMPUTE SANTEI-MSANTEICNT
                                           =   SANTEI-MSANTEICNT
                                           -   WRK-TEI-KAISU
                       MOVE    ZERO                TO  WRK-DAYCNT
                   END-IF
               END-IF
           END-IF
      *
      *    ¾Ã±êÄÃÄË½èÃÖ¤Î»þ¡¢ÄûÀµÆü¤Þ¤Ç¤Î²ó¿ô¤È¤¹¤ë
           MOVE    ZERO                TO  WRK-SYOEN-CNT
      *    µÞÀ­È¯À¸Æü°ÊÁ°¤ÏÂÐ¾Ý³°
           IF     (SPA-KYUSEI-YMD  NOT =   SPACE )  AND
                  (SPA-KYUSEI-YMD(1:6) =   SPA-SRYYMD(1:6))
               MOVE    SPA-KYUSEI-YMD(7:2)     TO  IDX-STR
           ELSE
               MOVE    1                       TO  IDX-STR
           END-IF
      *
           IF      SPA-SYORIFLG        =   1
               MOVE    SPA-SRYYMD(7:2)     TO  IDX-Y2
           ELSE
               MOVE    32                  TO  IDX-Y2
           END-IF
           PERFORM VARYING     IDX-Y3  FROM  IDX-STR  BY  1
                   UNTIL       IDX-Y3  >=    IDX-Y2
               ADD     SANTEI-DAY (IDX-Y3)
                                           TO  WRK-SYOEN-CNT
           END-PERFORM
      *
      *H24.4 ²þÀµ
      *    Ä¾¶á¤Î»»ÄêÆü¡Ê³°Íè¥ê¥Ï¥Ó¥ê¿Ç»¡ÎÁ¡Ë
           MOVE    SPA-SRYYMD(7:2)     TO  IDX-Y2
           IF      SPA-SYORIFLG        =   1
      *        ÄûÀµ¤ÏÁ°Æü¤Þ¤Ç
               COMPUTE IDX-Y2          =   IDX-Y2   -  1
           END-IF
           MOVE    SPACE               TO  WRK-LAST-DAY
           PERFORM VARYING     IDX-Y3  FROM  1   BY  1
                   UNTIL       IDX-Y3  >     IDX-Y2
               IF      SANTEI-DAY (IDX-Y3) >   ZERO
                   MOVE    IDX-Y3          TO  WRK-RDD
                   MOVE    WRK-RDD         TO  WRK-LAST-DD
                   MOVE    SANTEI-SRYYM    TO  WRK-LAST-YM
               END-IF
           END-PERFORM
      *!
      *    ºßÂð»þ°å³ØÁí¹ç´ÉÍýÎÁÅùÈ½Äê¡Êºß°åÁí´É¡¦ÆÃ°åÁí´É¡Ë
           SET     TBL-ZSIDX           TO  1
           SEARCH  TBL-ZISOSIN-OCC     VARYING   TBL-ZSIDX
              AT   END
                   MOVE    SPACE                   TO  WRK-ZS-KBN
                   MOVE    SPACE                   TO  WRK-ZS-GRP
               WHEN   (TBL-ZS-SRYCD (TBL-ZSIDX)    =   SANTEI-SRYCD) 
                   MOVE    TBL-ZS-GRP (TBL-ZSIDX)  TO  WRK-ZS-GRP
                   MOVE    TBL-ZS-KBN (TBL-ZSIDX)  TO  WRK-ZS-KBN
           END-SEARCH
           EVALUATE    WRK-ZS-GRP(1:1)
           WHEN    "0"
      *    ºßÂð»þ°å³ØÁí¹ç´ÉÍýÎÁ»»Äê¡Êºß°åÁí´É¡Ë
               IF      SPA-ZAIKANRI-ARI2   NOT =   2
      *            ½èÊý¤»¤óÍ­¡Ê±¡³°¡Ë
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    1                   TO  SPA-ZAIKANRI-ARI2
                   END-IF
               END-IF
           WHEN    "1"
      *    ÆÃÄê»ÜÀßÆþµï»þ°å³ØÁí¹ç´ÉÍýÎÁ¡ÊÆÃ°åÁí´É¡Ë
               IF      SPA-IGAKUKAN-ARI2   NOT =   2
      *            ½èÊý¤»¤óÍ­¡Ê±¡³°¡Ë
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    1                   TO  SPA-IGAKUKAN-ARI2
                   END-IF
               END-IF
           WHEN    "2"
      *    ºßÂð¤¬¤ó°åÁí¹ç
               IF      SPA-SYORIFLG        =   1
      *        ÄûÀµ»þ¤ÏÅöÆüÊ¬¤ÎÊÔ½¸¤Ê¤·
                   CONTINUE
               ELSE
      *        ÅöÆü¤Î»»Äê
                   MOVE    SPA-SRYYMD(7:2)     TO  IDX-Y2
                   IF      WRK-ZS-KBN          =   "1"
      *            ½èÊý¤»¤óÍ­¡Ê±¡³°¡Ë
                       IF      SANTEI-DAY (IDX-Y2) >   ZERO
                           MOVE    1               TO  SPA-ZAIMATU-ARI2
                       END-IF
                   ELSE
      *            ½èÊý¤»¤óÌµ¡Ê±¡Æâ¡Ë
                       IF      SANTEI-DAY (IDX-Y2) >   ZERO
                           MOVE    2               TO  SPA-ZAIMATU-ARI2
                       END-IF
                   END-IF
               END-IF
           END-EVALUATE
      *
           EVALUATE    SANTEI-SRYCD
      *        ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê
               WHEN    "113003510"
               WHEN    "113003610"
               WHEN    "113003710"
               WHEN    "113003810"
                   ADD     SANTEI-MSANTEICNT   TO  WRK-NYUYOJI
                   ADD     WRK-DAYCNT          TO  WRK-DAYCNT-SUM
      *H28.5
      *            ¾®»ù²Ê³°Íè¿ÇÎÅÎÁÅöÆü»»Äê¤¢¤ê
                   IF     (SPA-SYONIKA         =   ZERO )
                    AND   (WRK-DAYCNT-SUM      >   ZERO )
                       MOVE    1               TO  SPA-SYONIKA
                   END-IF
      *            ¾®»ù²Ê³°Íè¿ÇÎÅÎÁÅö·î»»Äê¥Á¥§¥Ã¥¯
                   IF     (WRK-NYUYOJI          >   ZERO )
                       MOVE    2               TO  SPA-15MIMAN-ARI
                   END-IF
      *H28.4
      *        ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅ²Ê
               WHEN    "113019710"
               WHEN    "113019910"
               WHEN    "113019810"
               WHEN    "113020010"
                   ADD     SANTEI-MSANTEICNT   TO  WRK-SYOUNI
                   ADD     WRK-DAYCNT          TO  WRK-SYOUNI-SUM
      *H24.4
      *        ¹â·ì°µ¾É
               WHEN    "113003910"
               WHEN    "113004010"
      *        ¹â»é·ì¾É
               WHEN    "113005810"
               WHEN    "113006010"
      *        ÅüÇ¢ÉÂ
               WHEN    "113005910"
               WHEN    "113006110"
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    1                   TO  SPA-SEIKATU-ARI
                       MOVE    1                   TO  SPA-SEIKATU-ARI2
                   END-IF
      *        ÃÔÊò´µ¼ÔºßÂð»ØÆ³´ÉÍýÎÁ
               WHEN    "113700310"
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    1               TO  SPA-GAIRAI-NASI
                   END-IF
      *
      *        ËýÀ­áÖÄË¼ÀÉÂ´ÉÍýÎÁ
               WHEN    "113006510"
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    1               TO  SPA-TOKUTEI-KNJ2
                   END-IF
      *            ½é²ó»»ÄêÆü¤è¤êÁ°¤Î»»Äê¤Ï¤Ê¤·¤È¤¹¤ë
                   IF    (SANTEI-FSANTEIYMD(1:6)
                                               =   SPA-SRYYMD(1:6))
                     AND (SANTEI-FSANTEIYMD    >   SPA-SRYYMD )
                       MOVE    ZERO            TO  SPA-TOKUTEI-KNJ2
                   END-IF
      *
      *        ´ï¶ñÅù¤Ë¤è¤ëÎÅË¡
               WHEN    "140040310"
      *        ¼¾ÉÛ½èÃÖ£±
               WHEN    "140002210"
      *        ¼¾ÉÛ½èÃÖ£²
               WHEN    "140002310"
                   ADD     WRK-SYOEN-CNT       TO  SPA-SYOEN-CNT
      *        ²ðÃ£¸£°ú
               WHEN    "140048010"
                   ADD     WRK-SYOEN-CNT       TO  SPA-SYOEN-CNT
      *H18/04¤«¤é
      *        ²ðÃ£¸£°ú¡Ê¶ºÀµ¸ÇÄê¡Ë
               WHEN    "140030350"
                   ADD     WRK-SYOEN-CNT       TO  SPA-SYOEN-CNT
      *        ²ðÃ£¸£°ú¡ÊÊÑ·Áµ¡³£¶ºÀµ½Ñ¡Ë
               WHEN    "140048250"
                   ADD     WRK-SYOEN-CNT       TO  SPA-SYOEN-CNT
      *        ¹øÉô¸ÇÄêÂÓ¸ÇÄê
               WHEN    "140048350"
                   ADD     WRK-SYOEN-CNT       TO  SPA-SYOEN-CNT
      *        ¶»Éô¸ÇÄêÂÓ¸ÇÄê
               WHEN    "140048450"
                   ADD     WRK-SYOEN-CNT       TO  SPA-SYOEN-CNT
      *        Äã½ÐÎÏ¥ì¡¼¥¶¾È¼Í
               WHEN    "140048550"
                   ADD     WRK-SYOEN-CNT       TO  SPA-SYOEN-CNT
      *        æêÌç½èÃÖ
               WHEN    "140002450"
                   ADD     WRK-SYOEN-CNT       TO  SPA-SYOEN-CNT
      *¤Þ¤Ç
      *!!
      *        ÆÃÄê¼À´µÎÅÍÜ»ØÆ³ÎÁ
               WHEN    "113001910"
               WHEN    "113002010"
               WHEN    "113001810"
                   ADD     WRK-SYOEN-CNT       TO  SPA-TOKUTEI-CNT
      *!!
      *H24.4 ²þÀµ
      *        ³°Íè¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥ó¿Ç»¡ÎÁ
               WHEN    "113013910"
                   MOVE    WRK-LAST-DAY        TO  WRK-LAST-DAY1
               WHEN    "113014010"
                   MOVE    WRK-LAST-DAY        TO  WRK-LAST-DAY2
      *        ³°ÍèÊü¼ÍÀþ¾È¼Í¿Ç»¡ÎÁ
               WHEN    "113014110"
                   MOVE    WRK-LAST-DAY        TO  WRK-LAST-DAY3
      *H30.4
      *        ÃÏ°èÊñ³ç¿ÇÎÅÎÁ
               WHEN    CONS-CHIKIHKT1
               WHEN    CONS-CHIKIHKT2
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    1                   TO  SPA-CHKHKT-ARI2
                   END-IF
      *H30.4
      *        Ç§ÃÎ¾ÉÃÏ°èÊñ³ç¿ÇÎÅÎÁ
               WHEN    CONS-NNCHIHKT1
               WHEN    CONS-NNCHIHKT2
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    1                   TO  SPA-NNCHKT-ARI2
                   END-IF
      *H30.4
      *        ¥ª¥ó¥é¥¤¥ó¿ÇÎÅÎÁ
               WHEN    CONS-ONLINE01
                   IF      SANTEI-MSANTEICNT   >   ZERO
                       MOVE    1                   TO  SPA-ONLINE-ARI2
                   END-IF
      *ÍúÎòºîÀ®¤Ê¤·
      ***      ½èÊý¤»¤óÌµ¸òÉÕ²Ã»»¡ÊºßÂð»þ°å¡Ë¡ÊC002-00)
      *        WHEN    CONS-C0020-KSN
      *            IF      SANTEI-MSANTEICNT   >   ZERO
      *                MOVE    2                   TO  SPA-ZAIKANRI-ARI2
      *            END-IF
      *        ½èÊý¤»¤óÌµ¸òÉÕ²Ã»»¡Ê»Ü°åÁí´É¡Ë¡ÊC002-02)
      *        WHEN    CONS-C0022-KSN
      *            IF      SANTEI-MSANTEICNT   >   ZERO
      *                MOVE    2                   TO  SPA-IGAKUKAN-ARI2
      *            END-IF
      *!!
      *        ºßÂðÎÅÍÜ»ØÆ³ÎÁ¤ÎÈ½Äê
               WHEN    OTHER
                   IF      SANTEI-SRYCD(1:3)   =   "114"
                       MOVE    SANTEI-SRYCD        TO  TNS-SRYCD
                       PERFORM 9101-TENSU-READ2-SEC
                       IF      (FLG-TENSU          =   ZERO ) AND
                               (TNS-CDKBN-KBN      =   "C"  ) AND
                               (TNS-CDKBN-KBNNUM   >=  "100" AND
                                                   <=  "112")
                           ADD     SANTEI-MSANTEICNT
                                               TO  WRK-ZAITAKU-CNT
                       END-IF
                   END-IF
           END-EVALUATE
           .
       10011-TOUGETU-CHK-EXT.
           EXIT.
      *
      *!!
      *H24.4 ²þÀµ
      *****************************************************************
      *    ³°Íè¥ê¥Ï¥Ó¥ê¿Ç»¡ÎÁÅù»»ÄêÈ½Äê½èÍý
      *****************************************************************
       10019-GAIRAIRIHA-CHK-SEC            SECTION.
      *
           IF     (WRK-LAST-DAY1       =   SPACE)  AND
                  (WRK-LAST-DAY2       =   SPACE)  AND
                  (WRK-LAST-DAY3       =   SPACE)
      *        Á°·îÍúÎò¤Î»»Äê
               IF      SPA-SRYYMD(1:6)     >   "201204"
                   PERFORM 100191-GAIRAIRIHA-ZEN-SEC
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  FLG-KIKAN
           MOVE    ZERO                TO  WRK-KIKAN
           MOVE    SPACE               TO  WRK-KIKAN-DAY
           MOVE    WRK-LAST-DAY1       TO  WRK-KIKAN-DAY
           MOVE    7                   TO  WRK-KIKAN
      *
           IF      WRK-KIKAN-DAY       <   WRK-LAST-DAY2
      *        ³°Íè¥ê¥Ï¥Ó¥ê¿Ç»¡ÎÁ£²¤¬ºÇ½ª
               MOVE    WRK-LAST-DAY2       TO  WRK-KIKAN-DAY
               MOVE    14                  TO  WRK-KIKAN
           END-IF
           IF      WRK-KIKAN-DAY       <   WRK-LAST-DAY3
      *        ³°ÍèÊü¼ÍÀþ¾È¼Í¿Ç»¡ÎÁ¤¬ºÇ½ª
               MOVE    WRK-LAST-DAY3       TO  WRK-KIKAN-DAY
               MOVE    7                   TO  WRK-KIKAN
               MOVE    1                   TO  FLG-KIKAN
           END-IF
      *
           IF      WRK-KIKAN-DAY   NOT =   SPACE
      *        ¿Ç»¡ÎÁÊñ³çÆü·×»»
               INITIALIZE                      STS-AREA-DAY
               INITIALIZE                      LNK-DAY6-AREA
               MOVE    "61"                TO  LNK-DAY6-IRAI
               MOVE    WRK-KIKAN-DAY       TO  LNK-DAY6-KIJUN
               MOVE    "1"                 TO  LNK-DAY6-ZOGENPTN
               MOVE    WRK-KIKAN           TO  LNK-DAY6-ZOGEN
               CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
      *TEST
      *          DISPLAY "SC10 LNK-DAY6-KEISAN:"  LNK-DAY6-KEISAN
      *TEST
               IF      LNK-DAY6-KEISAN     >   SPA-SRYYMD
      *            ³°Íè¥ê¥Ï¿Ç»¡ÎÁÅù»»ÄêÃæ¡Ê¸å´ü¹âÎð¼Ô¿ÇÎÅÎÁ¤Î¶èÊ¬¤Ë¡Ë
                   MOVE    2                   TO  SPA-KOURESRY-ARI2
                   IF      FLG-KIKAN           =   1
      *                ³°ÍèÊü¼ÍÀþ¾È¼Í¿Ç»¡ÎÁ»»Äê
                       MOVE    3                   TO  SPA-KOURESRY-ARI2
                   END-IF
               END-IF
           END-IF
           .
       100112-RIHABI-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼À´µÊÌ¥ê¥Ï¥Ó¥ê°å³Ø´ÉÍýÎÁÈ½Äê½èÍý
      *****************************************************************
       100191-GAIRAIRIHA-ZEN-SEC            SECTION.
      *
      *    Á°·îÊ¬¸¡º÷
           MOVE    SPA-SRYYMD          TO  WRK-YMD
           COMPUTE WRK-MM              =   WRK-MM   -  1
           IF      WRK-MM              =   ZERO
               MOVE    12                  TO  WRK-MM
               COMPUTE WRK-YY              =   WRK-YY  -   1
           END-IF
      *    ³°Íè¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥ó¿Ç»¡ÎÁ
           MOVE    "113013910"         TO  WRK-SRYCD
           PERFORM 1001912-SANTEI-KEN-SEC
           IF      WRK-LAST-DAY    NOT =   SPACE
               MOVE    WRK-LAST-DAY        TO  WRK-LAST-DAY1
           END-IF
      *
           MOVE    "113014010"         TO  WRK-SRYCD
           PERFORM 1001912-SANTEI-KEN-SEC
           IF      WRK-LAST-DAY    NOT =   SPACE
               MOVE    WRK-LAST-DAY        TO  WRK-LAST-DAY2
           END-IF
      *    ³°ÍèÊü¼ÍÀþ¾È¼Í¿Ç»¡ÎÁ
           MOVE    "113014110"         TO  WRK-SRYCD
           PERFORM 1001912-SANTEI-KEN-SEC
           IF      WRK-LAST-DAY    NOT =   SPACE
               MOVE    WRK-LAST-DAY        TO  WRK-LAST-DAY3
           END-IF
      *
           .
       100191-GAIRAIRIHA-ZEN-EXT.
           EXIT.
      *****************************************************************
      *    ³°Íè¥ê¥Ï¥Ó¥êÁ°·îÊ¬½èÍý
      *****************************************************************
       1001912-SANTEI-KEN-SEC            SECTION.
      *
      *    »»ÄêÍúÎò¸¡º÷
           MOVE    SPACE               TO  SANTEI-REC
           INITIALIZE                  SANTEI-REC
           MOVE    SPA-HOSPNUM         TO  SANTEI-HOSPNUM
           MOVE    SPA-PTID            TO  SANTEI-PTID
           MOVE    WRK-SRYCD           TO  SANTEI-SRYCD
           MOVE    ZERO                TO  SANTEI-NYUGAIKBN
           MOVE    ZERO                TO  SANTEI-SRYKA
           MOVE    WRK-YYMM            TO  SANTEI-SRYYM
           MOVE    ZERO                TO  SANTEI-HKNCOMBINUM
      *
           MOVE    SANTEI-REC          TO  MCPDATA-REC
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SANTEI
               INITIALIZE                  SANTEI-REC
           END-IF
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
      *    Ä¾¶á¤Î»»ÄêÆü
           MOVE    SPACE               TO  WRK-LAST-DAY
           PERFORM VARYING     IDX-Y3  FROM  31  BY  -1
                   UNTIL      (IDX-Y3  <     1   )
                          OR  (FLG-SANTEI    =   1   )
               IF      SANTEI-DAY (IDX-Y3) >   ZERO
                   MOVE    IDX-Y3          TO  WRK-RDD
                   MOVE    WRK-RDD         TO  WRK-LAST-DD
                   MOVE    SANTEI-SRYYM    TO  WRK-LAST-YM
                   MOVE    1               TO  IDX-Y3
               END-IF
           END-PERFORM
           .
       1001912-SANTEI-KEN-EXT.
           EXIT.
      *H24.4 ²þÀµ
      *!!
      *H28.9
      *****************************************************************
      *    ÌÜÉ¸ÀßÄêÅù»Ù±ç´ÉÍýÎÁÈ½Äê½èÍý
      *****************************************************************
       100110-MOKUHYO-CHK-SEC        SECTION.
      *
      *    ÌÜÉ¸ÀßÄêÅù»Ù±ç´ÉÍýÎÁ¡Ê½é²ó¡Ë
           MOVE    "180046110"         TO  WRK-SRYCD
           PERFORM 1001101-SANTEI-YMD-SEC
           IF      WRK-YMD             =   ZERO
               MOVE    SPACE               TO  SPA-MOKUHYO01-YMD
           ELSE
               MOVE    WRK-YMD             TO  SPA-MOKUHYO01-YMD
           END-IF
      *    ÌÜÉ¸ÀßÄêÅù»Ù±ç´ÉÍýÎÁ¡Ê£²²óÌÜ°Ê¹ß¡Ë
           MOVE    "180046210"         TO  WRK-SRYCD
           PERFORM 1001101-SANTEI-YMD-SEC
           IF      WRK-YMD             =   ZERO
               MOVE    SPACE               TO  SPA-MOKUHYO02-YMD
           ELSE
               MOVE    WRK-YMD             TO  SPA-MOKUHYO02-YMD
           END-IF
      *
      *
           .
       100110-MOKUHYO-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÇ½ª»»ÄêÆü½èÍý
      *****************************************************************
       1001101-SANTEI-YMD-SEC         SECTION.
      *
      *    ÄûÀµÊ¬¤ÏÂÐ¾Ý³°
           MOVE    ZERO                TO  FLG-TEISEI
           IF      SPA-SYORIFLG        =   1
               PERFORM VARYING     IDX     FROM    1   BY  1
                       UNTIL      (IDX     >   SPA-MAX-LINE )  OR
                                  (SPA-K02-TEI-SRYCD(IDX)
                                               =   SPACE )
                   IF      WRK-SRYCD       =   SPA-K02-TEI-SRYCD(IDX)
                       MOVE    1               TO  FLG-TEISEI
                   END-IF
               END-PERFORM
           END-IF
      *
      *    »»ÄêÍúÎò¸¡º÷
           MOVE    SPACE               TO  SANTEI-REC
           INITIALIZE                  SANTEI-REC
           MOVE    SPA-HOSPNUM         TO  SANTEI-HOSPNUM
           MOVE    SPA-PTID            TO  SANTEI-PTID
           MOVE    WRK-SRYCD           TO  SANTEI-SRYCD
           MOVE    ZERO                TO  SANTEI-NYUGAIKBN
           MOVE    ZERO                TO  SANTEI-SRYKA
           MOVE    SPA-SRYYMD(1:6)     TO  SANTEI-SRYYM
      *
      *    ´µ¼ÔËè¤È¤¹¤ë
           MOVE    ZERO                TO  SANTEI-HKNCOMBINUM
      *
           MOVE    SANTEI-REC          TO  MCPDATA-REC
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key15"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key15"             TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SANTEI
           END-IF
      *
           MOVE    ZERO                TO  WRK-YMD
           PERFORM
               UNTIL       FLG-SANTEI      =   1
      *
               IF     (SANTEI-MSANTEICNT   >   ZERO )  AND
                      (SANTEI-SRYYM        <=  SPA-SRYYMD(1:6))
      *            ºÇ¸å¤ÎÈ¯À¸Æü¡¢ÅöÆü°Ê¹ß¤ÏÂÐ¾Ý³°
                   IF      SANTEI-SRYYM        =   SPA-SRYYMD(1:6)
                       MOVE    SPA-SRYYMD(7:2)     TO  IDX-Y3
                   ELSE
                       MOVE    31                  TO  IDX-Y3
                   END-IF
                   MOVE    ZERO                TO  WRK-DD
                   PERFORM VARYING     IDX-Y2  FROM    IDX-Y3  BY  -1
                           UNTIL       IDX-Y2  <   1
                       IF      SANTEI-DAY (IDX-Y2) >   ZERO
                           MOVE    IDX-Y2          TO  WRK-DD
                           MOVE    1               TO  IDX-Y2
                       END-IF
                   END-PERFORM
                   IF      WRK-DD              >   ZERO
                       MOVE    SANTEI-SRYYM    TO  WRK-YYMM
                       MOVE    1               TO  FLG-SANTEI
      *                ÄûÀµÊ¬¤ÏÂÐ¾Ý³°
                       IF     (FLG-TEISEI          =   1 )
                          AND (WRK-YMD             =   SPA-SRYYMD)
                           MOVE    ZERO            TO  FLG-SANTEI
                           MOVE    ZERO            TO  WRK-YMD
                       END-IF
                   END-IF
               END-IF
      *
               IF     FLG-SANTEI           =   ZERO
                   MOVE    "tbl_santei"        TO  MCP-TABLE
                   MOVE    "key15"             TO  MCP-PATHNAME
                   PERFORM 920-SANTEI-READ-SEC
               END-IF
           END-PERFORM
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key15"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           IF      WRK-YYMM            =   ZERO
               MOVE    ZERO            TO  WRK-YMD
           END-IF
      *
           .
       1001101-SANTEI-YMD-EXT.
           EXIT.
      *!!! 
      *****************************************************************
      *    µÞÀ­È¯À¸Æü·èÄê½èÍý
      *****************************************************************
       10019-KYUSEI-CHK-SEC            SECTION.
      *
           MOVE    ZERO                TO  SPA-KYUSEI-FLG
           MOVE    SPACE               TO  SPA-KYUSEI-180
           MOVE    SPACE               TO  SPA-KYUSEI-90
           MOVE    SPACE               TO  SPA-KYUSEI-YMD
           MOVE    SPACE               TO  SPA-GMN-KYUSEI
      *!!!!
      *    ³Æ¥ê¥Ï¥Ó¥êÈ¯¾ÉÆü
           PERFORM 100193-RIHABIRI-YMDHEN-SEC
      *!!!!
      *    ÄûÀµ¤Î»þÅöÆü¤Ê¤é¡¢ÂÐ¾Ý³°
           IF      SPA-SYORIFLG        =   1
               IF      SPA-KYUSEI-END      =   SPA-SRYYMD
                   MOVE    SPACE               TO  SPA-KYUSEI-END
               END-IF
           END-IF
           IF     (SPA-KYUSEI-YMD          =   SPACE         )  OR
                  (SPA-KYUSEI-END          <=  SPA-KYUSEI-YMD)
               MOVE    SPACE               TO  SPA-KYUSEI-END
           END-IF
      *
           IF     (SPA-KYUSEI-YMD  NOT =   SPACE )  AND
                 ((SPA-KYUSEI-YMD      >   SPA-KYUSEI-END)  OR
                  (SPA-KYUSEI-END      =   SPA-SRYYMD    ))
               PERFORM 100192-KYUSEI-HENSYU-SEC
           END-IF
      *
      *    µÞÀ­È¯À¸Æü¤¬½ýÉÂÆü¤è¤ê¸å¤Î¾ì¹ç¡¢µÞÀ­È¯À¸Æü¤«¤é£¶¥ö·î¸å¤È¤¹¤ë
           IF     (SPA-HKNKBN          =   1        )  AND
                  (SPA-RSI-SHOBYOYMD   NOT =   SPACE ) AND
                  (SPA-RSI-SHOBYOYMD   <   SPA-KYUSEI-YMD )
               MOVE    SPA-KYUSEI-YMD      TO  WRK-HASSYOYMD
               COMPUTE WRK-HAS-MM          =   WRK-HAS-MM
                                           +   6
               IF      WRK-HAS-MM          >   12
                   COMPUTE WRK-HAS-MM      =   WRK-HAS-MM    -   12
                   COMPUTE WRK-HAS-YY      =   WRK-HAS-YY    +   1
               END-IF
               MOVE    WRK-HASSYOYMD       TO  SPA-RSI-SHOBYOYMD3
           END-IF
      *
      *
           .
       10019-KYUSEI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    µÞÀ­È¯À¸Æü»»ÄêÆü½èÍý
      *****************************************************************
       100192-KYUSEI-HENSYU-SEC                  SECTION.
      *
      *    180Æü¸å·×»»
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY6-AREA
           MOVE    "61"                TO  LNK-DAY6-IRAI
           MOVE    SPA-KYUSEI-YMD      TO  LNK-DAY6-KIJUN
           MOVE    "1"                 TO  LNK-DAY6-ZOGENPTN
           MOVE    180                 TO  LNK-DAY6-ZOGEN
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY6-AREA
           MOVE    LNK-DAY6-KEISAN     TO  SPA-KYUSEI-180
      *
      *    90Æü¸å
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY6-AREA
           MOVE    "61"                TO  LNK-DAY6-IRAI
           MOVE    SPA-KYUSEI-YMD      TO  LNK-DAY6-KIJUN
           MOVE    "1"                 TO  LNK-DAY6-ZOGENPTN
           MOVE    90                  TO  LNK-DAY6-ZOGEN
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY6-AREA
           MOVE    LNK-DAY6-KEISAN     TO  SPA-KYUSEI-90
      *
      *    ²èÌÌÉ½¼¨ÍÑ
           MOVE    SPACE               TO  WRK-HENSYU-AREA
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY2-AREA
           MOVE    "21"                TO  LNK-DAY2-IRAI
           MOVE    SPA-KYUSEI-YMD      TO  LNK-DAY2-YMD
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY2-AREA
           MOVE    LNK-DAY2-EDTYMD1    TO  WRK-KYUSEI-YMD
      *
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY2-AREA
           MOVE    "21"                TO  LNK-DAY2-IRAI
           MOVE    SPA-KYUSEI-90       TO  LNK-DAY2-YMD
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY2-AREA
           MOVE    LNK-DAY2-EDTYMD1    TO  WRK-KYUSEI-90
      *
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY2-AREA
           MOVE    "21"                TO  LNK-DAY2-IRAI
           MOVE    SPA-KYUSEI-180      TO  LNK-DAY2-YMD
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY2-AREA
           MOVE    LNK-DAY2-EDTYMD1    TO  WRK-KYUSEI-180
      *
           STRING   "µÞÀ­È¯¾ÉÆü¡§"     DELIMITED  BY  SIZE
                   WRK-KYUSEI-YMD      DELIMITED  BY  SIZE
                   "¡¡£¹£°Ä¶¡§"        DELIMITED  BY  SIZE
                   WRK-KYUSEI-90       DELIMITED  BY  SIZE
                   "¡¡£±£¸£°Ä¶¡§"      DELIMITED  BY  SIZE
                   WRK-KYUSEI-180      DELIMITED  BY  SIZE
                   INTO                SPA-GMN-KYUSEI
           END-STRING
      *
           .
       100192-KYUSEI-HENSYU-EXT.
           EXIT.
      *!!!!
      *
      *****************************************************************
      *    ³Æ¥ê¥Ï¥Ó¥êÈ¯¾ÉÆüÊÔ½¸½èÍý
      *****************************************************************
       100193-RIHABIRI-YMDHEN-SEC                  SECTION.
      *
           INITIALIZE                  SPA-GMN-RIHAYMD-TBL
      *    »»ÄêÍúÎò¸¡º÷
           MOVE    SPACE               TO  SANTEI-REC
           INITIALIZE                  SANTEI-REC
           MOVE    SPA-HOSPNUM         TO  SANTEI-HOSPNUM
           MOVE    SPA-PTID            TO  SANTEI-PTID
           MOVE    "099800%"           TO  SANTEI-SRYCD
           MOVE    ZERO                TO  SANTEI-NYUGAIKBN
           MOVE    ZERO                TO  SANTEI-SRYKA
           MOVE    SPA-SRYYMD(1:6)     TO  SANTEI-SRYYM
      *
      *    Ï«ºÒËè¤È¤¹¤ë
           IF      SPA-HKNKBN          =   1
                                       OR  2
               MOVE    SPA-HKNCOMBINUM     TO  SANTEI-HKNCOMBINUM
           ELSE
               MOVE    ZERO                TO  SANTEI-HKNCOMBINUM
           END-IF
      *
           MOVE    SANTEI-REC          TO  MCPDATA-REC
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key16"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key16"             TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SANTEI
           END-IF
      *
           INITIALIZE                  WRK-RIHABIR-AREA
           PERFORM
               UNTIL       FLG-SANTEI      =   1
      *        ºÇ¸å¤ÎÈ¯À¸Æü¡¢ÅöÆü°Ê¹ß¤ÏÂÐ¾Ý³°
               MOVE    ZERO                TO  WRK-YMD
               IF      SANTEI-SRYYM        =   SPA-SRYYMD(1:6)
                   MOVE    SPA-SRYYMD(7:2)     TO  IDX-Y3
               ELSE
                   MOVE    31                  TO  IDX-Y3
               END-IF
               MOVE    ZERO                TO  WRK-DD
               PERFORM VARYING     IDX-Y2  FROM    IDX-Y3  BY  -1
                       UNTIL       IDX-Y2  <   1
                   IF      SANTEI-DAY (IDX-Y2) >   ZERO
                       MOVE    IDX-Y2          TO  WRK-DD
                       PERFORM 1001932-RIHA-SANTEIHEN-SEC
                       IF      FLG-CHK-END     =   1
                           MOVE    1               TO  IDX-Y2
                       END-IF
                   END-IF
               END-PERFORM
      *
               MOVE    "tbl_santei"        TO  MCP-TABLE
               MOVE    "key16"             TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           END-PERFORM
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key16"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           MOVE    ZERO                TO  IDX-R
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   10   )
                         OR   (IDX-R   >=  7   )
      *
      *        ÄûÀµ¤Ç½ªÎ»Æü¤¬ÅöÆü¤Ê¤é¡¢ÂÐ¾Ý³°
               IF      SPA-SYORIFLG        =   1
                   IF      WRK-RIHA-END (IDX)   =   SPA-SRYYMD
                       MOVE    SPACE            TO  WRK-RIHA-END (IDX) 
                   END-IF
               END-IF
      *
               IF      WRK-RIHA-STR (IDX)  NOT =   SPACE
                   IF     (WRK-RIHA-END (IDX)  =   SPACE)
                   OR     (WRK-RIHA-STR (IDX)  >   WRK-RIHA-END(IDX))
                       MOVE    WRK-RIHA-STR (IDX)
                                               TO  WRK-RIHA-STR2(IDX)
      *                ¥ê¥Ï¥Ó¥êÈ¯¾ÉÆüÊÔ½¸
                       PERFORM 1001931-RIHA-HENKAN-SEC
                   END-IF
               END-IF
           END-PERFORM
           .
       100193-RIHABIRI-YMDHEN-EXT.
           EXIT.
      *****************************************************************
      *    ¥ê¥Ï¥Ó¥êÈ¯¾ÉÆüÊÔ½¸½èÍý
      *****************************************************************
       1001932-RIHA-SANTEIHEN-SEC                  SECTION.
      *
           MOVE    SANTEI-SRYYM        TO  WRK-YYMM
           MOVE    1                   TO  FLG-CHK-END
           EVALUATE    SANTEI-SRYCD
      *        Ç¾·ì´É¼À´µµÞÀ­È¯À¸Æü
               WHEN    "099800101"
                   IF      SPA-KYUSEI-YMD          =   SPACE
                       MOVE    WRK-YMD             TO  SPA-KYUSEI-YMD
                   END-IF
      *        Ç¾·ì´É¼À´µµÞÀ­È¯À¸½ªÎ»Æü
               WHEN    "099800102"
                   IF      SPA-KYUSEI-END          =   SPACE
                       MOVE    WRK-YMD             TO  SPA-KYUSEI-END
                   END-IF
      *        ¿´Âç·ì´É¼À´µ¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥ó
               WHEN    "099800111"
                   IF      WRK-RIHA-STR(1)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-STR(1)
      *                ½ªÎ»Æü¸¡º÷
                       PERFORM 1001931-SANTEIPLUS-CHK-SEC
                       IF      WRK-ENDYMD      NOT =   SPACE
                           MOVE    SPACE           TO  WRK-RIHA-STR(1)
                           MOVE    ZERO            TO  FLG-CHK-END
                       END-IF
                   END-IF
               WHEN    "099800112"
                   IF      WRK-RIHA-END(1)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-END(1)
                   END-IF
      *        Ç¾·ì´É¼À´µ¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥ó
               WHEN    "099800121"
                   IF      WRK-RIHA-STR(2)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-STR(2)
      *                ½ªÎ»Æü¸¡º÷
                       PERFORM 1001931-SANTEIPLUS-CHK-SEC
                       IF      WRK-ENDYMD      NOT =   SPACE
                           MOVE    SPACE           TO  WRK-RIHA-STR(2)
                           MOVE    ZERO            TO  FLG-CHK-END
                       END-IF
                   END-IF
               WHEN    "099800122"
                   IF      WRK-RIHA-END(2)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-END(2)
                   END-IF
      *        ±¿Æ°´ï¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥ó
               WHEN    "099800131"
                   IF      WRK-RIHA-STR(3)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-STR(3)
      *                ½ªÎ»Æü¸¡º÷
                       PERFORM 1001931-SANTEIPLUS-CHK-SEC
                       IF      WRK-ENDYMD      NOT =   SPACE
                           MOVE    SPACE           TO  WRK-RIHA-STR(3)
                           MOVE    ZERO            TO  FLG-CHK-END
                       END-IF
                   END-IF
               WHEN    "099800132"
                   IF      WRK-RIHA-END(3)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-END(3)
                   END-IF
      *        ¸ÆµÛ´ï¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥ó
               WHEN    "099800141"
                   IF      WRK-RIHA-STR(4)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-STR(4)
      *                ½ªÎ»Æü¸¡º÷
                       PERFORM 1001931-SANTEIPLUS-CHK-SEC
                       IF      WRK-ENDYMD      NOT =   SPACE
                           MOVE    SPACE           TO  WRK-RIHA-STR(4)
                           MOVE    ZERO            TO  FLG-CHK-END
                       END-IF
                   END-IF
               WHEN    "099800142"
                   IF      WRK-RIHA-END(4)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-END(4)
                   END-IF
      *        ÀÝ¿©µ¡Ç½ÎÅË¡½ªÎ»Æü
               WHEN    "099800151"
                   IF      WRK-RIHA-STR(5)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-STR(5)
      *                ½ªÎ»Æü¸¡º÷
                       PERFORM 1001931-SANTEIPLUS-CHK-SEC
                       IF      WRK-ENDYMD      NOT =   SPACE
                           MOVE    SPACE           TO  WRK-RIHA-STR(5)
                           MOVE    ZERO            TO  FLG-CHK-END
                       END-IF
                   END-IF
               WHEN    "099800152"
                   IF      WRK-RIHA-END(5)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-END(5)
                   END-IF
      *        ÆñÉÂ´µ¼Ô¥ê¥Ï¥Ó¥ê
               WHEN    "099800161"
                   IF      WRK-RIHA-STR(6)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-STR(6)
      *                ½ªÎ»Æü¸¡º÷
                       PERFORM 1001931-SANTEIPLUS-CHK-SEC
                       IF      WRK-ENDYMD      NOT =   SPACE
                           MOVE    SPACE           TO  WRK-RIHA-STR(6)
                           MOVE    ZERO            TO  FLG-CHK-END
                       END-IF
                   END-IF
               WHEN    "099800162"
                   IF      WRK-RIHA-END(6)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-END(6)
                   END-IF
      *        ¾ã³²¼Ô¥ê¥Ï¥Ó¥ê
               WHEN    "099800171"
                   IF      WRK-RIHA-STR(7)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-STR(7)
      *                ½ªÎ»Æü¸¡º÷
                       PERFORM 1001931-SANTEIPLUS-CHK-SEC
                       IF      WRK-ENDYMD      NOT =   SPACE
                           MOVE    SPACE           TO  WRK-RIHA-STR(7)
                           MOVE    ZERO            TO  FLG-CHK-END
                       END-IF
                   END-IF
               WHEN    "099800172"
                   IF      WRK-RIHA-END(7)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-END(7)
                   END-IF
      *        ¤¬¤ó´µ¼Ô¥ê¥Ï¥Ó¥ê
               WHEN    "099800181"
                   IF      WRK-RIHA-STR(8)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-STR(8)
      *                ½ªÎ»Æü¸¡º÷
                       PERFORM 1001931-SANTEIPLUS-CHK-SEC
                       IF      WRK-ENDYMD      NOT =   SPACE
                           MOVE    SPACE           TO  WRK-RIHA-STR(8)
                           MOVE    ZERO            TO  FLG-CHK-END
                       END-IF
                   END-IF
               WHEN    "099800182"
                   IF      WRK-RIHA-END(8)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-END(8)
                   END-IF
      *H28.4
      *        ÇÑÍÑ¾É¸õ·²¥ê¥Ï¥Ó¥ê
               WHEN    "099800191"
                   IF      WRK-RIHA-STR(9)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-STR(9)
      *                ½ªÎ»Æü¸¡º÷
                       PERFORM 1001931-SANTEIPLUS-CHK-SEC
                       IF      WRK-ENDYMD      NOT =   SPACE
                           MOVE    SPACE           TO  WRK-RIHA-STR(9)
                           MOVE    ZERO            TO  FLG-CHK-END
                       END-IF
                   END-IF
               WHEN    "099800192"
                   IF      WRK-RIHA-END(9)         =   SPACE
                       MOVE    WRK-YMD             TO  WRK-RIHA-END(9)
                   END-IF
           END-EVALUATE
           .
       1001932-RIHA-SANTEIHEN-EXT.
           EXIT.
      *****************************************************************
      *    ¥ê¥Ï¥Ó¥êÈ¯¾ÉÆüÊÔ½¸½èÍý
      *****************************************************************
       1001931-RIHA-HENKAN-SEC                  SECTION.
      *
           MOVE    ZERO                TO  WRK-ZOGEN
           EVALUATE    IDX
               WHEN     1
                   MOVE    150                     TO  WRK-ZOGEN
                   MOVE    "¿´Âç·ì´É¼À´µ¥ê¥Ï³«»ÏÆü¡§"  TO  WRK-RIHAMEI
                   MOVE    "£±£µ£°ÆüÄ¶¡§"              TO  WRK-ZOGEN-MEI
               WHEN    2
                   MOVE    180                     TO  WRK-ZOGEN
                   MOVE    "Ç¾·ì´É¼À´µ¥ê¥Ï³«»ÏÆü¡§"    TO  WRK-RIHAMEI
                   MOVE    "£±£¸£°ÆüÄ¶¡§"              TO  WRK-ZOGEN-MEI
               WHEN    3
                   MOVE    150                     TO  WRK-ZOGEN
                   MOVE    "±¿Æ°´ï¥ê¥Ï³«»ÏÆü¡§"    TO  WRK-RIHAMEI
                   MOVE    "£±£µ£°ÆüÄ¶¡§"          TO  WRK-ZOGEN-MEI
               WHEN    4
                   MOVE    90                      TO  WRK-ZOGEN
                   MOVE    "¸ÆµÛ´ï¥ê¥Ï³«»ÏÆü¡§"    TO  WRK-RIHAMEI
                   MOVE    "£¹£°ÆüÄ¶¡§"            TO  WRK-ZOGEN-MEI
               WHEN    5
                   MOVE    0                       TO  WRK-ZOGEN
                   MOVE    "ÀÝ¿©µ¡Ç½ÎÅË¡³«»ÏÆü¡§"  TO  WRK-RIHAMEI
               WHEN    6
                   MOVE    0                       TO  WRK-ZOGEN
                   MOVE    "ÆñÉÂ´µ¼Ô¥ê¥Ï³«»ÏÆü¡§"  TO  WRK-RIHAMEI
               WHEN    7
                   MOVE    0                       TO  WRK-ZOGEN
                   MOVE    "¾ã³²»ù¡Ê¼Ô¡Ë¥ê¥Ï³«»ÏÆü¡§"  TO  WRK-RIHAMEI
               WHEN    8
                   MOVE    0                       TO  WRK-ZOGEN
                   MOVE    "¤¬¤ó´µ¼Ô¥ê¥Ï³«»ÏÆü¡§"  TO  WRK-RIHAMEI
               WHEN    9
                   MOVE    "ÇÑÍÑ¾É¸õ·²¥ê¥Ï³«»ÏÆü¡§"    TO  WRK-RIHAMEI
                   IF      WRK-RIHA-STR2(IDX)      >=  "20160401"
                       MOVE    120                     TO  WRK-ZOGEN
                       MOVE    "£±£²£°ÆüÄ¶¡§"          TO  WRK-ZOGEN-MEI
                   ELSE
                       MOVE    180                     TO  WRK-ZOGEN
                       MOVE    "£±£¸£°ÆüÄ¶¡§"          TO  WRK-ZOGEN-MEI
                   END-IF
           END-EVALUATE
      *    £ÎÆü¸å·×»»
           IF      WRK-ZOGEN           >   ZERO
               INITIALIZE                      STS-AREA-DAY
               INITIALIZE                      LNK-DAY6-AREA
               MOVE    "61"                TO  LNK-DAY6-IRAI
               MOVE    WRK-RIHA-STR2(IDX)  TO  LNK-DAY6-KIJUN
               MOVE    "1"                 TO  LNK-DAY6-ZOGENPTN
               MOVE    WRK-ZOGEN           TO  LNK-DAY6-ZOGEN
               CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
               MOVE    LNK-DAY6-KEISAN     TO  WRK-RIHA-YMD
      *
               INITIALIZE                      STS-AREA-DAY
               INITIALIZE                      LNK-DAY2-AREA
               MOVE    "21"                TO  LNK-DAY2-IRAI
               MOVE    WRK-RIHA-YMD        TO  LNK-DAY2-YMD
               CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY2-AREA
               MOVE    LNK-DAY2-EDTYMD1    TO  WRK-RIHA-GMN
           END-IF
      *
           INITIALIZE                      STS-AREA-DAY
           INITIALIZE                      LNK-DAY2-AREA
           MOVE    "21"                TO  LNK-DAY2-IRAI
           MOVE    WRK-RIHA-STR2(IDX)  TO  LNK-DAY2-YMD
           CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                               LNK-DAY2-AREA
      *
           ADD     1                   TO  IDX-R
           IF      WRK-ZOGEN           =   ZERO
               STRING  WRK-RIHAMEI         DELIMITED  BY  SPACE
                       LNK-DAY2-EDTYMD1    DELIMITED  BY  SIZE
                   INTO                SPA-GMN-RIHAYMD (IDX-R)
               END-STRING
           ELSE
               STRING  WRK-RIHAMEI         DELIMITED  BY  SPACE
                       LNK-DAY2-EDTYMD1    DELIMITED  BY  SIZE
                       "¡¡"                DELIMITED  BY  SIZE 
                       WRK-ZOGEN-MEI       DELIMITED  BY  SPACE
                       WRK-RIHA-GMN        DELIMITED  BY  SIZE
                   INTO                SPA-GMN-RIHAYMD (IDX-R)
               END-STRING
           END-IF
      *
           .
       1001931-RIHA-HENKAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    »»ÄêÍúÎòÉÕ²Ã¾ðÊóÊÔ½¸½èÍý
      *****************************************************************
       1001931-SANTEIPLUS-CHK-SEC                  SECTION.
      *
           INITIALIZE                  SANTEIPLUS-REC
           MOVE    SANTEI-HOSPNUM      TO  SANTEIPLUS-HOSPNUM
           MOVE    SANTEI-PTID         TO  SANTEIPLUS-PTID
           MOVE    SANTEI-SRYCD        TO  SANTEIPLUS-SRYCD
           MOVE    SANTEI-SRYYM        TO  SANTEIPLUS-SRYYM
           MOVE    SANTEI-SRYKA        TO  SANTEIPLUS-SRYKA
           MOVE    SANTEI-NYUGAIKBN    TO  SANTEIPLUS-NYUGAIKBN
           MOVE    SANTEI-HKNCOMBINUM  TO  SANTEIPLUS-HKNCOMBINUM
           MOVE    WRK-DD              TO  SANTEIPLUS-DAYKEY
           MOVE    ZERO                TO  SANTEIPLUS-RENNUM
      *
           MOVE    SANTEIPLUS-REC      TO  MCPDATA-REC
           MOVE    "tbl_santeiplus"    TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_santeiplus"    TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 921-SANTEIPLUS-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SANTEIPLUS
           END-IF
           MOVE    "tbl_santeiplus"    TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           MOVE    SPACE               TO  WRK-ENDYMD
           IF      FLG-SANTEIPLUS      =   ZERO
               IF      SANTEIPLUS-ENDYMD   <   SPA-SRYYMD
      *            ¥·¥¹¥Æ¥àÆüÉÕ¤è¤êÁ°¤Î½ªÎ»
                   MOVE    SANTEIPLUS-ENDYMD   TO  WRK-ENDYMD
               END-IF
           END-IF
      *
           .
       1001931-SANTEIPLUS-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅ²ó¿ô½èÍý
      *****************************************************************
       1001-SYONIKKR-CHK-SEC           SECTION.
      *
           MOVE    ZERO                TO  FLG-SYONIKKR-ARI
           MOVE    ZERO                TO  SPA-SYONIKKR-ARI3
           MOVE    ZERO                TO  SPA-SYONIKKR-ARI2
      *
      *    Êñ³ç¤Þ¤È¤áÆþÎÏÂÐ¾Ý³°
           IF      SPA-HKNCOMBINUM     =   "9999"
               GO      TO      1001-SYONIKKR-CHK-EXT
           END-IF
      *    ¼£¸³ÂÐ¾Ý³°
           IF      SPA-CHIKENKBN       =   "1"
               GO      TO      1001-SYONIKKR-CHK-EXT
           END-IF
      *
      *    ÅöÆü»»Äê¤¬¤¢¤ì¤Ð¥Õ¥é¥°¤òÎ©¤Æ¤ë
           IF      WRK-SYOUNI-SUM      >   ZERO
               MOVE    1                   TO  SPA-SYONIKKR-ARI2
               MOVE    1                   TO  FLG-SYONIKKR-ARI
           ELSE
               MOVE    ZERO                TO  SPA-SYONIKKR-ARI2
           END-IF
      *
      *    ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅ»»ÄêÀßÄê
           IF     (SPA-SYOUNI-ARI      =   1   )
               CONTINUE
           ELSE
               GO      TO      1001-SYONIKKR-CHK-EXT
           END-IF
      *R02.4  £¶ºÐ¤Þ¤Ç¡Ê½¢³ØÁ°¤Þ¤Ç¡Ë
      *    £¶ºÐ¤Ë¤Ê¤ëÇ¯·îÆü¤ò·×»»
           MOVE    SPA-BIRTHDAY        TO  WRK-BIRTHDAY
           COMPUTE WRK-BIRTH-YY        =   WRK-BIRTH-YY    +  6
      *
      *    £¶ºÐ°Ê¾å¡¢»»Äê¤¬¤Ê¤±¤ì¤ÐÂÐ¾Ý³°
           IF     (SPA-NENREI-YY       >=  6               )
               IF      WRK-SYOUNI          =   ZERO
                   PERFORM 10011-SYONIKKR-RRK-SEC 
               END-IF
               IF      WRK-SYOUNI          =   ZERO
                   GO      TO      1001-SYONIKKR-CHK-EXT
               END-IF
           END-IF
      *
      *    ¾®»ùÂÐ¾Ý
           MOVE    1                   TO  FLG-SYONIKKR-ARI
           MOVE    1                   TO  SPA-SYONIKKR-ARI3
      *
           IF     (SPA-DOUJITU         >   ZERO)
             AND  (WRK-SYOUNI-SUM      =   ZERO)
             AND  (SPA-SYORIFLG        =   ZERO)
      *        Æ±Æü¤Ë¼õ¿Ç¤¬¤¢¤ê¡¢¾®»ù¤«¤«¤ê¤Ä¤±°Ê³°¤Î»»Äê¤¢¤ê
               MOVE    ZERO            TO  FLG-SYONIKKR-ARI
               MOVE    ZERO            TO  SPA-SYONIKKR-ARI3
           END-IF
      *
           IF     SPA-SYONIKKR-ARI3    =   1
               MOVE    ZERO            TO  SPA-SYONIKA-ARI3
               MOVE    ZERO            TO  FLG-SYONIKA-ARI
           END-IF
      *
           .
       1001-SYONIKKR-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅ²ó¿ô¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       10011-SYONIKKR-RRK-SEC          SECTION.
      *
      *    »»ÄêÍúÎò¸¡º÷
           MOVE    SPACE               TO  SANTEI-REC
           INITIALIZE                  SANTEI-REC
           MOVE    SPA-HOSPNUM         TO  SANTEI-HOSPNUM
           MOVE    SPA-PTID            TO  SANTEI-PTID
           MOVE    "1130%"             TO  SANTEI-SRYCD
           MOVE    ZERO                TO  SANTEI-NYUGAIKBN
           MOVE    ZERO                TO  SANTEI-SRYKA
           MOVE    SPA-SRYYMD(1:6)     TO  SANTEI-SRYYM
      *??? MOVE    WRK-BIRTH-YY(1:6)   TO  SANTEI-SRYYM
           MOVE    ZERO                TO  SANTEI-HKNCOMBINUM
      *
           MOVE    SANTEI-REC          TO  MCPDATA-REC
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key16"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key16"             TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SANTEI
           END-IF
      *
           PERFORM
               UNTIL      (FLG-SANTEI      =   1 )
                       OR ( WRK-SYOUNI     >   ZERO )
               EVALUATE    SANTEI-SRYCD
      *        ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅ²Ê
               WHEN    "113019710"
               WHEN    "113019910"
               WHEN    "113019810"
               WHEN    "113020010"
                   MOVE    1               TO   WRK-SYOUNI
               END-EVALUATE
      *
               MOVE    "tbl_santei"        TO  MCP-TABLE
               MOVE    "key16"             TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           END-PERFORM
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key16"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
           .
       10011-SYONIKKR-RRK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê²ó¿ô½èÍý
      *****************************************************************
       1001-SYONIKA-CHK-SEC                  SECTION.
      *
           MOVE    ZERO                TO  FLG-SYONIKA-ARI
           MOVE    ZERO                TO  SPA-SYONIKA-ARI3
           MOVE    ZERO                TO  SPA-SYONIKA-ARI2
      *
      *    Êñ³ç¤Þ¤È¤áÆþÎÏÂÐ¾Ý³°
           IF      SPA-HKNCOMBINUM     =   "9999"
               GO      TO      1001-SYONIKA-CHK-EXT
           END-IF
      *    ¼£¸³ÂÐ¾Ý³°
           IF      SPA-CHIKENKBN       =   "1"
               GO      TO      1001-SYONIKA-CHK-EXT
           END-IF
      *R02.4 ¤«¤é£¶ºÐ¤Þ¤Ç
      *    £¶ºÐ¤Ë¤Ê¤ëÇ¯·îÆü¤ò·×»»
           MOVE    SPA-BIRTHDAY        TO  WRK-BIRTHDAY
           COMPUTE WRK-BIRTH-YY        =   WRK-BIRTH-YY    +  6
      *    £¶ºÐÌ¤Ëþ¤ËÅ¬ÍÑ
           IF      WRK-BIRTHDAY(1:6)   <   SPA-SRYYMD (1:6)
               GO      TO      1001-SYONIKA-CHK-EXT
           END-IF
      *
      *    £¶ºÐ¤ÎÅö·î»þ¡¢Åö·î»»Äê¤¬¤Ê¤±¤ì¤ÐÂÐ¾Ý³°
           IF     (SPA-NENREI-YY   =   6               )  AND
                  (WRK-BIRTHDAY(1:6)   =   SPA-SRYYMD (1:6))
               IF      WRK-NYUYOJI         =   ZERO
                   GO      TO      1001-SYONIKA-CHK-EXT
               END-IF
           END-IF
      *
      *    ÅöÆü»»Äê¤¬¤¢¤ì¤Ð¥Õ¥é¥°¤òÎ©¤Æ¤ë
           IF      WRK-DAYCNT-SUM      >   ZERO
               MOVE    1                   TO  SPA-SYONIKA-ARI2
           ELSE
               MOVE    ZERO                TO  SPA-SYONIKA-ARI2
           END-IF
      *    ¾®»ù²ÊÂÐ¾Ý
           MOVE    1                   TO  FLG-SYONIKA-ARI
           MOVE    1                   TO  SPA-SYONIKA-ARI3
      *
           IF     (SPA-DOUJITU         >   ZERO)
             AND  (WRK-DAYCNT-SUM      =   ZERO)
             AND  (SPA-SYORIFLG        =   ZERO)
      *        Æ±Æü¤Ë¼õ¿Ç¤¬¤¢¤ê¡¢¾®»ù²Ê³°Íè°Ê³°¤Î»»Äê¤ÏºÆ¿ÇÎÁ¤È¤¹¤ë
               MOVE    ZERO            TO  FLG-SYONIKA-ARI
               MOVE    ZERO            TO  SPA-SYONIKA-ARI3
           END-IF
      *
           .
       1001-SYONIKA-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒ¤Î»þ¤Î½èÍý
      *****************************************************************
       1000-SANTEI-RSI-SEC              SECTION.
      *
      *    ·òÊÝ½àµò
           IF      SPA-RSI-JUNKYO      =   "1"
               MOVE    SPA-RSI-SHOBYOYMD   TO  SPA-RSI-HASSYOYMD
           ELSE
               MOVE    SPA-RSI-SHOBYOYMD   TO  SPA-RSI-HASSYOYMD
           END-IF
      *
      *    È¯À¸Æü¤«¤é£³¥ö·î¤Î·×»»¡Ê¸½ºß»ÈÍÑ¤Ê¤·¡Ë
           MOVE    SPA-RSI-HASSYOYMD   TO  WRK-HASSYOYMD
           COMPUTE WRK-HAS-MM          =   WRK-HAS-MM
                                       +   3
           IF      WRK-HAS-MM          >   12
               COMPUTE WRK-HAS-MM      =   WRK-HAS-MM    -   12
               COMPUTE WRK-HAS-YY      =   WRK-HAS-YY    +   1
           END-IF
           MOVE    WRK-HASSYOYMD       TO  SPA-RSI-HASSYOYMD3
      *
      *    ½ýÉÂÆü¤«¤é£¶¥ö·î¤Î·×»»
           MOVE    SPA-RSI-SHOBYOYMD   TO  WRK-HASSYOYMD
           COMPUTE WRK-HAS-MM          =   WRK-HAS-MM
                                       +   6
           IF      WRK-HAS-MM          >   12
               COMPUTE WRK-HAS-MM      =   WRK-HAS-MM    -   12
               COMPUTE WRK-HAS-YY      =   WRK-HAS-YY    +   1
           END-IF
           MOVE    WRK-HASSYOYMD       TO  SPA-RSI-SHOBYOYMD3
      *
      *    µÞÀ­È¯À¸Æü¤¬½ýÉÂÆü¤è¤ê¸å¤Î¾ì¹ç¡¢µÞÀ­È¯À¸Æü¤«¤é£¶¥ö·î¸å¤È¤¹¤ë
           IF     (SPA-HKNKBN          =   1        )  AND
                  (SPA-RSI-SHOBYOYMD   <   SPA-KYUSEI-YMD )
               MOVE    SPA-KYUSEI-YMD      TO  WRK-HASSYOYMD
               COMPUTE WRK-HAS-MM          =   WRK-HAS-MM
                                           +   6
               IF      WRK-HAS-MM          >   12
                   COMPUTE WRK-HAS-MM      =   WRK-HAS-MM    -   12
                   COMPUTE WRK-HAS-YY      =   WRK-HAS-YY    +   1
               END-IF
               MOVE    WRK-HASSYOYMD       TO  SPA-RSI-SHOBYOYMD3
           END-IF
      *
      *    ¼õ¿ÇÍúÎò¤è¤ê¿Ç»¡²ó¿ô¤òµá¤á¤ë
           PERFORM 1000-SINSATU-KAISU-SEC
      *
      *    Åö·î»»Äê²ó¿ô¤òµá¤á¤ë
           PERFORM 1001-TOUGETU-KAISU-SEC
      *
      *    ËýÀ­áÖÄË¼ÀÉÂ´ÉÍýÎÁ»»Äê¥Á¥§¥Ã¥¯
      ***  PERFORM 1004-TOUTUU-CHK-SEC
      *
           MOVE    ZERO                TO  SPA-SYONIKA-ARI3
           MOVE    ZERO                TO  SPA-SYONIKA-ARI2
           MOVE    ZERO                TO  SPA-SYONIKA-ARI
      *
           MOVE    ZERO                TO  SPA-SYONIKKR-ARI3
           MOVE    ZERO                TO  SPA-SYONIKKR-ARI2
           MOVE    ZERO                TO  SPA-SYONIKKR-ARI
      *
           .
       1000-SANTEI-RSI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÊÝ¸±Ëè¤Î¥³¡¼¥É¤ÎÈ½Äê½èÍý
      *****************************************************************
       1000-SANTEI-CHK-SEC      SECTION.
      *
           SET     TBL-SAN             TO  1
           SEARCH  TBL-SANTEI-OCC      VARYING   TBL-SAN
               AT  END
                   MOVE    ZERO            TO  FLG-HKNSAN
                   MOVE    SPACE           TO  WRK-RIHA-KBN
                   MOVE    SPACE           TO  WRK-RIHA-SYUKBN
               WHEN    WRK-SRYCD       =   TBL-SANTEI-SRYCD
                                                          (TBL-SAN)
                   MOVE    1               TO  FLG-HKNSAN
      *H19.4¤«¤é¥ê¥Ï¥Ó¥ê´ÉÍýÎÁ
                   MOVE    TBL-RSI-KBN (TBL-SAN)
                                           TO  WRK-RIHA-KBN
                   MOVE    TBL-RIHA-SYUKBN (TBL-SAN)
                                           TO  WRK-RIHA-SYUKBN
           END-SEARCH
      *H28.4
           IF    (WRK-SRYCD(1:7)       =   "0998002"  )
      *        Áá´ü¡¦½é´ü¥ê¥Ï³«»ÏÆü
               MOVE    1               TO  FLG-HKNSAN
           END-IF
      *
           .
       1000-SANTEI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    »»ÄêÍúÎò¥Á¥§¥Ã¥¯½èÍý¡ÊÏ«ºÒ¡Ë
      *****************************************************************
       10001-RSI-JYURRK-CHK-SEC            SECTION.
      *
           MOVE    ZERO                TO  FLG-TOUG-SANTEI
           MOVE    SPACE               TO  WRK-SANTEI-YMD
           MOVE    SPACE               TO  WRK-HASSYOYMD
      *
      *    MOVE    WRK-SRYCD           TO  TNS-SRYCD
      *    PERFORM 910-TENSU-READ-SEC
      *    IF      FLG-TENSU           =   1
      *        GO      TO      10001-RSI-JYURRK-CHK-EXT
      *    END-IF
      *
      *    ÊÝ¸±Ëè¤Î¥³¡¼¥É¤ÎÈ½Äê
      *    PERFORM 1000-SANTEI-CHK-SEC
      *
      *Ï«ºÒ¥³¡¼¥É¤Ê¤Î¤Ç¡¢ÊÝ¸±Ëè¤Î»»ÄêÍúÎò¤È¤¹¤ë
      *    »»ÄêÍúÎò¸¡º÷
           MOVE    SPACE               TO  SANTEI-REC
           INITIALIZE                  SANTEI-REC
           MOVE    SPA-HOSPNUM         TO  SANTEI-HOSPNUM
           MOVE    SPA-PTID            TO  SANTEI-PTID
           MOVE    WRK-SRYCD           TO  SANTEI-SRYCD
           MOVE    ZERO                TO  SANTEI-NYUGAIKBN
           MOVE    ZERO                TO  SANTEI-SRYKA
           MOVE    SPA-HKNCOMBINUM     TO  SANTEI-HKNCOMBINUM
      **** EVALUATE    TNS-SANTEIRRKKBN
      *        WHEN    1
      *            MOVE    ZERO                TO  SANTEI-NYUGAIKBN
      *            MOVE    ZERO                TO  SANTEI-SRYKA
      *        WHEN    2
      *            MOVE    SPA-NYUGAIKBN       TO  SANTEI-NYUGAIKBN
      *            MOVE    ZERO                TO  SANTEI-SRYKA
      *        WHEN    3
      *            MOVE    ZERO                TO  SANTEI-NYUGAIKBN
      *            MOVE    SPA-SRYKA           TO  SANTEI-SRYKA
      *        WHEN    4
      *            MOVE    SPA-NYUGAIKBN       TO  SANTEI-NYUGAIKBN
      *            MOVE    SPA-SRYKA           TO  SANTEI-SRYKA
      *    END-EVALUATE
      *
      *    IF     (FLG-HKNSAN          =   1   )  AND
      *           (SPA-HKNKBN      NOT =   ZERO)
      *        MOVE    SPA-HKNCOMBINUM     TO  SANTEI-HKNCOMBINUM
      *    ELSE
      *        MOVE    ZERO                TO  SANTEI-HKNCOMBINUM
      *****END-IF
      *
           MOVE    SANTEI-REC          TO  MCPDATA-REC
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key3"              TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "key3"              TO  MCP-PATHNAME
               PERFORM 920-SANTEI-READ-SEC
           ELSE
               MOVE    1                   TO  FLG-SANTEI
           END-IF
      *
           PERFORM
               UNTIL       FLG-SANTEI      =   1
      *
               IF      SANTEI-MSANTEICNT   >   ZERO
      *            ½é²ó»»ÄêÆü
                   MOVE    SANTEI-FSANTEIYMD   TO  WRK-HASSYOYMD
                   ADD     1                   TO  WRK-SANTEI-CNT
               END-IF
      *
               IF     FLG-SANTEI           =   ZERO
                  MOVE    "key3"              TO  MCP-PATHNAME
                  PERFORM 920-SANTEI-READ-SEC
               END-IF
           END-PERFORM
      *
           MOVE    "tbl_santei"        TO  MCP-TABLE
           MOVE    "key3"              TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       10001-RSI-JYURRK-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¿Ç»¡ÎÁ½é´üÈ¯À¸½èÍý
      *****************************************************************
       200-SINSATU-SET-SEC             SECTION.
      *
      ***  MOVE    SPACE               TO  SPA-SCR-REC
      **** INITIALIZE                  SPA-SCR-REC
           MOVE    ZERO                TO  IDX2
           MOVE    ZERO                TO  SPA-GMN-IDX
           MOVE    ZERO                TO  SPA-GAIRAISIN
           MOVE    ZERO                TO  SPA-SYONIKA-ARI
      *
           MOVE    SPACE               TO  WRK-SRYCD
      *
           MOVE    ZERO                TO  FLG-ERR
      *
      *    Æ±ÆüºÆ¿Ç
           IF     (SPA-HKNCOMBINUM     =   "9999")
      *       ¼õÉÕ¤¢¤ê
              OR  (SPA-UKETUKE-ARI     =   1    )
              OR  (SPA-TEISEIFLG       =   "0"  )
      *       ¼£¸³
              OR  (SPA-CHIKENKBN       =   "1"  )
               CONTINUE
           ELSE
               IF     ( SPA-NYUGAIKBN      =   "2"        ) AND
                      ( SPA-SYORIFLG       =   ZERO       ) AND
      **********      ( SPA-RRK-LSTYMD     =   SPA-SRYYMD ) AND
                      ( SPA-NAI-RRKYMD(1)  =   SPA-SRYYMD ) AND
                      ( SPA-LSTYMD         =   SPA-SRYYMD )
      *            Æþ±¡Ãæ°Ê³°
                AND   ( SPA-NAI-NYUIN      =   ZERO       )
                   IF      (SPA-TEISEIFLG       =   "1"  )
                       MOVE    "0100"              TO  SPA-KIDCD
                   ELSE
                       MOVE    "0131"              TO  SPA-KIDCD
                   END-IF
               END-IF
           END-IF
      *    Æþ±¡Æü¤Î»þ¡¢½é¿ÇÎÁ¤Î¤ß»»Äê¤¹¤ë
           IF    ( SPA-K02N-NYUINYMD(1:6)  =   SPA-NAI-SRYYMD(1:6) )
           AND   ( SPA-NYUGAIKBN           =   "1"    )
               IF      SPA-SYOSIN          =   1
                   CONTINUE
               ELSE
                   MOVE    1               TO  FLG-ERR
               END-IF
           END-IF
           IF     (SPA-HKNCOMBINUM NOT =   "9999" )  AND
                  (SPA-KIDCD           =   SPACE )   AND
                  (FLG-ERR             =   ZERO  )
                PERFORM 200-SYOSIN-SET-SEC
           END-IF
      *
           .
       200-SINSATU-SET-EXT.
           EXIT.
      *****************************************************************
      *    ½é¿ÇÎÁ¼«Æ°È¯À¸½èÍý
      *****************************************************************
       200-SYOSIN-SET-SEC              SECTION.
      *
           MOVE    ZERO                TO  IDX2
           MOVE    ZERO                TO  SPA-GMN-IDX
           MOVE    ZERO                TO  SPA-GAIRAISIN
           MOVE    ZERO                TO  SPA-SYONIKA-ARI
           MOVE    ZERO                TO  SPA-SYOSIN-KEI
           MOVE    ZERO                TO  SPA-SYOSIN-KEIFLG
           MOVE    ZERO                TO  SPA-SYONIKKR-ARI
      *
           MOVE    SPACE               TO  WRK-SRYCD
      *
           MOVE    ZERO                TO  FLG-ERR
      *    Êñ³ç¤Þ¤È¤áÆþÎÏÂÐ¾Ý³°
           IF      SPA-HKNCOMBINUM     =   "9999"
               MOVE    1                   TO  FLG-ERR
           END-IF
      *    ¼£¸³ÂÐ¾Ý³°
           IF      SPA-CHIKENKBN       =   "1"
               MOVE    1                   TO  FLG-ERR
           END-IF
      *
      *    Æþ±¡Æü¤Î»þ¡¢½é¿ÇÎÁ¤Î¤ß»»Äê¤¹¤ë
           IF    ( SPA-K02N-NYUINYMD(1:6)  =   SPA-NAI-SRYYMD(1:6))
           AND   ( SPA-NYUGAIKBN           =   "1"    )
               IF      SPA-SYOSIN          =   1
                   CONTINUE
               ELSE
                   MOVE    1                   TO  FLG-ERR
               END-IF
           END-IF
      *    Æþ±¡Æü¤Î»þ¡¢½é¿ÇÎÁ¤Î¤ß»»Äê¤¹¤ë
           IF    ( SPA-K02N-NYUINYMD       =   SPA-NAI-SRYYMD )
           AND   ( SPA-NYUGAIKBN           =   "2"    )
               IF      SPA-SYOSIN          =   1
                   CONTINUE
               ELSE
                   MOVE    1                   TO  FLG-ERR
               END-IF
           END-IF
      *    Æþ±¡Ãæ¡Ê¥¢¥Õ¥¿¡¼¥±¥¢¡Ë
           IF      SPA-NAI-NYUIN       =   1
               MOVE    1                   TO  FLG-ERR
           END-IF
      *
      *    ³°Íè¤Ç¼«Æ°È¯À¸¤Ê¤·
           IF     (SPA-NYUGAIKBN       =   "2"  )
             AND  (SPA-INITAUTO-FLG    =   "0"  )
               MOVE    1                   TO  FLG-ERR
           END-IF
      *
      *ver.4.7
      *    Ìë´ÖÁáÄ«²Ã»»¤Î£¶ºÐÌ¤ËþÂÐ±þ
           MOVE    SPA-GAI-JIKANKBN    TO  WRK-HZN-JIKANKBN
           IF      SPA-GAI-JIKANKBN    =   8
      *        £¶ºÐÌ¤Ëþ¤Ï¾®»ù²ÊÆÃÎãÌë´Ö¤Ø
               IF     (SPA-NENREI-YY       <   6  )
                  AND (SPA-JIKANTOKU-NYU   =   "1"
                                           OR  "2"  )
                   MOVE    5               TO  SPA-GAI-JIKANKBN
               END-IF
      *H30.4
      *        Ç¥ÉØ¤Ï¾®»ù²ÊÆÃÎãÌë´Ö¤Ø
               IF     (SPA-NENREI-YY       >=  6  )
                  AND (SPA-JIKANTOKU-NYU   =   "1"
                                           OR  "3" )
                  AND (SPA-NINPUKBN-ARI    =   1  )
                   MOVE    5               TO  SPA-GAI-JIKANKBN
               END-IF
      *H28.10
           ELSE
      *H30.4
      *        ¾®»ù²Ê¡¦»ºÉØ¿Í²ÊÆÃÎã»þ´Ö³°¶èÊ¬¤òÌë´Ö¡¦ÁáÄ«¤Ø
               MOVE    ZERO                TO  FLG-CHKT
      *        £¶ºÐ°Ê¾å¤ÇÌë´Ö¡¦ÁáÄ«»»Äê²Ä
               IF     (SPA-NENREI-YY       >=  6  )
                AND   (SPA-YAKANKBN        =   1  )
                AND   (SPA-HOSPSBT         =   2   )
                   MOVE    1                   TO  FLG-CHKT
      *            Ç¥ÉØ¤ÇÆÃÎã¤¢¤ê»þ
                   IF   (SPA-NINPUKBN-ARI      =   1  )
                    AND (SPA-JIKANTOKU-NYU     =   "1"
                                                OR "3")
                       MOVE    ZERO            TO  FLG-CHKT
                   END-IF
               END-IF
      *
      *        £¶ºÐÌ¤Ëþ
               IF     (SPA-NENREI-YY       <   6  )
                AND   (SPA-YAKANKBN        =   1  )
                AND   (SPA-HOSPSBT         =   2  )
                AND   (SPA-JIKANTOKU-NYU   =   "3" )
      *           £¶ºÐÌ¤Ëþ¤Ç»ºÉØ¿Í²ÊÆÃÎã¤Î¤ß
                   MOVE    1                   TO  FLG-CHKT
               END-IF
      *
               IF      FLG-CHKT        =   1
                   EVALUATE    WRK-HZN-JIKANKBN
      *                ¾®»ùÆÃÎãÌë´Ö¡¦µÙÆü¡¦¿¼Ìë
                       WHEN    "5"
                       WHEN    "6"
                       WHEN    "7"
                           MOVE    8               TO  SPA-GAI-JIKANKBN
                   END-EVALUATE
               END-IF
           END-IF
      *
           IF      FLG-ERR             =   ZERO
      *        Ï«ºÒ¤Î½é¿ÇÎÁ»»Äê
               IF     (SPA-HKNKBN          =   1   )
      *           ¼«ÇåÀÕ¤Î·òÊÝ½àµò°Ê³°
                 AND  (SPA-RSI-JUNKYO  NOT =   "1"  )
                   PERFORM 2001-RSI-SYOSIN-SET-SEC
               ELSE
                   MOVE    ZERO                TO  FLG-SYONIKA
      *H28.4
      *            ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅÎÁ
                   MOVE    ZERO                TO  FLG-SYONIKKR
                   IF     (SPA-NYUGAIKBN       =   "2"  )
                     AND  (SPA-SYOUNI-ARI      =   1    )
                     AND  (SPA-SYUGAKUKBN      =   1    )
      *              »ÜÀßÆþµï¼Ô¡¦ÃÏ°èÊñ³ç¡¦Ç§ÃÎ¾ÉÊñ³ç¤Ê¤·
                     AND  (SPA-PTTOKK-KBN      =   SPACE )
                     AND  (SPA-CHKHKT-ARI2     =   ZERO  )
                     AND  (SPA-NNCHKT-ARI2     =   ZERO  )
                     AND ((FLG-SYONIKKR-ARI    =   1   ) OR
                          (SPA-SYONIKKR-ARI3   =   1   ))
                       PERFORM 3304-SYOUNIKAKARI-SET-SEC
                   END-IF
      *
      *            ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê
                   IF     (SPA-SYONIKA         =   1   )  AND
                          (SPA-NYUGAIKBN       =   "2" )  AND
                         ((FLG-SYONIKA-ARI     =   1   ) OR
                          (SPA-SYONIKA-ARI3    =   1   ))
      *            »ÜÀßÆþµï¼Ô°Ê³°
                     AND  (SPA-PTTOKK-KBN      =   SPACE )
      *H26.4
      *             ÃÏ°èÊñ³ç¿ÇÎÅÎÁ»»Äê°Ê³°
                     AND  (SPA-CHKHKT-ARI2     =   ZERO  )
      *H28.4
      *             Ç§ÃÎ¾ÉÃÏ°èÊñ³ç¿ÇÎÅÎÁ»»Äê°Ê³°
                     AND  (SPA-NNCHKT-ARI2     =   ZERO  )
      *             ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅÎÁ¤Ê¤·
                     AND  (FLG-SYONIKKR        =   ZERO  )
      *
                       PERFORM 3303-SYONIKA-SET-SEC
                   END-IF
                   IF     (FLG-SYONIKA       =   1   )
                      OR  (FLG-SYONIKKR      =   1   )
                      OR  (SPA-SYONIKA-ARI2  =   1   )
                      OR  (SPA-SYONIKKR-ARI2 =   1   )
                       CONTINUE
                   ELSE
      *                ·òÊÝ¤Î¿Ç»¡ÎÁ»»Äê
                       PERFORM 2002-KNH-SYOSIN-SET-SEC
                   END-IF
               END-IF
           END-IF
      *ver.4.7
      *    ³°Íè»þ´Ö³°¶èÊ¬ÀßÄê¤òÌá¤¹
           MOVE    WRK-HZN-JIKANKBN    TO  SPA-GAI-JIKANKBN
      *
           .
       200-SYOSIN-SET-EXT.
           EXIT.
      *****************************************************************
      *    Ï«ºÒ½é¿ÇÎÁ¼«Æ°È¯À¸½èÍý
      *****************************************************************
       2001-RSI-SYOSIN-SET-SEC       SECTION.
      *
      *    £²£°£°¾²°Ê¾å¤ÇºÆ¿Ç¤Î¾ì¹ç¡¢³°Íè¿Ç»¡ÎÁ¤È¤¹¤ë
           IF     (SPA-SYOSIN      NOT =   1  )  AND
                  (SPA-BEDSUIPN        >=  200 )  AND
                  (SPA-HOSPSBT         =   1   )
      *        ·òÊÝ¿Ç»¡ÎÁ
               PERFORM 2002-KNH-SYOSIN-SET-SEC
           ELSE
               MOVE    SPACE               TO  WRK-KBN
               PERFORM 2009-RSIHKN-SET-SEC
               IF      SPA-GMN-IDX         >   ZERO
      *            ÎÅÍÜÃ´Åö¼êÅöÈ¯À¸
                   PERFORM 330123-RYOYOU-TEATE-SEC
               END-IF
           END-IF
           .
       2001-RSI-SYOSIN-SET-EXT.
           EXIT.
      *****************************************************************
      *    ·òÊÝ¿Ç»¡ÎÁ¼«Æ°È¯À¸½èÍý
      *****************************************************************
       2002-KNH-SYOSIN-SET-SEC       SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYCD
           MOVE    ZERO                TO  WRK-KAISU
      *
      *    ½é¿ÇÎÁ»»Äê
           IF      SPA-SYOSIN          =   1
               MOVE    "11"                TO  WRK-SRYKBN
               MOVE    "F"                 TO  WRK-KBN
      *        ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
               PERFORM 2001-SRYCD-TBL-SEC
           ELSE
      *        Æ±ÆüºÆ¿ÇÎÁ»»Äê
               MOVE    ZERO                TO  FLG-DOUJITU
               IF     ( SPA-SYORIFLG        =   ZERO     ) AND
                      ( SPA-RRK-LSTYMD      =   SPA-SRYYMD )
                   IF      SPA-DOUJITU     NOT =   ZERO
                       MOVE    1                   TO  FLG-DOUJITU
                   END-IF
               END-IF
               IF      (SPA-SYORIFLG        =   1       )   AND
                       (WRK-DAY-SINSATUCNT  >   ZERO    )
                   MOVE    1                   TO  FLG-DOUJITU
               END-IF
               IF      FLG-DOUJITU         =   1
                   IF     (SPA-TAKA-SRYKA-R    =   SPACE ) OR
                          (LNK-SC10S-SYORI     =   "J"   )
                     OR   (FLG-DOUJI-HEN       =   1     )
                     OR   (FLG-DOUJI-HEN2      =   1     )
                       MOVE    "12"                TO  WRK-SRYKBN
                       MOVE    "D"                 TO  WRK-KBN
      *                ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
                       PERFORM 2001-SRYCD-TBL-SEC
                   ELSE
                       PERFORM 3301-DOUSAISIN-SEC
                   END-IF
               ELSE
      *        ºÆ¿ÇÎÁ»»Äê
                   MOVE    "12"                TO  WRK-SRYKBN
                   MOVE    SPACE               TO  WRK-KBN
      *            ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
                   PERFORM 2001-SRYCD-TBL-SEC
               END-IF
           END-IF
      *!!
           IF      SPA-PTTOKK-KBN  NOT =   SPACE
      *        ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¤Ï»»Äê¤Ê¤·¤È¤¹¤ë
               MOVE    ZERO                TO  SPA-SYONIKA-ARI2
               MOVE    ZERO                TO  SPA-SYONIKA-ARI3
               MOVE    ZERO                TO  SPA-SYONIKKR-ARI2
               MOVE    ZERO                TO  SPA-SYONIKKR-ARI3
           END-IF
      *    Ï«ºÒ¡¦¼«ÇåÀÕ¡¢¥³¥á¥ó¥È°Ê³°
           IF     (SPA-HKNKBN          =   1   )
             OR   (WRK-SRYCD(1:2)      =   "83" )
               CONTINUE
           ELSE
      *    »ÜÀßÆþµï¼Ô¤Ï¥À¥ß¡¼
               IF      SPA-PTTOKK-KBN  NOT =   SPACE
                   IF      SPA-SYOSIN          =   1
                       MOVE    "099110001"         TO  WRK-SRYCD
                   ELSE
                       MOVE    "099120001"         TO  WRK-SRYCD
                   END-IF
               END-IF
           END-IF
      *
      *H24.4
      *    ³°Íè¥ê¥Ï¥Ó¥ê¿Ç»¡ÎÁÅù»»Äê»þ¡¢ºÆ¿Ç¥À¥ß¡¼¡©¡©
           IF     (WRK-SRYCD(1:2)      =   "83" )
      *        ¥³¥á¥ó¥È°Ê³°
               CONTINUE
           ELSE
               IF     (SPA-KOURESRY-ARI2   =   2   OR  3  )
      *H26.4
      *        ÃÏ°èÊñ³ç¿ÇÎÅÎÁ»»Äê»þ¡Ê¡©¡©¡Ë
                 OR   (SPA-CHKHKT-ARI2     =   1      )
      *H28.4   Ç§ÃÎ¾ÉÃÏ°èÊñ³ç
                 OR   (SPA-NNCHKT-ARI2     =   1      )
      *H30.4   ¥ª¥ó¥é¥¤¥ó¿ÇÎÅÎÁ
                 OR   (SPA-ONLINE-ARI2     =   1      )
                   MOVE    "099120001"         TO  WRK-SRYCD
               END-IF
           END-IF
      *H24.4
      *
      *    ½é¿ÇÎÁ¼«Æ°ÄÉ²Ã½èÍý
           PERFORM 3301-SYOSIN-SYORI-SEC
      *
           IF      SPA-PTTOKK-KBN  NOT =   SPACE
               GO      TO      2002-KNH-SYOSIN-SET-EXT
           END-IF
      *H30.4   ¥ª¥ó¥é¥¤¥ó¿ÇÎÅÎÁ
           IF      SPA-ONLINE-ARI2     =   1
               GO      TO      2002-KNH-SYOSIN-SET-EXT
           END-IF
      *
      *H24.4
      *    ³°Íè¥ê¥Ï¥Ó¥ê¿Ç»¡ÎÁÅù»»Äê
           IF     (SPA-KOURESRY-ARI2   =   2   OR  3)
      *H26.4
      *        ÃÏ°èÊñ³ç¿ÇÎÅÎÁ»»Äê»þ¡Ê¡©¡©¡Ë
                 OR   (SPA-CHKHKT-ARI2     =   1      )
      *H28.4   Ç§ÃÎ¾ÉÃÏ°èÊñ³ç
                 OR   (SPA-NNCHKT-ARI2     =   1      )
      *        ÎÅÍÜÃ´Åö¼êÅö¡ÊËÌ³¤Æ»¡Ë
               PERFORM 330123-RYOYOU-TEATE-SEC
               GO      TO      2002-KNH-SYOSIN-SET-EXT
           END-IF
      *H24.4
      *
      *
           IF      WRK-SRYCD(1:2)      =   "83"
               MOVE    "0109"              TO  SPA-KIDCD
           END-IF
      *    Æþ±¡Æü¤Î»þ¡¢½é¿ÇÎÁ¤Î¤ß»»Äê¤¹¤ë
           IF      SPA-K02N-NYUINYMD   =   SPA-NAI-SRYYMD
               MOVE    SPACE               TO  SPA-KIDCD
           END-IF
      *
           IF     (WRK-SRYKBN          =   "11"  )  AND
                  (SPA-GMN-IDX         =   ZERO  )  AND
                  (SPA-NYUGAIKBN       =   "2"   )
      *        ½é¿ÇÎÁ¤Ç¥¨¥é¡¼¤Ë¤è¤êÂÐ¾Ý¤¬¤Ê¤¤»þ¡¢¥¨¥é¡¼¤ÎÉ½¼¨
               MOVE    2                   TO  SPA-SYOSIN-KEI
           END-IF
      *
           IF     (SPA-SYOSIN          =   1 )
      *        ÎÅÍÜÃ´Åö¼êÅöÈ¯À¸
               PERFORM 330123-RYOYOU-TEATE-SEC
           ELSE
      *H28.12
      *        »ØÆ³ÎÁÅù¼«Æ°»»Äê½èÍý
               PERFORM 33014-AUTOSIDOU-SYORI-SEC
      *        »ØÆ³ÎÁ¤Î¼«Æ°È¯À¸
               MOVE    SPA-SRYKA           TO  WRK-SRYKA
               PERFORM 33012-SIDOU-SYORI-SEC
      *        ÎÅÍÜÃ´Åö¼êÅö¡ÊËÌ³¤Æ»¡Ë
               PERFORM 330123-RYOYOU-TEATE-SEC
           END-IF
      *
           .
       2002-KNH-SYOSIN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿Ç»¡ÎÁ¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê½èÍý
      *****************************************************************
       2001-SRYCD-TBL-SEC              SECTION.
      *
           MOVE    1                   TO  WRK-KAISU
           IF      WRK-SRYKBN          =   "12"
      *        °ìÈÌÉÂ¾²¿ô
               IF     (SPA-BEDSUIPN        >=  200 )  AND
                      (SPA-HOSPSBT         =   1   )
      *            200¾²°Ê¾å¤Ï³°Íè¿Ç»¡ÎÁ
                   MOVE    3               TO  WRK-KAISU
               END-IF
           END-IF
      *
           IF      WRK-SRYKBN          =   "11"
               MOVE    ZERO                TO  WRK-HOSPSBT
           ELSE
               MOVE    SPA-HOSPSBT         TO  WRK-HOSPSBT
           END-IF
      *H25.4
           IF      WRK-ETCKBN          =   "1"
                                       OR  "2"
               CONTINUE
           ELSE
               MOVE    "0"             TO  WRK-ETCKBN
           END-IF
      *H27.1
      *    ÂÅ·ëÎ¨£µ³ä°Ê²¼
           IF     (SPA-SRYYMD          >=  "20150101" )
             AND  (SPA-DAKT50-KBN      =   1          )
               MOVE    "2"             TO  WRK-ETCKBN
           END-IF
      *
      *    ¿Ç»¡ÎÁ¥»¥Ã¥È
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                   AT   END
                       MOVE    SPACE           TO  WRK-SRYCD
                   WHEN   (WRK-KAISU           =   TBL-KAISU  (TBL-IDX))
                     AND  (WRK-KBN             =   TBL-KBN    (TBL-IDX))
                     AND  (WRK-SRYKBN          =   TBL-SRYCD(TBL-IDX)
                                                                (2:2))
                     AND  (WRK-ETCKBN          =   TBL-ETCKBN(TBL-IDX))
                       MOVE    TBL-SRYCD (TBL-IDX)
                                               TO  WRK-SRYCD
           END-SEARCH
      *
           .
       2001-SRYCD-TBL-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³°Íè´ÉÍý²Ã»»¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê½èÍý
      *****************************************************************
       2002-SRYCD-TBLG-SEC                  SECTION.
      *
           MOVE    TBLG-SRYCD          TO  WRK-SRYCD
      *
           .
       2002-SRYCD-TBLG-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½é¿ÇÎÁ¼«Æ°È¯À¸½èÍý
      *****************************************************************
       3301-SYOSIN-SYORI-SEC                  SECTION.
      *
      *    ¿Ç»¡ÎÁÄÉ²Ã
           PERFORM 3301-SYOSIN-HEN-SEC
      *    °Ê¹ß¤Î¼«Æ°»»Äê¤Ê¤·
           IF      FLG-ADD             =   ZERO
               GO      TO      3301-SYOSIN-SYORI-EXT
           END-IF
           ADD     1                   TO  IDX2
           IF      WRK-SRYCD(1:2)      =   "83"
               GO      TO      3301-SYOSIN-SYORI-EXT
           END-IF
           IF      SPA-PTTOKK-KBN  NOT =   SPACE
               GO      TO      3301-SYOSIN-SYORI-EXT
           END-IF
      *H24.4
      *    ³°Íè¥ê¥Ï¥Ó¥ê¿Ç»¡ÎÁÅù»»Äê¤Ç¥À¥ß¡¼¤Î»þ
           IF     (SPA-KOURESRY-ARI2   =   2   OR  3 )
            AND   (WRK-SRYCD (1:3)     =   "099"     )
               GO      TO      3301-SYOSIN-SYORI-EXT
           END-IF
      *H24.4
      *H26.4
      *    ÃÏ°èÊñ³ç¿ÇÎÅÎÁ»»Äê»þ»»Äê¤Ç¥À¥ß¡¼¤Î»þ
           IF    ((SPA-CHKHKT-ARI2     =   1      )  OR
                  (SPA-NNCHKT-ARI2     =   1      ))
            AND   (WRK-SRYCD (1:3)     =   "099"  )
               GO      TO      3301-SYOSIN-SYORI-EXT
           END-IF
      *H30.4   ¥ª¥ó¥é¥¤¥ó¿ÇÎÅÎÁ
           IF     (SPA-ONLINE-ARI2     =   1      )
            AND   (WRK-SRYCD (1:3)     =   "099"  )
               GO      TO      3301-SYOSIN-SYORI-EXT
           END-IF
      *
      *    ³°Íè¤Ç¿Ç»¡ÎÁ¤Î»þ¡¢»þ´Ö³°¶èÊ¬¤òÉÕ¤±¤ë
           IF     (SPA-SYORIFLG        =   ZERO )  AND
                  (SPA-NYUGAIKBN       =   "2"  )  AND
                  (WRK-SRYCD(1:1)      =   "1"  )  AND
                  (SPA-SRYYMD          =   SPA-SYSYMD) AND
                  (SPA-GAI-JIKANKBN    NOT =   ZERO )  AND
      *           ¿Ç»¡ÎÁºÆ»»Äê»þ¤ÏÉÕ¤±¤Ê¤¤
                  (FLG-JIKANKBN        =   ZERO )
      *        ¾®»ù²ÊÆÃÎã»þ´Ö³°¤Ï£¶ºÐÌ¤Ëþ
      *        IF     (SPA-GAI-JIKANKBN    =   5
      *                                    OR  6
      *                                    OR  7  )  AND
      *               (SPA-NENREI-YY       >=  6  )
      *H30.4
      *        ¾®»ù²Ê¡¦»ºÉØ¿Í²ÊÆÃÎã»þ´Ö³°
               IF     (SPA-GAI-JIKANKBN    =   5
                                           OR  6
                                           OR  7  )
                   MOVE    ZERO                TO  FLG-CHKT
      *            £¶ºÐÌ¤Ëþ
                   IF     (SPA-NENREI-YY       <   6  )
                      AND (SPA-JIKANTOKU-NYU   =   "1"
                                               OR  "2" )
                       MOVE    1               TO  FLG-CHKT
                   END-IF
      *            Ç¥ÉØ
                   IF     (SPA-NENREI-YY       >=  6  )
                      AND (SPA-NINPUKBN-ARI    =   1  )
                      AND (SPA-JIKANTOKU-NYU   =   "1"
                                               OR  "3" )
                       MOVE    1               TO  FLG-CHKT
                   END-IF
               ELSE
                   MOVE    1                   TO  FLG-CHKT
               END-IF
               IF      FLG-CHKT            =   1
      *
               MOVE    SPA-GMN-INPUTCD (SPA-GMN-IDX)
                                           TO  WRK-INPUTCD
               MOVE    SPACE               TO  SPA-GMN-INPUTCD
                                                         (SPA-GMN-IDX)
               MOVE    SPA-GAI-JIKANKBN    TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(1:1)
               MOVE    WRK-INPUTCD         TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(3:)
               MOVE    SPA-GAI-JIKANKBN    TO  SPA-COM-TIMEFLG
                                                     (SPA-GMN-IDX)
           END-IF
      *
           END-IF
      *
           MOVE    ZERO                TO  FLG-OK
      *
           MOVE    ZERO                TO  SPA-GAIRAISIN
           IF      SPA-SYOSIN      NOT =   1
      *        ³°Íè¿Ç»¡ÎÁ¤Î»þ
               IF      WRK-KAISU           =   3
                    MOVE    1               TO  SPA-GAIRAISIN
               END-IF
           END-IF
      *
      *TEST
      *!!!!!¼«Æ°»»Äê¤Î°ÌÃÖ¤Ë¤è¤êÊÑ¹¹
      *H30.4
      *    Ç¥ÉØ²Ã»»
      *    IF     (SPA-NINPUKBN-ARI    =   1   )
      *       OR  (FLG-NINPU-IN        =   1   )
      *        IF     (SPA-NENREI-YY       >=  6     )
      *            Ç¥ÉØÀßÄê¡¢Ç¥ÉØ²Ã»»ÆþÎÏ¤¢¤ê
      *            PERFORM 33021-NINPUKSN-ADD-SEC
      *        END-IF
      **** END-IF
      *
           IF      SPA-SYOSIN          =   1
      *        ½é¿Ç¤Î¼«Æ°È¯À¸¡Ê°é»ù±ÉÍÜ²Ã»»Åù¡Ë
               PERFORM 3302-IKUJIEIYO-SET-SEC
           END-IF
      *
      *£È£²£²Ç¯£´·î¤«¤é
      *    ºÆ¿ÇÎÁ¤Î²Ã»»
           IF     (SPA-SYOSIN          =   1 )  OR
                  (SPA-GAIRAISIN       =   1 )  OR
                  (SPA-HOSPSBT         =   1 )
               CONTINUE
           ELSE
      *        ÃÏ°è°åÎÅ¹×¸¥¡¦ÌÀºÙ½ñÈ¯¹ÔÂÎÀ©Åù²Ã»»
               PERFORM 33013-SAISINKSN-SEC
      *H30.4
      *        ÌôºÞÅ¬Àµ»ÈÍÑÏ¢·È²Ã»»¡ÊºÆ¿Ç¡Ë¤ÎÆþÎÏ¤¬¤¢¤ë»þ
               IF      WRK-SAI-SRYCD   NOT =   SPACE
                   MOVE    WRK-SAI-SRYCD       TO  WRK-SRYCD
      *            ÄÉ²Ã¶¦ÄÌ½èÍý
                   MOVE    ZERO                TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
               END-IF
           END-IF
      *
      *
           IF     (SPA-SYOSIN          =   1 )  OR
                  (SPA-GAIRAISIN       =   1 )
      *        ¼«Æ°È¯À¸¤Ê¤·
               OR (SPA-GAIKANRIKBN-CHK =   3 )
               CONTINUE
           ELSE
      *    ³°Íè´ÉÍý²Ã»»¥³¡¼¥ÉÄÉ²Ã
               IF     (SPA-SYORIFLG        =   ZERO  ) OR
                      ((FLG-GAI            =   1   ) AND
                       (SPA-SYORIFLG       =   1   ))
                   PERFORM 2002-SRYCD-TBLG-SEC
      *            ¿Ç»¡ÎÁÄÉ²Ã
                   IF      WRK-SRYCD       NOT =   SPACE
                       PERFORM 3301-SYOSIN-HEN-SEC
      *                ¼«Æ°»»Äê¤¢¤ê
                       IF      FLG-ADD             =   1
                           ADD     1               TO  IDX2
                       END-IF
                   END-IF
               END-IF
           END-IF
           .
       3301-SYOSIN-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÆ¿ÇÎÁ¼«Æ°È¯À¸½èÍý
      *****************************************************************
       3301-DOUSAISIN-SEC                  SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYCD
      *
           IF      SPA-SYOYMD          =   SPA-SRYYMD
      *        ½é¿Ç
               MOVE    "830000020"         TO  WRK-SRYCD
           ELSE
      *        ºÆ¿Ç
               MOVE    "830000021"         TO  WRK-SRYCD
           END-IF
      *
           MOVE    "0109"              TO  SPA-KIDCD
      *    Æþ±¡Æü¤Î»þ¡¢½é¿ÇÎÁ¤Î¤ß»»Äê¤¹¤ë
           IF      SPA-K02N-NYUINYMD   =   SPA-NAI-SRYYMD
               MOVE    SPACE               TO  SPA-KIDCD
           END-IF
      *
           .
       3301-DOUSAISIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿Ç»¡ÎÁÄÉ²Ã½èÍý
      *****************************************************************
       3301-SYOSIN-HEN-SEC                SECTION.
      *
           IF     (WRK-SRYCD(1:2)      =   "83"  )   AND
                  (SPA-GMN-IDX         =   ZERO  )
               ADD     1                   TO  IDX2
               ADD     1                   TO  SPA-GMN-IDX
      *        ¿ÇÎÅ¶èÊ¬ÊÔ½¸
               IF      WRK-SRYCD           =   "830000020"
                   MOVE    ".110"          TO  SPA-GMN-INPUTCD
                                                         (SPA-GMN-IDX)
                   MOVE    "110"           TO  SPA-COM-SRYSYUKBN
                                                         (SPA-GMN-IDX)
                   MOVE    "11"            TO  SPA-COM-SRYKBN
                                                         (SPA-GMN-IDX)
               ELSE
                   MOVE    ".120"          TO  SPA-GMN-INPUTCD
                                                         (SPA-GMN-IDX)
                   MOVE    "120"           TO  SPA-COM-SRYSYUKBN
                                                         (SPA-GMN-IDX)
                   MOVE    "12"            TO  SPA-COM-SRYKBN
                                                         (SPA-GMN-IDX)
               END-IF
           END-IF
      *
           MOVE    ZERO                TO  FLG-ADD
      *
           ADD     1                   TO  SPA-GMN-IDX
           IF      WRK-SRYCD(1:2)      =   "83"
               MOVE    SPA-TAKA-SRYKA(1)   TO  SPA-COM-ATAI1
                                                         (SPA-GMN-IDX)
               MOVE    1                   TO  SPA-FUKU-SRYKA
           END-IF
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           MOVE    "1"                 TO  LNK-SC92-KBN
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
      *    ·Ù¹ð¤Î¥Á¥§¥Ã¥¯¤Ê¤·
           MOVE    SPACE               TO  LNK-SC92-KEIFLG
           MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *    ½é¿ÇÎÁ¤ÎÊ»ÍÑ¥¨¥é¡¼
           IF      WRK-SRYKBN          =   "11"
               IF      LNK-SC92-SYOKBN     =   "1"
      *            Á°¤ËÊ»ÍÑ»»Äê¤¬¤¢¤ë»þ¡¢ÉÂÌ¾¤¬¤¹¤Ù¤Æ¼£Ìþ¤Ç¤¢¤ë¤³¤È
                   IF      SPA-BYOMEI-STR      =   ZERO
                       MOVE    1                   TO  SPA-SYOSIN-KEI
                   ELSE
                       MOVE    "0033"              TO  LNK-SC92-ERRCD6
                   END-IF
               END-IF
      *
      *H24.9
      *        ½é¿ÇÎÁ¤ÎÊ»ÍÑ¥¨¥é¡¼¤Ï»»Äê¤¹¤ë
               IF      LNK-SC92-ERRCD6     =   "0033"
                   MOVE    SPACE               TO  LNK-SC92-ERRCD6
                   MOVE    2                   TO  SPA-SYOSIN-KEI
               END-IF
      *H24.9
      *
           END-IF
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE           TO  SPA-ERRCD
               INITIALIZE              SPA-GMN-TBLREC (SPA-GMN-IDX)
               INITIALIZE              SPA-COM-TBLREC (SPA-GMN-IDX)
               COMPUTE SPA-GMN-IDX     =   SPA-GMN-IDX
                                       -   1
               GO      TO      3301-SYOSIN-HEN-EXT
           END-IF
      *    ¿ÇÎÅ¶èÊ¬¤ÎÀßÄê
           IF      SPA-COM-SRYKBN(SPA-GMN-IDX) =   SPACE
      ***      MOVE    SPA-COM-SRYSYUKBN(SPA-GMN-IDX)
               MOVE    SPA-COM-TNSSRYKBN(SPA-GMN-IDX)
                                           TO  SPA-COM-SRYKBN
                                                         (SPA-GMN-IDX)
           END-IF
      *
      *!!
      *H31.2
      *    Ê»ÍÑ»»ÄêºÆ¥Á¥§¥Ã¥¯¤ò¹Ô¤¦
           MOVE    SPACE           TO  SPA-COM-HCHKFLG(SPA-GMN-IDX)
           MOVE    SPACE           TO  SPA-COM-HKEIFLG(SPA-GMN-IDX)
      *!!
      *
      *!!!!!!!!!!!!!!!!
      *??  ²Ã»»¼«Æ°È¯À¸ºÑ¤ßÀßÄê
      *    IF     (WRK-SRYCD(1:1)      =   "1" )
      *       AND (SPA-COM-DATAKBN(SPA-GMN-IDX)    =   "1" )
      *        MOVE    "1"             TO  SPA-COM-KSNAUTO
      *                                                  (SPA-GMN-IDX)
      *??? END-IF
      *
           IF      WRK-SRYCD(1:2)      =   "83"
      *        ºÆÊÔ½¸½èÍý
               MOVE    SPA-GMN-IDX         TO  IDX
               PERFORM 3101-INPUTCD-HEN-SEC
           END-IF
      *
           MOVE    1                   TO  FLG-ADD
           .
       3301-SYOSIN-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *   °é»ù±ÉÍÜ²Ã»»¼«Æ°È¯À¸½èÍý
      *****************************************************************
       3302-IKUJIEIYO-SET-SEC                  SECTION.
      *
      *H30.4
      *    µ¡Ç½¶¯²½²Ã»»
           PERFORM 33021-KYOUKAKSN-ADD-SEC
      *
      *    °é»ù±ÉÍÜ²Ã»»¼«Æ°»»Äê
           IF      SPA-IKUJIEIYO-FLG   NOT =   "1"
               GO      TO      3302-IKUJIEIYO-SET-EXT
           END-IF
      *    £³ºÐ¤Ë¤Ê¤ëÇ¯·îÆü¤ò·×»»
           MOVE    SPA-BIRTHDAY        TO  WRK-BIRTHDAY
           COMPUTE WRK-BIRTH-YY        =   WRK-BIRTH-YY    +  3
      *    £³ºÐÌ¤Ëþ¤ËÅ¬ÍÑ
           IF      WRK-BIRTHDAY(1:6)   <   SPA-SRYYMD (1:6)
               GO      TO      3302-IKUJIEIYO-SET-EXT
           END-IF
      *
      *    °é»ù±ÉÍÜ²Ã»»¼«Æ°»»Äê²Ê
           IF     (SPA-IKUJIEIYO-SRYKA =   ZERO      )  OR
                  (SPA-IKUJIEIYO-SRYKA =   SPA-SRYKA )
               CONTINUE
           ELSE
               GO      TO      3302-IKUJIEIYO-SET-EXT
           END-IF
      *
      *    ½é¿Ç¡Ê°é»ù±ÉÍÜ»ØÆ³¡Ë²Ã»»
           MOVE    "111000470"         TO  WRK-SRYCD
      *    ÄÉ²Ã¶¦ÄÌ½èÍý
           MOVE    ZERO                TO  WRK-IDX-IN
           PERFORM 33041-SRYCD-ADD-SEC
      *
           .
       3302-IKUJIEIYO-SET-EXT.
           EXIT.
      *H30.4
      *****************************************************************
      *   µ¡Ç½¶¯²½²Ã»»ÊÔ½¸½èÍý
      *****************************************************************
       33021-KYOUKAKSN-ADD-SEC         SECTION.
      *
      **   IF      SPA-KYOUKAKSN       =   ZERO
      *        GO    TO      33021-KYOUKAKSN-ADD-EXT
      **   END-IF
      *
      *    µ¡Ç½¶¯²½²Ã»»
           MOVE    "111013770"         TO  WRK-SRYCD
           IF      FLG-SYONIKA         =   1
      *        µ¡Ç½¶¯²½²Ã»»¡Ê¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ë
               MOVE    "113028870"         TO  WRK-SRYCD
           END-IF
           IF      FLG-SYONIKKR         =   1
      *        µ¡Ç½¶¯²½²Ã»»¡Ê¾®»ù¤«¤«¤ê¤Ä¤±¡Ë
               MOVE    "113028970"         TO  WRK-SRYCD
           END-IF
      *
      *    ÄÉ²Ã¶¦ÄÌ½èÍý
           MOVE    ZERO                TO  WRK-IDX-IN
           IF      WRK-IDX-INS         >   ZERO
               MOVE    WRK-IDX-INS         TO  WRK-IDX-IN
           END-IF
           PERFORM 33041-SRYCD-ADD-SEC
           .
       33021-KYOUKAKSN-ADD-EXT.
           EXIT.
      *****************************************************************
      *   ÃÏ°è°åÎÅ¹×¸¥¡¦ÌÀºÙ½ñÈ¯¹ÔÂÎÀ©Åù²Ã»»ÊÔ½¸½èÍý
      *****************************************************************
       33013-SAISINKSN-SEC                  SECTION.
      *
      *H24.4
      *    »þ´Ö³°ÂÐ±þ²Ã»»¡ÊÃÏ°è°åÎÅ¹×¸¥²Ã»»¡Ë
           EVALUATE    SPA-CHIIKKBN
               WHEN    1
      *            »þ´Ö³°ÂÐ±þ²Ã»»£±
                   MOVE    TBL-CHISRYCD1       TO  WRK-SRYCD
                   MOVE    ZERO                TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
               WHEN    2
      *            »þ´Ö³°ÂÐ±þ²Ã»»£²
                   MOVE    TBL-CHISRYCD2       TO  WRK-SRYCD
                   MOVE    ZERO                TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
               WHEN    3
      *            »þ´Ö³°ÂÐ±þ²Ã»»£³
                   MOVE    TBL-CHISRYCD3       TO  WRK-SRYCD
                   MOVE    ZERO                TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
           END-EVALUATE
      *    ÌÀºÙÈ¯¹ÔÂÎÀ©Åù²Ã»»
           IF      SPA-MEISAKBN        =   1
               MOVE    TBL-MEISRYCD        TO  WRK-SRYCD
      *        ÄÉ²Ã¶¦ÄÌ½èÍý
               MOVE    ZERO                TO  WRK-IDX-IN
               PERFORM 33041-SRYCD-ADD-SEC
           END-IF
      *
      *H28.4
      *    Ç§ÃÎ¾ÉÃÏ°èÊñ³ç¿ÇÎÅ²Ã»»
           IF      SPA-NNCHIH-ARI      =   1
               MOVE    CONS-NNCHIKSN1      TO  WRK-SRYCD
      *        ÄÉ²Ã¶¦ÄÌ½èÍý
               MOVE    ZERO                TO  WRK-IDX-IN
               PERFORM 33041-SRYCD-ADD-SEC
      *???
      *H30.4
      *    Ç§ÃÎ¾ÉÃÏ°èÊñ³ç¿ÇÎÅ²Ã»»£²
               IF      FLG-ADD             =   ZERO
                   MOVE    CONS-NNCHIKSN2      TO  WRK-SRYCD
      *            ÄÉ²Ã¶¦ÄÌ½èÍý
                   MOVE    ZERO                TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
               END-IF
           ELSE
      *H26.4
      *        ÃÏ°èÊñ³ç¿ÇÎÅ²Ã»»£±
               IF      SPA-CHKHKTBYO-ARI   =   1
                   MOVE    TBL-CHKCARKSN1      TO  WRK-SRYCD
      *            ÄÉ²Ã¶¦ÄÌ½èÍý
                   MOVE    ZERO                TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
      *???
      *H30.4
      *        ÃÏ°èÊñ³ç¿ÇÎÅ²Ã»»£²
               IF      FLG-ADD             =   ZERO
                   MOVE    TBL-CHKCARKSN2      TO  WRK-SRYCD
      *            ÄÉ²Ã¶¦ÄÌ½èÍý
                   MOVE    ZERO                TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
               END-IF
               END-IF
           END-IF
      *
           .
       33013-SAISINKSN-EXT.
           EXIT.
      *
      *H30.4 
      ******************************************************************
      *   Ç¥ÉØ²Ã»»ÊÔ½¸½èÍý
      *****************************************************************
       33021-NINPUKSN-ADD-SEC          SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYCD
           MOVE    SPACE               TO  WRK-TIME-KBN1
           MOVE    SPACE               TO  WRK-TIME-KBN2
           MOVE    SPACE               TO  WRK-TIME-KBN3
           MOVE    "0"                 TO  WRK-TIME-TIMKBN
           IF      SPA-SYOSIN          =   1
      *        ½é¿Ç
               MOVE    "1"                 TO  WRK-TIME-KBN1
           ELSE
               IF      SPA-GAIRAISIN       =   1
      *        ³°Íè¿ÇÎÅÎÁ
                   MOVE    "2"                 TO  WRK-TIME-KBN1
                   MOVE    "G"                 TO  WRK-TIME-KBN3
               ELSE
      *        ºÆ¿Ç
                   MOVE    "2"                 TO  WRK-TIME-KBN1
               END-IF
           END-IF
      *
           SET     TBL-NPIDX18         TO  1
           SEARCH  TBL-NINPUKSN18-OCC  VARYING   TBL-NPIDX18
              AT   END
                   MOVE    SPACE               TO  WRK-SRYCD
               WHEN   (TBL-NP18-KBN1(TBL-NPIDX18)
                                           =   WRK-TIME-KBN1)
                 AND  (TBL-NP18-KBN3(TBL-NPIDX18)
                                           =   WRK-TIME-KBN3)
                 AND  (TBL-NP18-TIMKBN(TBL-NPIDX18)
                                           =   WRK-TIME-TIMKBN )
                   MOVE    TBL-NP18-SRYCD (TBL-NPIDX18)
                                               TO  WRK-SRYCD
           END-SEARCH
      *    ÄÉ²Ã¶¦ÄÌ½èÍý
           MOVE    ZERO                TO  WRK-IDX-IN
           PERFORM 33041-SRYCD-ADD-SEC
      *
           .
       33021-NINPUKSN-ADD-EXT.
           EXIT.
      *
      *****************************************************************
      *   ÆþÎÏ¥³¡¼¥É¤Î²èÌÌÍÑºÆÊÔ½¸½èÍý
      *****************************************************************
       3101-INPUTCD-HEN-SEC                  SECTION.
      *
      *    ²èÌÌºÆÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC94AREA
           MOVE    "1"                 TO  LNK-SC94-KBN
           MOVE    "K02"               TO  LNK-SC94-PG
           MOVE    IDX                 TO  LNK-SC94-IDX
           CALL    "ORCSC94"           USING
                                       ORCSC94AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *
           IF      SPA-GMN-IDX         >   1
               MOVE    SPA-COM-SRYSYUKBN (SPA-GMN-IDX - 1)
                                           TO  SPA-COM-SRYSYUKBN
                                                         (SPA-GMN-IDX)
               MOVE    SPA-COM-SRYKBN (SPA-GMN-IDX - 1)
                                           TO  SPA-COM-SRYKBN
                                                         (SPA-GMN-IDX)
           END-IF
      *
           .
       3101-INPUTCD-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê¼«Æ°È¯À¸½èÍý
      *****************************************************************
       3303-SYONIKA-SET-SEC            SECTION.
      *
           MOVE    ZERO                TO  FLG-SYONIKA
      *
           MOVE    SPACE               TO  WRK-SRYCD
      *    ±¡³°½èÊý
           IF      SPA-INGAIKBN        =   "1"
               IF      SPA-SYOSIN          =   1
      *            ½é¿Ç
                   MOVE    "113003510"         TO  WRK-SRYCD
               ELSE
      *            ºÆ¿Ç
                   MOVE    "113003610"         TO  WRK-SRYCD
               END-IF
           ELSE
      *        ±¡Æâ½èÊý
               IF      SPA-SYOSIN          =   1
      *            ½é¿Ç
                   MOVE    "113003710"         TO  WRK-SRYCD
               ELSE
      *            ºÆ¿Ç
                   MOVE    "113003810"         TO  WRK-SRYCD
               END-IF
           END-IF
      *
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê»»Äê
      *
           MOVE    ZERO                TO  FLG-ADD
      *
           IF      WRK-IDX-IN          =   ZERO
               ADD     1                   TO  IDX2
               ADD     1                   TO  SPA-GMN-IDX
           ELSE
               MOVE    WRK-IDX-IN          TO  IDX2
               MOVE    WRK-IDX-IN          TO  SPA-GMN-IDX
           END-IF
      *
           MOVE    SPA-SCR-REC         TO  WRK-SCR-REC
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           IF      WRK-IDX-IN          =   ZERO
      *        ½é´ü»»Äê
               MOVE    "1"                 TO  LNK-SC92-KBN
               MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
               MOVE    ZERO                TO  FLG-JIKAN
           ELSE
      *        ±¡³°±¡ÆâÊÑ¹¹
               MOVE    SPACE               TO  LNK-SC92-KBN
               MOVE    WRK-IDX-IN          TO  LNK-SC92-GMN-IDX
               MOVE    SPA-COM-TIMEFLG(WRK-IDX-IN)
                                           TO  FLG-JIKAN
               INITIALIZE                      SPA-COM-TBLREC
                                                        (WRK-IDX-IN)
               MOVE    WRK-SRYCD           TO  SPA-COM-INPUTCD
                                                        (WRK-IDX-IN)
               MOVE    FLG-JIKAN           TO  SPA-COM-TIMEFLG
                                                        (WRK-IDX-IN)
           END-IF
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *
      *    Ç¯Îð¥¨¥é¡¼¤Î»þ¡¢¥¨¥é¡¼¤ò¤Ï¤º¤¹¡ÊÅö·î¤Ï£Ï£Ë¡Ë
           IF      LNK-SC92-ERRCD5 NOT =   SPACE
      *        Åö·î»»ÄêºÑ¤ß
               IF     (SPA-SYONIKA-ARI3    =   ZERO )
                   CONTINUE
               ELSE
                   MOVE    SPACE               TO  LNK-SC92-ERRCD5
               END-IF
           END-IF
      *
      *    Æ±ÆüºÆ¿Ç»þ¡¢Ê»ÍÑ»»Äê¥¨¥é¡¼
           IF      LNK-SC92-ERRCD3 NOT =   SPACE
               MOVE    SPACE               TO  SPA-ERRCD
               MOVE    WRK-SCR-REC         TO  SPA-SCR-REC
               MOVE    ZERO                TO  SPA-GMN-IDX
               MOVE    ZERO                TO  IDX2
               MOVE    1                   TO  FLG-SYONIKA
               MOVE    2                   TO  SPA-SYONIKA-ARI
               MOVE    1                   TO  SPA-SYONIKA-ARI2
               GO      TO      3303-SYONIKA-SET-EXT
           END-IF
      *
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE           TO  SPA-ERRCD
               MOVE    WRK-SCR-REC     TO  SPA-SCR-REC
               MOVE    ZERO            TO  SPA-GMN-IDX
               MOVE    ZERO            TO  IDX2
               GO      TO      3303-SYONIKA-SET-EXT
           END-IF
      *
      *    »»Äê¤¬¤¢¤ê¡¢´û¤ËÅöÆüÂ¾¤Î¿Ç»¡ÎÁ¤ò»»Äê¤·¤Æ¤¤¤ë»þ¡¢¥¨¥é¡¼
           IF     (SPA-SYOSIN          =   ZERO  )  AND
      ********** ((SPA-LSTYMD          =   SPA-SRYYMD) OR
                 ((SPA-LSTYMD          =   SPA-SRYYMD) AND
                  (WRK-DAY-SINSATUCNT  >   ZERO    )) AND
                  (SPA-SYORIFLG        =   ZERO   )
               MOVE    WRK-SCR-REC         TO  SPA-SCR-REC
               MOVE    1                   TO  FLG-SYONIKA
               MOVE    ZERO                TO  SPA-GMN-IDX
               MOVE    ZERO                TO  IDX2
               MOVE    "K005"              TO  SPA-ERRCD
               GO      TO      3303-SYONIKA-SET-EXT
           END-IF
      *
      *    ºÆÊÔ½¸½èÍý
           MOVE    SPA-GMN-IDX         TO  IDX
           PERFORM 3101-INPUTCD-HEN-SEC
      *
      *    ³°Íè¤Ç¿Ç»¡ÎÁ¤Î»þ¡¢»þ´Ö³°¶èÊ¬¤òÉÕ¤±¤ë
           IF     (SPA-SYORIFLG        =   ZERO )  AND
                  (SPA-NYUGAIKBN       =   "2"  )  AND
                  (SPA-SRYYMD          =   SPA-SYSYMD) AND
                  (SPA-GAI-JIKANKBN    NOT =   ZERO )  AND
      *           ¿Ç»¡ÎÁºÆ»»Äê»þ¤ÏÉÕ¤±¤Ê¤¤
                  (FLG-JIKANKBN        =   ZERO )
      *           »þ´Ö³°»ØÄê¤¬Ìµ¤¤»þ
             AND  (SPA-COM-TIMEFLG (SPA-GMN-IDX) =   ZERO )
      *            Ìë´Ö¡¦ÁáÄ«²Ã»»¤Ï¤Ê¤·
               IF     (SPA-GAI-JIKANKBN    NOT =   8    ) 
                   MOVE    SPA-GMN-INPUTCD (SPA-GMN-IDX)
                                               TO  WRK-INPUTCD
                   MOVE    SPACE               TO  SPA-GMN-INPUTCD
                                                         (SPA-GMN-IDX)
                   MOVE    SPA-GAI-JIKANKBN    TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(1:1)
                   MOVE    WRK-INPUTCD         TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(3:)
                   MOVE    SPA-GAI-JIKANKBN    TO  SPA-COM-TIMEFLG
                                                     (SPA-GMN-IDX)
               END-IF
           END-IF
      *
           MOVE    1                   TO  FLG-SYONIKA
           MOVE    1                   TO  SPA-SYONIKA-ARI
      *R02.1
      *    ±¡Æâ±¡³°ÀÚÂØ¤Ï¿Ç»¡ÎÁ¤Î¤ßÊÑ´¹
           IF      LNK-SC10S-SYORI   =   "4"
               GO  TO  3303-SYONIKA-SET-EXT
           END-IF
      *
      *H30.4
           IF      SPA-GMN-IDX         >   ZERO
               IF      SPA-SYOSIN          =   1
      *            µ¡Ç½¶¯²½²Ã»»
                   PERFORM 33021-KYOUKAKSN-ADD-SEC
               END-IF
           END-IF
      *H30.4
      *    ¾®»ù¹³¶ÝÅ¬ÀµÌô»ÈÍÑ²Ã»»¡Ê¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ë
           IF      SPA-GMN-IDX         >   ZERO
               IF      WRK-SYO-SRYCD   NOT =   SPACE
                   MOVE    WRK-SYO-SRYCD       TO  WRK-SRYCD
                   MOVE    ZERO                TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
               END-IF
           END-IF
      *
           IF      SPA-GMN-IDX         >   ZERO
      *        ÎÅÍÜÃ´Åö¼êÅö¡ÊËÌ³¤Æ»¡Ë
               PERFORM 330123-RYOYOU-TEATE-SEC
           END-IF
           .
       3303-SYONIKA-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅ²Ê¼«Æ°È¯À¸½èÍý
      *****************************************************************
       3304-SYOUNIKAKARI-SET-SEC            SECTION.
      *
           MOVE    ZERO                TO  FLG-SYONIKKR
      *
           MOVE    SPACE               TO  WRK-SRYCD
      *    ±¡³°½èÊý
           IF      SPA-INGAIKBN        =   "1"
               IF      SPA-SYOSIN          =   1
      *            ½é¿Ç
                   MOVE    "113019710"         TO  WRK-SRYCD
               ELSE
      *            ºÆ¿Ç
                   MOVE    "113019810"         TO  WRK-SRYCD
               END-IF
           ELSE
      *        ±¡Æâ½èÊý
               IF      SPA-SYOSIN          =   1
      *            ½é¿Ç
                   MOVE    "113019910"         TO  WRK-SRYCD
               ELSE
      *            ºÆ¿Ç
                   MOVE    "113020010"         TO  WRK-SRYCD
               END-IF
           END-IF
      *
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê»»Äê
      *
           MOVE    ZERO                TO  FLG-ADD
      *
           IF      WRK-IDX-IN          =   ZERO
               ADD     1                   TO  IDX2
               ADD     1                   TO  SPA-GMN-IDX
           ELSE
               MOVE    WRK-IDX-IN          TO  IDX2
               MOVE    WRK-IDX-IN          TO  SPA-GMN-IDX
           END-IF
      *
           MOVE    SPA-SCR-REC         TO  WRK-SCR-REC
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           IF      WRK-IDX-IN          =   ZERO
      *        ½é´ü»»Äê
               MOVE    "1"                 TO  LNK-SC92-KBN
               MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
               MOVE    ZERO                TO  FLG-JIKAN
           ELSE
      *        ±¡³°±¡ÆâÊÑ¹¹
               MOVE    SPACE               TO  LNK-SC92-KBN
               MOVE    WRK-IDX-IN          TO  LNK-SC92-GMN-IDX
               MOVE    SPA-COM-TIMEFLG(WRK-IDX-IN)
                                           TO  FLG-JIKAN
               INITIALIZE                      SPA-COM-TBLREC
                                                        (WRK-IDX-IN)
               MOVE    WRK-SRYCD           TO  SPA-COM-INPUTCD
                                                        (WRK-IDX-IN)
               MOVE    FLG-JIKAN           TO  SPA-COM-TIMEFLG
                                                        (WRK-IDX-IN)
           END-IF
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *
      *    Ç¯Îð¥¨¥é¡¼¤Î»þ¡¢¥¨¥é¡¼¤ò¤Ï¤º¤¹
           IF      LNK-SC92-ERRCD5 NOT =   SPACE
               MOVE    SPACE               TO  LNK-SC92-ERRCD5
           END-IF
      *
      *    Æ±ÆüºÆ¿Ç»þ¡¢Ê»ÍÑ»»Äê¥¨¥é¡¼
           IF      LNK-SC92-ERRCD3 NOT =   SPACE
               MOVE    SPACE               TO  SPA-ERRCD
               MOVE    WRK-SCR-REC         TO  SPA-SCR-REC
               MOVE    ZERO                TO  SPA-GMN-IDX
               MOVE    ZERO                TO  IDX2
               MOVE    1                   TO  FLG-SYONIKKR
               MOVE    2                   TO  SPA-SYONIKKR-ARI
               MOVE    1                   TO  SPA-SYONIKKR-ARI2
               GO      TO      3304-SYOUNIKAKARI-SET-EXT
           END-IF
      *
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE           TO  SPA-ERRCD
               MOVE    WRK-SCR-REC     TO  SPA-SCR-REC
               MOVE    ZERO            TO  SPA-GMN-IDX
               MOVE    ZERO            TO  IDX2
               GO      TO      3304-SYOUNIKAKARI-SET-EXT
           END-IF
      *
      *    »»Äê¤¬¤¢¤ê¡¢´û¤ËÅöÆüÂ¾¤Î¿Ç»¡ÎÁ¤ò»»Äê¤·¤Æ¤¤¤ë»þ¡¢¥¨¥é¡¼
           IF     (SPA-SYOSIN          =   ZERO  )  AND
                 ((SPA-LSTYMD          =   SPA-SRYYMD) AND
                  (WRK-DAY-SINSATUCNT  >   ZERO    )) AND
                  (SPA-SYORIFLG        =   ZERO   )
               MOVE    WRK-SCR-REC         TO  SPA-SCR-REC
               MOVE    1                   TO  FLG-SYONIKKR
               MOVE    ZERO                TO  SPA-GMN-IDX
               MOVE    ZERO                TO  IDX2
               MOVE    "K005"              TO  SPA-ERRCD
               GO      TO      3304-SYOUNIKAKARI-SET-EXT
           END-IF
      *
      *    ºÆÊÔ½¸½èÍý
           MOVE    SPA-GMN-IDX         TO  IDX
           PERFORM 3101-INPUTCD-HEN-SEC
      *
      *    ³°Íè¤Ç¿Ç»¡ÎÁ¤Î»þ¡¢»þ´Ö³°¶èÊ¬¤òÉÕ¤±¤ë
           IF     (SPA-SYORIFLG        =   ZERO )  AND
                  (SPA-NYUGAIKBN       =   "2"  )  AND
                  (SPA-SRYYMD          =   SPA-SYSYMD) AND
                  (SPA-GAI-JIKANKBN    NOT =   ZERO )  AND
      *           ¿Ç»¡ÎÁºÆ»»Äê»þ¤ÏÉÕ¤±¤Ê¤¤
                  (FLG-JIKANKBN        =   ZERO )
      *           »þ´Ö³°»ØÄê¤¬Ìµ¤¤»þ
             AND  (SPA-COM-TIMEFLG (SPA-GMN-IDX) =   ZERO )
      *            Ìë´Ö¡¦ÁáÄ«²Ã»»¤Ï¤Ê¤·
               IF     (SPA-GAI-JIKANKBN    NOT =   8    ) 
                   MOVE    SPA-GMN-INPUTCD (SPA-GMN-IDX)
                                               TO  WRK-INPUTCD
                   MOVE    SPACE               TO  SPA-GMN-INPUTCD
                                                         (SPA-GMN-IDX)
                   MOVE    SPA-GAI-JIKANKBN    TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(1:1)
                   MOVE    WRK-INPUTCD         TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(3:)
                   MOVE    SPA-GAI-JIKANKBN    TO  SPA-COM-TIMEFLG
                                                     (SPA-GMN-IDX)
               END-IF
           END-IF
      *
           MOVE    1                   TO  FLG-SYONIKKR
           MOVE    1                   TO  SPA-SYONIKKR-ARI
      *
      *R02.1
      *    ±¡Æâ±¡³°ÀÚÂØ¤Ï¿Ç»¡ÎÁ¤Î¤ßÊÑ´¹
           IF      LNK-SC10S-SYORI   =   "4"
               GO  TO  3304-SYOUNIKAKARI-SET-EXT
           END-IF
      *
      *H30.4
           IF      SPA-GMN-IDX         >   ZERO
               IF      SPA-SYOSIN          =   1
      *            µ¡Ç½¶¯²½²Ã»»
                   PERFORM 33021-KYOUKAKSN-ADD-SEC
               END-IF
           END-IF
      *H30.4
      *    ¾®»ù¹³¶ÝÅ¬ÀµÌô»ÈÍÑ²Ã»»¡Ê¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ë
           IF      SPA-GMN-IDX         >   ZERO
               IF      WRK-SYO-SRYCD   NOT =   SPACE
                   MOVE    WRK-SYO-SRYCD       TO  WRK-SRYCD
                   MOVE    ZERO                TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
               END-IF
           END-IF
      *
           IF      SPA-GMN-IDX         >   ZERO
      *        ÎÅÍÜÃ´Åö¼êÅö¡ÊËÌ³¤Æ»¡Ë
               PERFORM 330123-RYOYOU-TEATE-SEC
           END-IF
           .
       3304-SYOUNIKAKARI-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÄÉ²Ã¶¦ÄÌ½èÍý½èÍý
      *****************************************************************
       33041-SRYCD-ADD-SEC          SECTION.
      *
           MOVE    ZERO                TO  FLG-ADD
      *
           IF      WRK-IDX-IN          =   ZERO
               ADD     1                   TO  IDX2
               ADD     1                   TO  SPA-GMN-IDX
           ELSE
               MOVE    WRK-IDX-IN          TO  IDX2
               MOVE    WRK-IDX-IN          TO  SPA-GMN-IDX
           END-IF
           MOVE    ZERO                TO  WRK-IN-KAISU
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           IF      WRK-IDX-IN          =   ZERO
               MOVE    "1"                 TO  LNK-SC92-KBN
               MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
           ELSE
               MOVE    SPACE               TO  LNK-SC92-KBN
               MOVE    WRK-IDX-IN          TO  LNK-SC92-GMN-IDX
               MOVE    SPA-COM-TIMEFLG(WRK-IDX-IN)
                                           TO  FLG-JIKAN
      *        ²ó¿ô£±°Ê¾å
               IF      (SPA-COM-KAIFLG (WRK-IDX-IN)    =   "1")  AND
                       (SPA-COM-KAISU  (WRK-IDX-IN)    >   1  )
                   MOVE    SPA-COM-KAISU  (WRK-IDX-IN)
                                               TO  WRK-IN-KAISU
               ELSE
                   MOVE    ZERO                TO  WRK-IN-KAISU
               END-IF
      *
               INITIALIZE                      SPA-COM-TBLREC
                                                        (WRK-IDX-IN)
               MOVE    WRK-SRYCD           TO  SPA-COM-INPUTCD
                                                        (WRK-IDX-IN)
               IF      FLG-JIKAN           >   ZERO
                   MOVE    FLG-JIKAN           TO  SPA-GMN-INPUTCD
                                                    (WRK-IDX-IN)(1:1)
                   MOVE    WRK-SRYCD           TO  SPA-GMN-INPUTCD
                                                    (WRK-IDX-IN)(3:)
               ELSE
                   MOVE    WRK-SRYCD           TO  SPA-GMN-INPUTCD
                                                        (WRK-IDX-IN)
               END-IF
               MOVE    FLG-JIKAN           TO  SPA-COM-TIMEFLG
                                                        (WRK-IDX-IN)
           END-IF
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE           TO  SPA-ERRCD
               INITIALIZE              SPA-GMN-TBLREC (SPA-GMN-IDX)
               INITIALIZE              SPA-COM-TBLREC (SPA-GMN-IDX)
               COMPUTE SPA-GMN-IDX     =   SPA-GMN-IDX     -   1
               COMPUTE IDX2            =   IDX2            -   1
           ELSE
      *        ²ó¿ô¤ÎºÆÊÔ½¸
               IF      WRK-IN-KAISU        >   ZERO
                   MOVE    WRK-IN-KAISU        TO  SPA-COM-KAISU
                                                        (SPA-GMN-IDX)
                   MOVE    "1"                 TO  SPA-COM-KAIFLG
                                                        (SPA-GMN-IDX)
      *            ºÆÊÔ½¸½èÍý
                   MOVE    SPA-GMN-IDX         TO  IDX
                   PERFORM 3101-INPUTCD-HEN-SEC
               END-IF
               MOVE    1                  TO  FLG-ADD
           END-IF
      *
           .
       33041-SRYCD-ADD-EXT.
           EXIT.
      *----(01.00.02) LINE ADD END   ----------------------------------
      *
      *****************************************************************
      *    ÂÐ¾Ý¤Î»»ÄêÍúÎòÈ½Äê½èÍý
      *****************************************************************
       200511-SANTEI-CHK-SEC                SECTION.
      *
           MOVE    ZERO                TO  FLG-SANTEI-OK
      *
           EVALUATE    TRUE
      *        »»ÄêÍúÎò¶èÊ¬¡á£±
               WHEN   (SANTEI-NYUGAIKBN    =   ZERO )  AND
                      (SANTEI-SRYKA        =   ZERO )
                   MOVE    1                   TO  FLG-SANTEI-OK
      *        »»ÄêÍúÎò¶èÊ¬¡á£²
               WHEN   (SANTEI-NYUGAIKBN    =   SPA-NYUGAIKBN) AND
                      (SANTEI-SRYKA        =   ZERO )
                   MOVE    1                   TO  FLG-SANTEI-OK
      *
      *        »»ÄêÍúÎò¶èÊ¬¡á£³
               WHEN   (SANTEI-NYUGAIKBN    =   ZERO )  AND
                      (SANTEI-SRYKA        =   SPA-SRYKA )
                   MOVE    1                   TO  FLG-SANTEI-OK
      *
      *        »»ÄêÍúÎò¶èÊ¬¡á£´
               WHEN   (SANTEI-NYUGAIKBN    =   SPA-NYUGAIKBN) AND
                      (SANTEI-SRYKA        =   SPA-SRYKA )
                   MOVE    1                   TO  FLG-SANTEI-OK
           END-EVALUATE
      *
           .
       200511-SANTEI-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    »ØÆ³ÎÁ¤Î¼«Æ°È¯À¸½èÍý
      *****************************************************************
       33012-SIDOU-SYORI-SEC           SECTION.
      *
      *    ÆÃÄê¼À´µ²Ê
           MOVE    ZERO                TO  FLG-TOKUTEI
           MOVE    ZERO                TO  FLG-TOKUTEI05
           MOVE    ZERO                TO  FLG-ATOPII
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   10  )  OR
                              (SPA-TOKU-SRYKA(IDX) =   SPACE ) OR
                              (FLG-TOKUTEI     NOT =   ZERO )
               IF      SPA-TOKU-SRYKA (IDX)    =   WRK-SRYKA
                   MOVE    SPA-TOKU-FLG (IDX)      TO  FLG-TOKUTEI
                   MOVE    SPA-TOKU05-FLG (IDX)    TO  FLG-TOKUTEI05
                   MOVE    SPA-ATOPII  (IDX)       TO  FLG-ATOPII
               END-IF
           END-PERFORM
      *
      *    ³°ÍèÆñÉÂ¼À´µ
           IF      FLG-TOKUTEI         =   09
      *        ÆÃÄê¼À´µÎÅÍÜ»ØÆ³ÎÁ»»ÄêºÑ¤ß¤Ç¤¢¤ì¤Ð¡¢»ØÆ³ÎÁ
               IF      SPA-TOKUTEI-CNT     >   ZERO
                   MOVE    FLG-TOKUTEI05       TO  FLG-TOKUTEI
                END-IF
           END-IF
      *    ³°ÍèÆñÉÂ¼À´µ
           IF      FLG-TOKUTEI         =   09
               PERFORM 330123-NANBYOU-SIDOU-SEC
           END-IF
      *    ÆÃÄê¼À´µÎÅÍÜ»ØÆ³ÎÁ
           IF      FLG-TOKUTEI         =   05
                                       OR  08
               PERFORM 330121-TOKUTEI-SIDOU-SEC
           END-IF
      *
      *    ÈéÉæ²ÊÆÃÄê¼À´µ
           IF      FLG-TOKUTEI         =   03
                                       OR  04
               PERFORM 330122-HIFUKA-SIDOU-SEC
           END-IF
      *
           .
       33012-SIDOU-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    »ØÆ³ÎÁ¤Î¼«Æ°È¯À¸½èÍý
      *****************************************************************
       330121-TOKUTEI-SIDOU-SEC      SECTION.
      *
           EVALUATE    SPA-HOSPSBT
      *        °ìÈÌ¡¡ÉÂ±¡
               WHEN    1
                   IF      SPA-BEDSU           <   100
                       MOVE    "113001910"         TO  WRK-SRYCD
                   ELSE
                       MOVE    "113002010"         TO  WRK-SRYCD
                   END-IF
      *        °ìÈÌ¡¢¿ÇÎÅ½ê
               WHEN    2
                   MOVE    "113001810"         TO  WRK-SRYCD
           END-EVALUATE
      *
      *    ¼«Æ°È¯À¸¶èÊ¬È½Äê
           IF      SPA-BYOMEIAUTO-FLG  =  "1"
      *        »ØÆ³ÎÁÄÉ²Ã¡¢¥Á¥§¥Ã¥¯½èÍý
               MOVE    ZERO                TO  FLG-SIDOU
               PERFORM 3301211-SIDOU-ADD-SEC
      *
               IF      FLG-ADD2            =   1
                   MOVE    1                   TO  SPA-TOKUTEI-CNT
               END-IF
           END-IF
           .
       330121-TOKUTEI-SIDOU-EXT.
           EXIT.
      *****************************************************************
      *    ÆñÉÂ³°Íè»ØÆ³ÎÁ¤Î¼«Æ°È¯À¸½èÍý
      *****************************************************************
       330123-NANBYOU-SIDOU-SEC      SECTION.
      *
           MOVE    "113002910"         TO  WRK-SRYCD
      *
      *    ¼«Æ°È¯À¸¶èÊ¬È½Äê
           IF      SPA-BYOMEIAUTO-FLG  =  "1"
      *        »ØÆ³ÎÁÄÉ²Ã¡¢¥Á¥§¥Ã¥¯½èÍý
               MOVE    ZERO                TO  FLG-SIDOU
               PERFORM 3301211-SIDOU-ADD-SEC
      *        ÄÉ²Ã¥¨¥é¡¼¤È¤Ê¤Ã¤¿»þ¡¢ÆÃÄê¼À´µÎÅÍÜ»ØÆ³ÎÁ¤Ø
               IF     (FLG-ADD2            =   ZERO )
               AND    (FLG-TOKUTEI05   NOT =   ZERO )
                   MOVE    FLG-TOKUTEI05       TO  FLG-TOKUTEI
               END-IF
           END-IF
           .
       330123-NANBYOU-SIDOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    »ØÆ³ÎÁÊÔ½¸¡¦¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       3301211-SIDOU-ADD-SEC           SECTION.
      *
          MOVE    ZERO                 TO  FLG-ADD2
          EVALUATE    LNK-SC10S-SYORI
      *        ÃæÅÓ½ªÎ»Å¸³«
               WHEN    "W"
      *        ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý
               WHEN    "S"
      *        ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý¡ÊÂ¾ÊÝ¸±¼õ¿Ç¤¢¤ê¤ÇÆ±ÆüºÆ¿Ç¤Ø¡Ë
               WHEN    "J"
      *        ¿Ç»¡ÎÁ»»Äê¸å¡¢¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý
               WHEN    "K"
               WHEN    "E"
                   PERFORM 33012111-SIDOU-CHUTO-SEC
               WHEN    "A"
      *            Ê£¿ô²ÊÆþÎÏ
                   PERFORM 33012112-SIDOU-FUKU-SEC
               WHEN    "D"
      *            ÃæÅÓ½ªÎ»Å¸³«»þ¼«Æ°»»Äê¤Ê¤·
                   CONTINUE
               WHEN    OTHER
                   PERFORM 33012113-SIDOU-INS-SEC
           END-EVALUATE
      *
           .
       3301211-SIDOU-ADD-EXT.
           EXIT.
      *
      *****************************************************************
      *    »ØÆ³ÎÁÊÔ½¸¡¦¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       33012113-SIDOU-INS-SEC               SECTION.
      *
           MOVE    SPA-SCR-REC         TO  WRK-SCR-REC2
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           COMPUTE SPA-GMN-IDX         =   SPA-GMN-IDX   +   1
           INITIALIZE                  ORCSC92AREA
           MOVE    "1"                 TO  LNK-SC92-KBN
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (LNK-SC92-ERRAREA    =   SPACE )
               PERFORM 330122-JYUFUKU-CHK-SEC
           END-IF
      *
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (LNK-SC92-ERRAREA    =   SPACE )
      *        »ØÆ³ÎÁ½é¿ÇÆü¥Á¥§¥Ã¥¯¡ÊORCSC10 ¤ÈÆ±ÍÍ¤Î¥Á¥§¥Ã¥¯¡Ë
               PERFORM 330121-SIDOU-CHK-SEC
           END-IF
      *
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE               TO  SPA-ERRCD
               MOVE    WRK-SCR-REC2        TO  SPA-SCR-REC 
           ELSE
      *        ºÆÊÔ½¸½èÍý
               MOVE    SPA-GMN-IDX         TO  IDX
               PERFORM 3101-INPUTCD-HEN-SEC
               MOVE    1                   TO  FLG-ADD2
           END-IF
           MOVE    SPA-GMN-IDX         TO  IDX2
      *
           .
       33012113-SIDOU-INS-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÃæÅÓ½ªÎ»Å¸³«»ØÆ³ÎÁÊÔ½¸¡¦¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       33012111-SIDOU-CHUTO-SEC        SECTION.
      *
           MOVE    HZN-SCR-REC         TO  WRK-SCR-REC
      *    Å¸³«»þ¤ÎÆâÍÆ¤ÇÈ½ÃÇ¤¹¤ë
           COMPUTE WRK-GMN-MAX         =   WRK-GMN-MAX   +   1
           IF      WRK-GMN-MAX         >   SPA-MAX-LINE
               MOVE    SPA-MAX-LINE            TO  WRK-GMN-MAX
           END-IF
           INITIALIZE                      WRK-GMN-TBL (WRK-GMN-MAX)
           MOVE    WRK-SRYCD           TO  WRK-COM-INPUTCD(WRK-GMN-MAX)
      *
           IF      LNK-SC10S-SYORI     =   "E"
      *        ½é¿ÇÎÁ¤«¤éºÆ¿Ç¤Ø¤ÎÊÑ¹¹»þ¡¢½é¿ÇÎÁ¤òºï½ü
               PERFORM VARYING     IDX     FROM    1   BY  1
                       UNTIL      (IDX     >   SPA-MAX-LINE )
                   IF     (WRK-COM-INPUTCD (IDX)(1:1)  =   "1" )
                      AND (WRK-COM-SRYKBN (IDX)    =   "11"    )
                       MOVE    SPACE           TO  WRK-COM-INPUTCD (IDX)
                       MOVE    SPA-MAX-LINE        TO  IDX
                   END-IF
               END-PERFORM
           END-IF
      *H25.5
           IF     (LNK-SC10S-SYORI     =   "W"  )
      *        ÃæÅÓ½ªÎ»Å¸³«¤Ç¡¢¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¤òºÆ¿ÇÎÁ¤ØÊÑ´¹¤·¤¿»þ
      *        ¾®»ù²Ê³°Íè¿Ç»¡ÎÁºï½ü
               PERFORM VARYING     IDX     FROM    1   BY  1
                       UNTIL      (IDX     >   SPA-MAX-LINE )
                   IF     (WRK-COM-INPUTCD (IDX)(1:1)  =   "1" )
                      AND (WRK-COM-SRYKBN (IDX)    =   "13"    )
                       SET     TBL-IDX             TO  1
                       SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                           AT  END
                               MOVE    ZERO        TO  FLG-ARI
                           WHEN   WRK-COM-INPUTCD (IDX)
                                               =   TBL-SRYCD (TBL-IDX)
                           MOVE    1                   TO  FLG-ARI
                       END-SEARCH
                       IF      FLG-ARI         =   1
                           MOVE    SPACE       TO  WRK-COM-INPUTCD (IDX)
                           MOVE    SPA-MAX-LINE    TO  IDX
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *
      *
           INITIALIZE                  ORCSC92AREA
           MOVE    "3"                 TO  LNK-SC92-KBN
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    WRK-GMN-MAX         TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       WRK-SCR-REC
                                       SPA-AREA
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE           )  OR
                              (SPA-ERRCD       NOT  =   SPACE )  OR
                             ((HZN-COM-INPUTCD(IDX) =   SPACE ) AND
                              (HZN-GMN-INPUTCD(IDX) =   SPACE ))
               IF      HZN-COM-INPUTCD (IDX)   =   WRK-SRYCD
                   MOVE    "0134"              TO  SPA-ERRCD
               END-IF
           END-PERFORM
      *
           MOVE    SPACE               TO  WRK-SCR-REC
           INITIALIZE                  WRK-SCR-REC
           IF     (SPA-ERRCD           =   SPACE )  AND
                  (LNK-SC92-ERRAREA    =   SPACE )
      *        ¥¨¥é¡¼¤¬¤Ê¤¤»þ¡¢¼«Æ°È¯À¸¤¹¤ë
               PERFORM 33012113-SIDOU-INS-SEC
           ELSE
               MOVE    SPACE           TO  SPA-ERRCD
           END-IF
      *
           .
       33012111-SIDOU-CHUTO-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅ²ÊÆþÎÏ»þ»ØÆ³ÎÁÊÔ½¸¡¦¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       33012112-SIDOU-FUKU-SEC        SECTION.
      *
      *    ´û¤ËÆþÎÏºÑ¤ß¤«¤É¤¦¤«¤ÎÈ½ÃÇ
           PERFORM 330122-JYUFUKU-CHK-SEC
           IF      SPA-ERRCD           =   SPACE
               MOVE    SPA-SCR-REC         TO  WRK-SCR-REC
      *        ¥¨¥é¡¼¤¬¤Ê¤¤»þ¡¢¼«Æ°È¯À¸¤¹¤ë
               PERFORM 33012113-SIDOU-INS-SEC
           ELSE
               MOVE    SPACE               TO  SPA-ERRCD
           END-IF
      *
           .
       33012112-SIDOU-FUKU-EXT.
           EXIT.
      *
      *****************************************************************
      *    »ØÆ³ÎÁ½é¿ÇÆü¥Á¥§¥Ã¥¯½èÍý¡ÊORCSC10 ¤ÈÆ±ÍÍ¤Î¥Á¥§¥Ã¥¯¡Ë
      *****************************************************************
       330121-SIDOU-CHK-SEC            SECTION.
      *
           MOVE    SPA-SYOYMD          TO  WRK-SYOYMD
           MOVE    ZERO                TO  FLG-SYOHEN
      *    ½é¿Ç»»ÄêÆü¤¬¿ÇÎÅÆü°ÊÁ°¤Î»þ
           IF     (SPA-SYOYMD-OLD  NOT =  SPACE     ) AND
                  (WRK-SYOYMD          >  SPA-SRYYMD)
               MOVE    SPA-SYOYMD-OLD     TO  WRK-SYOYMD
           END-IF
      *    Æ±Æü½é¿Ç¤¬¤¢¤ë»þ¡¢Æ±Æü½é¿Ç
           IF      WRK-SRYKA           =   SPACE
               MOVE    SPA-SRYKA       TO  WRK-SRYKA
           END-IF
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   10  )   OR
                              (SPA-DOU-SRYKA (IDX) =   SPACE)
               IF      SPA-DOU-SRYKA (IDX) =   WRK-SRYKA
                   IF      SPA-DOU-SRYYMD(IDX) >   WRK-SYOYMD
                       MOVE    SPA-DOU-SRYYMD(IDX)
                                               TO  WRK-SYOYMD
                       MOVE    1               TO  FLG-SYOHEN
                   END-IF
                   MOVE    10          TO  IDX
               END-IF
           END-PERFORM
      *
      *    ºÇ½ªÂà±¡Æü¤¬¤¢¤ë»þ¡¢Âà±¡Æü
           IF     (SPA-K02N-TAIINYMD   =   SPACE )  OR
                  (SPA-K02N-TAIINYMD   <=  WRK-SYOYMD)
               MOVE    ZERO                TO  FLG-TAIIN
           ELSE
               MOVE    SPA-K02N-TAIINYMD   TO  WRK-SYOYMD
               MOVE    1                   TO  FLG-TAIIN
           END-IF
      *
           MOVE    ZERO                TO  FLG-KYUJITU
           IF      WRK-SYOYMD          =   SPACE
               MOVE    SPA-SRYYMD          TO  WRK-KEIYMD
               MOVE    SPA-SRYYMD          TO  WRK-KEIYMDZEN
           ELSE
      *        ½é¿ÇÎÁ»»ÄêÆü¡Ü£±·î¸å
               INITIALIZE                      STS-AREA-DAY
               INITIALIZE                      LNK-DAY6-AREA
               MOVE    "61"                TO  LNK-DAY6-IRAI
               MOVE    WRK-SYOYMD          TO  LNK-DAY6-KIJUN
               MOVE    "2"                 TO  LNK-DAY6-ZOGENPTN
               MOVE    1                   TO  LNK-DAY6-ZOGEN
               CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
               MOVE    LNK-DAY6-KEISAN     TO  WRK-KEIYMD
               MOVE    LNK-DAY6-KEISANZEN  TO  WRK-KEIYMDZEN
               IF      LNK-DAY6-KEISAN NOT =   LNK-DAY6-KEISANZEN
                   MOVE    1                   TO  FLG-KYUJITU
               END-IF
           END-IF
      *
           EVALUATE    TRUE
               WHEN    WRK-KEIYMD          <   SPA-SRYYMD
                   CONTINUE
               WHEN    WRK-KEIYMD          >   SPA-SRYYMD
      *            £±·î¸å¤ÎÁ°±Ä¶ÈÆü¤ÈÆ±¤¸»þ¡¢£Ï£Ë
                   IF      FLG-SIDOU       =   1
                       IF      FLG-TAIIN       =   1
                           MOVE    "0120"         TO  SPA-ERRCD
                       ELSE
                           MOVE    "0034"          TO  SPA-ERRCD
                       END-IF
                   ELSE
                       IF      FLG-TAIIN       =   1
                           MOVE    "0120"          TO  SPA-ERRCD
                       ELSE
                            MOVE    "0034"          TO  SPA-ERRCD
                       END-IF
                   END-IF
      *       ½é¿Ç»»ÄêÆü¤«¤é¤Î£±¥õ·î°ÊÆâ¤Î¥¨¥é¡¼¤ÇÆ±Æü½é¿ÇÆü¤Ç¤Ê¤¤»þ
                   IF     (SPA-ERRCD           =   "0034")  AND
                          (FLG-SYOHEN          =   ZERO  )  AND
                          (SPA-SYOYMD-RSI  NOT =   SPACE )
      ***********   AND   (SPA-SYOYMD-HKN  NOT =   SPACE )
                       PERFORM 2302-ERRCHK-SEC
                   END-IF
               WHEN    WRK-KEIYMD          =   SPA-SRYYMD
                   CONTINUE
           END-EVALUATE
           .
       330121-SIDOU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ½é¿Ç»»ÄêÆü¤Î·Ù¹ð¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       2302-ERRCHK-SEC               SECTION.
      *
           MOVE    SPACE               TO  WRK-SYOYMD-K
      *    ÊÝ¸±¤¬Ï«ºÒ¤Î»þ
           IF     (SPA-HKNKBN          =   1   )
             AND  (SPA-RSI-JUNKYO  NOT =   "1" )
      *        µ¬½àÆü¤¬Ï«ºÒ°Ê³°¤Î½é¿ÇÆü¤Ç¤¢¤ì¤Ð¡¢Ï«ºÒ¤Î½é¿ÇÆü¤Ç¥Á¥§¥Ã¥¯
               IF     (WRK-SYOYMD          =   SPA-SYOYMD-HKN )
                   MOVE    SPA-SYOYMD-RSI      TO  WRK-SYOYMD-K
               END-IF
           ELSE
               IF     (WRK-SYOYMD          =   SPA-SYOYMD-RSI )
      *        µ¬½àÆü¤¬Ï«ºÒ¤Î½é¿ÇÆü¤Ç¤¢¤ì¤Ð¡¢Ï«ºÒ°Ê³°¤Î½é¿ÇÆü¤Ç¥Á¥§¥Ã¥¯
                   MOVE    SPA-SYOYMD-HKN      TO  WRK-SYOYMD-K
      *            Ï«ºÒ°Ê³°¤Î½é¿Ç¤¬¤Ê¤±¤ì¤Ð·Ù¹ð¤È¤¹¤ë
                   IF      SPA-SYOYMD-HKN      =   SPACE
                       MOVE    SPACE           TO  SPA-ERRCD
                   END-IF
               END-IF
           END-IF
           IF      WRK-SYOYMD-K    NOT =   SPACE
      *        ½é¿ÇÎÁ»»ÄêÆü¡Ü£±·î¸å
               INITIALIZE                      STS-AREA-DAY
               INITIALIZE                      LNK-DAY6-AREA
               MOVE    "61"                TO  LNK-DAY6-IRAI
               MOVE    WRK-SYOYMD-K        TO  LNK-DAY6-KIJUN
               MOVE    "2"                 TO  LNK-DAY6-ZOGENPTN
               MOVE    1                   TO  LNK-DAY6-ZOGEN
               CALL    "ORCSDAY"           USING   STS-AREA-DAY
                                                   LNK-DAY6-AREA
               IF      LNK-DAY6-KEISAN     <=  SPA-SRYYMD
                   MOVE    SPACE           TO  SPA-ERRCD
               END-IF
           END-IF
           .
       2302-ERRCHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆÃÄê¼À´µ¼«Æ°»»Äê½èÍý
      *****************************************************************
       330122-JYUFUKU-CHK-SEC         SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE          )  OR
                              (SPA-ERRCD       NOT  =   SPACE )  OR
                             ((SPA-COM-INPUTCD(IDX) =   SPACE ) AND
                              (SPA-GMN-INPUTCD(IDX) =   SPACE ))
               IF     (SPA-GMN-IDX         NOT =   IDX   )  AND
                      (SPA-COM-INPUTCD (IDX)   =   WRK-SRYCD)
                   MOVE    "0134"              TO  SPA-ERRCD
               END-IF
           END-PERFORM
           .
       330122-JYUFUKU-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÈéÉæ²ÊÆÃÄê¼À´µ¼«Æ°»»Äê½èÍý
      *****************************************************************
       330122-HIFUKA-SIDOU-SEC         SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYCD
           EVALUATE    FLG-TOKUTEI
      *           ¡Ê£±¡Ë
               WHEN    03
                   MOVE    "113000910"     TO  WRK-SRYCD
      *           ¡Ê£²¡Ë
               WHEN    04
                   MOVE    "113002310"     TO  WRK-SRYCD
           END-EVALUATE
      *    ÈéÉæ²ÊÆÃÄê¼À´µ´ÉÍýÎÁ¡Ê£²¡Ë¤Ç¥¢¥È¥Ô¡¼À­ÈéÉæ±ê¤Î¤¢¤ë¾ì¹ç
           IF     (FLG-TOKUTEI         =   04  )  AND
      ***         (SPA-ATOPII-FLG      =   1   )
      *ver.4.7   ¥¢¥È¥Ô¡¼À­ÈéÉæ±ê¤Î¤ß¤Î»þ¡¢È½Äê¤¹¤ë
                  (FLG-ATOPII          =   1   )
      *        16ºÍÌ¤Ëþ¤Ï¤Ê¤·
               IF      SPA-NENREI-YY       <   16
                   MOVE    SPACE           TO  WRK-SRYCD
               END-IF
           END-IF
      *
      *    ¼«Æ°È¯À¸¶èÊ¬È½Äê
           IF     (WRK-SRYCD       NOT =   SPACE )  AND
                  (SPA-BYOMEIAUTO-FLG  =   "1"   )
      *        »ØÆ³ÎÁÄÉ²Ã¡¢¥Á¥§¥Ã¥¯½èÍý
               MOVE    1                   TO  FLG-SIDOU
               PERFORM 3301211-SIDOU-ADD-SEC
           END-IF
      *
           .
       330122-HIFUKA-SIDOU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÎÅÍÜÃ´Åö¼êÅö¡ÊËÌ³¤Æ»¡Ë½èÍý
      *****************************************************************
       330123-RYOYOU-TEATE-SEC         SECTION.
      *
           IF    ( SPA-RYOYOU-FLG      =   "1"     )  AND
                 ((SPA-SRYYMD(5:4)     >=  "1101"  AND
                                       <=  "1231")  OR
                  (SPA-SRYYMD(5:4)     >=  "0101"  AND
                                       <=  "0430") )
               CONTINUE
           ELSE
               GO      TO      330123-RYOYOU-TEATE-EXT
           END-IF
      *
           MOVE    "199000610"         TO  WRK-SRYCD
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           COMPUTE SPA-GMN-IDX         =   SPA-GMN-IDX   +   1
           INITIALIZE                  ORCSC92AREA
           MOVE    "1"                 TO  LNK-SC92-KBN
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE           TO  SPA-ERRCD
               INITIALIZE              SPA-GMN-TBLREC (SPA-GMN-IDX)
               INITIALIZE              SPA-COM-TBLREC (SPA-GMN-IDX)
               COMPUTE SPA-GMN-IDX     =   SPA-GMN-IDX
                                       -   1
           ELSE
               MOVE    "1"                 TO  SPA-COM-KAIFLG
                                                      (SPA-GMN-IDX)
      *        ºÆÊÔ½¸½èÍý
               MOVE    SPA-GMN-IDX         TO  IDX
               PERFORM 3101-INPUTCD-HEN-SEC
           END-IF
           MOVE    SPA-GMN-IDX         TO  IDX2
      *
           .
       330123-RYOYOU-TEATE-EXT.
           EXIT.
      *
      *H28.12
      *****************************************************************
      *    »ØÆ³ÎÁÅù¼«Æ°»»Äê½èÍý
      *****************************************************************
       33014-AUTOSIDOU-SYORI-SEC         SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   3   )
               IF      SPA-AUTOSIDOU (IDX) NOT =   SPACE
                   MOVE    SPA-AUTOSIDOU (IDX) TO  WRK-SRYCD
                   MOVE    ZERO                TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
                   IF      FLG-ADD             =   1
                       MOVE    SPACE           TO  SPA-COM-HCHKFLG
                                                   (SPA-GMN-IDX)
                       MOVE    SPACE           TO  SPA-COM-HKEIFLG
                                                   (SPA-GMN-IDX)
                   END-IF
               END-IF
           END-PERFORM
      *
           .
       33014-AUTOSIDOU-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒ¤Î½é¿ÇÎÁ»»Äê»»Äê½èÍý
      *****************************************************************
       2009-RSIHKN-SET-SEC         SECTION.
      *
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¤Ï»»Äê¤Ê¤·¤È¤¹¤ë
           MOVE    ZERO                TO  SPA-SYONIKA-ARI
           MOVE    ZERO                TO  SPA-SYONIKA-ARI2
           MOVE    ZERO                TO  SPA-SYONIKA-ARI3
      *    ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅÎÁ¤Ï»»Äê¤Ê¤·¤È¤¹¤ë
           MOVE    ZERO                TO  SPA-SYONIKKR-ARI
           MOVE    ZERO                TO  SPA-SYONIKKR-ARI2
           MOVE    ZERO                TO  SPA-SYONIKKR-ARI3
      *
           MOVE    ZERO                TO  WRK-KAISU
           MOVE    SPACE               TO  WRK-SRYCD
      *
      *    ½é¿ÇÎÁ»»Äê
           IF      SPA-SYOSIN          =   1
               MOVE    ZERO                TO  WRK-KAISU
               MOVE    "F"                 TO  WRK-KBN
               MOVE    SPACE               TO  WRK-KBN2
               PERFORM 20091-RSI-SINSATU-SEC
           ELSE
      *H25.9
      *        Æ±ÆüºÆ¿ÇÎÁ»»Äê
               MOVE    ZERO                TO  FLG-DOUJITU
               IF     ( SPA-SYORIFLG        =   ZERO     ) AND
                      ( SPA-RRK-LSTYMD      =   SPA-SRYYMD )
                   IF      SPA-DOUJITU     NOT =   ZERO
                       MOVE    1                   TO  FLG-DOUJITU
                   END-IF
               END-IF
               IF      (SPA-SYORIFLG        =   1       )   AND
                       (WRK-DAY-SINSATUCNT  >   ZERO    )
                   MOVE    1                   TO  FLG-DOUJITU
               END-IF
               IF      FLG-DOUJITU         =   1
                   IF     (SPA-TAKA-SRYKA-R    =   SPACE ) OR
                          (LNK-SC10S-SYORI     =   "J"   )
                     OR   (FLG-DOUJI-HEN       =   1     )
                     OR   (FLG-DOUJI-HEN2      =   1     )
                       MOVE    "12"                TO  WRK-SRYKBN
                       MOVE    "D"                 TO  WRK-KBN
                       MOVE    SPACE               TO  WRK-KBN2
      *                ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
                       PERFORM 20091-RSI-SINSATU-SEC
                   ELSE
                       PERFORM 3301-DOUSAISIN-SEC
                   END-IF
               ELSE
      *        ºÆ¿ÇÎÁ»»Äê
                   MOVE    "12"                TO  WRK-SRYKBN
                   MOVE    SPACE               TO  WRK-KBN
                   MOVE    SPACE               TO  WRK-KBN2
      *            ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
                   PERFORM 20091-RSI-SINSATU-SEC
               END-IF
           END-IF
      *    ¿Ç»¡ÎÁ¼«Æ°ÄÉ²Ã½èÍý
           PERFORM 3301-SYOSIN-HEN-SEC
           IF      FLG-ADD             =   1
               ADD     1               TO  IDX2
           END-IF
      *
      *    Æþ±¡Æü¤Î»þ¡¢½é¿ÇÎÁ¤Î¤ß»»Äê¤¹¤ë
      *    IF      SPA-NYUGAIKBN       =   "1"
      ***      ÅÅ»Ò²½²Ã»»
      ****     PERFORM 33021-DENSIKA-ADD-SEC
      *        GO      TO      2009-RSIHKN-SET-EXT
      **** END-IF
           IF      WRK-SRYCD(1:2)      =   "83"
               MOVE    "0109"              TO  SPA-KIDCD
               GO      TO      2009-RSIHKN-SET-EXT
           END-IF
      *
      *    ³°Íè¤Ç¿Ç»¡ÎÁ¤Î»þ¡¢»þ´Ö³°¶èÊ¬¤òÉÕ¤±¤ë
           IF     (SPA-SYORIFLG        =   ZERO )  AND
                  (FLG-ADD             =   1    )  AND
                  (SPA-NYUGAIKBN       =   "2"  )  AND
                  (WRK-SRYCD(1:1)      =   "1"  )  AND
                  (SPA-SRYYMD          =   SPA-SYSYMD) AND
                  (SPA-GAI-JIKANKBN    NOT =   ZERO )  AND
      *           ¿Ç»¡ÎÁºÆ»»Äê»þ¤ÏÉÕ¤±¤Ê¤¤
                  (FLG-JIKANKBN        =   ZERO )
      *        ¾®»ù²ÊÆÃÎã»þ´Ö³°¤Ï£¶ºÐÌ¤Ëþ
               IF     (SPA-GAI-JIKANKBN    =   5
                                           OR  6
                                           OR  7  )  AND
                      (SPA-NENREI-YY       >=  6  )
                   CONTINUE
               ELSE
               MOVE    SPA-GMN-INPUTCD (SPA-GMN-IDX)
                                           TO  WRK-INPUTCD
               MOVE    SPACE               TO  SPA-GMN-INPUTCD
                                                         (SPA-GMN-IDX)
               MOVE    SPA-GAI-JIKANKBN    TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(1:1)
               MOVE    WRK-INPUTCD         TO  SPA-GMN-INPUTCD
                                                     (SPA-GMN-IDX)(3:)
               MOVE    SPA-GAI-JIKANKBN    TO  SPA-COM-TIMEFLG
                                                     (SPA-GMN-IDX)
           END-IF
      *
           END-IF
      *
           MOVE    ZERO                TO  SPA-GAIRAISIN
      *
      *H30.4
      *    Ç¥ÉØ²Ã»»
           IF     (SPA-NINPUKBN-ARI    =   1   )
              OR  (FLG-NINPU-IN        =   1   )
               IF     (SPA-NENREI-YY       >=  6     )
      *            Ç¥ÉØÀßÄê¡¢Ç¥ÉØ²Ã»»ÆþÎÏ¤¢¤ê
                   PERFORM 33021-NINPUKSN-ADD-SEC
               END-IF
           END-IF
      *
           IF      SPA-SYOSIN          =   1
      *H30.4
      *        µ¡Ç½¶¯²½²Ã»»
               PERFORM 33021-KYOUKAKSN-ADD-SEC
               GO      TO      2009-RSIHKN-SET-EXT
           END-IF
      *    Æþ±¡Æü¤Î»þ¡¢½é¿ÇÎÁ¤Î¤ß»»Äê¤¹¤ë
           IF      SPA-NYUGAIKBN       =   "1"
               GO      TO      2009-RSIHKN-SET-EXT
           END-IF
      *
      *£È£²£²Ç¯£´·î¤«¤é
      *    ºÆ¿ÇÎÁ¤Î²Ã»»
           IF     (SPA-SYOSIN          =   1 )  OR
                  (SPA-GAIRAISIN       =   1 )  OR
                  (SPA-HOSPSBT         =   1 )
               CONTINUE
           ELSE
      *        ÃÏ°è°åÎÅ¹×¸¥¡¦ÌÀºÙ½ñÈ¯¹ÔÂÎÀ©Åù²Ã»»
               PERFORM 33013-SAISINKSN-SEC
           END-IF
      *
      *    ¥¢¥Õ¥¿¡¼¥±¥¢¤Î»þ¡¢°Ê²¼»»Äê¤Ê¤·
           IF      SPA-RSI-HKNKBN      =   "3"
               GO      TO      2009-RSIHKN-SET-EXT
           END-IF
      *
      *    ³°Íè´ÉÍý²Ã»»¥³¡¼¥ÉÄÉ²Ã
           IF     (SPA-SYORIFLG        =   ZERO ) OR
                  (FLG-GAI             =   1   AND
                   SPA-SYORIFLG        =   1    )
               PERFORM 20092-RSIGAIRA-SEC
           END-IF
      *
           .
       2009-RSIHKN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ï«ºÒ¤Î¿Ç»¡ÎÁ¸¡º÷½èÍý
      *****************************************************************
       20091-RSI-SINSATU-SEC         SECTION.
      *
      *    ¿Ç»¡ÎÁ¸¡º÷
           SET     TBL-RSI              TO  1
           SEARCH  TBL-RSI-SINSATU-OCC  VARYING   TBL-RSI
              AT   END
                   MOVE    ZERO               TO  FLG-ARI
                   MOVE    SPACE              TO  WRK-SRYCD
               WHEN   (WRK-KAISU       =   TBLR-KAISU (TBL-RSI)) AND
                      (WRK-KBN         =   TBLR-KBN   (TBL-RSI)) AND
                      (WRK-KBN2        =   TBLR-KBN2  (TBL-RSI))
                   MOVE    1                  TO  FLG-ARI
                   MOVE    TBLR-SRYCD (TBL-RSI)
                                              TO  WRK-SRYCD
           END-SEARCH
           .
       20091-RSI-SINSATU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³°Íè´ÉÍý²Ã»»¥³¡¼¥ÉÄÉ²Ã½èÍý¡ÊÏ«ºÒ¡Ë
      *****************************************************************
       20092-RSIGAIRA-SEC         SECTION.
      *
      *    MOVE    ZERO                TO  WRK-KAISU
      *    MOVE    "G"                 TO  WRK-KBN
      *
      *    ¥Æ¡¼¥Ö¥ë¸¡º÷
      *****PERFORM 20091-RSI-SINSATU-SEC
      *
      *    Ï«ºÒ³°Íè´ÉÍý²Ã»»¥³¡¼¥É
           MOVE    TBLRG-SRYCD         TO  WRK-SRYCD
      *H27.2 ¤«¤é¡¡³°Íè´ÉÍý²Ã»»¥³¡¼¥ÉÊÑ¹¹
           IF      SPA-SRYYMD          >=  "20150201"
               MOVE    TBLG-SRYCD          TO  WRK-SRYCD
           END-IF
           PERFORM 3301-SYOSIN-HEN-SEC
      *    ¼«Æ°»»Äê¤¢¤ê
           IF      FLG-ADD             =   1
               ADD     1               TO  IDX2
           END-IF
      *
           .
       20092-RSIGAIRA-EXT.
           EXIT.
      *
      *****************************************************************
      *    Æ±»þºÆ¿Ç»»Äê½èÍý¡Ê³ÎÇ§¸å¡Ë
      *****************************************************************
       300-DOUSAISIN-SET-SEC         SECTION.
      *
      *    ÅÅÏÃºÆ¿Ç¤«¤Î¥Á¥§¥Ã¥¯
           PERFORM 3001-TELSAISIN-CHK-SEC
           IF      FLG-TEL-ARI         =   1
               GO      TO      300-DOUSAISIN-SET-EXT
           END-IF
      *
           MOVE    SPA-SCR-REC         TO  HZN-SCR-REC
      *
           MOVE    SPACE               TO  SPA-SCR-REC
           INITIALIZE                  SPA-SCR-REC
           MOVE    ZERO                TO  SPA-GMN-MAX
           MOVE    ZERO                TO  IDX2
           MOVE    ZERO                TO  SPA-GMN-IDX
           MOVE    ZERO                TO  SPA-FUKU-SRYKA
      *
           IF     (SPA-HKNKBN          =   1   )
      *        ·òÊÝ½àµò°Ê³°
             AND  (SPA-RSI-JUNKYO  NOT =   "1" )
      *        Ï«ºÒ¤ÎÆ±ÆüºÆ¿ÇÎÁ»»Äê
               MOVE    "D"                 TO  WRK-KBN
               MOVE    SPACE               TO  WRK-KBN2
               MOVE    1                   TO  FLG-DOUJI-HEN
               PERFORM 2009-RSIHKN-SET-SEC
           ELSE
      *        Æ±ÆüºÆ¿ÇÎÁ¤ØÃÖ´¹¤¨
               MOVE    "12"                TO  WRK-SRYKBN
               MOVE    "D"                 TO  WRK-KBN
               MOVE    ZERO                TO  FLG-SAISIN-CHK
      *        ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
               PERFORM 2001-SRYCD-TBL-SEC
      *H24.4
      *       ³°Íè¥ê¥Ï¥Ó¥ê¿Ç»¡ÎÁÅù»»Äê»þ¡¢ºÆ¿Ç¥À¥ß¡¼¡©¡©
               IF     (SPA-KOURESRY-ARI2   =   2   OR  3  )
                 OR   (SPA-CHKHKT-ARI2     =   1      )
                 OR   (SPA-NNCHKT-ARI2     =   1      )
                   MOVE    "099120001"         TO  WRK-SRYCD
               END-IF
      *H24.4
      *        ½é¿ÇÎÁ¼«Æ°ÄÉ²Ã
               PERFORM 3301-SYOSIN-SYORI-SEC
           END-IF
      *    ¿ÇÎÅ¹Ô°ÙÆâÍÆ¤ÎÊÔ½¸
           PERFORM 10102-SINSATU-CHENGE-SEC
           .
       300-DOUSAISIN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÅÏÃºÆ¿Ç»»Äê¥Á¥§¥Ã¥¯½èÍý¡ÊÆþÎÏÊ¬¡Ë
      *****************************************************************
       3001-TELSAISIN-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-TEL-ARI
           MOVE    SPACE               TO  WRK-KBN4
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE  )  OR
                             ((SPA-GMN-INPUTCD(IDX)    =   SPACE) AND
                              (SPA-COM-INPUTCD(IDX)    =   SPACE)) OR
                              (FLG-TEL-ARI     =   1   )
      *        ÅÅÏÃºÆ¿Ç¤«¤Î¥Á¥§¥Ã¥¯
               MOVE    SPA-COM-INPUTCD (IDX)   TO  WRK-SRYCD
               MOVE    IDX                 TO  SPA-GMN-IDX
               PERFORM 30011-TELSAISIN-CHKSYORI-SEC
      *
           END-PERFORM
           .
       3001-TELSAISIN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÅÏÃºÆ¿Ç¥³¡¼¥ÉÈ½ÄêÊÑ´¹½èÍý
      *****************************************************************
       30011-TELSAISIN-CHKSYORI-SEC         SECTION.
      *
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
              AT   END
                   MOVE    SPACE           TO  WRK-KBN
                   MOVE    SPACE           TO  WRK-KBN2
                   MOVE    ZERO            TO  WRK-KAISU
                   MOVE    ZERO            TO  WRK-ZOKKBN
               WHEN   (TBL-SRYCD (TBL-IDX) =   WRK-SRYCD) 
                   MOVE    TBL-KBN   (TBL-IDX) TO  WRK-KBN
                   MOVE    TBL-KBN2  (TBL-IDX) TO  WRK-KBN2
                   MOVE    ZERO                TO  WRK-KAISU
      *H25.4       ¾Ò²ð¤Ê¤·¡¦ÂÅ·ëÎ¨ÂÐ±þ
                   MOVE    TBL-ETCKBN(TBL-IDX) TO  WRK-ETCKBN
      *H30.4       ¡Ê£³£°Ç¯£³·î°ÊÁ°·ÑÂ³)
                   MOVE    TBL-HOSPSBT(TBL-IDX) TO  WRK-ZOKKBN
           END-SEARCH
      *
      *    Æ±ÆüºÆ¿ÇÎÁ¤ØÃÖ´¹¤¨
           IF      WRK-KBN             =   "T"
               MOVE    "12"                TO  WRK-SRYKBN
               MOVE    "S"                 TO  WRK-KBN
      *        ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
               IF      WRK-ZOKKBN          =   3
                   PERFORM 2001-SRYCD-TBL3-SEC
               ELSE
                   PERFORM 2001-SRYCD-TBL-SEC
               END-IF
      *        ÅÅÏÃºÆ¿Ç¤Î»þ¡¢Æ±ÆüÅÅÏÃºÆ¿Ç¤Ø¿¶¤êÂØ¤¨
               MOVE    SPA-GMN-IDX         TO  WRK-IDX-IN
               PERFORM 33041-SRYCD-ADD-SEC
               MOVE    1                   TO  FLG-TEL-ARI
           END-IF
      *    Ï«ºÒÈ½Äê
           IF     (FLG-TEL-ARI         =   ZERO )
              AND (SPA-HKNKBN          =   1    )
              AND (SPA-RSI-JUNKYO  NOT =   "1" )
               SET     TBL-RSI              TO  1
               SEARCH  TBL-RSI-SINSATU-OCC  VARYING   TBL-RSI
                   AT  END
                       MOVE    SPACE              TO  WRK-KBN
                       MOVE    SPACE              TO  WRK-KBN2
                   WHEN    TBLR-SRYCD (TBL-RSI)   =   WRK-SRYCD
                       MOVE    TBLR-KBN   (TBL-RSI)   TO  WRK-KBN
                       MOVE    TBLR-KBN2  (TBL-RSI)   TO  WRK-KBN2
               END-SEARCH
      *
      *        Æ±ÆüÅÅÏÃºÆ¿ÇÎÁ¤ØÃÖ´¹¤¨
               IF      WRK-KBN             =   "T"
                   MOVE    "S"                 TO  WRK-KBN
      *            ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
                   PERFORM 20091-RSI-SINSATU-SEC
                   MOVE    SPA-GMN-IDX         TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
                   MOVE    1                   TO  FLG-TEL-ARI
               END-IF
           END-IF
           .
       30011-TELSAISIN-CHKSYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿Ç»¡ÎÁ¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê½èÍý
      *****************************************************************
       2001-SRYCD-TBL3-SEC              SECTION.
      *
           MOVE    1                   TO  WRK-KAISU
           IF      WRK-SRYKBN          =   "12"
      *        °ìÈÌÉÂ¾²¿ô
               IF     (SPA-BEDSUIPN        >=  200 )  AND
                      (SPA-HOSPSBT         =   1   )
      *            200¾²°Ê¾å¤Ï³°Íè¿Ç»¡ÎÁ
                   MOVE    3               TO  WRK-KAISU
               END-IF
           END-IF
      *
           IF      WRK-SRYKBN          =   "11"
               MOVE    ZERO                TO  WRK-HOSPSBT
           ELSE
               MOVE    SPA-HOSPSBT         TO  WRK-HOSPSBT
           END-IF
      *H25.4
           IF      WRK-ETCKBN          =   "1"
                                       OR  "2"
               CONTINUE
           ELSE
               MOVE    "0"             TO  WRK-ETCKBN
           END-IF
      *H27.1
      *    ÂÅ·ëÎ¨£µ³ä°Ê²¼
           IF     (SPA-SRYYMD          >=  "20150101" )
             AND  (SPA-DAKT50-KBN      =   1          )
               MOVE    "2"             TO  WRK-ETCKBN
           END-IF
      *
      *    ¿Ç»¡ÎÁ¥»¥Ã¥È
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                   AT   END
                       MOVE    SPACE           TO  WRK-SRYCD
                   WHEN   (WRK-KAISU           =   TBL-KAISU  (TBL-IDX))
                     AND  (WRK-KBN             =   TBL-KBN    (TBL-IDX))
                     AND  (WRK-SRYKBN          =   TBL-SRYCD(TBL-IDX)
                                                                (2:2))
                     AND  (WRK-ETCKBN          =   TBL-ETCKBN(TBL-IDX))
                     AND  (WRK-ZOKKBN          =   TBL-HOSPSBT(TBL-IDX))
                       MOVE    TBL-SRYCD (TBL-IDX)
                                               TO  WRK-SRYCD
           END-SEARCH
      *
           .
       2001-SRYCD-TBL3-EXT.
           EXIT.
      *
      *
      *H25.9
      *****************************************************************
      *    ±¡Æâ±¡³°ÊÑ¹¹½èÍý
      *****************************************************************
       400-INGAI-HEN-SEC         SECTION.
      *
           MOVE    ZERO                TO  WRK-IDX-IN
           MOVE    ZERO                TO  WRK-IDX-IN2
           MOVE    ZERO                TO  WRK-IDX-INS
           MOVE    ZERO                TO  WRK-ZAITAKU
           MOVE    ZERO                TO  WRK-ZAITAKU-IDX
      *****MOVE    ZERO                TO  WRK-GAIRAI-IDX
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE )  OR
                              (SPA-COM-INPUTCD (IDX)  =   SPACE AND
                               SPA-GMN-INPUTCD (IDX)  =   SPACE )
               EVALUATE    SPA-COM-INPUTCD (IDX)
      *            ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ
                   WHEN    "113003510" 
                   WHEN    "113003610" 
                   WHEN    "113003710" 
                   WHEN    "113003810" 
                       MOVE    IDX                 TO  WRK-IDX-IN
      *H28.4
      *            ¾®»ù¤«¤«¤ê¤Ä¤±³°Íè¿Ç»¡ÎÁ
                   WHEN    "113019710" 
                   WHEN    "113019810" 
                   WHEN    "113019910" 
                   WHEN    "113020010" 
                       MOVE    IDX                 TO  WRK-IDX-IN
      *H30.4
      *            µ¡Ç½¶¯²½²Ã»»¡Ê½é¿Ç¡Ë
                   WHEN    "111013770" 
                   WHEN    "113028870" 
                   WHEN    "113028970" 
                       MOVE    IDX                 TO  WRK-IDX-INS
      *
      *            À¸³è½¬´·ÉÂ»ØÆ³´ÉÍýÎÁ
                   WHEN    "113003910"
                   WHEN    "113005810"
                   WHEN    "113005910"
                   WHEN    "113004010"
                   WHEN    "113006010"
                   WHEN    "113006110"
                       MOVE    IDX                 TO  WRK-IDX-IN
      *
      *            ½èÊýäµÌµ¸òÉÕ²Ã»»¡Êºß°åÁí´É¡¦»Ü°åÁí´É¡Ë¡ÊC002-00)
                   WHEN    CONS-C0020-KSN
                       MOVE    IDX                 TO  WRK-IDX-IN2
      *H30.4ÇÑ»ß
      *            ½èÊý¤»¤óÌµ¸òÉÕ²Ã»»¡Ê»Ü°åÁí´É¡Ë¡ÊC002-02)
      *            WHEN    CONS-C0022-KSN
      *                MOVE    IDX                 TO  WRK-IDX-IN2
      ***
               END-EVALUATE
      *
               IF      WRK-IDX-IN      =   ZERO
      *            ºßÂðÊ¬
                   SET     TBL-ZSIDX           TO  1
                   SEARCH  TBL-ZISOSIN-OCC     VARYING   TBL-ZSIDX
                   AT   END
                       MOVE    SPACE                   TO  WRK-ZS-GRP
                   WHEN    TBL-ZS-SRYCD (TBL-ZSIDX)
                                               =   SPA-COM-INPUTCD(IDX)
                       MOVE    TBL-ZS-GRP (TBL-ZSIDX)  TO  WRK-ZS-GRP
                       MOVE    IDX                 TO  WRK-IDX-IN
                   END-SEARCH
               END-IF
           END-PERFORM
      *
           IF     (WRK-IDX-IN          =   ZERO ) AND
                  (WRK-ZAITAKU-IDX     =   ZERO )
               GO     TO      400-INGAI-HEN-EXT
           END-IF
      *
           IF      SPA-SYONIKA-ARI     NOT =   ZERO
      *        ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê¼«Æ°È¯À¸½èÍý
               PERFORM 3303-SYONIKA-SET-SEC
           END-IF
      *
           IF      SPA-SYONIKKR-ARI    NOT =   ZERO
      *        ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅ²Ê¼«Æ°È¯À¸½èÍý
               PERFORM 3304-SYOUNIKAKARI-SET-SEC
           END-IF
      *
           IF      SPA-SEIKATU-ARI     NOT =   ZERO
      *        À¸³è½¬´·ÉÂ»ØÆ³²Ê¿¶ÂØ¤¨½èÍý
               PERFORM 3306-SEIKATU-SET-SEC
           END-IF
      *
           IF     (SPA-ZAIMATU-ARI     NOT =   ZERO )
      *        ºßÂð¤¬¤ó°åÁí¹ç
               PERFORM 3308-ZAIKANRI-SET-SEC
           END-IF
      *
           IF     (SPA-ZAIKANRI-ARI    NOT =   ZERO )
            OR    (SPA-IGAKUKAN-ARI    NOT =   ZERO )
      *        ºß°åÁí´É¡¢ÆÃ°åÁí´É
               PERFORM 3308-ZAIKANRI02-SET-SEC
           END-IF
      *
           .
       400-INGAI-HEN-EXT.
           EXIT.
      *****************************************************************
      *    À¸³è½¬´·ÉÂ»ØÆ³²Ê¼«Æ°½èÍý
      *****************************************************************
       3306-SEIKATU-SET-SEC            SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYCD
           IF      SPA-INGAIKBN        =   "1"
      *        ±¡³°¤Ø
               EVALUATE    SPA-COM-INPUTCD (WRK-IDX-IN)
      *            ¹â·ì°µ¾É¡Ê±¡³°½èÊý¡Ë
                   WHEN    "113004010"
                       MOVE    "113003910"         TO  WRK-SRYCD
      *            ¹â»é·ì¾É¡Ê±¡³°½èÊý¡Ë
                   WHEN    "113006010"
                       MOVE    "113005810"         TO  WRK-SRYCD
      *            ¹â»é·ì¾É¡Ê±¡³°½èÊý¡Ë
                   WHEN    "113006110"
                       MOVE    "113005910"         TO  WRK-SRYCD
               END-EVALUATE
           ELSE
      *        ±¡Æâ¤Ø
               EVALUATE    SPA-COM-INPUTCD (WRK-IDX-IN)
      *            ¹â·ì°µ¾É¡Ê±¡³°½èÊý¡Ë
                   WHEN    "113003910"
                       MOVE    "113004010"         TO  WRK-SRYCD
      *            ¹â»é·ì¾É¡Ê±¡³°½èÊý¡Ë
                   WHEN    "113005810"
                       MOVE    "113006010"         TO  WRK-SRYCD
      *            ¹â»é·ì¾É¡Ê±¡³°½èÊý¡Ë
                   WHEN    "113005910"
                       MOVE    "113006110"         TO  WRK-SRYCD
               END-EVALUATE
           END-IF
           IF      WRK-SRYCD           =   SPACE
               GO      TO      3306-SEIKATU-SET-EXT
           END-IF
      *
           MOVE    ZERO                TO  FLG-ADD
      *
      *    ÄÉ²Ã¶¦ÄÌ½èÍý
           PERFORM 33041-SRYCD-ADD-SEC
      *
           .
       3306-SEIKATU-SET-EXT.
           EXIT.
      *****************************************************************
      *    ºßÂð»þ°å³ØÁí¹ç´ÉÍýÎÁ½èÍý
      *****************************************************************
       3308-ZAIKANRI-SET-SEC            SECTION.
      *
      *    ºßÂð¤¬¤ó°åÁí¹ç
      *
           SET     TBL-ZSIDX           TO  1
           SEARCH  TBL-ZISOSIN-OCC     VARYING   TBL-ZSIDX
              AT   END
                   MOVE    SPACE                   TO  WRK-ZS-KBN
                   MOVE    SPACE                   TO  WRK-ZS-GRP
               WHEN   (TBL-ZS-SRYCD (TBL-ZSIDX)
                                       =   SPA-COM-INPUTCD (WRK-IDX-IN))
                   MOVE    TBL-ZS-GRP (TBL-ZSIDX)  TO  WRK-ZS-GRP
                   MOVE    TBL-ZS-KBN (TBL-ZSIDX)  TO  WRK-ZS-KBN
           END-SEARCH
      *
           MOVE    SPACE           TO  WRK-KEY-KBN
           IF     (WRK-ZS-KBN      NOT =   SPACE )
              AND (WRK-ZS-GRP(1:1)     =   "2"   )
      *        ±¡³°¤Ø
               IF     (SPA-INGAIKBN    =   "1" )
                  AND (WRK-ZS-KBN      =   "2" )
      *            ½èÊý¤»¤óÌµ¤Î¥³¡¼¥É¤ò½èÊý¤»¤óÍ­¤Ø
                   MOVE    "1"             TO  WRK-KEY-KBN
               END-IF
      *        ±¡Æâ¤Ø
               IF     (SPA-INGAIKBN    =   "0" )
                  AND (WRK-ZS-KBN      =   "1" )
      *            ½èÊý¤»¤óÍ­¤Î¥³¡¼¥É¤ò½èÊý¤»¤óÌµ¤Ø
                   MOVE    "2"             TO  WRK-KEY-KBN
               END-IF
           END-IF
      *
           MOVE    SPACE               TO  WRK-SRYCD
           IF      WRK-KEY-KBN     NOT =   SPACE
               SET     TBL-ZSIDX           TO  1
               SEARCH  TBL-ZISOSIN-OCC     VARYING   TBL-ZSIDX
                   AT   END
                       MOVE    SPACE               TO  WRK-SRYCD
                   WHEN   (TBL-ZS-GRP (TBL-ZSIDX)  =   WRK-ZS-GRP )
                     AND  (TBL-ZS-KBN (TBL-ZSIDX)  =   WRK-KEY-KBN)
                       MOVE    TBL-ZS-SRYCD(TBL-ZSIDX) TO  WRK-SRYCD
               END-SEARCH
           END-IF
           IF      WRK-SRYCD       NOT =   SPACE
               MOVE    ZERO                TO  FLG-ADD
      *        ÄÉ²Ã¶¦ÄÌ½èÍý
               PERFORM 33041-SRYCD-ADD-SEC
           END-IF
           .
       3308-ZAIKANRI-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºßÂð»þ°å³ØÁí¹ç´ÉÍýÎÁ½èÍý
      *****************************************************************
       3308-ZAIKANRI02-SET-SEC            SECTION.
      *
      *    ºß°åÁí´É¡¢ÆÃ°åÁí´É
      *
           SET     TBL-ZSIDX           TO  1
           SEARCH  TBL-ZISOSIN-OCC     VARYING   TBL-ZSIDX
              AT   END
                   MOVE    SPACE                   TO  WRK-ZS-KBN
                   MOVE    SPACE                   TO  WRK-ZS-GRP
               WHEN   (TBL-ZS-SRYCD (TBL-ZSIDX)
                                       =   SPA-COM-INPUTCD (WRK-IDX-IN))
                   MOVE    TBL-ZS-GRP (TBL-ZSIDX)  TO  WRK-ZS-GRP
                   MOVE    TBL-ZS-KBN (TBL-ZSIDX)  TO  WRK-ZS-KBN
           END-SEARCH
      *
           IF      WRK-IDX-IN2         =   ZERO
      *        ±¡Æâ¤Ø
               MOVE    SPACE               TO  WRK-SRYCD
               EVALUATE    WRK-ZS-GRP(1:1)
               WHEN    "0"
      *            ºß°åÁí´É
                   MOVE    CONS-C0020-KSN      TO  WRK-SRYCD
               WHEN    "1"
      *            ÆÃ°åÁí´É
      *H30.4       MOVE    CONS-C0022-KSN      TO  WRK-SRYCD
                   MOVE    CONS-C0020-KSN      TO  WRK-SRYCD
               END-EVALUATE
      *        ÄÉ²Ã¶¦ÄÌ½èÍý
               IF      WRK-SRYCD       NOT =   SPACE
      *H29.2
      *            Ä¾²¼¤Ë¼ÂÀÓ²Ã»»£²¤¬¤¢¤ì¤Ð¤½¤Î²¼¤È¤¹¤ë
                   PERFORM 33081-ZAIKANRI02-SET02-SEC
      *
                   IF      WRK-IDX-IN3         =   ZERO
                       MOVE    WRK-IDX-IN          TO  IDX2
                       MOVE    WRK-IDX-IN          TO  SPA-GMN-IDX
                   ELSE
                       MOVE    WRK-IDX-IN3         TO  IDX2
                       MOVE    WRK-IDX-IN3         TO  SPA-GMN-IDX
                   END-IF
                   MOVE    ZERO                TO  WRK-IDX-IN
                   PERFORM 33041-SRYCD-ADD-SEC
               END-IF
           ELSE
      *        ½èÊý¤»¤ó¤Ê¤·²Ã»»ºï½ü
               MOVE    WRK-IDX-IN2         TO  IDX2
               MOVE    SPACE               TO  SPA-GMN-INPUTCD (IDX2)
               PERFORM 33081-GYO-DELETE-SEC
           END-IF
           .
       3308-ZAIKANRI02-SET-EXT.
           EXIT.
      *H29.2
      *****************************************************************
      *    ¼ÂÀÓ²Ã»»Åù¤ÎÈ½Äê½èÍý
      *****************************************************************
       33081-ZAIKANRI02-SET02-SEC         SECTION.
      *
      *H29.4 ²þÀµÂÐ±þ
           MOVE    ZERO                TO  WRK-IDX-IN3
           COMPUTE WRK-IDX-IN4         =   WRK-IDX-IN   +  1
      *
           MOVE    ZERO                TO  FLG-CHKEND
           PERFORM VARYING     IDKS    FROM    WRK-IDX-IN4   BY  1
                   UNTIL      (IDKS        >   SPA-MAX-LINE )
                         OR  ((SPA-COM-INPUTCD (IDKS)  =   SPACE ) AND
                              (SPA-GMN-INPUTCD (IDKS)  =   SPACE ))
                         OR   (FLG-CHKEND      =   1    )
               IF     (SPA-COM-INPUTCD(IDKS)(1:1)  =   "1" )
                 AND  (SPA-COM-DATAKBN(IDKS)       =   "2" )
                   IF      SPA-COM-AUTOKBN (IDKS)  =   SPACE
      *                ºßÂð¼ÂÀÓ²Ã»»¤Î¥Á¥§¥Ã¥¯
                       PERFORM 330811-ZISOKSN-CHK-SEC
                       IF     (WRK-ZKS-GRP(1:1)    =   "0"
                                                   OR  "1"    )
                           MOVE    IDKS            TO  WRK-IDX-IN3
                       END-IF
                   ELSE
                       MOVE    IDKS             TO  WRK-IDX-IN3
                   END-IF
               END-IF
               IF      SPA-COM-ZAIEND (IDKS)    =   "1"
                   MOVE    1                    TO  FLG-CHKEND
               END-IF
           END-PERFORM
           .
       33081-ZAIKANRI02-SET02-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºßÂð¼ÂÀÓ²Ã»»½èÍý
      *****************************************************************
       330811-ZISOKSN-CHK-SEC         SECTION.
      *
           SET     TBL-ZKSIDX          TO  1
           SEARCH  TBL-ZISOKSN-OCC     VARYING   TBL-ZKSIDX
              AT   END
                   MOVE    SPACE                   TO  WRK-ZKS-KBN
                   MOVE    SPACE                   TO  WRK-ZKS-GRP
              WHEN   (TBL-ZKS-SRYCD (TBL-ZKSIDX)
                                       =   SPA-COM-INPUTCD
                                                        (IDKS))
                   MOVE    TBL-ZKS-GRP (TBL-ZKSIDX) TO  WRK-ZKS-GRP
                   MOVE    TBL-ZKS-KBN (TBL-ZKSIDX) TO  WRK-ZKS-KBN
           END-SEARCH
           .
       330811-ZISOKSN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    £±¹Ôºï½ü½èÍý
      *****************************************************************
       33081-GYO-DELETE-SEC         SECTION.
      *
           MOVE    SPA-SCR-REC         TO  HZN-SCR-REC
           INITIALIZE                      SPA-SCR-REC
           MOVE    ZERO                TO  SPA-GMN-MAX
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-MAX-LINE
               IF      HZN-GMN-INPUTCD(IDX)    =   SPACE
                   CONTINUE
               ELSE
                   ADD     1               TO  SPA-GMN-MAX
                   MOVE    HZN-COM-TBLREC (IDX) 
                                           TO  SPA-COM-TBLREC
                                                        (SPA-GMN-MAX)
                   MOVE    HZN-GMN-TBLREC (IDX) 
                                           TO  SPA-GMN-TBLREC
                                                       (SPA-GMN-MAX)
               END-IF
           END-PERFORM
           .
       33081-GYO-DELETE-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    Æ±»þºÆ¿Ç»»Äê½èÍý¡ÊÆþÎÏÊ¬¡Ë
      *****************************************************************
       500-INDOUSAISIN-SET-SEC         SECTION.
      *
      *    ÅÅÏÃºÆ¿Ç¤«¤Î¥Á¥§¥Ã¥¯
           MOVE    SPA-COM-INPUTCD (SPA-GMN-IDX)   TO  WRK-SRYCD
           PERFORM 30011-TELSAISIN-CHKSYORI-SEC
           IF      FLG-TEL-ARI         =   1
               GO      TO      500-TELDOUSAISIN-SET-EXT
           END-IF
      *
      *    ÅÅÏÃºÆ¿Ç°Ê³°¤Î»þ¡¢ºÆÅÙ¿Ç»¡ÎÁ»»Äê¤Ø
           MOVE    SPACE               TO  SPA-SCR-REC
           INITIALIZE                  SPA-SCR-REC
           MOVE    ZERO                TO  SPA-GMN-MAX
           MOVE    ZERO                TO  IDX2
           MOVE    ZERO                TO  SPA-GMN-IDX
           MOVE    ZERO                TO  SPA-FUKU-SRYKA
           MOVE    ZERO                TO  SPA-SYOSIN
           PERFORM 100-SANTEI-CHK-SEC
           PERFORM 200-SYOSIN-SET-SEC
      *
           .
       500-TELDOUSAISIN-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *     ºÞÊ¬Î¥Á°¤ÎÆÃÄê»»Äê²ó¿ô¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       600-SANTEI-CNT-SEC              SECTION.
      *
      *    ÆÃÄê¤Î¿ÇÎÅ¹Ô°Ù¤ÎÍ­Ìµ
           MOVE    ZERO                TO  SPA-NETAKIRI-ARI
           MOVE    ZERO                TO  SPA-ROUMANSEI-ARI
           MOVE    ZERO                TO  SPA-HOUMON-ARI
           MOVE    ZERO                TO  SPA-SYONIKA-ARI
           MOVE    ZERO                TO  SPA-TELSAI-ARI
           MOVE    ZERO                TO  SPA-FUKU-SRYKA
           MOVE    ZERO                TO  SPA-ZAIMATU-ARI
           MOVE    ZERO                TO  SPA-KAIHOU1-ARI
           MOVE    ZERO                TO  SPA-KAIHOU2-ARI
           MOVE    ZERO                TO  SPA-ZAIKANRI-ARI
      *£È£²£°¡¥£´¤«¤é
           MOVE    ZERO                TO  SPA-KOURESRY-ARI
           MOVE    ZERO                TO  SPA-IGAKUKAN-ARI
      *
           MOVE    ZERO                TO  SPA-SEIKATU-ARI
           MOVE    ZERO                TO  SPA-KYUSEI-FLG
      *    ºßÂðÎÅÍÜ»ØÆ³ÎÁ»»Äê
           MOVE    ZERO                TO  WRK-ZAITAKU-CNT
      *H26.4
           MOVE    ZERO                TO  SPA-CHKHKT-ARI
           MOVE    ZERO                TO  SPA-NNCHKT-ARI
           MOVE    ZERO                TO  SPA-SYONIKKR-ARI
      *H30.4
           MOVE    ZERO                TO  SPA-NINPUKBN-IN
           MOVE    ZERO                TO  SPA-ONLINE-ARI
      *
      *    Êñ³ç¤Þ¤È¤áÆþÎÏÂÐ¾Ý³°
           IF      SPA-HKNCOMBINUM     =   "9999"
               GO      TO      600-SANTEI-CNT-EXT
           END-IF
      *
      *    ¥¢¥Õ¥¿¡¼¥±¥¢ÂÐ¾Ý³°
           IF      SPA-RSI-HKNKBN      =   "3"
               GO      TO      600-SANTEI-CNT-EXT
           END-IF
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE          )  OR
                              (SPA-COM-INPUTCD(IDX) =   SPACE  AND
                               SPA-GMN-INPUTCD(IDX) =   SPACE )
             IF      SPA-COM-HKNCOMBI (IDX)    NOT =   "9999"
      *          ¼£¸³
                 OR (SPA-COM-CHIKENKBN (IDX)      =   "1")
      *
      *        ºß°åÁí´ÉÅù¤ÎÈ½Äê
               PERFORM 6001-ZISOSIN-CHK-SEC
      *
      *        ÆÃÄê¤Î¿ÇÎÅ¹Ô°ÙÈ½Äê
               EVALUATE    SPA-COM-INPUTCD (IDX)
      *
      *            ºßÂð´µ¼ÔË¬Ìä¿Ç»¡ÎÁ¡Ê£±¡Ë£±
                   WHEN    "114001110"
      *H28.4
      *            ºßÂð´µ¼ÔË¬Ìä¿ÇÎÅÎÁ¡Ê£±¡Ë£±¡ÊÆ±°ì·úÊª½»µï¼Ô¡Ë
                   WHEN    "114030310"
      *H30.4
      *            ºßÂð´µ¼ÔË¬Ìä¿ÇÎÅÎÁ¡Ê£±¡Ë£²
                   WHEN    "114042110"
      *            ºßÂð´µ¼ÔË¬Ìä¿ÇÎÅÎÁ¡Ê£±¡Ë£²¡ÊÆ±°ì·úÊª½»µï¼Ô¡Ë
                   WHEN    "114042210"
      *            ºßÂð´µ¼ÔË¬Ìä¿ÇÎÅÎÁ¡Ê£²¡Ë
                   WHEN    "114042810"
      *            ºßÂð´µ¼ÔË¬Ìä¿ÇÎÅÎÁ¡Ê£²¡Ë¥í
                   WHEN    "114046310"
                       MOVE    1               TO  SPA-HOUMON-ARI
      *            ³«Êü·¿ÉÂ±¡¶¦Æ±»ØÆ³ÎÁ¡Ê£±¡Ë
                   WHEN    "180010510"
      *            ºßÂð´µ¼ÔÆþ±¡¶¦Æ±»ØÆ³ÎÁ¡Ê£±¡Ë
                   WHEN    "180015910"
                       MOVE    1               TO  SPA-KAIHOU1-ARI
      *            ÃÏ°èÏ¢ÂÓÂà±¡»þ¶¦Æ±»ØÆ³ÎÁ¡Ê£±¡Ë
                   WHEN    "113008610"
                   WHEN    "113008710"
                       MOVE    1               TO  SPA-KAIHOU1-ARI
      *            ¿²¤¿¤­¤êÏ·¿ÍÂà±¡»þ¶¦Æ±»ØÆ³ÎÁ¡Ê£±¡Ë
                   WHEN    "190766710"
                       MOVE    1               TO  SPA-KAIHOU2-ARI
      *
      *            À¸³è½¬´·ÉÂ»ØÆ³´ÉÍýÎÁ
                   WHEN    "113003910"
                   WHEN    "113005810"
                   WHEN    "113005910"
      *                ±¡³°
                       MOVE    "1"             TO  SPA-INGAIKBN
                       MOVE    1               TO  SPA-SEIKATU-ARI
                   WHEN    "113004010"
                   WHEN    "113006010"
                   WHEN    "113006110"
      *                ±¡Æâ
                       MOVE    "0"             TO  SPA-INGAIKBN
                       MOVE    1               TO  SPA-SEIKATU-ARI
      *
      *            ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê»»Äê
                   WHEN    "113003510"
                   WHEN    "113003610"
      *                ±¡³°
                       MOVE    "1"             TO  SPA-INGAIKBN
                       MOVE    1               TO  SPA-SYONIKA-ARI
                   WHEN    "113003710"
                   WHEN    "113003810"
      *                ±¡Æâ
                       MOVE    "0"             TO  SPA-INGAIKBN
                       MOVE    1               TO  SPA-SYONIKA-ARI
      *
      *                Æ±ÆüÂ¾²Ê¼õ¿Ç
                   WHEN    "830000020"
                   WHEN    "830000021"
                       MOVE    1               TO  SPA-FUKU-SRYKA
      *            ËýÀ­áÖÄË¼À´µ´ÉÍýÎÁ
                   WHEN    "113006510"
                       MOVE    1               TO  SPA-TOKUTEI-KNJ
      *            µÞÀ­È¯À¸
                   WHEN    "099800101"
                       MOVE    1               TO  SPA-KYUSEI-FLG
      *H24.4 ²þÀµ
      *        ¸å´ü¹âÎð¼Ô¿ÇÎÅÎÁ¶èÊ¬Î®ÍÑ
      *        ³°Íè¥ê¥Ï¥Ó¥ê¥Æ¡¼¥·¥ç¥ó¿Ç»¡ÎÁ
               WHEN    "113013910"
               WHEN    "113014010"
                   MOVE    2                   TO  SPA-KOURESRY-ARI
      *        ³°ÍèÊü¼ÍÀþ¾È¼Í¿Ç»¡ÎÁ
               WHEN    "113014110"
                   MOVE    3                   TO  SPA-KOURESRY-ARI
      *!!
      *H26.4
      *H30.4
      *            ÃÏ°èÊñ³ç¿ÇÎÅÎÁ
                   WHEN    CONS-CHIKIHKT1
                   WHEN    CONS-CHIKIHKT2
                       MOVE    1                   TO  SPA-CHKHKT-ARI
      *!!
      *H30.4
      *            Ç§ÃÎ¾ÉÃÏ°èÊñ³ç¿ÇÎÅÎÁ
                   WHEN    CONS-NNCHIHKT1
                   WHEN    CONS-NNCHIHKT2
                       MOVE    1                   TO  SPA-NNCHKT-ARI
      *            ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅ²Ê»»Äê
                   WHEN    "113019710"
                   WHEN    "113019810"
      *                ±¡³°
                       MOVE    "1"             TO  SPA-INGAIKBN
                       MOVE    1               TO  SPA-SYONIKKR-ARI
                   WHEN    "113019910"
                   WHEN    "113020010"
      *                ±¡Æâ
                       MOVE    "0"             TO  SPA-INGAIKBN
                       MOVE    1               TO  SPA-SYONIKKR-ARI
      *
      *            ¥ª¥ó¥é¥¤¥ó¿ÇÎÅÎÁ
                   WHEN    CONS-ONLINE01
                       MOVE    1               TO  SPA-ONLINE-ARI
               END-EVALUATE
      *        ºßÂðÎÅÍÜ»ØÆ³ÎÁ¤ÎÈ½Äê
               IF     (SPA-COM-INPUTCD (IDX)(1:3)  =   "114") AND
                      (SPA-COM-DATAKBN (IDX)       =   "1"  )
                   IF     (SPA-COM-CDKBN-KBN(IDX)  =   "C"  ) AND
                          (SPA-COM-CDKBN-KBNNUM (IDX)
                                                   >=  "100" AND
                                                   <=  "112")
                       MOVE    1               TO  WRK-ZAITAKU-CNT
                   END-IF
               END-IF
      *
      *        ¿Ç»¡ÎÁ¸¡º÷
               SET     TBL-IDX             TO  1
               SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                   AT   END
                        MOVE    ZERO           TO  FLG-ARI
                    WHEN   SPA-COM-INPUTCD (IDX)
                                              =   TBL-SRYCD (TBL-IDX)
                        MOVE    1                  TO  FLG-ARI
                        MOVE    TBL-KBN (TBL-IDX)  TO  WRK-KBN
               END-SEARCH
               IF      FLG-ARI             =   1
                   EVALUATE    WRK-KBN
      *                ÅÅÏÃºÆ¿Ç¡¢Æ±ÆüÅÅÏÃºÆ¿Ç
                       WHEN    "T"
                       WHEN    "S"
      *H24.4
                       WHEN    "J"
                           MOVE    1               TO  SPA-TELSAI-ARI
      **************** WHEN    SPACE
      *                WHEN    OTHER
      *                ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê»»Äê
      *                    IF      SPA-COM-INPUTCD (IDX)(1:3)
      *                                                =   "113"
      *                        MOVE    1           TO  SPA-SYONIKA-ARI
      ****************     END-IF
                   END-EVALUATE
      *H25.9
               ELSE
      *            Ï«ºÒ¥³¡¼¥ÉÈ½Äê
                   SET     TBL-RSI              TO  1
                   SEARCH  TBL-RSI-SINSATU-OCC  VARYING   TBL-RSI
                   AT  END
                       MOVE    SPACE              TO  WRK-KBN
                    WHEN   SPA-COM-INPUTCD (IDX)
                                              =   TBLR-SRYCD (TBL-RSI)
                       MOVE    1                  TO  FLG-ARI
                       MOVE    TBLR-KBN   (TBL-RSI)   TO  WRK-KBN
                   END-SEARCH
                   EVALUATE    WRK-KBN
      *                ÅÅÏÃºÆ¿Ç¡¢Æ±ÆüÅÅÏÃºÆ¿Ç
                       WHEN    "T"
                       WHEN    "S"
                       WHEN    "J"
                           MOVE    1               TO  SPA-TELSAI-ARI
                   END-EVALUATE
      *
               END-IF
      *H30.4
      ****     Ç¥ÉØ²Ã»»È½Äê
      ***          PERFORM 6002-NINPUKBN-CHECK-SEC
             END-IF
           END-PERFORM
           IF      SPA-SYONIKA-ARI     =   ZERO
               MOVE    SPA-SYONIKA-ARI2    TO  SPA-SYONIKA-ARI
           END-IF
           IF      SPA-SYONIKKR-ARI    =   ZERO
               MOVE    SPA-SYONIKKR-ARI2    TO  SPA-SYONIKKR-ARI
           END-IF
           .
       600-SANTEI-CNT-EXT.
           EXIT.
      *
      *H30.4
      *****************************************************************
      *    Ç¥ÉØ²Ã»»È½Äê½èÍý
      *****************************************************************
       6002-NINPUKBN-CHECK-SEC              SECTION.
      *
           SET     TBL-NPIDX18         TO  1
           SEARCH  TBL-NINPUKSN18-OCC  VARYING   TBL-NPIDX18
              AT   END
                   CONTINUE
               WHEN   (TBL-NP18-SRYCD (TBL-NPIDX18)
                                           =   SPA-COM-INPUTCD (IDX))
                   MOVE    1                   TO  SPA-NINPUKBN-IN
           END-SEARCH
           .
       6002-NINPUKBN-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *     ºß°åÁí´ÉÅù¤ÎÈ½Äê½èÍý
      *****************************************************************
       6001-ZISOSIN-CHK-SEC              SECTION.
      *
      *    ºßÂð»þ°å³ØÁí¹ç´ÉÍýÎÁÅùÈ½Äê¡Êºß°åÁí´É¡¦ÆÃ°åÁí´É¡Ë
           SET     TBL-ZSIDX           TO  1
           SEARCH  TBL-ZISOSIN-OCC     VARYING   TBL-ZSIDX
              AT   END
                   MOVE    SPACE                   TO  WRK-ZS-KBN
                   MOVE    SPACE                   TO  WRK-ZS-GRP
               WHEN   (TBL-ZS-SRYCD (TBL-ZSIDX)
                                           =   SPA-COM-INPUTCD (IDX))
                   MOVE    TBL-ZS-GRP (TBL-ZSIDX)  TO  WRK-ZS-GRP
                   MOVE    TBL-ZS-KBN (TBL-ZSIDX)  TO  WRK-ZS-KBN
           END-SEARCH
           EVALUATE    WRK-ZS-GRP(1:1)
               WHEN    "0"
      *        ºßÂð»þ°å³ØÁí¹ç´ÉÍýÎÁ»»Äê¡Êºß°åÁí´É¡Ë
      *            ½èÊý¤»¤óÍ­¡Ê±¡³°¡Ë
                   MOVE    1               TO  SPA-ZAIKANRI-ARI
                   MOVE    "1"             TO  SPA-INGAIKBN
               WHEN    "1"
      *        ÆÃÄê»ÜÀßÆþµï»þ°å³ØÁí¹ç´ÉÍýÎÁ¡ÊÆÃ°åÁí´É¡Ë
      *            ½èÊý¤»¤óÍ­¡Ê±¡³°¡Ë
                   MOVE    1               TO  SPA-IGAKUKAN-ARI
                   MOVE    "1"             TO  SPA-INGAIKBN
               WHEN    "2"
      *        ºßÂð¤¬¤ó°åÁí¹ç
                   IF      WRK-ZS-KBN          =   "1"
      *            ½èÊý¤»¤óÍ­¡Ê±¡³°¡Ë
                       MOVE    1               TO  SPA-ZAIMATU-ARI
                       MOVE    "1"             TO  SPA-INGAIKBN
                   ELSE
      *            ½èÊý¤»¤óÌµ¡Ê±¡Æâ¡Ë
                       MOVE    2               TO  SPA-ZAIMATU-ARI
                       MOVE    "0"             TO  SPA-INGAIKBN
                   END-IF
      *
           END-EVALUATE
      *
      *    ½èÊý¤»¤ó¸òÉÕ¤Ê¤·È½Äê
           EVALUATE    SPA-COM-INPUTCD (IDX)
      *        ½èÊýäµÌµ¸òÉÕ²Ã»»¡Êºß°åÁí´É¡¦»Ü°åÁí´É¡Ë
               WHEN    CONS-C0020-KSN
                   MOVE    "0"             TO  SPA-INGAIKBN
      *H30.4       ¼êµ»ÎÁ¤Ë¤è¤êÈ½Äê
                   IF      SPA-ZAIKANRI-ARI    =   1
      *            ºß°åÁí´É
                       MOVE    2               TO  SPA-ZAIKANRI-ARI
                   END-IF
      *            »Ü°åÁí´É
                   IF      SPA-IGAKUKAN-ARI    =   1
                       MOVE    2               TO  SPA-IGAKUKAN-ARI
                   END-IF
      *H304   ÇÑ»ß
      *        WHEN    CONS-C0022-KSN
      *            ÆÃ°åÁí´É
      *            MOVE    2               TO  SPA-IGAKUKAN-ARI
      ****         MOVE    "0"             TO  SPA-INGAIKBN
           END-EVALUATE
      *
           .
       6001-ZISOSIN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *     ºÞÊ¬Î¥¸å¤ÎÆÃÄê»»Äê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       700-SANTEI-CHK-SEC              SECTION.
      *
      *    Ç¥ÉØ²Ã»»È½Äê
           PERFORM 7001-NINPU-CHK-SEC
      *H30.9
      *    Æþ±¡¤Ï°Ê²¼½èÍý¤Ê¤·
           IF      SPA-NYUGAIKBN       =   "1"
               GO      TO      700-SANTEI-CHK-EXT
           END-IF
      *
      *    ¥¢¥Õ¥¿¡¼¥±¥¢ÂÐ¾Ý³°
           IF      SPA-RSI-HKNKBN      =   "3"
               GO      TO      700-SANTEI-CHK-EXT
           END-IF
      *
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ¥Á¥§¥Ã¥¯
           PERFORM 5019-SYONIKA-CHK-SEC
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      700-SANTEI-CHK-EXT
           END-IF
      *
      *****¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê¥Á¥§¥Ã¥¯
      *    IF     (SPA-NETAKIRI-ARI    NOT =   ZERO )  OR
      *           (SPA-NETAKIRI-ARI2   NOT =   ZERO )
      *        PERFORM 5021-NETAKIRI-CHK-SEC
      *        IF      SPA-ERRCD       NOT =   SPACE
      *            GO      TO      700-SANTEI-CHK-EXT
      *        END-IF
      **** END-IF
      *
      *    À¸³è½¬´·ÉÂ»ØÆ³´ÉÍý²Ê¥Á¥§¥Ã¥¯
           IF     (SPA-SEIKATU-ARI     NOT =   ZERO )  OR
                  (SPA-SEIKATU-ARI2    NOT =   ZERO )
      *        Êñ³ç¿ÇÎÅ¤Ï¥Á¥§¥Ã¥¯¤Ê¤·
               IF      SPA-HKTSANTEI-203   =   ZERO
      *
               PERFORM 5022-SEIKATU-CHK-SEC
               IF      SPA-ERRCD       NOT =   SPACE
                   GO      TO      700-SANTEI-CHK-EXT
               END-IF
      *
               END-IF
           END-IF
      *
      *
      *    ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ¥Á¥§¥Ã¥¯
           IF     (SPA-ZAIMATU-ARI     NOT =   ZERO )  OR
                  (SPA-ZAIMATU-ARI2    NOT =   ZERO )
      *        Êñ³ç¿ÇÎÅ¤Ï¥Á¥§¥Ã¥¯¤Ê¤·
               IF      SPA-HKTSANTEI-206   =   ZERO
      *
               PERFORM 5022-ZAIMATU-CHK-SEC
      *
               END-IF
           END-IF
      *
      *    ºßÂð»þ°å³ØÁí¹ç´ÉÍýÎÁ¥Á¥§¥Ã¥¯
           IF     (SPA-ZAIKANRI-ARI    NOT =   ZERO )
             OR   (SPA-ZAIKANRI-ARI2   NOT =   ZERO )
      *        Êñ³ç¿ÇÎÅ¤Ï¥Á¥§¥Ã¥¯¤Ê¤·
               IF      SPA-HKTSANTEI-204   =   ZERO
      *
               PERFORM 5022-ZAIKANRI-CHK-SEC
      *
               END-IF
           END-IF
      *
      *£È£²£²¡¥£´¤«¤éÇÑ»ß
      *    ¸å´ü¹âÎð¼Ô¿ÇÎÅÎÁ¥Á¥§¥Ã¥¯
      *    IF     (SPA-KOURESRY-ARI    NOT =   ZERO )
      *      OR   (SPA-KOURESRY-ARI2   NOT =   ZERO )
      *        PERFORM 5022-KOURESRY-CHK-SEC
      ***  END-IF
      *
      *    ÆÃÄê»ÜÀßÆþµï»þÅù°å³Ø´ÉÍýÎÁ
           IF     (SPA-IGAKUKAN-ARI    NOT =   ZERO )
             OR   (SPA-IGAKUKAN-ARI2   NOT =   ZERO )
      *        Êñ³ç¿ÇÎÅ¤Ï¥Á¥§¥Ã¥¯¤Ê¤·
               IF      SPA-HKTSANTEI-205   =   ZERO
      *
               PERFORM 5022-IGAKUKAN-CHK-SEC
      *
               END-IF
           END-IF
      *
           .
       700-SANTEI-CHK-EXT.
           EXIT.
      *H30.4
      *****************************************************************
      *     Ç¥ÉØ²Ã»»È½Äê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       7001-NINPU-CHK-SEC              SECTION.
      *
           MOVE    ZERO                TO  SPA-NINPUKBN-IN
           MOVE    ZERO                TO  IDX-SYU
      *
      *H30.5
           MOVE    ZERO                TO  FLG-SYUARI
           MOVE    ZERO                TO  FLG-SYUKSN
           MOVE    ZERO                TO  IDX-SYUKSN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE          )  OR
                              (SPA-COM-INPUTCD(IDX) =   SPACE  AND
                               SPA-GMN-INPUTCD(IDX) =   SPACE )
                          OR  (SPA-ERRCD        NOT =   SPACE )
             IF     (SPA-COM-HKNCOMBI (IDX)    NOT =   "9999" )
      *          ¼£¸³
                 OR (SPA-COM-CHIKENKBN (IDX)      =   "1")
               IF      SPA-COM-INPUTCD (IDX)(1:1) =   "1"
      *            Ç¥ÉØ²Ã»»È½Äê
                   SET     TBL-NPIDX18         TO  1
                   SEARCH  TBL-NINPUKSN18-OCC  VARYING   TBL-NPIDX18
                       AT   END
                           CONTINUE
                       WHEN   (TBL-NP18-SRYCD (TBL-NPIDX18)
                                           =   SPA-COM-INPUTCD (IDX))
                           IF    (SPA-COM-SRYKBN (IDX)   =   "11"
                                                         OR  "12"
                                                         OR  "13" )
                           AND   (IDX-SYU          >   ZERO   )
                               MOVE    1           TO  SPA-NINPUKBN-IN
                           ELSE
                               MOVE    "0187"      TO  SPA-ERRCD
                               MOVE    "1"         TO  SPA-COM-CUR
                                                                (IDX)
      *                        ²Ã»»¿ÇÎÅ¼ïÊÌ
                               IF      FLG-SYUKSN      =   1
                                   MOVE    IDX         TO  IDX-SYUKSN
                               END-IF
                           END-IF
                   END-SEARCH
      *            ¼êµ»ÎÁ
                   IF     (SPA-COM-DATAKBN(IDX)    =   "1" )
                       SET     TBL-IDX             TO  1
                       SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                           AT  END
                               CONTINUE
                           WHEN   SPA-COM-INPUTCD (IDX)
                                               =   TBL-SRYCD (TBL-IDX)
                               MOVE    IDX                 TO  IDX-SYU
                       END-SEARCH
                       IF      IDX-SYU         =   ZERO
      *                Ï«ºÒ¥³¡¼¥ÉÈ½Äê
                       SET     TBL-RSI              TO  1
                       SEARCH  TBL-RSI-SINSATU-OCC  VARYING   TBL-RSI
                       AT  END
                               CONTINUE
                        WHEN   SPA-COM-INPUTCD (IDX)
                                              =   TBLR-SRYCD (TBL-RSI)
                               MOVE    IDX                 TO  IDX-SYU
                       END-SEARCH
      *
                       END-IF
                   END-IF
               END-IF
      *        Ç§ÃÎ¾É
               EVALUATE    SPA-COM-INPUTCD (IDX)
      *            ÃÏ°èÊñ³ç¿ÇÎÅÎÁ
                   WHEN    CONS-CHIKIHKT1
                   WHEN    CONS-CHIKIHKT2
                       MOVE    IDX                 TO  IDX-SYU
      *            Ç§ÃÎ¾ÉÃÏ°èÊñ³ç¿ÇÎÅÎÁ
                   WHEN    CONS-NNCHIHKT1
                   WHEN    CONS-NNCHIHKT2
                       MOVE    IDX                 TO  IDX-SYU
               END-EVALUATE
      *
      *H30.5
               IF      IDX-SYU         >   ZERO
                   MOVE    1                TO  FLG-SYUARI
               END-IF
      *        ²Ã»»¿ÇÎÅ¼ïÊÌ
               IF     SPA-GMN-INPUTCD(IDX) =   ".114"
                                           OR  ".124"
                                           OR  ".133"
                   MOVE    1                 TO  FLG-SYUKSN
               END-IF
      *
             END-IF
      *
             IF     SPA-COM-ZAIEND (IDX)   =   "1"
                 MOVE    ZERO              TO  IDX-SYU
                 MOVE    ZERO              TO  FLG-SYUKSN
             END-IF
           END-PERFORM
      *
      *H30.5
           IF      SPA-ERRCD       NOT =   SPACE
      *        ²Ã»»¤Î¤ß¤Î¾ì¹ç¡¢OK
               IF     (FLG-SYUARI          =   ZERO )
                 AND  (IDX-SYUKSN      NOT =   ZERO )
                   MOVE    SPACE           TO  SPA-ERRCD
                   MOVE    SPACE           TO  SPA-COM-CUR
                                                 (IDX-SYUKSN)
               END-IF
           END-IF
           .
       7001-NINPU-CHK-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       5019-SYONIKA-CHK-SEC                SECTION.
      *
           MOVE    ZERO                TO  FLG-KBN
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE )   OR
                              (SPA-ERRCD           NOT =   SPACE )  OR
                              (SPA-GMN-INPUTCD (IDX)   =   SPACE )
      *      ¼«Èñ¤ÏÂÐ¾Ý³°
             IF     (SPA-COM-SRYKBN(IDX)     =   "95" OR
                                                 "96" OR
                                                 "98" OR
                                                 "99"  )  OR
      *!             Ê£¿ô²Ê¡¦ÊÝ¸±¹Ô
                    (SPA-GMN-INPUTCD(IDX)(1:1)   =   "#"  OR
                                                     "$" )
      *              ¥³¥á¥ó¥È
                 OR (SPA-COM-INPUTCD(IDX)(1:1)   =   "8" )
                 OR (SPA-COM-INPUTCD(IDX)(1:3)   =   "008" )
      *          Êñ³çÊÝ¸±
                 OR (SPA-COM-HKNCOMBI (IDX)      =   "9999")
      *          ¼£¸³
                 OR (SPA-COM-CHIKENKBN (IDX)      =   "1")
      *          ¼£¸³¸ºÅÀÊ¬
                 OR (SPA-COM-GENTEN (IDX)         =   "1")
      *          ¼£¸³ÌôÉ¾Ê¬
                 OR (SPA-COM-YAKUHYO (IDX)         =   "1")
                 CONTINUE
             ELSE
      *        ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê¤Î»þ¡¢¾®»ù²Ê³°Íè¿ÇÎÅ²Ê¤Î¤ß¤Ç¤¢¤ë¤³¤È
               IF     (SPA-SYONIKA-ARI     NOT =   ZERO )
                  OR  (SPA-SYONIKKR-ARI    NOT =   ZERO )
      *
                   EVALUATE    SPA-COM-SRYKBN  (IDX)
                       WHEN    "11"
                       WHEN    "12"
                           MOVE    ZERO            TO  FLG-OK
      *                    ¿Ç»¡ÎÁ¸¡º÷
                           PERFORM 50191-SRYCD-CHK-SEC
      *                    ÅÅÏÃºÆ¿Ç¤Ç¡¢ÅöÆü¿Ç»¡¤¬¤Ê¤¤¤³¤È
                           IF     (SPA-SYONIKA-ARI NOT =   2 )
                             AND  (SPA-SYONIKA-ARI2    =   ZERO)
                             AND  (WRK-KBN             =   "T"
      *H24.4
                                                       OR  "J"
                                                       OR  "S"  )
                               MOVE    1           TO  FLG-KBN
                               MOVE    1           TO  FLG-OK
                           END-IF
      *                    ÅÅÏÃºÆ¿Ç¤Î²Ã»»¤Ï£Ï£Ë
                           IF     (FLG-KBN             =   1  ) AND
                                  (SPA-COM-SRYKBN(IDX) =   "12") AND
                                  (SPA-COM-DATAKBN(IDX)
                                                       =   "2" )
                               MOVE    1           TO  FLG-OK
                           END-IF
      *TEST
      *H29.10
      *                    Æ±Æü»»ÄêºÑ¤ß¤Ç¤¢¤ì¤Ð¡¢»þ´Ö³°²Ã»»¤Î¤ßOK
                           IF     (SPA-COM-SRYKBN(IDX) =   "12" )
                             AND  (SPA-COM-DATAKBN(IDX) =   "2" )
                             AND  (SPA-COM-TIMEKSNKBN (IDX) NOT =  ZERO)
                             AND ((SPA-SYONIKA-ARI2    =   1  ) OR
                                  (SPA-SYONIKKR-ARI2   =   1  ))
                               MOVE    1           TO  FLG-OK
                           END-IF
      *                    ¼ïÊÌ¤Î¤ß¤Ï£Ï£Ë
                           IF     (SPA-GMN-INPUTCD(IDX)(1:4) =  ".124")
                             AND ((SPA-SYONIKA-ARI2    =   1  ) OR
                                  (SPA-SYONIKKR-ARI2   =   1  ))
                               MOVE    1           TO  FLG-OK
                           END-IF
      *TEST
      *
                           IF      FLG-OK          =   1
                               CONTINUE
                           ELSE
                               MOVE    "0044"      TO  SPA-ERRCD
                               MOVE    "1"         TO  SPA-COM-CUR
                                                                (IDX)
                           END-IF
      *
                       WHEN    "13"
      *                    ¼ïÊÌ¤Î¤ß¤Ï£Ï£Ë
                           IF      SPA-GMN-INPUTCD(IDX)(1:4) =   ".130"
                               CONTINUE
                           ELSE
      *                        ¿Ç»¡ÎÁ¸¡º÷
                               PERFORM 50191-SRYCD-CHK-SEC
                               IF      WRK-KAISU       =   2
      *                        Æ±ÆüºÆ¿Ç¤Î»þ¡¢¿Ç»¡ÎÁ¤Ï»»Äê¤Ç¤­¤Ê¤¤
                                   IF      SPA-SYONIKA-ARI     =   2
                                       MOVE    "0046"  TO  SPA-ERRCD
                                       MOVE    "1"     TO  SPA-COM-CUR
                                                              (IDX)
                                   END-IF
                               END-IF
      *                        Êñ³ç¿ÇÎÅ°Ê³°
                               IF     (SPA-HKTSANTEI-202   =   ZERO)
                                 AND  (SPA-SYONIKA-ARI NOT =   ZERO) 
      *
      *                        ÆÃÄê¤Î¿ÇÎÅ¹Ô°Ù¤Ç¤¢¤ë¤³¤È
                               PERFORM 50192-SYONIKASRYCD-CHK-SEC
                               IF      FLG-SYONIKA-CHK     =   ZERO
                                   MOVE    "0044"      TO  SPA-ERRCD
                                   MOVE    "1"         TO  SPA-COM-CUR
                                                                (IDX)
                               END-IF
      *
                               END-IF
      *
                           END-IF
      *
      *                ±ý¿ÇÎÁ¤Ç¤¢¤ë¤³¤È
                       WHEN    "14"
                           CONTINUE
      *
                       WHEN    "21"
                       WHEN    "22"
                       WHEN    "23"
                         IF    ((SPA-HKTSANTEI-202   =   ZERO )
                           AND  (SPA-SYONIKA-ARI NOT =   ZERO ))
                         OR    ((SPA-HKTSANTEI-209   =   ZERO )
                           AND  (SPA-SYONIKKR-ARI  NOT   =   ZERO ))
      *
      *                    ±¡Æâ»þ¤Î¿ÇÎÅ¼ïÊÌÊÑ¹¹
                           PERFORM 50192-SRYSYUKBN-CHK-SEC
      *
      *                    ÌôºÞ¤Î»þ¡¢±¡³°½èÊý¤Ç¤¢¤ë¤³¤È
                           IF    ((SPA-INGAIKBN        =   "1"  ) AND
                                  (SPA-COM-SRYSYUKBN(IDX)
                                                       =   "210" OR
                                                           "220" OR
                                                           "230" OR
                                                           "290" OR
                                                           "292" OR
      *H26.4                             ³°ÍÑ¡ÊÎ×»þ¡Ë
                                                           "293" OR
                                                           "296" OR
                                                           SPACE )) OR
                                 ( SPA-COM-SRYSYUKBN(IDX)
                                                       =   "212" OR
                                                           "222" OR
                                                           "232" OR
                                                           "292" OR
                                                           "298" OR
                                                           "295" )
                               CONTINUE
                           ELSE
      *                      ½èÊý¤Î¤ß¤Ï£Ï£Ë
                             IF     (SPA-COM-SRYSYUKBN(IDX)(3:1)
                                                   NOT =   "3" )
      *                       ³°ÍÑ¡ÊÎ×»þ
                              OR    (SPA-COM-SRYSYUKBN(IDX)
                                                       =   "293" )
                               MOVE    "0044"          TO  SPA-ERRCD
                               MOVE    "1"             TO  SPA-COM-CUR
                                                                (IDX)
                             END-IF
                           END-IF
                         END-IF
                       WHEN    OTHER
                           IF     (SPA-HKTSANTEI-202   =   ZERO)
                             AND  (SPA-SYONIKA-ARI NOT =   ZERO) 
      *
                            MOVE    "0044"      TO  SPA-ERRCD
                            MOVE    "1"         TO  SPA-COM-CUR
                                                          (IDX)
      *                    ³«Êü·¿ÉÂ±¡¶¦Æ±»ØÆ³ÎÁ¡Ê£±¡Ë¤Ç¤¢¤ë¤³¤È
                           PERFORM 50192-SYONIKASRYCD-CHK-SEC
                           IF      FLG-SYONIKA-CHK     =   1
                               MOVE    SPACE       TO  SPA-ERRCD
                               MOVE    SPACE       TO  SPA-COM-CUR
                                                                (IDX)
                           END-IF
      *                    ¤½¤ÎÂ¾¤Î¿ÇÎÅ¼ïÊÌ
                           IF      SPA-GMN-INPUTCD(IDX)(1:4)  =   ".800"
                                                              OR  ".850"
      *H28.7                   ¼«ÇåÀÕÂÐ±þ
                                                              OR  ".809"
                               MOVE    SPACE       TO  SPA-ERRCD
                               MOVE    SPACE       TO  SPA-COM-CUR
                                                                (IDX)
                           END-IF
      *H28.7               ¼«Èñ¥³¡¼¥É(¼«ÇåÀÕ¡Ë
                           IF     (SPA-COM-INPUTCD (IDX) (1:3)
                                                       =   "095"
                                                       OR  "096" )
                               MOVE    SPACE       TO  SPA-ERRCD
                               MOVE    SPACE       TO  SPA-COM-CUR
                                                                (IDX)
                           END-IF
      *
                           END-IF
                   END-EVALUATE
               ELSE
      *        ¾®»ù²Ê³°Íè¿ÇÎÅ²Ê°Ê³°¤Î»þ¡¢¾®»ù²Ê³°Íè¿ÇÎÅ²Ê¤Ç¤Ê¤¤¤³¤È
      *            ÆÃÄê¤Î¿ÇÎÅ¹Ô°Ù¤Ç¤¢¤ë¤³¤È
                   PERFORM 50192-SYONIKASRYCD-CHK-SEC
                   IF     (FLG-SYONIKA-CHK         =   ZERO)  OR
      *                   ³«Êü·¿ÉÂ±¡¶¦Æ±»ØÆ³ÎÁ¡¢ÃÏ°èÏ¢ÂÓ²Ã»»
                          (WRK-SYONIKA-KBN         =   "9" )
                       CONTINUE
                   ELSE
                       MOVE    "0045"          TO  SPA-ERRCD
                       MOVE    "1"             TO  SPA-COM-CUR (IDX)
                   END-IF
               END-IF
             END-IF
      *
             IF      SPA-COM-ZAIEND (IDX)  =   "1"
                  MOVE    ZERO             TO  FLG-KBN
             END-IF
           END-PERFORM
           .
       5019-SYONIKA-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅêÌô¼ïÊÌÊÑ¹¹½èÍý
      *****************************************************************
       50192-SRYSYUKBN-CHK-SEC                SECTION.
      *
      *    ¼«Æ°ÊÑ´¹¤Ê¤·
           IF      SPA-CHGSRYSYU-FLG   =   "1"
               GO     TO      50192-SRYSYUKBN-CHK-EXT
           END-IF
      *
           IF      SPA-COM-SRYSYUKBN(IDX)  =   SPACE
      *        ±¡³°
               IF      SPA-INGAIKBN        =   "1"
                   CONTINUE
               ELSE
                   MOVE    SPA-COM-SRYKBN(IDX)
                                           TO  SPA-COM-SRYSYUKBN(IDX)
                                                               (1:2)
                   MOVE    "3"             TO  SPA-COM-SRYSYUKBN(IDX)
                                                               (3:1)
               END-IF
           END-IF
           IF      SPA-COM-SRYSYUKBN(IDX)  =   "210"
                                           OR  "220"
                                           OR  "230"
      *        ±¡³°
               IF      SPA-INGAIKBN        =   "1"
                   CONTINUE
               ELSE
                   MOVE    "3"             TO  SPA-COM-SRYSYUKBN(IDX)
                                                               (3:1)
                   IF      SPA-GMN-INPUTCD(IDX)(1:1)   =   "."
                       MOVE    "3"         TO  SPA-GMN-INPUTCD(IDX)
                                                               (4:1)
                       PERFORM 501921-SRYSYUMEI-HEN-SEC
                   END-IF
               END-IF
           END-IF
      **** ½èÊý¤Î¤ß
      *    IF      SPA-COM-SRYSYUKBN(IDX)(3:1) =   "3"
      *        ±¡³°
      *        IF      SPA-INGAIKBN        =   "1"
      *            MOVE    "0"             TO  SPA-COM-SRYSYUKBN(IDX)
      *                                                        (3:1)
      *            IF      SPA-GMN-INPUTCD(IDX)(1:1)   =   "."
      *                MOVE    "0"         TO  SPA-GMN-INPUTCD(IDX)
      *                                                        (4:1)
      *                PERFORM 501921-SRYSYUMEI-HEN-SEC
      *            END-IF
      *        END-IF
      *****END-IF
           .
       50192-SRYSYUKBN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¼ïÊÌÌ¾ÊÔ½¸½èÍý
      *****************************************************************
       501921-SRYSYUMEI-HEN-SEC             SECTION.
      *
      *    ¿ÇÎÅ¼ïÊÌ¥Æ¡¼¥Ö¥ë¥»¥Ã¥È
           CALL    "ORCSSRYSYU"        USING
                                       MSYU-DATA-REC
      *
           SET     MSYU-IDX            TO  1
           SEARCH      MSYU-TBL-OCC    VARYING   MSYU-IDX
                   AT   END
                       MOVE    SPACE       TO  SPA-GMN-MEISYO (IDX)
                   WHEN    SPA-COM-SRYSYUKBN(IDX)
                                           =   MSYU-SRYSYUKBN 
                                                           (MSYU-IDX)
                       MOVE    MSYU-SRYMEI (MSYU-IDX)
                                           TO  SPA-GMN-MEISYO (IDX)
           END-SEARCH 
      *
           .
       501921-SRYSYUMEI-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¿Ç»¡ÎÁ¸¡º÷½èÍý
      *****************************************************************
       50191-SRYCD-CHK-SEC                SECTION.
      *    ¿Ç»¡ÎÁ¸¡º÷
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
               AT   END
                    MOVE    ZERO           TO  FLG-ARI
                    MOVE    SPACE          TO  WRK-KBN
                    MOVE    ZERO           TO  WRK-KAISU
                WHEN   SPA-COM-INPUTCD (IDX)
                                          =   TBL-SRYCD (TBL-IDX)
                    MOVE    1                  TO  FLG-ARI
                    MOVE    TBL-KBN (TBL-IDX)  TO  WRK-KBN
                    MOVE    TBL-KAISU (TBL-IDX)    TO  WRK-KAISU
           END-SEARCH
           .
       50191-SRYCD-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ²Ê¥Á¥§¥Ã¥¯¥¯½èÍý
      *****************************************************************
       50192-SYONIKASRYCD-CHK-SEC                SECTION.
      *
      *    ¿Ç»¡ÎÁ¸¡º÷
           SET     TBL-SYO             TO  1
           SEARCH  TBL-SYONIKA-OCC     VARYING   TBL-SYO
               AT   END
                    MOVE    ZERO           TO  FLG-SYONIKA-CHK
                    MOVE   SPACE           TO  WRK-SYONIKA-KBN
                WHEN   SPA-COM-INPUTCD (IDX)
                                           =   TBL-SYONIKA-SRYCD
                                                      (TBL-SYO)
                    MOVE    TBL-SYONIKA-KBN (TBL-SYO)
                                           TO  WRK-SYONIKA-KBN
                    MOVE    1              TO  FLG-SYONIKA-CHK
           END-SEARCH
      *
      *H24.4 ÄÉ²Ã¤Î¥³¡¼¥É
           IF      SPA-COM-INPUTCD (IDX)   =   "113013710"
                                           OR  "113013810"
      *        ±¡Æâ¥È¥ê¥¢¡¼¥¸¼Â»ÜÎÁ¡¦Ìë´ÖµÙÆüµßµÞÈÂÁ÷°å³Ø´ÉÍýÎÁ
               MOVE    1                   TO  FLG-SYONIKA-CHK
               MOVE    "9"                 TO  WRK-SYONIKA-KBN
           END-IF
      *
      *H30.4 ÄÉ²Ã¤Î¥³¡¼¥É
           IF      SPA-COM-INPUTCD (IDX)   =   CONS-SYOUNICD1
                                           OR  CONS-SYOUNICD2
      *        µ¡Ç½¶¯²½²Ã»»¡Ê½é¿Ç¡Ë¤Ê¤É
               MOVE    1                   TO  FLG-SYONIKA-CHK
               MOVE    "9"                 TO  WRK-SYONIKA-KBN
           END-IF
      *R02.4 ÄÉ²Ã¤Î¥³¡¼¥É
           IF      SPA-COM-INPUTCD (IDX)   =   "113032310"
      *        ¿ÇÎÅ¾ðÊóÄó¶¡ÎÁ¡Ê£³¡Ë
               MOVE    1                   TO  FLG-SYONIKA-CHK
               MOVE    "9"                 TO  WRK-SYONIKA-KBN
           END-IF
           .
       50192-SYONIKASRYCD-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    À¸³è½¬´·ÉÂ»ØÆ³´ÉÍý²Ê¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       5022-SEIKATU-CHK-SEC                SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE   )   OR
                              (SPA-ERRCD           NOT =   SPACE )  OR
                              (SPA-GMN-INPUTCD (IDX)   =   SPACE )
      *      Êñ³çÊÝ¸±
             IF     (SPA-COM-HKNCOMBI (IDX)      =   "9999")
                 OR (SPA-GMN-INPUTCD  (IDX)(1:1) =   "#"
                                                 OR  "$"   )
      *          ¼£¸³
                 OR (SPA-COM-CHIKENKBN (IDX)      =   "1")
      *          ¼£¸³¸ºÅÀÊ¬
                 OR (SPA-COM-GENTEN (IDX)         =   "1")
      *          ¼£¸³ÌôÉ¾Ê¬
                 OR (SPA-COM-YAKUHYO (IDX)         =   "1")
               CONTINUE
             ELSE
      *        ¸¡ºº¡¢ÅêÌô¡¢Ãí¼Í¤Ï»»Äê¤Ç¤­¤Ê¤¤
               EVALUATE    SPA-COM-SRYKBN(IDX)
                   WHEN    "60"
                   WHEN    "64"
                   WHEN    "31"
                   WHEN    "32"
                   WHEN    "33"
                       MOVE    "0068"          TO  SPA-ERRCD
                       MOVE    "1"             TO  SPA-COM-CUR (IDX)
                   WHEN    "21"
                   WHEN    "22"
                   WHEN    "23"
      *                ±¡Æâ»þ¤Î¿ÇÎÅ¼ïÊÌÊÑ¹¹
                       PERFORM 50192-SRYSYUKBN-CHK-SEC
      *                ÌôºÞ¤Î»þ¡¢±¡³°½èÊý¤Ç¤¢¤ë¤³¤È
                       IF    ((SPA-INGAIKBN        =   "1"  ) AND
                              (SPA-COM-SRYSYUKBN(IDX)
                                                   =   "210" OR
                                                       "220" OR
                                                       "230" OR
                                                       "290" OR
                                                       "293" OR
                                                       "296" OR
                                                       SPACE  ))  OR
                             ( SPA-COM-SRYSYUKBN(IDX)
                                                   =   "212" OR
                                                       "222" OR
                                                       "232" OR
                                                       "292" OR
                                                       "298" OR
                                                       "295"  )
      *!!                  ±¡³°½èÊýäµ¤ò¸òÉÕ¤·¤Ê¤¤¾ì¹ç¤Î»þ¡¢¥¨¥é¡¼
      *                    IF     (SPA-SEIKATU-ARI     =   2 )  OR
      *                           (SPA-SEIKATU-ARI2    =   2 )
      *                      ½èÊý¤Î¤ß¤Ï£Ï£Ë
      *                      IF      SPA-COM-SRYSYUKBN(IDX)(3:1)
      *                                            NOT =   "3" 
      *                        MOVE    "0068"          TO  SPA-ERRCD
      *                        MOVE    "1"             TO  SPA-COM-CUR
      *                                                         (IDX)
      *                      END-IF
      *!!                  END-IF
                           CONTINUE
                       ELSE
      *                    ½èÊý¤Î¤ß¤Ï£Ï£Ë
                           IF     (SPA-COM-SRYSYUKBN(IDX)(3:1)
                                                   NOT =   "3"  )
      *                       ³°ÍÑ¡ÊÎ×»þ
                              OR    (SPA-COM-SRYSYUKBN(IDX)
                                                       =   "293" )
                               MOVE    "0068"          TO  SPA-ERRCD
                               MOVE    "1"             TO  SPA-COM-CUR
                                                             (IDX)
                           END-IF
                       END-IF
               END-EVALUATE
             END-IF
           END-PERFORM
           .
       5022-SEIKATU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ºßÂð»þ°å³ØÁí¹ç´ÉÍýÎÁ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       5022-ZAIKANRI-CHK-SEC                SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE    )   OR
                              (SPA-ERRCD           NOT =   SPACE )  OR
                              (SPA-GMN-INPUTCD (IDX)   =   SPACE )
      *      Êñ³çÊÝ¸±
             IF     (SPA-COM-HKNCOMBI (IDX)      =   "9999")
                 OR (SPA-GMN-INPUTCD  (IDX)(1:1) =   "#"
                                                 OR  "$"   )
      *          ¼£¸³
                 OR (SPA-COM-CHIKENKBN (IDX)      =   "1")
      *          ¼£¸³¸ºÅÀÊ¬
                 OR (SPA-COM-GENTEN (IDX)         =   "1")
      *          ¼£¸³ÌôÉ¾Ê¬
                 OR (SPA-COM-YAKUHYO (IDX)         =   "1")
               CONTINUE
             ELSE
      *        ÅêÌô¤Ï»»Äê¤Ç¤­¤Ê¤¤
               EVALUATE    SPA-COM-SRYKBN(IDX)
                   WHEN    "21"
                   WHEN    "22"
                   WHEN    "23"
      *                ±¡Æâ»þ¤Î¿ÇÎÅ¼ïÊÌÊÑ¹¹
                       PERFORM 50192-SRYSYUKBN-CHK-SEC
      *                ÌôºÞ¤Î»þ¡¢±¡³°½èÊý¤Ç¤¢¤ë¤³¤È
                       IF    ((SPA-INGAIKBN        =   "1"  ) AND
                              (SPA-COM-SRYSYUKBN(IDX)
                                                   =   "210" OR
                                                       "220" OR
                                                       "230" OR
                                                       "290" OR
                                                       "293" OR
                                                       "296" OR
                                                       SPACE  ))  OR
                             ( SPA-COM-SRYSYUKBN(IDX)
                                                   =   "212" OR
                                                       "222" OR
                                                       "232" OR
                                                       "292" OR
                                                       "298" OR
                                                       "295"  )
      *!!                  ±¡³°½èÊýäµ¤ò¸òÉÕ¤·¤Ê¤¤¾ì¹ç¤Î»þ¡¢¥¨¥é¡¼
      *                    IF     (SPA-SEIKATU-ARI     =   2 )  OR
      *                           (SPA-SEIKATU-ARI2    =   2 )
      *                      ½èÊý¤Î¤ß¤Ï£Ï£Ë
      *                      IF      SPA-COM-SRYSYUKBN(IDX)(3:1)
      *                                            NOT =   "3" 
      *                        MOVE    "1402"          TO  SPA-ERRCD
      *                        MOVE    "1"             TO  SPA-COM-CUR
      *                                                         (IDX)
      *                      END-IF
      *!!                  END-IF
                           CONTINUE
                       ELSE
      *                    ½èÊý¤Î¤ß¤Ï£Ï£Ë
                           IF     (SPA-COM-SRYSYUKBN(IDX)(3:1)
                                                   NOT =   "3" )
      *                       ³°ÍÑ¡ÊÎ×»þ
                              OR  (SPA-COM-SRYSYUKBN(IDX)
                                                       =   "293" )
                               MOVE    "1402"          TO  SPA-ERRCD
                               MOVE    "1"             TO  SPA-COM-CUR
                                                             (IDX)
                           END-IF
                       END-IF
               END-EVALUATE
             END-IF
           END-PERFORM
           .
       5022-ZAIKANRI-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ºßÂðËö´ü°åÎÅÁí¹ç¿Ç»¡ÎÁ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       5022-ZAIMATU-CHK-SEC                SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE    )   OR
                              (SPA-ERRCD           NOT =   SPACE )  OR
                              (SPA-GMN-INPUTCD (IDX)   =   SPACE )
      *      Êñ³çÊÝ¸±
             IF     (SPA-COM-HKNCOMBI (IDX)      =   "9999")
                 OR (SPA-GMN-INPUTCD  (IDX)(1:1) =   "#"
                                                 OR  "$"   )
      *          ¼£¸³
                 OR (SPA-COM-CHIKENKBN (IDX)      =   "1")
      *          ¼£¸³¸ºÅÀÊ¬
                 OR (SPA-COM-GENTEN (IDX)         =   "1")
      *          ¼£¸³ÌôÉ¾Ê¬
                 OR (SPA-COM-YAKUHYO (IDX)         =   "1")
               CONTINUE
             ELSE
      *        º£²óÆþÎÏ
               IF      SPA-ZAIMATU-ARI    NOT  =   ZERO
      *            ºßÂðÎÁ°Ê³°¤Ï»»Äê¤Ç¤­¤Ê¤¤
                   EVALUATE    SPA-COM-SRYKBN(IDX)
                   WHEN    "14"
                   WHEN    "95"
                   WHEN    "96"
                   WHEN    "98"
                   WHEN    "99"
                       CONTINUE
                   WHEN    "21"
                   WHEN    "22"
                   WHEN    "23"
      *                ±¡Æâ»þ¤Î¿ÇÎÅ¼ïÊÌÊÑ¹¹
                       PERFORM 50192-SRYSYUKBN-CHK-SEC
      *                ÌôºÞ¤Î»þ¡¢±¡³°½èÊý¤Ç¤¢¤ë¤³¤È
                       IF    ((SPA-INGAIKBN        =   "1"  ) AND
                              (SPA-COM-SRYSYUKBN(IDX)
                                                   =   "210" OR
                                                       "220" OR
                                                       "230" OR
                                                       "290" OR
                                                       "293" OR
                                                       "296" OR
                                                       SPACE  ))  OR
                             ( SPA-COM-SRYSYUKBN(IDX)
                                                   =   "212" OR
                                                       "222" OR
                                                       "232" OR
                                                       "292" OR
                                                       "298" OR
                                                       "295"  )
                           CONTINUE
                       ELSE
      *                    ½èÊý¤Î¤ß¤Ï£Ï£Ë
                           IF     (SPA-COM-SRYSYUKBN(IDX)(3:1)
                                                   NOT =   "3" )
      *                       ³°ÍÑ¡ÊÎ×»þ
                             OR   (SPA-COM-SRYSYUKBN(IDX)
                                                       =   "293" )
                               MOVE    "1421"          TO  SPA-ERRCD
                               MOVE    "1"             TO  SPA-COM-CUR
                                                             (IDX)
                           END-IF
                       END-IF
                       WHEN    "11"
                       WHEN    "12"
                           CONTINUE
                       WHEN    OTHER
      *                    »»Äê¥¨¥é¡¼
                           MOVE    "1421"          TO  SPA-ERRCD
                           MOVE    "1"             TO  SPA-COM-CUR
                                                                (IDX)
                   END-EVALUATE
               END-IF
            END-IF
           END-PERFORM
           .
       5022-ZAIMATU-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ÆÃÄê»ÜÀßÆþµï»þÅù°å³Ø´ÉÍýÎÁ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       5022-IGAKUKAN-CHK-SEC                SECTION.
      *
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE    )   OR
                              (SPA-ERRCD           NOT =   SPACE )  OR
                              (SPA-GMN-INPUTCD (IDX)   =   SPACE )
      *      Êñ³çÊÝ¸±
             IF     (SPA-COM-HKNCOMBI (IDX)      =   "9999")
                 OR (SPA-GMN-INPUTCD  (IDX)(1:1) =   "#"
                                                 OR  "$"   )
      *          ¼£¸³
                 OR (SPA-COM-CHIKENKBN (IDX)      =   "1")
      *          ¼£¸³¸ºÅÀÊ¬
                 OR (SPA-COM-GENTEN (IDX)         =   "1")
      *          ¼£¸³ÌôÉ¾Ê¬
                 OR (SPA-COM-YAKUHYO (IDX)         =   "1")
               CONTINUE
             ELSE
      *        ÅêÌô¤Ï»»Äê¤Ç¤­¤Ê¤¤
               EVALUATE    SPA-COM-SRYKBN(IDX)
                   WHEN    "21"
                   WHEN    "22"
                   WHEN    "23"
      *                ±¡Æâ»þ¤Î¿ÇÎÅ¼ïÊÌÊÑ¹¹
                       PERFORM 50192-SRYSYUKBN-CHK-SEC
      *                ÌôºÞ¤Î»þ¡¢±¡³°½èÊý¤Ç¤¢¤ë¤³¤È
                       IF    ((SPA-INGAIKBN        =   "1"  ) AND
                              (SPA-COM-SRYSYUKBN(IDX)
                                                   =   "210" OR
                                                       "220" OR
                                                       "230" OR
                                                       "290" OR
                                                       "293" OR
                                                       "296" OR
                                                       SPACE  ))  OR
                             ( SPA-COM-SRYSYUKBN(IDX)
                                                   =   "212" OR
                                                       "222" OR
                                                       "232" OR
                                                       "292" OR
                                                       "298" OR
                                                       "295"  )
                           CONTINUE
                       ELSE
      *                    ½èÊý¤Î¤ß¤Ï£Ï£Ë
                           IF     (SPA-COM-SRYSYUKBN(IDX)(3:1)
                                                   NOT =   "3" )
      *                       ³°ÍÑ¡ÊÎ×»þ
                            OR    (SPA-COM-SRYSYUKBN(IDX)
                                                       =   "293" )
                               MOVE    "1402"          TO  SPA-ERRCD
                               MOVE    "1"             TO  SPA-COM-CUR
                                                             (IDX)
                           END-IF
                       END-IF
               END-EVALUATE
             END-IF
           END-PERFORM
           .
       5022-IGAKUKAN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÆ¿ÇÎÁ¢ª½é¿ÇÎÁ¤Î¿¶ÂØ»þ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       900-SYOSIN-CHK-SEC             SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYCD
      *
           IF      SPA-COM-INPUTCD(1)(1:3) =   "113"
      *    ¾®»ù¤«¤«¤ê¤Ä¤±
               IF      SPA-SYONIKKR-ARI    =   1
      *            ±¡³°½èÊý
                   IF      SPA-INGAIKBN        =   "1"
                       MOVE    "113019710"         TO  WRK-SRYCD
                   ELSE
      *            ±¡Æâ½èÊý
                       MOVE    "113019910"         TO  WRK-SRYCD
                   END-IF
               END-IF
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ
               IF      SPA-SYONIKA-ARI     =   1
      *            ±¡³°½èÊý
                   IF      SPA-INGAIKBN        =   "1"
                       MOVE    "113003510"         TO  WRK-SRYCD
                   ELSE
      *            ±¡Æâ½èÊý
                       MOVE    "113003710"         TO  WRK-SRYCD
                   END-IF
               END-IF
           ELSE
               IF     (SPA-HKNKBN          =   1   )
      *        ¼«ÇåÀÕ¤Î·òÊÝ½àµò°Ê³°
               AND    (SPA-RSI-JUNKYO  NOT =   "1" )
      *            Ï«ºÒ¤Î½é¿ÇÎÁ»»Äê
                   MOVE    ZERO                TO  WRK-KAISU
                   MOVE    "F"                 TO  WRK-KBN
                   PERFORM 20091-RSI-SINSATU-SEC
               ELSE
      *            ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ°Ê³°
                   MOVE    "11"                TO  WRK-SRYKBN
                   MOVE    "F"                 TO  WRK-KBN
      *            ¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
                   PERFORM 2001-SRYCD-TBL-SEC
               END-IF
           END-IF
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           IF      SPA-COM-INPUTCD(1)(1:3) =   "113"
               MOVE    "2"                 TO  LNK-SC92-KBN
           ELSE
               MOVE    "1"                 TO  LNK-SC92-KBN
           END-IF
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    1                   TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *    ½é¿ÇÎÁ¤ÎÊ»ÍÑ¥¨¥é¡¼
           MOVE    ZERO                TO  SPA-SYOSIN-KEI
           MOVE    ZERO                TO  SPA-SYOSIN-KEIFLG
           IF      LNK-SC92-SYOKBN     =   "1"
      *        Á°¤ËÊ»ÍÑ»»Äê¤¬¤¢¤ë»þ¡¢ÉÂÌ¾¤¬¤¹¤Ù¤Æ¼£Ìþ¤Ç¤¢¤ë¤³¤È
               IF      SPA-BYOMEI-STR      =   ZERO
                   MOVE    1                   TO  SPA-SYOSIN-KEI
               ELSE
                   MOVE    "0033"              TO  LNK-SC92-ERRCD6
               END-IF
           END-IF
      *
      *    ¥¨¥é¡¼»þ¡¢ºÇ½é¤Î¥¨¥é¡¼¥³¡¼¥É¤ò¥»¥Ã¥È
           IF      SPA-ERRCD       NOT =   SPACE
               GO      TO      900-SYOSIN-CHK-EXT
           END-IF
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¤ÇÇ¯Îð¥¨¥é¡¼¤Ï£Ï£Ë¤È¤¹¤ë
           IF    ((SPA-SYONIKA-ARI     NOT =   ZERO )  OR
                  (SPA-SYONIKKR-ARI    NOT =   ZERO ))
              AND (LNK-SC92-ERRCD5     NOT =   SPACE)
               MOVE    SPACE               TO  LNK-SC92-ERRCD5
           END-IF
      *
           IF      LNK-SC92-ERRAREA    NOT =   SPACE
               IF      LNK-SC92-ERRCD3     NOT =   SPACE
                   MOVE    LNK-SC92-ERRCD3         TO  SPA-ERRCD
               ELSE
                   MOVE    "0001"                  TO  SPA-ERRCD
               END-IF
           END-IF
      *
           .
       900-SYOSIN-CHK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÃæÅÓ½ªÎ»Å¸³«¸å¤Î¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       1000-WKSRYACT-SYORI-SEC              SECTION.
      *
           MOVE    ZERO                TO  FLG-SYOSIN2
           MOVE    ZERO                TO  FLG-GAI
           MOVE    ZERO                TO  FLG-DUMMY
           MOVE    ZERO                TO  FLG-SINSATU-ARI
           MOVE    SPACE               TO  WRK-KBN3
           MOVE    SPACE               TO  WRK-KBN5
      *    »þ´Ö³°¤Ê¤·
           MOVE    1                   TO  FLG-JIKANKBN
      *    ²èÌÌ¥Æ¡¼¥Ö¥ëÆâÍÆ¥Á¥§¥Ã¥¯
           PERFORM 1001-TBLCHEK-SEC
      *    ³Æ¿Ç»¡»»Äê²ó¿ô½èÍý
           PERFORM 100-SANTEI-CHK-SEC
           PERFORM 600-SANTEI-CNT-SEC
      *
           MOVE    1                   TO  FLG-HENKAN
      *    £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁ¤ÎÊÑ¹¹¤ò¤ª¤³¤Ê¤ï¤Ê¤¤
           IF      FLG-DUMMY           =   1
               MOVE    ZERO                TO  FLG-HENKAN
           END-IF
      *    ÃæÅÓ½ªÎ»¤Ç¿Ç»¡ÎÁ¤¬¤Ê¤¤»þ
           IF     (FLG-SINSATU-ARI     =   ZERO )
               MOVE    ZERO                TO  FLG-HENKAN
           END-IF
      *    ¥ª¥ó¥é¥¤¥ó¿Ç»¡ÎÁ¤ÏÊÑ¹¹¤ò¤ª¤³¤Ê¤ï¤Ê¤¤
           IF      FLG-ONLINE          =   1
               MOVE    ZERO                TO  FLG-HENKAN
           END-IF
      *
           MOVE    ZERO                TO  FLG-DOUJI-HEN2
      *    Æ±ÆüºÆ¿Ç¤Ç¤¹¤Ç¤Ë¿Ç»¡¤¬¤¢¤ë»þ
           IF     (WRK-KBN3            =   "D"  )  AND
                 ((SPA-LSTYMD          =   SPA-SRYYMD) OR
                  (SPA-RRK-LSTYMD      =   SPA-SRYYMD))
               IF     (SPA-WKSRY-KARTE-FLG =   1   )
                   MOVE    ZERO                TO  FLG-HENKAN
               ELSE
      *            CLAIM¡¡¤«¤é¤Î»þ¡¢Æ±ÆüºÆ¿Ç¤âºÆÊÔ½¸
                   MOVE    1                   TO  FLG-DOUJI-HEN2
               END-IF
           END-IF
      *    ÅÅÏÃºÆ¿Ç¤Î»þ
           IF     (WRK-KBN3            =   "T"  OR  "S"
                                       OR  "J"  )
               MOVE    ZERO                TO  FLG-HENKAN
           END-IF
      *H24.4
      *    ºÆ¿ÇÆ±°ìÆü£²²ÊÌÜ¤Î»þ
           IF     (WRK-KBN3            =   "K"   )
      *        Æ±°ìÆü£²²ÊÌÜ
              OR  (WRK-KBN5            =   "D"   )
               MOVE    ZERO                TO  FLG-HENKAN
           END-IF
      *R02.4
           IF     (FLG-SYOSIN-ETC      =   1     )
               MOVE    ZERO                TO  FLG-HENKAN
           END-IF
      *
      *    ½é¿ÇÎÁ»»Äê¤Ç¡¢´û¤ËÅöÆü¼õ¿Ç¤¬¤¢¤ë»þ¤ÏÂÐ¾Ý
           IF     (FLG-SYOSIN2         =   1    )
      *        ½é¿ÇÎÁ°Ê³°¤Î»þ¡¢¼«Æ°È¯À¸¤¢¤ê
               IF     (SPA-SRYYMD      NOT =   SPA-LSTYMD )
      *            ÅöÆü¤Ë¿Ç»¡ÎÁ»»Äê¤Ê¤·
                 OR  ((SPA-SRYYMD          =   SPA-LSTYMD ) AND
                      (WRK-DAY-SINSATUCNT  =   ZERO        ))
      *
                   MOVE    FLG-SYOSIN2         TO  SPA-SYOSIN
      *H30.4       ½é¿Ç¤Ë²Ã»»¤òÄÉ²Ã¤¹¤ë¤¿¤á¡¢ÂÐ¾Ý¤È¤¹¤ë
      *                ½é¿ÇÎÁ¤òºÆÅÙÈ¯À¸
      *!!!
      *            ÃæÅÓ½ªÎ»Ê¬
      *??          IF     (SPA-WKSRY-KARTE-FLG =   1   )
      *                MOVE    ZERO                TO  FLG-HENKAN
      **           END-IF
      *            £Ã£Ì£Á£É£Í¤«¤é
      *            IF     (SPA-WKSRY-KARTE-FLG NOT =   1   )
      *                IF      (SPA-SINSATU-FLG    =   "0" )
      *                    ½é¿ÇÎÁ¤Ï¼«Æ°È¯À¸¤·¤Ê¤¤
      *                    MOVE    ZERO                TO  FLG-HENKAN
      *                    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¤¬»»Äê²ÄÇ½¤Ê»þ¤Ï¡¢ºÆÅÙ
      *                    IF      FLG-SYONIKA-ARI     =   1
      *                       OR   FLG-SYONIKKR-ARI    =   1
      *                        MOVE    1               TO  FLG-HENKAN
      *                    END-IF
      *                END-IF
      **           END-IF
               ELSE
                   MOVE    ZERO                TO  SPA-SYOSIN
               END-IF
           END-IF
      *    ÃæÅÓ½ªÎ»¤ÇºÆ»»Äê¤·¤Ê¤¤»þ
           IF     (SPA-CHUTOTENKAI-FLG =   "0"  )  AND
                  (SPA-WKSRY-KARTE-FLG =   1   )
               MOVE    ZERO                TO  FLG-HENKAN
           END-IF
      *    ¿Ç»¡ÎÁ¼«Æ°È¯À¸¤Ê¤·»þCLAIM¤â¤Ê¤·
           IF     (SPA-INITAUTO-FLG    =   "0" )
               MOVE    ZERO                TO  FLG-HENKAN
           END-IF
      *
      *ver.4.8
      *    ÅÅÏÃºÆ¿Ç½èÍýºÑ¤ß¶èÊ¬ÀßÄê
           IF     (WRK-KBN3            =   "T"  OR  "S" )
             AND  (IDX-TEL             >   ZERO         )
      *        £Ã£Ì£Á£É£Í¤«¤é¤Ï¡¢´Ä¶­ÀßÄê¤ÏÈ¿±Ç¤Ê¤·
               IF     (SPA-WKSRY-KARTE-FLG NOT =   1   )
                   MOVE    "2"             TO  SPA-COM-KSNAUTO
                                                   (IDX-TEL)
               END-IF
      *        ¿Ç»¡ÎÁ¼«Æ°È¯À¸¤Ê¤·»þCLAIM¤â¤Ê¤·
               IF     (SPA-INITAUTO-FLG    =   "0" )
      *        ÃæÅÓ½ªÎ»¤ÇºÆ»»Äê¤·¤Ê¤¤»þ
                 OR  ((SPA-CHUTOTENKAI-FLG =   "0"  )  AND
                      (SPA-WKSRY-KARTE-FLG =   1    ))
                   MOVE    "1"             TO  SPA-COM-KSNAUTO
                                                   (IDX-TEL)
               END-IF
           END-IF
      *ver.4.8
      *!!!!
      *!!!!
      *H30.4
      *    ÃæÅÓ½ªÎ»Ê¬¤Ï¡¢Ç¥ÉØ²Ã»»¥¯¥ê¥¢¡ÊÇ¥ÉØÀßÄê¤ÇÈ½Äê¡Ë
      *    IF     (SPA-WKSRY-KARTE-FLG =   1   )
      *        MOVE    ZERO                TO  FLG-NINPU-IN
      *    END-IF
      *!!!!
      *
      *    ¿Ç»¡ÎÁÊÑ´¹
           IF      FLG-HENKAN          =   1
      *        »þ´Ö³°¤Ê¤·
               MOVE    1                   TO  FLG-JIKANKBN
               PERFORM 10101-SINSATU-HENKAN-SEC
           END-IF
           .
       1000-WKSRYACT-SYORI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ²èÌÌ¥Æ¡¼¥Ö¥ëÆâÍÆ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       1001-TBLCHEK-SEC              SECTION.
      *
           MOVE    ZERO                TO  FLG-TAKA
           MOVE    ZERO                TO  FLG-ARI
           MOVE    ZERO                TO  IDX-TEL
           MOVE    ZERO                TO  FLG-ONLINE
           MOVE    SPACE               TO  WRK-KBN4
           MOVE    SPACE               TO  WRK-ETCKBN
      *TEST
           MOVE    ZERO                TO  FLG-SYOSIN-ETC
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE    )  OR
                             ((SPA-COM-INPUTCD(IDX) =   SPACE ) AND
                              (SPA-GMN-INPUTCD(IDX) =   SPACE ))
      *        ¿Ç»¡ÎÁ¸¡º÷
               MOVE    ZERO                TO  FLG-ARI
               IF      FLG-SINSATU-ARI     =   ZERO
                   SET     TBL-IDX             TO  1
                   SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                   AT  END
                       MOVE    ZERO                TO  FLG-ARI
                       MOVE    SPACE               TO  WRK-KBN
                       MOVE    ZERO                TO  WRK-KAISU
                   WHEN   SPA-COM-INPUTCD (IDX) =
                                             TBL-SRYCD (TBL-IDX)
                       MOVE    1                   TO  FLG-ARI
                       MOVE    TBL-KBN  (TBL-IDX)  TO  WRK-KBN
                       MOVE    1                   TO  FLG-SINSATU-ARI
                       MOVE    TBL-KBN  (TBL-IDX)  TO  WRK-KBN3
      *H25.4           ¾Ò²ð¤Ê¤·ÂÐ±þ
                       MOVE    TBL-ETCKBN(TBL-IDX) TO  WRK-ETCKBN
      *H26.4
                       MOVE    TBL-KAISU (TBL-IDX) TO  WRK-KAISU
      *H27.10          Æ±°ìÆü£²²ÊÌÜ
                       MOVE    TBL-KBN2  (TBL-IDX) TO  WRK-KBN5
                   END-SEARCH
               END-IF
      *
               IF      FLG-ARI             =   ZERO
      *            Ï«ºÒ¥³¡¼¥É¥Á¥§¥Ã¥¯¡Ê½é¿Ç¡Ë
                   SET     TBL-RSI              TO  1
                   SEARCH  TBL-RSI-SINSATU-OCC  VARYING   TBL-RSI
                       AT  END
                           MOVE    ZERO               TO  FLG-ARI
                           MOVE    SPACE              TO  WRK-KBN
                       WHEN    SPA-COM-INPUTCD (IDX)
                                              =   TBLR-SRYCD (TBL-RSI)
                           MOVE    1                  TO  FLG-ARI
                           MOVE    TBLR-KBN (TBL-RSI) TO  WRK-KBN
                           MOVE    1           TO  FLG-SINSATU-ARI
                           MOVE    TBLR-KBN (TBL-RSI)
                                                   TO  WRK-KBN2
                           MOVE    TBLR-KBN (TBL-RSI)  TO  WRK-KBN3
                           MOVE    TBLR-KBN2(TBL-RSI)  TO  WRK-KBN5
                   END-SEARCH
               END-IF
               IF      FLG-ARI             =   1
      *            ½é¿Ç
                   IF      WRK-KBN             =   "F"
                       MOVE    1               TO  FLG-SYOSIN2
                       IF      WRK-ETCKBN      =   "3"
                           MOVE    1           TO  FLG-SYOSIN-ETC
                       END-IF
                   END-IF
      *            ³°Íè´ÉÍý²Ã»»
                   IF      WRK-KBN             =   "G"
                       MOVE    1               TO  FLG-GAI
                   END-IF
      *ver.4.8
      *            ÅÅÏÃºÆ¿Ç¤Î°ÌÃÖ
                   IF     (WRK-KBN3            =   "T"  OR  "S" )
                       MOVE    IDX             TO  IDX-TEL
                   END-IF
      *
               END-IF
      *
               EVALUATE    SPA-COM-INPUTCD (IDX)
      *                £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁ
                   WHEN    "099110001"
                   WHEN    "099120001"
                       MOVE    1              TO  FLG-DUMMY
      *                Â¾²Ê¼õ¿Ç¡¦Â¾ÊÝ¸±
                   WHEN    "830000020"
                   WHEN    "830000021"
                   WHEN    "099999902"
                       MOVE    1               TO  FLG-TAKA
      *H30.4
      *            ¥ª¥ó¥é¥¤¥ó¿ÇÎÅÎÁ
                   WHEN    CONS-ONLINE01
                       MOVE    1               TO  FLG-ONLINE
               END-EVALUATE
      *        ³°Íè´ÉÍý²Ã»»
               IF      SPA-COM-INPUTCD (IDX)   =   TBLG-SRYCD
                   MOVE    1               TO  FLG-GAI
               END-IF
      *H25.9
      *        Ï«ºÒ³°Íè´ÉÍý²Ã»»
               IF      SPA-COM-INPUTCD (IDX)   =   TBLRG-SRYCD
                   MOVE    1               TO  FLG-GAI
               END-IF
           END-PERFORM
      *H30.4
      *    Ç¥ÉØ²Ã»»È½Äê
           PERFORM 7001-NINPU-CHK-SEC
           IF      SPA-NINPUKBN-IN         =   1
               MOVE    1                   TO  FLG-NINPU-IN
           END-IF
           MOVE    ZERO                TO  SPA-NINPUKBN-IN
           .
       1001-TBLCHEK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý
      *****************************************************************
       1010-SINSATU-HEN-SEC              SECTION.
      *
      *H26.2
      *    ÊÝ¸±¶èÊ¬ÊÑ¹¹¤Î»þ
           IF     (SPA-HKNKBN      NOT =   SPA-MAE-HKNKBN)
      *        ¾®»ù²Ê³°Íè¿ÇÎÅ²ÊÈ½Äê
               IF    ((SPA-SYONIKA         =   1   )  OR
                      (SPA-SYUGAKUKBN      =   1   ))
                 AND  (SPA-NYUGAIKBN       =   "2" )
      *            Åö·î»»Äê²ó¿ô¤òµá¤á¤ë
                   PERFORM 1001-TOUGETU-KAISU-SEC
      *            ¾®»ù²Ê³°Íè¿ÇÎÅ²ÊÈ½Äê
                   IF     (WRK-ZAITAKU-CNT     =   ZERO )
                     AND  (SPA-HKNKBN          =   ZERO )
      *H28.4           PERFORM 1001-SYONIKA-CHK-SEC
                       PERFORM 10013-SYONIKARRK-CHEK-SEC
                   ELSE
      **H26.5**        MOVE    ZERO            TO  SPA-SYONIKA-ARI3
                       MOVE    ZERO            TO  SPA-SYONIKA-ARI2
                       MOVE    ZERO            TO  SPA-SYONIKA-ARI
                       MOVE    ZERO            TO  SPA-SYONIKKR-ARI2
                       MOVE    ZERO            TO  SPA-SYONIKKR-ARI
                   END-IF
               END-IF
           END-IF
      *
      *
           MOVE    ZERO                TO  FLG-SYOSIN2
           MOVE    ZERO                TO  FLG-GAI
           MOVE    ZERO                TO  FLG-DUMMY
           MOVE    ZERO                TO  FLG-SINSATU-ARI
           MOVE    SPACE               TO  WRK-KBN3
           MOVE    SPACE               TO  WRK-KBN4
           MOVE    SPACE               TO  WRK-ETCKBN
           MOVE    ZERO                TO  FLG-DOUJI-HEN 
      *    »þ´Ö³°¤Ê¤·
           MOVE    ZERO                TO  FLG-JIKANKBN
      *    ¿Ç»¡ÎÁ¤ò»»ÄêÃæ¤«¤ÎÈ½Äê
           IF     (SPA-SYORIFLG        =   1    )
               OR (LNK-SC10S-SYORI     =   "S"  )
      *H24.5
               OR (LNK-SC10S-SYORI     =   "J"  )
      *        »þ´Ö³°¤Ê¤·
               IF      SPA-SYORIFLG        =   1
                   MOVE    1                   TO  FLG-JIKANKBN
               END-IF
      *        ²èÌÌ¥Æ¡¼¥Ö¥ëÆâÍÆ¥Á¥§¥Ã¥¯
               PERFORM 1001-TBLCHEK-SEC
           END-IF
      *!!!!!!!!!!!!!!!!!
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ°Ê³°¤ÎÆþÎÏ¤Ï¡¢¤½¤Î¤Þ¤Þ
           MOVE    ZERO                TO  FLG-SYONIKA-NAI
           MOVE    ZERO                TO  FLG-SYONIKKR-NAI
           IF     (SPA-SYONIKA         =   1  )
             AND  (LNK-SC10S-SYORI     =   "S"
                                       OR  "J"
                                       OR  "E"
                                       OR  "K" )
      *        ²èÌÌ¥Æ¡¼¥Ö¥ëÆâÍÆ¥Á¥§¥Ã¥¯
               PERFORM 1001-TBLCHEK-SEC
               IF     (WRK-KAISU           =   1  OR  3  OR 4)
                 AND  (SPA-SYONIKA-ARI     =   ZERO      )
                   MOVE    1               TO  FLG-SYONIKA-NAI
               END-IF
               IF     (WRK-KAISU           =   1  OR  3  OR 2 )
                 AND  (SPA-SYONIKKR-ARI    =   ZERO      )
                   MOVE    1               TO  FLG-SYONIKKR-NAI
               END-IF
           END-IF
      *
      *    Æ±»þÂ¾²Ê¼õ¿Ç¤¬¤¢¤Ã¤¿»þ¤Ï¡¢¿Ç»¡ÎÁ¤ÎÊÑ¹¹¤ò¤ª¤³¤Ê¤ï¤Ê¤¤
      *    ¡ÊÃæÅÓ½ªÎ»»þ°Ê³°¡Ë
           MOVE    1                   TO  FLG-HENKAN
           IF    ( LNK-SC10S-SYORI NOT =   "W"  AND "K"
                                                AND "J" )  AND
                 ((SPA-LSTYMD          =   SPA-SRYYMD) OR
                  (SPA-RRK-LSTYMD      =   SPA-SRYYMD))
               IF      SPA-TAKA-SRYKA-R    NOT =   SPACE
                   MOVE    ZERO                TO  FLG-HENKAN
               END-IF
           END-IF
      *
      *    ¿Ç»¡ÎÁÊÑ´¹¤ÇÆ±ÆüºÆ¿Ç°Ê³°¤Ï¤½¤Î¤Þ¤Þ
           IF      (LNK-SC10S-SYORI    =   "S" )  AND
                   (FLG-HENKAN         =   ZERO)
               IF     (SPA-TAKA-SRYKA-R    NOT =   SPACE ) AND
                      (FLG-SINSATU-ARI     =   1         )
                   MOVE    1               TO  FLG-DOUJI-HEN 
                   MOVE    1               TO  FLG-HENKAN
               END-IF
           END-IF
      *
      *H25.7
      *    ºÆ¿ÇÎÁÊÑ´¹¡Ê¡¥£±£²¡Ë¤ÇÂ¾²Ê¼õ¿Ç¤¢¤ê¤ÏÆ±ÆüºÆ¿ÇÎÁ¤È¤¹¤ë
           IF      (LNK-SC10S-SYORI    =   "E" )  AND
                   (FLG-HENKAN         =   ZERO)
               IF     (SPA-TAKA-SRYKA-R    NOT =   SPACE )
                   MOVE    1               TO  FLG-DOUJI-HEN 
                   MOVE    1               TO  FLG-HENKAN
               END-IF
           END-IF
      *
      *    £Ä£Õ£Í£Í£Ù¿Ç»¡ÎÁ¤ÎÊÑ¹¹¤ò¤ª¤³¤Ê¤ï¤Ê¤¤
           IF     (FLG-DUMMY           =   1     )
             AND  (SPA-PTTOKK-KBN      =   SPACE )
               MOVE    ZERO                TO  FLG-HENKAN
           END-IF
      *    ¿Ç»¡ÎÁ¼«Æ°È¯À¸¤Ê¤·»þ¡¢ÊÑ¹¹¤â¤Ê¤·
           IF     (SPA-INITAUTO-FLG    =   "0" )
               MOVE    ZERO                TO  FLG-HENKAN
           END-IF
      *    ¿Ç»¡ÎÁÊÑ´¹½èÍý
           IF      FLG-HENKAN          =   1
               PERFORM 10101-SINSATU-HENKAN-SEC
           END-IF
      *
           .
       1010-SINSATU-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¾®»ù²ÊÊÑ´¹¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       10013-SYONIKARRK-CHEK-SEC              SECTION.
      *
      *    ¾®»ù¤«¤«¤ê¤Ä¤±¿ÇÎÅÈ½Äê¡¡½¢³ØÁ°¤Î¤ß
           IF     (SPA-SYOUNI-ARI      =   1   )
              AND (SPA-SYUGAKUKBN      =   1   )
               PERFORM 1001-SYONIKKR-CHK-SEC
           END-IF
      *    ¾®»ù²Ê³°Íè¿ÇÎÅ²ÊÈ½Äê
           IF     (SPA-SYONIKKR-ARI3   =   ZERO )
               PERFORM 1001-SYONIKA-CHK-SEC
          END-IF
      *
           .
       10013-SYONIKARRK-CHEK-EXT.
           EXIT.
      *****************************************************************
      *    ¿Ç»¡ÎÁÊÑ´¹½èÍý
      *****************************************************************
       10101-SINSATU-HENKAN-SEC              SECTION.
      *
           MOVE    SPACE               TO  SPA-ERRCD
           MOVE    SPA-SCR-REC         TO  HZN-SCR-REC
           MOVE    SPACE               TO  SPA-SCR-REC
           INITIALIZE                  SPA-SCR-REC
           MOVE    ZERO                TO  SPA-GMN-MAX
           MOVE    ZERO                TO  IDX2
           MOVE    ZERO                TO  SPA-GMN-IDX
           MOVE    ZERO                TO  SPA-FUKU-SRYKA
      *
           IF      LNK-SC10S-SYORI NOT =   "W"
      *        ÃæÅÓ½ªÎ»Å¸³«¤Ï´û¤Ë»»ÄêºÑ¤ß
               PERFORM 100-SANTEI-CHK-SEC
           END-IF
      *H30.4
      *    ¾®»ù¹³¶ÝÅ¬ÀµÌô»ÈÍÑ²Ã»»¡Ê¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ë
           MOVE    SPACE               TO  WRK-SYO-SRYCD
           MOVE    SPACE               TO  WRK-SAI-SRYCD
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE  )  OR
                             ((HZN-COM-INPUTCD (IDX)   =   SPACE ) AND
                              (HZN-GMN-INPUTCD (IDX)   =   SPACE ))
                 IF     (HZN-COM-SRYKBN(IDX)     =   "13"  )
                    AND (HZN-COM-INPUTCD(IDX)    =   CONS-SYOUNICD2
                                                 OR  CONS-SYOKAKCD2)
                     MOVE    HZN-COM-INPUTCD(IDX)    TO  WRK-SYO-SRYCD
                 END-IF
      *          ÌôºÞÅ¬Àµ»ÈÍÑÏ¢·È²Ã»»¡ÊºÆ¿Ç¡Ë
                 IF     (HZN-COM-SRYKBN(IDX)     =   "12"  )
                    AND (HZN-COM-INPUTCD(IDX)    =   CONS-YKZTEKICD)
                     MOVE    HZN-COM-INPUTCD(IDX)    TO  WRK-SAI-SRYCD
                 END-IF
           END-PERFORM
      *
      *    ¿Ç»¡ÎÁÊÔ½¸
           PERFORM 200-SYOSIN-SET-SEC
      *    ¿ÇÎÅ¹Ô°ÙÆâÍÆ¤ÎÊÔ½¸
           PERFORM 10102-SINSATU-CHENGE-SEC
      *
           .
       10101-SINSATU-HENKAN-EXT.
           EXIT.
      *****************************************************************
      *    ¿Ç»¡ÎÁ¥Á¥§¥Ã¥¯ÊÑ´¹½èÍý
      *****************************************************************
       10102-SINSATU-CHENGE-SEC              SECTION.
      *
      *H30.4
      *    º£²óÊ¬¤Î½é¿ÇÈ½Äê
           PERFORM 101022-SYOSIN-CHENGE-SEC
      *
      *    ¿ÇÎÅ¹Ô°ÙÆâÍÆ¤ÎÊÔ½¸
           MOVE    ZERO                TO  FLG-JIKAN
           MOVE    ZERO                TO  FLG-CHK
           MOVE    SPACE               TO  WRK-SCR-REC
           INITIALIZE                  WRK-SCR-REC
           MOVE    ZERO                TO  IDX3
           MOVE    ZERO                TO  FLG-CHK-ALL
           MOVE    ZERO                TO  FLG-ARI2
           MOVE    ZERO                TO  FLG-FUKU
           MOVE    IDX2                TO  IDX-INT-MAX
      *
           MOVE    ZERO                TO  FLG-ARIRS
      *
           MOVE    ZERO                TO  FLG-JIHI-ARI
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE  )  OR
                             ((HZN-COM-INPUTCD (IDX)   =   SPACE ) AND
                              (HZN-GMN-INPUTCD (IDX)   =   SPACE ))
      *
               MOVE    ZERO                    TO  FLG-ARI
               IF      FLG-FUKU                =   ZERO
                 IF     (HZN-COM-SRYKBN(IDX)     =   "11"  OR  "12"
                                                 OR  "13"  OR  "14" ) OR
      *                ÎÅÍÜÃ´Åö¼êÅö
                     ( HZN-COM-INPUTCD(IDX)     =   "199000610" )
                   MOVE    HZN-COM-INPUTCD(IDX) TO  WRK-SRYCD
                   IF      HZN-COM-INPUTCD(IDX) NOT =   SPACE
                       PERFORM 10101-SINSATU-CHK-SEC
                   END-IF
      *
                   IF      FLG-ARI             =   1
                       IF     (HZN-GMN-INPUTCD(IDX)(1:1) NUMERIC  )  AND
                              (HZN-GMN-INPUTCD(IDX)(2:1) =   SPACE)
                           MOVE    HZN-GMN-INPUTCD(IDX)(1:1)
                                                  TO  FLG-JIKAN
                       END-IF
                       MOVE    1               TO  FLG-CHK
                   END-IF
                 END-IF
               END-IF
               IF      HZN-GMN-INPUTCD(IDX)(1:1)   =   "$"
                   MOVE    1                   TO  FLG-FUKU
               END-IF
               IF      FLG-ARI                 =   ZERO
                   IF      FLG-CHK             =   ZERO
                       ADD     1                   TO  IDX3
                       MOVE    HZN-GMN-TBL (IDX)   TO  WRK-GMN-TBL(IDX3)
                   END-IF
               END-IF
      *
      *        ºÞËè¤ËÂÐ¾Ý¤òÊÔ½¸¤¹¤ë
               IF     (HZN-COM-ZAIEND (IDX)    =   "1" )  OR
                     ((IDX                     <   SPA-MAX-LINE  )  AND
                      (WRK-GMN-INPUTCD(IDX + 1)(1:1)  =  "."))
      *            ¿ÇÎÅ¼ïÊÌ¤À¤±¤Ïºï½ü
                   IF     (IDX3                =   1  )  AND
                          (WRK-GMN-INPUTCD(IDX3)(1:1)  =  "." )
      *H24.11
                       IF     (HZN-GMN-INPUTCD(IDX  + 1)(1:1)
                                                       =  "." )
                       OR     (SPA-COM-KAIFLG (IDX2)   =   "1" )
                           MOVE    ZERO                TO  IDX3
                       ELSE
      *                    ¿ÇÎÅ¼ïÊÌ¤Î¹Ôºï½ü¥Á¥§¥Ã¥¯
                           PERFORM 4201-ZAIDEL-CHK-SEC
                       END-IF
      *
                   END-IF
                   PERFORM VARYING     IDX4    FROM   1   BY  1
                           UNTIL       IDX4    >   IDX3
                       ADD     1                   TO  IDX2
                       ADD     1                   TO  SPA-GMN-IDX
                       MOVE    WRK-GMN-TBL(IDX4)   TO  SPA-GMN-TBL
                                                                (IDX2)
                       MOVE    SPACE               TO  SPA-MAE-INPUTCD
                                                                (IDX2)
                       MOVE    SPACE               TO  SPA-COM-CHKFLG
                                                                (IDX2)
      *H27.12
      *                Á°¤¬¼«Èñ¤Î»þ
                       IF     (IDX4                =   1   )
                          AND (FLG-JIHI-ARI        =   1   )
                           PERFORM 101023-JIHIEND-CHK-SEC
                       END-IF
      *H27.12
      *                ¼«Èñ¿ÇÎÅ¼ïÊÌÍ­
                       IF      (IDX4               =   1  )
                           IF  (SPA-GMN-INPUTCD(IDX2)(1:4)
                                                   =   ".950"
                                                   OR  ".960")
                               MOVE    1           TO  FLG-JIHI-ARI
                           ELSE
                               MOVE    ZERO        TO  FLG-JIHI-ARI
                           END-IF
                      END-IF
                   END-PERFORM
                   INITIALIZE                  WRK-SCR-REC
                   MOVE    ZERO                TO  IDX3
                   MOVE    ZERO                TO  FLG-CHK-ALL
                   MOVE    ZERO                TO  FLG-CHK
               END-IF
           END-PERFORM
      *
      *    ¿Ç»¡ÎÁ¤ËÊÑ¹¹¤¬Ìµ¤¤»þ¡¢¤½¤Î¤Þ¤Þ
      *!** IF      FLG-ARI2            =   1
      *        MOVE    HZN-SCR-REC         TO  SPA-SCR-REC
      *        GO      TO      10102-SINSATU-CHENGE-EXT
      *!   END-IF
      *
      *    ºÞËè¤ËÂÐ¾Ý¤òÊÔ½¸¤¹¤ë
           IF      IDX3                >   ZERO
               IF     (IDX3                =   1  )  AND
                      (WRK-GMN-INPUTCD(IDX3)(1:1)  =  "." )
                   MOVE    ZERO                TO  IDX3
               END-IF
               PERFORM VARYING     IDX4    FROM   1   BY  1
                       UNTIL       IDX4    >   IDX3
                   ADD     1                   TO  IDX2
                   ADD     1                   TO  SPA-GMN-IDX
                   MOVE    WRK-GMN-TBL(IDX4)   TO  SPA-GMN-TBL
                                                            (IDX2)
                   MOVE    SPACE               TO  SPA-MAE-INPUTCD(IDX2)
                   MOVE    SPACE               TO  SPA-COM-CHKFLG
                                                                (IDX2)
      *H27.12
      *            Á°¤¬¼«Èñ¤Î»þ
                   IF     (IDX3                =   1   )
                      AND (FLG-JIHI-ARI        =   1   )
                       PERFORM 101023-JIHIEND-CHK-SEC
                   END-IF
               END-PERFORM
           END-IF
      *    »þ´Ö³°ÆþÎÏ¤¢¤ê
           IF      FLG-JIKAN       NOT =   ZERO
               IF      SPA-COM-INPUTCD(01)(1:1)    =   "1"
                  MOVE    SPA-GMN-INPUTCD(01) TO  WRK-INPUTCD
      *           ´û¤Ë»þ´Ö³°¤¬¤¢¤ë¾ì¹ç¡¢Á°¤Î»þ´Ö³°¤Ø
                  IF     (SPA-GMN-INPUTCD(01)(1:1) NUMERIC  )  AND
                         (SPA-GMN-INPUTCD(01)(2:1) =   SPACE)
                       MOVE    SPA-GMN-INPUTCD(01)(3:)
                                               TO  WRK-INPUTCD
                   END-IF
                   MOVE    SPACE               TO  SPA-GMN-INPUTCD(01)
                   MOVE    FLG-JIKAN           TO  SPA-GMN-INPUTCD(01)
                                                                (1:1)
                   MOVE    WRK-INPUTCD         TO  SPA-GMN-INPUTCD(01)
                                                                (3:)
                   MOVE    FLG-JIKAN           TO  SPA-COM-TIMEFLG(01)
               END-IF
           END-IF
           .
       10102-SINSATU-CHENGE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¼ïÊÌ¤Î¹Ôºï½ü¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       4201-ZAIDEL-CHK-SEC                 SECTION.
      *
      *    ¼¡¤¬ÌôºÞ¤ÇÁ°¤¬ºÞ½ªÎ»¤Ç¤Ê¤¤»þ
           IF     (HZN-COM-INPUTCD(IDX  +  1)(1:1) =   "6"   )
           AND    (SPA-COM-KAIFLG (IDX2)       NOT =   "1"   )
               IF     (SPA-COM-SRYKBN (IDX2)
                                               =   "11"
                                               OR  "12"
                                               OR  "13" )
               OR     (SPA-COM-SRYSYUKBN(IDX2)
                                               =   "600" )
                   CONTINUE
               ELSE
                   MOVE    "1"                 TO  SPA-COM-KAIFLG
                                                          (IDX2)
                   INITIALIZE                  ORCSC94AREA
                   MOVE    "1"                 TO  LNK-SC94-KBN
                   MOVE    "K02"               TO  LNK-SC94-PG
                   MOVE    IDX2                TO  LNK-SC94-IDX
                   CALL    "ORCSC94"           USING
                                               ORCSC94AREA
                                               SPA-SCR-REC
                                               SPA-AREA
               END-IF
           END-IF
      *
           IF     (HZN-COM-INPUTCD(IDX + 1)(1:1)   =   "6"   )
           AND    (SPA-COM-SRYSYUKBN(IDX2)     =   "600" )
           AND    (SPA-COM-KAISU    (IDX2)     <=  1     )
      *        ¸¡ºº¤Î»þ¡¢²ó¿ô¤¬Ìµ¸ú¤È¤Ê¤ë°Ù¡¢¿ÇÎÅ¼ïÊÌ¤òÊÑ¹¹¤¹¤ë
               MOVE    1                   TO  IDX3
               MOVE    HZN-COM-SRYKBN(IDX + 1)
                                           TO  WRK-GMN-INPUTCD
                                                   (IDX3)(2:2)
               MOVE    "0"                 TO  WRK-GMN-INPUTCD
                                                   (IDX3)(4:1)
           ELSE
               MOVE    ZERO                TO  IDX3
           END-IF
      *
           .
       4201-ZAIDEL-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¼«ÈñºÞ¤ÎºÞÊ¬Î¥È½Äê½èÍý
      *****************************************************************
       101023-JIHIEND-CHK-SEC              SECTION.
      *
           IF     (SPA-COM-ZAIEND (IDX2 - 1)   =   "1"  )
              AND (SPA-COM-KAIFLG (IDX2 - 1)   =   SPACE)
              AND (SPA-GMN-INPUTCD(IDX2)(1:1)  NOT =   "." )
      *        ¼«Èñ¤Î¼¡¤¬¿ÇÎÅ¼ïÊÌ¤Ç¤Ê¤¤»þ
               MOVE    "1"                 TO  SPA-COM-KAIFLG
                                                         (IDX2 - 1)
               INITIALIZE                  ORCSC94AREA
               MOVE    "1"                 TO  LNK-SC94-KBN
               MOVE    "K02"               TO  LNK-SC94-PG
               COMPUTE LNK-SC94-IDX        =   IDX2  -  1
               CALL    "ORCSC94"           USING
                                               ORCSC94AREA
                                               SPA-SCR-REC
                                               SPA-AREA
           END-IF
      *
           .
       101023-JIHIEND-CHK-EXT.
           EXIT.
      *****************************************************************
      *    ¿Ç»¡ÎÁ¥Á¥§¥Ã¥¯ÊÑ´¹½èÍý
      *****************************************************************
       10101-SINSATU-CHK-SEC              SECTION.
      *
      *    ¿Ç»¡ÎÁ¸¡º÷
           SET     TBL-IDX             TO  1
           SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
               AT  END
                   MOVE    ZERO                TO  FLG-ARI
                   MOVE    ZERO                TO  FLG-ARI3
               WHEN   WRK-SRYCD            =   TBL-SRYCD (TBL-IDX)
                   MOVE    1                   TO  FLG-ARI
                   MOVE    1                   TO  FLG-ARI3
           END-SEARCH
      *
           IF      FLG-ARI         =   ZERO
      *    ³°Íè´ÉÍý²Ã»»
               IF      WRK-SRYCD           =   TBLG-SRYCD
                   MOVE    1                   TO  FLG-ARI
      *            ³°Íè´ÉÍý²Ã»»¤ò¼«Æ°È¯À¸¤·¤Ê¤¤»þ¡¢ºï½ü¤·¤Ê¤¤
                   IF     (SPA-GAIKANRIKBN-CHK     =   3    )
                    AND   (FLG-GAIDEL              =   ZERO )
      *                Ï«ºÒ¥³¡¼¥É¤¬¤¢¤ì¤Ðºï½ü
                    AND   (FLG-ARIRS               =   ZERO )
                       MOVE    ZERO                TO  FLG-ARI
                   END-IF
               END-IF
           END-IF
      *
           IF      FLG-ARI         =   ZERO
      *        Ï«ºÒ¥³¡¼¥É¥Á¥§¥Ã¥¯
               SET     TBL-RSI              TO  1
               SEARCH  TBL-RSI-SINSATU-OCC  VARYING   TBL-RSI
                   AT  END
                       MOVE    ZERO                TO  FLG-ARI
                   WHEN    WRK-SRYCD       =   TBLR-SRYCD (TBL-RSI)
                       MOVE    1                   TO  FLG-ARI
                       MOVE    1                   TO  FLG-ARI3
                       MOVE    1                   TO  FLG-ARIRS
               END-SEARCH
      *        Ï«ºÒ³°Íè´ÉÍý²Ã»»
               IF      WRK-SRYCD           =   TBLRG-SRYCD
                   MOVE    1                   TO  FLG-ARI
               END-IF
           END-IF
      *    ¿Ç»¡ÎÁ¤ÇÆ±¤¸¥³¡¼¥É¤¬¤¢¤ë»þ
           IF      FLG-ARI3            =   1
               PERFORM VARYING     IDXS    FROM    1   BY  1
                       UNTIL      (IDXS    >   SPA-GMN-IDX )  OR
                                  (FLG-ARI2    =   1           )
                   IF     (WRK-SRYCD(1:1)          =   "1"  )  AND
                          (WRK-SRYCD               =   SPA-COM-INPUTCD
                                                            (IDXS))
                       MOVE    1               TO  FLG-ARI2
                   END-IF
               END-PERFORM
           END-IF
      *
      *    ¤½¤ÎÂ¾¤Î¼«Æ°È¯À¸Ê¬
           IF     WRK-SRYCD            =   "830000020"   OR
                                           "830000021"
               MOVE    1               TO  FLG-ARI
           END-IF
      *
      *    ¥À¥ß¡¼
           IF     WRK-SRYCD            =   "099110001"   OR
                                           "099120001"
               MOVE    1               TO  FLG-ARI
           END-IF
      *
      *    °é»ù±ÉÍÜ»ØÆ³ÎÁ
           IF     WRK-SRYCD            =   "111000470"
               MOVE    1               TO  FLG-ARI
      *H30.4
      *        ÃæÅÓ¥Ç¡¼¥¿Å¸³«¤Ç½é¿ÇÎÁ»»Äê»þ
               IF     (LNK-SC10S-SYORI     =   "W"  )
                  AND (FLG-SYOSIN-AUTO     =    1   )
      *            °é»ù±ÉÍÜ²Ã»»¼«Æ°»»Äê¤Î»þ¤Î¤ßºï½üÂÐ¾Ý
                   IF     (SPA-IKUJIEIYO-FLG   =   "1"  )
                      AND ((SPA-IKUJIEIYO-SRYKA =   ZERO   )  OR
                           (SPA-IKUJIEIYO-SRYKA =   SPA-SRYKA))
                       MOVE    1               TO  FLG-ARI
                   ELSE
                       MOVE    ZERO            TO  FLG-ARI
                   END-IF
               END-IF
           END-IF
      *H24.4
      *    »þ´Ö³°ÂÐ±þ²Ã»»
           IF     WRK-SRYCD            =   TBL-CHISRYCD1
                                       OR  TBL-CHISRYCD2
                                       OR  TBL-CHISRYCD3
               MOVE    1               TO  FLG-ARI
           END-IF
      *    ÌÀºÙ½ñÈ¯¹ÔÂÎÀ©Åù²Ã»»
           IF     WRK-SRYCD            =   TBL-MEISRYCD
               MOVE    1               TO  FLG-ARI
           END-IF
      *    ÃÏ°èÊñ³ç¿ÇÎÅ²Ã»»
           IF     WRK-SRYCD            =   TBL-CHKCARKSN1
                                       OR  TBL-CHKCARKSN2
               MOVE    1               TO  FLG-ARI
           END-IF
      *
      *    ¿²¤¿¤­¤êÏ·¿ÍºßÂðÁí¹ç¿ÇÎÅ²Ê
           IF     WRK-SRYCD            =   "114701210"   OR
                                           "114701710"
               PERFORM VARYING     IDXS    FROM    1   BY  1
                       UNTIL      (IDXS    >   SPA-GMN-IDX )  OR
                                  (FLG-ARI =   1           )
                   IF      SPA-COM-INPUTCD (IDXS)  =   "114701210" 
                                                   OR  "114701710"
                       MOVE    1               TO  FLG-ARI
                   END-IF
               END-PERFORM
           END-IF
      *    ÆÃÄêËýÀ­¼À´µ»ØÆ³ÎÁ
           IF     WRK-SRYCD            =   "113700710"   OR
                                           "113700810"   OR
                                           "113700610"   OR
                                           "113001910"   OR
                                           "113002010"   OR
                                           "113001810"
      *            ÈéÉæ²ÊÀ­¼À´µ»ØÆ³ÎÁ
                                       OR  "113000910"
                                       OR  "113002310"
               PERFORM VARYING     IDXS    FROM    1   BY  1
                       UNTIL      (IDXS    >   SPA-GMN-IDX )  OR
                                  (FLG-ARI =   1           )
                   IF      SPA-COM-INPUTCD (IDXS)  =   "113700710"
                                                   OR  "113700810"
                                                   OR  "113700610"
                                                   OR  "113001910"
                                                   OR  "113002010"
                                                   OR  "113001810"
      *            ÈéÉæ²ÊÀ­¼À´µ»ØÆ³ÎÁ
                                                   OR  "113000910"
                                                   OR  "113002310"
                       MOVE    1               TO  FLG-ARI
                   END-IF
               END-PERFORM
           END-IF
      *
      *    ¤½¤ÎÂ¾Æ±¤¸¥³¡¼¥É¤¬¤¢¤ë»þ
           MOVE    ZERO                TO  FLG-ARI1
           PERFORM VARYING     IDXS    FROM    1   BY  1
                   UNTIL      (IDXS    >   IDX-INT-MAX )  OR
                              (FLG-ARI =   1           )
               IF     (WRK-SRYCD(1:1)          =   "1"   ) AND
                      (WRK-SRYCD               =   SPA-COM-INPUTCD
                                                            (IDXS))
                   MOVE    1                   TO  FLG-ARI
               END-IF
      *H27.3   ³°Íè´ÉÍý²Ã»»¤ò»Ä¤¹»þ¡¢¿Ç»¡ÎÁ¤ò¼«Æ°»»Äê¤·¤Æ¤¤¤ë¤³¤È
               IF      WRK-SRYCD           =   TBLG-SRYCD
                   IF      (SPA-COM-INPUTCD (IDXS)(1:1)
                                               =   "1" )
                       MOVE    1               TO  FLG-ARI1
                   END-IF
                END-IF
           END-PERFORM
      *
      *H27.3
      *    ³°Íè´ÉÍý²Ã»»¤Îºï½ü
           IF     (FLG-ARI             =   ZERO       )
             AND  (WRK-SRYCD           =   TBLG-SRYCD )
               IF      FLG-ARI1            =   ZERO
                   MOVE    1                   TO  FLG-ARI
               END-IF
           END-IF
      *
           .
       10101-SINSATU-CHK-EXT.
           EXIT.
      *
      *H30.4
      *****************************************************************
      *    º£²óÊ¬¤ÎÈ½Äê½èÍý
      *****************************************************************
       101022-SYOSIN-CHENGE-SEC                 SECTION.
      *
           MOVE    SPACE              TO  WRK-KBN
           MOVE    SPACE              TO  WRK-KBN2
           MOVE    ZERO               TO  WRK-KAISU
           MOVE    ZERO               TO  FLG-ARI
           MOVE    ZERO               TO  FLG-SYOSIN-AUTO
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE    )  OR
                             ((SPA-COM-INPUTCD(IDX) =   SPACE ) AND
                              (SPA-GMN-INPUTCD(IDX) =   SPACE ))
                         OR  ( FLG-ARI     =   1      )
      *        ¿Ç»¡ÎÁ¸¡º÷
               SET     TBL-IDX             TO  1
               SEARCH  TBL-SINSATU-OCC     VARYING   TBL-IDX
                   AT  END
                       MOVE    ZERO                TO  FLG-ARI
               WHEN   SPA-COM-INPUTCD (IDX) =
                                             TBL-SRYCD (TBL-IDX)
                       MOVE    1                   TO  FLG-ARI
                       MOVE    TBL-KBN  (TBL-IDX)  TO  WRK-KBN
                       MOVE    TBL-KBN2 (TBL-IDX)  TO  WRK-KBN2
                       MOVE    TBL-KAISU (TBL-IDX) TO  WRK-KAISU
               END-SEARCH
      *
               IF      FLG-ARI             =   ZERO
      *            Ï«ºÒ¥³¡¼¥É¥Á¥§¥Ã¥¯¡Ê½é¿Ç¡Ë
                   SET     TBL-RSI              TO  1
                   SEARCH  TBL-RSI-SINSATU-OCC  VARYING   TBL-RSI
                       AT  END
                           MOVE    ZERO               TO  FLG-ARI
                       WHEN    SPA-COM-INPUTCD (IDX)
                                              =   TBLR-SRYCD (TBL-RSI)
                           MOVE    1                  TO  FLG-ARI
                           MOVE    TBLR-KBN (TBL-RSI) TO  WRK-KBN
                           MOVE    TBLR-KBN2(TBL-RSI) TO  WRK-KBN2
                   END-SEARCH
               END-IF
           END-PERFORM
      *
           IF     (WRK-KBN             =   "F" )
              AND (WRK-KAISU           =   1
                                       OR  ZERO   )
              AND (WRK-KBN2            =   SPACE)
               MOVE    1               TO  FLG-SYOSIN-AUTO
           END-IF
           .
       101022-SYOSIN-CHENGE-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    ¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý¡ÊÂ¾ÊÝ¸±¼õ¿Ç¤¢¤ê¡Ë
      *****************************************************************
       1012-TAHOKEN-HEN-SEC              SECTION.
      *
      *    »»Äê²ó¿ô·×»»ÊÔ½¸
           PERFORM 100-SANTEI-CHK-SEC
      *
           MOVE    SPA-SCR-REC         TO  HZN-SCR-REC
           MOVE    SPACE               TO  SPA-SCR-REC
           INITIALIZE                  SPA-SCR-REC
           MOVE    ZERO                TO  SPA-GMN-MAX
           MOVE    ZERO                TO  IDX2
           MOVE    ZERO                TO  SPA-GMN-IDX
           COMPUTE SPA-GMN-IDX         =   SPA-GMN-IDX   +   1
           MOVE    "099999902"         TO  WRK-SRYCD
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           MOVE    "1"                 TO  LNK-SC92-KBN
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    SPA-GMN-IDX         TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
      *
      *    ¥¨¥é¡¼»þ¡¢ÄÉ²Ã¤·¤Ê¤¤
           IF     (SPA-ERRCD           NOT =   SPACE )  OR
                  (LNK-SC92-ERRAREA    NOT =   SPACE )
               MOVE    SPACE           TO  SPA-ERRCD
               INITIALIZE              SPA-GMN-TBLREC (SPA-GMN-IDX)
               INITIALIZE              SPA-COM-TBLREC (SPA-GMN-IDX)
               COMPUTE SPA-GMN-IDX     =   SPA-GMN-IDX
                                       -   1
               GO      TO      1012-TAHOKEN-HEN-EXT
           END-IF
           MOVE    SPA-GMN-IDX         TO  IDX2
      *H27.3
      *    ³°Íè´ÉÍý²Ã»»ºï½ü
           MOVE    1                   TO  FLG-GAIDEL
           MOVE    ZERO                TO  FLG-ARIRS
      *
      *    ¿ÇÎÅ¹Ô°ÙÆâÍÆ¤ÎÊÔ½¸
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE  )  OR
                              (HZN-COM-INPUTCD (IDX)   =   SPACE   AND
                               HZN-GMN-INPUTCD (IDX)   =   SPACE )
               IF     (HZN-COM-SRYKBN(IDX)     =   "11"  OR  "12"
                                               OR  "13"  OR  "14" ) AND
                      (HZN-COM-INPUTCD(IDX)(1:1)   =   "1"   )
                   MOVE    HZN-COM-INPUTCD(IDX) TO  WRK-SRYCD
                   PERFORM 10101-SINSATU-CHK-SEC
                   IF      FLG-ARI             =   1
                       MOVE    1               TO  FLG-CHK
                   END-IF
               END-IF
               IF      HZN-COM-INPUTCD(IDX)    =   "099999902"
                   MOVE    1               TO  FLG-CHK
               END-IF
      *
               IF      FLG-CHK         =   ZERO
                   ADD     1                   TO  IDX2
                   ADD     1                   TO  SPA-GMN-IDX
                   MOVE    HZN-GMN-TBL(IDX)    TO  SPA-GMN-TBL (IDX2)
               END-IF
               IF      HZN-COM-ZAIEND (IDX)    =   "1"
                   MOVE     ZERO               TO  FLG-CHK
               END-IF
           END-PERFORM
           .
       1012-TAHOKEN-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¿Ç»¡ÎÁ»»Äê¸å¡¢¿Ç»¡ÎÁ¤Î¤ß¤ÎÊÑ¹¹½èÍý
      *****************************************************************
       1014-SINSATU-HENKAN-SEC              SECTION.
      *
      *    Ê£¿ô²Ê¤¬¤¢¤ë»þ¡¢ºÆÊÔ½¸
           MOVE    ZERO                TO  FLG-FUKU-ARI
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-MAX-LINE   )  OR
                             ((SPA-COM-INPUTCD(IDX) =   SPACE ) AND
                              (SPA-GMN-INPUTCD(IDX) =   SPACE ))
               IF      SPA-GMN-INPUTCD(IDX)(1:1)   =   "$"
                   MOVE    SPACE           TO  SPA-MAE-INPUTCD(IDX)
                   MOVE    1               TO  FLG-FUKU-ARI
               END-IF
           END-PERFORM
      *
           PERFORM 1010-SINSATU-HEN-SEC
      *
           IF      FLG-FUKU-ARI        =   1
      *        Ê£¿ôÎÁ¡Ê¡ð¡Ë¡¢ÊÝ¸±ÁÈ¹ç¤»¡Ê¡ô¡ËÂÐ±þ
               PERFORM 1015-FUKU-SYORI-SEC
           END-IF
           .
       1014-SINSATU-HENKAN-EXT.
           EXIT.
      *****************************************************************
      *    Ê£¿ôÎÁ¡Ê¡ð¡Ë¡¢ÊÝ¸±ÁÈ¹ç¤»¡Ê¡ô¡ËÂÐ±þ½èÍý
      *****************************************************************
       1015-FUKU-SYORI-SEC              SECTION.
      *
      *
           IF      LNK-SC10S-STRIDX    =   ZERO
               MOVE    1               TO  LNK-SC10S-STRIDX
           END-IF
      *
           PERFORM VARYING     IDX-A   FROM    LNK-SC10S-STRIDX   BY  1
                   UNTIL      (IDX-A   >   SPA-MAX-LINE  )  OR
                             ((SPA-COM-INPUTCD (IDX-A) =   SPACE ) AND
                              (SPA-GMN-INPUTCD (IDX-A) =   SPACE )) OR
                              (SPA-ERRCD           NOT =   SPACE )
      *
             IF      SPA-GMN-INPUTCD(IDX-A)  NOT =
                                             SPA-MAE-INPUTCD(IDX-A)
      *        ¿ÇÎÅ²Ê
               IF     (SPA-GMN-INPUTCD(IDX-A)(1:1) =   "$" ) AND
                      (SPA-GMN-INPUTCD(IDX-A)(2:2) NUMERIC ) AND
                      (SPA-GMN-INPUTCD(IDX-A)(4:1) =   SPACE)
                   PERFORM 10151-SRYKA-SYORI-SEC
               END-IF
      *        ÊÝ¸±ÁÈ¹ç¤»
               IF     (SPA-GMN-INPUTCD(IDX-A)(1:1) =   "#" ) AND
                      (SPA-GMN-INPUTCD(IDX-A)(2:4) NUMERIC )
                   PERFORM 10152-HKNCOMBI-SYORI-SEC
               END-IF
             END-IF
           END-PERFORM
      *
           .
       1015-FUKU-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    Ê£¿ô²ÊÌÀºÙÄÉ²Ã½èÍý
      *****************************************************************
       10151-SRYKA-SYORI-SEC              SECTION.
      *
      *    ¿ÇÎÅ²Ê
           MOVE    SPA-GMN-INPUTCD(IDX-A)(2:2)
                                       TO  WRK-SRYKA
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX2    FROM    1   BY  1
                   UNTIL      (IDX2    >   SPA-SRYKA-MAX )  OR
                              (FLG-CHK     =    1   ) 
               IF      WRK-SRYKA           =   SPA-GMN-SRYKAL (IDX2)
                   MOVE    IDX2              TO  IDY
                   MOVE    1                 TO  FLG-CHK
               END-IF
           END-PERFORM
           IF       FLG-CHK            =   ZERO
               MOVE    "1053"          TO  SPA-ERRCD
               MOVE    SPACE           TO  SPA-MAE-INPUTCD(IDX-A)
               MOVE    "1"             TO  SPA-COM-CUR    (IDX-A)
           END-IF
      *!!
      *    ¼õ¿ÇÍúÎò¤¬£¹¤Þ¤ÇÅÐÏ¿ºÑ¤ß¤Î»þ¡¢¥¨¥é¡¼
           IF     (SPA-ERRCD           =   SPACE )
               PERFORM 101514-JYURRK-NUM-CHK-SEC
               IF      SPA-ERRCD       NOT =   SPACE
                   MOVE    SPACE           TO  SPA-MAE-INPUTCD(IDX-A)
                   MOVE    "1"             TO  SPA-COM-CUR    (IDX-A)
               END-IF
           END-IF
      *!!
      *
           IF      SPA-ERRCD           =   SPACE
               MOVE    SPA-GMN-INPUTCD(IDX-A)(5:4)
                                           TO  WRK-DRCD2
               INITIALIZE                  SPA-GMN-TBLREC (IDX-A)
               INITIALIZE                  SPA-COM-TBLREC (IDX-A)
               STRING  "$"                 DELIMITED   BY  SIZE
                       WRK-SRYKA           DELIMITED   BY  SIZE
                       " "                 DELIMITED   BY  SIZE
                       WRK-DRCD2           DELIMITED   BY  SPACE
                               INTO    SPA-GMN-INPUTCD (IDX-A)
               END-STRING
      *        ¥É¥¯¥¿¡¼¤ÎÊÔ½¸
               PERFORM 101513-DRCD-SYORI-SEC
           END-IF
      *
           IF      SPA-ERRCD           =   SPACE
               MOVE    SPA-GMN-INPUTCD(IDX-A)
                                           TO  SPA-MAE-INPUTCD(IDX-A)
               MOVE    WRK-SRYKA           TO  SPA-COM-SRYKA   (IDX-A)
               MOVE    WRK-DRCD            TO  SPA-COM-DRCD    (IDX-A)
           END-IF
      *
           IF     (FLG-OK              =   ZERO )  AND
                  (SPA-ERRCD           =   SPACE)  AND
                  (LNK-SC10S-SYORI     =   "A"
                                       OR  "D"   )
      *    ¿Ç»¡ÎÁ¼«Æ°È¯À¸¤¢¤ê¤Î¤ß
           AND    (SPA-INITAUTO-FLG    =   "1"   )
      *        Æ±»þ½é¿ÇÈ½Äê
               PERFORM 101510-DOUJI-CHK-SEC
               IF      FLG-DOUSYOSIN       =   ZERO
                   PERFORM 101511-SRYKA-INS-SEC
               END-IF
           END-IF
      *
           .
       10151-SRYKA-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    ¿ÇÎÅÍúÎòÏ¢ÈÖ¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       101514-JYURRK-NUM-CHK-SEC         SECTION.
      *
           PERFORM VARYING     IDX2    FROM    1  BY  1
                   UNTIL      (IDX2    >   SPA-GMN-MAX1 )
                          OR  (SPA-ERRCD   NOT =   SPACE)
      *        ¿ÇÎÅÆü¤è¤ê¸å¤ÎÍúÎò¤ÏÂÐ¾Ý³°
               IF      (SPA-SRYYMD         =   SPA-NAI-RRKYMD (IDX2) )
                 AND   (WRK-SRYKA          =   SPA-NAI-RRK-SRYKA(IDX2))
                   IF      SPA-NAI-RENNUM (IDX2)   =   9
                       MOVE    "0220"              TO  SPA-ERRCD
                   END-IF
               END-IF
               IF      (SPA-SRYYMD         >   SPA-NAI-RRKYMD (IDX2))
                   MOVE    SPA-GMN-MAX1        TO  IDX2
               END-IF
           END-PERFORM
      *
           .
       101514-JYURRK-NUM-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Æ±»þ½é¿ÇÈ½Äê½èÍý
      *****************************************************************
       101510-DOUJI-CHK-SEC         SECTION.
      *
           MOVE    ZERO                TO  FLG-DOUSYOSIN
           PERFORM VARYING     IDX     FROM    IDX-A   BY  1
                   UNTIL      (IDX         >   SPA-MAX-LINE )  OR
                             ((SPA-COM-INPUTCD (IDX) =   SPACE ) AND
                              (SPA-GMN-INPUTCD (IDX) =   SPACE )) OR
                              (FLG-DOUSYOSIN           =   1   )
               IF     (IDX-A                   NOT =   IDX )  AND
                      (SPA-GMN-INPUTCD(IDX)(1:1)   =   "$" )
                   MOVE    SPA-MAX-LINE                TO  IDX
               ELSE
      *            Æ±Æü½é¿Ç
                   IF      SPA-COM-INPUTCD (IDX)   =   "111011810"
      *TE 
                                                   OR  "101110040"
                       MOVE    1               TO  FLG-DOUSYOSIN
                   END-IF
      *H24.4
      *            ºÆ¿ÇÎÁ£²²ÊÌÜ
                   IF      SPA-COM-INPUTCD (IDX)   =   "112015810"
                                                   OR  "112015950"
                                                   OR  "112016210"
                       MOVE    1               TO  FLG-DOUSYOSIN
                   END-IF
      *H25.4
      *            ½é¿ÇÎÁ¡¦³°Íè¿Ç»¡ÎÁ¡¡£²²ÊÌÜ¡Ê¸ºÅÀµ¬³Ê³ºÅö¡Ë
                   IF      SPA-COM-INPUTCD (IDX)   =   "111012610"
                                                   OR  "112016410"
      *H28.4
                                                   OR  "111012810"
                                                   OR  "112017610"
                       MOVE    1               TO  FLG-DOUSYOSIN
                   END-IF
               END-IF
           END-PERFORM
      *
           .
       101510-DOUJI-CHK-EXT.
           EXIT.
      *****************************************************************
      *    Â¾²Ê¤Ë¤Æ»»ÄêºÑ¤ß½èÍý
      *****************************************************************
       101511-SRYKA-INS-SEC         SECTION.
      *
      *    Â¾²Ê¤Ë¤Æ»»ÄêºÑ¤ß
           MOVE    ZERO                TO  FLG-CHK
           MOVE    ZERO                TO  FLG-SRYKBN
           MOVE    SPACE               TO  WRK-HEN-SRYKA
           MOVE    ZERO                TO  FLG-SYOSIN-ARI
           MOVE    ZERO                TO  FLG-SYOKAINASI
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >=  IDX-A    )  OR
                              (FLG-CHK     =   1   )
               IF     (IDX-A                   NOT =   IDX )  AND
                      (SPA-COM-SRYKA    (IDX)  NOT =   SPACE )  AND
                      (SPA-COM-SRYKA    (IDX)  =   WRK-SRYKA )
                   MOVE    1               TO  FLG-CHK
               END-IF
               IF      SPA-SRYKA           =   WRK-SRYKA
                   MOVE    1               TO  FLG-CHK
               END-IF
               IF     (SPA-COM-SRYKBN  (IDX)   =   "11" ) AND
                     ((SPA-COM-INPUTCD (IDX)(1:1)  =   "1" )  OR
                      (SPA-COM-INPUTCD (IDX)(1:3)  =   "099"))
                   IF      SPA-COM-SRYKA(IDX)  =   SPA-SRYKA
                       MOVE    1               TO  FLG-SRYKBN
                   END-IF
      *            ½é¿ÇÎÁ
                   IF     (SPA-COM-INPUTCD (IDX)(1:1)  =   "1" )
                     AND  (SPA-COM-DATAKBN (IDX)   =   "1"  )
                       MOVE    1               TO  FLG-SYOSIN-ARI
                   END-IF
      *            Æ±Æü½é¿Ç
                   IF      SPA-COM-INPUTCD (IDX)   =   "111011810"
      *TE          Ï«ºÒ
                                                   OR  "101110040"
      *H25.4       ½é¿ÇÎÁ£²²ÊÌÜ¡Ê¸ºÅÀµ¬³Ê³ºÅö¡Ë
                                                   OR  "111012610"
                                                   OR  "111012810"
                       MOVE    1               TO  FLG-DOUSYOSIN
                   END-IF
      *H25.4
      *            ½é¿ÇÎÁ¡Ê¾Ò²ð¤Ê¤·¡Ë¤Î»»Äê
                   IF      SPA-COM-INPUTCD (IDX)   =   "111012510"
                       MOVE    1               TO  FLG-SYOKAINASI
                   END-IF
      *
      *R02.4
      *            ½é¿ÇÎÁ¡Ê¿··¿¥³¥í¥Ê¥¦¥¤¥ë¥¹´¶À÷¾É¡¦Î×»þ¡Ë
                   IF      SPA-COM-INPUTCD (IDX)   =   "111013850"
      *                Æ±°ìÆü£²²ÊÌÜ¤Î¼«Æ°»»Äê¤Ê¤·
                       MOVE    1               TO  FLG-DOUSYOSIN
                   END-IF
      *
               END-IF
               IF     (SPA-COM-SRYKBN  (IDX)   =   "12" ) AND
                     ((SPA-COM-INPUTCD (IDX)(1:1)  =   "1" )  OR
                      (SPA-COM-INPUTCD (IDX)(1:3)  =   "099"))
                   MOVE    2               TO  FLG-SRYKBN
               END-IF
      *
               IF     (SPA-COM-SRYKA   (IDX)   =   SPA-SRYKA ) AND
                      (SPA-COM-SRYKBN  (IDX)   =   "11"      ) AND
                      (SPA-COM-INPUTCD (IDX)   =   "830000020")
                   MOVE    1                   TO  FLG-SRYKBN
                   MOVE    SPA-COM-ATAI1(IDX)  TO  WRK-HEN-SRYKA
               END-IF
               IF     (SPA-COM-SRYKA   (IDX)   =   SPA-SRYKA ) AND
                      (SPA-COM-SRYKBN  (IDX)   =   "12"      ) AND
                      (SPA-COM-INPUTCD (IDX)   =   "830000021")
                   MOVE    2                   TO  FLG-SRYKBN
                   MOVE    SPA-COM-ATAI1(IDX)  TO  WRK-HEN-SRYKA
               END-IF
           END-PERFORM
      *
           IF      FLG-CHK             =   ZERO
               PERFORM 101513-HKNCOMBI-GYOU-SEC
           END-IF
           IF     (FLG-CHK             =   ZERO )  AND
                  (FLG-SRYKBN      NOT =   ZERO )  AND
                  (IDX-A               <   199  )
            AND   (FLG-HKN-ARI     NOT =   9    )
               IF      FLG-HKN-ARI         =   1
                   MOVE    IDX-A           TO  IDX-A-HZN
                   ADD     1               TO  IDX-A
               END-IF
               PERFORM 1015112-TAKA-HEN-SEC
           END-IF
      *    ÊÝ¸±ÁÈ¹ç¤»
           IF      FLG-HKN-ARI         =   1
               MOVE    IDX-A-HZN           TO  IDX-A
               ADD     1                   TO  IDX-A
               IF      SPA-GMN-INPUTCD(IDX-A)(1:1)     =   "#"
                   PERFORM 10152-HKNCOMBI-SYORI-SEC
               END-IF
           END-IF
      *
           .
       101511-SRYKA-INS-EXT.
           EXIT.
      *****************************************************************
      *    ¥É¥¯¥¿¡¼Ì¾¼èÆÀ½èÍý
      *****************************************************************
       101513-DRCD-SYORI-SEC         SECTION.
      *
      *    ¥É¥¯¥¿¡¼¤ÎÍ­Ìµ
           IF      WRK-DRCD2           =   SPACE
      *DDD                             OR  ZERO
               MOVE    SPACE               TO  WRK-DRCD-MEI
           ELSE
               MOVE    "1"                 TO  WRK-DRCD1
               MOVE    SPACE               TO  WRK-DRCD-MEI
               PERFORM 1015131-DRCDMEI-HEN-SEC
               IF      WRK-DRCD-MEI       =   SPACE
                   IF      SPA-ERRCD      =   SPACE
                       MOVE    "1054"          TO  SPA-ERRCD
                   END-IF
                   MOVE    SPACE           TO  SPA-MAE-INPUTCD(IDX-A)
                   MOVE    "1"             TO  SPA-COM-CUR    (IDX-A)
               END-IF
           END-IF
           IF      SPA-ERRCD           =   SPACE
             IF      WRK-DRCD-MEI        =   SPACE
               STRING  "¡ã¡ã"              DELIMITED  BY  SIZE
                       SPA-GMN-SRYKAMEIL(IDY)
                                           DELIMITED  BY  SPACE
                        "¡ä¡ä"             DELIMITED  BY  SIZE
                   INTO                SPA-GMN-MEISYO-G (IDX-A)
               END-STRING
             ELSE
               STRING  "¡ã¡ã"              DELIMITED  BY  SIZE
                       SPA-GMN-SRYKAMEIL(IDY)
                                           DELIMITED  BY  SPACE
                       "¡¡¥É¥¯¥¿¡¼¡§"      DELIMITED  BY  SIZE
                       WRK-DRCD-MEI        DELIMITED  BY  SPACE
                        "¡ä¡ä"             DELIMITED  BY  SIZE
                   INTO                SPA-GMN-MEISYO-G (IDX-A)
               END-STRING
             END-IF
           END-IF
      *
           .
       101513-DRCD-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    ¥É¥¯¥¿¡¼Ì¾¼èÆÀ½èÍý
      *****************************************************************
       1015131-DRCDMEI-HEN-SEC         SECTION.
      *
           INITIALIZE                  SYS-1010-REC
           MOVE    "1010"              TO  SYS-1010-KANRICD
           MOVE    WRK-DRCD            TO  SYS-1010-KBNCD
           MOVE    SPA-SRYYMD          TO  SYS-1010-STYUKYMD
           MOVE    SPA-SRYYMD          TO  SYS-1010-EDYUKYMD
      *    ¥·¥¹¥Æ¥à´ÉÍý¸¡º÷
           MOVE    SPA-HOSPNUM         TO  SYS-1010-HOSPNUM
           MOVE    SYS-1010-REC        TO  MCPDATA-REC
           PERFORM 960-SYSKANRI-READ-SEC
      *
           IF      FLG-SYSKANRI        =   ZERO
               MOVE    MCPDATA-REC         TO  SYS-1010-REC
               IF      SYS-1010-KBNCD      =   WRK-DRCD
                   MOVE    SYS-1010-NAME       TO  WRK-DRCD-MEI
               END-IF
           END-IF
      *
           .
       1015131-DRCDMEI-HEN-EXT.
           EXIT.
      *****************************************************************
      *    Â¾²Ê¤Ë¤Æ¼õ¿ÇºÑ¤ß¼«Æ°ÊÔ½¸½èÍý
      *****************************************************************
       1015112-TAKA-HEN-SEC         SECTION.
      *
           MOVE    SPACE               TO  WRK-SRYCD
           IF     (FLG-SRYKBN          =   1 )  AND
                  (FLG-SYOSIN-ARI      =   1 )  AND
                  (FLG-DOUSYOSIN       =   ZERO )
      *        Æ±Æü½é¿ÇÈ½Äê
               PERFORM 10151121-DOJITU-HEN-SEC
               IF      WRK-SRYCD       NOT =   SPACE
                   GO      TO      1015112-TAKA-HEN-EXT
               END-IF
           END-IF
      *
           IF      FLG-SRYKBN          =   1
               MOVE    ".110"              TO  WRK-SRYCD
           ELSE
               MOVE    ".120"              TO  WRK-SRYCD
           END-IF
           IF      IDX-KA              =   ZERO
               ADD     1               TO  IDX-A
               PERFORM 1015119-GYOINSN-SEC
           ELSE
               COMPUTE IDX-A           =   IDX-KA   -  1
           END-IF
           IF      SPA-ERRCD           =   SPACE
               INITIALIZE                  SPA-GMN-TBLREC  (IDX-A)
               INITIALIZE                  SPA-COM-TBLREC  (IDX-A)
               MOVE    WRK-SRYCD       TO  SPA-GMN-INPUTCD (IDX-A)
               MOVE    WRK-SRYCD       TO  SPA-MAE-INPUTCD (IDX-A)
               MOVE    WRK-SRYKA       TO  SPA-COM-SRYKA   (IDX-A)
               MOVE    1               TO  FLG-FUKU
           END-IF
      *
           IF      FLG-SRYKBN          =   1
               MOVE    "830000020"         TO  WRK-SRYCD
           ELSE
               MOVE    "830000021"         TO  WRK-SRYCD
           END-IF
           IF      IDX-A               <   SPA-MAX-LINE
               IF      SPA-COM-INPUTCD(IDX-A + 1)
                                           =   "830000020"  OR
                                               "830000021"
                   ADD     1               TO  IDX-A
               ELSE
                   ADD     1               TO  IDX-A
                   PERFORM 1015119-GYOINSN-SEC
               END-IF
           ELSE
               MOVE    "0007"              TO  SPA-ERRCD
           END-IF
           IF      WRK-HEN-SRYKA       =   SPACE
               MOVE    SPA-SRYKA       TO  WRK-HEN-SRYKA
           END-IF
           IF      SPA-ERRCD       =   SPACE
               INITIALIZE                  SPA-GMN-TBLREC  (IDX-A)
               INITIALIZE                  SPA-COM-TBLREC  (IDX-A)
               MOVE    WRK-SRYCD       TO  SPA-GMN-INPUTCD (IDX-A)
               MOVE    WRK-HEN-SRYKA   TO  SPA-GMN-INPUTCD (IDX-A)
                                                           (11:2)
               MOVE    WRK-SRYCD       TO  SPA-COM-INPUTCD (IDX-A)
               MOVE    WRK-HEN-SRYKA   TO  SPA-COM-ATAI1   (IDX-A)
               PERFORM 10151121-INPUCD-HENSYU-SEC
               MOVE    WRK-SRYKA       TO  SPA-COM-SRYKA   (IDX-A)
           END-IF
           IF      SPA-ERRCD       =   SPACE
      *        ÆÃÄê¼À´µÎÅÍÜ»ØÆ³ÎÁ¤ÎÈ¯À¸
               PERFORM 10151122-TOKUTEI-HENSYU-SEC
           END-IF
           .
       1015112-TAKA-HEN-EXT.
           EXIT.
      *****************************************************************
      *    Æ±Æü½é¿ÇÊÔ½¸½èÍý
      *****************************************************************
       10151121-DOJITU-HEN-SEC       SECTION.
      *
           IF      SPA-HKNKBN          =   1
      *        Ï«ºÒ¡¦¼«ÇåÀÕ
               IF      (SPA-RSI-JUNKYO     =   "1" )
      *            ·òÊÝ½àµò
                   MOVE   "111011810"          TO  WRK-SRYCD
      *H25.4
      *            ¾Ò²ð¤Ê¤·
                   IF     FLG-SYOKAINASI       =   1
                       MOVE   "111012610"          TO  WRK-SRYCD
                   END-IF
      *H26.12
      *            ÂÅ·ëÎ¨£µ³ä°Ê²¼
                   IF      SPA-DAKT50-KBN      =   1
                       MOVE   "111012610"          TO  WRK-SRYCD
                   END-IF
               ELSE
      *            Ï«ºÒ
                   MOVE   "101110040"          TO  WRK-SRYCD
               END-IF
           ELSE
               MOVE   "111011810"          TO  WRK-SRYCD
      *H25.4
      *        ¾Ò²ð¤Ê¤·
               IF     FLG-SYOKAINASI       =   1
                   MOVE   "111012610"          TO  WRK-SRYCD
               END-IF
      *H26.12
      *        ÂÅ·ëÎ¨£µ³ä°Ê²¼
               IF      SPA-DAKT50-KBN      =   1
                   MOVE   "111012810"          TO  WRK-SRYCD
               END-IF
      *
           END-IF
           IF      IDX-A               <   SPA-MAX-LINE
               IF      SPA-COM-INPUTCD(IDX-A + 1)
                                           =   WRK-SRYCD
                   ADD     1               TO  IDX-A
               ELSE
                   ADD     1               TO  IDX-A
                   PERFORM 1015119-GYOINSN-SEC
               END-IF
           ELSE
               MOVE    "0007"              TO  SPA-ERRCD
           END-IF
           IF      SPA-ERRCD           =   SPACE
               INITIALIZE                  SPA-GMN-TBLREC  (IDX-A)
               INITIALIZE                  SPA-COM-TBLREC  (IDX-A)
               MOVE    WRK-SRYCD       TO  SPA-GMN-INPUTCD (IDX-A)
               MOVE    WRK-SRYCD       TO  SPA-COM-INPUTCD (IDX-A)
               MOVE    "11"            TO  SPA-COM-SRYKBN  (IDX-A)
               PERFORM 10151121-INPUCD-HENSYU-SEC
               MOVE    WRK-SRYKA       TO  SPA-COM-SRYKA   (IDX-A)
               MOVE    1               TO  FLG-DOUSYOSIN
           END-IF
           IF      SPA-ERRCD       =   SPACE
      *        ÆÃÄê¼À´µÎÅÍÜ»ØÆ³ÎÁ¤ÎÈ¯À¸
               PERFORM 10151122-TOKUTEI-HENSYU-SEC
           ELSE
               IF      SPA-ERRCD       NOT =   SPACE
                   COMPUTE IDX-A           =   IDX-KA   -  1
                   MOVE    SPACE           TO  WRK-SRYCD
               END-IF
           END-IF
           .
       10151121-DOJITU-HEN-EXT.
           EXIT.
      *****************************************************************
      *    Ê£¿ôÊÝ¸±¥³¥á¥ó¥ÈÊÔ½¸½èÍý
      *****************************************************************
       10151121-INPUCD-HENSYU-SEC       SECTION.
      *
      *    ÅÀ¿ô¥Þ¥¹¥¿ÊÔ½¸¡¦´ðËÜ¥Á¥§¥Ã¥¯
           INITIALIZE                  ORCSC92AREA
           MOVE    "2"                 TO  LNK-SC92-KBN
           MOVE    SPA-SYORIFLG        TO  LNK-SC92-SYORIFLG
           MOVE    "K02"               TO  LNK-SC92-PG
           MOVE    IDX-A               TO  LNK-SC92-GMN-IDX
           MOVE    WRK-SRYCD           TO  LNK-SC92-SRYCD
           MOVE    SPA-NENREI          TO  LNK-SC92-NENREI
           MOVE    SPA-15MIMAN-ARI     TO  LNK-SC92-15MIMAN-ARI
           MOVE    SPA-NAI-ROUJIN      TO  LNK-SC92-ROUJIN
           MOVE    SPA-LSTSRYKA        TO  LNK-SC92-LSTSRYKA
           MOVE    SPA-LSTSRYKAMEI     TO  LNK-SC92-LSTSRYKAMEI
           MOVE    SPA-K02-TEISEI-AREA TO  LNK-SC92-TEISEI-AREA
           CALL    "ORCSC92"           USING
                                       MCPAREA
                                       ORCSC92AREA
                                       SPA-SCR-REC
                                       SPA-AREA
           .
       10151121-INPUCD-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÆÃÄê¼À´µÎÅÍÜ»ØÆ³ÎÁ¤ÎÈ¯À¸½èÍý
      *****************************************************************
       10151122-TOKUTEI-HENSYU-SEC       SECTION.
      *
           IF      IDX-HKN         >   IDX-A
               MOVE    IDX-HKN         TO  SPA-GMN-IDX
           ELSE
               MOVE    IDX-A           TO  SPA-GMN-IDX
           END-IF
      *    »ØÆ³ÎÁ¤Î¼«Æ°È¯À¸
           PERFORM 33012-SIDOU-SYORI-SEC
      *    ÆÃÄê¼À´µ²Ê
      *    MOVE    ZERO                TO  FLG-TOKUTEI
      *    PERFORM VARYING     IDX     FROM    1   BY  1
      *            UNTIL      (IDX         >   10  )  OR
      *                       (SPA-TOKU-SRYKA(IDX) =   SPACE ) OR
      *                       (FLG-TOKUTEI     NOT =   ZERO )
      *        IF      SPA-TOKU-SRYKA (IDX)    =   WRK-SRYKA
      *            MOVE    SPA-TOKU-FLG (IDX)  TO  FLG-TOKUTEI
      *        END-IF
      *    END-PERFORM
      *    ÆÃÄêËýÀ­¼À´µ»ØÆ³ÎÁ
      *    IF      FLG-TOKUTEI         =   05
      *                                OR  08
      *        IF      IDX-HKN         >   IDX-A
      *            MOVE    IDX-HKN         TO  SPA-GMN-IDX
      *        ELSE
      *            MOVE    IDX-A           TO  SPA-GMN-IDX
      *        END-IF
      *        PERFORM 330121-TOKUTEI-SIDOU-SEC
      *    END-IF
      *
      *    ÈéÉæ²ÊÆÃÄê¼À´µ
      *    IF      FLG-TOKUTEI         =   03  OR  04
      *        IF      IDX-HKN         >   IDX-A
      *            MOVE    IDX-HKN         TO  SPA-GMN-IDX
      *        ELSE
      *            MOVE    IDX-A           TO  SPA-GMN-IDX
      *        END-IF
      *        PERFORM 330122-HIFUKA-SIDOU-SEC
      *    END-IF
      *
           .
       10151122-TOKUTEI-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    Ê£¿ôÊÝ¸±¥³¥á¥ó¥ÈÊÔ½¸½èÍý
      *****************************************************************
       101513-HKNCOMBI-GYOU-SEC       SECTION.
      *
           MOVE    ZERO                TO  IDX-HKN
           MOVE    ZERO                TO  IDX-KA
           MOVE    ZERO                TO  FLG-CHK3
           MOVE    ZERO                TO  FLG-HKN-ARI
           MOVE    ZERO                TO  FLG-KA-ARI
           COMPUTE IDX4                =   IDX-A   +  1
           PERFORM VARYING     IDX     FROM    IDX4    BY  1
                   UNTIL     ( IDX         >   SPA-MAX-LINE     )  OR
                             ((SPA-GMN-INPUTCD(IDX)    =   SPACE ) AND
                              (SPA-COM-INPUTCD(IDX)    =   SPACE )) OR
                             ( FLG-CHK3    =   1       )
               IF      SPA-COM-INPUTCD (IDX)  =   "099409901"
                                              OR  "099999902"
                   MOVE    IDX                TO  IDX-HKN
               END-IF
               IF      SPA-COM-INPUTCD (IDX)  =   "830000020"
                                              OR  "830000021"
                   MOVE    IDX                TO  IDX-KA
               END-IF
               IF     (SPA-COM-INPUTCD (IDX)  =   "099409901"
                                              OR  "099999902"
                                              OR  "830000020"
                                              OR  "830000021") OR
                      (SPA-GMN-INPUTCD (IDX)(1:1)  =   "." 
                                              OR  "#" 
                                              OR  "$"   )
                   CONTINUE
               ELSE
                   MOVE    1               TO  FLG-CHK3
               END-IF
               IF      SPA-GMN-INPUTCD (IDX)(1:1)  =   "#"
                   MOVE    1               TO  FLG-HKN-ARI
      *
                   IF     (SPA-GMN-INPUTCD (IDX)(2:4)  =   "9999")
                       MOVE    9               TO  FLG-HKN-ARI
                   END-IF
               END-IF
               IF      SPA-GMN-INPUTCD (IDX)(1:1)  =   "$"
                   MOVE    1               TO  FLG-KA-ARI
               END-IF
           END-PERFORM
           .
       101513-HKNCOMBI-GYOU-EXT.
           EXIT.
      *****************************************************************
      *    Ê£¿ôÊÝ¸±ÌÀºÙÄÉ²Ã½èÍý
      *****************************************************************
       10152-HKNCOMBI-SYORI-SEC              SECTION.
      *
           MOVE    SPA-GMN-INPUTCD(IDX-A)(2:4)
                                       TO  WRK-HKNCOMBI
      *
           MOVE    ZERO                TO  FLG-CHK
           MOVE    SPACE               TO  WRK-SEL-HKNNUM
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >   SPA-HKN-MAX )  OR
                              (FLG-CHK     =    1   ) 
               IF      WRK-HKNCOMBI        =   SPA-GMN-THKNCOMBINUM
                                                             (IDX)
                   MOVE    SPA-NAI-HKNNUM (IDX)  TO  WRK-SEL-HKNNUM
                   MOVE    IDX               TO  IDY
                   MOVE    1                 TO  FLG-CHK
               END-IF
           END-PERFORM
      *
           IF       FLG-CHK            =   ZERO
               MOVE    "1051"          TO  SPA-ERRCD
               MOVE    SPACE           TO  SPA-MAE-INPUTCD(IDX-A)
               MOVE    "1"             TO  SPA-COM-CUR (IDX-A)
           ELSE
      *        ÊÝ¸±Ì¾¾Î¤òÌ¾¾Î¤Ø
               STRING  "¡Ô"                DELIMITED  BY  SIZE
                   SPA-GMN-THKNCOMBIMEI(IDY)
                                       DELIMITED  BY  "  "
                   "¡Õ"                DELIMITED  BY  SIZE
                   INTO                SPA-GMN-MEISYO-G (IDX-A)
               END-STRING
               MOVE    SPA-GMN-INPUTCD(IDX-A)
                                       TO  SPA-MAE-INPUTCD(IDX-A)
           END-IF
      *    Ï«ºÒ¡¦¸ø³²¤Ï¥¨¥é¡¼
           IF     (SPA-ERRCD           =   SPACE  )  AND
                 ((SPA-NAI-RSI-HKNKBN (IDY)   NOT =  SPACE)
              OR  (SPA-NAI-HKNNUM (IDY)    =   "975"  ))
               MOVE    "1050"          TO  SPA-ERRCD
               MOVE    SPACE           TO  SPA-MAE-INPUTCD(IDX-A)
               MOVE    "1"             TO  SPA-COM-CUR    (IDX-A)
           END-IF
      *
      *    Ï·¿Í¡¦°ìÈÌÈ½Äê
      *    £¶£µºÐ°Ê¾å¤ÇÏ·¿Í¸øÈñ¤Î¤¢¤ë¾ì¹ç¡¢
           IF     (SPA-ERRCD           =   SPACE  )  AND
                  (SPA-NAI-ROUJIN2     =   1      )
             AND  (WRK-HKNCOMBI    NOT =   "9999" )
               INITIALIZE                  ORCSAGECHKAREA
               MOVE    SPA-HOSPNUM         TO  AGECHK-HOSPNUM
               MOVE    SPA-PTID            TO  AGECHK-PTID
               MOVE    SPA-SRYYMD          TO  AGECHK-SRYYMD
               MOVE    SPA-BIRTHDAY        TO  AGECHK-BIRTHDAY
               MOVE    SPA-NYUGAIKBN       TO  AGECHK-NYUGAIKBN
               MOVE    WRK-HKNCOMBI        TO  AGECHK-HKNCOMBINUM
               CALL    "ORCSAGECHK"        USING
                                           ORCSAGECHKAREA
                                           SPA-AREA
               IF      SPA-NAI-ROUJIN  NOT =   AGECHK-ROUJIN
                   MOVE    "1052"          TO  SPA-ERRCD
                   MOVE    SPACE           TO  SPA-MAE-INPUTCD
                                                          (IDX-A)
                   MOVE    "1"             TO  SPA-COM-CUR(IDX-A)
               END-IF
           END-IF
           IF      SPA-ERRCD           =   SPACE
               MOVE    WRK-HKNCOMBI        TO  SPA-COM-HKNCOMBI(IDX-A)
      *        ¼£¸³
               MOVE    SPA-NAI-CHIKENKBN (IDY)
                                           TO  SPA-COM-CHIKENKBN(IDX-A)
           END-IF
      *
           IF     (FLG-OK              =   ZERO )  AND
                  (SPA-ERRCD           =   SPACE)  AND
                  (LNK-SC10S-SYORI     =   "A"
                                       OR  "D"   )
              AND (WRK-HKNCOMBI    NOT =   "9999" )
      *    ¿Ç»¡ÎÁ¼«Æ°È¯À¸¤¢¤ê¤Î¤ß
           AND    (SPA-INITAUTO-FLG    =   "1"   )
      *    ¼£¸³ÂÐ¾Ý³°
           AND    (SPA-NAI-CHIKENKBN (IDY) NOT =   "1" )
               PERFORM 101521-HKNCOMBI-HEN-SEC
           END-IF
      *
           .
       10152-HKNCOMBI-SYORI-EXT.
           EXIT.
      *****************************************************************
      *    Ê£¿ôÊÝ¸±¥³¥á¥ó¥ÈÄÉ²ÃÊÔ½¸½èÍý
      *****************************************************************
       101521-HKNCOMBI-HEN-SEC       SECTION.
      *
      *    Â¾ÊÝ¸±¤Ë¤Æ»»ÄêºÑ¤ß
           MOVE    ZERO                TO  FLG-CHK
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL      (IDX     >=  IDX-A   )  OR
                              (FLG-CHK     =    1  ) 
               IF     (IDX-A                   NOT =   IDX )  AND
                      (SPA-COM-HKNCOMBI (IDX)  NOT =   SPACE )  AND
                      (SPA-COM-HKNCOMBI (IDX)  =   WRK-HKNCOMBI )
                   MOVE    1               TO  FLG-CHK
               END-IF
               IF      SPA-HKNCOMBINUM     =   WRK-HKNCOMBI
                   MOVE    1               TO  FLG-CHK
               END-IF
           END-PERFORM
           MOVE    ZERO                TO  IDX-HKN
           IF      FLG-CHK             =   ZERO
               PERFORM 101513-HKNCOMBI-GYOU-SEC
           END-IF
           IF     (FLG-CHK             =   ZERO )  AND
                  (IDX-HKN             =   ZERO )
               IF      IDX-KA          NOT =   ZERO
                   MOVE    IDX-KA          TO  IDX-A
               END-IF
               IF      WRK-SEL-HKNNUM      =   SPA-HKNNUM
                   MOVE    "099409901"     TO  WRK-SRYCD
               ELSE
                   MOVE    "099999902"     TO  WRK-SRYCD
               END-IF
               IF      IDX-A           <   SPA-MAX-LINE
                   ADD     1               TO  IDX-A
                   PERFORM 1015119-GYOINSN-SEC
                   IF      SPA-ERRCD       =   SPACE
                       INITIALIZE                  SPA-GMN-TBLREC
                                                        (IDX-A)
                       INITIALIZE                  SPA-COM-TBLREC
                                                        (IDX-A)
                       MOVE    WRK-SRYCD       TO  SPA-GMN-INPUTCD
                                                       (IDX-A)
                       MOVE    WRK-SRYCD       TO  SPA-COM-INPUTCD
                                                       (IDX-A)
                       PERFORM 10151121-INPUCD-HENSYU-SEC
                       MOVE    WRK-HKNCOMBI    TO  SPA-COM-HKNCOMBI
                                                       (IDX-A)
                   END-IF
               END-IF
           END-IF
      *
           .
       101521-HKNCOMBI-HEN-EXT.
           EXIT.
      *****************************************************************
      *    ¹ÔÁÞÆþ½èÍý
      *****************************************************************
       1015119-GYOINSN-SEC              SECTION.
      *
           IF      IDX-A               >=  SPA-MAX-LINE
               MOVE    "0007"              TO  SPA-ERRCD
               GO      TO      1015119-GYOINSN-EXT
           END-IF
      *
           MOVE    SPA-SCR-REC         TO  HZN-SCR-REC
           INITIALIZE                      SPA-GMN-REC
           MOVE    ZERO                TO  IDX2
           PERFORM VARYING     IDX     FROM    1   BY  1
                   UNTIL       IDX     >   SPA-MAX-LINE
               IF      IDX             =   IDX-A
                   CONTINUE
               ELSE
                   ADD     1               TO  IDX2
                   MOVE    HZN-COM-TBLREC (IDX2) 
                                           TO  SPA-COM-TBLREC(IDX)
                   MOVE    HZN-GMN-TBLREC (IDX2) 
                                           TO  SPA-GMN-TBLREC(IDX)
               END-IF
               IF     (SPA-GMN-INPUTCD (IDX)   NOT =   SPACE ) OR
                      (SPA-COM-INPUTCD (IDX)   NOT =   SPACE )
                   MOVE    IDX                 TO  SPA-GMN-MAX
               END-IF
           END-PERFORM
      *
           .
       1015119-GYOINSN-EXT.
           EXIT.
      *
      *H27.07
      *****************************************************************
      *    API¡¡ºÆ¿Ç¤Î¼«Æ°È¯À¸½èÍý
      *****************************************************************
       1019-API-SYORI-SEC              SECTION.
      *
           PERFORM 100-SANTEI-CHK-SEC
      *
      *    Æ±ÆüºÆ¿ÇÎÁ»»Äê
           MOVE    ZERO                TO  FLG-DOUJITU
           IF     ( SPA-SYORIFLG        =   ZERO     ) AND
                  ( SPA-RRK-LSTYMD      =   SPA-SRYYMD )
               IF      SPA-DOUJITU     NOT =   ZERO
                   MOVE    1                   TO  FLG-DOUJITU
               END-IF
           END-IF
      *
      *    ¾®»ù²Ê³°Íè¿Ç»¡ÎÁ¡¦¾®»ù¤«¤«¤ê¤Ä¤±¤ÎÆ±Æü¤¢¤ê
           IF      SPA-SYONIKA-ARI2    =   1
               OR  SPA-SYONIKKR-ARI2   =   1
               GO      TO      1019-API-SYORI-EXT
           END-IF
      *
      *
           IF      SPA-TELSAI-ARI      =   1
      *        Ìë´ÖÁáÄ«²Ã»»¤Î£¶ºÐÌ¤ËþÂÐ±þ
               MOVE    SPA-GAI-JIKANKBN    TO  WRK-HZN-JIKANKBN
               IF      SPA-GAI-JIKANKBN    =   8
      *            £¶ºÐÌ¤Ëþ¤Ï¾®»ù²ÊÆÃÎãÌë´Ö¤Ø
                   IF     (SPA-NENREI-YY       <   6  )
                      AND (SPA-JIKANTOKU-NYU   =   1
                                               OR  2  )
                       MOVE    5               TO  SPA-GAI-JIKANKBN
                   END-IF
      *H30.4
      *            Ç¥ÉØ¤Ï¾®»ù²ÊÆÃÎãÌë´Ö¤Ø
                   IF     (SPA-NENREI-YY       >=  6  )
                      AND (SPA-JIKANTOKU-NYU   =   1
                                               OR  3  )
                      AND (SPA-NINPUKBN-ARI    =   1  )
                       MOVE    5               TO  SPA-GAI-JIKANKBN
                   END-IF
               END-IF
      *
               IF      FLG-DOUJITU         =   1
      *            Æ±ÆüÅÅÏÃºÆ¿Ç¤ò»»Äê
                   MOVE    "12"                TO  WRK-SRYKBN
                   MOVE    "S"                 TO  WRK-KBN
               ELSE
      *            ÅÅÏÃºÆ¿Ç¤ò»»Äê
                   MOVE    "12"                TO  WRK-SRYKBN
                   MOVE    "T"                 TO  WRK-KBN
               END-IF
      *
               IF     (SPA-HKNKBN          =   1   )
      *           ·òÊÝ½àµò°Ê³°
                 AND  (SPA-RSI-JUNKYO  NOT =   "1"  )
      *            Ï«ºÒ¤Î¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
                   PERFORM 20091-RSI-SINSATU-SEC
               ELSE
      *            ·òÊÝ¤Î¿Ç»¡¥³¡¼¥É¤ò¥Æ¡¼¥Ö¥ë¤è¤ê·èÄê
                   PERFORM 2001-SRYCD-TBL-SEC
      *!!Ï«ºÒ¤â¥À¥ß¡¼¤Ë¤¹¤ë¤Ê¤é¡¢Ï«ºÒ¤âÄÉ²Ã  !!
      *            ÃÏ°èÊñ³ç¿ÇÎÅÎÁ»»Äê»þ
                   IF      (SPA-CHKHKT-ARI2     =   1      )
      *H28.4           Ç§ÃÎ¾ÉÃÏ°èÊñ³ç
                      OR   (SPA-NNCHKT-ARI2     =   1      )
                       MOVE    "099120001"         TO  WRK-SRYCD
                   END-IF
               END-IF
      *        ¿Ç»¡ÎÁ¼«Æ°ÄÉ²Ã½èÍý
               PERFORM 3301-SYOSIN-HEN-SEC
      *        ³°Íè»þ´Ö³°¶èÊ¬ÀßÄê¤òÌá¤¹
               MOVE    WRK-HZN-JIKANKBN    TO  SPA-GAI-JIKANKBN
           END-IF
      *
           .
       1019-API-SYORI-EXT.
           EXIT.
      *H27.07
      *
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       910-TENSU-READ-SEC              SECTION.
      *
      *    »»ÄêÍúÎò¤Ë´Ø¤¹¤ë¹àÌÜ¤Î¤ß
           MOVE    SPA-SRYYMD          TO  TNS-YUKOSTYMD
           MOVE    SPA-SRYYMD          TO  TNS-YUKOEDYMD
      *
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key22"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key22"             TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  TNS-TENSU-REC
                   MOVE    ZERO                TO  FLG-TENSU
               ELSE
                   INITIALIZE                  TNS-TENSU-REC
                   MOVE    1                   TO  FLG-TENSU
               END-IF
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1                   TO  FLG-TENSU
           END-IF
      *
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key22"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       910-TENSU-READ-EXT.
           EXIT.
      *****************************************************************
      *    ÅÀ¿ô¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       9101-TENSU-READ2-SEC              SECTION.
      *
           MOVE    SPA-SRYYMD          TO  TNS-YUKOSTYMD
           MOVE    SPA-SRYYMD          TO  TNS-YUKOEDYMD
      *
           MOVE    SPA-HOSPNUM         TO  TNS-HOSPNUM
           MOVE    TNS-TENSU-REC       TO  MCPDATA-REC
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_tensu"         TO  MCP-TABLE
               MOVE    "key"               TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    MCPDATA-REC         TO  TNS-TENSU-REC
                   MOVE    ZERO                TO  FLG-TENSU
               ELSE
                   INITIALIZE                  TNS-TENSU-REC
                   MOVE    1                   TO  FLG-TENSU
               END-IF
           ELSE
               INITIALIZE                  TNS-TENSU-REC
               MOVE    1                   TO  FLG-TENSU
           END-IF
      *
           MOVE    "tbl_tensu"         TO  MCP-TABLE
           MOVE    "key"               TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       9101-TENSU-READ2-EXT.
           EXIT.
      *
      *****************************************************************
      *    »»ÄêÎò¥Þ¥¹¥¿ÆÉ¤ß¹þ¤ß
      *****************************************************************
       920-SANTEI-READ-SEC         SECTION.
      *
           MOVE    "tbl_santei"        TO  MCP-TABLE
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  SANTEI-REC
               MOVE    ZERO                TO  FLG-SANTEI
           ELSE
               INITIALIZE                      SANTEI-REC
               MOVE    1                   TO  FLG-SANTEI
           END-IF
      *
           .
       920-SANTEI-READ-EXT.
           EXIT.
      ******************************************************************
      *    ¼õ¿ÇÍúÎò¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       970-JYURRK-READ-SEC         SECTION.
      *
           MOVE    "tbl_jyurrk"        TO  MCP-TABLE
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  JYURRK-REC
               MOVE    ZERO            TO  FLG-JYURRK
           ELSE
               INITIALIZE                  JYURRK-REC
               MOVE    1               TO  FLG-JYURRK
           END-IF
      *
           .
       970-JYURRK-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¹Ô°Ù¥Þ¥¹¥¿¡¼ÆÉ¹þ
      *****************************************************************
       930-SRYACT-READ-SEC         SECTION.
      *
           MOVE    "tbl_sryact"        TO  MCP-TABLE
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC     TO  SRYACT-REC
               MOVE    ZERO            TO  FLG-SRYACT
           ELSE
               INITIALIZE                  SRYACT-REC
               MOVE    1               TO  FLG-SRYACT
           END-IF
      *
           .
       930-SRYACT-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥·¥¹¥Æ¥à´ÉÍýÆÉ¹þ
      *****************************************************************
       960-SYSKANRI-READ-SEC         SECTION.
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 910-DBSELECT-SEC
           IF      MCP-RC              =   ZERO
               MOVE    "tbl_syskanri"      TO  MCP-TABLE
               MOVE    "key10"             TO  MCP-PATHNAME
               PERFORM 920-DBFETCH-SEC
               IF      MCP-RC              =   ZERO
                   MOVE    ZERO            TO  FLG-SYSKANRI
               ELSE
                   MOVE    1               TO  FLG-SYSKANRI
               END-IF
           ELSE
               MOVE    1               TO  FLG-SYSKANRI
           END-IF
      *
           MOVE    "tbl_syskanri"      TO  MCP-TABLE
           MOVE    "key10"             TO  MCP-PATHNAME
           PERFORM 990-DBCLOSE-SEC
      *
           .
       960-SYSKANRI-READ-EXT.
           EXIT.
      *****************************************************************
      *    »»ÄêÎòÉÕ²Ã¥Þ¥¹¥¿ÆÉ¤ß¹þ¤ß
      *****************************************************************
       921-SANTEIPLUS-READ-SEC         SECTION.
      *
           PERFORM 920-DBFETCH-SEC
           IF      MCP-RC              =   ZERO
               MOVE    MCPDATA-REC         TO  SANTEIPLUS-REC
               MOVE    ZERO                TO  FLG-SANTEIPLUS
           ELSE
               INITIALIZE                      SANTEIPLUS-REC
               MOVE    1                   TO  FLG-SANTEIPLUS
           END-IF
      *
           .
       921-SANTEIPLUS-READ-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Ñ¥é¥á¥¿¥Ç¡¼¥¿½çÆÉ¤ß
      *****************************************************************
      *980-PARA-READ-SEC         SECTION.
      *
      *    READ    PARA-FILE 
      *        AT  END
      *            MOVE    1           TO  FLG-PARA
      *        NOT AT  END
      *            MOVE    ZERO        TO  FLG-PARA
      *    END-READ
      *
      *    .
      *980-PARA-READ-EXT.
      *    EXIT.
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¸¡º÷½èÍý
      *****************************************************************
       910-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"      TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       910-DBSELECT-EXT.
           EXIT.
      *****************************************************************
      *    £Ä£ÂÆÉ¤ß¹þ¤ß½èÍý
      *****************************************************************
       920-DBFETCH-SEC                 SECTION.
      *
           MOVE    "DBFETCH"       TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
      *
       920-DBFETCH-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¥¯¥í¡¼¥¹½èÍý
      *****************************************************************
       990-DBCLOSE-SEC           SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
grpsys     CALL    "ORCDBMAIN"         USING   MCPAREA
                                               MCPDATA-REC
                                               SPA-AREA
      *
           .
       990-DBCLOSE-EXT.
           EXIT.
      *
