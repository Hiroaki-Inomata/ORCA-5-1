      *******************************************************************
      * Project code name "ORCA"
      * Æü°åÉ¸½à¥ì¥»¥×¥È¥½¥Õ¥È¡ÊJMA standard receipt software¡Ë
      * Copyright(C) 2002 JMA (Japan Medical Association)
      *
      * This program is part of "JMA standard receipt software".
      *
      *     This program is distributed in the hope that it will be useful
      * for further advancement in medical care, according to JMA Open
      * Source License, but WITHOUT ANY WARRANTY.
      *     Everyone is granted permission to use, copy, modify and
      * redistribute this program, but only under the conditions described
      * in the JMA Open Source License. You should have received a copy of
      * this license along with this program. If not, stop using this
      * program and contact JMA, 2-28-16 Honkomagome, Bunkyo-ku, Tokyo,
      * 113-8621, Japan.
      ********************************************************************
       IDENTIFICATION          DIVISION.
       PROGRAM-ID.             ORCR1260.
      *****************************************************************
      *  ¥·¥¹¥Æ¥àÌ¾        : £Ï£Ò£Ã£Á
      *  ¥µ¥Ö¥·¥¹¥Æ¥àÌ¾    : ¥ì¥»¥×¥È¡ÊÆþ±¡¡Ë
      *  ¥³¥ó¥Ý¡¼¥Í¥ó¥ÈÌ¾  : ¸ø³²¥ì¥»¥×¥È
      *                      Å¦Í×ÍóÊÔ½¸
      *  ´ÉÍý¼Ô            : 
      *  ºîÀ®ÆüÉÕ    ºî¶È¼Ô        µ­½Ò
      *  07/11/16    NACL¡ÝÆ£¸¶    ¿·µ¬ºîÀ®
      *****************************************************************
      *  ¥×¥í¥°¥é¥à½¤ÀµÍúÎò
      * Maj/Min/Rev  ½¤Àµ¼Ô       ÆüÉÕ      ÆâÍÆ
      *  04.02.01    NACL-ÌçÏÆ    08/03/24  Ê¿À®£²£°Ç¯£´·î²þÀµÂÐ±þ
      *                                     ¡Ê½é¿Ç¡ÊÌë´Ö¡¦ÁáÄ«Åù¡Ë²Ã»»ÄÉ²Ã¡Ë
      *                                     ¡ÊÅÀÅ©ÊÔ½¸½¤Àµ¡Ë
      *                                     ¡Ê¿ÇÎÅ¶èÊ¬£¶£´¡§ÉÂÍý¿ÇÃÇÂÐ±þ¡Ë
      *  04.02.02    NACL-ÌçÏÆ    08/05/08  ÅÀÅ©£³£³£²¤Î¼êµ»ÎÁÊÔ½¸
      *
      *  04.03.01    NACL-ÌçÏÆ    08/07/09  ÅêÌô¤Îµ­ºÜ½çÊÑ¹¹¡ÊÆüÉÕ½ç¡Ë
      *  04.03.02    NACL-ÌçÏÆ    08/07/14  ÅêÌôºÞÅÀ£°¡Ê±¡³°Åù¡Ëµ­ºÜÂÐ±þ
      *  04.03.03    NACL-ÌçÏÆ    08/12/01  ºßÂð¡Ê±¡³°Ê¬¡ËÊÔ½¸½¤Àµ
      *
      *  04.04.01    NACL-ÌçÏÆ    09/02/04  ¸¡ºº¤Î¥³¥á¥ó¥È¼«Æ°µ­ºÜÂÐ±þ
      *  04.04.02    NACL-ÌçÏÆ    09/09/30  ¸¡ºº¤Î¿ôÎÌÊÔ½¸½¤Àµ
      *  04.04.03    NACL-ÌçÏÆ    10/03/03  ÎÅÍÜ¥ì¥»¥³¥á¥ó¥ÈÊÔ½¸½¤Àµ
      *  04.04.04    NACL-ÌçÏÆ    10/03/29  ²þÀµÂÐ±þ
      *                                     ¡Ê²èÁü¿ÇÃÇ£²²óÌÜ°Ê¹ß¸º»»ÊÔ½¸¡Ë
      *                                     ¡Ê¥³¡¼¥ÉÄÉ²Ã¡Ë
      *  04.04.05    NACL-ÌçÏÆ    10/06/01  Â¾°åÎÅµ¡´Ø¼õ¿ÇÂÐ±þ
      *  04.04.06    NACL-ÌçÏÆ    10/09/03  ºßÂðÌôºÞ±¡³°½èÊýÅÀ¸¡ÍÑ¥ì¥»
      *                                     µ­ºÜ½¤Àµ
      *
      *  04.05.01    NACL-ÌçÏÆ    09/06/10  Å¦Í×Íó²¼Éô¤Ø¤Î¥³¥á¥ó¥Èµ­ºÜÂÐ±þ
      *  04.05.02    NACL-ÌçÏÆ    09/06/17  ½èÃÖ¤Îµ­ºÜ½çÊÑ¹¹¡ÊÆüÉÕ½ç¡Ë
      *  04.05.03    NACL-Æ£¸¶    09/07/14  ¾®¿ôÅÀ°Ê²¼£µ·åÂÐ±þ
      *  04.05.04    NACL-ÌçÏÆ    10/01/27  ¼£¸³ÂÐ±þ
      *  04.05.05    NACL-ÌçÏÆ    11/11/30  ²èÁü¿ÇÃÇ¥Õ¥¤¥ë¥àÊ¬²è¿ôÂÐ±þ
      *  04.05.06    NACL-ÌçÏÆ    13/01/22  ¥ï¡¼¥¯ÎÎ°è³ÈÄ¥
      *  04.06.01    NACL-ÌçÏÆ    12/10/15  ¿ÇÎÅ¹Ô°ÙÆþÎÏ¤·¤¿¥³¥á¥ó¥È¤Î¤ß¤ÎºÞ¤Î
      *                                     ¥ì¥»¥×¥Èµ­ºÜÂÐ±þ
      *  04.06.02    NACL-ÌçÏÆ    13/02/27  Ê¿À®£²£µÇ¯£´·î²þÀµÂÐ±þ
      *  04.07.01    NACL-ÌçÏÆ    12/08/28  ÌôºÞÎÁ¸ºÅÀÂÐ±þ
      *  04.07.02    NACL-ÌçÏÆ    14/06/17  ±ÉÍÜ´ÉÍýÂÎÀ©¸º»»µ¬Äê³ºÅöÂÐ±þ
      *  04.07.03    NACL-ÌçÏÆ    14/11/12  ²èÁü¿ÇÃÇ¥Õ¥¤¥ë¥àÊ¬²è¿ôÂÐ±þ½¤Àµ
      *  04.07.04    NACL-ÌçÏÆ    14/12/15  Ê¿À®£²£·Ç¯£±·î²þÀµÂÐ±þ
      *                                     ¡Ê½éºÆ¿ÇÎÁ¡¦ÄãÂÅ·ëÎ¨ÂÐ±þ¡Ë
      *  04.07.05    NACL-ÌçÏÆ    14/12/24  Ê¿À®£²£·Ç¯£±·î²þÀµÂÐ±þ
      *                                     ¡Ê½éºÆ¿ÇÎÁ¡¦ÄãÂÅ·ëÎ¨ÂÐ±þ¡Ë
      *  04.07.06    NACL-ÌçÏÆ    15/06/02  µ­ºÜÉÔÍ×¤Ê¥·¥¹¥Æ¥àÍ½Ìó¥³¡¼¥É¤ÎÂÐ±þ
      *
      *  04.08.01    NACL-ÌçÏÆ    13/01/25  Êñ³ç¿ÇÎÅÊ¬¤ÎÅÀ¸¡ÍÑ¥ì¥»¥×¥Èµ­ºÜÂÐ±þ
      *  04.08.02    NACL-Æ£¸¶    14/07/07  °ì»þ¥Ç¥£¥ì¥¯¥È¥êÂÐ±þ
      *  04.08.03    NACL-ÌçÏÆ    15/12/02  £°ÅÀÃÏ°è¸øÈñµ­ºÜÂÐ±þ
      *  04.08.04    NACL-ÌçÏÆ    16/01/12  ÅÀ¸¡ÍÑ¥ì¥»¥×¥È±¡³°½èÊý°ìÈÌÌ¾µ­ºÜÂÐ±þ
      *  04.08.05    NACL-ÌçÏÆ    16/03/03  ¸ø³²¤ÎÎÅÍÜÃ´Åö¼êÅö¤Ï
      *                                     ÌôºÞ¡¦´ïºàÅÀ¤Î¼è¤ê°·¤¤¤È¤¹¤ë
      *  04.08.06    NACL-ÌçÏÆ    16/03/28  Ê¿À®£²£¸Ç¯£´·î²þÀµÂÐ±þ
      *  04.08.07    NACL-ÌçÏÆ    16/08/23  »ý»²ÌôÂÐ±þ
      *  04.08.08    NACL-ÌçÏÆ    16/09/20  £±£µ±ß°Ê²¼ÌôºÞ¤ÎÄó½ÐÍÑ¥ì¥»¥×¥Èµ­ºÜ
      *                                     ¡Êµ­Ï¿¡ËÂÐ±þ
      *  04.08.09    NACL-ÌçÏÆ    16/11/07  £±£µ±ß°Ê²¼ÌôºÞ¤ÎÄó½ÐÍÑ¥ì¥»¥×¥Èµ­ºÜ
      *                                     ¡Êµ­Ï¿¡ËÂÐ±þ½¤Àµ
      *  04.08.10    NACL-ÌçÏÆ    17/10/18  Æþ±¡ÎÁ¤È°Û¤Ê¤ëÊÝ¸±ÁÈ¤ß¹ç¤ï¤»
      *                                     ¤Ç¤Î¿©»ö»»ÄêÂÐ±þ
      *  04.08.11    NACL-ÌçÏÆ    17/12/13  Êñ³çÅÀ¿ô¤Î¸ø³²Êä½þË¡¸ºÅÀÊ¬¤Î¥Þ¥¤¥Ê¥¹
      *                                     É½¼¨ÂÐ±þ
      *  04.08.12    NACL-Æ£¸¶    18/03/28  Ê¿À®£³£°Ç¯£´·î²þÀµÂÐ±þ
      *  04.08.13    NACL-ÌçÏÆ    18/04/02  Ê¿À®£³£°Ç¯£´·î²þÀµÂÐ±þ
      *
      *  05.00.01    NACL-ÌçÏÆ    18/11/16  µÜ¾ë¸©ÃÏÊý¸øÈñÂÐ±þ
      *  05.00.02    NACL-ÌçÏÆ    19/03/11  Í½Ìó¥³¡¼¥ÉÆÉ¤ßÈô¤Ð¤·½¤Àµ
      *  05.00.03    NACL-ÌçÏÆ    20/03/30  ÎáÏÂ£²Ç¯£´·î²þÀµÂÐ±þ
      *  05.00.04    NACL-Æ£¸¶    20/04/01  ÎáÏÂ£²Ç¯£´·î²þÀµÂÐ±þ
      *                                     Êñ³çÂÐ¾Ý¸¡ºº¤ÎÄÉ²Ã
      *                                     Ì¾¾Î¤Î·å¿ôÊÑ¹¹¤Ë¤è¤ëµ­ºÜÂÐ±þ
      *****************************************************************
      *
       ENVIRONMENT                 DIVISION.
       CONFIGURATION               SECTION.
       INPUT-OUTPUT                SECTION.
       FILE-CONTROL.
      *
           SELECT  RECE200-FILE    ASSIGN  RECE200PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE200-KEY
                                   FILE    STATUS  IS  STS-RECE200.
           SELECT  RECE220-FILE    ASSIGN  RECE220PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  SEQUENTIAL
                                   RECORD  KEY     IS  RECE220-KEY
                                   FILE    STATUS  IS  STS-RECE220.
           SELECT  RECE230-FILE    ASSIGN  RECE230PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  SEQUENTIAL
                                   RECORD  KEY     IS  RECE230-KEY
                                   FILE    STATUS  IS  STS-RECE230.
           SELECT  RECE240-FILE    ASSIGN  RECE240PARA
                                   ORGANIZATION    IS  INDEXED
                                   ACCESS  MODE    IS  DYNAMIC
                                   RECORD  KEY     IS  RECE240-KEY
                                   FILE    STATUS  IS  STS-RECE240.
      *    ¥¨¥é¡¼¥Õ¥¡¥¤¥ë
           SELECT  RECEERR-FILE    ASSIGN  RECEERR
                                   FILE    STATUS  IS  STS-RECEERR.
      *
       DATA                    DIVISION.
       FILE                        SECTION.
      *
       FD  RECE200-FILE.
       01  RECE200-REC.
           COPY    "CPRCF200.INC".
      *
       FD  RECE220-FILE.
       01  RECE220-REC.
           COPY    "CPRCF220.INC".
      *
       FD  RECE230-FILE.
       01  RECE230-REC.
           COPY    "CPRCF230.INC".
      *
       FD  RECE240-FILE.
       01  RECE240-REC. 
           COPY    "CPRCF240.INC".
      *
       FD  RECEERR-FILE.
       01  RECEERR-REC             PIC X(200). 
      *
       WORKING-STORAGE             SECTION.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE200//.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE220//.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE230//.
      *
           COPY    "CPRECEDAT1.INC"
                                   REPLACING  //RECEDAT1//
                                   BY         //RECE240//.
      *
      *    ¥¨¥é¡¼¥Õ¥¡¥¤¥ëÌ¾¾ÎÎÎ°è
           COPY    "CPERRFL.INC"   REPLACING  //ERRFLPARA//
                                   BY         //RECEERR//.
      *
      *    ¥Õ¥¡¥¤¥ëÌ¾¾ÎÎÎ°è
           COPY    "CPRECEDAT1.INC".
           COPY    "CPTEMPFL.INC".
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  STS-AREA.
           03  SPA-STS             PIC 9(04).
           03  STS-RECE200         PIC X(02).
           03  STS-RECE220         PIC X(02).
           03  STS-RECE230         PIC X(02).
           03  STS-RECE240         PIC X(02).
           03  STS-RECEERR         PIC X(02).
      *
      *    ¥Õ¥é¥°ÎÎ°è
       01  FLG-AREA.
           03  FLG-END             PIC 9(01).
           03  FLG-RECE220         PIC 9(01).
           03  FLG-RECE230         PIC 9(01).
           03  FLG-SP              PIC 9(01).
           03  FLG-NOPRT           PIC 9(01).
           03  FLG-TEIGEN          PIC 9(01).
           03  FLG-COMMENT         PIC 9(01).
           03  FLG-COMMENT2        PIC 9(01).
           03  FLG-COMMENT3        PIC 9(01).
           03  FLG-HIKAKIN         PIC 9(01).
           03  FLG-SRYCD1          PIC 9(01).
           03  FLG-OK              PIC 9(01).
           03  FLG-NG              PIC 9(01).
           03  FLG-GAIJINKEN       PIC 9(01).
      *
      *    ¥«¥¦¥ó¥ÈÎÎ°è
       01  CNT-AREA.
           03  CNT-RECE200         PIC 9(06).
           03  CNT-RECE220         PIC 9(06).
           03  CNT-RECE230         PIC 9(06).
           03  CNT-RECE240         PIC 9(06).
           03  CNT-IN-CANCEL       PIC 9(06).
      *
      *    Åº»úÎÎ°è
       01  IDX-AREA.
           03  IDV                 PIC 9(04).
           03  IDW                 PIC 9(04).
           03  IDX                 PIC 9(04).
           03  IDY                 PIC 9(04).
           03  IDZ                 PIC 9(04).
           03  IDXX                PIC 9(04).
      *    ÅÀ¿ô²ó¿ôÊÔ½¸ÍÑ     
           03  IDA                 PIC 9(04).
           03  IDB                 PIC 9(04).
      *    ºÞ¿ÇÎÅ¹Ô°Ù¥³¡¼¥ÉÊÌÊÔ½¸ÍÑ     
           03  IDX1                PIC 9(04).
           03  IDX2                PIC 9(04).
           03  IDX3                PIC 9(04).
           03  IDX4                PIC 9(04).
           03  IDX6                PIC 9(04).
           03  IDX8                PIC 9(03).
           03  IDX9                PIC 9(03).
      *
           03  IDXY                PIC 9(03).
           03  IDXZ                PIC 9(03).
      *     
           03  IDW1                PIC 9(04). 
           03  IDW2                PIC 9(04). 
           03  IDW3                PIC 9(04).
      *
      *    °ì»þÎÎ°è
       01  WRK-AREA.
           03  WRK-PARA.
               05  WRK-PARA-SRYYM  PIC X(06).
               05  WRK-PARA-TERMID PIC X(16).
               05  WRK-PARA-SYSYMD PIC X(08).
               05  WRK-PARA-JOBID  PIC 9(07).
               05  WRK-PARA-SHELLID
                                   PIC X(08).
           03  WRK-PARA-PRTKBN     PIC X(01).
           03  WRK-PARA-HOSPNUM    PIC 9(02).
      *
           03  WRK-RECEERR         PIC X(200).
      *
           03  WRK-LINENUM         PIC 9(05).
      *
           03  WRK-TENSUGOKEI      PIC 9(07).
      *
      *    ºÞ°õ»ú¹Ô¿ô
           03  WRK-TBLMAX          PIC 9(03).
      *    ºÞÌÀºÙÁí¿ô¡Ê¿ÇÎÅ¹Ô°Ù¥³¡¼¥ÉÊÌ¡Ë
           03  WRK-ZAIWMAX-G.
               05  WRK-ZAIWMAX     PIC 9(03)   OCCURS  6.
           03  WRK-ZAIWMAX-SAV-G.
               05  WRK-ZAIWMAX-SAV PIC 9(03)   OCCURS  6.
      * 
           03  WRK-YUKOKETA        PIC  9(03).
           03  WRK-NAME            PIC  X(300).
      *
           03  WRK-RECE230         PIC 9(01).
      *
      *    ¿ô»úÈ¾³ÑÁ´³ÑÊÑ´¹ÍÑ     
           03  WRK-NUM             PIC 9(01).
           03  WRK-CHAR-IDX        PIC 9(02).
           03  WRK-CHAR-HENKAN-AREA.
               05  WRK-CHAR-X      PIC X(10).
               05  WRK-CHAR-N      PIC X(20).
               05  WRK-CHAR-CNT    PIC 9(02).
               05  WRK-CHAR-FLG    PIC 9(01). 
               05  WRK-CHAR-N-CNT  PIC 9(02).
      *
           03  WRK-EDIT-AREA.
               05  WRK-WCLM        PIC 9(03).
      *
           03  WRK-KOUI            PIC X(300).
      *
           03  WRK-ZAI.
               05  WRK-ZAI-MK      PIC X(02).
               05  WRK-ZAI-NAME.
                   07  FILLER      PIC X(28).
                   07  WRK-ZAI-TNSKAI
                                   PIC X(22).
      *
           03  WRK-TNSKAI.
               05  WRK-ZAITEN      PIC X(14).
               05  WRK-X           PIC X(02).
               05  WRK-ZAIKAISU    PIC X(06).
      *
           03  WRK-ZAITENX         PIC ZZZZZZ9.
           03  WRK-ZAIKAISUX       PIC ZZ9.
           03  WRK-TNSKAI-ST       PIC 9(02).
           03  WRK-TNSKAI-KETA     PIC 9(02).
      *
           03  WRK-SRYCD           PIC X(01).
      *
      *    ¸¡ºº¤Î²ó¿ô
           03  WRK-KENSA-KAISU     PIC 9(05). 
      *     
           03  WRK-SRYSURYOW       PIC X(24).
           03  WRK-NAMEKETA        PIC 9(03).
           03  WRK-YOHAKU          PIC 9(03).
           03  WRK-WKETA           PIC 9(03).
      *    Ê¬²è¿ôÊÔ½¸ÍÑ     
           03  WRK-BUNKAKUKETA     PIC 9(02).
           03  WRK-BUNKAKU-N       PIC X(10).
           03  WRK-SRYKAISU-X      PIC ZZ9.
      *    ¿ôÎÌÊÔ½¸ÍÑ     
           03  WRK-SURYOKETA       PIC 9(02).
           03  WRK-SURYOKETA1      PIC 9(02).
           03  WRK-SURYOKETA2      PIC 9(02).
           03  WRK-SURYOST         PIC 9(02).
           03  WRK-SURYO           PIC 9(05)V9(05).
           03  WRK-SURYO-R         REDEFINES   WRK-SURYO.
               05  WRK-SURYO-S1    PIC 9(05).
               05  WRK-SURYO-S2    PIC 9(05).
           03  WRK-SURYO-X.
      *********05  WRK-SURYO-Z1    PIC ZZZZZ.
               05  WRK-SURYO-Z1    PIC ZZZZ9.
               05  WRK-SURYO-Z2    PIC X(01).
               05  WRK-SURYO-Z3    PIC ZZZZZ.
           03  WRK-SURYO-N.
               05  WRK-SURYO-N1    PIC X(10).
               05  WRK-SURYO-N2    PIC X(02).
               05  WRK-SURYO-N3    PIC X(10).
      *
      *    ÆÃÄêÊÝ¸±°åÎÅºàÎÁÊÔ½¸ÍÑ
           03  WRK-RECEHENNAME                 PIC X(300).
           03  WRK-RECEHENTANINAME             PIC X(50).
           03  WRK-RECEHENTANI                 PIC 9(02).
      *
      *    ºÞ¿ÇÎÅ¹Ô°Ù¥³¡¼¥ÉÊÌÊÔ½¸ÍÑ     
           03  WRK-WIDX1           PIC 9(03).
           03  WRK-WIDX2           PIC 9(03).
      *     
           03  WRK-Z9              PIC ZZZ9.
      *
      *    ºÞ¤Î¿ÇÎÅ¼ïÊÌ¶èÊ¬
           03  WRK-SRYSYUKBN       PIC X(03).
      *
           03  WRK-SYS-SRYYMD      PIC X(08).
      *
           03  WRK-KENTAICOMMENT-YUKOKETA      PIC 9(03).
           03  WRK-KENTAICOMMENT-NAME          PIC X(300).
           03  WRK-KENTAICOMMENT-NAME-TEMP     PIC X(300).
           03  WRK-KENTAICOMMENT-SRYCD         PIC 9(09).
      *
           03  WRK-SET-LINENUM     PIC 9(05).
      *
      *    ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë
       01  TBL-ZAI-AREA.
      ***  03  TBL-ZAI-OCC         OCCURS   100.
           03  TBL-ZAI-OCC         OCCURS   300.
               05  TBL-ZAI         PIC X(52).
               05  TBL-ZAI-IDX     PIC 9(01).
               05  TBL-ZAI-SRYCD   PIC X(09).
      *
      *    ¸¡ºº¤ò¤Þ¤È¤á¤ë¥Æ¡¼¥Ö¥ë
       01  WRK-KENSA-MATOME-MAX    PIC 9(03).
       01  WRK-KENSA-MATOME-TABLE.
           03  WRK-KENSA-MATOME        OCCURS  101.
               05  WRK-HOUKNSKBN   PIC 9(02).
               05  WRK-GAIJINKEN   PIC 9(02).
               05  WRK-SRYSYUKBN-K PIC X(03).
               05  WRK-KAISU-G.
                   07  WRK-KAKSU-OCC   OCCURS  4.
                       09  WRK-KAISU
                                   PIC 9(03).  
                   07  WRK-KAISU1  PIC 9(02).
                   07  WRK-KAISU2  PIC 9(03).
               05  WRK-KENSA-SU    PIC 9(03).
               05  WRK-RECE220-IDX-G.
                   07  WRK-RECE220-IDX
                                   PIC 9(03)   OCCURS  30.
               05  WRK-KENSA-SRYCD-G.
                   07  WRK-KENSA-SRYCD-OCC     OCCURS  30.
                       09  WRK-KENSA-KENTAICOMMENT-SRYCD
                                   PIC 9(09).
                       09  WRK-KENSA-SRYCD
                                   PIC 9(09).
                       09  WRK-KENSA-SRYSURYO
                                   PIC 9(05)V9(05).
      *
       01  WRK-RECE220-ZAITEN      PIC 9(08).
      *         
       01  WRK-RECE220-MAX         PIC 9(03).
       01  WRK-SUM-KAISU-TABLE.
           03  WRK-SUM-KAISU       PIC 9(04)   OCCURS  31.
       01  WRK-MIN-KAISU-TABLE.
           03  WRK-MIN-KAISU-G         OCCURS  31.
               05  WRK-MIN-KAISU   PIC 9(03).
               05  WRK-MIN-HOUKNSKBN
                                   PIC 9(02).
               05  WRK-MIN-GAIJINKEN
                                   PIC 9(02).
               05  WRK-MIN-SRYSYUKBN
                                   PIC X(03).
       01  WRK-RECE220-FLG-TABLE.
           03  WRK-RECE220-FLG     PIC 9(01)   OCCURS  100.
       01  WRK-RECE220-MATOME-TABLE.
           03  WRK-RECE220-MATOME  PIC 9(01)   OCCURS  100.
       01  WRK-RECE220-TABLE.
           03  WRK-RECE220-TBL                 OCCURS  100.
               05  WRK-RECE220-HOUKNSKBN   PIC 9(02).
               05  WRK-RECE220-GAIJINKEN   PIC 9(02).
               05  WRK-RECE220-SRYSYUKBN   PIC X(03).
               05  WRK-RECE220-REC         PIC X(1000).
               05  WRK-RECE220-SRYCD-G.
                   07  WRK-RECE220-KENTAICOMMENT-SRYCD
                                           PIC 9(09).
                   07  WRK-RECE220-SRYCD   PIC 9(09).
                   07  WRK-RECE220-SRYSURYO
                                           PIC 9(05)V9(05).
               05  WRK-RECE220-DAY-AREA.
                   07  WRK-RECE220-DAY-TBL         OCCURS  4.
                       09  WRK-RECE220-KAISUINF    OCCURS  31.
                           11  WRK-RECE220-KAISU   PIC  9(03).
      *
      *    ¸¡ºº¤Î¤È¤­Å¬ÍÑ¤ÎÊÔ½¸¤Ë»ÈÍÑ
       01  WRK-KENSA-MAX           PIC 9(04).
       01  TBL-NAME-AREA.
           03  TBL-NAME-REC                OCCURS 100.
               05  TBL-SRYCD       PIC X(09).
               05  TBL-SRYSURYO    PIC 9(05)V9(05).
      *        Ã±°Ì¥³¡¼¥É/Ã±°ÌÌ¾¾ÎÍ­¸ú·å¿ô/Ã±°ÌÌ¾¾Î
               05  TBL-TANICD      PIC 9(03).
               05  TBL-TANIMOJISU  PIC 9(01).
               05  TBL-TANINAME    PIC X(24).
               05  TBL-NAMEINF.
      *            ´Á»úÍ­¸ú·å¿ô/´Á»úÌ¾¾Î
                   07  TBL-YUKOKETA
                                   PIC 9(03).
                   07  TBL-NAME    PIC X(300).
      *        ¥Ç¡¼¥¿¶èÊ¬¾ðÊó
               05  TBL-DATAKBN     PIC 9(01).
      *        Êñ³çÂÐ¾Ý¸¡ºº¾ðÊó
               05  TBL-HOUKNSKBN   PIC 9(02).
      *
      *     ¸¡ºº¤Î¹àÌÜ¿ôÍÑ
        01  WRK-KOUMOKUSU          PIC 9(02). 
        01  WRK-TNS-HOUKNSKBN      PIC 9(02).
        01  WRK-CONS-KENSACOMMENT-AREA.
            03  WRK-CONS-KENSACOMMENT-G.
                05  FILLER         PIC X(50)   VALUE
                "·ì±Õ²½³Ø¸¡ºº".                        
                05  FILLER         PIC X(50)   VALUE
                "ÆâÊ¬Èç³ØÅª¸¡ºº".                        
                05  FILLER         PIC X(50)   VALUE
                "´Î±ê¥¦¥¤¥ë¥¹´ØÏ¢¸¡ºº".                        
                05  FILLER         PIC X(50)   VALUE
                "¼ðáç¥Þ¡¼¥«¡¼¤Î¤¦¤Á¦Á¡Ý¥Õ¥§¥È¥×¥í¥Æ¥¤¥óÅù".                        
                05  FILLER         PIC X(50)   VALUE
                "¼ðáç¥Þ¡¼¥«¡¼".                        
                05  FILLER         PIC X(50)   VALUE
                "½Ð·ì¡¦¶Å¸Ç¸¡ºº".                        
                05  FILLER         PIC X(50)   VALUE
                "¼«¸Ê¹³ÂÎ¸¡ºº".                        
                05  FILLER         PIC X(50)   VALUE
                "ÆâÊ¬ÈçÉé²Ù»î¸³".                        
                05  FILLER         PIC X(50)   VALUE
                "¥¦¥¤¥ë¥¹¹³ÂÎ²Á".                        
                05  FILLER         PIC X(50)   VALUE
                "¥¦¥¤¥ë¥¹¹³ÂÎ²ÁÀºÌ©Â¬Äê".                        
                05  FILLER         PIC X(50)   VALUE
                "·ìÞùÃÁÇòÌÈ±Ö³ØÅª¸¡ºº".                        
                05  FILLER         PIC X(50)   VALUE
                "°­À­¼ðáç°äÅÁ»Ò¸¡ºº".
                05  FILLER                 PIC X(50)   VALUE
                "°­À­¼ðáç°äÅÁ»Ò¸¡ºº¡Ê½èÍý¤¬ÍÆ°×¤Ê¤â¤Î¡Ë".
                05  FILLER                 PIC X(50)   VALUE
                "°­À­¼ðáç°äÅÁ»Ò¸¡ºº¡Ê½èÍý¤¬Ê£»¨¤Ê¤â¤Î¡Ë".
            03  WRK-CONS-KENSACOMMENT-R    REDEFINES
                                           WRK-CONS-KENSACOMMENT-G.
                05  WRK-CONS-KENSACOMMENT  PIC X(50)   OCCURS  14.
      *
      *³°Íè¿×Â®¸¡ÂÎ¸¡ºº²Ã»»»»ÄêÆü¥Æ¡¼¥Ö¥ë
       01  WRK-KENTAIKASAN-TABLE.
           03  WRK-KENTAIKASAN     PIC 9(01)   OCCURS  31.
       01  WRK-GAIJINKEN-ZAINUM    PIC 9(03).
      *
      *³°Íè¿×Â®¸¡ÂÎ¸¡ºº²Ã»»»»ÄêÆü¤ÎºÞ¾ðÊóÂàÈò
       01  WRK-RECE220GJK-MAX               PIC 9(02).
       01  WRK-RECE220GJK-TABLE.
           03  WRK-RECE220GJK-TBL           OCCURS 31.
               05  WRK-RECE220GJK-REC       PIC X(1000).
       01  RECE220GJK-REC.
           COPY    "CPRCF220.INC"  REPLACING  //RECE220//
                                   BY         //RECE220GJK//.
       01  RECE220SAV-REC.
           COPY    "CPRCF220.INC"  REPLACING  //RECE220//
                                   BY         //RECE220SAV//.
      *
      *ºÞ¤ÎÀèÆ¬¤Î¿ÇÎÅ¥³¡¼¥É¾ðÊó
       01  WRK-ZAIW-AREA.
      *    ¿ÇÎÅ¥³¡¼¥É
           03  WRK-ZAIW-SRYCD1             PIC X(09).
      *    ³Æ¼ïÈÖ¹æÅù¾ðÊó
           03  WRK-ZAIW-CDKBN-AREA.
               05  WRK-ZAIW-CDKBN-KBN      PIC X(01).
               05  WRK-ZAIW-CDKBN-SYO      PIC 9(01).
               05  WRK-ZAIW-CDKBN-BU       PIC 9(02).
               05  WRK-ZAIW-CDKBN-KBNNUM   PIC 9(03).
               05  WRK-ZAIW-CDKBN-KBNNUM-EDA
                                           PIC 9(02).
               05  WRK-ZAIW-CDKBN-KOUBAN   PIC 9(02).
               05  WRK-ZAIW-KOUHYOJYUNNUM  PIC 9(09).
      *    ¸¡ººÅù¼Â»ÜÈ½ÃÇ¾ðÊó
           03  WRK-ZAIW-KNSJISKBN          PIC 9(01).
      *     
      *    ¿ÇÎÅ¹Ô°ÙÊÌ¥Æ¡¼¥Ö¥ë
      *    £±¡§¥æ¡¼¥¶¡¼¥³¥á¥ó¥È¡¢£²¡§¥³¥á¥ó¥È¡¢
      *    £³¡§¿ÇÎÅ¹Ô°Ù¡¢£´¡§ÌôºÞ¡¢£µ¡§ÆÃÄê´ïºà¡¢£¶¡§³°¿×¸¡ÂàÈòÍÑ
           03  TBL-ZAIW-OCC                OCCURS 6.  
      ***      05  TBL-ZAIW-REC            OCCURS 100.
               05  TBL-ZAIW-REC            OCCURS 300.
                   07  TBL-ZAIW-SRYACTINF.
      *                ¿ÇÎÅ¥³¡¼¥É
                       09  TBL-ZAIW-SRYCD           PIC  X(09).
      *                ¿ÇÎÅ¼ïÊÌ¶èÊ¬
                       09  TBL-ZAIW-SRYSYUKBN       PIC  X(03).
      *                ¿ôÎÌ
                       09  TBL-ZAIW-SRYSURYO        PIC  9(05)V9(05).
      *                ²ó¿ô
                       09  TBL-ZAIW-SRYKAISU        PIC  9(03).
      *                Ã±°Ì¥³¡¼¥É
                       09  TBL-ZAIW-TANICD          PIC  9(03).
      *                Ã±°ÌÌ¾¾ÎÍ­¸ú·å¿ô
                       09  TBL-ZAIW-TANIMOJISU      PIC  9(01).
      *                Ã±°ÌÌ¾¾Î
                       09  TBL-ZAIW-TANINAME        PIC  X(24).
      *                ÅÀ¿ô¼±ÊÌ¶èÊ¬
                       09  TBL-ZAIW-TENSIKIBETU     PIC  9(01).
      *                ÅÀ¿ô
                       09  TBL-ZAIW-TEN             PIC  9(09)V9(02).
      *                ÌÀºÙÀÁµá¥Õ¥é¥°
                       09  TBL-ZAIW-MEISKYFLG       PIC  X(01).
      *                ¼«Æ°»»Äê¶èÊ¬
                       09  TBL-ZAIW-AUTOKBN         PIC  X(01).
      *                Ì¾¾ÎÆþÎÏÈÖ¹æ
                       09  TBL-ZAIW-INPUTNUM        PIC  9(03).
      *                ÅÀ¿ôÍó½¸·×Àè¼±ÊÌ
                       09  TBL-ZAIW-TENTTLKBN       PIC  9(03).
      *                ¥Ç¡¼¥¿¶èÊ¬
                       09  TBL-ZAIW-DATAKBN         PIC  9(01).
      *                Êñ³çÂÐ¾Ý¸¡ºº
                       09  TBL-ZAIW-HOUKNSKBN       PIC  9(02).
      *                ¸¡ººÅù¼Â»ÜÈ½ÃÇ
                       09  TBL-ZAIW-KNSJISKBN       PIC  9(01).
      *                ¸¡ººÅù¼Â»ÜÈ½ÃÇ¥°¥ë¡¼¥×
                       09  TBL-ZAIW-KNSJISGRPKBN    PIC  9(02).
      *                ³Æ¼ïÈÖ¹æÅù
                       09  TBL-ZAIW-CDKBNINF.
                           11  TBL-ZAIW-CDKBN-KBN   PIC  X(01).
                           11  TBL-ZAIW-CDKBN-SYO   PIC  9(01).
                           11  TBL-ZAIW-CDKBN-BU    PIC  9(02).
                           11  TBL-ZAIW-CDKBN-KBNNUM     PIC  9(03).
                           11  TBL-ZAIW-CDKBN-KBNNUM-EDA PIC  9(02).
                           11  TBL-ZAIW-CDKBN-KOUBAN     PIC  9(02).
                           11  TBL-ZAIW-KOUHYOJYUNNUM    PIC  9(09).
      *                ¹ð¼¨Åù¼±ÊÌ¶èÊ¬£±
                       09  TBL-ZAIW-KOKUJISKBKBN1   PIC  9(01).
      *                ¤­¤¶¤ßÃÍ·×»»¼±ÊÌ
                       09  TBL-ZAIW-KZMCOMPSIKIBETU PIC  9(01).
      *                Ãí²Ã»»¥³¡¼¥É
                       09  TBL-ZAIW-CHUKSNINF.
      *                    ¥³¡¼¥É
                           11  TBL-ZAIW-CHUKSNCD    PIC  X(04).
      *                    ÄÌÈÖ
                           11  TBL-ZAIW-CHUKSNTUBAN PIC  X(01).
      *                ¸¡ÂÎ¸¡ºº¥³¥á¥ó¥È
                       09  TBL-ZAIW-KENTAICOMMENT   PIC  9(01).
      *                ÆþÎÏ¥³¥á¥ó¥È
                       09  TBL-ZAIW-INPUTCOMENT     PIC  X(140).
      *            Ì¾¾Î¾ðÊó
                   07  TBL-ZAIW-NAMEINF.
      *                ´Á»úÍ­¸ú·å¿ô
                       09  TBL-ZAIW-YUKOKETA        PIC  9(03).
      *                ´Á»úÌ¾¾Î
                       09  TBL-ZAIW-NAME            PIC  X(300).
                   07  TBL-ZAIW-SRYSYUKBN-INPUT     PIC  X(03).
                   07  TBL-ZAIW-KENTAICOMMENT-SRYCD PIC  9(09).
      *            ¥ì¥»ÍÑÆÃÄê´ïºà¾¦ÉÊÌ¾ÊÔ½¸¥Õ¥é¥°
                   07  TBL-ZAIW-RECEHENFLG          PIC  X(01).
      *
       01  TBL-ZAI-MAX         PIC  9(03)  VALUE   100.              
       01  TBL-ZAI-MAX2        PIC  9(03)  VALUE   300.
      *
      *    ½é¿Ç¡¦ºÆ¿Ç¤ÎºÞ¤Þ¤È¤á¾ðÊó
       01  TBL-SORT11-INF.
         02    TBL-SORT11-OCC              OCCURS   4.
           03  TBL-SORT11-FLG              PIC  9(01).
           03  TBL-SORT11-TEN              PIC  9(07).
           03  TBL-SORT11-YUKOKETA         PIC  9(03).
           03  TBL-SORT11-NAME             PIC  X(300).
           03  TBL-SORT11-ZAIKAISU         PIC  9(04).
           03  TBL-SORT11-HKNCOMBI         PIC  9(04).
      *
      *   ÆüËÜ¸ì¿ô»ú
       01  TBL-SUJI-AREA.
           03  FILLER          PIC X(20)   VALUE
              "£±£²£³£´£µ£¶£·£¸£¹£°".
       01  TBL-SUJI-R          REDEFINES   TBL-SUJI-AREA.
           03  TBL-SUJI        PIC X(02)   OCCURS   10.
      *
      *   °õ»ú¤·¤Ê¤¤¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë
       01  TBL-NOSRYCD-AREA.
      *    ½é¿Ç¡ÊÉÂ±¡¡Ë
           03  FILLER          PIC X(09)   VALUE   "111000110".
      *    ½é¿Ç¡Ê¿ÇÎÅ½ê¡Ë
           03  FILLER          PIC X(09)   VALUE   "111003610".
      *    ½é¿Ç¡ÊÉÂ±¡¡Ë
           03  FILLER          PIC X(09)   VALUE   "111700110".
      *    ½é¿Ç¡Ê¿ÇÎÅ½ê¡Ë
           03  FILLER          PIC X(09)   VALUE   "111700210".
      *    Ä´´ð¡Ê¤½¤ÎÂ¾¡Ë
           03  FILLER          PIC X(09)   VALUE   "120001810".
      *    Ä´´ð¡ÊÆþ±¡¡Ë
           03  FILLER          PIC X(09)   VALUE   "120001710".
      *    Ä´ºÞÎÁ¡ÊÆþ±¡¡Ë
           03  FILLER          PIC X(09)   VALUE   "120001110".
      *    Ä´ºÞÎÁ¡ÊËã¡¦¸þ¡¦³Ð¡¦ÆÇ¡Ë¡ÊÆþ±¡¡Ë
           03  FILLER          PIC X(09)   VALUE   "120000410".
      *    ½é¿ÇÎÁ»»Äê²Ê¡§
           03  FILLER          PIC X(09)   VALUE   "830000020".
      *
      *    ¼ÂÆü¿ô»»Äê
           03  FILLER          PIC X(09)   VALUE   "099409901".
      *    ½é¿ÇÎÁ¥À¥ß¡¼
           03  FILLER          PIC X(09)   VALUE   "099110001".
      *    ¼ÂÆü¿ô¸º»»
           03  FILLER          PIC X(09)   VALUE   "099409903".
      *
       01  TBL-NOSRYCD-R       REDEFINES   TBL-NOSRYCD-AREA.
            03  TBL-NOSRYCD     PIC X(09)   OCCURS   12.
      *
       01  TBL-NOSRYCD-MAX     PIC 9(02)   VALUE   12.
      *
      *    ¸ÇÄêÃÍ
       01  CONST-AREA.
      *    ²èÁü¿ÇÃÇ¤ÎÃ±°Ì¤ÎÊÑ¹¹¡ÊËç¢ª²ó¡Ë
           03  WRK-CONS-TANICD PIC 9(03)   VALUE   006.
           03  WRK-CONS-TANINAME
                               PIC X(02)   VALUE   "²ó".
           03  WRK-CONS-BUNKAKU-MOJISU
                               PIC 9(02)   VALUE   4.                    
           03  WRK-CONS-BUNKAKU
                               PIC X(04)   VALUE   "Ê¬²è".
      *    ÌôºÞÎÁÄþ¸º
           03  CONS-TEIGEN     PIC X(09)   VALUE   "630010002".
      *    Êñ³çÅÀ¿ô¤Î¼£¸³¸ºÅÀÊ¬
           03  CONS-GENTEN     PIC X(09)   VALUE   "199000210".
      *    ÌôºÞÎÁ¸ºÅÀ¡Ê¹ç»»ÌôºÞÎÁ¾å¸ÂÄ¶¡Ë
           03  CONS-GENTEN2    PIC X(09)   VALUE   "630010001".
      *    Êñ³çÅÀ¿ô¤Î¸ø³²Êä½þË¡¸ºÅÀÊ¬
           03  CONS-GENTEN3    PIC X(09)   VALUE   "199000410".
      *    ±ÉÍÜ´ÉÍýÂÎÀ©¸º»»µ¬Äê³ºÅö
           03  CONS-EIYOGEN1   PIC X(09)   VALUE   "190182590".
           03  CONS-EIYOGEN2   PIC X(09)   VALUE   "190182690".
      *
      *¥Õ¥ê¡¼¥³¥á¥ó¥È
      *    ¥Õ¥ê¡¼¥³¥á¥ó¥È 
           03  CONS-COMMENT3   PIC X(09)   VALUE   "810000001".
      *    Ê£¿ô¿ÇÎÅ²Ê¼õ¿Ç
           03  CONS-COMMENT4   PIC X(09)   VALUE   "099999901".
      *    ½¸ÃÄ¸¡¿Ç¤«¤é
           03  CONS-COMMENT5   PIC X(09)   VALUE   "820000003".
      *    Ï·¿Í¸¡¿Ç¤«¤é
           03  CONS-COMMENT6   PIC X(09)   VALUE   "820000004".
      *    ³Ø¹»¸¡¿Ç¤«¤é
           03  CONS-COMMENT7   PIC X(09)   VALUE   "820000005".
      *    ·ò¹¯¿ÇÃÇ¤«¤é
           03  CONS-COMMENT8   PIC X(09)   VALUE   "820000006".
      *
      *Èé²¼¶ÚÆùÃí¼Í
           03  CONS-HIKAKIN    PIC X(09)   VALUE   "130000510".
      *    ¡Ê¥µ¡Ë
           03  CONS-RINYAK     PIC X(09)   VALUE   "820000046".
      *
      *½é¿Ç²Ã»»
      *    ½é¿Ç¡Ê¿ÇÎÅ½ê¡Ë¾Ò²ð´µ¼Ô²Ã»»
           03  WRK-CONS-SYOSIN1    PIC X(09)  VALUE "111003770".
      *    Ï·¿Í½é¿Ç¡Ê¿ÇÎÅ½ê¡Ë¾Ò²ð´µ¼Ô²Ã»»
           03  WRK-CONS-SYOSIN2    PIC X(09)  VALUE "111700470".
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ê½é¿Ç»þ¿ÇÎÅ»þ¤Î¾Ò²ð´µ¼Ô¡Ë²Ã»»
           03  WRK-CONS-SYOSIN5    PIC X(09)  VALUE "111010370".
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ê¾Ò²ð´µ¼Ô²Ã»»£³¡Ë
           03  WRK-CONS-SYOSIN6    PIC X(09)  VALUE "111010870".
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ê¾Ò²ð´µ¼Ô²Ã»»£´¡Ë
           03  WRK-CONS-SYOSIN7    PIC X(09)  VALUE "111010970".
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ê¾Ò²ð´µ¼Ô²Ã»»£µ¡Ë
           03  WRK-CONS-SYOSIN8    PIC X(09)  VALUE "111011070".
      *    ¾®»ù²Ê³°Íè¿ÇÎÅÎÁ¡Ê¾Ò²ð´µ¼Ô²Ã»»£¶¡Ë
           03  WRK-CONS-SYOSIN9    PIC X(09)  VALUE "111011170".
      *    ¾Ò²ð´µ¼Ô²Ã»»£±¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN10   PIC X(09)  VALUE "111011270".
      *    ¾Ò²ð´µ¼Ô²Ã»»£²¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN11   PIC X(09)  VALUE "111011370".
      *    ¾Ò²ð´µ¼Ô²Ã»»£³¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN12   PIC X(09)  VALUE "111009970".
      *    ¾Ò²ð´µ¼Ô²Ã»»£´¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN13   PIC X(09)  VALUE "111010070".
      *    ¾Ò²ð´µ¼Ô²Ã»»£µ¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN14   PIC X(09)  VALUE "111010170".
      *    ¾Ò²ð´µ¼Ô²Ã»»£¶¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN15   PIC X(09)  VALUE "111010270".
      *    ¡ãÏ·¡ä¾Ò²ð´µ¼Ô²Ã»»£±¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN16   PIC X(09)  VALUE "111702770".
      *    ¡ãÏ·¡ä¾Ò²ð´µ¼Ô²Ã»»£²¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN17   PIC X(09)  VALUE "111702870".
      *    ¡ãÏ·¡ä¾Ò²ð´µ¼Ô²Ã»»£³¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN18   PIC X(09)  VALUE "111702370".
      *    ¡ãÏ·¡ä¾Ò²ð´µ¼Ô²Ã»»£´¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN19   PIC X(09)  VALUE "111702470".
      *    ¡ãÏ·¡ä¾Ò²ð´µ¼Ô²Ã»»£µ¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN20   PIC X(09)  VALUE "111702570".
      *    ¡ãÏ·¡ä¾Ò²ð´µ¼Ô²Ã»»£¶¡ÊÉÂ±¡¡Ë
           03  WRK-CONS-SYOSIN21   PIC X(09)  VALUE "111702670".
      *    ½é¿Ç¡ÊÆýÍÄ»ù¡Ë¡ÊÌë´Ö¡Ë²Ã»»
           03  WRK-CONS-SYOSIN22   PIC X(09)  VALUE "111011570".
      *    ½é¿Ç¡ÊÆýÍÄ»ù¡Ë¡ÊµÙÆü¡Ë²Ã»»
           03  WRK-CONS-SYOSIN23   PIC X(09)  VALUE "111011670".
      *    ½é¿Ç¡ÊÆýÍÄ»ù¡Ë¡Ê¿¼Ìë¡Ë²Ã»»
           03  WRK-CONS-SYOSIN24   PIC X(09)  VALUE "111011770".
      *    ½é¿Ç¡Ê»þ´Ö³°ÆÃÎã¡Ë²Ã»»
           03  WRK-CONS-SYOSIN25   PIC X(09)  VALUE "111000870".
      *    ¡ãÏ·¡ä½é¿Ç¡Ê»þ´Ö³°ÆÃÎã¡Ë²Ã»»
           03  WRK-CONS-SYOSIN26   PIC X(09)  VALUE "111700870".
      *    ½é¿Ç¡ÊÆýÍÄ»ù»þ´Ö³°ÆÃÎã°åÎÅµ¡´Ø¡Ë²Ã»»
           03  WRK-CONS-SYOSIN27   PIC X(09)  VALUE "111012270".
      *    Æ±Æü½é¿Ç
           03  WRK-CONS-SYOSIN28   PIC X(09)  VALUE "111011810".
      *    ½é¿Ç¡ÊÌë´Ö¡¦ÁáÄ«Åù¡Ë²Ã»»
           03  WRK-CONS-SYOSIN30   PIC X(09)  VALUE "111012470".
      *    ½é¿ÇÎÁ¡ÊÆ±°ìÆü£²²ÊÌÜ¡§¾Ò²ð¾õ¤Ê¤·¡Ë
           03  WRK-CONS-SYOSIN32   PIC X(09)  VALUE "111012610".
      *    ½é¿Ç¡ÊÆ±°ìÆüÊ£¿ô²Ê¼õ¿Ç»þ¤Î£²²ÊÌÜ¡¦ÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  WRK-CONS-SYOSIN33   PIC X(09)  VALUE "111012810".
      *
      *    Ç¥ÉØ»þ´Ö³°²Ã»»¡Ê½é¿Ç¡Ë
           03  WRK-CONS-SYOSIN34   PIC X(09)  VALUE "111012970".
      *    Ç¥ÉØµÙÆü²Ã»»¡Ê½é¿Ç¡Ë
           03  WRK-CONS-SYOSIN35   PIC X(09)  VALUE "111013070".
      *    Ç¥ÉØ¿¼Ìë²Ã»»¡Ê½é¿Ç¡Ë
           03  WRK-CONS-SYOSIN36   PIC X(09)  VALUE "111013170".
      *    Ç¥ÉØ»þ´Ö³°ÆÃÎã°åÎÅµ¡´Ø²Ã»»¡Ê½é¿Ç¡Ë
           03  WRK-CONS-SYOSIN37   PIC X(09)  VALUE "111013270".
      *    Ç¥ÉØ²Ã»»¡Ê½é¿Ç¡Ë
           03  WRK-CONS-SYOSIN38   PIC X(09)  VALUE "111013370".
      *    Ç¥ÉØÌë´Ö²Ã»»¡Ê»º²ÊËô¤Ï»ºÉØ¿Í²Ê½é¿Ç¡Ë
           03  WRK-CONS-SYOSIN39   PIC X(09)  VALUE "111013470".
      *    Ç¥ÉØµÙÆü²Ã»»¡Ê»º²ÊËô¤Ï»ºÉØ¿Í²Ê½é¿Ç¡Ë
           03  WRK-CONS-SYOSIN40   PIC X(09)  VALUE "111013570".
      *    Ç¥ÉØ¿¼Ìë²Ã»»¡Ê»º²ÊËô¤Ï»ºÉØ¿Í²Ê½é¿Ç¡Ë
           03  WRK-CONS-SYOSIN41   PIC X(09)  VALUE "111013670".
      *    µ¡Ç½¶¯²½²Ã»»¡Ê½é¿Ç¡Ë
           03  WRK-CONS-SYOSIN42   PIC X(09)  VALUE "111013770".
      *
      *    ½é¿Ç¡ÊÂ¾°åÎÅµ¡´Ø¤«¤é¤Î¾Ò²ð¾õ¤¬¤Ê¤¤´µ¼Ô¡Ë
           03  WRK-CONS-SYOSIN101  PIC X(09)  VALUE "111012510".
      *    ½é¿Ç¡ÊÂÅ·ëÎ¨£µ³ä°Ê²¼¡Ë
           03  WRK-CONS-SYOSIN102  PIC X(09)  VALUE "111012710".
      *    ÅÅ»Ò²½²Ã»»
           03  WRK-CONS-SYOSIN103  PIC X(09)  VALUE "111012370".
      *    ½é¿ÇÎÁ¡Ê¿··¿¥³¥í¥Ê¥¦¥¤¥ë¥¹´¶À÷¾É¡¦¿ÇÎÅÊó½·¾åÎ×»þÅª¼è°·¡Ë
           03  WRK-CONS-SYOSIN104  PIC X(09)  VALUE "111013850".
      *
      *    ³°Íè¿×Â®¸¡ÂÎ¸¡ºº²Ã»»
           03  WRK-CONS-GAIJINKEN      PIC X(09)   VALUE 
                                                   "160177770".
           03  WRK-CONS-GAIJINKEN-N    PIC 9(09)   VALUE 
                                                   160177770.
      *    Ç¢°ìÈÌ
           03  WRK-CONS-NYOIPPAN-N     PIC 9(09)   VALUE 
                                                   160000310.
      *    ¸¡ºº¤Î²ó¿ô¤Ë½¸·×¤·¤Ê¤¤¿ÇÎÅ¹Ô°Ù
      *    ºÎ·ì¡Ê£Â¡Ý£Á¡Ë
           03  WRK-CONS-SAIKETSU1      PIC X(09)   VALUE "160101210".
      *    ºÎ·ì¡Ê£Â¡Ý£Ö¡Ë
           03 WRK-CONS-SAIKETSU2       PIC X(09)   VALUE "160095710".
      *    ºÎ·ì¡Ê£Â¡Ý£Ã¡Ë
           03 WRK-CONS-SAIKETSU3       PIC X(09)   VALUE "160095810".
      *
      *    ¥Õ¥£¥ë¥àÎÁ¡ÊÆýÍÄ»ù¡Ë²Ã»»
           03  WRK-CONS-FILM-YOUJI-KASAN
                                       PIC X(09)   VALUE 
                                                   "799990070".
      *    »ÀÁÇÊäÀµÎ¨
           03  WRK-CONS-SANSO          PIC X(09)   VALUE 
                                                   "770020070".
      *    ¹âµ¤°µ»ÀÁÇ²Ã»»
           03  WRK-CONS-SANSO2         PIC X(09)   VALUE 
                                                   "770030070".
      *
           COPY    "MCPAREA".
      *
           COPY    "COMMON-SPA".
      *
      *****************************************************************
      *    ¥Õ¥¡¥¤¥ë¥ì¥¤¥¢¥¦¥È
      *****************************************************************
      *
      *    ¥¸¥ç¥Ö´ÉÍý¥Þ¥¹¥¿
       01  JOBKANRI-REC.
           COPY    "CPJOBKANRI.INC".
      *
      *****************************************************************
      *    ¥µ¥Ö¥×¥íÍÑÎÎ°è
      *****************************************************************
      *   ¥¸¥ç¥Ö´ÉÍý£Ä£ÂÀ©¸æ¥µ¥Ö
           COPY    "CPORCSJOBKANRI.INC".
      *     
      *    ¿ôÃÍÊÑ´¹¥µ¥Ö
           COPY    "CPORCSNUM.INC".
      *
           COPY    "CPORCSGETTEMP.INC".
      *
      *    £Ä£Â¸¡º÷
           COPY    "MCPDATA.INC".
      *
      ****************************************************************
       LINKAGE                 SECTION.
       01  COMMAND-PARAM.
           02  FILLER      PIC X(256).
      ****************************************************************
       PROCEDURE           DIVISION
               USING
           COMMAND-PARAM.
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       000-PROC-SEC                SECTION.
      *
           PERFORM 100-INIT-SEC
      *
           PERFORM 200-MAIN-SEC
                   UNTIL       SPA-STS     =   2
      *
           PERFORM 300-END-SEC
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
               STOP    RUN
           ELSE
               EXIT    PROGRAM
           END-IF 
           .
      *****************************************************************
      *    ½é´ü¡¡½èÍý
      *****************************************************************
       100-INIT-SEC                SECTION.
      *
           INITIALIZE                  SPA-AREA
           INITIALIZE                  FLG-AREA
           INITIALIZE                  STS-AREA
           INITIALIZE                  WRK-AREA
           INITIALIZE                  CNT-AREA
           INITIALIZE                  TBL-ZAI-AREA
           INITIALIZE                  WRK-ZAIW-AREA
      *
      *
           UNSTRING    COMMAND-PARAM   DELIMITED  BY  ","
                                       INTO    WRK-PARA
                                               WRK-PARA-PRTKBN
                                               WRK-PARA-HOSPNUM
                                               RECEERR
           END-UNSTRING
           MOVE    WRK-PARA-HOSPNUM    TO  SPA-HOSPNUM
      *
           INITIALIZE                      SGETTEMP-AREA
           MOVE    RECEERR             TO  SGETTEMP-BASENAME
           CALL    "ORCSGETTEMP"       USING   SGETTEMP-AREA
           MOVE    SPACE               TO  RECEERR
           MOVE    SGETTEMP-FULLNAME   TO  RECEERR
      *
           MOVE    "RECE700"           TO  RECEDAT1PARA-FILE-ID
           PERFORM 800-FILENM-SET-SEC
           MOVE    TEMPFLPARA          TO  RECE200PARA
      *
           MOVE    "RECE722"           TO  RECEDAT1PARA-FILE-ID
           PERFORM 800-FILENM-SET-SEC
           MOVE    TEMPFLPARA          TO  RECE220PARA
      *
           MOVE    "RECE732"           TO  RECEDAT1PARA-FILE-ID
           PERFORM 800-FILENM-SET-SEC
           MOVE    TEMPFLPARA          TO  RECE230PARA
      *
           MOVE    "RECE740"           TO  RECEDAT1PARA-FILE-ID
           PERFORM 800-FILENM-SET-SEC
           MOVE    TEMPFLPARA          TO  RECE240PARA
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *        £Ä£Â¥ª¡¼¥×¥ó½èÍý
               PERFORM 120-DBOPEN-SEC
      *
      *        ¥¹¥Æ¥Ã¥×´ÉÍý³«»Ï½èÍý
               MOVE    "STS"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               MOVE    "ORCR1260"      TO  JOB-PGID
               MOVE    "Å¦Í×ÍóÊÔ½¸"    TO  JOB-SHELLMSG
               PERFORM   900-CALL-ORCSJOB-SEC
      *        ½èÍýÃæ»ßÀßÄê½èÍý
               PERFORM 500-CANCEL-HENSYU-SEC
           END-IF
      *
           OPEN    I-O                 RECE200-FILE
           OPEN    INPUT               RECE220-FILE
                                       RECE230-FILE
      *
           OPEN    OUTPUT              RECE240-FILE
           CLOSE                       RECE240-FILE
           OPEN    I-O                 RECE240-FILE
      *
           PERFORM 990-RECE200-READ-SEC
           .
       100-INIT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¼ç¡¡¡¡½èÍý
      *****************************************************************
       200-MAIN-SEC                SECTION.
      *
      *        ¹Ô¥«¥¦¥ó¥¿½é´ü²½
           MOVE    ZERO                TO  WRK-LINENUM
      *    ¸¡ºº²ó¿ô½é´ü²½
           MOVE    ZERO                TO  WRK-KENSA-KAISU
      *
           MOVE    ZERO                TO  WRK-GAIJINKEN-ZAINUM
           INITIALIZE                      WRK-RECE220-TABLE
                                           WRK-RECE220-MAX 
                                           WRK-SUM-KAISU-TABLE
                                           WRK-KENSA-MATOME-TABLE
                                           WRK-KENSA-MATOME-MAX
                                           WRK-MIN-KAISU-TABLE
                                           WRK-KENTAIKASAN-TABLE
      *
           INITIALIZE                      TBL-SORT11-INF
      *
      *    ³°Íè¿×Â®¸¡ÂÎ¸¡ºº²Ã»»»»ÄêÆü¤ò³ÎÇ§
      ***  IF      RECE200-KENTAIKASANFLG     =   '1'
      ***      PERFORM 2009-KENTAIKASAN-KAKUNIN-SEC
      ***  END-IF
      *
      *    ¥Ñ¥é¥á¡¼¥¿£°£´¥Õ¥¡¥¤¥ë¤è¤êÊÔ½¸
           INITIALIZE                      RECE220-REC
           MOVE    RECE200-KEY         TO  RECE220-KEY1
           MOVE    ZERO                TO  RECE220-ZAINUM
      *
           START   RECE220-FILE
               KEY IS    >=   RECE220-KEY
               INVALID
                   MOVE    1           TO  FLG-RECE220
               NOT INVALID
                   PERFORM 990-RECE220-NEXT-SEC
           END-START
           PERFORM
               UNTIL  ( SPA-STS              =   2            )
               OR     ( FLG-RECE220          =   1            )
               OR     ( RECE200-KEY      NOT =   RECE220-KEY1 )
      *
               MOVE    ZERO                  TO  FLG-SRYCD1
               MOVE    ZERO                  TO  FLG-NG
      *
               INITIALIZE                      WRK-ZAIW-AREA
               MOVE    ZERO                TO  WRK-ZAIWMAX-G
               MOVE    ZERO                TO  WRK-TBLMAX
               MOVE    ZERO                TO  FLG-TEIGEN
                                               FLG-COMMENT
                                               FLG-COMMENT2
                                               FLG-COMMENT3
                                               FLG-HIKAKIN
                                               FLG-GAIJINKEN
               MOVE    ZERO                TO  WRK-RECE230
                                               IDY
               MOVE    SPACE               TO  WRK-SRYSYUKBN
      *
               PERFORM 2002-TBLZAIW-TAIHI-SEC
      *
               IF      SPA-STS          =   ZERO
      *            ¥ì¥»¥×¥È£°£´ºÞÊÔ½¸Á°½èÍý
                   PERFORM 2001-RECE220-ZAIHEN-MAE-SEC
      *
      *            ¥ì¥»¥×¥È£°£´¥Õ¥¡¥¤¥ëÊÔ½¸½èÍý
                   EVALUATE    RECE220-SRYKBN
      *                ½é¿Ç
                       WHEN    "11"
                           PERFORM 2003-SRYKBN11-HENSYU-SEC
      *                ¸¡ºº
                       WHEN    "60"
                       WHEN    "64"
                           PERFORM 2006-SRYKBN60-CHECK-SEC 
      *                ¤½¤ì°Ê³°
                       WHEN    OTHER
                           PERFORM 2005-SRYKBNELSE-HENSYU-SEC
                   END-EVALUATE
      *
                   ADD     1               TO  CNT-RECE220
      *
                   PERFORM 990-RECE220-NEXT-SEC
      *
      *            ½èÍýÃæ»ßÀßÄê½èÍý
                   IF      CNT-IN-CANCEL       =   50
                       MOVE    ZERO                TO  CNT-IN-CANCEL
                       PERFORM 500-CANCEL-HENSYU-SEC
                   END-IF
               END-IF     
           END-PERFORM
      *
           IF      SPA-STS             =   ZERO
      *        ¸¡ºº¤¬¤¢¤ë¤È¤­¤Þ¤È¤á¤ë
               IF      WRK-RECE220-MAX          >   ZERO
                   PERFORM 2007-SRYKBN60-HENSYU-SEC
               END-IF         
      *
      *        ¸¡ºº¤Î¤È¤­²ó¿ô¤òÊÔ½¸¤¹¤ë
               IF      WRK-KENSA-KAISU        >   ZERO
                   MOVE    WRK-KENSA-KAISU        TO  RECE200-KAISU (16)
               END-IF
      *
      *        ½é¿Ç¡¦ºÆ¿Ç¤ÎºÞ¤Þ¤È¤áÊÔ½¸
               MOVE    ZERO      TO    FLG-TEIGEN
               PERFORM  VARYING  IDX6   FROM   1   BY  1
                         UNTIL   IDX6    >     4
                 IF      TBL-SORT11-FLG(IDX6)  =   1
                   PERFORM 2010-SYOSAIMATOME-HENSYU1-SEC
                 END-IF
               END-PERFORM
      *
               REWRITE RECE200-REC
      *
               PERFORM 990-RECE200-READ-SEC
           END-IF
      *
           .
       200-MAIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥È£°£´¤è¤êºÞÊÔ½¸Á°½èÍý
      *****************************************************************
       2001-RECE220-ZAIHEN-MAE-SEC     SECTION.
      *
           MOVE    SPACE               TO  WRK-ZAI
           MOVE    "¡ö"                TO  WRK-ZAI-MK
      *    ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È
           MOVE    RECE220-ZAITEN       TO  WRK-ZAITENX
           MOVE    RECE220-ZAIKAISU     TO  WRK-ZAIKAISUX
      *    É¬Í×Í­¸ú·å¿ô¡¦³«»Ï°ÌÃÖ¡¦²ó¿ôÊÔ½¸
           PERFORM 810-TENSUKAI-HEN-SEC
      *
           .
       2001-RECE220-ZAIHEN-MAE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÞ¡¡ÌÀºÙ¥Æ¡¼¥Ö¥ëÂàÈò½èÍý
      *****************************************************************
       2002-TBLZAIW-TAIHI-SEC    SECTION.
      *
      *    ¥Ñ¥é¥á¡¼¥¿£°£µ¥Õ¥¡¥¤¥ë¤è¤êÊÔ½¸
           INITIALIZE                      RECE230-REC
           MOVE    RECE220-KEY1        TO  RECE230-KEY1
           MOVE    RECE220-ZAINUM      TO  RECE230-ZAINUM
           START   RECE230-FILE
               KEY IS    >=   RECE230-KEY
               INVALID
                   MOVE    1           TO  FLG-RECE230
               NOT INVALID
                   PERFORM 990-RECE230-NEXT-SEC
           END-START
           PERFORM
               UNTIL  ( SPA-STS              =   2              )
               OR     ( FLG-RECE230          =   1              )
               OR     ( RECE220-KEY1     NOT =   RECE230-KEY1   )
               OR     ( RECE220-ZAINUM   NOT =   RECE230-ZAINUM )
      *
               PERFORM   VARYING   IDX   FROM    1   BY  1
                         UNTIL   ( IDX                >   5     )
                         OR      ( RECE230-SRYCD(IDX) =   SPACE )
                         OR      ( SPA-STS            =   2     )
      *
                 IF        RECE230-RECEPTFLG(IDX)     =   SPACE
      *
                   IF      RECE230-SRYCD (IDX) (1:1)  =   "1"
                       IF      RECE230-DATAKBN(IDX)         =   "2"
                           MOVE    1                 TO  FLG-SRYCD1
                       END-IF
                   ELSE
                       MOVE    1                     TO  FLG-SRYCD1
                   END-IF
      *
                   IF   (RECE220-SRYKBN     = "90" OR "92")
                   AND  (RECE230-SRYCD(IDX) =  "000000000")
                       MOVE    1                     TO  FLG-NG
                   END-IF
      *                     
                   IF      RECE220-SRYKBN     <   "31"
                       MOVE    1             TO  IDY
                   ELSE                          
                    IF     RECE220-ZAIKBN     =    1
                    OR     FLG-NG             =    1
                       MOVE    2             TO  IDY
                    ELSE
      *              ÎÅÍÜÉÂÅï¥ì¥»¥³¥á¥ó¥È¤¬¤¢¤ëºÞ
                     IF    RECE220-RYOTENKISAISU  NOT = ZERO
                       IF    WRK-ZAIWMAX(3) >= RECE220-RYOTENKISAISU
                          MOVE    5          TO  IDY
                       ELSE
                          MOVE    3          TO  IDY
                       END-IF
                     ELSE
                       EVALUATE    RECE230-SRYCD (IDX) (1:1)
                           WHEN    "0"
                               IF      RECE230-SRYCD (IDX) (1:3)
                                                     =  "059" OR "058"
                                     MOVE    4           TO  IDY
                               ELSE
                                 IF    RECE230-SRYCD (IDX) (1:3) = "008"
                                    IF      IDY      =   ZERO
                                        MOVE    2        TO  IDY
                                    END-IF
                                 ELSE
                                    IF      IDY      =   ZERO
                                        MOVE    1        TO  IDY
                                    END-IF
                                 END-IF
                               END-IF
                           WHEN    "8"
                               IF      IDY           =   ZERO
                                   MOVE    2             TO  IDY
                               END-IF
                           WHEN    "1"
                               IF  RECE230-SRYCD(IDX)  =  "199000510"
                                   MOVE    4             TO  IDY
                               ELSE
                                   MOVE    3             TO  IDY
                               END-IF
                           WHEN    "6"
                                   MOVE    5             TO  IDY
                           WHEN    "7"
                                   MOVE    4             TO  IDY
                           WHEN    OTHER
                               DISPLAY "ORCR1260 SRYCD="
                                                 RECE230-SRYCD (IDX) 
                               MOVE    "¿ÇÎÅ¹Ô°Ù¥³¡¼¥É¤¬ÈÏ°Ï³°¤Ç¤¹"
                                                 TO  WRK-RECEERR
                               PERFORM 500-ERR-HENSYU-SEC
                               MOVE    2             TO  SPA-STS
                               GO  TO  2002-TBLZAIW-TAIHI-EXT
                       END-EVALUATE
                     END-IF
                    END-IF
                   END-IF
      *
                   IF      RECE230-KENTAICOMMENT (IDX)   =   1
                       MOVE    RECE230-NAME (IDX)        TO
                                             WRK-KENTAICOMMENT-NAME
                       INSPECT WRK-KENTAICOMMENT-NAME
                               REPLACING  ALL  "¡Ò"  BY  "¡Ê"
                                          ALL  "¡Ó"  BY  "¡Ë"
                       MOVE    RECE230-YUKOKETA (IDX)    TO
                                             WRK-KENTAICOMMENT-YUKOKETA
                       MOVE    RECE230-SRYCD (IDX)       TO
                                             WRK-KENTAICOMMENT-SRYCD
                   ELSE
      *
                     ADD     1                 TO  WRK-ZAIWMAX (IDY)
                                                   WRK-ZAIWMAX (6)
                     IF  ((RECE220-RYOTENKISAISU     =   ZERO    ) AND
                          (WRK-ZAIWMAX (IDY)     >   TBL-ZAI-MAX ))
                     OR  ((RECE220-RYOTENKISAISU NOT =   ZERO    ) AND
                          (WRK-ZAIWMAX (IDY)     >   TBL-ZAI-MAX2))
                       MOVE    "¥Æ¡¼¥Ö¥ë¤¬¥ª¡¼¥Ð¡¼¤·¤Þ¤·¤¿"
                                                 TO  WRK-RECEERR
                       PERFORM 500-ERR-HENSYU-SEC
                       MOVE    2                 TO  SPA-STS
                       GO  TO  2002-TBLZAIW-TAIHI-EXT
                     ELSE
      *                ÀèÆ¬¤Î¿ÇÎÅ¹Ô°Ù¥³¡¼¥ÉÊÔ½¸              
                       IF      WRK-RECE230        =   ZERO
                         IF  ( RECE230-SRYCD(IDX)(1:1)  =  "8"       )
                         OR  ((RECE230-SRYCD(IDX)(1:3)  NOT =  "059")
                                                                  AND
                              (RECE230-SRYCD(IDX)(1:1)  =  "0"      ))
                         OR  ( RECE220-SAFLG       NOT  =  SPACE     )
                         OR  ( RECE220-ZAIKBN           =   1        )
                           CONTINUE
                         ELSE
                           MOVE    RECE230-SRYCD (IDX)
                                                 TO  WRK-ZAIW-SRYCD1 
                           MOVE    RECE230-CDKBN-KBN(IDX)
                                                 TO  WRK-ZAIW-CDKBN-KBN
                           MOVE    RECE230-CDKBN-SYO(IDX)
                                                 TO  WRK-ZAIW-CDKBN-SYO
                           MOVE    RECE230-CDKBN-BU(IDX)
                                                 TO  WRK-ZAIW-CDKBN-BU
                           MOVE    RECE230-CDKBN-KBNNUM(IDX)
                                         TO  WRK-ZAIW-CDKBN-KBNNUM
                           MOVE    RECE230-CDKBN-KBNNUM-EDA(IDX)
                                         TO  WRK-ZAIW-CDKBN-KBNNUM-EDA
                           MOVE    RECE230-CDKBN-KOUBAN(IDX)
                                         TO  WRK-ZAIW-CDKBN-KOUBAN
                           MOVE    RECE230-KOUHYOJYUNNUM(IDX)
                                         TO  WRK-ZAIW-KOUHYOJYUNNUM
                           MOVE    RECE230-KNSJISKBN(IDX)
                                         TO  WRK-ZAIW-KNSJISKBN
                           MOVE    1             TO  WRK-RECE230
                         END-IF
                       END-IF
      *
                       MOVE    RECE230-SRYSYUKBN  TO  WRK-SRYSYUKBN
      *                                                         
                       MOVE    WRK-ZAIWMAX (IDY) TO  IDZ
                       MOVE    RECE230-SRYACTINF (IDX)
                                     TO  TBL-ZAIW-SRYACTINF (IDY IDZ)
                       MOVE    RECE230-NAMEINF   (IDX)
                                     TO  TBL-ZAIW-NAMEINF   (IDY IDZ)
                       IF  RECE230-INGAIFLG-RECE(IDX) = "1"
                         MOVE  RECE230-GENERICNAME(IDX)
                                     TO  TBL-ZAIW-NAME(IDY IDZ)
                         MOVE  RECE230-GENERICYUKOKETA(IDX)
                                     TO  TBL-ZAIW-YUKOKETA(IDY IDZ)
                       END-IF
                       MOVE    RECE230-RECEHENFLG(IDX)
                                     TO  TBL-ZAIW-RECEHENFLG(IDY IDZ)
                       MOVE    RECE230-SRYSYUKBN  TO
                                     TBL-ZAIW-SRYSYUKBN-INPUT(IDY IDZ)
                       IF      WRK-KENTAICOMMENT-SRYCD  NOT =  ZERO
                           STRING  TBL-ZAIW-NAME (IDY IDZ)
                                     DELIMITED   BY  SPACE
                                   WRK-KENTAICOMMENT-NAME
                                     DELIMITED   BY  SPACE
                                   INTO  WRK-KENTAICOMMENT-NAME-TEMP
                           END-STRING
                           MOVE    WRK-KENTAICOMMENT-NAME-TEMP
                                     TO  TBL-ZAIW-NAME (IDY IDZ)
                           COMPUTE TBL-ZAIW-YUKOKETA (IDY IDZ)  =
                                   TBL-ZAIW-YUKOKETA (IDY IDZ)  +
                                   WRK-KENTAICOMMENT-YUKOKETA
                           MOVE    WRK-KENTAICOMMENT-SRYCD      TO
                                  TBL-ZAIW-KENTAICOMMENT-SRYCD (IDY IDZ)
                           MOVE    ZERO          TO
                                     WRK-KENTAICOMMENT-YUKOKETA
                                     WRK-KENTAICOMMENT-SRYCD
                           MOVE    SPACE         TO
                                     WRK-KENTAICOMMENT-NAME
                                     WRK-KENTAICOMMENT-NAME-TEMP
                       END-IF
     *
                       IF      RECE230-SRYCD (IDX) (1:1)
                                                 =   "1"
                       AND     RECE220-SRYKBN     =   "70"
                       AND     RECE230-TANICD(IDX)
                                                 =   WRK-CONS-TANICD
                           MOVE    WRK-CONS-TANINAME TO 
                                         TBL-ZAIW-TANINAME  (IDY IDZ) 
                       END-IF                     
      *
                       IF      RECE230-SRYCD (IDX) (1:1)  =  "7"
                          IF    ( RECE220-SRYKBN     =   "70" )
                          AND   ( RECE230-DATAKBN (IDX)
                                                    =   "3"  )
                            IF  TBL-ZAIW-TANINAME  (IDY IDZ)  
                                                    =   SPACE
                                  MOVE    "¡ö"  TO 
                                         TBL-ZAIW-TANINAME  (IDY IDZ) 
                            END-IF
                          ELSE
                            IF      RECE230-SRYCD (IDX)    =
                                     WRK-CONS-FILM-YOUJI-KASAN  OR
                                     WRK-CONS-SANSO             OR
                                     WRK-CONS-SANSO2
                               CONTINUE
                            ELSE
                               IF  TBL-ZAIW-TANINAME  (IDY IDZ)  
                                                    =   SPACE
                                  MOVE    "¡ö"  TO 
                                         TBL-ZAIW-TANINAME  (IDY IDZ) 
                               END-IF
                            END-IF
                          END-IF
                       END-IF
      *
                       IF      RECE230-SRYCD (IDX) (1:1)  =  "6"
                          IF   RECE230-SRYCD (IDX) (1:2)  =  "63"
                               CONTINUE
                          ELSE
                            IF  TBL-ZAIW-TANINAME  (IDY IDZ)  
                                                    =   SPACE
                                  MOVE    "¡ö"  TO 
                                         TBL-ZAIW-TANINAME  (IDY IDZ) 
                            END-IF
                          END-IF
                       END-IF
      *
      *---- (01.00.05) LINE ADD START --------------------------------
                       IF      RECE230-SRYCD(IDX) =  CONS-COMMENT3   OR
                                                     CONS-COMMENT4   
                           MOVE    1             TO  FLG-COMMENT
                       END-IF 
                       IF      RECE230-SRYCD(IDX) =  CONS-COMMENT5   OR
                                                     CONS-COMMENT6   OR
                                                     CONS-COMMENT7   OR
                                                     CONS-COMMENT8     
                           MOVE    1             TO  FLG-COMMENT2      
                       END-IF                                          
                       IF     (RECE230-SRYCD(IDX)(1:1)   =   "8"  )
                       OR     (RECE230-SRYCD(IDX)(1:3)   =   "008")
                           MOVE    1             TO  FLG-COMMENT3      
                       END-IF                                     
      *---- (01.00.05) LINE ADD END --------------------------------
      *
                       IF      RECE230-SRYCD(IDX) =   CONS-TEIGEN
                                                  OR  CONS-GENTEN
                                                  OR  CONS-GENTEN2
                                                  OR  CONS-GENTEN3
                           MOVE    1             TO  FLG-TEIGEN
                       END-IF
                       IF     (RECE220-SRYKBN     =   "90" OR "92" )
                       AND    (RECE230-SRYCD(IDX) =   CONS-EIYOGEN1
                                                  OR  CONS-EIYOGEN2)
                           MOVE    1             TO  FLG-TEIGEN
                       END-IF
                     END-IF
      *
                   END-IF
      *
                 END-IF
      *
               END-PERFORM
               ADD     1                 TO  CNT-RECE230
      *
               PERFORM 990-RECE230-NEXT-SEC
      *
      *        ½èÍýÃæ»ßÀßÄê½èÍý
               IF      CNT-IN-CANCEL       =   50
                   MOVE    ZERO                TO  CNT-IN-CANCEL
                   PERFORM 500-CANCEL-HENSYU-SEC
               END-IF
           END-PERFORM
      *
           .
       2002-TBLZAIW-TAIHI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ÇÎÅ¶èÊ¬¡Ê£±£±¡ËÊÔ½¸½èÍý
      *****************************************************************
       2003-SRYKBN11-HENSYU-SEC    SECTION.
      *
      *    ºÞ¡¡ÌÀºÙ¥Æ¡¼¥Ö¥ë¥Á¥§¥Ã¥¯
           INITIALIZE                    TBL-ZAI-AREA
           MOVE    ZERO              TO  WRK-TBLMAX
           MOVE    ZERO              TO  WRK-TENSUGOKEI
      *
           PERFORM VARYING IDX1    FROM    1   BY  1
                   UNTIL   IDX1    >       1  
               PERFORM VARYING IDX2    FROM    1   BY  1
                         UNTIL IDX2    >   WRK-ZAIWMAX (IDX1)  
                   MOVE    IDX1          TO  WRK-WIDX1
                   MOVE    IDX2          TO  WRK-WIDX2
                   PERFORM 20031-SRYKBN11-CHECK-SEC
                   IF  FLG-NOPRT         =   ZERO
      *            ¥ì¥»¥×¥È£°£µºÞÊÔ½¸½èÍý
                       PERFORM 430-TBLZAI-HEN-SEC
                   END-IF
               END-PERFORM
           END-PERFORM    
      *
           IF  WRK-TBLMAX           >   ZERO
               IF  WRK-TBLMAX       NOT =   RECE220-MEISAISU
                   PERFORM 400-TENSU-SAIKEISAN-SEC
               END-IF
      *        ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È½èÍý
               MOVE    WRK-TBLMAX       TO  IDY
               PERFORM 440-TNSKAI-SET-SEC
               MOVE    IDY              TO  WRK-TBLMAX
      *        ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë½ÐÎÏ½èÍý
               PERFORM 450-RECE240-OUT-SEC
           END-IF
      *
           .
       2003-SRYKBN11-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÌÀºÙ°õ»ú¥Á¥§¥Ã¥¯ ¿ÇÎÅ¶èÊ¬¡Ê£±£±¡Ë ½èÍý
      *****************************************************************
       20031-SRYKBN11-CHECK-SEC        SECTION.
      * 
           MOVE    ZERO          TO  FLG-NOPRT
      *
      *    ÉþÍÑÊýË¡¤Ç¤Ê¤¤¤³¤È
           IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:3)   =   "001"
               MOVE    1             TO  FLG-NOPRT
           END-IF
      *
      *    ½é¿Ç²Ã»»¤Î»þ¤À¤±°õºþ¡Ü¸¡¿Ç
           IF   RECE220-JIHOKBN  =  SPACE
             IF  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)
                                            =   WRK-CONS-SYOSIN1
                                            OR  WRK-CONS-SYOSIN2
                                            OR  WRK-CONS-SYOSIN5
                                            OR  WRK-CONS-SYOSIN6
                                            OR  WRK-CONS-SYOSIN7
                                            OR  WRK-CONS-SYOSIN8
                                            OR  WRK-CONS-SYOSIN9
                                            OR  WRK-CONS-SYOSIN10
                                            OR  WRK-CONS-SYOSIN11
                                            OR  WRK-CONS-SYOSIN12
                                            OR  WRK-CONS-SYOSIN13
                                            OR  WRK-CONS-SYOSIN14
                                            OR  WRK-CONS-SYOSIN15
                                            OR  WRK-CONS-SYOSIN16
                                            OR  WRK-CONS-SYOSIN17
                                            OR  WRK-CONS-SYOSIN18
                                            OR  WRK-CONS-SYOSIN19
                                            OR  WRK-CONS-SYOSIN20
                                            OR  WRK-CONS-SYOSIN21
                                            OR  WRK-CONS-SYOSIN22
                                            OR  WRK-CONS-SYOSIN23
                                            OR  WRK-CONS-SYOSIN24
                                            OR  WRK-CONS-SYOSIN25
                                            OR  WRK-CONS-SYOSIN26
                                            OR  WRK-CONS-SYOSIN27
                                            OR  WRK-CONS-SYOSIN28
                                            OR  WRK-CONS-SYOSIN30
                                            OR  WRK-CONS-SYOSIN32
                                            OR  WRK-CONS-SYOSIN33
                                            OR  WRK-CONS-SYOSIN34
                                            OR  WRK-CONS-SYOSIN35
                                            OR  WRK-CONS-SYOSIN36
                                            OR  WRK-CONS-SYOSIN37
                                            OR  WRK-CONS-SYOSIN38
                                            OR  WRK-CONS-SYOSIN39
                                            OR  WRK-CONS-SYOSIN40
                                            OR  WRK-CONS-SYOSIN41
                                            OR  WRK-CONS-SYOSIN42
                                            OR  CONS-COMMENT5         
                                            OR  CONS-COMMENT6         
                                            OR  CONS-COMMENT7         
                                            OR  CONS-COMMENT8         )
             OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:1)  = "8" AND    
                  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)   
                                                     NOT = "830000020")
             OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:3)  = "008"  )
                   CONTINUE
             ELSE
                   MOVE    1                 TO  FLG-NOPRT
             END-IF
           END-IF
      *
      *    ¼±ÊÌ¤¬ÅÀ¿ô¤Î¾ì¹ç
           IF  FLG-NOPRT                     =   ZERO
               IF      TBL-ZAIW-TENSIKIBETU (WRK-WIDX1 WRK-WIDX2)
                                             =   3
                   ADD     TBL-ZAIW-TEN (WRK-WIDX1 WRK-WIDX2)
                                             TO  WRK-TENSUGOKEI
               END-IF
           END-IF
      *
           IF   RECE220-JIHOKBN  =  SPACE
            IF TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2) =
                                            WRK-CONS-SYOSIN101  OR
                                            WRK-CONS-SYOSIN102  OR
                                            WRK-CONS-SYOSIN103  OR
                                            WRK-CONS-SYOSIN104
      *
               EVALUATE  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)
                 WHEN      WRK-CONS-SYOSIN103
                     MOVE   1    TO   IDX6
                 WHEN      WRK-CONS-SYOSIN104
                     MOVE   2    TO   IDX6
                 WHEN      WRK-CONS-SYOSIN101
                     MOVE   3    TO   IDX6
                 WHEN      WRK-CONS-SYOSIN102
                     MOVE   4    TO   IDX6
               END-EVALUATE
      *
               MOVE     1             TO  TBL-SORT11-FLG(IDX6)
               MOVE  TBL-ZAIW-TEN (WRK-WIDX1 WRK-WIDX2)
                                      TO  TBL-SORT11-TEN(IDX6)
               MOVE  TBL-ZAIW-YUKOKETA(WRK-WIDX1 WRK-WIDX2)
                                      TO  TBL-SORT11-YUKOKETA(IDX6)
               MOVE  TBL-ZAIW-NAME(WRK-WIDX1 WRK-WIDX2)
                                      TO  TBL-SORT11-NAME(IDX6)
               ADD   RECE220-ZAIKAISU TO  TBL-SORT11-ZAIKAISU(IDX6)
               MOVE  RECE220-HKNCOMBI TO  TBL-SORT11-HKNCOMBI(IDX6)
      *
            END-IF
           END-IF
      *
           .
       20031-SRYKBN11-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥È£°£´¥Õ¥¡¥¤¥ë  ¿ÇÎÅ¶èÊ¬¡Ê¤½¤ÎÂ¾¡ËÊÔ½¸½èÍý
      *****************************************************************
       2005-SRYKBNELSE-HENSYU-SEC    SECTION.
      *
      *    ¸¡ºº¤Î¤È¤­ºÞ¤¬°ì¤Ä°Ê¾å¤Ê¤é¡É¡¢¡É¤ÇÊÔ½¸
           IF  RECE220-SRYKBN         =   "60" OR "64"
               PERFORM 20051-SRYKBNELSE-KENSA-SEC
           ELSE 
               PERFORM 20052-SRYKBNELSE-CHECK-SEC
           END-IF
      *
           IF  WRK-TBLMAX           >   ZERO
               IF      RECE220-SRYKBN      >=  "33"                      
               AND     RECE220-ZAIKBN   NOT =   1
               AND     RECE220-JIHOKBN      =   SPACE
                   CONTINUE
               ELSE        
                   MOVE    WRK-TBLMAX       TO  IDY
                   PERFORM 440-TNSKAI-SET-SEC
                   MOVE    IDY              TO  WRK-TBLMAX
               END-IF    
      *        ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë½ÐÎÏ½èÍý
               PERFORM 450-RECE240-OUT-SEC
           END-IF
      *
           .
       2005-SRYKBNELSE-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÞ¡¡ÌÀºÙ¥Æ¡¼¥Ö¥ëÊÔ½¸¡¡ ¿ÇÎÅ¶èÊ¬¡Ê¤½¤ÎÂ¾¡Ë¸¡ºº¤Î¤È¤­½èÍý
      *****************************************************************
       20051-SRYKBNELSE-KENSA-SEC      SECTION.
      *
           MOVE    WRK-ZAIWMAX (3)     TO  WRK-KENSA-MAX
           MOVE    ZERO                TO  WRK-TNS-HOUKNSKBN
                                           WRK-KOUMOKUSU
      *     
           PERFORM VARYING IDX FROM    1   BY  1
                   UNTIL   IDX >       WRK-ZAIWMAX (3)
               IF    ( TBL-ZAIW-HOUKNSKBN(3 IDX) =   11   )
               AND   ( TBL-ZAIW-KZMCOMPSIKIBETU  (3 IDX)
                                                 >   ZERO ) 
      *            ¿ôÎÌÊÔ½¸
                   MOVE    3               TO  WRK-WIDX1
                   MOVE    IDX             TO  WRK-WIDX2
                   PERFORM 4301-SURYO-HEN1-SEC
                   MOVE    SPACE           TO  TBL-NAME (IDX)
                   STRING  TBL-ZAIW-NAME     (3 IDX)
                                              DELIMITED  BY  SPACE
                           "¡Ê"               DELIMITED  BY  SIZE
                           WRK-SRYSURYOW      DELIMITED  BY  SPACE
                           TBL-ZAIW-TANINAME(3 IDX)
                                              DELIMITED  BY  SPACE
                           "¡Ë"               DELIMITED  BY  SIZE
                           INTO               TBL-NAME (IDX)
                   END-STRING
                   MOVE    ZERO               TO  TBL-YUKOKETA (IDX)
                   MOVE    SPACE   TO   TBL-ZAIW-TANINAME(3 IDX)
               ELSE
                   MOVE    TBL-ZAIW-NAMEINF (3 IDX)
                                              TO  TBL-NAMEINF (IDX)
               END-IF
               MOVE    TBL-ZAIW-SRYSURYO(3 IDX)  TO  TBL-SRYSURYO(IDX)
               MOVE    TBL-ZAIW-TANICD  (3 IDX)  TO  TBL-TANICD  (IDX)
               MOVE    TBL-ZAIW-TANIMOJISU(3 IDX)
                                             TO  TBL-TANIMOJISU(IDX)
               MOVE    TBL-ZAIW-TANINAME(3 IDX)  TO  TBL-TANINAME(IDX)
               MOVE    TBL-ZAIW-SRYCD   (3 IDX)  TO  TBL-SRYCD   (IDX)
               MOVE    TBL-ZAIW-DATAKBN (3 IDX)  TO  TBL-DATAKBN (IDX)
               MOVE    TBL-ZAIW-HOUKNSKBN(3 IDX) TO  TBL-HOUKNSKBN(IDX)
               IF      TBL-YUKOKETA (IDX)      =   ZERO
                   PERFORM VARYING IDZ FROM   300 BY  -1
                           UNTIL   IDZ <      1
                       IF      TBL-NAME (IDX) (IDZ:1)    NOT =   SPACE
                           COMPUTE TBL-YUKOKETA (IDX)    =
                                   IDZ     /   2
                           MOVE    1          TO  IDZ
                       END-IF
                   END-PERFORM
               END-IF             
           END-PERFORM
      *
           COMPUTE WRK-ZAIWMAX (6)   =   WRK-ZAIWMAX  (6)     -   
                                         WRK-ZAIWMAX  (3) 
           INITIALIZE                    TBL-ZAIW-OCC (3)
           MOVE    ZERO              TO  WRK-ZAIWMAX  (3)
      *
      *    ºÞ¤¬°ì¤Ä°Ê¾å¤Î¤È¤­¡Ç¡¢¡Ç¤ÇÌ¾¾Î¤òÊÔ½¸¤¹¤ë
      *
           MOVE    1                 TO  IDX
               
           PERFORM UNTIL   IDX     >       WRK-KENSA-MAX
               IF      TBL-HOUKNSKBN(IDX)   =   ZERO
               OR      FLG-SRYCD1           =    1
                   IF     (TBL-HOUKNSKBN(IDX)  NOT =  ZERO)
                   AND    (FLG-SRYCD1              =   1  )
                     IF    IDX  =   1
                       MOVE  TBL-HOUKNSKBN(IDX)  TO  WRK-TNS-HOUKNSKBN
                     END-IF
                     IF  TBL-DATAKBN (IDX)   NOT =   "2"
                       ADD     1                 TO  WRK-KOUMOKUSU
                     END-IF
                   END-IF
                   ADD     1                        TO  WRK-ZAIWMAX (3)
                   MOVE    WRK-ZAIWMAX (3)          TO  IDZ
                   MOVE    TBL-NAMEINF (IDX)   TO
                                    TBL-ZAIW-NAMEINF (3 IDZ)
                   MOVE    TBL-SRYSURYO(IDX)   TO
                                    TBL-ZAIW-SRYSURYO(3 IDZ)
                   MOVE    TBL-TANICD  (IDX)   TO
                                    TBL-ZAIW-TANICD  (3 IDZ)
                   MOVE    TBL-TANIMOJISU(IDX) TO
                                    TBL-ZAIW-TANIMOJISU(3 IDZ)
                   MOVE    TBL-TANINAME(IDX)   TO
                                    TBL-ZAIW-TANINAME(3 IDZ)
                   MOVE    TBL-SRYCD   (IDX)   TO
                                    TBL-ZAIW-SRYCD   (3 IDZ)
                   MOVE    TBL-DATAKBN (IDX)   TO
                                    TBL-ZAIW-DATAKBN (3 IDZ)
                   MOVE    TBL-HOUKNSKBN(IDX)  TO
                                    TBL-ZAIW-HOUKNSKBN(3 IDZ)
                   IF      (FLG-GAIJINKEN  =   1) 
                     AND   (TBL-SRYCD (IDX)(1:1)
                                       NOT =   "8")
                     AND   (TBL-SRYCD (IDX)(1:3)
                                       NOT =   "008")
                           PERFORM 200511-GJK-DAY-ADD-SEC
                   END-IF
                   ADD     1                   TO  IDX
               ELSE
                   IF      IDX             =   1
                       MOVE    TBL-HOUKNSKBN(IDX)
                                           TO  WRK-TNS-HOUKNSKBN         
                   END-IF                                
                   MOVE    ZERO            TO  WRK-YUKOKETA
                   MOVE    SPACE           TO  WRK-NAME
                   MOVE    TBL-SRYCD (IDX) TO  WRK-SRYCD
                   PERFORM     UNTIL   IDX >       WRK-KENSA-MAX
                               OR      TBL-SRYCD (IDX) (1:1)
                                           NOT =   WRK-SRYCD
      *                ¼¡¤ÎÌ¾¾Î¤¬¤¢¤ë¤È¤­¡É¡¢¡É¡ÜÌ¾¾Î¤ò¤Ä¤±¤ë
                       IF      WRK-YUKOKETA    >   ZERO
                           STRING  WRK-NAME    DELIMITED  BY  SPACE
                                   "¡¤"        DELIMITED  BY  SIZE
                                   INTO        WRK-NAME
                           END-STRING        
                           ADD     2           TO  WRK-YUKOKETA
      *              
                           COMPUTE IDZ     =   WRK-YUKOKETA        +
                                               TBL-YUKOKETA (IDX)  *  2
                           IF      IDZ             >   38
                               ADD     1               TO
                                                   WRK-ZAIWMAX (3)
                               MOVE    WRK-ZAIWMAX (3) TO  IDZ
                               MOVE    WRK-NAME        TO
                                           TBL-ZAIW-NAME(3 IDZ)
                               COMPUTE TBL-ZAIW-YUKOKETA (3 IDZ) 
                                           =   WRK-YUKOKETA   /   2  
                               MOVE    SPACE           TO  WRK-NAME
                               MOVE    ZERO            TO  WRK-YUKOKETA
                           END-IF
                       END-IF
      *
                       IF      TBL-YUKOKETA (IDX)  >   19
                           ADD     1               TO  WRK-ZAIWMAX (3)
                           MOVE    WRK-ZAIWMAX (3) TO  IDZ
                           MOVE    TBL-NAME (IDX) (1:38)   TO
                                       TBL-ZAIW-NAME    (3 IDZ)
                           MOVE    19                      TO  
                                       TBL-ZAIW-YUKOKETA(3 IDZ)
                           MOVE    TBL-NAME (IDX) (39:)    TO  WRK-NAME
                           COMPUTE WRK-YUKOKETA    =  
                                   ( TBL-YUKOKETA (IDX) -   19 )  *   2                                           
                       ELSE
                           STRING  WRK-NAME        DELIMITED  BY  SPACE
                                   TBL-NAME    (IDX)
                                                   DELIMITED  BY  SPACE
                                   INTO            WRK-NAME
                           END-STRING
                           COMPUTE WRK-YUKOKETA =  WRK-YUKOKETA   +
                                       TBL-YUKOKETA (IDX)  *   2
                       END-IF
      *                 
                       IF      TBL-DATAKBN (IDX)   NOT =   "2"
                           ADD     1           TO  WRK-KOUMOKUSU 
                       END-IF
                       ADD     1           TO  IDX
                   END-PERFORM                            
                   ADD     1               TO  WRK-ZAIWMAX (3)
                   MOVE    WRK-ZAIWMAX (3) TO  IDZ
                   MOVE    WRK-NAME    TO  TBL-ZAIW-NAME (3 IDZ)
                   COMPUTE TBL-ZAIW-YUKOKETA (3 IDZ) 
                                       =   WRK-YUKOKETA   /   2
                   IF      (FLG-GAIJINKEN  =   1) 
                           PERFORM 200512-GJK-DAY-ADD-SEC
                   END-IF
               END-IF
           END-PERFORM
      *
      *    ¸¡ºº¤Î¹àÌÜ¿ô¤ò¥³¥á¥ó¥È¤Ë¥»¥Ã¥È
           IF      WRK-TNS-HOUKNSKBN  >   ZERO
               INITIALIZE                 WRK-CHAR-HENKAN-AREA
               MOVE    1                  TO  WRK-CHAR-FLG
               MOVE    WRK-KOUMOKUSU      TO  WRK-Z9
               MOVE    WRK-Z9 (3:2)       TO  WRK-CHAR-X
               MOVE    2                  TO  WRK-CHAR-CNT
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               ADD     1                  TO  WRK-ZAIWMAX (2)
                                              WRK-ZAIWMAX (6)
               MOVE    WRK-ZAIWMAX (2)    TO  IDZ   
               IF      WRK-TNS-HOUKNSKBN  =   11
                   MOVE    WRK-CONS-KENSACOMMENT (WRK-TNS-HOUKNSKBN)
                                          TO    TBL-ZAIW-NAME (2 IDZ)
               ELSE
                   STRING  WRK-CONS-KENSACOMMENT (WRK-TNS-HOUKNSKBN)
                                              DELIMITED  BY  SPACE
                           "¡Ê"               DELIMITED  BY  SIZE
                           WRK-CHAR-N         DELIMITED  BY  SPACE
                           "¹àÌÜ¡Ë"           DELIMITED  BY  SIZE
                                          INTO    TBL-ZAIW-NAME (2 IDZ)
                   END-STRING
               END-IF
               PERFORM VARYING IDX FROM   300 BY  -1
                       UNTIL   IDX <      1
                   IF      TBL-ZAIW-NAME (2 IDZ) (IDX:1)
                                              NOT =   SPACE
                       COMPUTE TBL-ZAIW-YUKOKETA (2 IDZ)    =
                                                  IDX     /   2
                       MOVE    1          TO  IDX
                   END-IF
               END-PERFORM
               MOVE    "88888888"         TO  TBL-ZAIW-SRYCD(2 IDZ)
           END-IF                                    
      *
           COMPUTE WRK-ZAIWMAX (6)   =   WRK-ZAIWMAX  (6)     +   
                                         WRK-ZAIWMAX  (3) 
           MOVE    WRK-ZAIW-SRYCD1   TO  TBL-ZAIW-SRYCD (3 1) 
      *
           PERFORM 20052-SRYKBNELSE-CHECK-SEC
           .
       20051-SRYKBNELSE-KENSA-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³°Íè¿×Â®¸¡ÂÎ¸¡ºº²Ã»»»»ÄêÆüÊÔ½¸½èÍý
      *****************************************************************
       200511-GJK-DAY-ADD-SEC          SECTION.
      *
           INITIALIZE                  WRK-CHAR-HENKAN-AREA
      *
           PERFORM VARYING IDV FROM 1  BY  1
                   UNTIL   IDV >           31
                   IF  RECE220-KAISU (1 IDV)    >   0
                       MOVE    IDV     TO  WRK-Z9
                       MOVE    31      TO  IDV
                   END-IF
           END-PERFORM
      *
           MOVE    1                   TO  WRK-CHAR-FLG
           MOVE    WRK-Z9 (3:2)        TO  WRK-CHAR-X
           MOVE    2                   TO  WRK-CHAR-CNT
           MOVE    IDZ                 TO  IDV
           PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
           MOVE    IDV                 TO  IDZ
      * 
           IF      WRK-Z9              <   10
                   MOVE    4           TO  IDV
           ELSE
                   MOVE    5           TO  IDV
           END-IF
           MOVE    SPACE               TO  WRK-NAME
           COMPUTE WRK-YUKOKETA        =   TBL-ZAIW-YUKOKETA(3 IDZ)
                                       +   IDV
           IF      WRK-YUKOKETA        >   19
                   ADD     1           TO  WRK-ZAIWMAX (3)
                   MOVE    WRK-ZAIWMAX (3) TO  IDZ
                   STRING  "¡Ê"               DELIMITED  BY  SIZE
                           WRK-CHAR-N         DELIMITED  BY  SPACE
                           "Æü¡Ë"             DELIMITED  BY  SIZE
                                       INTO   TBL-ZAIW-NAME (3 IDZ)
                   END-STRING
                   MOVE    IDV         TO     TBL-ZAIW-YUKOKETA(3 IDZ)
           ELSE
                   STRING  TBL-ZAIW-NAME (3 IDZ)
                                              DELIMITED  BY  SPACE
                           "¡Ê"               DELIMITED  BY  SIZE
                           WRK-CHAR-N         DELIMITED  BY  SPACE
                           "Æü¡Ë"             DELIMITED  BY  SIZE
                                       INTO   WRK-NAME
                   END-STRING
                   MOVE    WRK-NAME    TO  TBL-ZAIW-NAME (3 IDZ)
                   MOVE    WRK-YUKOKETA    TO  TBL-ZAIW-YUKOKETA(3 IDZ)
           END-IF
      *                 
           .
       200511-GJK-DAY-ADD-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³°Íè¿×Â®¸¡ÂÎ¸¡ºº²Ã»»»»ÄêÆüÊÔ½¸½èÍý
      *****************************************************************
       200512-GJK-DAY-ADD-SEC          SECTION.
      *
           INITIALIZE                  WRK-CHAR-HENKAN-AREA
      *
           PERFORM VARYING IDV FROM 1  BY  1
                   UNTIL   IDV >           31
                   IF  RECE220-KAISU (1 IDV)    >   0
                       MOVE    IDV     TO  WRK-Z9
                       MOVE    31      TO  IDV
                   END-IF
           END-PERFORM
      *
           MOVE    1                   TO  WRK-CHAR-FLG
           MOVE    WRK-Z9 (3:2)        TO  WRK-CHAR-X
           MOVE    2                   TO  WRK-CHAR-CNT
           MOVE    IDZ                 TO  IDV
           PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
           MOVE    IDV                 TO  IDZ
      * 
           IF      WRK-Z9              <   10
                   MOVE    4           TO  IDV
           ELSE
                   MOVE    5           TO  IDV
           END-IF
           ADD     1                   TO  WRK-ZAIWMAX (3)
           MOVE    WRK-ZAIWMAX (3)     TO  IDZ
           STRING  "¡Ê"                DELIMITED  BY  SIZE
                   WRK-CHAR-N          DELIMITED  BY  SPACE
                   "Æü¡Ë"              DELIMITED  BY  SIZE
                                       INTO   TBL-ZAIW-NAME (3 IDZ)
           END-STRING
           MOVE    IDV                 TO  TBL-ZAIW-YUKOKETA(3 IDZ)
      *                 
           .
       200512-GJK-DAY-ADD-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÞ¡¡ÌÀºÙ¥Æ¡¼¥Ö¥ë¥Á¥§¥Ã¥¯ ¿ÇÎÅ¶èÊ¬¡Ê¤½¤ÎÂ¾¡Ë ½èÍý
      *****************************************************************
       20052-SRYKBNELSE-CHECK-SEC      SECTION.
      *
           INITIALIZE                    TBL-ZAI-AREA
           MOVE    ZERO              TO  WRK-TBLMAX
           MOVE    SPACE             TO  WRK-ZAI
           MOVE    "¡ö"              TO  WRK-ZAI-MK
      *     
           PERFORM VARYING IDX3    FROM    1   BY  1
                   UNTIL   IDX3    >       5
      *
      *        ÌôºÞ¤È´ïºà¤ÎÉ½¼¨¤òµÕ¤Ë¤¹¤ë
               EVALUATE    IDX3
                   WHEN    4
                       MOVE    5               TO  IDX1
                   WHEN    5
                       MOVE    4               TO  IDX1
                   WHEN   OTHER
                       MOVE    IDX3            TO  IDX1
               END-EVALUATE
      *  
               IF      RECE220-SRYKBN   <=   "33"
                   MOVE    "¡ö"            TO  WRK-ZAI-MK
               END-IF    
               IF    ((RECE220-YKZTEN           =   ZERO) AND
                      (RECE220-JIHOKBN          =  SPACE) AND
                      (RECE220-RYOTENKISAISU    =   ZERO) AND
                      (RECE220-YKZKISAIFLG      =  SPACE) AND
                      (IDX1                     =   5   ))
               OR    ((RECE220-KIZAITEN         =   ZERO) AND
                      (RECE220-JIHOKBN          =  SPACE) AND
                      (RECE220-RYOTENKISAISU    =   ZERO) AND
                      (IDX1                     =   4   ))
               OR    ((RECE220-HOKATU-YKZTEN    =   ZERO) AND
                      (RECE220-JIHOKBN      NOT =  SPACE) AND
                      (RECE220-RYOTENKISAISU    =   ZERO) AND
                      (RECE220-YKZKISAIFLG      =  SPACE) AND
                      (IDX1                     =   5   ))
               OR    ((RECE220-HOKATU-KIZAITEN  =   ZERO) AND
                      (RECE220-JIHOKBN      NOT =  SPACE) AND
                      (RECE220-RYOTENKISAISU    =   ZERO) AND
                      (IDX1                     =   4   ))
                   CONTINUE
               ELSE    
                       IF  ( RECE220-SRYKBN       =   "31" OR "32" )
                       OR  ((RECE220-SRYKBN       =   "33"        ) AND
                            (RECE220-JIHOKBN  NOT =   SPACE       ))
                         IF   WRK-TBLMAX      >    ZERO
                             MOVE     SPACE      TO  WRK-ZAI-MK
                         END-IF
                       END-IF
                       PERFORM VARYING IDX2    FROM    1   BY  1
                               UNTIL   IDX2    >   WRK-ZAIWMAX (IDX1)  
                           MOVE    ZERO          TO  FLG-NOPRT
                           MOVE    IDX1          TO  WRK-WIDX1
                           MOVE    IDX2          TO  WRK-WIDX2
                           PERFORM 200521-SEYKBNELSE-MEISAI-SEC
                           IF  FLG-NOPRT         =   ZERO
      *                        ¥ì¥»¥×¥È£°£µºÞÊÔ½¸½èÍý
                               PERFORM 430-TBLZAI-HEN-SEC
                           END-IF    
                       END-PERFORM
               END-IF        
               IF      WRK-ZAIWMAX (IDX1)    >   ZERO        
                   MOVE    SPACE             TO  WRK-ZAI
               END-IF    
      *             
      *        ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È½èÍý¡Ê¿ÇÎÅ¹Ô°Ù¡Ë
               IF      IDX1              =   3
               AND     WRK-ZAIWMAX(IDX1) >   ZERO
               AND     RECE220-JIHOKBN   =   SPACE
                   IF      RECE220-SRYKBN     >=  "33"                   
                       MOVE    RECE220-SYUTEN1    TO  WRK-ZAITENX
                       MOVE    RECE220-ZAIKAISU   TO  WRK-ZAIKAISUX
                       PERFORM 810-TENSUKAI-HEN-SEC
                       MOVE    WRK-TBLMAX        TO  IDY
                       PERFORM 440-TNSKAI-SET-SEC
                       MOVE    IDY               TO  WRK-TBLMAX 
                   END-IF
               END-IF    
      *        ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È½èÍý¡ÊÆÃÄê´ïºà¡Ë
               IF     ( IDX1                =   4    )
               AND    ( WRK-ZAIWMAX(IDX1)   >   ZERO )
               AND    ( RECE220-JIHOKBN     =   SPACE)
                 IF     RECE220-KIZAITEN    >   ZERO
                   IF      RECE220-SRYKBN     >=  "33"                   
                       MOVE    RECE220-KIZAITEN   TO  WRK-ZAITENX
                       MOVE    RECE220-ZAIKAISU   TO  WRK-ZAIKAISUX
                       PERFORM 810-TENSUKAI-HEN-SEC
                       MOVE    WRK-TBLMAX        TO  IDY
                       PERFORM 440-TNSKAI-SET-SEC
                       MOVE    IDY               TO  WRK-TBLMAX 
                   END-IF
                 END-IF
               END-IF     
      *        ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È½èÍý¡ÊÌôºÞ¡Ë
               IF     ( IDX1                =   5    )
               AND    ( WRK-ZAIWMAX(IDX1)   >   ZERO )
               AND    ( RECE220-JIHOKBN      =   SPACE)
                 IF     RECE220-YKZTEN       >   ZERO
                 OR     RECE220-YKZKISAIFLG  =   "1"
                   IF      RECE220-SRYKBN     >=  "33"               
                       MOVE    RECE220-YKZTEN     TO  WRK-ZAITENX
                       MOVE    RECE220-ZAIKAISU   TO  WRK-ZAIKAISUX
                       PERFORM 810-TENSUKAI-HEN-SEC
                       MOVE    WRK-TBLMAX        TO  IDY
                       PERFORM 440-TNSKAI-SET-SEC
                       MOVE    IDY               TO  WRK-TBLMAX 
                   END-IF          
                 END-IF
               END-IF        
           END-PERFORM
      *             
      *    ¸¡ºº¤Î¤È¤­²ó¿ô¤ò½¸·×
           IF     (WRK-ZAIWMAX(3)      >   ZERO        )
           AND    (RECE220-SRYKBN      =   "60" OR "64")
           AND    (RECE220-JIHOKBN     =   SPACE       )
               IF      TBL-ZAIW-SRYCD (3 1)   =   WRK-CONS-SAIKETSU1
                                              OR  WRK-CONS-SAIKETSU2
                                              OR  WRK-CONS-SAIKETSU3 
                   CONTINUE
               ELSE
                   IF      WRK-ZAIW-KNSJISKBN  =  "2"
                       CONTINUE
                   ELSE 
                       ADD     RECE220-ZAIKAISU   TO  WRK-KENSA-KAISU
                   END-IF
               END-IF
           END-IF     
      *
           .
       20052-SRYKBNELSE-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÌÀºÙ°õ»ú¥Á¥§¥Ã¥¯ ¿ÇÎÅ¶èÊ¬¡Ê¤½¤ÎÂ¾¡Ë ½èÍý
      *****************************************************************
       200521-SEYKBNELSE-MEISAI-SEC        SECTION.
      *
           MOVE    ZERO          TO  FLG-NOPRT
      *
      *    ÉþÍÑÊýË¡¤Ç¤Ê¤¤¤³¤È
           IF  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:3) =   "001")
           OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:1) =   "S"  )
           OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:5) =   "09500" )
           OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:5) =   "09591" )
           OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:5) =   "09592" )
           OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:5) =   "09593" )
           OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:5) =   "09594" )
           OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:5) =   "09600" )
           OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:5) =   "09691" )
           OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:5) =   "09692" )
           OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:5) =   "09693" )
           OR  (TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)(1:5) =   "09694" )
               MOVE    1             TO  FLG-NOPRT
           END-IF
      *    ¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë¤ËÂ¸ºß¤·¤¿¾ì¹ç¡¢°õ»ú¤·¤Ê¤¤¤³¤È
           IF   RECE220-JIHOKBN  =  SPACE
             PERFORM   VARYING   IDY   FROM    1   BY  1
                       UNTIL   ( IDY           >   TBL-NOSRYCD-MAX )
                       OR      ( FLG-NOPRT     =    1 )
      *
               IF  TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2)
                                =   TBL-NOSRYCD (IDY)
                   MOVE    1                 TO  FLG-NOPRT
               END-IF
             END-PERFORM
           END-IF
      *
           .
       200521-SEYKBNELSE-MEISAI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸¡ºº¥Á¥§¥Ã¥¯½èÍý
      *****************************************************************
       2006-SRYKBN60-CHECK-SEC         SECTION.
      *
           PERFORM 2006-GAIJINKEN-BUNRI-SEC
           MOVE    RECE220-REC          TO   RECE220SAV-REC
      *
      *    ÌôºÞ¤ä¥³¥á¥ó¥È¤¬¤¢¤ì¤Ð¤Þ¤È¤á¤Ê¤¤
           IF      FLG-SRYCD1          =   1
               PERFORM 2006-GAIJINKEN-HENSYU-SEC
               MOVE    RECE220SAV-REC       TO  RECE220-REC
               IF      RECE220-ZAIKAISU     >   0
                       MOVE    ZERO        TO  FLG-GAIJINKEN
                       COMPUTE RECE220-ZAINUM   =   RECE220-ZAINUM
                                               +   99000000
                       PERFORM 2005-SRYKBNELSE-HENSYU-SEC
               END-IF
           ELSE
      *        ºÞ¤ÎÌÀºÙ¿ô¤¬£³°Ê¾å¤Î¾ì¹ç¤ÈÌÀºÙ¿ô¤¬£²¤Ç
      *        ÀèÆ¬¤¬¸¡ÂÎÌ¾¥³¡¼¥É¤Ç¤Ê¤¤¾ì¹ç¤Ï¤Þ¤È¤á¤Ê¤¤
               IF    ( RECE220-MEISAISU     >   2 )
                 OR (( RECE220-MEISAISU     =   2 )
                 AND ( TBL-ZAIW-KENTAICOMMENT-SRYCD (3 1) = 0 ))
                   PERFORM 2006-GAIJINKEN-HENSYU-SEC
                   MOVE    RECE220SAV-REC       TO  RECE220-REC
                   IF      RECE220-ZAIKAISU     >   0
                           MOVE    ZERO        TO  FLG-GAIJINKEN
                           COMPUTE RECE220-ZAINUM   =   RECE220-ZAINUM
                                                   +   99000000
                           PERFORM 2005-SRYKBNELSE-HENSYU-SEC
                   END-IF
               ELSE    
      *        Êñ³çÂÐ¾Ý¤Ç¤Ê¤¤¤È¤­¤Þ¤È¤á¤Ê¤¤         
                   IF      TBL-ZAIW-HOUKNSKBN(3 1)  =   ZERO
                       PERFORM 2006-GAIJINKEN-HENSYU-SEC
                       MOVE    RECE220SAV-REC       TO  RECE220-REC
                       IF      RECE220-ZAIKAISU     >   0
                               MOVE    ZERO        TO  FLG-GAIJINKEN
                               COMPUTE RECE220-ZAINUM
                                                   =   RECE220-ZAINUM
                                                   +   99000000
                               PERFORM 2005-SRYKBNELSE-HENSYU-SEC
                       END-IF
                   ELSE
                       IF      WRK-RECE220GJK-MAX   >   0
                               PERFORM VARYING IDXX FROM  1  BY  1 
                                       UNTIL   IDXX >
                                                   WRK-RECE220GJK-MAX 
                                 MOVE  1           TO  FLG-GAIJINKEN
                                 MOVE  WRK-RECE220GJK-REC (IDXX) 
                                                   TO  RECE220-REC 
                                 PERFORM 2006-SRYKBN60-TAIHI-SEC
                               END-PERFORM
                       END-IF
                       MOVE    RECE220SAV-REC       TO  RECE220-REC
                       IF      RECE220-ZAIKAISU     >   0
                               MOVE    ZERO        TO  FLG-GAIJINKEN
                               PERFORM 2006-SRYKBN60-TAIHI-SEC
                       END-IF
                   END-IF
               END-IF
           END-IF
           .
       2006-SRYKBN60-CHECK-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³°Íè¿×Â®¸¡ÂÎ¸¡ºº²Ã»»ºÞÊ¬Î¥½èÍý
      *****************************************************************
       2006-GAIJINKEN-BUNRI-SEC        SECTION.
      *
           INITIALIZE                  WRK-RECE220GJK-TABLE
           MOVE    ZERO                TO  WRK-RECE220GJK-MAX
      *
           IF      ( RECE200-KENTAIKASANFLG   =   '1' )
             AND   ( WRK-ZAIW-KNSJISKBN  NOT =   2 )
             AND  (((RECE220-KNSJISGRPKBN     >   0)
             AND    (RECE220-KNSJISGRPKBN     <   7))
             OR     (RECE220-SRYCDTOTAL       =   WRK-CONS-NYOIPPAN-N))
             MOVE    RECE220-REC        TO  RECE220GJK-REC
             PERFORM VARYING IDX FROM  1   BY  1
                     UNTIL   IDX >     31
                 IF  RECE220-KAISU (1 IDX)    >   0
                   IF  WRK-KENTAIKASAN (IDX) =   1
                       MOVE    ZERO    TO  RECE220GJK-ZAIKAISU
                                           RECE220GJK-DAY-AREA
                       MOVE    RECE220-KAISU (1 IDX)
                                       TO  RECE220GJK-ZAIKAISU
                       MOVE    RECE220-KAISU (1 IDX)
                                       TO  RECE220GJK-KAISU (1 IDX)
                       MOVE    RECE220-KAISU (2 IDX)
                                       TO  RECE220GJK-KAISU (2 IDX) 
                       MOVE    RECE220-KAISU (3 IDX)
                                       TO  RECE220GJK-KAISU (3 IDX) 
                       MOVE    RECE220-KAISU (4 IDX)
                                       TO  RECE220GJK-KAISU (4 IDX) 
                       COMPUTE WRK-RECE220GJK-MAX =  WRK-RECE220GJK-MAX
                                                 +  1
                       MOVE    RECE220GJK-REC
                                       TO  WRK-RECE220GJK-REC 
                                               (WRK-RECE220GJK-MAX)
                       COMPUTE RECE220-ZAIKAISU   =  RECE220-ZAIKAISU
                                       -   RECE220-KAISU (1 IDX)
                       MOVE    ZERO    TO  RECE220-KAISU (1 IDX)
                                           RECE220-KAISU (2 IDX) 
                                           RECE220-KAISU (3 IDX) 
                                           RECE220-KAISU (4 IDX) 
                   END-IF
                 END-IF
             END-PERFORM
           END-IF        
           .
       2006-GAIJINKEN-BUNRI-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³°Íè¿×Â®¸¡ÂÎ¸¡ºº²Ã»»ÂÐ¾ÝºÞ½èÍý
      *****************************************************************
       2006-GAIJINKEN-HENSYU-SEC       SECTION.
      *
           IF     WRK-RECE220GJK-MAX    >   0
                  PERFORM VARYING IDXX FROM  1  BY  1 
                          UNTIL   IDXX >     WRK-RECE220GJK-MAX 
                      MOVE  WRK-RECE220GJK-REC (IDXX) 
                                       TO  RECE220-REC 
                      COMPUTE WRK-GAIJINKEN-ZAINUM  =
                              WRK-GAIJINKEN-ZAINUM  +  1
                      COMPUTE RECE220-ZAINUM = RECE220-ZAINUM
                                            + WRK-GAIJINKEN-ZAINUM
                                            * 100000
                      MOVE    1        TO  FLG-GAIJINKEN
                      MOVE    TBL-ZAIW-OCC (3)
                                       TO  TBL-ZAIW-OCC (6)
                      MOVE    WRK-ZAIWMAX-G
                                       TO  WRK-ZAIWMAX-SAV-G
                      PERFORM 2005-SRYKBNELSE-HENSYU-SEC
                      MOVE    TBL-ZAIW-OCC (6)
                                       TO  TBL-ZAIW-OCC (3)
                      MOVE    WRK-ZAIWMAX-SAV-G
                                       TO  WRK-ZAIWMAX-G
                  END-PERFORM
           END-IF
           .
       2006-GAIJINKEN-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¸¡ºº¤Þ¤È¤áÂÐ¾ÝÂÔÈò½èÍý
      *****************************************************************
       2006-SRYKBN60-TAIHI-SEC         SECTION.
      *
           ADD     1               TO  WRK-RECE220-MAX
           MOVE    RECE220-REC     TO  WRK-RECE220-REC (WRK-RECE220-MAX)
           MOVE    RECE220-DAY-AREA
                                   TO  WRK-RECE220-DAY-AREA
                                                      (WRK-RECE220-MAX)
           MOVE    TBL-ZAIW-HOUKNSKBN(3 1) TO  WRK-RECE220-HOUKNSKBN
                                                      (WRK-RECE220-MAX)
           IF      FLG-GAIJINKEN   =   0                    
                   MOVE ZERO       TO  WRK-RECE220-GAIJINKEN
                                                      (WRK-RECE220-MAX)
           ELSE
                   PERFORM VARYING IDX FROM    1   BY  1
                           UNTIL   IDX >       31
                       IF  RECE220-KAISU (1 IDX)    >   0
                           MOVE IDX TO  WRK-RECE220-GAIJINKEN
                                                      (WRK-RECE220-MAX)
                           MOVE 31  TO  IDX
                       END-IF
                   END-PERFORM
           END-IF
           MOVE    TBL-ZAIW-SRYSYUKBN-INPUT(3 1)
                                   TO  WRK-RECE220-SRYSYUKBN
                                                      (WRK-RECE220-MAX)
           MOVE    TBL-ZAIW-SRYCD(3 1)
                                   TO  WRK-RECE220-SRYCD
                                                      (WRK-RECE220-MAX)
           MOVE    TBL-ZAIW-SRYSURYO(3 1)
                                   TO  WRK-RECE220-SRYSURYO
                                                      (WRK-RECE220-MAX)
           MOVE    TBL-ZAIW-KENTAICOMMENT-SRYCD (3 1)
                                   TO  WRK-RECE220-KENTAICOMMENT-SRYCD
                                                      (WRK-RECE220-MAX)
           PERFORM VARYING IDX FROM    1   BY  1
                   UNTIL   IDX >       31
               ADD      RECE220-KAISU (1 IDX)   TO  WRK-SUM-KAISU (IDX)
               IF      (RECE220-KAISU (1 IDX)   >   0)
                 IF    (WRK-MIN-KAISU (IDX)    =   0)
                 OR    (RECE220-KAISU (1 IDX)   <   WRK-MIN-KAISU (IDX))
                   MOVE RECE220-KAISU (1 IDX)   TO  WRK-MIN-KAISU (IDX)
                   MOVE TBL-ZAIW-HOUKNSKBN(3 1)
                                            TO  WRK-MIN-HOUKNSKBN (IDX)
                   MOVE WRK-RECE220-GAIJINKEN (WRK-RECE220-MAX)
                                            TO  WRK-MIN-GAIJINKEN (IDX)
                   MOVE TBL-ZAIW-SRYSYUKBN-INPUT(3 1)
                                            TO  WRK-MIN-SRYSYUKBN (IDX)
                 END-IF
               END-IF
           END-PERFORM                                                       
           .
       2006-SRYKBN60-TAIHI-EXT.
           EXIT.
      *
      *****************************************************************
      *    Êñ³çÂÐ¾Ý¸¡ºº¤Þ¤È¤á½èÍý
      *****************************************************************
       2007-SRYKBN60-HENSYU-SEC         SECTION.
      * 
           INITIALIZE                   WRK-RECE220-MATOME-TABLE
      *
           PERFORM     VARYING  IDXX     FROM  1  BY  1
                       UNTIL    IDXX     >    31
      *
             PERFORM            UNTIL   WRK-SUM-KAISU (IDXX)  =  ZERO
               INITIALIZE       WRK-KENSA-MATOME (101)
                                WRK-RECE220-FLG-TABLE
               PERFORM  VARYING IDY FROM    1   BY  1
                        UNTIL   IDY >       WRK-RECE220-MAX
                 IF    ( WRK-RECE220-KAISU (IDY 1 IDXX)
                                       >=   WRK-MIN-KAISU (IDXX) )
                 AND   ( WRK-RECE220-HOUKNSKBN (IDY)
                                        =   WRK-MIN-HOUKNSKBN (IDXX) )
                 AND   ( WRK-RECE220-GAIJINKEN (IDY)
                                        =   WRK-MIN-GAIJINKEN (IDXX) )
                 AND   ( WRK-RECE220-SRYSYUKBN (IDY)
                                        =   WRK-MIN-SRYSYUKBN (IDXX) )
                 AND   ( WRK-RECE220-FLG (IDY)      =   ZERO )
                    MOVE  WRK-RECE220-HOUKNSKBN (IDY)
                                              TO  WRK-HOUKNSKBN (101)
                    MOVE  WRK-RECE220-GAIJINKEN (IDY)
                                              TO  WRK-GAIJINKEN (101)
                    MOVE  WRK-RECE220-SRYSYUKBN (IDY)
                                              TO  WRK-SRYSYUKBN-K (101)
                    MOVE  WRK-MIN-KAISU (IDXX)
                                              TO  WRK-KAISU (101 1)
                    MOVE  1                   TO  WRK-RECE220-FLG (IDY)
                    ADD   1                   TO  WRK-KENSA-SU (101)
                    MOVE  WRK-KENSA-SU (101)  TO  IDX1
                    MOVE  IDY             TO  WRK-RECE220-IDX (101 IDX1)
                    PERFORM  VARYING  IDX2  FROM 1 BY 1
                             UNTIL    IDX2  >    IDX1
                      IF   WRK-KENSA-SRYCD(101 IDX2)  =  0
                           MOVE  WRK-RECE220-SRYCD-G (IDY)
                                       TO  WRK-KENSA-SRYCD-OCC(101 IDX2)
                      ELSE
                        IF   WRK-RECE220-SRYCD-G (IDY)
                                       <   WRK-KENSA-SRYCD-OCC(101 IDX2)
                             PERFORM  VARYING  IDX3  FROM  IDX1  BY -1
                                      UNTIL    IDX3  =     IDX2
                               COMPUTE  IDX4   =     IDX3  -  1
                               MOVE   WRK-KENSA-SRYCD-OCC(101 IDX4)
                                       TO  WRK-KENSA-SRYCD-OCC(101 IDX3)
                             END-PERFORM
                             MOVE  WRK-RECE220-SRYCD-G (IDY)
                                       TO  WRK-KENSA-SRYCD-OCC(101 IDX2)
                             MOVE  IDX1   TO  IDX2
                        END-IF
                      END-IF
                    END-PERFORM
                 END-IF
               END-PERFORM
      *
      *        Æ±°ì¸¡ººÆâÍÆ¤Î¥°¥ë¡¼¥×¤¬¥Æ¡¼¥Ö¥ë¤ËÂ¸ºß¤¹¤ë¤«
               MOVE    ZERO                   TO  IDX1
               PERFORM  VARYING IDY FROM    1   BY  1
                        UNTIL   IDY >       WRK-KENSA-MATOME-MAX
                 IF    ( WRK-HOUKNSKBN (IDY)  =  WRK-HOUKNSKBN (101) )
                 AND   ( WRK-GAIJINKEN (IDY)  =  WRK-GAIJINKEN (101) )
                 AND   ( WRK-KENSA-SU (IDY)   =  WRK-KENSA-SU (101) )
                   IF  ( WRK-RECE220-IDX-G (IDY)
                                           =  WRK-RECE220-IDX-G (101) )
                   OR  ( WRK-KENSA-SRYCD-G (IDY)
                                           =  WRK-KENSA-SRYCD-G (101) )
                    MOVE  IDY                 TO  IDX1
                    MOVE  WRK-KENSA-MATOME-MAX
                                              TO  IDY
                   END-IF
                 END-IF
               END-PERFORM
      *
               IF      IDX1                   =   0
                       ADD  1                 TO  WRK-KENSA-MATOME-MAX
                       MOVE WRK-KENSA-MATOME (101)
                            TO  WRK-KENSA-MATOME (WRK-KENSA-MATOME-MAX)
               ELSE
                       ADD  WRK-MIN-KAISU (IDXX)
                                              TO  WRK-KAISU (IDX1 1)
               END-IF
      *
      *        ²ó¿ô¥Æ¡¼¥Ö¥ë¤è¤êº¹¤·°ú¤¯
               PERFORM  VARYING IDY FROM    1   BY  1
                        UNTIL   IDY >       WRK-RECE220-MAX
                 IF    ( WRK-RECE220-FLG (IDY)      =   1 )
                    COMPUTE WRK-SUM-KAISU (IDXX)   =
                            WRK-SUM-KAISU (IDXX)   -
                            WRK-MIN-KAISU (IDXX)
                    COMPUTE WRK-RECE220-KAISU (IDY 1 IDXX)   =
                            WRK-RECE220-KAISU (IDY 1 IDXX)   -
                            WRK-MIN-KAISU (IDXX)
                 END-IF
               END-PERFORM
      *
      *        ¿·¤¿¤ËºÇ¾®²ó¿ô¾ðÊó¤ò¥»¥Ã¥È¤¹¤ë
               MOVE     ZERO             TO  WRK-MIN-KAISU (IDXX)
               MOVE     ZERO             TO  WRK-MIN-HOUKNSKBN (IDXX)
               MOVE     ZERO             TO  WRK-MIN-GAIJINKEN (IDXX)
               MOVE     SPACE            TO  WRK-MIN-SRYSYUKBN (IDXX)
               PERFORM  VARYING IDY FROM    1   BY  1
                        UNTIL   IDY >       WRK-RECE220-MAX
                 IF    (WRK-RECE220-KAISU (IDY 1 IDXX)  >   0)
                   IF  (WRK-MIN-KAISU (IDXX)   =   0)
                   OR  (WRK-RECE220-KAISU (IDY 1 IDXX)
                                             <   WRK-MIN-KAISU (IDXX))
                     MOVE WRK-RECE220-KAISU (IDY 1 IDXX)
                                           TO  WRK-MIN-KAISU (IDXX)
                     MOVE WRK-RECE220-HOUKNSKBN (IDY)
                                           TO  WRK-MIN-HOUKNSKBN (IDXX)
                     MOVE WRK-RECE220-GAIJINKEN (IDY)
                                           TO  WRK-MIN-GAIJINKEN (IDXX)
                     MOVE WRK-RECE220-SRYSYUKBN (IDY)
                                           TO  WRK-MIN-SRYSYUKBN (IDXX)
                   END-IF
                 END-IF
               END-PERFORM
             END-PERFORM
           END-PERFORM
      *
      *    ¤Þ¤È¤á¤¿ºÞ¤ò½ÐÎÏ¤¹¤ë
           PERFORM      VARYING IDXX FROM   1   BY  1
                        UNTIL   IDXX >      WRK-KENSA-MATOME-MAX
             MOVE    ZERO                TO  FLG-SRYCD1
             MOVE    ZERO                TO  FLG-NG
      *
             INITIALIZE                      WRK-ZAIW-AREA
             MOVE    ZERO                TO  WRK-ZAIWMAX-G
             MOVE    ZERO                TO  WRK-TBLMAX
             MOVE    ZERO                TO  FLG-TEIGEN
                                             FLG-COMMENT
                                             FLG-COMMENT2
                                             FLG-COMMENT3
                                             FLG-HIKAKIN 
             MOVE    ZERO                TO  WRK-RECE230
             MOVE    SPACE               TO  WRK-SRYSYUKBN
      *
             MOVE    SPACE               TO  RECE220-REC
             INITIALIZE                      RECE220-REC
             MOVE    ZERO                TO  WRK-RECE220-ZAITEN
             PERFORM VARYING IDW FROM    1   BY  1
                     UNTIL   IDW >       WRK-KENSA-SU (IDXX)
               MOVE  WRK-RECE220-IDX (IDXX IDW) TO  IDX1
               MOVE  WRK-RECE220-REC (IDX1)     TO  RECE220-REC
               MOVE  WRK-RECE220-DAY-AREA(IDX1) TO  RECE220-DAY-AREA
               ADD   RECE220-ZAITEN             TO  WRK-RECE220-ZAITEN
               PERFORM 2002-TBLZAIW-TAIHI-SEC
             END-PERFORM
             MOVE    WRK-KAISU (IDXX 1)  TO  RECE220-ZAIKAISU
             MOVE    WRK-RECE220-ZAITEN   TO  RECE220-SYUTEN1
                                             RECE220-ZAITEN
             IF      WRK-GAIJINKEN (IDXX)  >  0
                     COMPUTE WRK-GAIJINKEN-ZAINUM  =
                             WRK-GAIJINKEN-ZAINUM  +  1
                     COMPUTE RECE220-ZAINUM = RECE220-ZAINUM
                                           + WRK-GAIJINKEN-ZAINUM
                                           * 100000
                     MOVE    1           TO  FLG-GAIJINKEN
             ELSE
                     COMPUTE RECE220-ZAINUM = RECE220-ZAINUM
                                           + 99000000
                     MOVE    0           TO  FLG-GAIJINKEN
             END-IF
      *
      *     ¥ì¥»¥×¥È£°£´ºÞÊÔ½¸Á°½èÍý
            PERFORM 2001-RECE220-ZAIHEN-MAE-SEC
      *
            IF      SPA-STS          =   ZERO
                    PERFORM 20051-SRYKBNELSE-KENSA-SEC
      *             ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ë½ÐÎÏ½èÍý
                    PERFORM 450-RECE240-OUT-SEC
            END-IF
           END-PERFORM
           .
       2007-SRYKBN60-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ³°Íè¿×Â®¸¡ÂÎ¸¡ºº²Ã»»¤Î»»ÄêÆü³ÎÇ§½èÍý
      *****************************************************************
       2009-KENTAIKASAN-KAKUNIN-SEC      SECTION.
      *
           INITIALIZE                      RECE220-REC
           MOVE    RECE200-KEY         TO  RECE220-KEY1
           MOVE    ZERO                TO  RECE220-ZAINUM
      *
           START   RECE220-FILE
               KEY IS    >=   RECE220-KEY
               INVALID
                   MOVE    1           TO  FLG-RECE220
               NOT INVALID
                   PERFORM 990-RECE220-NEXT-SEC
           END-START
           PERFORM
               UNTIL  ( SPA-STS              =   2            )
               OR     ( FLG-RECE220          =   1            )
               OR     ( RECE200-KEY      NOT =   RECE220-KEY1 )
      *
               IF     RECE220-KNSJISGRPKBN    =   99
      *
                   PERFORM VARYING IDX FROM      1  BY  1
                           UNTIL   IDX >         31
                       IF  RECE220-KAISU (1 IDX)  >    0
                           MOVE    1         TO  WRK-KENTAIKASAN (IDX)
                       END-IF
                   END-PERFORM
               END-IF
      *
               PERFORM 990-RECE220-NEXT-SEC
      *
           END-PERFORM
      *
           MOVE    ZERO                TO  FLG-RECE220
           .
      *
       2009-KENTAIKASAN-KAKUNIN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½é¿Ç¤ÎºÞ¤Þ¤È¤áÊÔ½¸
      *****************************************************************
       2010-SYOSAIMATOME-HENSYU1-SEC      SECTION.
      *
           IF  TBL-SORT11-ZAIKAISU(IDX6)  NOT =  ZERO
      *
               EVALUATE    TRUE
                 WHEN    TBL-SORT11-YUKOKETA(IDX6) <=  16
                   MOVE    SPACE             TO  WRK-ZAI
                   MOVE    TBL-SORT11-TEN(IDX6)  TO  WRK-ZAITENX
                   MOVE    TBL-SORT11-ZAIKAISU(IDX6)
                                                 TO  WRK-ZAIKAISUX
                   PERFORM 810-TENSUKAI-HEN-SEC
                   MOVE    WRK-TNSKAI        TO  WRK-ZAI-TNSKAI
      *
                   MOVE    "¡ö"              TO  WRK-ZAI-MK
                   MOVE    TBL-SORT11-YUKOKETA(IDX6)
                                             TO  IDX8
                   COMPUTE IDX8 = IDX8 * 2
                   MOVE    TBL-SORT11-NAME(IDX6)(1:IDX8)
                                             TO  WRK-ZAI-NAME(1:IDX8)
      *
                   MOVE    1                 TO  WRK-SET-LINENUM
                   PERFORM 20101-SYOSAIMATOME-WRITE1-SEC
                 WHEN    TBL-SORT11-YUKOKETA(IDX6) <=  41
                   MOVE    SPACE             TO  WRK-ZAI
                   MOVE    "¡ö"              TO  WRK-ZAI-MK
                   MOVE    TBL-SORT11-YUKOKETA(IDX6)
                                             TO  IDX8
                   COMPUTE IDX8 = IDX8 * 2
                   IF   IDX8  <=  50
                     MOVE  TBL-SORT11-NAME(IDX6)(1:IDX8)
                                             TO  WRK-ZAI-NAME(1:IDX8)
                   ELSE
                     MOVE  TBL-SORT11-NAME(IDX6)(1:50)
                                             TO  WRK-ZAI-NAME(1:50)
                   END-IF
      *
                   MOVE    1                 TO  WRK-SET-LINENUM
                   PERFORM 20101-SYOSAIMATOME-WRITE1-SEC
      *@
                   MOVE    SPACE             TO  WRK-ZAI
                   MOVE    TBL-SORT11-TEN(IDX6)  TO  WRK-ZAITENX
                   MOVE    TBL-SORT11-ZAIKAISU(IDX6)
                                                 TO  WRK-ZAIKAISUX
                   PERFORM 810-TENSUKAI-HEN-SEC
                   MOVE    WRK-TNSKAI        TO  WRK-ZAI-TNSKAI
                   IF   IDX8  >  50
                     COMPUTE IDX9 = IDX8 - 50
                     MOVE    TBL-SORT11-NAME(IDX6)(51:IDX9)
                                             TO  WRK-ZAI-NAME(1:IDX9)
                   END-IF
      *
                   MOVE    2                 TO  WRK-SET-LINENUM
                   PERFORM 20101-SYOSAIMATOME-WRITE1-SEC
               END-EVALUATE
      *
           END-IF
      *
           .
      *
       2010-SYOSAIMATOME-HENSYU1-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½é¿Ç¤ÎºÞ¤Þ¤È¤á½ÐÎÏ
      *****************************************************************
       20101-SYOSAIMATOME-WRITE1-SEC      SECTION.
      *
           MOVE    SPACE             TO  RECE240-REC
           INITIALIZE                    RECE240-REC
           MOVE    RECE200-KEY       TO  RECE240-KEY1
      *
           MOVE    WRK-SET-LINENUM   TO  RECE240-LINENUM
      *
           EVALUATE  IDX6
             WHEN     1
               COMPUTE RECE240-ZAINUM   = 99992001
             WHEN     2
               COMPUTE RECE240-ZAINUM   = 99992011
             WHEN     3
               COMPUTE RECE240-ZAINUM   = 99992021
             WHEN     4
               COMPUTE RECE240-ZAINUM   = 99992031
           END-EVALUATE
      *
           MOVE    1                 TO  RECE240-ZAIMEISAISU
           MOVE    RECE200-PTNUM     TO  RECE240-PTNUM
           MOVE    WRK-ZAI           TO  RECE240-TEKIYO-INF
      *
           MOVE    "11"              TO  RECE240-SRYKBN
      *
           MOVE    99999999          TO  RECE240-ZAITEN
           MOVE    ZERO              TO  RECE240-KNSJISKBN
      *
           IF      IDX6  =  1
             MOVE    9               TO  RECE240-CDKBN-SYO
             MOVE    99              TO  RECE240-CDKBN-BU
             MOVE    "9"             TO  RECE240-CDKBN-KBN
             MOVE    999             TO  RECE240-CDKBN-KBNNUM
             MOVE    99              TO  RECE240-CDKBN-KBNNUM-EDA
             MOVE    99              TO  RECE240-CDKBN-KOUBAN
             MOVE    999999999       TO  RECE240-KOUHYOJUNNUM
           END-IF
      *
           MOVE    SPACE             TO  RECE240-SAFLG
           MOVE    ZERO              TO  RECE240-ZAIKBN
           MOVE    SPACE             TO  RECE240-SRYSYUKBN
           MOVE    ZERO              TO  RECE240-DAY
      *
           MOVE    SPACE             TO  RECE240-JIHOKBN
      *
           MOVE    SPACE             TO  RECE240-ZAISKBKBN
           MOVE    ZERO              TO  RECE240-ZAISKBBAN
           MOVE    ZERO              TO  RECE240-TENTEKIKBN
           MOVE    ZERO              TO  RECE240-TENTEKIBAN
      *
           PERFORM 4501-RECE240-WRITE-SEC
      *
           IF      STS-RECE240     NOT =   ZERO
               DISPLAY "<SYOSAIMATOME-WRITE1>"
           END-IF
      *
           .
      *
       20101-SYOSAIMATOME-WRITE1-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ôºÆ·×»»½èÍý
      *****************************************************************
       400-TENSU-SAIKEISAN-SEC    SECTION.
      *
           MOVE    SPACE               TO  WRK-ZAI
           MOVE    "¡ö"                TO  WRK-ZAI-MK
      *    ÅÀ¿ô¡¦²ó¿ô¥»¥Ã¥È
           MOVE    WRK-TENSUGOKEI      TO  WRK-ZAITENX
           MOVE    RECE220-ZAIKAISU     TO  WRK-ZAIKAISUX
      *    É¬Í×Í­¸ú·å¿ô¡¦³«»Ï°ÌÃÖ¡¦²ó¿ôÊÔ½¸
           PERFORM 810-TENSUKAI-HEN-SEC
      *
           .
       400-TENSU-SAIKEISAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÞ¥Æ¡¼¥Ö¥ëÊÔ½¸½èÍý
      *****************************************************************
       430-TBLZAI-HEN-SEC     SECTION.
      *
      *    ¿ôÎÌÊÔ½¸
           PERFORM 4301-SURYO-HEN1-SEC
      *
      *    Ê¬²è¿ôÊÔ½¸
           PERFORM 4301-BUNKAKU-HEN1-SEC
      *
      *    ÌÀºÙÊÔ½¸¡¦ÌÀºÙ·å¿ô·×»»
           PERFORM 4302-MEISAI-KETA-HEN1-SEC
      *
      *    ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ëÊÔ½¸½èÍý
           PERFORM 4303-ZAITBL-TENSO-SEC
      *    
      *    ÌÀºÙ¤¬£±¹Ô¤Ë¼ý¤Þ¤ê¤­¤é¤Ê¤¤¾ì¹ç
           IF  WRK-WCLM            >   50
               MOVE    SPACE             TO  WRK-ZAI-NAME
               MOVE    WRK-KOUI (51:)    TO  WRK-ZAI-NAME
               PERFORM 4303-ZAITBL-TENSO-SEC
           END-IF
           IF  WRK-WCLM            >   100
               MOVE    SPACE             TO  WRK-ZAI-NAME
               MOVE    WRK-KOUI (101:)   TO  WRK-ZAI-NAME
               PERFORM 4303-ZAITBL-TENSO-SEC
           END-IF
           IF  WRK-WCLM            >   150
               MOVE    SPACE             TO  WRK-ZAI-NAME
               MOVE    WRK-KOUI (151:)   TO  WRK-ZAI-NAME
               PERFORM 4303-ZAITBL-TENSO-SEC
           END-IF
           IF  WRK-WCLM            >   200
               MOVE    SPACE             TO  WRK-ZAI-NAME
               MOVE    WRK-KOUI (201:)   TO  WRK-ZAI-NAME
               PERFORM 4303-ZAITBL-TENSO-SEC
           END-IF
           IF  WRK-WCLM            >   250
               MOVE    SPACE             TO  WRK-ZAI-NAME
               MOVE    WRK-KOUI (251:)   TO  WRK-ZAI-NAME
               PERFORM 4303-ZAITBL-TENSO-SEC
           END-IF
      *
           .
       430-TBLZAI-HEN-EXT.
           EXIT.
      *     
      *****************************************************************
      *    ¿ôÎÌÊÔ½¸½èÍý
      *****************************************************************
       4301-SURYO-HEN1-SEC        SECTION.
      *
           MOVE    SPACE           TO  WRK-SURYO-X
           MOVE    ZERO            TO  WRK-SURYOST
           MOVE    ZERO            TO  WRK-SURYOKETA
           MOVE    ZERO            TO  WRK-SURYOKETA1
           MOVE    ZERO            TO  WRK-SURYOKETA2
           MOVE    SPACE           TO  WRK-SURYO-N
           MOVE    SPACE           TO  WRK-SRYSURYOW
      *
           IF      TBL-ZAIW-SRYSURYO (WRK-WIDX1 WRK-WIDX2)
                                   =   ZERO
             IF  (RECE220-JIHOKBN  NOT =  SPACE)
             AND (RECE220-ZAIKBN       =   4   )
               CONTINUE
             ELSE
               GO  TO  4301-SURYO-HEN1-EXT  
             END-IF
           END-IF
      * 
      *    ¿ô»úÉ½¼¨ÍÑÊÔ½¸¡ÊÈ¾³Ñ¡Ë
           MOVE    TBL-ZAIW-SRYSURYO (WRK-WIDX1 WRK-WIDX2)
                                   TO  WRK-SURYO
           MOVE    WRK-SURYO-S1    TO  WRK-SURYO-Z1
      *
      *    ¡Ö£°£µ£¹¡×¤Ç»Ï¤Þ¤ë¾ì¹ç¤Ï¾®¿ôÅÀ°Ê²¼£³·å¤Þ¤Ç¤È¤¹¤ë
           IF      TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2) (1:3)
                                   =   "059"
               MOVE    "00"            TO  WRK-SURYO-S2 (4:2)
           END-IF
      *
           MOVE    ZERO            TO  FLG-SP
           PERFORM   VARYING   IDY   FROM    5   BY  -1
                     UNTIL     IDY           =   ZERO
             IF  WRK-SURYO-S2(IDY:1) NOT =   ZERO
                 MOVE    1               TO  FLG-SP
             END-IF
             IF  FLG-SP                  =   1
                 MOVE    WRK-SURYO-S2(IDY:1)
                                         TO  WRK-SURYO-Z3(IDY:1)
             END-IF
           END-PERFORM
           IF  WRK-SURYO-Z3          NOT =   SPACE
               MOVE    "."               TO  WRK-SURYO-Z2
           END-IF
      *    É½¼¨Ê¸»ú¿ô¥«¥¦¥ó¥È
           PERFORM   VARYING   IDY   FROM    1   BY  1
                     UNTIL     IDY           >   11
             IF  WRK-SURYO-X (IDY:1)   NOT =   SPACE
                 IF  WRK-SURYOST           =   ZERO
                     MOVE    IDY           TO  WRK-SURYOST
                 END-IF
      *          ¿ôÎÌ·å¿ô¥«¥¦¥ó¥È(£¶·åÌÜ¡§¥Ô¥ê¥ª¥É)
                 ADD     1                 TO  WRK-SURYOKETA
                 IF  IDY                   <   6
                     ADD     1             TO  WRK-SURYOKETA1
                 END-IF
                 IF  IDY                   >   6
                     ADD     1             TO  WRK-SURYOKETA2
                 END-IF
             END-IF
           END-PERFORM
           IF  WRK-SURYOST             =   6
               MOVE    "0"             TO  WRK-SURYO-Z1(5:1)
               MOVE    5               TO  WRK-SURYOST
               MOVE    1               TO  WRK-SURYOKETA1
               ADD     1               TO  WRK-SURYOKETA
           END-IF
      *    Á´³ÑÊÑ´¹
           IF  WRK-SURYOKETA1          >   ZERO
               INITIALIZE              WRK-CHAR-HENKAN-AREA
               MOVE    WRK-SURYO-Z1 (WRK-SURYOST:WRK-SURYOKETA1)
                                       TO  WRK-CHAR-X
               MOVE    WRK-SURYOKETA1  TO  WRK-CHAR-CNT
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-CHAR-N      TO  WRK-SURYO-N1
           END-IF
           IF  WRK-SURYOKETA2          >   ZERO
               MOVE    "¡¥"            TO  WRK-SURYO-N2
               INITIALIZE              WRK-CHAR-HENKAN-AREA
               MOVE    WRK-SURYO-Z3 (1:WRK-SURYOKETA2)
                                       TO  WRK-CHAR-X
               MOVE    WRK-SURYOKETA2  TO  WRK-CHAR-CNT
               PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
               MOVE    WRK-CHAR-N      TO  WRK-SURYO-N3
           END-IF
           STRING      WRK-SURYO-N1    DELIMITED   BY  " "
                       WRK-SURYO-N2    DELIMITED   BY  " "
                       WRK-SURYO-N3    DELIMITED   BY  " "
                       INTO            WRK-SRYSURYOW
           END-STRING
      *
           .
       4301-SURYO-HEN1-EXT.
           EXIT.
      *     
      *****************************************************************
      *    Ê¬²è¿ôÊÔ½¸½èÍý
      *****************************************************************
       4301-BUNKAKU-HEN1-SEC        SECTION.
      *
           MOVE    ZERO            TO  WRK-BUNKAKUKETA
           MOVE    SPACE           TO  WRK-BUNKAKU-N
      *
           IF      TBL-ZAIW-SRYCD (WRK-WIDX1 WRK-WIDX2) (1:1)
                                   =   "7"
           AND     TBL-ZAIW-TANICD(WRK-WIDX1 WRK-WIDX2)
                                   =   WRK-CONS-TANICD 
           AND     TBL-ZAIW-SRYKAISU(WRK-WIDX1 WRK-WIDX2)
                                   >   1
             IF   TBL-ZAIW-SRYCD(WRK-WIDX1 WRK-WIDX2) =
                  "700020000" OR "700040000" OR "700060000" OR
                  "700070000" OR "700090000" OR "700100000" OR
                  "700120000" OR "700130000" OR "700150000" OR
                  "700300000" OR "700320000" OR "700340000" OR
                  "700350000" OR "700720000" OR "700740000" OR
                  "700760000" OR "700770000" OR "700790000" OR
                  "700800000" OR "700820000" OR "700830000" OR
                  "700850000" OR "700860000" OR "700880000" OR
                  "700890000"
               GO  TO  4301-BUNKAKU-HEN1-EXT
             ELSE
               CONTINUE
             END-IF
           ELSE                            
               GO  TO  4301-BUNKAKU-HEN1-EXT  
           END-IF
      * 
      *    É½¼¨ÍÑÊÔ½¸¡ÊÈ¾³Ñ¡Ë
           MOVE    TBL-ZAIW-SRYKAISU (WRK-WIDX1 WRK-WIDX2)
                                   TO  WRK-SRYKAISU-X
      *    Á´³ÑÊÑ´¹
           INITIALIZE              WRK-CHAR-HENKAN-AREA
           MOVE    WRK-SRYKAISU-X  TO  WRK-CHAR-X
           MOVE    3               TO  WRK-CHAR-CNT
           MOVE    1               TO  WRK-CHAR-FLG
           PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
           STRING  WRK-CHAR-N      DELIMITED BY  SPACE
                   "Ê¬²è"          DELIMITED  BY  SIZE
                                   INTO  WRK-BUNKAKU-N
           END-STRING
           COMPUTE WRK-BUNKAKUKETA =   WRK-CHAR-N-CNT  +  4
      *
           .
       4301-BUNKAKU-HEN1-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÌÀºÙ¡¦ÌÀºÙ·å¡¡ÊÔ½¸½èÍý
      *****************************************************************
       4302-MEISAI-KETA-HEN1-SEC    SECTION.
      *
           MOVE    SPACE           TO  WRK-KOUI
                                       WRK-RECEHENNAME
                                       WRK-RECEHENTANINAME
           MOVE    ZERO            TO  WRK-RECEHENTANI
      *
           IF      TBL-ZAIW-RECEHENFLG (WRK-WIDX1 WRK-WIDX2) 
                                   =   "1"
               STRING    "¡Ê"          DELIMITED   BY  SIZE
                         TBL-ZAIW-NAME (WRK-WIDX1 WRK-WIDX2)
                                       DELIMITED   BY  SIZE
                                       INTO    WRK-RECEHENNAME
               END-STRING
               MOVE    WRK-RECEHENNAME TO
                                   TBL-ZAIW-NAME (WRK-WIDX1 WRK-WIDX2)
               COMPUTE TBL-ZAIW-YUKOKETA (WRK-WIDX1 WRK-WIDX2)  =
                       TBL-ZAIW-YUKOKETA (WRK-WIDX1 WRK-WIDX2)  +   1
           END-IF
      *
           IF  TBL-ZAIW-TANINAME (WRK-WIDX1 WRK-WIDX2)
                                   =   SPACE
      *        < Ì¾¾Î >
               MOVE    TBL-ZAIW-NAME (WRK-WIDX1 WRK-WIDX2)
                                   TO  WRK-KOUI
      *        < Ì¾¾Î*2 >
               COMPUTE WRK-WCLM  =
                       TBL-ZAIW-YUKOKETA (WRK-WIDX1 WRK-WIDX2) *  2
           ELSE
      *
               IF   TBL-ZAIW-TANINAME (WRK-WIDX1 WRK-WIDX2)(1:2)
                                            =  "¡ö"
                   IF      TBL-ZAIW-RECEHENFLG (WRK-WIDX1 WRK-WIDX2) 
                                                =   "1"
                       MOVE    "¡Ë"    TO  
                               TBL-ZAIW-TANINAME   (WRK-WIDX1 WRK-WIDX2)
                       MOVE    2       TO  
                               TBL-ZAIW-TANIMOJISU (WRK-WIDX1 WRK-WIDX2)
                   ELSE
                       MOVE    SPACE   TO  
                              TBL-ZAIW-TANINAME (WRK-WIDX1 WRK-WIDX2)
                   END-IF
               ELSE
                   IF      TBL-ZAIW-RECEHENFLG (WRK-WIDX1 WRK-WIDX2) 
                                                =   "1"
                       COMPUTE WRK-RECEHENTANI =
                           TBL-ZAIW-TANIMOJISU (WRK-WIDX1 WRK-WIDX2)
                                           *   2
                       STRING    TBL-ZAIW-TANINAME (WRK-WIDX1 WRK-WIDX2)
                                                    (1:WRK-RECEHENTANI)
                                           DELIMITED   BY  SIZE
                             "¡Ë"          DELIMITED   BY  SIZE
                                           INTO    WRK-RECEHENTANINAME
                       END-STRING
                       MOVE    WRK-RECEHENTANINAME TO
                               TBL-ZAIW-TANINAME   (WRK-WIDX1 WRK-WIDX2)
                       COMPUTE
                           TBL-ZAIW-TANIMOJISU (WRK-WIDX1 WRK-WIDX2)  =
                           TBL-ZAIW-TANIMOJISU (WRK-WIDX1 WRK-WIDX2)
                                                                   +  1
                   END-IF
               END-IF
      *        Ì¾¾Î¤ÎÄ¹¤µ
               COMPUTE   WRK-NAMEKETA  =
                         TBL-ZAIW-YUKOKETA (WRK-WIDX1 WRK-WIDX2)
                         *   2
      *        -----------------------------------
      *        £±ÌÀºÙ¤Ë¿ôÎÌÃ±°Ì¤Þ¤Ç¼ý¤Þ¤ë¤«¤É¤¦¤«
      *        -----------------------------------
               EVALUATE    TRUE
               WHEN    WRK-NAMEKETA    >   50
      *            ÌÀºÙ¹Ô
                   MOVE    TBL-ZAIW-NAME (WRK-WIDX1 WRK-WIDX2)
                                       TO  WRK-KOUI
                   MOVE    WRK-KOUI    TO  WRK-ZAI-NAME
                   PERFORM 4303-ZAITBL-TENSO-SEC
      *
                   MOVE    SPACE       TO  WRK-KOUI
                   MOVE    SPACE       TO  WRK-ZAI-NAME
                   COMPUTE WRK-NAMEKETA    =   WRK-NAMEKETA  -  50
      *   ¡¡       < Ì¾¾Î¸åÈ¾ + ¶õÇò + ¿ôÎÌ + Ã±°Ì + Ê¬²è¿ô>
                   STRING  TBL-ZAIW-NAME     (WRK-WIDX1 WRK-WIDX2)
                                             (51:WRK-NAMEKETA)
                                              DELIMITED  BY  SIZE
                           "  "               DELIMITED  BY  SIZE
                           WRK-SRYSURYOW      DELIMITED  BY  " "
                           TBL-ZAIW-TANINAME (WRK-WIDX1 WRK-WIDX2)
                                              DELIMITED  BY  " "
                           "  "               DELIMITED  BY  SIZE
                           WRK-BUNKAKU-N      DELIMITED  BY  " "
                           INTO               WRK-KOUI
                   END-STRING
                   COMPUTE   WRK-WCLM
                         =   ( WRK-SURYOKETA                  *   2 )
                         +   ( TBL-ZAIW-TANIMOJISU (WRK-WIDX1 WRK-WIDX2)
                                                              *   2 )
                         +   WRK-NAMEKETA  +  2
                   IF      WRK-BUNKAKUKETA        >   ZERO
                       COMPUTE   WRK-WCLM    =   WRK-WCLM         +
                                                 WRK-BUNKAKUKETA  +
                                                 2
                   END-IF                                             
      *
               WHEN    WRK-NAMEKETA    =   50
      *            ¿ôÎÌ¡¦Ã±°Ì¡¡¼¡¹Ô°õ»ú½èÍý
                   PERFORM 43021-SURYO-NEXTPRT-SEC
      *
               WHEN    WRK-NAMEKETA    <   50
      *            ´Ö¤Î¶õÇòÊ¬¤òÂ­¤·¹þ¤à
                   COMPUTE   WRK-NAMEKETA  =   WRK-NAMEKETA   +   2
                   IF  WRK-NAMEKETA    <   50
      *                Í¾Çò
                       COMPUTE   WRK-YOHAKU  =   50  -   WRK-NAMEKETA
      *                ¿ôÎÌ¡¦Ê¬²è¿ô·å¿ô
                       COMPUTE   WRK-WKETA   =
                         ( WRK-SURYOKETA                  * 2 )
                             +
                         ( TBL-ZAIW-TANIMOJISU (WRK-WIDX1 WRK-WIDX2)
                                                          * 2 )
                       IF      WRK-BUNKAKUKETA   >   ZERO
                           COMPUTE   WRK-WKETA   =   WRK-WKETA        +
                                                     WRK-BUNKAKUKETA  +
                                                     2
                       END-IF                                             
      *
                       IF  WRK-YOHAKU        >=  WRK-WKETA
      *                    < Ì¾¾Î + ¶õÇò + ¿ôÎÌ + Ã±°Ì + ¶õÇò + Ê¬²è¿ô>
                          STRING  TBL-ZAIW-NAME (WRK-WIDX1 WRK-WIDX2)
                                                (1:WRK-NAMEKETA)
                                                  DELIMITED  BY  SIZE
                                   WRK-SRYSURYOW  DELIMITED  BY  " "
                                   TBL-ZAIW-TANINAME
                                                 (WRK-WIDX1 WRK-WIDX2)
                                                  DELIMITED  BY  " "
                                   "  "           DELIMITED  BY  SIZE
                                   WRK-BUNKAKU-N  DELIMITED  BY  " "
                                   INTO           WRK-KOUI
                           END-STRING
      *                    < Ì¾¾Î*2 + ¶õÇò*2 + ¿ôÎÌ + Ã±°Ì*2 + ¶õÇò + Ê¬²è¿ô>
                           COMPUTE   WRK-WCLM     =
                               ( TBL-ZAIW-YUKOKETA 
                                         (WRK-WIDX1 WRK-WIDX2)  * 2 )
                             + ( WRK-SURYOKETA                  * 2 )
                             + ( TBL-ZAIW-TANIMOJISU 
                                         (WRK-WIDX1 WRK-WIDX2)  * 2 )
                             +  2
                           IF      WRK-BUNKAKUKETA   >   ZERO
                               COMPUTE   WRK-WCLM   =   WRK-WCLM      +
                                                     WRK-BUNKAKUKETA  +
                                                     2
                           END-IF                                             
                       ELSE
      *                    ¿ôÎÌ¡¦Ã±°Ì¡¡¼¡¹Ô°õ»ú½èÍý
                           PERFORM 43021-SURYO-NEXTPRT-SEC
                       END-IF
                   ELSE
      *                ¿ôÎÌ¡¦Ã±°Ì¡¡¼¡¹Ô°õ»ú½èÍý
                       PERFORM 43021-SURYO-NEXTPRT-SEC
                   END-IF
               END-EVALUATE
           END-IF
           MOVE    WRK-KOUI        TO  WRK-ZAI-NAME
      *
           .
       4302-MEISAI-KETA-HEN1-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ôÎÌ¡¦Ã±°Ì¡¡¼¡¹ÔÊÔ½¸½èÍý
      *****************************************************************
       43021-SURYO-NEXTPRT-SEC    SECTION.
      *
      *    < Ì¾¾Î >
           MOVE    TBL-ZAIW-NAME (WRK-WIDX1 WRK-WIDX2)
                                      TO  WRK-KOUI
           MOVE    WRK-KOUI           TO  WRK-ZAI-NAME
           PERFORM 4303-ZAITBL-TENSO-SEC
      *
           MOVE    SPACE              TO  WRK-KOUI
           MOVE    SPACE              TO  WRK-ZAI-NAME
      *    < ¶õÇò + ¿ôÎÌ + Ã±°Ì + ¶õÇò + Ê¬²è¿ô>
           STRING  "    "             DELIMITED  BY  SIZE
                   WRK-SRYSURYOW      DELIMITED  BY  " "
                   TBL-ZAIW-TANINAME (WRK-WIDX1 WRK-WIDX2)
                                      DELIMITED  BY  " "
                   "  "               DELIMITED  BY  SIZE
                   WRK-BUNKAKU-N      DELIMITED  BY  " "
                   INTO               WRK-KOUI
           END-STRING
           COMPUTE   WRK-WCLM
                 =   ( WRK-SURYOKETA                  *   2 )
                 +   ( TBL-ZAIW-TANIMOJISU (WRK-WIDX1 WRK-WIDX2)
                                                      *   2 )
                 +   4
           IF      WRK-BUNKAKUKETA   >   ZERO
               COMPUTE   WRK-WCLM   =   WRK-WCLM         +
                                        WRK-BUNKAKUKETA  +
                                        2
           END-IF                                             
      *
           .
       43021-SURYO-NEXTPRT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ºÞ¡¦¿ÇÎÅ¹Ô°Ù¥Æ¡¼¥Ö¥ëÊÔ½¸½èÍý
      *****************************************************************
       4303-ZAITBL-TENSO-SEC    SECTION.
      *
           ADD     1                 TO  WRK-TBLMAX
      ***  IF  WRK-TBLMAX           >   100
           IF  WRK-TBLMAX           >   300
               DISPLAY "*** ORCR1260 TBL-ZAI INDEX[300] OVER  ***"
           ELSE
               MOVE    WRK-ZAI       TO  TBL-ZAI (WRK-TBLMAX)
               IF      RECE220-SRYKBN      =  "33"
                  MOVE    IDX1       TO  TBL-ZAI-IDX(WRK-TBLMAX)
                  MOVE    TBL-ZAIW-SRYCD(IDX1 IDX2)  
                                     TO  TBL-ZAI-SRYCD(WRK-TBLMAX)
               END-IF
               MOVE    SPACE         TO  WRK-ZAI
           END-IF
      *
           .
       4303-ZAITBL-TENSO-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ô²ó¿ô¥»¥Ã¥È½èÍý
      *****************************************************************
       440-TNSKAI-SET-SEC          SECTION.
      *
      ***  IF   RECE220-ZAIKBN      =    1 OR 2
           IF   RECE220-ZAIKBN      =    2
             CONTINUE
           ELSE
             IF ((FLG-COMMENT        =    1                  ) AND
                 (RECE220-SRYKBN     =   "99"                ))
             OR ((FLG-COMMENT2       =    1                  ) AND
                 (RECE220-SRYKBN     =   "11" OR "99"        ))
             OR ((FLG-COMMENT3       =    1                  ) AND
                 (RECE220-SRYKBN     =   "11"                ) AND
                 (WRK-TENSUGOKEI     =   ZERO                ))
             OR ((FLG-COMMENT3       =    1                  ) AND
                 (RECE220-SRYKBN     NOT =  "11"             ) AND
                 (RECE220-ZAITEN     =   ZERO                ) AND
                 (RECE220-TOYAKUFLG  =   SPACE               ) AND
                 (RECE220-YKZKISAIFLG
                                     =   SPACE               ))
             OR ( RECE220-SAFLG  NOT =   SPACE                )
             OR ( RECE220-TOYAKUFLG  =   "2" OR "4"           )
             OR ( RECE220-ZAIKBN     =    1                   )
                  GO  TO  440-TNSKAI-SET-EXT
             END-IF
           END-IF
      *
           IF      IDY               >   ZERO         
               MOVE    WRK-TNSKAI-ST     TO  IDA
               COMPUTE   IDA             =   IDA     -   2
               MOVE    WRK-TNSKAI-KETA   TO  IDB
      *
      *        ºÇ½ªÌÀºÙ¤ËÅÀ¿ô¡¦²ó¿ô¤ò°õ»ú¤¹¤ë¥¹¥Ú¡¼¥¹Í­¤ê
               MOVE    TBL-ZAI (IDY)(3:)     TO  WRK-ZAI-NAME
               IF  WRK-ZAI-NAME (IDA:)       =   SPACE
                   COMPUTE   WRK-TNSKAI-ST   =   22
                                             -   WRK-TNSKAI-KETA
                   ADD     1                 TO  WRK-TNSKAI-ST
                   MOVE    WRK-TNSKAI (WRK-TNSKAI-ST:IDB)
                                             TO  WRK-ZAI-TNSKAI
                                                    (WRK-TNSKAI-ST:)
                   MOVE    WRK-ZAI-NAME      TO  TBL-ZAI (IDY)(3:)
               ELSE
      *        ºÇ½ªÌÀºÙ¤ËÅÀ¿ô¡¦²ó¿ô¤ò°õ»ú¤¹¤ë¥¹¥Ú¡¼¥¹Ìµ¤·
                   ADD     1                 TO  IDY
      ***          IF  IDY                   >   100
                   IF  IDY                   >   300
                       DISPLAY
                           "*#* ORCR1260 TBL-ZAI INDEX[300] OVER  ***"
                   ELSE
                       MOVE    SPACE             TO  WRK-ZAI
                       MOVE    WRK-TNSKAI        TO  WRK-ZAI-TNSKAI
                       MOVE    WRK-ZAI           TO  TBL-ZAI (IDY)
                       IF      RECE220-SRYKBN      =  "33"
                           MOVE    TBL-ZAI-IDX(WRK-TBLMAX)
                                                 TO  TBL-ZAI-IDX(IDY)
                           MOVE    TBL-ZAI-SRYCD(WRK-TBLMAX)
                                                 TO  TBL-ZAI-SRYCD(IDY)
                       END-IF
                       MOVE    SPACE             TO  WRK-ZAI
                   END-IF
               END-IF        
           END-IF
      *
           .
       440-TNSKAI-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥È£°£¶½ÐÎÏ½èÍý
      *****************************************************************
       450-RECE240-OUT-SEC    SECTION.
      *
           PERFORM   VARYING   IDY   FROM    1   BY  1
                     UNTIL     IDY   >   WRK-TBLMAX
      *
               ADD     1                 TO  WRK-LINENUM
               MOVE    SPACE             TO  RECE240-REC
               INITIALIZE                    RECE240-REC
               MOVE    RECE200-KEY       TO  RECE240-KEY1
               MOVE    RECE220-ZAINUM    TO  RECE240-ZAINUM
               MOVE    WRK-LINENUM       TO  RECE240-LINENUM
               MOVE    WRK-TBLMAX        TO  RECE240-ZAIMEISAISU
               MOVE    RECE220-PTNUM     TO  RECE240-PTNUM
               MOVE    RECE220-SRYKBN    TO  RECE240-SRYKBN
               MOVE    RECE220-ZAISKBKBN TO  RECE240-ZAISKBKBN
               IF    RECE220-ZAISKBKBN   =   "1" OR "2" OR "4"
                   MOVE   RECE220-ZAINUM TO  RECE240-ZAISKBBAN
               END-IF
               IF    RECE220-ZAISKBKBN  =   "6"
               AND   RECE220-NYUSAIFLG  =   "1"
                   MOVE   99999999       TO  RECE240-ZAISKBBAN
               END-IF
               MOVE    TBL-ZAI (IDY)     TO  RECE240-TEKIYO-INF
      *
               IF      RECE220-SRYKBN      =  "33"
      *
                IF     RECE200-SRYYM      >=  "200804"
                  IF  (WRK-SRYSYUKBN      =  "330" OR "332"            )
                  AND (TBL-ZAI-SRYCD(1)   =  "130003710" OR "130003810")
                          MOVE   1              TO  RECE240-TENTEKIKBN
                  END-IF
                  IF  (WRK-SRYSYUKBN      =  "330" OR "332"            )
                  AND (TBL-ZAI-SRYCD(1)   =  "130000110" OR "130000210"
                                          OR "130000310"               )
                  AND (RECE240-TENTEKIKBN  =  ZERO                     )
                          MOVE   2              TO  RECE240-TENTEKIKBN
                  END-IF
                  IF  (WRK-SRYSYUKBN      =  "330" OR "332")
                  AND (RECE240-TENTEKIKBN =  ZERO          )
                    IF  (RECE220-ZAITEN  NOT =  ZERO          )
                    AND (RECE220-YKZTEN      =  ZERO          )
                    AND (RECE220-KIZAITEN    =  ZERO          )
                    AND (RECE220-JIHOKBN     =  SPACE         )
                          MOVE   3              TO  RECE240-TENTEKIKBN
                    END-IF
                    IF  (RECE220-HOKATU-ZAITEN  NOT =  ZERO   )
                    AND (RECE220-HOKATU-YKZTEN      =  ZERO   )
                    AND (RECE220-HOKATU-KIZAITEN    =  ZERO   )
                    AND (RECE220-JIHOKBN        NOT =  SPACE  )
                          MOVE   3              TO  RECE240-TENTEKIKBN
                    END-IF
                  END-IF
      *
                  IF  (WRK-SRYSYUKBN      =  "340")
                  AND (TBL-ZAI-SRYCD(1)   =  "130004410" OR "130008510"
                                          OR "130004670"               )
                    IF  (RECE220-YKZTEN      =  ZERO )
                    AND (RECE220-KIZAITEN    =  ZERO )
                    AND (RECE220-JIHOKBN     =  SPACE)
                          MOVE   4              TO  RECE240-TENTEKIKBN
                    END-IF
                    IF  (RECE220-HOKATU-YKZTEN      =  ZERO )
                    AND (RECE220-HOKATU-KIZAITEN    =  ZERO )
                    AND (RECE220-JIHOKBN        NOT =  SPACE)
                          MOVE   4              TO  RECE240-TENTEKIKBN
                    END-IF
                  END-IF
                  IF  (WRK-SRYSYUKBN      =  "340")
                  AND (TBL-ZAI-SRYCD(1)   =  "130000110" OR "130000210"
                                          OR "130000310"               )
                  AND (RECE240-TENTEKIKBN =  ZERO )
                    IF  (RECE220-YKZTEN      =  ZERO )
                    AND (RECE220-KIZAITEN    =  ZERO )
                    AND (RECE220-JIHOKBN     =  SPACE)
                          MOVE   5              TO  RECE240-TENTEKIKBN
                    END-IF
                    IF  (RECE220-HOKATU-YKZTEN    =  ZERO )
                    AND (RECE220-HOKATU-KIZAITEN  =  ZERO )
                    AND (RECE220-JIHOKBN      NOT =  SPACE)
                          MOVE   5              TO  RECE240-TENTEKIKBN
                    END-IF
                  END-IF
                ELSE
                  IF  (WRK-SRYSYUKBN      =  "330" OR "332"            )
                  AND (TBL-ZAI-SRYCD(1)   =  "130003710" OR "130003810"
                                          OR "130700310" OR "130700410"
                                          OR "130702910" OR "130701010"
                                          OR "130702810"               )
                          MOVE   1              TO  RECE240-TENTEKIKBN
                  END-IF
                  IF  (WRK-SRYSYUKBN      =  "330" OR "332"            )
                  AND (TBL-ZAI-SRYCD(1)   =  "130000110" OR "130000210"
                                          OR "130000310" OR "130008270"
                                          OR "130701270" OR "130004570"
                                          OR "130009670" OR "130701370"
                                          OR "130010570" OR "130702670"
                                          OR "130010670" OR "130702770"
                                          OR "130011070"               )
                  AND (RECE240-TENTEKIKBN  =  ZERO                     )
                          MOVE   2              TO  RECE240-TENTEKIKBN
                  END-IF
                  IF  (WRK-SRYSYUKBN       =  "330" OR "332")
                  AND (RECE220-ZAITEN  NOT =  ZERO          )
                  AND (RECE220-YKZTEN      =  ZERO          )
                  AND (RECE220-KIZAITEN    =  ZERO          )
                  AND (RECE240-TENTEKIKBN  =  ZERO          )
                          MOVE   3              TO  RECE240-TENTEKIKBN
                  END-IF
      *
                  IF  (WRK-SRYSYUKBN      =  "340")
                  AND (TBL-ZAI-SRYCD(1)   =  "130004410" OR "130008510"
                                          OR "130004670"               )
                  AND (RECE220-YKZTEN      =  ZERO )
                  AND (RECE220-KIZAITEN    =  ZERO )
                          MOVE   4              TO  RECE240-TENTEKIKBN
                  END-IF
                  IF  (WRK-SRYSYUKBN      =  "340")
                  AND (TBL-ZAI-SRYCD(1)   =  "130000110" OR "130000210"
                                          OR "130000310" OR "130008270"
                                          OR "130701270" OR "130004570"
                                          OR "130009670" OR "130701370"
                                          OR "130010570" OR "130702670"
                                          OR "130010670" OR "130702770"
                                          OR "130011070"               )
                  AND (RECE220-YKZTEN      =  ZERO )
                  AND (RECE220-KIZAITEN    =  ZERO )
                  AND (RECE240-TENTEKIKBN  =  ZERO )
                          MOVE   5              TO  RECE240-TENTEKIKBN
                  END-IF
                END-IF
      *
                IF   WRK-SRYSYUKBN   =  "330" OR "331" OR "332" OR
                                        "350" OR "352"
                  IF   (RECE220-YKZTEN             NOT =  ZERO )
                  AND  (RECE220-JIHOKBN                =  SPACE)
                  AND  (RECE240-TENTEKIKBN             =  ZERO )
                          MOVE   6              TO  RECE240-TENTEKIKBN
                  END-IF
                  IF   (RECE220-HOKATU-YKZTEN      NOT =  ZERO )
                  AND  (RECE220-JIHOKBN            NOT =  SPACE)
                  AND  (RECE240-TENTEKIKBN             =  ZERO )
                          MOVE   6              TO  RECE240-TENTEKIKBN
                  END-IF
                  IF   (RECE220-KIZAITEN           NOT =  ZERO )
                  AND  (RECE220-JIHOKBN                =  SPACE)
                  AND  (RECE240-TENTEKIKBN             =  ZERO )
                          MOVE   7              TO  RECE240-TENTEKIKBN
                  END-IF
                  IF   (RECE220-HOKATU-KIZAITEN    NOT =  ZERO )
                  AND  (RECE220-JIHOKBN            NOT =  SPACE)
                  AND  (RECE240-TENTEKIKBN             =  ZERO )
                          MOVE   7              TO  RECE240-TENTEKIKBN
                  END-IF
                END-IF
      *
                IF   WRK-SRYSYUKBN   =  "340"
                  IF   (RECE220-ZAITEN             NOT =  ZERO )
                  AND  (RECE220-JIHOKBN                =  SPACE)
                  AND  (RECE240-TENTEKIKBN             =  ZERO )
                          MOVE   8              TO  RECE240-TENTEKIKBN
                  END-IF
                  IF   (RECE220-HOKATU-ZAITEN      NOT =  ZERO )
                  AND  (RECE220-JIHOKBN            NOT =  SPACE)
                  AND  (RECE240-TENTEKIKBN             =  ZERO )
                          MOVE   8              TO  RECE240-TENTEKIKBN
                  END-IF
                END-IF
      *
      **********°Ê²¼¥³¥á¥ó¥È¤Î¤ßÊ¬
                IF   (RECE240-TENTEKIKBN       =  ZERO )
                         MOVE   9              TO  RECE240-TENTEKIKBN
                END-IF
      *
               END-IF
      *
               IF    ( FLG-COMMENT2      =   1   )               
               AND   ( RECE220-SRYKBN    =  "11" )               
                   MOVE  SPACE           TO  RECE240-SRYKBN              
               END-IF        
      *
               IF      IDY               =   1
                 IF       (WRK-ZAIW-SRYCD1(1:1)  =   "6"  OR  "7")
                 OR       (WRK-ZAIW-SRYCD1(1:3)  =   "059"       )
                 OR       (RECE220-SAFLG     NOT  =   SPACE      )
                 OR       (RECE220-ZAIKBN         =    1         )
                     MOVE    ALL "9"            TO
                                            WRK-ZAIW-CDKBN-AREA
                     IF   (RECE220-SAFLG     NOT  =   SPACE)
                     OR   (RECE220-ZAIKBN         =    1   )
                         MOVE    999999999   TO  WRK-ZAIW-KOUHYOJYUNNUM
                     ELSE
                       IF    WRK-ZAIW-SRYCD1(1:1)  =   "6"
                         MOVE    999999997   TO  WRK-ZAIW-KOUHYOJYUNNUM
                       ELSE
                         MOVE    999999998   TO  WRK-ZAIW-KOUHYOJYUNNUM
                       END-IF
                     END-IF
                 END-IF
                 IF        WRK-ZAIW-SRYCD1  =  "102900010" OR
                                               "102900020" OR
                                               "102900030" OR
                                               "102900040"
                     MOVE    ALL "9"            TO
                                            WRK-ZAIW-CDKBN-AREA
                     EVALUATE   WRK-ZAIW-SRYCD1
                       WHEN      "102900010"
                         MOVE    999999996   TO  WRK-ZAIW-KOUHYOJYUNNUM
                       WHEN      "102900020"
                         MOVE    999999997   TO  WRK-ZAIW-KOUHYOJYUNNUM
                       WHEN      "102900030"
                         MOVE    999999998   TO  WRK-ZAIW-KOUHYOJYUNNUM
                       WHEN      "102900040"
                         MOVE    999999999   TO  WRK-ZAIW-KOUHYOJYUNNUM
                     END-EVALUATE
                 END-IF
               END-IF
               MOVE    WRK-ZAIW-CDKBN-SYO  TO  RECE240-CDKBN-SYO
               MOVE    WRK-ZAIW-CDKBN-BU   TO  RECE240-CDKBN-BU
               MOVE    WRK-ZAIW-CDKBN-KBN  TO  RECE240-CDKBN-KBN
               MOVE    WRK-ZAIW-CDKBN-KBNNUM
                                           TO  RECE240-CDKBN-KBNNUM
               MOVE    WRK-ZAIW-CDKBN-KBNNUM-EDA
                                           TO  RECE240-CDKBN-KBNNUM-EDA
               MOVE    WRK-ZAIW-CDKBN-KOUBAN
                                           TO  RECE240-CDKBN-KOUBAN
               MOVE    WRK-ZAIW-KOUHYOJYUNNUM
                                           TO  RECE240-KOUHYOJUNNUM
      *
               IF    RECE220-GAZOGEN = "1"
                  MOVE    202              TO  RECE240-CDKBN-KBNNUM
                  MOVE    99               TO  RECE240-CDKBN-KOUBAN
                  MOVE    ZERO             TO  RECE240-KOUHYOJUNNUM
               END-IF
      *
               IF    RECE220-JIHOKBN = SPACE
                  MOVE    RECE220-ZAITEN         TO  RECE240-ZAITEN
               ELSE
                  MOVE    RECE220-HOKATU-ZAITEN  TO  RECE240-ZAITEN
               END-IF
      *
               IF      RECE220-SRYKBN     =   "60" OR "64"
                       MOVE   WRK-ZAIW-KNSJISKBN
                                             TO  RECE240-KNSJISKBN
               ELSE
                       MOVE   ZERO           TO  RECE240-KNSJISKBN
               END-IF
      *
               MOVE    RECE220-SAFLG          TO  RECE240-SAFLG
               MOVE    RECE220-ZAIKBN         TO  RECE240-ZAIKBN
      *
               MOVE       SPACE          TO  RECE240-SRYSYUKBN
               MOVE       ZERO           TO  RECE240-DAY
               MOVE       ZERO           TO  RECE240-DAY2
               EVALUATE  RECE220-SRYKBN
                 WHEN      "21"
                 WHEN      "22"
                 WHEN      "23"
                 WHEN      "33"
                 WHEN      "40"
                   PERFORM   VARYING   IDW3   FROM    1   BY  1
                              UNTIL    IDW3   >      31
                       IF    RECE220-KAISU(1 IDW3)    NOT =   ZERO
                          MOVE   IDW3    TO  RECE240-DAY
                          MOVE    31     TO  IDW3
                       END-IF
                   END-PERFORM
                 WHEN      "50"
                 WHEN      "54"
                   MOVE   WRK-SRYSYUKBN  TO  RECE240-SRYSYUKBN
                   PERFORM   VARYING   IDW3   FROM    1   BY  1
                              UNTIL    IDW3   >      31
                       IF    RECE220-KAISU(1 IDW3)    NOT =   ZERO
                          MOVE   IDW3    TO  RECE240-DAY
                          MOVE    31     TO  IDW3
                       END-IF
                   END-PERFORM
                 WHEN      "70"
                   IF    RECE220-GAZOGEN = "1"
                     PERFORM   VARYING   IDW3   FROM    1   BY  1
                                UNTIL    IDW3   >      31
                       IF    RECE220-KAISU(1 IDW3)    NOT =   ZERO
                          MOVE   IDW3    TO  RECE240-DAY2
                          MOVE    31     TO  IDW3
                       END-IF
                     END-PERFORM
                   END-IF
                 WHEN      "99"
                   MOVE   WRK-SRYSYUKBN  TO  RECE240-SRYSYUKBN
               END-EVALUATE
      *
               MOVE    RECE220-JIHOKBN   TO  RECE240-JIHOKBN
      *
               PERFORM 4501-RECE240-WRITE-SEC
      *
               IF      STS-RECE240     NOT =   ZERO
                   MOVE   WRK-TBLMAX     TO  IDY
               END-IF
           END-PERFORM
      *     
           INITIALIZE                    TBL-ZAI-AREA
      *
           .
       450-RECE240-OUT-EXT.
           EXIT.
      *
      *****************************************************************
      *    Å¬ÍÑÍóÌÀºÙ¾ðÊó¥Õ¥¡¥¤¥ë½ÐÎÏ½èÍý
      *****************************************************************
       4501-RECE240-WRITE-SEC                SECTION.
      *
           IF      RECE240-ZAINUM      =   99999999
               MOVE     ZERO               TO  RECE240-ZAINUM
           END-IF
           IF      RECE240-SRYKBN      =   "60" OR "64"
               IF      RECE240-KNSJISKBN   =   2
                   MOVE    5                   TO  RECE240-KNSJISKBN
               ELSE
                   IF    ( RECE240-CDKBN-KBNNUM    >=  0   )   AND
                         ( RECE240-CDKBN-KBNNUM    <=  199 )
                       MOVE   1                TO  RECE240-KNSJISKBN
                   END-IF
                   IF    ( RECE240-CDKBN-KBNNUM    >=  400 )   AND
                         ( RECE240-CDKBN-KBNNUM    <=  499 )
                       MOVE   2                TO   RECE240-KNSJISKBN
                   END-IF
                   IF    ( RECE240-CDKBN-KBNNUM    >=  200 )   AND
                         ( RECE240-CDKBN-KBNNUM    <=  399 )
                       MOVE   3                TO  RECE240-KNSJISKBN
                   END-IF
                   IF      RECE240-CDKBN-KBN       =  "9"
                       MOVE   4                TO  RECE240-KNSJISKBN
                   END-IF
               END-IF
               IF   (RECE240-SAFLG   NOT =  SPACE)
               OR   (RECE240-ZAIKBN  NOT =  ZERO )
                   MOVE    9               TO  RECE240-KNSJISKBN
               END-IF
           END-IF
      *
           IF     (RECE240-SRYKBN         =  "99" )
           AND    (RECE240-SRYSYUKBN  NOT =  "991")
               MOVE  SPACE                 TO  RECE240-SRYKBN
           END-IF
      *
           IF      RECE240-SRYKBN      NOT =   "21" AND "22" AND "23"
               IF      RECE240-SRYKBN  NOT =   "40" AND "60" AND "80"
                                                    AND "64"
                   CONTINUE
               ELSE 
                   INITIALIZE              RECE240-ZAITEN
               END-IF
           ELSE
               INITIALIZE                  RECE240-ZAITEN
               INITIALIZE                  RECE240-CDKBN-SYO
                                           RECE240-CDKBN-BU
                                           RECE240-CDKBN-KBN
                                           RECE240-CDKBN-KBNNUM
                                           RECE240-CDKBN-KBNNUM-EDA
                                           RECE240-CDKBN-KOUBAN
                                           RECE240-KOUHYOJUNNUM
           END-IF
      *
           WRITE   RECE240-REC
      *
           IF      STS-RECE240     NOT =   ZERO
               DISPLAY "*** ORCR1260 RECE240 WRITE ERR  ***"
               DISPLAY "*** RECE240-SRYKBN ***" RECE240-SRYKBN
               DISPLAY "*** RECE240-ZAINUM ***" RECE240-ZAINUM
               MOVE    2               TO  SPA-STS
           ELSE
               ADD     1               TO  CNT-RECE240
           END-IF
      *
           .
       4501-RECE240-WRITE-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥¨¥é¡¼½ÐÎÏ½èÍý
      *****************************************************************
       500-ERR-HENSYU-SEC                SECTION.
      *
           OPEN    INPUT   RECEERR-FILE
           IF      STS-RECEERR         =   ZERO
               CLOSE   RECEERR-FILE
           ELSE
               OPEN    OUTPUT              RECEERR-FILE
      *
               MOVE    WRK-RECEERR         TO  RECEERR-REC
               WRITE   RECEERR-REC
               CLOSE   RECEERR-FILE
      *         
               IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *            ¥¸¥ç¥Ö´ÉÍý½ªÎ»½èÍý
                   MOVE    "JBE"           TO  SJOBKANRI-MODE
                   INITIALIZE                  JOBKANRI-REC
                   MOVE    WRK-RECEERR     TO  JOB-YOBI
                   MOVE    "9999"          TO  JOB-ERRCD
                   PERFORM   900-CALL-ORCSJOB-SEC
               END-IF
           END-IF
      *                             
           MOVE    1                   TO  FLG-END
           MOVE    2                   TO  SPA-STS
      *
           .
       500-ERR-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½èÍýÃæ»ß½èÍý
      *****************************************************************
       500-CANCEL-HENSYU-SEC                SECTION.
      *
           IF      WRK-PARA-SHELLID    =   "RECEPTX"
               CONTINUE
           ELSE
               MOVE    "CHK"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               PERFORM   900-CALL-ORCSJOB-SEC
               IF    ( SJOBKANRI-RETURN
                                       =   ZERO )
               AND   ( JOB-STOPFLG     =   1    )
                   MOVE    "½èÍý¤¬Ãæ»ß¤µ¤ì¤Þ¤·¤¿"
                                           TO  WRK-RECEERR
      *
                   OPEN    INPUT   RECEERR-FILE
                   IF      STS-RECEERR         =   ZERO
                       CLOSE   RECEERR-FILE
                   ELSE
                       OPEN    OUTPUT              RECEERR-FILE
      *    
                       MOVE    WRK-RECEERR         TO  RECEERR-REC
                       WRITE   RECEERR-REC
                       CLOSE   RECEERR-FILE
      *         
      *                ¥¸¥ç¥Ö´ÉÍý½ªÎ»½èÍý
                       MOVE    "CAN"           TO  SJOBKANRI-MODE
                       INITIALIZE                  JOBKANRI-REC
                       MOVE    WRK-RECEERR     TO  JOB-YOBI
                       MOVE    "8888"          TO  JOB-ERRCD
                       MOVE    2               TO  JOB-STOPFLG
                       PERFORM   900-CALL-ORCSJOB-SEC
                   END-IF
      *                             
                   MOVE    1                   TO  FLG-END
                   MOVE    2                   TO  SPA-STS
               END-IF
           END-IF
           .
       500-CANCEL-HENSYU-EXT.
           EXIT.
      *
      *****************************************************************
      *    ½ªÎ»¡¡¡¡½èÍý
      *****************************************************************
       300-END-SEC                 SECTION.
      *
      *    ¥Õ¥¡¥¤¥ë£Ã£Ì£Ï£Ó£Å½èÍý
           CLOSE                       RECE200-FILE
           CLOSE                       RECE220-FILE
           CLOSE                       RECE230-FILE
           CLOSE                       RECE240-FILE     
      *
           IF      WRK-PARA-SHELLID    NOT =   "RECEPTX"
      *        ¥¹¥Æ¥Ã¥×´ÉÍý½ªÎ»½èÍý
               MOVE    "STE"           TO  SJOBKANRI-MODE
               INITIALIZE                  JOBKANRI-REC
               PERFORM   900-CALL-ORCSJOB-SEC
      *
               PERFORM 900-DBDISCONNECT-SEC
           END-IF
      *
           DISPLAY "RECE200  IN  " CNT-RECE200   
           DISPLAY "RECE240  CNT " CNT-RECE240 
           DISPLAY "*** ORCR1260 END ***"
      *
           .
       300-END-EXT.
           EXIT.
      *
      *****************************************************************
      *    °ì»þ¥Õ¥¡¥¤¥ëÌ¾¼èÆÀ½èÍý
      *****************************************************************
       800-FILENM-SET-SEC        SECTION.
      *
           MOVE    WRK-PARA-TERMID     TO  RECEDAT1PARA-TERMID
           MOVE    WRK-PARA-HOSPNUM    TO  RECEDAT1PARA-HOSPNUM
           MOVE    SGETTEMP-TEMPDIR    TO  TEMPFLPARA
           MOVE    RECEDAT1PARA-BASENAME
                                       TO  TEMPFLPARA (SGETTEMP-ST:)
           .
       800-FILENM-SET-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¿ôÃÍÈ¾³Ñ¢ªÁ´³ÑÊÑ´¹½èÍý
      *****************************************************************
       800-NUM-ZENKAKU-HENKAN-SEC    SECTION.
      *
      *    FLG=1¤Î¤È¤­¶õÇò¤ÏÊÔ½¸¤·¤Ê¤¤
      *
           MOVE    1                   TO  WRK-CHAR-IDX
           MOVE    ZERO                TO  WRK-CHAR-N-CNT
      *     
           PERFORM VARYING     IDZ     FROM    1   BY  1
                   UNTIL       IDZ     >   WRK-CHAR-CNT
               IF      WRK-CHAR-FLG        =   1
               AND     WRK-CHAR-X (IDZ:1)  =   SPACE
                   CONTINUE
               ELSE        
                   IF    WRK-CHAR-X (IDZ:1)  IS  NUMERIC
                       IF      WRK-CHAR-X (IDZ:1)  =   "0"
                           MOVE    TBL-SUJI (10)
                                       TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       ELSE
                           MOVE    WRK-CHAR-X (IDZ:1)  TO  WRK-NUM
                           MOVE    TBL-SUJI (WRK-NUM)
                                       TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                       END-IF                    
                   ELSE
                       MOVE    "  "    TO  WRK-CHAR-N (WRK-CHAR-IDX:)
                   END-IF
                   ADD     2           TO  WRK-CHAR-IDX
                                           WRK-CHAR-N-CNT
               END-IF    
           END-PERFORM
      *
           .
       800-NUM-ZENKAKU-HENKAN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ÅÀ¿ô¡¦²ó¿ôÊÔ½¸½èÍý
      *****************************************************************
       810-TENSUKAI-HEN-SEC    SECTION.
      *    ÅÀ¿ôÊÔ½¸
           INITIALIZE                      WRK-CHAR-HENKAN-AREA
           MOVE    WRK-ZAITENX         TO  WRK-CHAR-X
           MOVE    7                   TO  WRK-CHAR-CNT
           PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
           MOVE    WRK-CHAR-N          TO  WRK-ZAITEN
      *    ²ó¿ôÊÔ½¸
           INITIALIZE                      WRK-CHAR-HENKAN-AREA
           MOVE    WRK-ZAIKAISUX       TO  WRK-CHAR-X
           MOVE    3                   TO  WRK-CHAR-CNT
           PERFORM 800-NUM-ZENKAKU-HENKAN-SEC
           MOVE    WRK-CHAR-N          TO  WRK-ZAIKAISU
           MOVE    "¡ß"                TO  WRK-X
      *
      *    ÌôºÞÎÁÄþ¸º¡¦Ì¤¼Â»Ü¸º»»¤Î¤È¤­ÅÀ¿ô¤Î¤Þ¤¨¤Ë¢¥¤òÉ½¼¨
           IF      FLG-TEIGEN          =   1
               PERFORM VARYING IDZ FROM    13  BY  -2
                       UNTIL   IDZ <       3
                   IF      WRK-ZAITEN (IDZ:2)  =   SPACE
                       MOVE    "¢¥"        TO  WRK-ZAITEN (IDZ:2)
                       MOVE    1           TO  IDZ
                   END-IF
               END-PERFORM
           END-IF
      *
      *
      *    É¬Í×Í­¸ú·å¿ô¡ÊÅÀ¿ôZZZZZZZ X ¿ôÎÌZZZ ¤ÎÁ´³Ñ¤Î·å¿ô¡Ë
           MOVE    ZERO                TO  WRK-TNSKAI-KETA
           PERFORM VARYING   IDZ     FROM    1   BY  1
                   UNTIL     IDZ     >       22
               IF      WRK-TNSKAI (IDZ:1)      NOT =   SPACE
                   COMPUTE WRK-TNSKAI-KETA   =   22  -  IDZ     +   1
                   MOVE    22                  TO  IDZ
               END-IF 
           END-PERFORM
      *    ³«»Ï°ÌÃÖ¤ò¼èÆÀ
           COMPUTE   WRK-TNSKAI-ST     =   ( 50  -  WRK-TNSKAI-KETA )
                                       +   1
      *
           .
       810-TENSUKAI-HEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥ì¥»¥×¥È£°£²¥Ç¡¼¥¿½ç¸¡º÷½èÍý
      *****************************************************************
       990-RECE200-READ-SEC           SECTION.
      *
           READ    RECE200-FILE         NEXT
               AT  END
                   MOVE    1           TO  FLG-END
                   MOVE    2           TO  SPA-STS
               NOT AT  END
                   ADD     1           TO  CNT-RECE200
      *
                   DISPLAY "RECE200  PTNUM=" RECE200-PTNUM
      *
           END-READ
      *
           .
       990-RECE200-READ-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¥ì¥»¥×¥È£°£´¥Ç¡¼¥¿ÆÉ¤ß
      ****************************************************************
       990-RECE220-NEXT-SEC           SECTION.
      *
           READ    RECE220-FILE       NEXT
               AT  END
                   MOVE    1         TO  FLG-RECE220
               NOT AT  END
                   MOVE    ZERO      TO  FLG-RECE220
                   ADD     1         TO  CNT-IN-CANCEL
                   IF   (WRK-PARA-PRTKBN        =   "1"  )
                   AND  (RECE220-TOYAKUFLG  NOT =   SPACE)
                       GO  TO  990-RECE220-NEXT-SEC
                   END-IF
           END-READ
      *
           .
       990-RECE220-NEXT-EXT.
           EXIT.
      *
      ****************************************************************
      *    ¥ì¥»¥×¥È£°£µ¥Ç¡¼¥¿ÆÉ¤ß
      ****************************************************************
       990-RECE230-NEXT-SEC           SECTION.
      *
           READ    RECE230-FILE       NEXT
               AT  END
                   MOVE    1         TO  FLG-RECE230
               NOT AT  END
                   MOVE    ZERO      TO  FLG-RECE230
                                         CNT-IN-CANCEL
           END-READ
      *
           .
       990-RECE230-NEXT-EXT.
           EXIT.
      *
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       900-CLOSE-SEC               SECTION.
      *
           MOVE    "DBCLOSECURSOR"     TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-CLOSE-EXT.
           EXIT.
      *      
      *****************************************************************
      *    ¥¸¥ç¥Ö´ÉÍý£Ä£ÂÀ©¸æ½èÍý
      *****************************************************************
       900-CALL-ORCSJOB-SEC            SECTION.
      *
           MOVE    WRK-PARA-JOBID  TO  JOB-JOBID
           MOVE    WRK-PARA-SHELLID
                                   TO  JOB-SHELLID
           MOVE    SPA-HOSPNUM     TO  JOB-HOSPNUM
           CALL    "ORCSJOB"       USING
                                   ORCSJOBKANRIAREA 
                                   JOBKANRI-REC
                                   SPA-AREA
           .
       900-CALL-ORCSJOB-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â£Ó£Å£Ì£Å£Ã£Ô½èÍý
      *****************************************************************
       900-DBSELECT-SEC                SECTION.
      *
           MOVE    "DBSELECT"          TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
           IF      MCP-RC              =   ZERO
               CONTINUE
           ELSE
               DISPLAY "SELECT ERR table=" MCP-TABLE
                       " pathname="        MCP-PATHNAME
           END-IF
           .
       900-DBSELECT-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â£Æ£Å£Ô£Ã£È½èÍý
      *****************************************************************
       900-DBFETCH-SEC                SECTION.
      *
           MOVE    "DBFETCH"           TO  MCP-FUNC
           PERFORM 900-ORCDBMAIN-SEC
      *
           .
       900-DBFETCH-EXT.
           EXIT.
      *
      *
      *****************************************************************
      *    ¥Æ¡¼¥Ö¥ë¥¢¥¯¥»¥¹½èÍý
      *****************************************************************
       900-ORCDBMAIN-SEC               SECTION.
      *
           CALL    "ORCDBMAIN"     USING   MCPAREA
                                           MCPDATA-REC
                                           SPA-AREA
           .
      *
       900-ORCDBMAIN-EXT.
           EXIT.
      *      
      *****************************************************************
      *    £Ä£Â¡¡¥ª¡¼¥×¥ó½èÍý
      *****************************************************************
       120-DBOPEN-SEC                SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBOPEN"            TO  MCP-FUNC
           PERFORM   900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBSTART"           TO  MCP-FUNC
           PERFORM   900-ORCDBMAIN-SEC
           .
       100-DBOPEN-EXT.
           EXIT.
      *
      *****************************************************************
      *    £Ä£Â¡¡¥¯¥í¡¼¥º½èÍý
      *****************************************************************
       900-DBDISCONNECT-SEC            SECTION.
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBCOMMIT"          TO  MCP-FUNC
           PERFORM   900-ORCDBMAIN-SEC
      *
           MOVE    LOW-VALUE           TO  MCP-TABLE
                                           MCP-PATHNAME
           MOVE    "DBDISCONNECT"      TO  MCP-FUNC
           PERFORM   900-ORCDBMAIN-SEC
      *
           .
       900-DBDISCONNECT-EXT.
           EXIT.
